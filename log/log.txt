PYTHONPATH=/home/ylu130/workspace/in-context-generalization
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 8 --num-workers 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 16 --seed 42 --data-dir /scratch/ylu130/processed_data/commonsenseqa/n0-seed42-rationalesTrue --rationales --num-in-domain 0
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-07 13:52:55,508] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/n0-seed42-rationalesTrue
  processed_data_dir ........... None
  num_eval ..................... 8
  num_in_domain ................ 0
  num_out_domain ............... None
  out_domain ................... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/t1-m512-i0-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 16
  clip_grad .................... 1.0
  seed ......................... 42
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                   | 0/9741 [00:00<?, ?it/s]  3%|██▎                                                                    | 313/9741 [00:00<00:03, 3120.52it/s]  6%|████▌                                                                  | 628/9741 [00:00<00:02, 3133.25it/s] 10%|██████▉                                                                | 945/9741 [00:00<00:02, 3149.68it/s] 13%|█████████                                                             | 1262/9741 [00:00<00:02, 3156.64it/s] 16%|███████████▎                                                          | 1578/9741 [00:00<00:02, 3145.90it/s] 19%|█████████████▌                                                        | 1893/9741 [00:00<00:02, 3127.21it/s] 23%|███████████████▊                                                      | 2206/9741 [00:00<00:02, 3123.37it/s] 26%|██████████████████                                                    | 2521/9741 [00:00<00:02, 3130.96it/s] 29%|████████████████████▎                                                 | 2835/9741 [00:00<00:02, 3125.39it/s] 32%|██████████████████████▋                                               | 3150/9741 [00:01<00:02, 3130.90it/s] 36%|████████████████████████▉                                             | 3465/9741 [00:01<00:02, 3135.51it/s] 39%|███████████████████████████▏                                          | 3779/9741 [00:01<00:01, 3135.09it/s] 42%|█████████████████████████████▍                                        | 4095/9741 [00:01<00:01, 3140.29it/s] 45%|███████████████████████████████▋                                      | 4410/9741 [00:01<00:01, 3140.00it/s] 49%|█████████████████████████████████▉                                    | 4725/9741 [00:01<00:01, 3107.95it/s] 52%|████████████████████████████████████▏                                 | 5036/9741 [00:01<00:01, 2483.81it/s] 55%|██████████████████████████████████████▍                               | 5344/9741 [00:01<00:01, 2634.57it/s] 58%|████████████████████████████████████████▋                             | 5661/9741 [00:01<00:01, 2776.89it/s] 61%|███████████████████████████████████████████                           | 5989/9741 [00:01<00:01, 2914.59it/s] 65%|█████████████████████████████████████████████▎                        | 6314/9741 [00:02<00:01, 3007.83it/s] 68%|███████████████████████████████████████████████▋                      | 6641/9741 [00:02<00:01, 3081.68it/s] 72%|██████████████████████████████████████████████████                    | 6973/9741 [00:02<00:00, 3148.96it/s] 76%|█████████████████████████████████████████████████████▏                | 7401/9741 [00:02<00:00, 3480.40it/s] 81%|████████████████████████████████████████████████████████▊             | 7901/9741 [00:02<00:00, 3928.29it/s] 86%|████████████████████████████████████████████████████████████▍         | 8415/9741 [00:02<00:00, 4286.24it/s] 92%|████████████████████████████████████████████████████████████████▏     | 8932/9741 [00:02<00:00, 4547.86it/s] 97%|███████████████████████████████████████████████████████████████████▉  | 9451/9741 [00:02<00:00, 4739.10it/s]100%|██████████████████████████████████████████████████████████████████████| 9741/9741 [00:02<00:00, 3415.88it/s]
Load End
Num instances: 8
Loading checkpoint shards:   0%|                                                           | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                           | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                           | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                           | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████                                  | 1/3 [00:04<00:09,  5.00s/it]Loading checkpoint shards:  33%|█████████████████                                  | 1/3 [00:05<00:10,  5.27s/it]Loading checkpoint shards:  33%|█████████████████                                  | 1/3 [00:05<00:10,  5.29s/it]Loading checkpoint shards:  33%|█████████████████                                  | 1/3 [00:05<00:11,  5.72s/it]Loading checkpoint shards:  67%|██████████████████████████████████                 | 2/3 [00:10<00:05,  5.07s/it]Loading checkpoint shards:  67%|██████████████████████████████████                 | 2/3 [00:10<00:05,  5.08s/it]Loading checkpoint shards:  67%|██████████████████████████████████                 | 2/3 [00:10<00:05,  5.40s/it]Loading checkpoint shards:  67%|██████████████████████████████████                 | 2/3 [00:11<00:05,  5.51s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.49s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.66s/it]
Loading checkpoint shards: 100%|███████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.42s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.59s/it]
[2023-08-07 13:53:49,516] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|███████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.72s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.89s/it]
Loading checkpoint shards: 100%|███████████████████████████████████████████████████| 3/3 [00:15<00:00,  4.90s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.09s/it]
[2023-08-07 13:54:04,699] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-07 13:54:04,701] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-07 13:54:04,701] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-07 13:54:04,701] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-07 13:54:04,701] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-07 13:54:04,701] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-07 13:54:04,702] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-07 13:54:04,702] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-07 13:54:04,702] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-07 13:54:04,702] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-07 13:54:04,702] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-07 13:54:04,702] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fea63c02610>
[2023-08-07 13:54:04,702] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-07 13:54:04,702] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-07 13:54:04,702] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-07 13:54:04,702] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-07 13:54:04,702] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-07 13:54:04,702] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-07 13:54:04,702] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-07 13:54:04,702] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-07 13:54:04,702] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-07 13:54:04,702] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-07 13:54:04,702] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-07 13:54:04,702] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-07 13:54:04,702] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-07 13:54:04,702] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-07 13:54:04,702] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-07 13:54:04,702] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-07 13:54:04,702] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-07 13:54:04,702] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-07 13:54:04,702] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-07 13:54:04,702] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-07 13:54:04,702] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-07 13:54:04,702] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-07 13:54:04,703] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-07 13:54:04,703] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-07 13:54:04,703] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-07 13:54:04,703] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-07 13:54:04,703] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-07 13:54:04,703] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-07 13:54:04,703] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-07 13:54:04,703] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-07 13:54:04,703] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-07 13:54:04,703] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-07 13:54:04,703] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7fea63c02b80>
[2023-08-07 13:54:04,703] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-07 13:54:04,703] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-07 13:54:04,703] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-07 13:54:04,703] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-07 13:54:04,703] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-07 13:54:04,703] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-07 13:54:04,703] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-07 13:54:04,703] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-07 13:54:04,703] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-07 13:54:04,703] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-07 13:54:04,703] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-07 13:54:04,703] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-07 13:54:04,703] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-07 13:54:04,703] [INFO] [config.py:1012:print]   train_batch_size ............. 64
[2023-08-07 13:54:04,703] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  16
[2023-08-07 13:54:04,703] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-07 13:54:04,703] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-07 13:54:04,703] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-07 13:54:04,703] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-07 13:54:04,703] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-07 13:54:04,703] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-07 13:54:04,703] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-07 13:54:04,704] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 16, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.3199009895324707 seconds
Loading extension module utils...
Time to load utils op: 0.30436015129089355 seconds
Loading extension module utils...
Time to load utils op: 0.30428576469421387 seconds
Loading extension module utils...
Time to load utils op: 0.30411839485168457 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                                           | 0/1 [00:00<?, ?it/s]############### Example ###############
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following multiple choice question.

### Demonstration:None

### Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid

### Response:
############### End ###############
Evaluating commonsenseqa : 100%|███████████████████████████████████████████████████| 1/1 [00:31<00:00, 31.12s/it]Evaluating commonsenseqa : 100%|███████████████████████████████████████████████████| 1/1 [00:31<00:00, 31.12s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 0.8415} | lm_loss 8.299 | avg. gen lenth: 386.5
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 8 --num-workers 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 16 --seed 42 --data-dir /scratch/ylu130/processed_data/commonsenseqa/n1-seed42-rationalesTrue --rationales --num-in-domain 1
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[nltk_data]   Package punkt is already up-to-date!
[2023-08-07 13:54:41,514] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/n1-seed42-rationalesTrue
  processed_data_dir ........... None
  num_eval ..................... 8
  num_in_domain ................ 1
  num_out_domain ............... None
  out_domain ................... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/t1-m512-i1-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 16
  clip_grad .................... 1.0
  seed ......................... 42
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                   | 0/9740 [00:00<?, ?it/s]  1%|▌                                                                        | 67/9740 [00:00<00:14, 660.16it/s]  1%|▉                                                                       | 135/9740 [00:00<00:14, 666.52it/s]  2%|█▍                                                                      | 202/9740 [00:00<00:14, 663.01it/s]  3%|█▉                                                                      | 269/9740 [00:00<00:14, 658.75it/s]  3%|██▍                                                                     | 336/9740 [00:00<00:14, 659.87it/s]  4%|██▉                                                                     | 403/9740 [00:00<00:14, 660.54it/s]  5%|███▍                                                                    | 470/9740 [00:00<00:14, 657.29it/s]  6%|███▉                                                                    | 536/9740 [00:00<00:13, 658.11it/s]  6%|████▍                                                                   | 602/9740 [00:00<00:14, 642.68it/s]  7%|████▉                                                                   | 667/9740 [00:01<00:14, 641.79it/s]  8%|█████▍                                                                  | 733/9740 [00:01<00:13, 645.27it/s]  8%|█████▉                                                                  | 799/9740 [00:01<00:13, 649.37it/s]  9%|██████▍                                                                 | 865/9740 [00:01<00:13, 651.40it/s] 10%|██████▉                                                                 | 931/9740 [00:01<00:13, 650.12it/s] 10%|███████▎                                                                | 997/9740 [00:01<00:13, 651.52it/s] 11%|███████▋                                                               | 1063/9740 [00:01<00:13, 652.18it/s] 12%|████████▏                                                              | 1129/9740 [00:01<00:13, 650.43it/s] 12%|████████▋                                                              | 1195/9740 [00:01<00:13, 650.62it/s] 13%|█████████▏                                                             | 1261/9740 [00:01<00:13, 651.12it/s] 14%|█████████▋                                                             | 1327/9740 [00:02<00:13, 646.58it/s] 14%|██████████▏                                                            | 1392/9740 [00:02<00:12, 644.70it/s] 15%|██████████▋                                                            | 1458/9740 [00:02<00:12, 647.39it/s] 16%|███████████                                                            | 1523/9740 [00:02<00:12, 648.15it/s] 16%|███████████▌                                                           | 1589/9740 [00:02<00:12, 649.99it/s] 17%|████████████                                                           | 1658/9740 [00:02<00:12, 659.88it/s] 18%|████████████▋                                                          | 1749/9740 [00:02<00:10, 732.46it/s] 19%|█████████████▍                                                         | 1845/9740 [00:02<00:09, 799.99it/s] 20%|██████████████▏                                                        | 1949/9740 [00:02<00:08, 871.28it/s] 21%|██████████████▉                                                        | 2053/9740 [00:02<00:08, 921.58it/s] 22%|███████████████▋                                                       | 2158/9740 [00:03<00:07, 958.67it/s] 23%|████████████████▍                                                      | 2262/9740 [00:03<00:07, 982.61it/s] 24%|█████████████████                                                     | 2367/9740 [00:03<00:07, 1002.27it/s] 25%|█████████████████▊                                                    | 2470/9740 [00:03<00:07, 1008.57it/s] 26%|██████████████████▍                                                   | 2573/9740 [00:03<00:07, 1014.33it/s] 27%|███████████████████▏                                                  | 2678/9740 [00:03<00:06, 1022.80it/s] 29%|███████████████████▉                                                  | 2781/9740 [00:03<00:06, 1023.16it/s] 30%|████████████████████▋                                                 | 2886/9740 [00:03<00:06, 1029.48it/s] 31%|█████████████████████▍                                                | 2989/9740 [00:03<00:06, 1026.85it/s] 32%|██████████████████████▏                                               | 3092/9740 [00:03<00:06, 1025.66it/s] 33%|██████████████████████▉                                               | 3196/9740 [00:04<00:06, 1028.81it/s] 34%|███████████████████████▋                                              | 3301/9740 [00:04<00:06, 1033.75it/s] 35%|████████████████████████▍                                             | 3405/9740 [00:04<00:06, 1033.36it/s] 36%|█████████████████████████▏                                            | 3509/9740 [00:04<00:06, 1033.93it/s] 37%|█████████████████████████▉                                            | 3613/9740 [00:04<00:05, 1033.53it/s] 38%|███████████████████████████                                            | 3717/9740 [00:04<00:06, 993.86it/s] 39%|███████████████████████████▊                                           | 3817/9740 [00:04<00:05, 992.66it/s] 40%|████████████████████████████▏                                         | 3920/9740 [00:04<00:05, 1001.16it/s] 41%|████████████████████████████▉                                         | 4025/9740 [00:04<00:05, 1012.96it/s] 42%|█████████████████████████████▋                                        | 4129/9740 [00:04<00:05, 1020.48it/s] 43%|██████████████████████████████▍                                       | 4233/9740 [00:05<00:05, 1026.24it/s] 45%|███████████████████████████████▏                                      | 4337/9740 [00:05<00:05, 1029.11it/s] 46%|███████████████████████████████▉                                      | 4441/9740 [00:05<00:05, 1030.70it/s] 47%|█████████████████████████████████▏                                     | 4545/9740 [00:05<00:05, 988.38it/s] 48%|█████████████████████████████████▍                                    | 4650/9740 [00:05<00:05, 1003.78it/s] 49%|██████████████████████████████████▋                                    | 4751/9740 [00:05<00:06, 762.30it/s] 50%|███████████████████████████████████▍                                   | 4855/9740 [00:05<00:05, 827.56it/s] 51%|████████████████████████████████████                                   | 4955/9740 [00:05<00:05, 869.61it/s] 52%|████████████████████████████████████▊                                  | 5054/9740 [00:05<00:05, 901.20it/s] 53%|█████████████████████████████████████▌                                 | 5157/9740 [00:06<00:04, 935.15it/s] 54%|██████████████████████████████████████▎                                | 5259/9740 [00:06<00:04, 957.44it/s] 55%|███████████████████████████████████████                                | 5363/9740 [00:06<00:04, 979.73it/s] 56%|███████████████████████████████████████▊                               | 5465/9740 [00:06<00:04, 988.81it/s] 57%|████████████████████████████████████████                              | 5571/9740 [00:06<00:04, 1009.10it/s] 58%|████████████████████████████████████████▊                             | 5677/9740 [00:06<00:03, 1021.29it/s] 59%|█████████████████████████████████████████▌                            | 5784/9740 [00:06<00:03, 1034.43it/s] 60%|██████████████████████████████████████████▎                           | 5891/9740 [00:06<00:03, 1044.19it/s] 62%|███████████████████████████████████████████▏                          | 6001/9740 [00:06<00:03, 1058.96it/s] 63%|███████████████████████████████████████████▉                          | 6108/9740 [00:07<00:03, 1055.95it/s] 64%|████████████████████████████████████████████▋                         | 6216/9740 [00:07<00:03, 1061.07it/s] 65%|█████████████████████████████████████████████▍                        | 6323/9740 [00:07<00:03, 1057.34it/s] 66%|██████████████████████████████████████████████▏                       | 6432/9740 [00:07<00:03, 1065.49it/s] 67%|███████████████████████████████████████████████                       | 6540/9740 [00:07<00:02, 1067.55it/s] 68%|███████████████████████████████████████████████▊                      | 6649/9740 [00:07<00:02, 1073.63it/s] 69%|████████████████████████████████████████████████▌                     | 6759/9740 [00:07<00:02, 1080.25it/s] 71%|█████████████████████████████████████████████████▎                    | 6868/9740 [00:07<00:02, 1074.16it/s] 72%|██████████████████████████████████████████████████▏                   | 6976/9740 [00:07<00:02, 1072.03it/s] 73%|██████████████████████████████████████████████████▉                   | 7084/9740 [00:07<00:02, 1068.83it/s] 74%|███████████████████████████████████████████████████▋                  | 7191/9740 [00:08<00:02, 1064.94it/s] 75%|████████████████████████████████████████████████████▍                 | 7298/9740 [00:08<00:02, 1061.96it/s] 76%|█████████████████████████████████████████████████████▏                | 7406/9740 [00:08<00:02, 1064.96it/s] 77%|█████████████████████████████████████████████████████▉                | 7513/9740 [00:08<00:02, 1039.33it/s] 78%|██████████████████████████████████████████████████████▊               | 7620/9740 [00:08<00:02, 1047.76it/s] 79%|███████████████████████████████████████████████████████▌              | 7727/9740 [00:08<00:01, 1053.90it/s] 80%|████████████████████████████████████████████████████████▎             | 7836/9740 [00:08<00:01, 1061.94it/s] 82%|█████████████████████████████████████████████████████████             | 7944/9740 [00:08<00:01, 1066.52it/s] 83%|█████████████████████████████████████████████████████████▉            | 8053/9740 [00:08<00:01, 1072.24it/s] 84%|██████████████████████████████████████████████████████████▋           | 8162/9740 [00:08<00:01, 1075.69it/s] 85%|███████████████████████████████████████████████████████████▍          | 8270/9740 [00:09<00:01, 1075.25it/s] 86%|████████████████████████████████████████████████████████████▏         | 8378/9740 [00:09<00:01, 1071.25it/s] 87%|████████████████████████████████████████████████████████████▉         | 8486/9740 [00:09<00:01, 1071.30it/s] 88%|█████████████████████████████████████████████████████████████▊        | 8594/9740 [00:09<00:01, 1073.06it/s] 89%|██████████████████████████████████████████████████████████████▌       | 8702/9740 [00:09<00:00, 1069.73it/s] 90%|███████████████████████████████████████████████████████████████▎      | 8810/9740 [00:09<00:00, 1071.81it/s] 92%|████████████████████████████████████████████████████████████████      | 8919/9740 [00:09<00:00, 1076.13it/s] 93%|████████████████████████████████████████████████████████████████▉     | 9028/9740 [00:09<00:00, 1078.76it/s] 94%|█████████████████████████████████████████████████████████████████▋    | 9136/9740 [00:09<00:00, 1076.23it/s] 95%|██████████████████████████████████████████████████████████████████▍   | 9246/9740 [00:09<00:00, 1080.52it/s] 96%|███████████████████████████████████████████████████████████████████▏  | 9355/9740 [00:10<00:00, 1077.33it/s] 97%|████████████████████████████████████████████████████████████████████  | 9463/9740 [00:10<00:00, 1077.10it/s] 98%|████████████████████████████████████████████████████████████████████▊ | 9571/9740 [00:10<00:00, 1077.01it/s] 99%|█████████████████████████████████████████████████████████████████████▌| 9679/9740 [00:10<00:00, 1074.91it/s]100%|███████████████████████████████████████████████████████████████████████| 9740/9740 [00:10<00:00, 936.92it/s]
Load End
Num instances: 8
Loading checkpoint shards:   0%|                                                                                                       | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                                       | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                                       | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                                       | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███████████████████████████████▋                                                               | 1/3 [00:04<00:09,  4.87s/it]Loading checkpoint shards:  33%|███████████████████████████████▋                                                               | 1/3 [00:05<00:10,  5.10s/it]Loading checkpoint shards:  33%|███████████████████████████████▋                                                               | 1/3 [00:05<00:10,  5.29s/it]Loading checkpoint shards:  33%|███████████████████████████████▋                                                               | 1/3 [00:05<00:10,  5.39s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████████████████▎                               | 2/3 [00:09<00:04,  4.97s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████████████████▎                               | 2/3 [00:10<00:05,  5.19s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████████████████▎                               | 2/3 [00:10<00:05,  5.38s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████████████████▎                               | 2/3 [00:10<00:05,  5.46s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.35s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.51s/it]
Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.55s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.71s/it]
Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.74s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.90s/it]
[2023-08-07 13:55:44,339] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.79s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.97s/it]
[2023-08-07 13:55:54,581] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-07 13:55:54,583] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-07 13:55:54,583] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-07 13:55:54,583] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-07 13:55:54,583] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-07 13:55:54,583] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-07 13:55:54,584] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-07 13:55:54,584] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-07 13:55:54,584] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-07 13:55:54,584] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-07 13:55:54,584] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-07 13:55:54,584] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f03d6974610>
[2023-08-07 13:55:54,584] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-07 13:55:54,584] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-07 13:55:54,584] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-07 13:55:54,584] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-07 13:55:54,584] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-07 13:55:54,584] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-07 13:55:54,584] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-07 13:55:54,584] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-07 13:55:54,584] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-07 13:55:54,584] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-07 13:55:54,584] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-07 13:55:54,584] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-07 13:55:54,584] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-07 13:55:54,584] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-07 13:55:54,584] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-07 13:55:54,584] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-07 13:55:54,584] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-07 13:55:54,584] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-07 13:55:54,584] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-07 13:55:54,585] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-07 13:55:54,585] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-07 13:55:54,585] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-07 13:55:54,585] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-07 13:55:54,585] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-07 13:55:54,585] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-07 13:55:54,585] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-07 13:55:54,585] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-07 13:55:54,585] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-07 13:55:54,585] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-07 13:55:54,585] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-07 13:55:54,585] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-07 13:55:54,585] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-07 13:55:54,585] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f03d6974b80>
[2023-08-07 13:55:54,585] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-07 13:55:54,585] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-07 13:55:54,585] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-07 13:55:54,585] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-07 13:55:54,585] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-07 13:55:54,585] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-07 13:55:54,585] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-07 13:55:54,585] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-07 13:55:54,585] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-07 13:55:54,585] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-07 13:55:54,585] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-07 13:55:54,585] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-07 13:55:54,585] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-07 13:55:54,585] [INFO] [config.py:1012:print]   train_batch_size ............. 64
[2023-08-07 13:55:54,585] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  16
[2023-08-07 13:55:54,585] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-07 13:55:54,585] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-07 13:55:54,585] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-07 13:55:54,585] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-07 13:55:54,586] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-07 13:55:54,586] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-07 13:55:54,586] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-07 13:55:54,586] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 16, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.42807459831237793 seconds
Loading extension module utils...
Time to load utils op: 0.404573917388916 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                                                                                       | 0/1 [00:00<?, ?it/s]############### Example ###############
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following multiple choice question.

### Demonstration:Input: He fantasied about getting a what while driving to work and the pros and cons of the extra responsibilities and benefits? Choices:  A: new car B: promotion C: boredom D: impatience E: pressure
Rationales: 1. The question is about someone who is fantasizing about something while driving to work. This person is also considering the pros and cons of the extra responsibilities and benefits. This helps narrow down the choices to something that would involve extra responsibilities and benefits.
   
2. Option A: A new car does not involve extra responsibilities and benefits. The responsibilities and benefits of a car remain the same, regardless of whether it's new or old. Hence, this option is incorrect.

3. Option B: A promotion at work would definitely involve extra responsibilities. It would also come with benefits, such as a higher salary or more influence within the company. Hence, this option fits the criteria mentioned in the question.

4. Option C: Boredom does not involve extra responsibilities and benefits. Hence, this option is incorrect.

5. Option D: Impatience does not involve extra responsibilities and benefits. Hence, this option is incorrect.

6. Option E: Pressure does not offer benefits, although it might involve extra responsibilities. However, considering the context of the question, it's unlikely that someone would fantasize about having more pressure. Hence, this option is incorrect.

7. Therefore, by process of elimination and by matching the criteria given in the question to the options, the correct answer is B: promotion.
Answer: B: promotion

### Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid

### Response:
############### End ###############
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.5050146579742432 seconds
Time to load utils op: 0.5045762062072754 seconds
Evaluating commonsenseqa : 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.49s/it]Evaluating commonsenseqa : 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.49s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 2.6316} | lm_loss 8.5036 | avg. gen lenth: 49.5
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 8 --num-workers 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 16 --seed 42 --data-dir /scratch/ylu130/processed_data/commonsenseqa/n2-seed42-rationalesTrue --rationales --num-in-domain 2
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-07 13:56:33,273] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/n2-seed42-rationalesTrue
  processed_data_dir ........... None
  num_eval ..................... 8
  num_in_domain ................ 2
  num_out_domain ............... None
  out_domain ................... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/t1-m512-i2-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 16
  clip_grad .................... 1.0
  seed ......................... 42
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                                                               | 0/9739 [00:00<?, ?it/s]  0%|▌                                                                                                                    | 47/9739 [00:00<00:20, 462.15it/s]  1%|█▏                                                                                                                   | 94/9739 [00:00<00:20, 466.63it/s]  1%|█▋                                                                                                                  | 142/9739 [00:00<00:20, 470.08it/s]  2%|██▎                                                                                                                 | 190/9739 [00:00<00:20, 470.94it/s]  2%|██▊                                                                                                                 | 238/9739 [00:00<00:20, 468.58it/s]  3%|███▍                                                                                                                | 285/9739 [00:00<00:20, 468.67it/s]  3%|███▉                                                                                                                | 332/9739 [00:00<00:20, 468.05it/s]  4%|████▌                                                                                                               | 379/9739 [00:00<00:20, 467.72it/s]  4%|█████                                                                                                               | 427/9739 [00:00<00:19, 468.89it/s]  5%|█████▋                                                                                                              | 474/9739 [00:01<00:19, 467.10it/s]  5%|██████▏                                                                                                             | 522/9739 [00:01<00:19, 468.82it/s]  6%|██████▊                                                                                                             | 569/9739 [00:01<00:19, 468.78it/s]  6%|███████▎                                                                                                            | 616/9739 [00:01<00:19, 469.05it/s]  7%|███████▉                                                                                                            | 663/9739 [00:01<00:19, 467.11it/s]  7%|████████▍                                                                                                           | 710/9739 [00:01<00:19, 467.81it/s]  8%|█████████                                                                                                           | 757/9739 [00:01<00:19, 468.39it/s]  8%|█████████▌                                                                                                          | 805/9739 [00:01<00:19, 469.39it/s]  9%|██████████▏                                                                                                         | 852/9739 [00:01<00:18, 469.03it/s]  9%|██████████▋                                                                                                         | 899/9739 [00:01<00:18, 466.48it/s] 10%|███████████▎                                                                                                        | 948/9739 [00:02<00:18, 471.06it/s] 10%|███████████▉                                                                                                        | 998/9739 [00:02<00:18, 478.34it/s] 11%|████████████▎                                                                                                      | 1048/9739 [00:02<00:17, 483.88it/s] 11%|████████████▉                                                                                                      | 1098/9739 [00:02<00:17, 487.79it/s] 12%|█████████████▌                                                                                                     | 1148/9739 [00:02<00:17, 488.95it/s] 12%|██████████████▏                                                                                                    | 1198/9739 [00:02<00:17, 490.83it/s] 13%|██████████████▊                                                                                                    | 1254/9739 [00:02<00:16, 510.01it/s] 14%|███████████████▋                                                                                                   | 1324/9739 [00:02<00:14, 566.53it/s] 14%|████████████████▌                                                                                                  | 1398/9739 [00:02<00:13, 617.14it/s] 15%|█████████████████▍                                                                                                 | 1473/9739 [00:02<00:12, 656.61it/s] 16%|██████████████████▎                                                                                                | 1548/9739 [00:03<00:11, 683.87it/s] 17%|███████████████████▏                                                                                               | 1622/9739 [00:03<00:11, 700.54it/s] 17%|████████████████████                                                                                               | 1696/9739 [00:03<00:11, 709.97it/s] 18%|████████████████████▉                                                                                              | 1771/9739 [00:03<00:11, 721.86it/s] 19%|█████████████████████▊                                                                                             | 1844/9739 [00:03<00:11, 710.33it/s] 20%|██████████████████████▋                                                                                            | 1918/9739 [00:03<00:10, 719.03it/s] 20%|███████████████████████▌                                                                                           | 1993/9739 [00:03<00:10, 726.76it/s] 21%|████████████████████████▍                                                                                          | 2066/9739 [00:03<00:10, 723.67it/s] 22%|█████████████████████████▎                                                                                         | 2140/9739 [00:03<00:10, 727.80it/s] 23%|██████████████████████████▏                                                                                        | 2215/9739 [00:03<00:10, 733.01it/s] 24%|███████████████████████████                                                                                        | 2289/9739 [00:04<00:10, 734.67it/s] 24%|███████████████████████████▉                                                                                       | 2364/9739 [00:04<00:09, 738.07it/s] 25%|████████████████████████████▊                                                                                      | 2439/9739 [00:04<00:09, 740.97it/s] 26%|█████████████████████████████▋                                                                                     | 2514/9739 [00:04<00:09, 731.62it/s] 27%|██████████████████████████████▌                                                                                    | 2589/9739 [00:04<00:09, 735.68it/s] 27%|███████████████████████████████▍                                                                                   | 2664/9739 [00:04<00:09, 737.37it/s] 28%|████████████████████████████████▎                                                                                  | 2738/9739 [00:04<00:09, 735.83it/s] 29%|█████████████████████████████████▏                                                                                 | 2812/9739 [00:04<00:09, 734.88it/s] 30%|██████████████████████████████████                                                                                 | 2886/9739 [00:04<00:09, 734.93it/s] 30%|██████████████████████████████████▉                                                                                | 2960/9739 [00:04<00:09, 734.66it/s] 31%|███████████████████████████████████▊                                                                               | 3035/9739 [00:05<00:09, 737.87it/s] 32%|████████████████████████████████████▋                                                                              | 3110/9739 [00:05<00:08, 739.92it/s] 33%|█████████████████████████████████████▌                                                                             | 3184/9739 [00:05<00:08, 739.72it/s] 33%|██████████████████████████████████████▍                                                                            | 3259/9739 [00:05<00:08, 741.56it/s] 34%|███████████████████████████████████████▎                                                                           | 3334/9739 [00:05<00:08, 739.09it/s] 35%|████████████████████████████████████████▏                                                                          | 3408/9739 [00:05<00:08, 739.21it/s] 36%|█████████████████████████████████████████▏                                                                         | 3483/9739 [00:05<00:08, 740.02it/s] 37%|██████████████████████████████████████████                                                                         | 3558/9739 [00:05<00:08, 741.33it/s] 37%|██████████████████████████████████████████▉                                                                        | 3633/9739 [00:05<00:08, 739.70it/s] 38%|███████████████████████████████████████████▊                                                                       | 3708/9739 [00:05<00:08, 741.28it/s] 39%|████████████████████████████████████████████▋                                                                      | 3783/9739 [00:06<00:08, 742.18it/s] 40%|█████████████████████████████████████████████▌                                                                     | 3858/9739 [00:06<00:08, 732.04it/s] 40%|██████████████████████████████████████████████▍                                                                    | 3932/9739 [00:06<00:08, 715.81it/s] 41%|███████████████████████████████████████████████▎                                                                   | 4007/9739 [00:06<00:07, 723.98it/s] 42%|████████████████████████████████████████████████▏                                                                  | 4082/9739 [00:06<00:07, 728.98it/s] 43%|█████████████████████████████████████████████████                                                                  | 4157/9739 [00:06<00:07, 734.57it/s] 43%|█████████████████████████████████████████████████▉                                                                 | 4232/9739 [00:06<00:07, 738.13it/s] 44%|██████████████████████████████████████████████████▊                                                                | 4306/9739 [00:06<00:07, 729.30it/s] 45%|███████████████████████████████████████████████████▋                                                               | 4381/9739 [00:06<00:07, 733.66it/s] 46%|████████████████████████████████████████████████████▌                                                              | 4456/9739 [00:06<00:07, 737.14it/s] 47%|█████████████████████████████████████████████████████▍                                                             | 4530/9739 [00:07<00:07, 689.96it/s] 47%|██████████████████████████████████████████████████████▍                                                            | 4605/9739 [00:07<00:07, 706.50it/s] 48%|███████████████████████████████████████████████████████▎                                                           | 4680/9739 [00:07<00:07, 717.23it/s] 49%|████████████████████████████████████████████████████████                                                           | 4753/9739 [00:07<00:09, 538.16it/s] 50%|█████████████████████████████████████████████████████████                                                          | 4828/9739 [00:07<00:08, 588.00it/s] 50%|█████████████████████████████████████████████████████████▉                                                         | 4903/9739 [00:07<00:07, 627.51it/s] 51%|██████████████████████████████████████████████████████████▊                                                        | 4977/9739 [00:07<00:07, 656.94it/s] 52%|███████████████████████████████████████████████████████████▋                                                       | 5052/9739 [00:07<00:06, 681.71it/s] 53%|████████████████████████████████████████████████████████████▌                                                      | 5127/9739 [00:08<00:06, 700.00it/s] 53%|█████████████████████████████████████████████████████████████▍                                                     | 5201/9739 [00:08<00:06, 711.00it/s] 54%|██████████████████████████████████████████████████████████████▎                                                    | 5276/9739 [00:08<00:06, 720.69it/s] 55%|███████████████████████████████████████████████████████████████▏                                                   | 5350/9739 [00:08<00:06, 724.12it/s] 56%|████████████████████████████████████████████████████████████████                                                   | 5424/9739 [00:08<00:05, 727.29it/s] 56%|████████████████████████████████████████████████████████████████▉                                                  | 5500/9739 [00:08<00:05, 736.36it/s] 57%|█████████████████████████████████████████████████████████████████▉                                                 | 5579/9739 [00:08<00:05, 750.16it/s] 58%|██████████████████████████████████████████████████████████████████▊                                                | 5657/9739 [00:08<00:05, 756.94it/s] 59%|███████████████████████████████████████████████████████████████████▋                                               | 5735/9739 [00:08<00:05, 763.50it/s] 60%|████████████████████████████████████████████████████████████████████▋                                              | 5814/9739 [00:08<00:05, 768.66it/s] 60%|█████████████████████████████████████████████████████████████████████▌                                             | 5892/9739 [00:09<00:04, 770.19it/s] 61%|██████████████████████████████████████████████████████████████████████▍                                            | 5970/9739 [00:09<00:04, 772.31it/s] 62%|███████████████████████████████████████████████████████████████████████▍                                           | 6049/9739 [00:09<00:04, 774.91it/s] 63%|████████████████████████████████████████████████████████████████████████▎                                          | 6127/9739 [00:09<00:04, 773.88it/s] 64%|█████████████████████████████████████████████████████████████████████████▎                                         | 6205/9739 [00:09<00:04, 775.27it/s] 65%|██████████████████████████████████████████████████████████████████████████▏                                        | 6283/9739 [00:09<00:04, 775.59it/s] 65%|███████████████████████████████████████████████████████████████████████████                                        | 6361/9739 [00:09<00:04, 774.13it/s] 66%|████████████████████████████████████████████████████████████████████████████                                       | 6440/9739 [00:09<00:04, 775.96it/s] 67%|████████████████████████████████████████████████████████████████████████████▉                                      | 6518/9739 [00:09<00:04, 774.12it/s] 68%|█████████████████████████████████████████████████████████████████████████████▉                                     | 6596/9739 [00:09<00:04, 770.01it/s] 69%|██████████████████████████████████████████████████████████████████████████████▊                                    | 6674/9739 [00:10<00:03, 771.92it/s] 69%|███████████████████████████████████████████████████████████████████████████████▋                                   | 6753/9739 [00:10<00:03, 774.84it/s] 70%|████████████████████████████████████████████████████████████████████████████████▋                                  | 6831/9739 [00:10<00:03, 774.88it/s] 71%|█████████████████████████████████████████████████████████████████████████████████▌                                 | 6909/9739 [00:10<00:03, 776.38it/s] 72%|██████████████████████████████████████████████████████████████████████████████████▌                                | 6988/9739 [00:10<00:03, 777.81it/s] 73%|███████████████████████████████████████████████████████████████████████████████████▍                               | 7066/9739 [00:10<00:03, 775.85it/s] 73%|████████████████████████████████████████████████████████████████████████████████████▎                              | 7145/9739 [00:10<00:03, 777.99it/s] 74%|█████████████████████████████████████████████████████████████████████████████████████▎                             | 7223/9739 [00:10<00:03, 776.48it/s] 75%|██████████████████████████████████████████████████████████████████████████████████████▏                            | 7301/9739 [00:10<00:03, 775.64it/s] 76%|███████████████████████████████████████████████████████████████████████████████████████▏                           | 7380/9739 [00:10<00:03, 777.65it/s] 77%|████████████████████████████████████████████████████████████████████████████████████████                           | 7458/9739 [00:11<00:03, 749.88it/s] 77%|████████████████████████████████████████████████████████████████████████████████████████▉                          | 7536/9739 [00:11<00:02, 757.75it/s] 78%|█████████████████████████████████████████████████████████████████████████████████████████▉                         | 7615/9739 [00:11<00:02, 765.07it/s] 79%|██████████████████████████████████████████████████████████████████████████████████████████▊                        | 7693/9739 [00:11<00:02, 767.17it/s] 80%|███████████████████████████████████████████████████████████████████████████████████████████▊                       | 7772/9739 [00:11<00:02, 771.57it/s] 81%|████████████████████████████████████████████████████████████████████████████████████████████▋                      | 7851/9739 [00:11<00:02, 775.54it/s] 81%|█████████████████████████████████████████████████████████████████████████████████████████████▋                     | 7929/9739 [00:11<00:02, 773.91it/s] 82%|██████████████████████████████████████████████████████████████████████████████████████████████▌                    | 8007/9739 [00:11<00:02, 775.42it/s] 83%|███████████████████████████████████████████████████████████████████████████████████████████████▍                   | 8086/9739 [00:11<00:02, 777.01it/s] 84%|████████████████████████████████████████████████████████████████████████████████████████████████▍                  | 8164/9739 [00:11<00:02, 776.66it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                 | 8243/9739 [00:12<00:01, 778.08it/s] 85%|██████████████████████████████████████████████████████████████████████████████████████████████████▎                | 8321/9739 [00:12<00:01, 778.13it/s] 86%|███████████████████████████████████████████████████████████████████████████████████████████████████▏               | 8399/9739 [00:12<00:01, 777.16it/s] 87%|████████████████████████████████████████████████████████████████████████████████████████████████████               | 8478/9739 [00:12<00:01, 778.14it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████████████████              | 8556/9739 [00:12<00:01, 778.10it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████████████████▉             | 8634/9739 [00:12<00:01, 770.61it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████████████████▊            | 8712/9739 [00:12<00:01, 747.99it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████████████████████▊           | 8790/9739 [00:12<00:01, 755.40it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████████████████▋          | 8866/9739 [00:12<00:01, 754.75it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▌         | 8944/9739 [00:12<00:01, 760.33it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▌        | 9022/9739 [00:13<00:00, 763.38it/s] 93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▍       | 9099/9739 [00:13<00:00, 760.39it/s] 94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▎      | 9177/9739 [00:13<00:00, 764.12it/s] 95%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▎     | 9254/9739 [00:13<00:00, 758.46it/s] 96%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▏    | 9330/9739 [00:13<00:00, 754.48it/s] 97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████    | 9408/9739 [00:13<00:00, 760.40it/s] 97%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████   | 9485/9739 [00:13<00:00, 759.78it/s] 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉  | 9561/9739 [00:13<00:00, 759.72it/s] 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊ | 9638/9739 [00:13<00:00, 762.45it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋| 9715/9739 [00:14<00:00, 763.83it/s]100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9739/9739 [00:14<00:00, 693.76it/s]
Load End
Num instances: 8
Loading checkpoint shards:   0%|                                                                                                       | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                                       | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                                       | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                                       | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███████████████████████████████▋                                                               | 1/3 [00:04<00:09,  4.99s/it]Loading checkpoint shards:  33%|███████████████████████████████▋                                                               | 1/3 [00:05<00:11,  5.65s/it]Loading checkpoint shards:  33%|███████████████████████████████▋                                                               | 1/3 [00:05<00:11,  5.62s/it]Loading checkpoint shards:  33%|███████████████████████████████▋                                                               | 1/3 [00:05<00:11,  5.60s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████████████████▎                               | 2/3 [00:10<00:05,  5.01s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████████████████▎                               | 2/3 [00:10<00:05,  5.44s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████████████████▎                               | 2/3 [00:11<00:05,  5.86s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████████████████▎                               | 2/3 [00:11<00:05,  5.61s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.54s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.67s/it]
Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.80s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.99s/it]
Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.02s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.22s/it]
Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  4.93s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.12s/it]
[2023-08-07 13:57:40,626] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
[2023-08-07 13:57:54,992] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-07 13:57:54,993] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-07 13:57:54,993] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-07 13:57:54,993] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-07 13:57:54,993] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-07 13:57:54,993] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f07c78c5610>
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f07c78c5280>
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-07 13:57:54,994] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-07 13:57:54,995] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-07 13:57:54,995] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-07 13:57:54,995] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-07 13:57:54,995] [INFO] [config.py:1012:print]   train_batch_size ............. 64
[2023-08-07 13:57:54,995] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  16
[2023-08-07 13:57:54,995] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-07 13:57:54,995] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-07 13:57:54,995] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-07 13:57:54,995] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-07 13:57:54,995] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-07 13:57:54,995] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-07 13:57:54,995] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-07 13:57:54,995] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 16, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.49294376373291016 secondsTime to load utils op: 0.4049999713897705 seconds

Loading extension module utils...
Time to load utils op: 0.5049941539764404 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                                                                                       | 0/1 [00:00<?, ?it/s]############### Example ###############
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following multiple choice question.

### Demonstration:Input: He fantasied about getting a what while driving to work and the pros and cons of the extra responsibilities and benefits? Choices:  A: new car B: promotion C: boredom D: impatience E: pressure
Rationales: Step 1: Identify the key terms in the question. Here, the protagonist is fantasizing while driving to work about something that comes with both additional responsibilities and benefits.

Step 2: Consider each answer choice in relation to the key terms. 

Choice A: A new car may be a desire, but it does not inherently carry extra responsibilities and benefits.

Choice B: A promotion at work would logically involve both additional responsibilities and benefits, fitting the description in the question.

Choice C: Boredom is a state of mind, not something one would fantasize about on the way to work, and it does not involve responsibilities or benefits. 

Choice D: Impatience is an emotion, not a situation one would fantasize about. Additionally, it doesn't involve responsibilities or benefits. 

Choice E: Pressure, like impatience, is more of a feeling or situation one might experience but not fantasize about. It also doesn't inherently have responsibilities or benefits.

Step 3: Choose the answer that best fits the key terms in the question. In this case, the answer is B: promotion.
Answer: B: promotion

Input: He was good at traditional science but excelled at social science, his favorite subject was what? Choices:  A: geography B: history studies C: math D: religion E: dancing
Rationales: Step 1: The question tells us that the person is good at traditional science but excels at social science. That means we should look for a subject that falls under the category of social science. 

Step 2: From the choices given, geography, history studies, and religion can be considered as social sciences. Math and dancing are not social sciences, so we can eliminate choices C and E. 

Step 3: Although geography and religion are part of social sciences, the question indicates that "his favorite subject was what". We're looking for a subject he would likely excel at, since it's his favorite.

Step 4: The question does not provide any information suggesting the person has a particular interest in geography or religion.

Step 5: By default, the answer is B: history studies, as it's the only remaining social science subject among the choices.
Answer: B: history studies

### Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid

### Response:
############### End ###############
Loading extension module utils...
Time to load utils op: 0.5049445629119873 seconds
Evaluating commonsenseqa : 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:27<00:00, 27.04s/it]Evaluating commonsenseqa : 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:27<00:00, 27.04s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 1.1971} | lm_loss 8.4195 | avg. gen lenth: 421.0
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 8 --num-workers 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 16 --seed 42 --data-dir /scratch/ylu130/processed_data/commonsenseqa/n3-seed42-rationalesTrue --rationales --num-in-domain 3
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-07 13:58:29,863] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/n3-seed42-rationalesTrue
  processed_data_dir ........... None
  num_eval ..................... 8
  num_in_domain ................ 3
  num_out_domain ............... None
  out_domain ................... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/t1-m512-i3-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 16
  clip_grad .................... 1.0
  seed ......................... 42
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                                                               | 0/9738 [00:00<?, ?it/s]  0%|▏                                                                                                                    | 18/9738 [00:00<00:54, 177.39it/s]  0%|▍                                                                                                                    | 36/9738 [00:00<00:56, 172.86it/s]  1%|▉                                                                                                                    | 75/9738 [00:00<00:36, 267.00it/s]  1%|█▏                                                                                                                  | 102/9738 [00:00<00:39, 242.82it/s]  1%|█▌                                                                                                                  | 127/9738 [00:00<00:42, 226.34it/s]  2%|█▉                                                                                                                  | 166/9738 [00:00<00:34, 276.00it/s]  2%|██▎                                                                                                                 | 195/9738 [00:00<00:36, 259.04it/s]  2%|██▊                                                                                                                 | 235/9738 [00:00<00:31, 298.83it/s]  3%|███▏                                                                                                                | 266/9738 [00:01<00:34, 274.00it/s]  3%|███▋                                                                                                                | 305/9738 [00:01<00:31, 303.91it/s]  3%|████                                                                                                                | 337/9738 [00:01<00:32, 285.94it/s]  4%|████▎                                                                                                               | 367/9738 [00:01<00:33, 278.13it/s]  4%|████▋                                                                                                               | 396/9738 [00:01<00:34, 272.88it/s]  4%|█████                                                                                                               | 424/9738 [00:01<00:34, 268.88it/s]  5%|█████▍                                                                                                              | 452/9738 [00:01<00:36, 254.40it/s]  5%|█████▋                                                                                                              | 480/9738 [00:01<00:35, 259.47it/s]  5%|██████                                                                                                              | 507/9738 [00:01<00:35, 260.95it/s]  6%|██████▌                                                                                                             | 548/9738 [00:02<00:30, 301.51it/s]  6%|██████▉                                                                                                             | 579/9738 [00:02<00:31, 290.88it/s]  6%|███████▎                                                                                                            | 609/9738 [00:02<00:32, 284.76it/s]  7%|███████▌                                                                                                            | 638/9738 [00:02<00:32, 280.45it/s]  7%|███████▉                                                                                                            | 667/9738 [00:02<00:32, 282.27it/s]  7%|████████▍                                                                                                           | 709/9738 [00:02<00:28, 319.70it/s]  8%|████████▉                                                                                                           | 750/9738 [00:02<00:26, 345.62it/s]  8%|█████████▍                                                                                                          | 792/9738 [00:02<00:24, 364.94it/s]  9%|█████████▉                                                                                                          | 834/9738 [00:02<00:23, 378.34it/s]  9%|██████████▍                                                                                                         | 876/9738 [00:02<00:22, 388.05it/s]  9%|██████████▉                                                                                                         | 917/9738 [00:03<00:22, 392.91it/s] 10%|███████████▍                                                                                                        | 958/9738 [00:03<00:22, 397.76it/s] 10%|███████████▊                                                                                                       | 1000/9738 [00:03<00:21, 401.51it/s] 11%|████████████▎                                                                                                      | 1042/9738 [00:03<00:21, 404.29it/s] 11%|████████████▊                                                                                                      | 1083/9738 [00:03<00:21, 397.62it/s] 12%|█████████████▎                                                                                                     | 1123/9738 [00:03<00:35, 245.58it/s] 12%|█████████████▋                                                                                                     | 1155/9738 [00:04<00:45, 189.40it/s] 12%|█████████████▉                                                                                                     | 1181/9738 [00:04<00:46, 182.66it/s] 12%|██████████████▎                                                                                                    | 1208/9738 [00:04<00:43, 198.30it/s] 13%|██████████████▌                                                                                                    | 1235/9738 [00:04<00:39, 212.68it/s] 13%|██████████████▉                                                                                                    | 1262/9738 [00:04<00:37, 225.68it/s] 13%|███████████████▏                                                                                                   | 1289/9738 [00:04<00:35, 235.57it/s] 14%|███████████████▌                                                                                                   | 1316/9738 [00:04<00:34, 243.84it/s] 14%|███████████████▊                                                                                                   | 1343/9738 [00:04<00:33, 248.99it/s] 14%|████████████████▏                                                                                                  | 1370/9738 [00:04<00:32, 254.53it/s] 14%|████████████████▍                                                                                                  | 1397/9738 [00:05<00:32, 258.30it/s] 15%|████████████████▊                                                                                                  | 1424/9738 [00:05<00:31, 261.21it/s] 15%|█████████████████▏                                                                                                 | 1451/9738 [00:05<00:31, 263.43it/s] 15%|█████████████████▍                                                                                                 | 1478/9738 [00:05<00:31, 264.98it/s] 15%|█████████████████▊                                                                                                 | 1505/9738 [00:05<00:30, 265.65it/s] 16%|██████████████████                                                                                                 | 1532/9738 [00:05<00:30, 266.52it/s] 16%|██████████████████▍                                                                                                | 1559/9738 [00:05<00:30, 267.30it/s] 16%|██████████████████▋                                                                                                | 1586/9738 [00:05<00:30, 266.25it/s] 17%|███████████████████                                                                                                | 1613/9738 [00:05<00:30, 266.94it/s] 17%|███████████████████▎                                                                                               | 1640/9738 [00:05<00:30, 267.85it/s] 17%|███████████████████▋                                                                                               | 1667/9738 [00:06<00:30, 268.30it/s] 17%|████████████████████                                                                                               | 1694/9738 [00:06<00:29, 268.34it/s] 18%|████████████████████▎                                                                                              | 1721/9738 [00:06<00:29, 268.43it/s] 18%|████████████████████▋                                                                                              | 1748/9738 [00:06<00:29, 268.73it/s] 18%|████████████████████▉                                                                                              | 1775/9738 [00:06<00:29, 268.91it/s] 19%|█████████████████████▎                                                                                             | 1802/9738 [00:06<00:33, 234.62it/s] 19%|█████████████████████▌                                                                                             | 1829/9738 [00:06<00:32, 243.46it/s] 19%|█████████████████████▉                                                                                             | 1856/9738 [00:06<00:31, 248.78it/s] 19%|██████████████████████▏                                                                                            | 1883/9738 [00:06<00:30, 254.03it/s] 20%|██████████████████████▌                                                                                            | 1910/9738 [00:07<00:30, 258.22it/s] 20%|██████████████████████▊                                                                                            | 1937/9738 [00:07<00:29, 261.23it/s] 20%|███████████████████████▏                                                                                           | 1964/9738 [00:07<00:29, 263.00it/s] 20%|███████████████████████▌                                                                                           | 1991/9738 [00:07<00:29, 261.84it/s] 21%|███████████████████████▊                                                                                           | 2018/9738 [00:07<00:29, 263.28it/s] 21%|████████████████████████▏                                                                                          | 2045/9738 [00:07<00:29, 261.80it/s] 21%|████████████████████████▍                                                                                          | 2072/9738 [00:07<00:29, 263.44it/s] 22%|████████████████████████▊                                                                                          | 2099/9738 [00:07<00:28, 263.54it/s] 22%|█████████████████████████                                                                                          | 2126/9738 [00:07<00:28, 263.02it/s] 22%|█████████████████████████▍                                                                                         | 2153/9738 [00:07<00:28, 263.28it/s] 22%|█████████████████████████▋                                                                                         | 2180/9738 [00:08<00:28, 263.85it/s] 23%|██████████████████████████                                                                                         | 2207/9738 [00:08<00:28, 264.06it/s] 23%|██████████████████████████▍                                                                                        | 2234/9738 [00:08<00:28, 264.32it/s] 23%|██████████████████████████▋                                                                                        | 2261/9738 [00:08<00:28, 263.18it/s] 23%|███████████████████████████                                                                                        | 2288/9738 [00:08<00:28, 263.24it/s] 24%|███████████████████████████▎                                                                                       | 2315/9738 [00:08<00:28, 263.54it/s] 24%|███████████████████████████▋                                                                                       | 2342/9738 [00:08<00:28, 263.68it/s] 24%|███████████████████████████▉                                                                                       | 2369/9738 [00:08<00:27, 264.10it/s] 25%|████████████████████████████▎                                                                                      | 2396/9738 [00:08<00:27, 264.36it/s] 25%|████████████████████████████▌                                                                                      | 2423/9738 [00:08<00:27, 262.58it/s] 25%|████████████████████████████▉                                                                                      | 2453/9738 [00:09<00:26, 272.78it/s] 26%|█████████████████████████████▍                                                                                     | 2493/9738 [00:09<00:23, 308.57it/s] 26%|█████████████████████████████▉                                                                                     | 2534/9738 [00:09<00:21, 336.63it/s] 26%|██████████████████████████████▍                                                                                    | 2575/9738 [00:09<00:20, 356.47it/s] 27%|██████████████████████████████▉                                                                                    | 2616/9738 [00:09<00:19, 370.41it/s] 27%|███████████████████████████████▍                                                                                   | 2657/9738 [00:09<00:18, 381.14it/s] 28%|███████████████████████████████▊                                                                                   | 2698/9738 [00:09<00:18, 389.33it/s] 28%|████████████████████████████████▎                                                                                  | 2739/9738 [00:09<00:17, 393.25it/s] 29%|████████████████████████████████▊                                                                                  | 2780/9738 [00:09<00:17, 397.14it/s] 29%|█████████████████████████████████▎                                                                                 | 2821/9738 [00:09<00:17, 400.36it/s] 29%|█████████████████████████████████▊                                                                                 | 2862/9738 [00:10<00:17, 403.18it/s] 30%|██████████████████████████████████▎                                                                                | 2903/9738 [00:10<00:16, 404.63it/s] 30%|██████████████████████████████████▊                                                                                | 2944/9738 [00:10<00:16, 404.08it/s] 31%|███████████████████████████████████▎                                                                               | 2985/9738 [00:10<00:16, 405.33it/s] 31%|███████████████████████████████████▋                                                                               | 3026/9738 [00:10<00:16, 406.20it/s] 31%|████████████████████████████████████▏                                                                              | 3067/9738 [00:10<00:16, 406.14it/s] 32%|████████████████████████████████████▋                                                                              | 3108/9738 [00:10<00:16, 406.65it/s] 32%|█████████████████████████████████████▏                                                                             | 3149/9738 [00:10<00:16, 405.32it/s] 33%|█████████████████████████████████████▋                                                                             | 3190/9738 [00:10<00:16, 404.49it/s] 33%|██████████████████████████████████████▏                                                                            | 3231/9738 [00:10<00:16, 405.16it/s] 34%|██████████████████████████████████████▋                                                                            | 3272/9738 [00:11<00:15, 406.07it/s] 34%|███████████████████████████████████████                                                                            | 3313/9738 [00:11<00:15, 406.51it/s] 34%|███████████████████████████████████████▌                                                                           | 3354/9738 [00:11<00:15, 406.61it/s] 35%|████████████████████████████████████████                                                                           | 3395/9738 [00:11<00:15, 405.27it/s] 35%|████████████████████████████████████████▌                                                                          | 3436/9738 [00:11<00:15, 405.57it/s] 36%|█████████████████████████████████████████                                                                          | 3477/9738 [00:11<00:15, 406.01it/s] 36%|█████████████████████████████████████████▌                                                                         | 3518/9738 [00:11<00:15, 406.05it/s] 37%|██████████████████████████████████████████                                                                         | 3559/9738 [00:11<00:15, 402.87it/s] 37%|██████████████████████████████████████████▌                                                                        | 3600/9738 [00:11<00:15, 403.66it/s] 37%|██████████████████████████████████████████▉                                                                        | 3641/9738 [00:11<00:15, 403.42it/s] 38%|███████████████████████████████████████████▍                                                                       | 3682/9738 [00:12<00:14, 404.36it/s] 38%|███████████████████████████████████████████▉                                                                       | 3723/9738 [00:12<00:14, 405.58it/s] 39%|████████████████████████████████████████████▍                                                                      | 3764/9738 [00:12<00:14, 406.15it/s] 39%|████████████████████████████████████████████▉                                                                      | 3805/9738 [00:12<00:14, 406.52it/s] 39%|█████████████████████████████████████████████▍                                                                     | 3846/9738 [00:12<00:14, 405.12it/s] 40%|█████████████████████████████████████████████▉                                                                     | 3887/9738 [00:12<00:14, 406.03it/s] 40%|██████████████████████████████████████████████▍                                                                    | 3928/9738 [00:12<00:14, 406.21it/s] 41%|██████████████████████████████████████████████▊                                                                    | 3969/9738 [00:12<00:14, 406.09it/s] 41%|███████████████████████████████████████████████▎                                                                   | 4010/9738 [00:12<00:14, 406.28it/s] 42%|███████████████████████████████████████████████▊                                                                   | 4051/9738 [00:12<00:13, 406.33it/s] 42%|████████████████████████████████████████████████▎                                                                  | 4092/9738 [00:13<00:13, 404.78it/s] 42%|████████████████████████████████████████████████▊                                                                  | 4133/9738 [00:13<00:13, 404.82it/s] 43%|█████████████████████████████████████████████████▎                                                                 | 4174/9738 [00:13<00:13, 402.86it/s] 43%|█████████████████████████████████████████████████▊                                                                 | 4215/9738 [00:13<00:13, 403.53it/s] 44%|██████████████████████████████████████████████████▎                                                                | 4256/9738 [00:13<00:13, 404.40it/s] 44%|██████████████████████████████████████████████████▋                                                                | 4297/9738 [00:13<00:13, 403.32it/s] 45%|███████████████████████████████████████████████████▏                                                               | 4338/9738 [00:13<00:13, 404.31it/s] 45%|███████████████████████████████████████████████████▋                                                               | 4379/9738 [00:13<00:13, 404.67it/s] 45%|████████████████████████████████████████████████████▏                                                              | 4420/9738 [00:13<00:13, 405.05it/s] 46%|████████████████████████████████████████████████████▋                                                              | 4461/9738 [00:14<00:13, 402.12it/s] 46%|█████████████████████████████████████████████████████▏                                                             | 4502/9738 [00:14<00:12, 402.99it/s] 47%|█████████████████████████████████████████████████████▋                                                             | 4543/9738 [00:14<00:13, 374.36it/s] 47%|██████████████████████████████████████████████████████▏                                                            | 4584/9738 [00:14<00:13, 383.11it/s] 47%|██████████████████████████████████████████████████████▌                                                            | 4625/9738 [00:14<00:13, 389.72it/s] 48%|███████████████████████████████████████████████████████                                                            | 4666/9738 [00:14<00:12, 394.68it/s] 48%|███████████████████████████████████████████████████████▌                                                           | 4707/9738 [00:14<00:12, 397.08it/s] 49%|████████████████████████████████████████████████████████                                                           | 4747/9738 [00:14<00:17, 283.83it/s] 49%|████████████████████████████████████████████████████████▌                                                          | 4788/9738 [00:14<00:15, 311.63it/s] 50%|█████████████████████████████████████████████████████████                                                          | 4829/9738 [00:15<00:14, 335.04it/s] 50%|█████████████████████████████████████████████████████████▌                                                         | 4870/9738 [00:15<00:13, 353.27it/s] 50%|█████████████████████████████████████████████████████████▉                                                         | 4911/9738 [00:15<00:13, 367.65it/s] 51%|██████████████████████████████████████████████████████████▍                                                        | 4952/9738 [00:15<00:12, 377.38it/s] 51%|██████████████████████████████████████████████████████████▉                                                        | 4992/9738 [00:15<00:12, 383.77it/s] 52%|███████████████████████████████████████████████████████████▍                                                       | 5033/9738 [00:15<00:12, 390.07it/s] 52%|███████████████████████████████████████████████████████████▉                                                       | 5074/9738 [00:15<00:11, 394.71it/s] 53%|████████████████████████████████████████████████████████████▍                                                      | 5115/9738 [00:15<00:11, 398.40it/s] 53%|████████████████████████████████████████████████████████████▉                                                      | 5156/9738 [00:15<00:11, 400.89it/s] 53%|█████████████████████████████████████████████████████████████▎                                                     | 5197/9738 [00:15<00:11, 400.79it/s] 54%|█████████████████████████████████████████████████████████████▊                                                     | 5238/9738 [00:16<00:11, 402.21it/s] 54%|██████████████████████████████████████████████████████████████▎                                                    | 5279/9738 [00:16<00:11, 403.02it/s] 55%|██████████████████████████████████████████████████████████████▊                                                    | 5320/9738 [00:16<00:10, 403.99it/s] 55%|███████████████████████████████████████████████████████████████▎                                                   | 5361/9738 [00:16<00:10, 402.83it/s] 55%|███████████████████████████████████████████████████████████████▊                                                   | 5402/9738 [00:16<00:10, 404.00it/s] 56%|████████████████████████████████████████████████████████████████▎                                                  | 5443/9738 [00:16<00:10, 403.05it/s] 56%|████████████████████████████████████████████████████████████████▊                                                  | 5485/9738 [00:16<00:10, 405.20it/s] 57%|█████████████████████████████████████████████████████████████████▎                                                 | 5528/9738 [00:16<00:10, 409.82it/s] 57%|█████████████████████████████████████████████████████████████████▊                                                 | 5571/9738 [00:16<00:10, 413.20it/s] 58%|██████████████████████████████████████████████████████████████████▎                                                | 5613/9738 [00:17<00:09, 414.94it/s] 58%|██████████████████████████████████████████████████████████████████▊                                                | 5655/9738 [00:17<00:09, 414.88it/s] 59%|███████████████████████████████████████████████████████████████████▎                                               | 5698/9738 [00:17<00:09, 416.51it/s] 59%|███████████████████████████████████████████████████████████████████▊                                               | 5740/9738 [00:17<00:09, 417.13it/s] 59%|████████████████████████████████████████████████████████████████████▎                                              | 5783/9738 [00:17<00:09, 418.02it/s] 60%|████████████████████████████████████████████████████████████████████▊                                              | 5825/9738 [00:17<00:09, 418.55it/s] 60%|█████████████████████████████████████████████████████████████████████▎                                             | 5867/9738 [00:17<00:09, 417.31it/s] 61%|█████████████████████████████████████████████████████████████████████▊                                             | 5909/9738 [00:17<00:09, 418.06it/s] 61%|██████████████████████████████████████████████████████████████████████▎                                            | 5952/9738 [00:17<00:09, 418.77it/s] 62%|██████████████████████████████████████████████████████████████████████▊                                            | 5994/9738 [00:17<00:08, 419.03it/s] 62%|███████████████████████████████████████████████████████████████████████▎                                           | 6037/9738 [00:18<00:08, 419.57it/s] 62%|███████████████████████████████████████████████████████████████████████▊                                           | 6080/9738 [00:18<00:08, 419.99it/s] 63%|████████████████████████████████████████████████████████████████████████▎                                          | 6122/9738 [00:18<00:08, 417.69it/s] 63%|████████████████████████████████████████████████████████████████████████▊                                          | 6164/9738 [00:18<00:08, 418.32it/s] 64%|█████████████████████████████████████████████████████████████████████████▎                                         | 6206/9738 [00:18<00:08, 418.63it/s] 64%|█████████████████████████████████████████████████████████████████████████▊                                         | 6248/9738 [00:18<00:08, 418.53it/s] 65%|██████████████████████████████████████████████████████████████████████████▎                                        | 6291/9738 [00:18<00:08, 419.16it/s] 65%|██████████████████████████████████████████████████████████████████████████▊                                        | 6333/9738 [00:18<00:08, 417.93it/s] 65%|███████████████████████████████████████████████████████████████████████████▎                                       | 6376/9738 [00:18<00:08, 418.64it/s] 66%|███████████████████████████████████████████████████████████████████████████▊                                       | 6419/9738 [00:18<00:07, 419.08it/s] 66%|████████████████████████████████████████████████████████████████████████████▎                                      | 6461/9738 [00:19<00:07, 418.73it/s] 67%|████████████████████████████████████████████████████████████████████████████▊                                      | 6503/9738 [00:19<00:07, 418.52it/s] 67%|█████████████████████████████████████████████████████████████████████████████▎                                     | 6545/9738 [00:19<00:07, 417.22it/s] 68%|█████████████████████████████████████████████████████████████████████████████▊                                     | 6587/9738 [00:19<00:07, 417.95it/s] 68%|██████████████████████████████████████████████████████████████████████████████▎                                    | 6630/9738 [00:19<00:07, 418.64it/s] 69%|██████████████████████████████████████████████████████████████████████████████▊                                    | 6673/9738 [00:19<00:07, 419.19it/s] 69%|███████████████████████████████████████████████████████████████████████████████▎                                   | 6715/9738 [00:19<00:07, 419.36it/s] 69%|███████████████████████████████████████████████████████████████████████████████▊                                   | 6758/9738 [00:19<00:07, 420.14it/s] 70%|████████████████████████████████████████████████████████████████████████████████▎                                  | 6801/9738 [00:19<00:07, 418.80it/s] 70%|████████████████████████████████████████████████████████████████████████████████▊                                  | 6843/9738 [00:19<00:06, 416.99it/s] 71%|█████████████████████████████████████████████████████████████████████████████████▎                                 | 6885/9738 [00:20<00:06, 417.82it/s] 71%|█████████████████████████████████████████████████████████████████████████████████▊                                 | 6927/9738 [00:20<00:06, 418.45it/s] 72%|██████████████████████████████████████████████████████████████████████████████████▎                                | 6969/9738 [00:20<00:06, 418.84it/s] 72%|██████████████████████████████████████████████████████████████████████████████████▊                                | 7011/9738 [00:20<00:06, 417.04it/s] 72%|███████████████████████████████████████████████████████████████████████████████████▎                               | 7054/9738 [00:20<00:06, 418.20it/s] 73%|███████████████████████████████████████████████████████████████████████████████████▊                               | 7097/9738 [00:20<00:06, 418.83it/s] 73%|████████████████████████████████████████████████████████████████████████████████████▎                              | 7140/9738 [00:20<00:06, 419.43it/s] 74%|████████████████████████████████████████████████████████████████████████████████████▊                              | 7183/9738 [00:20<00:06, 419.70it/s] 74%|█████████████████████████████████████████████████████████████████████████████████████▎                             | 7225/9738 [00:20<00:06, 414.68it/s] 75%|█████████████████████████████████████████████████████████████████████████████████████▊                             | 7268/9738 [00:20<00:05, 416.37it/s] 75%|██████████████████████████████████████████████████████████████████████████████████████▎                            | 7311/9738 [00:21<00:05, 417.50it/s] 76%|██████████████████████████████████████████████████████████████████████████████████████▊                            | 7354/9738 [00:21<00:05, 418.27it/s] 76%|███████████████████████████████████████████████████████████████████████████████████████▎                           | 7397/9738 [00:21<00:05, 418.78it/s] 76%|███████████████████████████████████████████████████████████████████████████████████████▊                           | 7439/9738 [00:21<00:05, 419.04it/s] 77%|████████████████████████████████████████████████████████████████████████████████████████▎                          | 7481/9738 [00:21<00:05, 383.45it/s] 77%|████████████████████████████████████████████████████████████████████████████████████████▊                          | 7523/9738 [00:21<00:05, 393.35it/s] 78%|█████████████████████████████████████████████████████████████████████████████████████████▎                         | 7566/9738 [00:21<00:05, 401.08it/s] 78%|█████████████████████████████████████████████████████████████████████████████████████████▊                         | 7608/9738 [00:21<00:05, 406.08it/s] 79%|██████████████████████████████████████████████████████████████████████████████████████████▎                        | 7650/9738 [00:21<00:05, 409.82it/s] 79%|██████████████████████████████████████████████████████████████████████████████████████████▊                        | 7692/9738 [00:22<00:04, 411.27it/s] 79%|███████████████████████████████████████████████████████████████████████████████████████████▎                       | 7735/9738 [00:22<00:04, 414.41it/s] 80%|███████████████████████████████████████████████████████████████████████████████████████████▊                       | 7777/9738 [00:22<00:04, 415.90it/s] 80%|████████████████████████████████████████████████████████████████████████████████████████████▎                      | 7820/9738 [00:22<00:04, 417.43it/s] 81%|████████████████████████████████████████████████████████████████████████████████████████████▊                      | 7863/9738 [00:22<00:04, 418.28it/s] 81%|█████████████████████████████████████████████████████████████████████████████████████████████▎                     | 7905/9738 [00:22<00:04, 417.63it/s] 82%|█████████████████████████████████████████████████████████████████████████████████████████████▊                     | 7948/9738 [00:22<00:04, 418.50it/s] 82%|██████████████████████████████████████████████████████████████████████████████████████████████▎                    | 7991/9738 [00:22<00:04, 419.09it/s] 82%|██████████████████████████████████████████████████████████████████████████████████████████████▊                    | 8033/9738 [00:22<00:04, 418.27it/s] 83%|███████████████████████████████████████████████████████████████████████████████████████████████▎                   | 8075/9738 [00:22<00:03, 418.48it/s] 83%|███████████████████████████████████████████████████████████████████████████████████████████████▊                   | 8118/9738 [00:23<00:03, 419.48it/s] 84%|████████████████████████████████████████████████████████████████████████████████████████████████▎                  | 8160/9738 [00:23<00:03, 418.30it/s] 84%|████████████████████████████████████████████████████████████████████████████████████████████████▊                  | 8203/9738 [00:23<00:03, 418.92it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████████████████▍                 | 8246/9738 [00:23<00:03, 419.35it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████████████████▉                 | 8288/9738 [00:23<00:03, 419.47it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████████████████▎                | 8330/9738 [00:23<00:03, 419.57it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████████████████▊                | 8372/9738 [00:23<00:03, 418.38it/s] 86%|███████████████████████████████████████████████████████████████████████████████████████████████████▎               | 8414/9738 [00:23<00:03, 418.52it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████████████████▊               | 8457/9738 [00:23<00:03, 419.16it/s] 87%|████████████████████████████████████████████████████████████████████████████████████████████████████▎              | 8499/9738 [00:23<00:02, 419.08it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████████████████▊              | 8541/9738 [00:24<00:02, 419.17it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████████████████▎             | 8583/9738 [00:24<00:02, 417.84it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████████████████▊             | 8625/9738 [00:24<00:02, 418.47it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████████████████▎            | 8667/9738 [00:24<00:02, 418.86it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████████████████▊            | 8710/9738 [00:24<00:02, 419.28it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████████████████████▎           | 8752/9738 [00:24<00:02, 419.25it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████████████████████▊           | 8794/9738 [00:24<00:02, 419.30it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████████████████▎          | 8836/9738 [00:24<00:02, 418.02it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████████████████▊          | 8879/9738 [00:24<00:02, 418.67it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▎         | 8922/9738 [00:24<00:01, 419.00it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▊         | 8964/9738 [00:25<00:01, 419.11it/s] 92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▎        | 9006/9738 [00:25<00:01, 419.33it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▊        | 9048/9738 [00:25<00:01, 418.03it/s] 93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▎       | 9090/9738 [00:25<00:01, 418.59it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▊       | 9132/9738 [00:25<00:01, 418.94it/s] 94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▎      | 9175/9738 [00:25<00:01, 419.25it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 9217/9738 [00:25<00:01, 419.28it/s] 95%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▎     | 9260/9738 [00:25<00:01, 419.54it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▊     | 9302/9738 [00:25<00:01, 418.21it/s] 96%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▎    | 9345/9738 [00:25<00:00, 418.99it/s] 96%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▊    | 9387/9738 [00:26<00:00, 418.61it/s] 97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▎   | 9429/9738 [00:26<00:00, 417.71it/s] 97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▊   | 9471/9738 [00:26<00:00, 418.26it/s] 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎  | 9513/9738 [00:26<00:00, 417.15it/s] 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊  | 9556/9738 [00:26<00:00, 418.07it/s] 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎ | 9599/9738 [00:26<00:00, 418.84it/s] 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊ | 9641/9738 [00:26<00:00, 419.11it/s] 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎| 9683/9738 [00:26<00:00, 419.29it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊| 9725/9738 [00:26<00:00, 417.58it/s]100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9738/9738 [00:26<00:00, 362.03it/s]
Load End
Num instances: 8
Loading checkpoint shards:   0%|                                                                                                       | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                                       | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                                       | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                                       | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███████████████████████████████▋                                                               | 1/3 [00:05<00:10,  5.06s/it]Loading checkpoint shards:  33%|███████████████████████████████▋                                                               | 1/3 [00:05<00:11,  5.52s/it]Loading checkpoint shards:  33%|███████████████████████████████▋                                                               | 1/3 [00:05<00:11,  5.68s/it]Loading checkpoint shards:  33%|███████████████████████████████▋                                                               | 1/3 [00:05<00:10,  5.17s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████████████████▎                               | 2/3 [00:11<00:05,  5.63s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████████████████▎                               | 2/3 [00:11<00:05,  5.50s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████████████████▎                               | 2/3 [00:11<00:05,  5.52s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████████████████▎                               | 2/3 [00:10<00:05,  5.08s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.05s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.15s/it]
Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  4.94s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.09s/it]
Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.48s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.65s/it]
[2023-08-07 13:59:48,278] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  4.89s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.07s/it]
[2023-08-07 14:00:07,331] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-07 14:00:07,332] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-07 14:00:07,333] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-07 14:00:07,333] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-07 14:00:07,333] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-07 14:00:07,333] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-07 14:00:07,333] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-07 14:00:07,333] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-07 14:00:07,333] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-07 14:00:07,333] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-07 14:00:07,333] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-07 14:00:07,333] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f554c3d1610>
[2023-08-07 14:00:07,333] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-07 14:00:07,334] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-07 14:00:07,334] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-07 14:00:07,334] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-07 14:00:07,334] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-07 14:00:07,334] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-07 14:00:07,334] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-07 14:00:07,334] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-07 14:00:07,334] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-07 14:00:07,334] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-07 14:00:07,334] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-07 14:00:07,334] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-07 14:00:07,334] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-07 14:00:07,334] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-07 14:00:07,334] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-07 14:00:07,334] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-07 14:00:07,334] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-07 14:00:07,334] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-07 14:00:07,334] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-07 14:00:07,334] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-07 14:00:07,334] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-07 14:00:07,334] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-07 14:00:07,334] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-07 14:00:07,334] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-07 14:00:07,334] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-07 14:00:07,334] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-07 14:00:07,334] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-07 14:00:07,334] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-07 14:00:07,334] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-07 14:00:07,334] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-07 14:00:07,334] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-07 14:00:07,334] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-07 14:00:07,334] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f554c3d1b80>
[2023-08-07 14:00:07,334] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-07 14:00:07,334] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-07 14:00:07,335] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-07 14:00:07,335] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-07 14:00:07,335] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-07 14:00:07,335] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-07 14:00:07,335] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-07 14:00:07,335] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-07 14:00:07,335] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-07 14:00:07,335] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-07 14:00:07,335] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-07 14:00:07,335] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-07 14:00:07,335] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-07 14:00:07,335] [INFO] [config.py:1012:print]   train_batch_size ............. 64
[2023-08-07 14:00:07,335] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  16
[2023-08-07 14:00:07,335] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-07 14:00:07,335] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-07 14:00:07,335] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-07 14:00:07,335] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-07 14:00:07,335] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-07 14:00:07,335] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-07 14:00:07,335] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-07 14:00:07,335] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 16, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.5969462394714355 seconds
Loading extension module utils...
Time to load utils op: 0.5051524639129639 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Loading extension module utils...
Time to load utils op: 0.4047811031341553 seconds
Evaluating commonsenseqa :   0%|                                                                                                       | 0/1 [00:00<?, ?it/s]############### Example ###############
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following multiple choice question.

### Demonstration:Input: He fantasied about getting a what while driving to work and the pros and cons of the extra responsibilities and benefits? Choices:  A: new car B: promotion C: boredom D: impatience E: pressure
Rationales: Step 1: Analyze the question - The question is asking about something that could come with both extra responsibilities and benefits. 

Step 2: Evaluate the options - Review all the given choices and consider which one fits best with the context of the question. 

Option A: new car - A new car wouldn't necessarily come with extra responsibilities and benefits in the context of fantasizing while driving to work. It's more of a material possession than a status or position.

Option B: promotion - A promotion at work would certainly come with extra responsibilities, as you would likely be expected to take on more tasks or duties. At the same time, a promotion would also come with benefits, such as a higher salary or more respect and prestige in the workplace. 

Option C: boredom - Boredom is a feeling, not something that one would fantasize about getting and it doesn't come with extra responsibilities or benefits.

Option D: impatience - Similar to boredom, impatience is a feeling, not something that one would fantasize about getting and it doesn't come with extra responsibilities or benefits.

Option E: pressure - Pressure is also a feeling or a state of stress, not something that one would typically fantasize about. Though it could potentially come with extra responsibilities, it doesn't inherently have benefits.

Step 3: Select the best fit - Based on the analysis of the question and the evaluation of the options, the best fit is B: promotion. This is because a promotion matches with the context of the question and it is the only option that clearly comes with both extra responsibilities and benefits.
Answer: B: promotion

Input: He was good at traditional science but excelled at social science, his favorite subject was what? Choices:  A: geography B: history studies C: math D: religion E: dancing
Rationales: Step 1: The question mentions that "he" excels in social science. This gives us a clue that the answer is a subject within the social sciences.
Step 2: Consider the choices provided. Social sciences include subjects like geography, history, political science, sociology, and anthropology. It does not include subjects like math, religion, or dancing. Therefore, we can rule out choices C, D, and E.
Step 3: Between the remaining choices, geography and history studies, there is no further information provided in the question that would favor geography. 
Step 4: Therefore, the answer must be B: history studies. This is the only remaining choice that fits with the information given in the question - that he excels in and presumably enjoys social science.
Answer: B: history studies

Input: Jan wasn't very good at studying.  What might help him study better? Choices:  A: having a bigger brain B: headaches C: inspiration D: more intelligence E: understanding
Rationales: Step 1: Understand the question. The question asks what might help Jan study better, indicating that the correct choice should be something that could potentially improve Jan's study skills or abilities.

Step 2: Evaluate each choice based on this understanding. 

Choice A: Having a bigger brain doesn't necessarily equate to better studying abilities. It's not the size of the brain that matters, but how it is used. 

Choice B: Headaches would likely hinder studying, not help it, as they can be distracting and painful.

Choice C: Inspiration could potentially help with motivation to study, but it doesn't necessarily improve one's ability to study or understand material.

Choice D: More intelligence could help Jan study better, as increased cognitive abilities could make it easier for him to understand and retain information. 

Choice E: Understanding is a result of studying, not necessarily something that can improve the act of studying itself. 

Step 3: Based on this evaluation, the best choice is D: More intelligence. This is because increased intelligence could directly improve Jan's ability to study and learn, making it the most logical answer to the question.
Answer: D: more intelligence

### Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid

### Response:
############### End ###############
Loading extension module utils...
Time to load utils op: 0.5053932666778564 seconds
Evaluating commonsenseqa : 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:18<00:00, 18.94s/it]Evaluating commonsenseqa : 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:18<00:00, 18.94s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 5.1242} | lm_loss 8.5135 | avg. gen lenth: 193.0
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 8 --num-workers 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 16 --seed 42 --data-dir /scratch/ylu130/processed_data/commonsenseqa/n4-seed42-rationalesTrue --rationales --num-in-domain 4
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-07 14:00:41,370] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/n4-seed42-rationalesTrue
  processed_data_dir ........... None
  num_eval ..................... 8
  num_in_domain ................ 4
  num_out_domain ............... None
  out_domain ................... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/t1-m512-i4-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 16
  clip_grad .................... 1.0
  seed ......................... 42
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                                                               | 0/9737 [00:00<?, ?it/s]  0%|▏                                                                                                                    | 17/9737 [00:00<00:57, 168.52it/s]  0%|▍                                                                                                                    | 34/9737 [00:00<00:57, 169.16it/s]  1%|▌                                                                                                                    | 52/9737 [00:00<00:57, 169.78it/s]  1%|▊                                                                                                                    | 69/9737 [00:00<00:56, 169.62it/s]  1%|█                                                                                                                    | 87/9737 [00:00<00:56, 169.79it/s]  1%|█▎                                                                                                                  | 105/9737 [00:00<00:56, 169.92it/s]  1%|█▍                                                                                                                  | 122/9737 [00:00<00:56, 169.75it/s]  1%|█▋                                                                                                                  | 140/9737 [00:00<00:56, 169.88it/s]  2%|█▉                                                                                                                  | 158/9737 [00:00<00:56, 169.99it/s]  2%|██                                                                                                                  | 175/9737 [00:01<00:56, 169.86it/s]  2%|██▎                                                                                                                 | 192/9737 [00:01<00:56, 169.71it/s]  2%|██▍                                                                                                                 | 209/9737 [00:01<00:56, 168.11it/s]  2%|██▋                                                                                                                 | 227/9737 [00:01<00:56, 168.85it/s]  3%|██▉                                                                                                                 | 244/9737 [00:01<00:56, 167.76it/s]  3%|███                                                                                                                 | 262/9737 [00:01<00:55, 170.13it/s]  3%|███▎                                                                                                                | 280/9737 [00:01<00:55, 171.90it/s]  3%|███▌                                                                                                                | 298/9737 [00:01<00:54, 173.07it/s]  3%|███▊                                                                                                                | 316/9737 [00:01<00:54, 173.87it/s]  3%|███▉                                                                                                                | 334/9737 [00:01<00:53, 174.45it/s]  4%|████▏                                                                                                               | 352/9737 [00:02<00:53, 174.83it/s]  4%|████▍                                                                                                               | 373/9737 [00:02<00:51, 183.47it/s]  4%|████▊                                                                                                               | 400/9737 [00:02<00:44, 208.72it/s]  4%|█████                                                                                                               | 427/9737 [00:02<00:41, 226.42it/s]  5%|█████▍                                                                                                              | 453/9737 [00:02<00:39, 234.51it/s]  5%|█████▋                                                                                                              | 480/9737 [00:02<00:37, 244.46it/s]  5%|██████                                                                                                              | 507/9737 [00:02<00:36, 251.67it/s]  5%|██████▎                                                                                                             | 534/9737 [00:02<00:35, 256.63it/s]  6%|██████▋                                                                                                             | 561/9737 [00:02<00:35, 260.12it/s]  6%|███████                                                                                                             | 588/9737 [00:02<00:34, 262.69it/s]  6%|███████▎                                                                                                            | 615/9737 [00:03<00:34, 264.45it/s]  7%|███████▋                                                                                                            | 642/9737 [00:03<00:34, 265.71it/s]  7%|███████▉                                                                                                            | 669/9737 [00:03<00:34, 265.07it/s]  7%|████████▎                                                                                                           | 696/9737 [00:03<00:33, 266.20it/s]  7%|████████▌                                                                                                           | 723/9737 [00:03<00:33, 266.32it/s]  8%|████████▉                                                                                                           | 750/9737 [00:03<00:33, 266.78it/s]  8%|█████████▎                                                                                                          | 777/9737 [00:03<00:33, 267.44it/s]  8%|█████████▌                                                                                                          | 804/9737 [00:03<00:33, 267.65it/s]  9%|█████████▉                                                                                                          | 831/9737 [00:03<00:33, 267.89it/s]  9%|██████████▏                                                                                                         | 858/9737 [00:03<00:33, 268.12it/s]  9%|██████████▌                                                                                                         | 885/9737 [00:04<00:33, 267.94it/s]  9%|██████████▊                                                                                                         | 912/9737 [00:04<00:33, 266.38it/s] 10%|███████████▏                                                                                                        | 939/9737 [00:04<00:32, 266.89it/s] 10%|███████████▌                                                                                                        | 966/9737 [00:04<00:32, 267.39it/s] 10%|███████████▊                                                                                                        | 993/9737 [00:04<00:32, 267.69it/s] 10%|████████████                                                                                                       | 1020/9737 [00:04<00:32, 267.94it/s] 11%|████████████▎                                                                                                      | 1047/9737 [00:04<00:32, 268.11it/s] 11%|████████████▋                                                                                                      | 1074/9737 [00:04<00:32, 267.40it/s] 11%|█████████████                                                                                                      | 1101/9737 [00:04<00:32, 267.15it/s] 12%|█████████████▎                                                                                                     | 1128/9737 [00:04<00:32, 265.80it/s] 12%|█████████████▋                                                                                                     | 1155/9737 [00:05<00:32, 266.67it/s] 12%|█████████████▉                                                                                                     | 1182/9737 [00:05<00:32, 267.18it/s] 12%|██████████████▎                                                                                                    | 1209/9737 [00:05<00:31, 267.20it/s] 13%|██████████████▌                                                                                                    | 1236/9737 [00:05<00:31, 267.42it/s] 13%|██████████████▉                                                                                                    | 1263/9737 [00:05<00:31, 267.63it/s] 13%|███████████████▏                                                                                                   | 1290/9737 [00:05<00:31, 267.60it/s] 14%|███████████████▌                                                                                                   | 1317/9737 [00:05<00:31, 267.61it/s] 14%|███████████████▊                                                                                                   | 1344/9737 [00:05<00:31, 265.86it/s] 14%|████████████████▏                                                                                                  | 1371/9737 [00:05<00:31, 266.47it/s] 14%|████████████████▌                                                                                                  | 1398/9737 [00:05<00:31, 266.71it/s] 15%|████████████████▊                                                                                                  | 1425/9737 [00:06<00:31, 264.90it/s] 15%|█████████████████▏                                                                                                 | 1452/9737 [00:06<00:31, 265.60it/s] 15%|█████████████████▍                                                                                                 | 1479/9737 [00:06<00:31, 266.14it/s] 15%|█████████████████▊                                                                                                 | 1506/9737 [00:06<00:30, 266.27it/s] 16%|██████████████████                                                                                                 | 1533/9737 [00:06<00:30, 266.67it/s] 16%|██████████████████▍                                                                                                | 1560/9737 [00:06<00:30, 267.17it/s] 16%|██████████████████▋                                                                                                | 1587/9737 [00:06<00:30, 265.45it/s] 17%|███████████████████                                                                                                | 1614/9737 [00:06<00:30, 265.91it/s] 17%|███████████████████▍                                                                                               | 1641/9737 [00:06<00:30, 266.36it/s] 17%|███████████████████▋                                                                                               | 1668/9737 [00:07<00:30, 266.44it/s] 17%|████████████████████                                                                                               | 1695/9737 [00:07<00:30, 266.27it/s] 18%|████████████████████▎                                                                                              | 1722/9737 [00:07<00:30, 266.45it/s] 18%|████████████████████▋                                                                                              | 1749/9737 [00:07<00:29, 266.76it/s] 18%|████████████████████▉                                                                                              | 1776/9737 [00:07<00:30, 264.60it/s] 19%|█████████████████████▎                                                                                             | 1803/9737 [00:07<00:33, 238.95it/s] 19%|█████████████████████▌                                                                                             | 1830/9737 [00:07<00:32, 246.70it/s] 19%|█████████████████████▉                                                                                             | 1857/9737 [00:07<00:31, 252.36it/s] 19%|██████████████████████▎                                                                                            | 1884/9737 [00:07<00:30, 256.54it/s] 20%|██████████████████████▌                                                                                            | 1911/9737 [00:07<00:30, 259.51it/s] 20%|██████████████████████▉                                                                                            | 1938/9737 [00:08<00:29, 261.42it/s] 20%|███████████████████████▏                                                                                           | 1965/9737 [00:08<00:29, 262.92it/s] 20%|███████████████████████▌                                                                                           | 1992/9737 [00:08<00:29, 264.25it/s] 21%|███████████████████████▊                                                                                           | 2019/9737 [00:08<00:29, 265.16it/s] 21%|████████████████████████▏                                                                                          | 2046/9737 [00:08<00:29, 263.95it/s] 21%|████████████████████████▍                                                                                          | 2073/9737 [00:08<00:28, 264.70it/s] 22%|████████████████████████▊                                                                                          | 2100/9737 [00:08<00:28, 263.88it/s] 22%|█████████████████████████                                                                                          | 2127/9737 [00:08<00:28, 264.69it/s] 22%|█████████████████████████▍                                                                                         | 2154/9737 [00:08<00:28, 265.25it/s] 22%|█████████████████████████▊                                                                                         | 2181/9737 [00:08<00:28, 265.86it/s] 23%|██████████████████████████                                                                                         | 2208/9737 [00:09<00:28, 266.26it/s] 23%|██████████████████████████▍                                                                                        | 2235/9737 [00:09<00:28, 266.52it/s] 23%|██████████████████████████▋                                                                                        | 2262/9737 [00:09<00:28, 264.74it/s] 24%|███████████████████████████                                                                                        | 2289/9737 [00:09<00:28, 265.47it/s] 24%|███████████████████████████▎                                                                                       | 2316/9737 [00:09<00:27, 265.87it/s] 24%|███████████████████████████▋                                                                                       | 2343/9737 [00:09<00:27, 266.07it/s] 24%|███████████████████████████▉                                                                                       | 2370/9737 [00:09<00:27, 266.28it/s] 25%|████████████████████████████▎                                                                                      | 2397/9737 [00:09<00:27, 266.51it/s] 25%|████████████████████████████▋                                                                                      | 2424/9737 [00:09<00:27, 266.69it/s] 25%|████████████████████████████▉                                                                                      | 2451/9737 [00:09<00:27, 266.69it/s] 25%|█████████████████████████████▎                                                                                     | 2478/9737 [00:10<00:27, 264.50it/s] 26%|█████████████████████████████▌                                                                                     | 2505/9737 [00:10<00:27, 265.01it/s] 26%|█████████████████████████████▉                                                                                     | 2532/9737 [00:10<00:27, 265.39it/s] 26%|██████████████████████████████▏                                                                                    | 2559/9737 [00:10<00:27, 265.60it/s] 27%|██████████████████████████████▌                                                                                    | 2586/9737 [00:10<00:26, 266.07it/s] 27%|██████████████████████████████▊                                                                                    | 2613/9737 [00:10<00:26, 266.38it/s] 27%|███████████████████████████████▏                                                                                   | 2640/9737 [00:10<00:26, 266.46it/s] 27%|███████████████████████████████▍                                                                                   | 2667/9737 [00:10<00:26, 266.65it/s] 28%|███████████████████████████████▊                                                                                   | 2694/9737 [00:10<00:26, 266.48it/s] 28%|████████████████████████████████▏                                                                                  | 2721/9737 [00:11<00:26, 264.68it/s] 28%|████████████████████████████████▍                                                                                  | 2748/9737 [00:11<00:26, 265.28it/s] 28%|████████████████████████████████▊                                                                                  | 2775/9737 [00:11<00:26, 265.41it/s] 29%|█████████████████████████████████                                                                                  | 2802/9737 [00:11<00:26, 265.68it/s] 29%|█████████████████████████████████▍                                                                                 | 2829/9737 [00:11<00:25, 265.89it/s] 29%|█████████████████████████████████▋                                                                                 | 2856/9737 [00:11<00:25, 266.14it/s] 30%|██████████████████████████████████                                                                                 | 2883/9737 [00:11<00:25, 266.30it/s] 30%|██████████████████████████████████▎                                                                                | 2910/9737 [00:11<00:25, 266.42it/s] 30%|██████████████████████████████████▋                                                                                | 2937/9737 [00:11<00:25, 264.51it/s] 30%|███████████████████████████████████                                                                                | 2964/9737 [00:11<00:25, 265.04it/s] 31%|███████████████████████████████████▎                                                                               | 2991/9737 [00:12<00:25, 264.65it/s] 31%|███████████████████████████████████▋                                                                               | 3018/9737 [00:12<00:25, 264.22it/s] 31%|███████████████████████████████████▉                                                                               | 3045/9737 [00:12<00:25, 264.56it/s] 32%|████████████████████████████████████▎                                                                              | 3072/9737 [00:12<00:25, 264.81it/s] 32%|████████████████████████████████████▌                                                                              | 3099/9737 [00:12<00:25, 265.28it/s] 32%|████████████████████████████████████▉                                                                              | 3126/9737 [00:12<00:24, 265.71it/s] 32%|█████████████████████████████████████▏                                                                             | 3153/9737 [00:12<00:24, 265.80it/s] 33%|█████████████████████████████████████▌                                                                             | 3180/9737 [00:12<00:24, 264.11it/s] 33%|█████████████████████████████████████▉                                                                             | 3207/9737 [00:12<00:24, 264.94it/s] 33%|██████████████████████████████████████▏                                                                            | 3234/9737 [00:12<00:24, 265.56it/s] 33%|██████████████████████████████████████▌                                                                            | 3261/9737 [00:13<00:24, 266.00it/s] 34%|██████████████████████████████████████▊                                                                            | 3288/9737 [00:13<00:24, 266.18it/s] 34%|███████████████████████████████████████▏                                                                           | 3315/9737 [00:13<00:24, 266.35it/s] 34%|███████████████████████████████████████▍                                                                           | 3342/9737 [00:13<00:24, 266.32it/s] 35%|███████████████████████████████████████▊                                                                           | 3369/9737 [00:13<00:23, 266.45it/s] 35%|████████████████████████████████████████                                                                           | 3396/9737 [00:13<00:23, 264.89it/s] 35%|████████████████████████████████████████▍                                                                          | 3423/9737 [00:13<00:23, 265.48it/s] 35%|████████████████████████████████████████▋                                                                          | 3450/9737 [00:13<00:23, 265.43it/s] 36%|█████████████████████████████████████████                                                                          | 3477/9737 [00:13<00:23, 265.79it/s] 36%|█████████████████████████████████████████▍                                                                         | 3504/9737 [00:13<00:23, 265.80it/s] 36%|█████████████████████████████████████████▋                                                                         | 3531/9737 [00:14<00:23, 265.94it/s] 37%|██████████████████████████████████████████                                                                         | 3558/9737 [00:14<00:23, 265.56it/s] 37%|██████████████████████████████████████████▎                                                                        | 3585/9737 [00:14<00:23, 265.79it/s] 37%|██████████████████████████████████████████▋                                                                        | 3612/9737 [00:14<00:23, 264.00it/s] 37%|██████████████████████████████████████████▉                                                                        | 3639/9737 [00:14<00:23, 264.90it/s] 38%|███████████████████████████████████████████▎                                                                       | 3666/9737 [00:14<00:22, 265.34it/s] 38%|███████████████████████████████████████████▌                                                                       | 3693/9737 [00:14<00:22, 265.88it/s] 38%|███████████████████████████████████████████▉                                                                       | 3720/9737 [00:14<00:22, 266.28it/s] 38%|████████████████████████████████████████████▎                                                                      | 3747/9737 [00:14<00:22, 266.54it/s] 39%|████████████████████████████████████████████▌                                                                      | 3774/9737 [00:14<00:22, 266.74it/s] 39%|████████████████████████████████████████████▉                                                                      | 3801/9737 [00:15<00:22, 266.69it/s] 39%|█████████████████████████████████████████████▏                                                                     | 3828/9737 [00:15<00:22, 266.81it/s] 40%|█████████████████████████████████████████████▌                                                                     | 3855/9737 [00:15<00:22, 265.11it/s] 40%|█████████████████████████████████████████████▊                                                                     | 3882/9737 [00:15<00:22, 265.70it/s] 40%|██████████████████████████████████████████████▏                                                                    | 3909/9737 [00:15<00:21, 264.94it/s] 40%|██████████████████████████████████████████████▍                                                                    | 3936/9737 [00:15<00:21, 265.37it/s] 41%|██████████████████████████████████████████████▊                                                                    | 3963/9737 [00:15<00:21, 265.54it/s] 41%|███████████████████████████████████████████████                                                                    | 3990/9737 [00:15<00:21, 265.69it/s] 41%|███████████████████████████████████████████████▍                                                                   | 4017/9737 [00:15<00:21, 266.08it/s] 42%|███████████████████████████████████████████████▊                                                                   | 4044/9737 [00:15<00:21, 266.27it/s] 42%|████████████████████████████████████████████████                                                                   | 4071/9737 [00:16<00:21, 264.57it/s] 42%|████████████████████████████████████████████████▍                                                                  | 4098/9737 [00:16<00:21, 264.84it/s] 42%|████████████████████████████████████████████████▋                                                                  | 4125/9737 [00:16<00:21, 265.26it/s] 43%|█████████████████████████████████████████████████                                                                  | 4152/9737 [00:16<00:21, 265.44it/s] 43%|█████████████████████████████████████████████████▎                                                                 | 4179/9737 [00:16<00:21, 257.90it/s] 43%|█████████████████████████████████████████████████▋                                                                 | 4206/9737 [00:16<00:21, 260.42it/s] 43%|█████████████████████████████████████████████████▉                                                                 | 4233/9737 [00:16<00:20, 262.29it/s] 44%|██████████████████████████████████████████████████▎                                                                | 4260/9737 [00:16<00:20, 263.66it/s] 44%|██████████████████████████████████████████████████▋                                                                | 4287/9737 [00:16<00:20, 264.65it/s] 44%|██████████████████████████████████████████████████▉                                                                | 4314/9737 [00:17<00:20, 263.53it/s] 45%|███████████████████████████████████████████████████▎                                                               | 4341/9737 [00:17<00:20, 262.19it/s] 45%|███████████████████████████████████████████████████▌                                                               | 4368/9737 [00:17<00:20, 263.32it/s] 45%|███████████████████████████████████████████████████▉                                                               | 4395/9737 [00:17<00:20, 264.27it/s] 45%|████████████████████████████████████████████████████▏                                                              | 4422/9737 [00:17<00:20, 264.66it/s] 46%|████████████████████████████████████████████████████▌                                                              | 4449/9737 [00:17<00:19, 265.11it/s] 46%|████████████████████████████████████████████████████▊                                                              | 4476/9737 [00:17<00:19, 265.35it/s] 46%|█████████████████████████████████████████████████████▏                                                             | 4503/9737 [00:17<00:19, 265.66it/s] 47%|█████████████████████████████████████████████████████▌                                                             | 4530/9737 [00:17<00:21, 243.33it/s] 47%|█████████████████████████████████████████████████████▊                                                             | 4557/9737 [00:17<00:20, 249.76it/s] 47%|██████████████████████████████████████████████████████▏                                                            | 4584/9737 [00:18<00:20, 254.26it/s] 47%|██████████████████████████████████████████████████████▍                                                            | 4611/9737 [00:18<00:19, 257.17it/s] 48%|██████████████████████████████████████████████████████▊                                                            | 4638/9737 [00:18<00:19, 259.77it/s] 48%|███████████████████████████████████████████████████████                                                            | 4665/9737 [00:18<00:19, 261.38it/s] 48%|███████████████████████████████████████████████████████▍                                                           | 4692/9737 [00:18<00:19, 262.70it/s] 48%|███████████████████████████████████████████████████████▋                                                           | 4719/9737 [00:18<00:19, 263.58it/s] 49%|████████████████████████████████████████████████████████                                                           | 4746/9737 [00:18<00:27, 181.87it/s] 49%|████████████████████████████████████████████████████████▎                                                          | 4773/9737 [00:18<00:24, 200.62it/s] 49%|████████████████████████████████████████████████████████▋                                                          | 4800/9737 [00:19<00:22, 216.27it/s] 50%|█████████████████████████████████████████████████████████                                                          | 4827/9737 [00:19<00:21, 229.00it/s] 50%|█████████████████████████████████████████████████████████▎                                                         | 4854/9737 [00:19<00:20, 238.66it/s] 50%|█████████████████████████████████████████████████████████▋                                                         | 4881/9737 [00:19<00:19, 245.78it/s] 50%|█████████████████████████████████████████████████████████▉                                                         | 4908/9737 [00:19<00:19, 251.21it/s] 51%|██████████████████████████████████████████████████████████▎                                                        | 4935/9737 [00:19<00:18, 255.25it/s] 51%|██████████████████████████████████████████████████████████▌                                                        | 4962/9737 [00:19<00:18, 256.38it/s] 51%|██████████████████████████████████████████████████████████▉                                                        | 4989/9737 [00:19<00:18, 258.62it/s] 52%|███████████████████████████████████████████████████████████▏                                                       | 5016/9737 [00:19<00:18, 260.75it/s] 52%|███████████████████████████████████████████████████████████▌                                                       | 5043/9737 [00:19<00:17, 262.29it/s] 52%|███████████████████████████████████████████████████████████▉                                                       | 5070/9737 [00:20<00:17, 263.27it/s] 52%|████████████████████████████████████████████████████████████▏                                                      | 5097/9737 [00:20<00:17, 263.72it/s] 53%|████████████████████████████████████████████████████████████▌                                                      | 5124/9737 [00:20<00:17, 264.24it/s] 53%|████████████████████████████████████████████████████████████▊                                                      | 5151/9737 [00:20<00:17, 264.73it/s] 53%|█████████████████████████████████████████████████████████████▏                                                     | 5178/9737 [00:20<00:17, 263.37it/s] 53%|█████████████████████████████████████████████████████████████▍                                                     | 5205/9737 [00:20<00:17, 261.69it/s] 54%|█████████████████████████████████████████████████████████████▊                                                     | 5232/9737 [00:20<00:17, 262.87it/s] 54%|██████████████████████████████████████████████████████████████                                                     | 5259/9737 [00:20<00:17, 262.91it/s] 54%|██████████████████████████████████████████████████████████████▍                                                    | 5286/9737 [00:20<00:16, 263.83it/s] 55%|██████████████████████████████████████████████████████████████▋                                                    | 5313/9737 [00:20<00:16, 264.30it/s] 55%|███████████████████████████████████████████████████████████████                                                    | 5340/9737 [00:21<00:16, 264.57it/s] 55%|███████████████████████████████████████████████████████████████▍                                                   | 5367/9737 [00:21<00:16, 265.00it/s] 55%|███████████████████████████████████████████████████████████████▋                                                   | 5394/9737 [00:21<00:16, 265.17it/s] 56%|████████████████████████████████████████████████████████████████                                                   | 5421/9737 [00:21<00:16, 263.69it/s] 56%|████████████████████████████████████████████████████████████████▎                                                  | 5448/9737 [00:21<00:16, 264.43it/s] 56%|████████████████████████████████████████████████████████████████▋                                                  | 5475/9737 [00:21<00:16, 265.15it/s] 57%|████████████████████████████████████████████████████████████████▉                                                  | 5503/9737 [00:21<00:15, 267.66it/s] 57%|█████████████████████████████████████████████████████████████████▎                                                 | 5531/9737 [00:21<00:15, 269.65it/s] 57%|█████████████████████████████████████████████████████████████████▋                                                 | 5559/9737 [00:21<00:15, 271.11it/s] 57%|█████████████████████████████████████████████████████████████████▉                                                 | 5587/9737 [00:22<00:15, 271.61it/s] 58%|██████████████████████████████████████████████████████████████████▎                                                | 5615/9737 [00:22<00:15, 272.39it/s] 58%|██████████████████████████████████████████████████████████████████▋                                                | 5643/9737 [00:22<00:15, 268.25it/s] 58%|██████████████████████████████████████████████████████████████████▉                                                | 5671/9737 [00:22<00:15, 270.02it/s] 59%|███████████████████████████████████████████████████████████████████▎                                               | 5699/9737 [00:22<00:14, 271.03it/s] 59%|███████████████████████████████████████████████████████████████████▋                                               | 5727/9737 [00:22<00:14, 271.98it/s] 59%|███████████████████████████████████████████████████████████████████▉                                               | 5755/9737 [00:22<00:14, 272.54it/s] 59%|████████████████████████████████████████████████████████████████████▎                                              | 5783/9737 [00:22<00:14, 273.06it/s] 60%|████████████████████████████████████████████████████████████████████▋                                              | 5811/9737 [00:22<00:14, 273.24it/s] 60%|████████████████████████████████████████████████████████████████████▉                                              | 5839/9737 [00:22<00:14, 273.46it/s] 60%|█████████████████████████████████████████████████████████████████████▎                                             | 5867/9737 [00:23<00:14, 271.61it/s] 61%|█████████████████████████████████████████████████████████████████████▌                                             | 5895/9737 [00:23<00:14, 272.23it/s] 61%|█████████████████████████████████████████████████████████████████████▉                                             | 5923/9737 [00:23<00:13, 272.82it/s] 61%|██████████████████████████████████████████████████████████████████████▎                                            | 5951/9737 [00:23<00:13, 273.45it/s] 61%|██████████████████████████████████████████████████████████████████████▌                                            | 5979/9737 [00:23<00:13, 273.78it/s] 62%|██████████████████████████████████████████████████████████████████████▉                                            | 6007/9737 [00:23<00:13, 273.89it/s] 62%|███████████████████████████████████████████████████████████████████████▎                                           | 6035/9737 [00:23<00:13, 273.98it/s] 62%|███████████████████████████████████████████████████████████████████████▌                                           | 6063/9737 [00:23<00:13, 273.87it/s] 63%|███████████████████████████████████████████████████████████████████████▉                                           | 6091/9737 [00:23<00:13, 272.10it/s] 63%|████████████████████████████████████████████████████████████████████████▎                                          | 6119/9737 [00:23<00:13, 269.60it/s] 63%|████████████████████████████████████████████████████████████████████████▌                                          | 6147/9737 [00:24<00:13, 270.49it/s] 63%|████████████████████████████████████████████████████████████████████████▉                                          | 6175/9737 [00:24<00:13, 271.52it/s] 64%|█████████████████████████████████████████████████████████████████████████▎                                         | 6203/9737 [00:24<00:13, 271.68it/s] 64%|█████████████████████████████████████████████████████████████████████████▌                                         | 6231/9737 [00:24<00:12, 272.11it/s] 64%|█████████████████████████████████████████████████████████████████████████▉                                         | 6259/9737 [00:24<00:12, 272.56it/s] 65%|██████████████████████████████████████████████████████████████████████████▎                                        | 6287/9737 [00:24<00:12, 273.06it/s] 65%|██████████████████████████████████████████████████████████████████████████▌                                        | 6315/9737 [00:24<00:12, 271.54it/s] 65%|██████████████████████████████████████████████████████████████████████████▉                                        | 6343/9737 [00:24<00:12, 272.27it/s] 65%|███████████████████████████████████████████████████████████████████████████▏                                       | 6371/9737 [00:24<00:12, 272.76it/s] 66%|███████████████████████████████████████████████████████████████████████████▌                                       | 6399/9737 [00:24<00:12, 273.19it/s] 66%|███████████████████████████████████████████████████████████████████████████▉                                       | 6427/9737 [00:25<00:12, 273.42it/s] 66%|████████████████████████████████████████████████████████████████████████████▏                                      | 6455/9737 [00:25<00:12, 273.34it/s] 67%|████████████████████████████████████████████████████████████████████████████▌                                      | 6483/9737 [00:25<00:11, 273.59it/s] 67%|████████████████████████████████████████████████████████████████████████████▉                                      | 6511/9737 [00:25<00:11, 273.59it/s] 67%|█████████████████████████████████████████████████████████████████████████████▏                                     | 6539/9737 [00:25<00:11, 271.99it/s] 67%|█████████████████████████████████████████████████████████████████████████████▌                                     | 6567/9737 [00:25<00:11, 272.41it/s] 68%|█████████████████████████████████████████████████████████████████████████████▉                                     | 6595/9737 [00:25<00:11, 271.68it/s] 68%|██████████████████████████████████████████████████████████████████████████████▏                                    | 6623/9737 [00:25<00:11, 272.18it/s] 68%|██████████████████████████████████████████████████████████████████████████████▌                                    | 6651/9737 [00:25<00:11, 272.89it/s] 69%|██████████████████████████████████████████████████████████████████████████████▉                                    | 6679/9737 [00:26<00:11, 273.24it/s] 69%|███████████████████████████████████████████████████████████████████████████████▏                                   | 6707/9737 [00:26<00:11, 273.32it/s] 69%|███████████████████████████████████████████████████████████████████████████████▌                                   | 6735/9737 [00:26<00:11, 272.87it/s] 69%|███████████████████████████████████████████████████████████████████████████████▉                                   | 6763/9737 [00:26<00:10, 273.40it/s] 70%|████████████████████████████████████████████████████████████████████████████████▏                                  | 6791/9737 [00:26<00:10, 271.84it/s] 70%|████████████████████████████████████████████████████████████████████████████████▌                                  | 6819/9737 [00:26<00:10, 272.46it/s] 70%|████████████████████████████████████████████████████████████████████████████████▊                                  | 6847/9737 [00:26<00:10, 272.90it/s] 71%|█████████████████████████████████████████████████████████████████████████████████▏                                 | 6875/9737 [00:26<00:10, 273.20it/s] 71%|█████████████████████████████████████████████████████████████████████████████████▌                                 | 6903/9737 [00:26<00:10, 273.05it/s] 71%|█████████████████████████████████████████████████████████████████████████████████▊                                 | 6931/9737 [00:26<00:10, 273.48it/s] 71%|██████████████████████████████████████████████████████████████████████████████████▏                                | 6959/9737 [00:27<00:10, 273.85it/s] 72%|██████████████████████████████████████████████████████████████████████████████████▌                                | 6987/9737 [00:27<00:10, 273.98it/s] 72%|██████████████████████████████████████████████████████████████████████████████████▊                                | 7015/9737 [00:27<00:10, 272.03it/s] 72%|███████████████████████████████████████████████████████████████████████████████████▏                               | 7043/9737 [00:27<00:09, 272.75it/s] 73%|███████████████████████████████████████████████████████████████████████████████████▌                               | 7071/9737 [00:27<00:09, 272.88it/s] 73%|███████████████████████████████████████████████████████████████████████████████████▊                               | 7099/9737 [00:27<00:09, 272.86it/s] 73%|████████████████████████████████████████████████████████████████████████████████████▏                              | 7127/9737 [00:27<00:09, 271.93it/s] 73%|████████████████████████████████████████████████████████████████████████████████████▌                              | 7155/9737 [00:27<00:09, 272.38it/s] 74%|████████████████████████████████████████████████████████████████████████████████████▊                              | 7183/9737 [00:27<00:09, 272.92it/s] 74%|█████████████████████████████████████████████████████████████████████████████████████▏                             | 7211/9737 [00:27<00:09, 273.25it/s] 74%|█████████████████████████████████████████████████████████████████████████████████████▍                             | 7239/9737 [00:28<00:09, 271.79it/s] 75%|█████████████████████████████████████████████████████████████████████████████████████▊                             | 7267/9737 [00:28<00:09, 272.42it/s] 75%|██████████████████████████████████████████████████████████████████████████████████████▏                            | 7295/9737 [00:28<00:09, 270.89it/s] 75%|██████████████████████████████████████████████████████████████████████████████████████▍                            | 7323/9737 [00:28<00:08, 271.83it/s] 75%|██████████████████████████████████████████████████████████████████████████████████████▊                            | 7351/9737 [00:28<00:08, 272.68it/s] 76%|███████████████████████████████████████████████████████████████████████████████████████▏                           | 7379/9737 [00:28<00:08, 273.29it/s] 76%|███████████████████████████████████████████████████████████████████████████████████████▍                           | 7407/9737 [00:28<00:08, 273.63it/s] 76%|███████████████████████████████████████████████████████████████████████████████████████▊                           | 7435/9737 [00:28<00:08, 272.86it/s] 77%|████████████████████████████████████████████████████████████████████████████████████████▏                          | 7463/9737 [00:28<00:09, 246.42it/s] 77%|████████████████████████████████████████████████████████████████████████████████████████▍                          | 7491/9737 [00:29<00:08, 254.04it/s] 77%|████████████████████████████████████████████████████████████████████████████████████████▊                          | 7519/9737 [00:29<00:08, 259.42it/s] 78%|█████████████████████████████████████████████████████████████████████████████████████████▏                         | 7547/9737 [00:29<00:08, 263.25it/s] 78%|█████████████████████████████████████████████████████████████████████████████████████████▍                         | 7575/9737 [00:29<00:08, 266.49it/s] 78%|█████████████████████████████████████████████████████████████████████████████████████████▊                         | 7603/9737 [00:29<00:07, 268.64it/s] 78%|██████████████████████████████████████████████████████████████████████████████████████████▏                        | 7631/9737 [00:29<00:07, 270.19it/s] 79%|██████████████████████████████████████████████████████████████████████████████████████████▍                        | 7659/9737 [00:29<00:07, 271.27it/s] 79%|██████████████████████████████████████████████████████████████████████████████████████████▊                        | 7687/9737 [00:29<00:07, 270.03it/s] 79%|███████████████████████████████████████████████████████████████████████████████████████████                        | 7715/9737 [00:29<00:07, 271.21it/s] 80%|███████████████████████████████████████████████████████████████████████████████████████████▍                       | 7743/9737 [00:29<00:07, 271.97it/s] 80%|███████████████████████████████████████████████████████████████████████████████████████████▊                       | 7771/9737 [00:30<00:07, 272.43it/s] 80%|████████████████████████████████████████████████████████████████████████████████████████████                       | 7799/9737 [00:30<00:07, 272.82it/s] 80%|████████████████████████████████████████████████████████████████████████████████████████████▍                      | 7827/9737 [00:30<00:07, 272.72it/s] 81%|████████████████████████████████████████████████████████████████████████████████████████████▊                      | 7855/9737 [00:30<00:06, 273.26it/s] 81%|█████████████████████████████████████████████████████████████████████████████████████████████                      | 7883/9737 [00:30<00:06, 273.44it/s] 81%|█████████████████████████████████████████████████████████████████████████████████████████████▍                     | 7911/9737 [00:30<00:06, 272.22it/s] 82%|█████████████████████████████████████████████████████████████████████████████████████████████▊                     | 7939/9737 [00:30<00:06, 272.60it/s] 82%|██████████████████████████████████████████████████████████████████████████████████████████████                     | 7967/9737 [00:30<00:06, 273.16it/s] 82%|██████████████████████████████████████████████████████████████████████████████████████████████▍                    | 7995/9737 [00:30<00:06, 273.42it/s] 82%|██████████████████████████████████████████████████████████████████████████████████████████████▊                    | 8023/9737 [00:30<00:06, 273.61it/s] 83%|███████████████████████████████████████████████████████████████████████████████████████████████                    | 8051/9737 [00:31<00:06, 273.49it/s] 83%|███████████████████████████████████████████████████████████████████████████████████████████████▍                   | 8079/9737 [00:31<00:06, 273.77it/s] 83%|███████████████████████████████████████████████████████████████████████████████████████████████▋                   | 8107/9737 [00:31<00:05, 274.18it/s] 84%|████████████████████████████████████████████████████████████████████████████████████████████████                   | 8135/9737 [00:31<00:05, 272.66it/s] 84%|████████████████████████████████████████████████████████████████████████████████████████████████▍                  | 8163/9737 [00:31<00:05, 273.14it/s] 84%|████████████████████████████████████████████████████████████████████████████████████████████████▋                  | 8191/9737 [00:31<00:05, 273.35it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████████████████                  | 8219/9737 [00:31<00:05, 273.58it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████████████████▍                 | 8247/9737 [00:31<00:05, 273.32it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████████████████▋                 | 8275/9737 [00:31<00:05, 273.56it/s] 85%|██████████████████████████████████████████████████████████████████████████████████████████████████                 | 8303/9737 [00:31<00:05, 273.64it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                | 8331/9737 [00:32<00:05, 273.94it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████████████████▋                | 8359/9737 [00:32<00:05, 272.19it/s] 86%|███████████████████████████████████████████████████████████████████████████████████████████████████                | 8387/9737 [00:32<00:04, 272.47it/s] 86%|███████████████████████████████████████████████████████████████████████████████████████████████████▍               | 8415/9737 [00:32<00:04, 272.91it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████████████████▋               | 8443/9737 [00:32<00:04, 273.03it/s] 87%|████████████████████████████████████████████████████████████████████████████████████████████████████               | 8471/9737 [00:32<00:04, 272.95it/s] 87%|████████████████████████████████████████████████████████████████████████████████████████████████████▍              | 8499/9737 [00:32<00:04, 273.24it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████████████████▋              | 8527/9737 [00:32<00:04, 273.15it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████████████████              | 8555/9737 [00:32<00:04, 273.17it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████████████████▎             | 8583/9737 [00:33<00:04, 271.30it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████████████████▋             | 8611/9737 [00:33<00:04, 271.55it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████████████████             | 8639/9737 [00:33<00:04, 271.08it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████████████████▎            | 8667/9737 [00:33<00:03, 270.96it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████████████████▋            | 8695/9737 [00:33<00:03, 268.84it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████████████████████            | 8722/9737 [00:33<00:03, 266.76it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████████████████████▎           | 8750/9737 [00:33<00:03, 267.99it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████████████████████▋           | 8778/9737 [00:33<00:03, 268.91it/s] 90%|████████████████████████████████████████████████████████████████████████████████████████████████████████           | 8806/9737 [00:33<00:03, 269.78it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████████████████▎          | 8833/9737 [00:33<00:03, 268.59it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████████████████▋          | 8860/9737 [00:34<00:03, 268.85it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████████████████▉          | 8888/9737 [00:34<00:03, 269.78it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▎         | 8915/9737 [00:34<00:03, 269.62it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▌         | 8943/9737 [00:34<00:02, 270.57it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▉         | 8971/9737 [00:34<00:02, 270.95it/s] 92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▎        | 8999/9737 [00:34<00:02, 271.54it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▌        | 9027/9737 [00:34<00:02, 272.03it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▉        | 9055/9737 [00:34<00:02, 270.41it/s] 93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▎       | 9083/9737 [00:34<00:02, 270.60it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▌       | 9111/9737 [00:34<00:02, 271.09it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉       | 9139/9737 [00:35<00:02, 271.39it/s] 94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▎      | 9167/9737 [00:35<00:02, 271.62it/s] 94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▌      | 9195/9737 [00:35<00:01, 271.99it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▉      | 9223/9737 [00:35<00:01, 272.18it/s] 95%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▎     | 9251/9737 [00:35<00:01, 272.45it/s] 95%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▌     | 9279/9737 [00:35<00:01, 270.82it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▉     | 9307/9737 [00:35<00:01, 271.54it/s] 96%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▎    | 9335/9737 [00:35<00:01, 271.81it/s] 96%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▌    | 9363/9737 [00:35<00:01, 272.02it/s] 96%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▉    | 9391/9737 [00:36<00:01, 272.28it/s] 97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏   | 9419/9737 [00:36<00:01, 272.42it/s] 97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▌   | 9447/9737 [00:36<00:01, 272.47it/s] 97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▉   | 9475/9737 [00:36<00:00, 272.38it/s] 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏  | 9503/9737 [00:36<00:00, 270.94it/s] 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌  | 9531/9737 [00:36<00:00, 271.62it/s] 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉  | 9559/9737 [00:36<00:00, 272.09it/s] 98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏ | 9587/9737 [00:36<00:00, 272.17it/s] 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌ | 9615/9737 [00:36<00:00, 271.65it/s] 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉ | 9643/9737 [00:36<00:00, 271.81it/s] 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏| 9671/9737 [00:37<00:00, 271.99it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌| 9699/9737 [00:37<00:00, 272.04it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉| 9727/9737 [00:37<00:00, 270.45it/s]100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9737/9737 [00:37<00:00, 261.18it/s]
Load End
Num instances: 8
Loading checkpoint shards:   0%|                                                                                                       | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                                       | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                                       | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                                       | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███████████████████████████████▋                                                               | 1/3 [00:05<00:11,  5.70s/it]Loading checkpoint shards:  33%|███████████████████████████████▋                                                               | 1/3 [00:05<00:11,  5.67s/it]Loading checkpoint shards:  33%|███████████████████████████████▋                                                               | 1/3 [00:05<00:11,  6.00s/it]Loading checkpoint shards:  33%|███████████████████████████████▋                                                               | 1/3 [00:06<00:12,  6.46s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████████████████▎                               | 2/3 [00:11<00:06,  6.00s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████████████████▎                               | 2/3 [00:11<00:05,  5.62s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████████████████▎                               | 2/3 [00:11<00:05,  5.88s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████████████████▎                               | 2/3 [00:13<00:06,  6.70s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:16<00:00,  5.19s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:16<00:00,  5.38s/it]
Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.08s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.23s/it]
[2023-08-07 14:02:13,188] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:16<00:00,  5.27s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:16<00:00,  5.45s/it]
Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:17<00:00,  5.42s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:17<00:00,  5.74s/it]
[2023-08-07 14:02:31,748] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-07 14:02:31,749] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-07 14:02:31,750] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-07 14:02:31,750] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-07 14:02:31,750] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-07 14:02:31,750] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-07 14:02:31,750] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-07 14:02:31,751] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-07 14:02:31,751] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-07 14:02:31,751] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-07 14:02:31,751] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-07 14:02:31,751] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fe0ffb87670>
[2023-08-07 14:02:31,751] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-07 14:02:31,751] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-07 14:02:31,751] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-07 14:02:31,751] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-07 14:02:31,751] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-07 14:02:31,751] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-07 14:02:31,751] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-07 14:02:31,751] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-07 14:02:31,751] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-07 14:02:31,751] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-07 14:02:31,751] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-07 14:02:31,751] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-07 14:02:31,751] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-07 14:02:31,751] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-07 14:02:31,751] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-07 14:02:31,751] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-07 14:02:31,751] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-07 14:02:31,751] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-07 14:02:31,751] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-07 14:02:31,751] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-07 14:02:31,751] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-07 14:02:31,751] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-07 14:02:31,751] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-07 14:02:31,751] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-07 14:02:31,751] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-07 14:02:31,751] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-07 14:02:31,751] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-07 14:02:31,751] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-07 14:02:31,752] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-07 14:02:31,752] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-07 14:02:31,752] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-07 14:02:31,752] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-07 14:02:31,752] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7fe0ffb87bb0>
[2023-08-07 14:02:31,752] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-07 14:02:31,752] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-07 14:02:31,752] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-07 14:02:31,752] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-07 14:02:31,752] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-07 14:02:31,752] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-07 14:02:31,752] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-07 14:02:31,752] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-07 14:02:31,752] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-07 14:02:31,752] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-07 14:02:31,752] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-07 14:02:31,752] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-07 14:02:31,752] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-07 14:02:31,752] [INFO] [config.py:1012:print]   train_batch_size ............. 64
[2023-08-07 14:02:31,752] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  16
[2023-08-07 14:02:31,752] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-07 14:02:31,752] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-07 14:02:31,752] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-07 14:02:31,752] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-07 14:02:31,752] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-07 14:02:31,752] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-07 14:02:31,752] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-07 14:02:31,752] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 16, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.6297409534454346 seconds
Loading extension module utils...
Time to load utils op: 0.6052684783935547 seconds
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.6054630279541016 seconds
Time to load utils op: 0.6050596237182617 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                                                                                       | 0/1 [00:00<?, ?it/s]############### Example ###############
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following multiple choice question.

### Demonstration:Input: He fantasied about getting a what while driving to work and the pros and cons of the extra responsibilities and benefits? Choices:  A: new car B: promotion C: boredom D: impatience E: pressure
Rationales: Step 1: The question is about someone fantasizing during their drive to work. The topic of their daydream involves the pros and cons of additional responsibilities and benefits. This leads us to understand that the person is contemplating something that could potentially bring about such changes.

Step 2: Looking at the answer choices, we can start eliminating options that don't fit the context. 
- A new car (Choice A) wouldn't necessarily come with additional responsibilities or benefits within a work context, so it can be eliminated.
- Boredom (Choice C), impatience (Choice D), and pressure (Choice E) are emotional states or feelings, not something one would typically fantasize about while considering added responsibilities and benefits. So, these can also be eliminated.

Step 3: This leaves us with Choice B, a promotion. A promotion would indeed come with extra responsibilities as well as benefits. 

Step 4: Therefore, the person is fantasizing about getting a promotion (Choice B). This is the best fit given the context of the question.
Answer: B: promotion

Input: He was good at traditional science but excelled at social science, his favorite subject was what? Choices:  A: geography B: history studies C: math D: religion E: dancing
Rationales: Step 1: Understand the question. The question is asking to identify the favorite subject of the person based on the information given.

Step 2: Analyze the information given. We know that the person is good at traditional science and excels at social science. 

Step 3: Understand the categories of the subjects in the choices. We have geography, history studies, math, religion, and dancing as choices. Traditional sciences generally involve disciplines like physics, chemistry, biology, etc. Social sciences, on the other hand, include disciplines that study society and the relationships among individuals within a society. Under social sciences, we have subjects like history, geography, political science, sociology, etc. 

Step 4: Identify the favorite subject. Since the person excels at social science, we could infer that his favorite subject would be under social science. In the choices, both A: geography and B: history studies fall under social science.

Step 5: Select the best answer. Among A and B, the question does not provide any explicit information to choose between geography and history studies. However, it does mention that he "excelled" at social science. "Excelling" at something often implies a deep interest or passion. Since the question asks for his "favorite" subject, it would be reasonable to pick the subject at which he excelled. From the choices, the only subject that falls under social science at which he could have excelled is B: history studies.

Therefore, the answer is B: history studies.
Answer: B: history studies

Input: Jan wasn't very good at studying.  What might help him study better? Choices:  A: having a bigger brain B: headaches C: inspiration D: more intelligence E: understanding
Rationales: Step 1: The question asks us to identify what might help Jan to study better. This implies that we need to look for an answer choice that would improve his ability to learn and understand new information.

Step 2: Option A suggests that having a bigger brain might help Jan study better. While the size of the brain does correlate to some extent with cognitive abilities in general, it is not a definitive factor in determining individual intelligence or study skills. Therefore, this is not the best answer.

Step 3: Option B suggests that headaches might help Jan study better. This is counterintuitive as headaches often distract and make it harder for individuals to concentrate, which would likely hinder studying, not help it.

Step 4: Option C suggests that inspiration might help Jan study better. While being inspired can motivate someone to study harder, it doesn't necessarily improve their ability to comprehend the material. Therefore, this is not the best answer.

Step 5: Option D suggests that more intelligence might help Jan study better. Intelligence refers to the ability to learn, understand and apply knowledge, which are all key to studying effectively. This makes it the best answer out of the given choices.

Step 6: Option E suggests that understanding might help Jan study better. While understanding is a crucial part of studying, the phrase is vague and it's unclear what Jan should understand. More intelligence, on the other hand, would likely improve his overall understanding regardless of the subject matter.

Therefore, the best answer to the question is D: more intelligence.
Answer: D: more intelligence

Input: The cat was wild but like all others he was always read for a cat what? Choices:  A: stealing B: four legs C: tuna fish D: food now E: nap
Rationales: Step 1: Understand the question. The question is asking for a characteristic trait that is common among all cats, which the wild cat in the context is always ready for.

Step 2: Look at each of the options individually.

Option A: Stealing - Not all cats are known for stealing. Especially, it isn't a characteristic trait that a cat is always ready for. So, this can be eliminated.

Option B: Four legs - This option doesn't fit the sentence structure. The phrase "always ready for a four legs" is grammatically incorrect. So, this can be eliminated.

Option C: Tuna fish - While cats do like to eat fish, it's not a universal trait and it's not something a cat is 'always ready for', as cats can be picky eaters. So, this can be eliminated.

Option D: Food now - While cats are often ready to eat, the phrase "always ready for a food now" is grammatically incorrect. So, this can be eliminated.

Option E: Nap - Cats are known for their sleeping habits, and it's a characteristic trait that a cat, wild or domesticated, is always ready for a nap. This fits the sentence structure and makes sense contextually.

Step 3: Choose the correct option. Therefore, the answer is E: nap.
Answer: E: nap

### Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid

### Response:
############### End ###############
Evaluating commonsenseqa : 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:21<00:00, 21.57s/it]Evaluating commonsenseqa : 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:21<00:00, 21.57s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 0.641} | lm_loss 8.3537 | avg. gen lenth: 227.0
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 8 --num-workers 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 16 --seed 42 --data-dir /scratch/ylu130/processed_data/commonsenseqa/n0-seed42-rationalesFalse --num-in-domain 0
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-07 14:03:02,256] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/n0-seed42-rationalesFalse
  processed_data_dir ........... None
  num_eval ..................... 8
  num_in_domain ................ 0
  num_out_domain ............... None
  out_domain ................... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/t1-m512-i0-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 16
  clip_grad .................... 1.0
  seed ......................... 42
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                                                               | 0/9741 [00:00<?, ?it/s]  3%|███▋                                                                                                               | 311/9741 [00:00<00:03, 3107.72it/s]  6%|███████▍                                                                                                           | 625/9741 [00:00<00:02, 3123.93it/s] 10%|███████████                                                                                                        | 942/9741 [00:00<00:02, 3142.96it/s] 13%|██████████████▋                                                                                                   | 1259/9741 [00:00<00:02, 3152.24it/s] 16%|██████████████████▍                                                                                               | 1575/9741 [00:00<00:02, 3145.63it/s] 19%|██████████████████████                                                                                            | 1890/9741 [00:00<00:02, 3122.09it/s] 23%|█████████████████████████▊                                                                                        | 2203/9741 [00:00<00:02, 3119.93it/s] 26%|█████████████████████████████▍                                                                                    | 2517/9741 [00:00<00:02, 3124.81it/s] 29%|█████████████████████████████████                                                                                 | 2830/9741 [00:00<00:02, 3118.26it/s] 32%|████████████████████████████████████▊                                                                             | 3143/9741 [00:01<00:02, 3121.02it/s] 35%|████████████████████████████████████████▍                                                                         | 3457/9741 [00:01<00:02, 3125.02it/s] 39%|████████████████████████████████████████████                                                                      | 3770/9741 [00:01<00:01, 3121.00it/s] 42%|███████████████████████████████████████████████▊                                                                  | 4083/9741 [00:01<00:01, 3033.14it/s] 45%|███████████████████████████████████████████████████▍                                                              | 4393/9741 [00:01<00:01, 3051.70it/s] 48%|██████████████████████████████████████████████████████▉                                                           | 4699/9741 [00:01<00:01, 3006.21it/s] 51%|██████████████████████████████████████████████████████████▌                                                       | 5000/9741 [00:01<00:02, 2067.04it/s] 55%|██████████████████████████████████████████████████████████████▏                                                   | 5313/9741 [00:01<00:01, 2303.78it/s] 58%|█████████████████████████████████████████████████████████████████▉                                                | 5629/9741 [00:01<00:01, 2509.58it/s] 61%|█████████████████████████████████████████████████████████████████████▋                                            | 5957/9741 [00:02<00:01, 2705.82it/s] 65%|█████████████████████████████████████████████████████████████████████████▌                                        | 6285/9741 [00:02<00:01, 2859.35it/s] 68%|█████████████████████████████████████████████████████████████████████████████▎                                    | 6611/9741 [00:02<00:01, 2969.32it/s] 71%|█████████████████████████████████████████████████████████████████████████████████▏                                | 6937/9741 [00:02<00:00, 3049.78it/s] 75%|█████████████████████████████████████████████████████████████████████████████████████                             | 7271/9741 [00:02<00:00, 3133.20it/s] 78%|████████████████████████████████████████████████████████████████████████████████████████▉                         | 7600/9741 [00:02<00:00, 3176.89it/s] 82%|████████████████████████████████████████████████████████████████████████████████████████████▉                     | 7939/9741 [00:02<00:00, 3237.79it/s] 85%|████████████████████████████████████████████████████████████████████████████████████████████████▉                 | 8279/9741 [00:02<00:00, 3284.24it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████████████████▊             | 8617/9741 [00:02<00:00, 3310.73it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▊       | 9131/9741 [00:02<00:00, 3854.10it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉ | 9647/9741 [00:03<00:00, 4243.16it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9741/9741 [00:03<00:00, 3145.44it/s]
Load End
Num instances: 8
Loading checkpoint shards:   0%|                                                                                                       | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                                       | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                                       | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                                       | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███████████████████████████████▋                                                               | 1/3 [00:05<00:10,  5.49s/it]Loading checkpoint shards:  33%|███████████████████████████████▋                                                               | 1/3 [00:05<00:11,  5.54s/it]Loading checkpoint shards:  33%|███████████████████████████████▋                                                               | 1/3 [00:05<00:11,  5.63s/it]Loading checkpoint shards:  33%|███████████████████████████████▋                                                               | 1/3 [00:05<00:11,  5.68s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████████████████▎                               | 2/3 [00:10<00:05,  5.23s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████████████████▎                               | 2/3 [00:10<00:05,  5.44s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████████████████▎                               | 2/3 [00:11<00:05,  5.51s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████████████████▎                               | 2/3 [00:13<00:07,  7.06s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.58s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.78s/it]
[2023-08-07 14:03:57,196] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  4.85s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.02s/it]
Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  4.90s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.08s/it]
Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:19<00:00,  6.42s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:19<00:00,  6.45s/it]
[2023-08-07 14:04:14,423] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-07 14:04:14,424] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-07 14:04:14,425] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-07 14:04:14,425] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-07 14:04:14,425] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-07 14:04:14,425] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-07 14:04:14,425] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-07 14:04:14,425] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-07 14:04:14,425] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-07 14:04:14,425] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-07 14:04:14,425] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-07 14:04:14,425] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7faa2045a670>
[2023-08-07 14:04:14,425] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-07 14:04:14,426] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-07 14:04:14,426] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-07 14:04:14,426] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-07 14:04:14,426] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-07 14:04:14,426] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-07 14:04:14,426] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-07 14:04:14,426] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-07 14:04:14,426] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-07 14:04:14,426] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-07 14:04:14,426] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-07 14:04:14,426] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-07 14:04:14,426] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-07 14:04:14,426] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-07 14:04:14,426] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-07 14:04:14,426] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-07 14:04:14,426] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-07 14:04:14,426] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-07 14:04:14,426] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-07 14:04:14,426] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-07 14:04:14,426] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-07 14:04:14,426] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-07 14:04:14,426] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-07 14:04:14,426] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-07 14:04:14,426] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-07 14:04:14,426] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-07 14:04:14,426] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-07 14:04:14,426] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-07 14:04:14,426] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-07 14:04:14,426] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-07 14:04:14,426] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-07 14:04:14,426] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-07 14:04:14,426] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7faa2045abb0>
[2023-08-07 14:04:14,426] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-07 14:04:14,426] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-07 14:04:14,426] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-07 14:04:14,427] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-07 14:04:14,427] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-07 14:04:14,427] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-07 14:04:14,427] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-07 14:04:14,427] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-07 14:04:14,427] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-07 14:04:14,427] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-07 14:04:14,427] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-07 14:04:14,427] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-07 14:04:14,427] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-07 14:04:14,427] [INFO] [config.py:1012:print]   train_batch_size ............. 64
[2023-08-07 14:04:14,427] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  16
[2023-08-07 14:04:14,427] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-07 14:04:14,427] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-07 14:04:14,427] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-07 14:04:14,427] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-07 14:04:14,427] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-07 14:04:14,427] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-07 14:04:14,427] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-07 14:04:14,427] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 16, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.3660750389099121 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Loading extension module utils...
Evaluating commonsenseqa :   0%|                                                                                                       | 0/1 [00:00<?, ?it/s]Time to load utils op: 0.3047502040863037 seconds
############### Example ###############
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following multiple choice question.

### Demonstration:None

### Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid

### Response:
############### End ###############
Loading extension module utils...
Time to load utils op: 0.3054947853088379 seconds
Loading extension module utils...
Time to load utils op: 0.40511465072631836 seconds
^CTraceback (most recent call last):
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
Traceback (most recent call last):
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 136, in evaluate_main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 136, in evaluate_main
        lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)

  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 114, in run_model
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 114, in run_model
        gen_out = model.generate(gen_out = model.generate(

  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    main()
      File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
return func(*args, **kwargs)    
return func(*args, **kwargs)  File "/home/ylu130/workspace/minillm/transformers/src/transformers/generation/utils.py", line 1454, in generate

  File "/home/ylu130/workspace/minillm/transformers/src/transformers/generation/utils.py", line 1454, in generate
Evaluating commonsenseqa :   0%|                                                                                                       | 0/1 [00:03<?, ?it/s]
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 136, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 114, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
        return self.sample(return self.sample(
    
  File "/home/ylu130/workspace/minillm/transformers/src/transformers/generation/utils.py", line 2484, in sample
return func(*args, **kwargs)  File "/home/ylu130/workspace/minillm/transformers/src/transformers/generation/utils.py", line 2484, in sample

  File "/home/ylu130/workspace/minillm/transformers/src/transformers/generation/utils.py", line 1454, in generate
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
WARNING:torch.distributed.elastic.agent.server.api:Received 2 death signal, shutting down workers
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    return self.sample(
  File "/home/ylu130/workspace/minillm/transformers/src/transformers/generation/utils.py", line 2509, in sample
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 136, in evaluate_main
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 353936 closing signal SIGINT
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 114, in run_model
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 353937 closing signal SIGINT
return func(*args, **kwargs)
  File "/home/ylu130/workspace/minillm/transformers/src/transformers/generation/utils.py", line 1454, in generate
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    outputs = self(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 353938 closing signal SIGINT
  File "/home/ylu130/workspace/minillm/transformers/src/transformers/models/llama/modeling_llama.py", line 727, in forward
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 353939 closing signal SIGINT
    return forward_call(*input, **kwargs)
  File "/home/ylu130/workspace/minillm/transformers/src/transformers/models/llama/modeling_llama.py", line 727, in forward
  File "/home/ylu130/workspace/minillm/transformers/src/transformers/generation/logits_process.py", line 92, in __call__
    outputs = self.model(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    scores = processor(input_ids, scores)
  File "/home/ylu130/workspace/minillm/transformers/src/transformers/generation/logits_process.py", line 487, in __call__
    return self.sample(    
outputs = self.model(  File "/home/ylu130/workspace/minillm/transformers/src/transformers/generation/utils.py", line 2509, in sample

  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
      File "/home/ylu130/workspace/minillm/transformers/src/transformers/models/llama/modeling_llama.py", line 617, in forward
banned_batch_tokens = _calc_banned_ngram_tokens(self.ngram_size, input_ids, num_batch_hypotheses, cur_len)
  File "/home/ylu130/workspace/minillm/transformers/src/transformers/generation/logits_process.py", line 460, in _calc_banned_ngram_tokens
    return forward_call(*input, **kwargs)
  File "/home/ylu130/workspace/minillm/transformers/src/transformers/models/llama/modeling_llama.py", line 617, in forward
    layer_outputs = decoder_layer(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    generated_ngrams = _get_ngrams(ngram_size, prev_input_ids, num_hypos)
  File "/home/ylu130/workspace/minillm/transformers/src/transformers/generation/logits_process.py", line 441, in _get_ngrams
    layer_outputs = decoder_layer(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
        return forward_call(*input, **kwargs)generated_ngram[prev_ngram_tuple] = generated_ngram.get(prev_ngram_tuple, []) + [ngram[-1]]

  File "/home/ylu130/workspace/minillm/transformers/src/transformers/models/llama/modeling_llama.py", line 328, in forward
KeyboardInterrupt
    return forward_call(*input, **kwargs)
  File "/home/ylu130/workspace/minillm/transformers/src/transformers/models/llama/modeling_llama.py", line 341, in forward
    hidden_states, self_attn_weights, present_key_value = self.self_attn(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    hidden_states = self.mlp(hidden_states)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/ylu130/workspace/minillm/transformers/src/transformers/models/llama/modeling_llama.py", line 232, in forward
    next_token_scores = logits_processor(input_ids, next_token_logits)
  File "/home/ylu130/workspace/minillm/transformers/src/transformers/generation/logits_process.py", line 92, in __call__
    return forward_call(*input, **kwargs)
  File "/home/ylu130/workspace/minillm/transformers/src/transformers/models/llama/modeling_llama.py", line 192, in forward
    key_states = self.k_proj(hidden_states).view(bsz, q_len, self.num_heads, self.head_dim).transpose(1, 2)
KeyboardInterrupt
    scores = processor(input_ids, scores)
  File "/home/ylu130/workspace/minillm/transformers/src/transformers/generation/logits_process.py", line 487, in __call__
    return self.down_proj(self.act_fn(self.gate_proj(x)) * self.up_proj(x))
KeyboardInterrupt
    banned_batch_tokens = _calc_banned_ngram_tokens(self.ngram_size, input_ids, num_batch_hypotheses, cur_len)
  File "/home/ylu130/workspace/minillm/transformers/src/transformers/generation/logits_process.py", line 460, in _calc_banned_ngram_tokens
    generated_ngrams = _get_ngrams(ngram_size, prev_input_ids, num_hypos)
  File "/home/ylu130/workspace/minillm/transformers/src/transformers/generation/logits_process.py", line 441, in _get_ngrams
    generated_ngram[prev_ngram_tuple] = generated_ngram.get(prev_ngram_tuple, []) + [ngram[-1]]
KeyboardInterrupt
Traceback (most recent call last):
  File "/home/ylu130/.conda/envs/distllm/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 345, in wrapper
    return f(*args, **kwargs)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 761, in main
    run(args)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 752, in run
    elastic_launch(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 131, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 236, in launch_agent
    result = agent.run()
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/metrics/api.py", line 125, in wrapper
    result = f(*args, **kwargs)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py", line 709, in run
    result = self._invoke_run(role)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py", line 850, in _invoke_run
    time.sleep(monitor_interval)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 60, in _terminate_process_handler
    raise SignalException(f"Process {os.getpid()} got signal: {sigval}", sigval=sigval)
torch.distributed.elastic.multiprocessing.api.SignalException: Process 353870 got signal: 2
^C