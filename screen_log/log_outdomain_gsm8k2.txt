PYTHONPATH=/home/ylu130/workspace/in-context-generalization
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name gsm8k --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 4 --seed 42 --data-dir /scratch/ylu130/processed_data/commonsenseqa/out-domain/o5-tgsm8k-s42-rTrue --rationales --num-out-domain 5
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-08 19:45:15,681] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/out-domain/o5-tgsm8k-s42-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 5
  out_domain_data_name ......... gsm8k
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o5-tgsm8k-s42-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 4
  clip_grad .................... 1.0
  seed ......................... 42
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                        | 0/9741 [00:00<?, ?it/s]  0%|▏                                                                             | 19/9741 [00:00<00:53, 180.76it/s]  0%|▎                                                                             | 38/9741 [00:00<00:52, 185.30it/s]  1%|▍                                                                             | 57/9741 [00:00<00:52, 182.86it/s]  1%|▌                                                                             | 76/9741 [00:00<00:54, 177.90it/s]  1%|▊                                                                             | 94/9741 [00:00<00:54, 177.82it/s]  1%|▉                                                                            | 112/9741 [00:00<00:58, 165.79it/s]  1%|█                                                                            | 131/9741 [00:00<00:55, 172.58it/s]  2%|█▏                                                                           | 150/9741 [00:00<00:54, 177.47it/s]  2%|█▎                                                                           | 168/9741 [00:00<00:54, 176.19it/s]  2%|█▍                                                                           | 186/9741 [00:01<00:54, 174.95it/s]  2%|█▌                                                                           | 204/9741 [00:01<00:57, 165.56it/s]  2%|█▋                                                                           | 221/9741 [00:01<01:01, 154.87it/s]  2%|█▉                                                                           | 240/9741 [00:01<00:57, 164.44it/s]  3%|██                                                                           | 258/9741 [00:01<00:56, 168.28it/s]  3%|██▏                                                                          | 276/9741 [00:01<00:55, 169.43it/s]  3%|██▎                                                                          | 294/9741 [00:01<00:59, 159.88it/s]  3%|██▍                                                                          | 311/9741 [00:01<00:58, 161.02it/s]  3%|██▌                                                                          | 330/9741 [00:01<00:56, 167.86it/s]  4%|██▊                                                                          | 349/9741 [00:02<00:54, 173.20it/s]  4%|██▉                                                                          | 367/9741 [00:02<00:54, 172.46it/s]  4%|███                                                                          | 385/9741 [00:02<00:54, 170.67it/s]  4%|███▏                                                                         | 403/9741 [00:02<00:55, 167.13it/s]  4%|███▎                                                                         | 421/9741 [00:02<00:55, 168.42it/s]  5%|███▍                                                                         | 440/9741 [00:02<00:53, 173.13it/s]  5%|███▋                                                                         | 459/9741 [00:02<00:52, 175.78it/s]  5%|███▊                                                                         | 477/9741 [00:02<00:53, 174.06it/s]  5%|███▉                                                                         | 495/9741 [00:02<00:53, 173.97it/s]  5%|████                                                                         | 513/9741 [00:03<00:54, 169.90it/s]  5%|████▏                                                                        | 531/9741 [00:03<00:53, 170.79it/s]  6%|████▎                                                                        | 550/9741 [00:03<00:52, 176.12it/s]  6%|████▍                                                                        | 568/9741 [00:03<00:51, 177.00it/s]  6%|████▋                                                                        | 586/9741 [00:03<00:52, 175.58it/s]  6%|████▊                                                                        | 604/9741 [00:03<00:51, 175.99it/s]  6%|████▉                                                                        | 622/9741 [00:03<00:56, 162.59it/s]  7%|█████                                                                        | 641/9741 [00:03<00:53, 169.26it/s]  7%|█████▏                                                                       | 659/9741 [00:03<00:52, 171.44it/s]  7%|█████▎                                                                       | 677/9741 [00:03<00:52, 171.57it/s]  7%|█████▍                                                                       | 695/9741 [00:04<00:53, 170.18it/s]  7%|█████▋                                                                       | 713/9741 [00:04<00:53, 168.89it/s]  8%|█████▊                                                                       | 731/9741 [00:04<00:53, 169.75it/s]  8%|█████▉                                                                       | 751/9741 [00:04<00:51, 175.77it/s]  8%|██████                                                                       | 769/9741 [00:04<00:51, 173.90it/s]  8%|██████▏                                                                      | 787/9741 [00:04<00:51, 172.95it/s]  8%|██████▎                                                                      | 805/9741 [00:04<00:51, 174.68it/s]  8%|██████▌                                                                      | 823/9741 [00:04<00:52, 171.19it/s]  9%|██████▋                                                                      | 842/9741 [00:04<00:50, 176.14it/s]  9%|██████▊                                                                      | 862/9741 [00:05<00:49, 180.75it/s]  9%|██████▉                                                                      | 881/9741 [00:05<00:49, 177.50it/s]  9%|███████                                                                      | 900/9741 [00:05<00:49, 179.78it/s]  9%|███████▎                                                                     | 919/9741 [00:05<00:50, 175.49it/s] 10%|███████▍                                                                     | 939/9741 [00:05<00:48, 180.29it/s] 10%|███████▌                                                                     | 958/9741 [00:05<00:48, 182.39it/s] 10%|███████▋                                                                     | 977/9741 [00:05<00:48, 181.38it/s] 10%|███████▊                                                                     | 996/9741 [00:05<00:47, 182.71it/s] 10%|███████▉                                                                    | 1015/9741 [00:05<00:48, 181.22it/s] 11%|████████                                                                    | 1034/9741 [00:05<00:48, 179.48it/s] 11%|████████▏                                                                   | 1052/9741 [00:06<00:48, 178.90it/s] 11%|████████▎                                                                   | 1070/9741 [00:06<00:49, 176.22it/s] 11%|████████▍                                                                   | 1089/9741 [00:06<00:48, 177.70it/s] 11%|████████▋                                                                   | 1108/9741 [00:06<00:47, 180.24it/s] 12%|████████▊                                                                   | 1127/9741 [00:06<00:49, 173.00it/s] 12%|████████▉                                                                   | 1145/9741 [00:06<00:49, 172.15it/s] 12%|█████████                                                                   | 1164/9741 [00:06<00:49, 174.45it/s] 12%|█████████▏                                                                  | 1184/9741 [00:06<00:47, 179.51it/s] 12%|█████████▍                                                                  | 1203/9741 [00:06<00:47, 181.51it/s] 13%|█████████▌                                                                  | 1222/9741 [00:07<00:49, 173.59it/s] 13%|█████████▋                                                                  | 1241/9741 [00:07<00:48, 175.89it/s] 13%|█████████▊                                                                  | 1260/9741 [00:07<00:47, 179.50it/s] 13%|█████████▉                                                                  | 1280/9741 [00:07<00:46, 183.18it/s] 13%|██████████▏                                                                 | 1300/9741 [00:07<00:45, 185.29it/s] 14%|██████████▎                                                                 | 1319/9741 [00:07<00:45, 185.55it/s] 14%|██████████▍                                                                 | 1338/9741 [00:07<00:50, 167.67it/s] 14%|██████████▌                                                                 | 1357/9741 [00:07<00:48, 173.67it/s] 14%|██████████▋                                                                 | 1377/9741 [00:07<00:46, 178.54it/s] 14%|██████████▉                                                                 | 1396/9741 [00:08<00:46, 181.33it/s] 15%|███████████                                                                 | 1415/9741 [00:08<00:45, 183.31it/s] 15%|███████████▏                                                                | 1434/9741 [00:08<00:47, 175.63it/s] 15%|███████████▎                                                                | 1453/9741 [00:08<00:46, 178.36it/s] 15%|███████████▍                                                                | 1472/9741 [00:08<00:45, 180.21it/s] 15%|███████████▋                                                                | 1492/9741 [00:08<00:44, 185.81it/s] 16%|███████████▊                                                                | 1521/9741 [00:08<00:38, 215.37it/s] 16%|████████████                                                                | 1545/9741 [00:08<00:36, 222.36it/s] 16%|████████████▏                                                               | 1568/9741 [00:08<00:37, 219.25it/s] 16%|████████████▍                                                               | 1594/9741 [00:08<00:35, 228.91it/s] 17%|████████████▋                                                               | 1623/9741 [00:09<00:32, 246.58it/s] 17%|████████████▊                                                               | 1649/9741 [00:09<00:32, 250.30it/s] 17%|█████████████                                                               | 1675/9741 [00:09<00:33, 241.39it/s] 17%|█████████████▎                                                              | 1700/9741 [00:09<00:36, 220.65it/s] 18%|█████████████▍                                                              | 1723/9741 [00:09<00:39, 203.95it/s] 18%|█████████████▌                                                              | 1744/9741 [00:09<00:40, 198.09it/s] 18%|█████████████▊                                                              | 1765/9741 [00:09<00:40, 194.80it/s] 18%|█████████████▉                                                              | 1785/9741 [00:09<00:48, 163.06it/s] 19%|██████████████                                                              | 1805/9741 [00:10<00:46, 169.80it/s] 19%|██████████████▏                                                             | 1823/9741 [00:10<00:46, 171.60it/s] 19%|██████████████▎                                                             | 1841/9741 [00:10<00:50, 157.68it/s] 19%|██████████████▍                                                             | 1858/9741 [00:10<00:49, 160.13it/s] 19%|██████████████▋                                                             | 1876/9741 [00:10<00:47, 164.12it/s] 19%|██████████████▊                                                             | 1894/9741 [00:10<00:46, 167.23it/s] 20%|██████████████▉                                                             | 1911/9741 [00:10<00:51, 153.04it/s] 20%|███████████████                                                             | 1928/9741 [00:10<00:49, 157.15it/s] 20%|███████████████▏                                                            | 1947/9741 [00:10<00:46, 166.07it/s] 20%|███████████████▎                                                            | 1965/9741 [00:11<00:46, 167.38it/s] 20%|███████████████▍                                                            | 1982/9741 [00:11<00:52, 149.05it/s] 21%|███████████████▌                                                            | 1999/9741 [00:11<00:50, 154.35it/s] 21%|███████████████▋                                                            | 2018/9741 [00:11<00:47, 163.25it/s] 21%|███████████████▉                                                            | 2037/9741 [00:11<00:45, 170.26it/s] 21%|████████████████                                                            | 2055/9741 [00:11<00:49, 155.76it/s] 21%|████████████████▏                                                           | 2072/9741 [00:11<00:49, 154.47it/s] 21%|████████████████▎                                                           | 2092/9741 [00:11<00:46, 164.48it/s] 22%|████████████████▍                                                           | 2111/9741 [00:11<00:44, 170.04it/s] 22%|████████████████▌                                                           | 2129/9741 [00:12<00:45, 167.25it/s] 22%|████████████████▋                                                           | 2146/9741 [00:12<00:47, 158.71it/s] 22%|████████████████▉                                                           | 2163/9741 [00:12<00:47, 161.01it/s] 22%|█████████████████                                                           | 2183/9741 [00:12<00:44, 169.47it/s] 23%|█████████████████▏                                                          | 2201/9741 [00:12<00:43, 172.16it/s] 23%|█████████████████▎                                                          | 2220/9741 [00:12<00:42, 174.91it/s] 23%|█████████████████▍                                                          | 2238/9741 [00:12<00:42, 175.84it/s] 23%|█████████████████▌                                                          | 2256/9741 [00:12<00:43, 172.48it/s] 23%|█████████████████▋                                                          | 2274/9741 [00:12<00:42, 174.11it/s] 24%|█████████████████▉                                                          | 2293/9741 [00:12<00:42, 177.29it/s] 24%|██████████████████                                                          | 2311/9741 [00:13<00:43, 170.77it/s] 24%|██████████████████▏                                                         | 2330/9741 [00:13<00:42, 176.18it/s] 24%|██████████████████▎                                                         | 2348/9741 [00:13<00:42, 173.49it/s] 24%|██████████████████▍                                                         | 2366/9741 [00:13<00:42, 172.39it/s] 24%|██████████████████▌                                                         | 2384/9741 [00:13<00:42, 173.57it/s] 25%|██████████████████▊                                                         | 2404/9741 [00:13<00:41, 178.95it/s] 25%|██████████████████▉                                                         | 2423/9741 [00:13<00:40, 180.96it/s] 25%|███████████████████                                                         | 2442/9741 [00:13<00:40, 181.18it/s] 25%|███████████████████▏                                                        | 2461/9741 [00:13<00:41, 176.82it/s] 25%|███████████████████▎                                                        | 2479/9741 [00:14<00:41, 176.46it/s] 26%|███████████████████▍                                                        | 2498/9741 [00:14<00:40, 180.30it/s] 26%|███████████████████▋                                                        | 2517/9741 [00:14<00:39, 180.98it/s] 26%|███████████████████▊                                                        | 2536/9741 [00:14<00:40, 179.02it/s] 26%|███████████████████▉                                                        | 2554/9741 [00:14<00:42, 170.31it/s] 26%|████████████████████                                                        | 2573/9741 [00:14<00:41, 174.28it/s] 27%|████████████████████▏                                                       | 2592/9741 [00:14<00:40, 177.79it/s] 27%|████████████████████▎                                                       | 2610/9741 [00:14<00:39, 178.31it/s] 27%|████████████████████▌                                                       | 2629/9741 [00:14<00:39, 179.39it/s] 27%|████████████████████▋                                                       | 2648/9741 [00:15<00:39, 177.60it/s] 27%|████████████████████▊                                                       | 2666/9741 [00:15<00:40, 176.65it/s] 28%|████████████████████▉                                                       | 2685/9741 [00:15<00:39, 178.07it/s] 28%|█████████████████████                                                       | 2703/9741 [00:15<00:39, 176.53it/s] 28%|█████████████████████▏                                                      | 2721/9741 [00:15<00:39, 177.30it/s] 28%|█████████████████████▍                                                      | 2740/9741 [00:15<00:38, 179.73it/s] 28%|█████████████████████▌                                                      | 2758/9741 [00:15<00:40, 174.06it/s] 28%|█████████████████████▋                                                      | 2776/9741 [00:15<00:39, 174.53it/s] 29%|█████████████████████▊                                                      | 2794/9741 [00:15<00:39, 175.32it/s] 29%|█████████████████████▉                                                      | 2813/9741 [00:15<00:38, 178.84it/s] 29%|██████████████████████                                                      | 2832/9741 [00:16<00:37, 182.10it/s] 29%|██████████████████████▏                                                     | 2851/9741 [00:16<00:39, 175.97it/s] 29%|██████████████████████▍                                                     | 2869/9741 [00:16<00:38, 176.21it/s] 30%|██████████████████████▌                                                     | 2887/9741 [00:16<00:42, 162.35it/s] 30%|██████████████████████▋                                                     | 2906/9741 [00:16<00:40, 169.86it/s] 30%|██████████████████████▊                                                     | 2924/9741 [00:16<00:39, 172.01it/s] 30%|██████████████████████▉                                                     | 2942/9741 [00:16<00:40, 169.61it/s] 30%|███████████████████████                                                     | 2960/9741 [00:16<00:39, 171.16it/s] 31%|███████████████████████▏                                                    | 2979/9741 [00:16<00:38, 175.38it/s] 31%|███████████████████████▍                                                    | 2998/9741 [00:17<00:37, 178.51it/s] 31%|███████████████████████▌                                                    | 3016/9741 [00:17<00:37, 178.46it/s] 31%|███████████████████████▋                                                    | 3035/9741 [00:17<00:37, 178.84it/s] 31%|███████████████████████▊                                                    | 3053/9741 [00:17<00:38, 174.17it/s] 32%|███████████████████████▉                                                    | 3072/9741 [00:17<00:37, 178.52it/s] 32%|████████████████████████                                                    | 3091/9741 [00:17<00:37, 179.34it/s] 32%|████████████████████████▎                                                   | 3109/9741 [00:17<00:37, 178.14it/s] 32%|████████████████████████▍                                                   | 3128/9741 [00:17<00:36, 178.82it/s] 32%|████████████████████████▌                                                   | 3146/9741 [00:17<00:37, 174.61it/s] 32%|████████████████████████▋                                                   | 3165/9741 [00:17<00:37, 177.53it/s] 33%|████████████████████████▊                                                   | 3183/9741 [00:18<00:37, 173.88it/s] 33%|████████████████████████▉                                                   | 3202/9741 [00:18<00:37, 175.88it/s] 33%|█████████████████████████▏                                                  | 3221/9741 [00:18<00:36, 178.12it/s] 33%|█████████████████████████▎                                                  | 3240/9741 [00:18<00:35, 181.49it/s] 33%|█████████████████████████▍                                                  | 3259/9741 [00:18<00:36, 176.09it/s] 34%|█████████████████████████▌                                                  | 3278/9741 [00:18<00:36, 177.33it/s] 34%|█████████████████████████▋                                                  | 3296/9741 [00:18<00:36, 178.08it/s] 34%|█████████████████████████▊                                                  | 3315/9741 [00:18<00:35, 181.43it/s] 34%|██████████████████████████                                                  | 3334/9741 [00:18<00:35, 178.65it/s] 34%|██████████████████████████▏                                                 | 3352/9741 [00:19<00:37, 171.42it/s] 35%|██████████████████████████▎                                                 | 3373/9741 [00:19<00:35, 181.60it/s] 35%|██████████████████████████▍                                                 | 3394/9741 [00:19<00:33, 187.86it/s] 35%|██████████████████████████▋                                                 | 3417/9741 [00:19<00:31, 199.81it/s] 35%|██████████████████████████▉                                                 | 3446/9741 [00:19<00:27, 225.46it/s] 36%|███████████████████████████                                                 | 3471/9741 [00:19<00:27, 229.69it/s] 36%|███████████████████████████▎                                                | 3495/9741 [00:19<00:28, 220.56it/s] 36%|███████████████████████████▍                                                | 3518/9741 [00:19<00:30, 201.49it/s] 36%|███████████████████████████▋                                                | 3546/9741 [00:19<00:28, 221.01it/s] 37%|███████████████████████████▊                                                | 3571/9741 [00:19<00:27, 226.27it/s] 37%|████████████████████████████                                                | 3594/9741 [00:20<00:27, 221.63it/s] 37%|████████████████████████████▏                                               | 3617/9741 [00:20<00:28, 211.60it/s] 37%|████████████████████████████▍                                               | 3643/9741 [00:20<00:27, 224.10it/s] 38%|████████████████████████████▌                                               | 3668/9741 [00:20<00:26, 229.53it/s] 38%|████████████████████████████▊                                               | 3692/9741 [00:20<00:26, 228.75it/s] 38%|████████████████████████████▉                                               | 3716/9741 [00:20<00:32, 184.79it/s] 38%|█████████████████████████████▏                                              | 3736/9741 [00:20<00:32, 186.57it/s] 39%|█████████████████████████████▎                                              | 3757/9741 [00:20<00:31, 191.99it/s] 39%|█████████████████████████████▌                                              | 3785/9741 [00:21<00:27, 214.76it/s] 39%|█████████████████████████████▋                                              | 3811/9741 [00:21<00:26, 225.33it/s] 39%|█████████████████████████████▉                                              | 3835/9741 [00:21<00:26, 223.54it/s] 40%|██████████████████████████████                                              | 3858/9741 [00:21<00:27, 217.11it/s] 40%|██████████████████████████████▎                                             | 3883/9741 [00:21<00:25, 226.27it/s] 40%|██████████████████████████████▌                                             | 3912/9741 [00:21<00:23, 243.42it/s] 40%|██████████████████████████████▋                                             | 3937/9741 [00:21<00:24, 240.89it/s] 41%|██████████████████████████████▉                                             | 3962/9741 [00:21<00:24, 236.94it/s] 41%|███████████████████████████████                                             | 3986/9741 [00:21<00:24, 235.52it/s] 41%|███████████████████████████████▎                                            | 4014/9741 [00:21<00:23, 247.04it/s] 41%|███████████████████████████████▌                                            | 4039/9741 [00:22<00:23, 238.40it/s] 42%|███████████████████████████████▋                                            | 4063/9741 [00:22<00:24, 232.95it/s] 42%|███████████████████████████████▉                                            | 4087/9741 [00:22<00:24, 230.13it/s] 42%|████████████████████████████████                                            | 4115/9741 [00:22<00:23, 242.97it/s] 43%|████████████████████████████████▎                                           | 4140/9741 [00:22<00:23, 235.87it/s] 43%|████████████████████████████████▍                                           | 4164/9741 [00:22<00:24, 230.89it/s] 43%|████████████████████████████████▋                                           | 4188/9741 [00:22<00:24, 226.40it/s] 43%|████████████████████████████████▊                                           | 4211/9741 [00:22<00:24, 226.74it/s] 44%|█████████████████████████████████                                           | 4239/9741 [00:22<00:22, 241.84it/s] 44%|█████████████████████████████████▎                                          | 4264/9741 [00:23<00:23, 234.29it/s] 44%|█████████████████████████████████▍                                          | 4288/9741 [00:23<00:23, 231.82it/s] 44%|█████████████████████████████████▋                                          | 4315/9741 [00:23<00:22, 240.98it/s] 45%|█████████████████████████████████▊                                          | 4340/9741 [00:23<00:24, 219.10it/s] 45%|██████████████████████████████████                                          | 4363/9741 [00:23<00:26, 205.15it/s] 45%|██████████████████████████████████▏                                         | 4384/9741 [00:23<00:28, 188.42it/s] 45%|██████████████████████████████████▎                                         | 4404/9741 [00:23<00:28, 186.48it/s] 45%|██████████████████████████████████▌                                         | 4423/9741 [00:23<00:28, 187.36it/s] 46%|██████████████████████████████████▋                                         | 4442/9741 [00:23<00:29, 181.67it/s] 46%|██████████████████████████████████▊                                         | 4461/9741 [00:24<00:29, 178.32it/s] 46%|██████████████████████████████████▉                                         | 4479/9741 [00:24<00:29, 178.40it/s] 46%|███████████████████████████████████                                         | 4497/9741 [00:24<00:30, 174.64it/s] 46%|███████████████████████████████████▏                                        | 4515/9741 [00:24<00:36, 145.02it/s] 47%|███████████████████████████████████▎                                        | 4533/9741 [00:24<00:33, 153.38it/s] 47%|███████████████████████████████████▌                                        | 4551/9741 [00:24<00:32, 159.64it/s] 47%|███████████████████████████████████▋                                        | 4570/9741 [00:24<00:30, 167.84it/s] 47%|███████████████████████████████████▊                                        | 4588/9741 [00:24<00:30, 169.01it/s] 47%|███████████████████████████████████▉                                        | 4607/9741 [00:24<00:29, 172.77it/s] 47%|████████████████████████████████████                                        | 4625/9741 [00:25<00:29, 173.38it/s] 48%|████████████████████████████████████▏                                       | 4644/9741 [00:25<00:28, 176.31it/s] 48%|████████████████████████████████████▍                                       | 4663/9741 [00:25<00:28, 180.03it/s] 48%|████████████████████████████████████▌                                       | 4682/9741 [00:25<00:29, 173.08it/s] 48%|████████████████████████████████████▋                                       | 4701/9741 [00:25<00:28, 175.42it/s] 48%|████████████████████████████████████▊                                       | 4719/9741 [00:25<00:29, 170.54it/s] 49%|████████████████████████████████████▉                                       | 4737/9741 [00:25<00:48, 103.14it/s] 49%|█████████████████████████████████████                                       | 4751/9741 [00:26<00:47, 104.83it/s] 49%|█████████████████████████████████████▏                                      | 4768/9741 [00:26<00:42, 117.66it/s] 49%|█████████████████████████████████████▎                                      | 4787/9741 [00:26<00:36, 134.10it/s] 49%|█████████████████████████████████████▍                                      | 4806/9741 [00:26<00:33, 147.21it/s] 50%|█████████████████████████████████████▋                                      | 4823/9741 [00:26<00:32, 153.09it/s] 50%|█████████████████████████████████████▊                                      | 4840/9741 [00:26<00:34, 140.29it/s] 50%|█████████████████████████████████████▉                                      | 4858/9741 [00:26<00:32, 149.83it/s] 50%|██████████████████████████████████████                                      | 4877/9741 [00:26<00:30, 158.40it/s] 50%|██████████████████████████████████████▏                                     | 4895/9741 [00:26<00:29, 164.28it/s] 50%|██████████████████████████████████████▎                                     | 4914/9741 [00:27<00:28, 169.23it/s] 51%|██████████████████████████████████████▍                                     | 4932/9741 [00:27<00:28, 166.66it/s] 51%|██████████████████████████████████████▌                                     | 4950/9741 [00:27<00:28, 169.98it/s] 51%|██████████████████████████████████████▊                                     | 4969/9741 [00:27<00:27, 173.53it/s] 51%|██████████████████████████████████████▉                                     | 4987/9741 [00:27<00:27, 171.44it/s] 51%|███████████████████████████████████████                                     | 5005/9741 [00:27<00:27, 172.85it/s] 52%|███████████████████████████████████████▏                                    | 5024/9741 [00:27<00:26, 176.28it/s] 52%|███████████████████████████████████████▎                                    | 5042/9741 [00:27<00:27, 171.64it/s] 52%|███████████████████████████████████████▍                                    | 5061/9741 [00:27<00:26, 175.70it/s] 52%|███████████████████████████████████████▋                                    | 5080/9741 [00:28<00:26, 177.02it/s] 52%|███████████████████████████████████████▊                                    | 5098/9741 [00:28<00:26, 176.41it/s] 53%|███████████████████████████████████████▉                                    | 5117/9741 [00:28<00:25, 177.93it/s] 53%|████████████████████████████████████████                                    | 5135/9741 [00:28<00:26, 175.67it/s] 53%|████████████████████████████████████████▏                                   | 5153/9741 [00:28<00:26, 176.43it/s] 53%|████████████████████████████████████████▎                                   | 5171/9741 [00:28<00:25, 176.02it/s] 53%|████████████████████████████████████████▍                                   | 5189/9741 [00:28<00:26, 174.63it/s] 53%|████████████████████████████████████████▋                                   | 5208/9741 [00:28<00:25, 178.37it/s] 54%|████████████████████████████████████████▊                                   | 5226/9741 [00:28<00:25, 177.23it/s] 54%|████████████████████████████████████████▉                                   | 5244/9741 [00:28<00:26, 169.71it/s] 54%|█████████████████████████████████████████                                   | 5262/9741 [00:29<00:26, 170.27it/s] 54%|█████████████████████████████████████████▏                                  | 5281/9741 [00:29<00:25, 175.49it/s] 54%|█████████████████████████████████████████▎                                  | 5300/9741 [00:29<00:25, 177.18it/s] 55%|█████████████████████████████████████████▍                                  | 5318/9741 [00:29<00:24, 177.66it/s] 55%|█████████████████████████████████████████▋                                  | 5336/9741 [00:29<00:25, 170.43it/s] 55%|█████████████████████████████████████████▊                                  | 5354/9741 [00:29<00:29, 149.34it/s] 55%|█████████████████████████████████████████▉                                  | 5373/9741 [00:29<00:27, 158.82it/s] 55%|██████████████████████████████████████████                                  | 5391/9741 [00:29<00:26, 163.01it/s] 56%|██████████████████████████████████████████▏                                 | 5409/9741 [00:29<00:26, 166.16it/s] 56%|██████████████████████████████████████████▎                                 | 5426/9741 [00:30<00:26, 165.19it/s] 56%|██████████████████████████████████████████▍                                 | 5443/9741 [00:30<00:26, 162.95it/s] 56%|██████████████████████████████████████████▌                                 | 5461/9741 [00:30<00:25, 167.11it/s] 56%|██████████████████████████████████████████▋                                 | 5479/9741 [00:30<00:25, 170.08it/s] 56%|██████████████████████████████████████████▉                                 | 5497/9741 [00:30<00:25, 169.69it/s] 57%|███████████████████████████████████████████                                 | 5515/9741 [00:30<00:25, 168.92it/s] 57%|███████████████████████████████████████████▏                                | 5532/9741 [00:30<00:27, 154.94it/s] 57%|███████████████████████████████████████████▎                                | 5551/9741 [00:30<00:25, 163.50it/s] 57%|███████████████████████████████████████████▍                                | 5569/9741 [00:30<00:24, 167.49it/s] 57%|███████████████████████████████████████████▌                                | 5588/9741 [00:31<00:24, 172.48it/s] 58%|███████████████████████████████████████████▋                                | 5606/9741 [00:31<00:23, 173.59it/s] 58%|███████████████████████████████████████████▉                                | 5624/9741 [00:31<00:23, 174.30it/s] 58%|████████████████████████████████████████████                                | 5642/9741 [00:31<00:23, 172.11it/s] 58%|████████████████████████████████████████████▏                               | 5661/9741 [00:31<00:23, 176.31it/s] 58%|████████████████████████████████████████████▎                               | 5680/9741 [00:31<00:22, 176.86it/s] 58%|████████████████████████████████████████████▍                               | 5698/9741 [00:31<00:27, 149.36it/s] 59%|████████████████████████████████████████████▌                               | 5718/9741 [00:31<00:24, 161.10it/s] 59%|████████████████████████████████████████████▋                               | 5735/9741 [00:31<00:24, 161.60it/s] 59%|████████████████████████████████████████████▉                               | 5755/9741 [00:32<00:23, 170.08it/s] 59%|█████████████████████████████████████████████                               | 5774/9741 [00:32<00:22, 174.20it/s] 59%|█████████████████████████████████████████████▏                              | 5793/9741 [00:32<00:22, 177.60it/s] 60%|█████████████████████████████████████████████▎                              | 5812/9741 [00:32<00:21, 179.53it/s] 60%|█████████████████████████████████████████████▍                              | 5831/9741 [00:32<00:22, 174.69it/s] 60%|█████████████████████████████████████████████▋                              | 5850/9741 [00:32<00:21, 178.18it/s] 60%|█████████████████████████████████████████████▊                              | 5869/9741 [00:32<00:21, 180.95it/s] 60%|█████████████████████████████████████████████▉                              | 5888/9741 [00:32<00:21, 180.83it/s] 61%|██████████████████████████████████████████████                              | 5908/9741 [00:32<00:20, 183.89it/s] 61%|██████████████████████████████████████████████▎                             | 5928/9741 [00:32<00:20, 186.59it/s] 61%|██████████████████████████████████████████████▍                             | 5947/9741 [00:33<00:20, 180.98it/s] 61%|██████████████████████████████████████████████▌                             | 5967/9741 [00:33<00:20, 183.60it/s] 61%|██████████████████████████████████████████████▋                             | 5986/9741 [00:33<00:20, 181.34it/s] 62%|██████████████████████████████████████████████▊                             | 6005/9741 [00:33<00:20, 183.27it/s] 62%|██████████████████████████████████████████████▉                             | 6024/9741 [00:33<00:20, 179.27it/s] 62%|███████████████████████████████████████████████▏                            | 6042/9741 [00:33<00:21, 176.06it/s] 62%|███████████████████████████████████████████████▎                            | 6060/9741 [00:33<00:20, 177.02it/s] 62%|███████████████████████████████████████████████▍                            | 6079/9741 [00:33<00:20, 180.16it/s] 63%|███████████████████████████████████████████████▌                            | 6098/9741 [00:33<00:20, 182.05it/s] 63%|███████████████████████████████████████████████▋                            | 6117/9741 [00:34<00:19, 182.17it/s] 63%|███████████████████████████████████████████████▊                            | 6136/9741 [00:34<00:20, 174.17it/s] 63%|████████████████████████████████████████████████                            | 6155/9741 [00:34<00:20, 178.10it/s] 63%|████████████████████████████████████████████████▏                           | 6174/9741 [00:34<00:19, 181.02it/s] 64%|████████████████████████████████████████████████▎                           | 6193/9741 [00:34<00:19, 179.74it/s] 64%|████████████████████████████████████████████████▍                           | 6212/9741 [00:34<00:19, 180.38it/s] 64%|████████████████████████████████████████████████▌                           | 6231/9741 [00:34<00:20, 175.21it/s] 64%|████████████████████████████████████████████████▊                           | 6251/9741 [00:34<00:19, 180.24it/s] 64%|████████████████████████████████████████████████▉                           | 6270/9741 [00:34<00:19, 181.47it/s] 65%|█████████████████████████████████████████████████                           | 6289/9741 [00:34<00:19, 180.88it/s] 65%|█████████████████████████████████████████████████▏                          | 6308/9741 [00:35<00:20, 170.36it/s] 65%|█████████████████████████████████████████████████▎                          | 6326/9741 [00:35<00:20, 170.71it/s] 65%|█████████████████████████████████████████████████▍                          | 6344/9741 [00:35<00:20, 165.12it/s] 65%|█████████████████████████████████████████████████▋                          | 6361/9741 [00:35<00:22, 151.70it/s] 66%|█████████████████████████████████████████████████▊                          | 6381/9741 [00:35<00:20, 162.24it/s] 66%|█████████████████████████████████████████████████▉                          | 6399/9741 [00:35<00:20, 166.59it/s] 66%|██████████████████████████████████████████████████                          | 6416/9741 [00:35<00:22, 146.90it/s] 66%|██████████████████████████████████████████████████▏                         | 6434/9741 [00:35<00:21, 155.17it/s] 66%|██████████████████████████████████████████████████▎                         | 6454/9741 [00:36<00:19, 166.16it/s] 66%|██████████████████████████████████████████████████▌                         | 6474/9741 [00:36<00:18, 174.09it/s] 67%|██████████████████████████████████████████████████▋                         | 6494/9741 [00:36<00:18, 180.14it/s] 67%|██████████████████████████████████████████████████▊                         | 6514/9741 [00:36<00:17, 183.03it/s] 67%|██████████████████████████████████████████████████▉                         | 6533/9741 [00:36<00:18, 177.83it/s] 67%|███████████████████████████████████████████████████                         | 6552/9741 [00:36<00:17, 179.43it/s] 68%|███████████████████████████████████████████████████▎                        | 6576/9741 [00:36<00:16, 195.68it/s] 68%|███████████████████████████████████████████████████▌                        | 6606/9741 [00:36<00:13, 224.67it/s] 68%|███████████████████████████████████████████████████▋                        | 6629/9741 [00:36<00:13, 224.03it/s] 68%|███████████████████████████████████████████████████▉                        | 6652/9741 [00:36<00:14, 212.74it/s] 69%|████████████████████████████████████████████████████                        | 6675/9741 [00:37<00:14, 216.14it/s] 69%|████████████████████████████████████████████████████▎                       | 6704/9741 [00:37<00:12, 237.03it/s] 69%|████████████████████████████████████████████████████▌                       | 6733/9741 [00:37<00:12, 249.64it/s] 69%|████████████████████████████████████████████████████▋                       | 6759/9741 [00:37<00:12, 240.40it/s] 70%|████████████████████████████████████████████████████▉                       | 6784/9741 [00:37<00:12, 239.68it/s] 70%|█████████████████████████████████████████████████████                       | 6809/9741 [00:37<00:12, 232.52it/s] 70%|█████████████████████████████████████████████████████▎                      | 6838/9741 [00:37<00:11, 248.56it/s] 70%|█████████████████████████████████████████████████████▌                      | 6866/9741 [00:37<00:11, 254.64it/s] 71%|█████████████████████████████████████████████████████▊                      | 6892/9741 [00:37<00:11, 246.60it/s] 71%|█████████████████████████████████████████████████████▉                      | 6917/9741 [00:38<00:11, 241.01it/s] 71%|██████████████████████████████████████████████████████▏                     | 6942/9741 [00:38<00:12, 228.49it/s] 72%|██████████████████████████████████████████████████████▍                     | 6971/9741 [00:38<00:11, 244.24it/s] 72%|██████████████████████████████████████████████████████▌                     | 6997/9741 [00:38<00:11, 245.79it/s] 72%|██████████████████████████████████████████████████████▊                     | 7022/9741 [00:38<00:11, 241.96it/s] 72%|██████████████████████████████████████████████████████▉                     | 7047/9741 [00:38<00:11, 237.66it/s] 73%|███████████████████████████████████████████████████████▏                    | 7071/9741 [00:38<00:11, 230.91it/s] 73%|███████████████████████████████████████████████████████▍                    | 7100/9741 [00:38<00:10, 245.48it/s] 73%|███████████████████████████████████████████████████████▌                    | 7125/9741 [00:38<00:10, 240.33it/s] 73%|███████████████████████████████████████████████████████▊                    | 7150/9741 [00:39<00:10, 237.48it/s] 74%|███████████████████████████████████████████████████████▉                    | 7176/9741 [00:39<00:10, 242.50it/s] 74%|████████████████████████████████████████████████████████▏                   | 7201/9741 [00:39<00:10, 231.73it/s] 74%|████████████████████████████████████████████████████████▎                   | 7225/9741 [00:39<00:11, 226.22it/s] 74%|████████████████████████████████████████████████████████▌                   | 7248/9741 [00:39<00:11, 223.20it/s] 75%|████████████████████████████████████████████████████████▋                   | 7273/9741 [00:39<00:10, 230.66it/s] 75%|████████████████████████████████████████████████████████▉                   | 7303/9741 [00:39<00:09, 248.30it/s] 75%|█████████████████████████████████████████████████████████▏                  | 7328/9741 [00:39<00:10, 230.41it/s] 75%|█████████████████████████████████████████████████████████▎                  | 7353/9741 [00:39<00:10, 233.13it/s] 76%|█████████████████████████████████████████████████████████▌                  | 7379/9741 [00:40<00:09, 238.64it/s] 76%|█████████████████████████████████████████████████████████▊                  | 7409/9741 [00:40<00:09, 254.57it/s] 76%|██████████████████████████████████████████████████████████                  | 7435/9741 [00:40<00:09, 231.75it/s] 77%|██████████████████████████████████████████████████████████▏                 | 7459/9741 [00:40<00:12, 181.70it/s] 77%|██████████████████████████████████████████████████████████▎                 | 7480/9741 [00:40<00:12, 184.51it/s] 77%|██████████████████████████████████████████████████████████▌                 | 7500/9741 [00:40<00:12, 185.46it/s] 77%|██████████████████████████████████████████████████████████▋                 | 7520/9741 [00:40<00:11, 185.26it/s] 77%|██████████████████████████████████████████████████████████▊                 | 7540/9741 [00:40<00:13, 160.74it/s] 78%|██████████████████████████████████████████████████████████▉                 | 7559/9741 [00:41<00:13, 167.81it/s] 78%|███████████████████████████████████████████████████████████                 | 7578/9741 [00:41<00:12, 172.07it/s] 78%|███████████████████████████████████████████████████████████▎                | 7596/9741 [00:41<00:12, 171.27it/s] 78%|███████████████████████████████████████████████████████████▍                | 7614/9741 [00:41<00:12, 168.30it/s] 78%|███████████████████████████████████████████████████████████▌                | 7634/9741 [00:41<00:12, 175.34it/s] 79%|███████████████████████████████████████████████████████████▋                | 7652/9741 [00:41<00:12, 173.99it/s] 79%|███████████████████████████████████████████████████████████▊                | 7670/9741 [00:41<00:13, 158.70it/s] 79%|███████████████████████████████████████████████████████████▉                | 7689/9741 [00:41<00:12, 166.63it/s] 79%|████████████████████████████████████████████████████████████▏               | 7709/9741 [00:41<00:11, 174.60it/s] 79%|████████████████████████████████████████████████████████████▎               | 7728/9741 [00:42<00:11, 176.56it/s] 80%|████████████████████████████████████████████████████████████▍               | 7746/9741 [00:42<00:11, 171.10it/s] 80%|████████████████████████████████████████████████████████████▌               | 7765/9741 [00:42<00:11, 174.50it/s] 80%|████████████████████████████████████████████████████████████▋               | 7785/9741 [00:42<00:10, 180.35it/s] 80%|████████████████████████████████████████████████████████████▉               | 7804/9741 [00:42<00:10, 181.82it/s] 80%|█████████████████████████████████████████████████████████████               | 7823/9741 [00:42<00:10, 179.26it/s] 80%|█████████████████████████████████████████████████████████████▏              | 7841/9741 [00:42<00:10, 177.30it/s] 81%|█████████████████████████████████████████████████████████████▎              | 7860/9741 [00:42<00:10, 180.02it/s] 81%|█████████████████████████████████████████████████████████████▍              | 7880/9741 [00:42<00:10, 184.20it/s] 81%|█████████████████████████████████████████████████████████████▋              | 7899/9741 [00:42<00:10, 181.13it/s] 81%|█████████████████████████████████████████████████████████████▊              | 7918/9741 [00:43<00:09, 183.22it/s] 81%|█████████████████████████████████████████████████████████████▉              | 7937/9741 [00:43<00:09, 182.79it/s] 82%|██████████████████████████████████████████████████████████████              | 7956/9741 [00:43<00:09, 181.82it/s] 82%|██████████████████████████████████████████████████████████████▏             | 7975/9741 [00:43<00:09, 183.39it/s] 82%|██████████████████████████████████████████████████████████████▎             | 7994/9741 [00:43<00:09, 184.30it/s] 82%|██████████████████████████████████████████████████████████████▌             | 8013/9741 [00:43<00:09, 183.95it/s] 82%|██████████████████████████████████████████████████████████████▋             | 8032/9741 [00:43<00:09, 185.72it/s] 83%|██████████████████████████████████████████████████████████████▊             | 8051/9741 [00:43<00:09, 177.27it/s] 83%|██████████████████████████████████████████████████████████████▉             | 8071/9741 [00:43<00:09, 182.36it/s] 83%|███████████████████████████████████████████████████████████████▏            | 8091/9741 [00:44<00:08, 186.22it/s] 83%|███████████████████████████████████████████████████████████████▎            | 8110/9741 [00:44<00:08, 186.33it/s] 83%|███████████████████████████████████████████████████████████████▍            | 8129/9741 [00:44<00:08, 184.62it/s] 84%|███████████████████████████████████████████████████████████████▌            | 8148/9741 [00:44<00:08, 177.61it/s] 84%|███████████████████████████████████████████████████████████████▋            | 8167/9741 [00:44<00:08, 180.87it/s] 84%|███████████████████████████████████████████████████████████████▉            | 8187/9741 [00:44<00:08, 185.11it/s] 84%|████████████████████████████████████████████████████████████████            | 8206/9741 [00:44<00:08, 184.46it/s] 84%|████████████████████████████████████████████████████████████████▏           | 8225/9741 [00:44<00:08, 184.78it/s] 85%|████████████████████████████████████████████████████████████████▎           | 8244/9741 [00:44<00:08, 181.04it/s] 85%|████████████████████████████████████████████████████████████████▍           | 8263/9741 [00:44<00:08, 171.91it/s] 85%|████████████████████████████████████████████████████████████████▌           | 8282/9741 [00:45<00:08, 176.11it/s] 85%|████████████████████████████████████████████████████████████████▊           | 8301/9741 [00:45<00:08, 177.77it/s] 85%|████████████████████████████████████████████████████████████████▉           | 8319/9741 [00:45<00:07, 177.85it/s] 86%|█████████████████████████████████████████████████████████████████           | 8338/9741 [00:45<00:07, 179.85it/s] 86%|█████████████████████████████████████████████████████████████████▏          | 8357/9741 [00:45<00:07, 173.38it/s] 86%|█████████████████████████████████████████████████████████████████▎          | 8376/9741 [00:45<00:07, 177.29it/s] 86%|█████████████████████████████████████████████████████████████████▍          | 8394/9741 [00:45<00:08, 168.10it/s] 86%|█████████████████████████████████████████████████████████████████▌          | 8411/9741 [00:45<00:08, 152.45it/s] 87%|█████████████████████████████████████████████████████████████████▊          | 8431/9741 [00:45<00:07, 163.79it/s] 87%|█████████████████████████████████████████████████████████████████▉          | 8448/9741 [00:46<00:07, 163.42it/s] 87%|██████████████████████████████████████████████████████████████████          | 8467/9741 [00:46<00:07, 170.25it/s] 87%|██████████████████████████████████████████████████████████████████▏         | 8487/9741 [00:46<00:07, 177.23it/s] 87%|██████████████████████████████████████████████████████████████████▎         | 8507/9741 [00:46<00:06, 181.74it/s] 88%|██████████████████████████████████████████████████████████████████▌         | 8526/9741 [00:46<00:06, 181.76it/s] 88%|██████████████████████████████████████████████████████████████████▋         | 8545/9741 [00:46<00:06, 171.09it/s] 88%|██████████████████████████████████████████████████████████████████▊         | 8563/9741 [00:46<00:07, 159.76it/s] 88%|██████████████████████████████████████████████████████████████████▉         | 8582/9741 [00:46<00:06, 167.61it/s] 88%|███████████████████████████████████████████████████████████████████         | 8602/9741 [00:46<00:06, 174.07it/s] 89%|███████████████████████████████████████████████████████████████████▎        | 8621/9741 [00:47<00:06, 177.16it/s] 89%|███████████████████████████████████████████████████████████████████▍        | 8639/9741 [00:47<00:06, 171.04it/s] 89%|███████████████████████████████████████████████████████████████████▌        | 8657/9741 [00:47<00:06, 172.56it/s] 89%|███████████████████████████████████████████████████████████████████▋        | 8677/9741 [00:47<00:05, 178.84it/s] 89%|███████████████████████████████████████████████████████████████████▊        | 8697/9741 [00:47<00:05, 182.25it/s] 89%|████████████████████████████████████████████████████████████████████        | 8716/9741 [00:47<00:05, 181.81it/s] 90%|████████████████████████████████████████████████████████████████████▏       | 8735/9741 [00:47<00:05, 181.37it/s] 90%|████████████████████████████████████████████████████████████████████▎       | 8754/9741 [00:47<00:05, 175.96it/s] 90%|████████████████████████████████████████████████████████████████████▍       | 8774/9741 [00:47<00:05, 181.40it/s] 90%|████████████████████████████████████████████████████████████████████▌       | 8793/9741 [00:48<00:05, 182.38it/s] 90%|████████████████████████████████████████████████████████████████████▊       | 8812/9741 [00:48<00:05, 181.83it/s] 91%|████████████████████████████████████████████████████████████████████▉       | 8831/9741 [00:48<00:05, 180.45it/s] 91%|█████████████████████████████████████████████████████████████████████       | 8850/9741 [00:48<00:04, 178.98it/s] 91%|█████████████████████████████████████████████████████████████████████▏      | 8870/9741 [00:48<00:04, 183.40it/s] 91%|█████████████████████████████████████████████████████████████████████▎      | 8889/9741 [00:48<00:04, 184.27it/s] 91%|█████████████████████████████████████████████████████████████████████▌      | 8908/9741 [00:48<00:04, 184.90it/s] 92%|█████████████████████████████████████████████████████████████████████▋      | 8927/9741 [00:48<00:04, 183.00it/s] 92%|█████████████████████████████████████████████████████████████████████▊      | 8946/9741 [00:48<00:04, 181.97it/s] 92%|█████████████████████████████████████████████████████████████████████▉      | 8966/9741 [00:48<00:04, 185.09it/s] 92%|██████████████████████████████████████████████████████████████████████      | 8985/9741 [00:49<00:04, 186.27it/s] 92%|██████████████████████████████████████████████████████████████████████▏     | 9004/9741 [00:49<00:03, 185.06it/s] 93%|██████████████████████████████████████████████████████████████████████▍     | 9023/9741 [00:49<00:03, 181.47it/s] 93%|██████████████████████████████████████████████████████████████████████▌     | 9042/9741 [00:49<00:03, 179.45it/s] 93%|██████████████████████████████████████████████████████████████████████▋     | 9061/9741 [00:49<00:03, 182.03it/s] 93%|██████████████████████████████████████████████████████████████████████▊     | 9080/9741 [00:49<00:03, 175.39it/s] 93%|██████████████████████████████████████████████████████████████████████▉     | 9098/9741 [00:49<00:03, 161.66it/s] 94%|███████████████████████████████████████████████████████████████████████▏    | 9118/9741 [00:49<00:03, 170.61it/s] 94%|███████████████████████████████████████████████████████████████████████▎    | 9136/9741 [00:49<00:03, 170.86it/s] 94%|███████████████████████████████████████████████████████████████████████▍    | 9154/9741 [00:50<00:03, 163.55it/s] 94%|███████████████████████████████████████████████████████████████████████▌    | 9171/9741 [00:50<00:03, 149.61it/s] 94%|███████████████████████████████████████████████████████████████████████▋    | 9191/9741 [00:50<00:03, 161.88it/s] 95%|███████████████████████████████████████████████████████████████████████▊    | 9210/9741 [00:50<00:03, 169.16it/s] 95%|███████████████████████████████████████████████████████████████████████▉    | 9228/9741 [00:50<00:02, 172.08it/s] 95%|████████████████████████████████████████████████████████████████████████▏   | 9246/9741 [00:50<00:03, 147.89it/s] 95%|████████████████████████████████████████████████████████████████████████▎   | 9263/9741 [00:50<00:03, 153.20it/s] 95%|████████████████████████████████████████████████████████████████████████▍   | 9283/9741 [00:50<00:02, 163.86it/s] 95%|████████████████████████████████████████████████████████████████████████▌   | 9301/9741 [00:50<00:02, 167.96it/s] 96%|████████████████████████████████████████████████████████████████████████▋   | 9319/9741 [00:51<00:02, 168.52it/s] 96%|████████████████████████████████████████████████████████████████████████▊   | 9337/9741 [00:51<00:02, 166.94it/s] 96%|█████████████████████████████████████████████████████████████████████████   | 9357/9741 [00:51<00:02, 174.66it/s] 96%|█████████████████████████████████████████████████████████████████████████▏  | 9377/9741 [00:51<00:02, 179.56it/s] 96%|█████████████████████████████████████████████████████████████████████████▎  | 9398/9741 [00:51<00:01, 186.96it/s] 97%|█████████████████████████████████████████████████████████████████████████▌  | 9421/9741 [00:51<00:01, 198.90it/s] 97%|█████████████████████████████████████████████████████████████████████████▋  | 9443/9741 [00:51<00:01, 204.81it/s] 97%|█████████████████████████████████████████████████████████████████████████▊  | 9468/9741 [00:51<00:01, 216.90it/s] 97%|██████████████████████████████████████████████████████████████████████████  | 9493/9741 [00:51<00:01, 225.36it/s] 98%|██████████████████████████████████████████████████████████████████████████▎ | 9517/9741 [00:52<00:00, 228.15it/s] 98%|██████████████████████████████████████████████████████████████████████████▍ | 9540/9741 [00:52<00:00, 227.34it/s] 98%|██████████████████████████████████████████████████████████████████████████▋ | 9569/9741 [00:52<00:00, 244.67it/s] 98%|██████████████████████████████████████████████████████████████████████████▊ | 9594/9741 [00:52<00:00, 242.53it/s] 99%|███████████████████████████████████████████████████████████████████████████ | 9619/9741 [00:52<00:00, 237.96it/s] 99%|███████████████████████████████████████████████████████████████████████████▏| 9643/9741 [00:52<00:00, 236.16it/s] 99%|███████████████████████████████████████████████████████████████████████████▍| 9668/9741 [00:52<00:00, 239.82it/s]100%|███████████████████████████████████████████████████████████████████████████▋| 9698/9741 [00:52<00:00, 256.16it/s]100%|███████████████████████████████████████████████████████████████████████████▊| 9724/9741 [00:52<00:00, 239.85it/s]100%|████████████████████████████████████████████████████████████████████████████| 9741/9741 [00:52<00:00, 184.07it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                                | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████████████▋                                     | 1/3 [00:06<00:13,  6.85s/it]Loading checkpoint shards:  33%|██████████████████▋                                     | 1/3 [00:06<00:13,  6.60s/it]Loading checkpoint shards:  33%|██████████████████▋                                     | 1/3 [00:07<00:15,  7.81s/it]Loading checkpoint shards:  33%|██████████████████▋                                     | 1/3 [00:07<00:15,  7.95s/it]Loading checkpoint shards:  67%|█████████████████████████████████████▎                  | 2/3 [00:15<00:07,  7.69s/it]Loading checkpoint shards:  67%|█████████████████████████████████████▎                  | 2/3 [00:13<00:06,  6.89s/it]Loading checkpoint shards:  67%|█████████████████████████████████████▎                  | 2/3 [00:16<00:08,  8.14s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:21<00:00,  7.20s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:21<00:00,  7.24s/it]
Loading checkpoint shards:  67%|█████████████████████████████████████▎                  | 2/3 [00:16<00:08,  8.12s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:19<00:00,  6.30s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:19<00:00,  6.43s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:21<00:00,  6.91s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:21<00:00,  7.21s/it]
[2023-08-08 19:47:25,304] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:22<00:00,  7.09s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:22<00:00,  7.35s/it]
[2023-08-08 19:47:36,078] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-08 19:47:36,079] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-08 19:47:36,079] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-08 19:47:36,079] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-08 19:47:36,079] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-08 19:47:36,080] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-08 19:47:36,080] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-08 19:47:36,080] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-08 19:47:36,080] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-08 19:47:36,080] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-08 19:47:36,080] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-08 19:47:36,080] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fec2f6ace80>
[2023-08-08 19:47:36,080] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-08 19:47:36,080] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-08 19:47:36,080] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-08 19:47:36,080] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-08 19:47:36,080] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-08 19:47:36,080] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-08 19:47:36,080] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-08 19:47:36,080] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-08 19:47:36,080] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-08 19:47:36,080] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-08 19:47:36,080] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-08 19:47:36,080] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-08 19:47:36,080] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-08 19:47:36,080] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-08 19:47:36,080] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-08 19:47:36,081] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-08 19:47:36,081] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-08 19:47:36,081] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-08 19:47:36,081] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-08 19:47:36,081] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-08 19:47:36,081] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-08 19:47:36,081] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-08 19:47:36,081] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-08 19:47:36,081] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-08 19:47:36,081] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-08 19:47:36,081] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-08 19:47:36,081] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-08 19:47:36,081] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-08 19:47:36,081] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-08 19:47:36,081] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-08 19:47:36,081] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-08 19:47:36,081] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-08 19:47:36,081] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7fec2f70bf10>
[2023-08-08 19:47:36,081] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-08 19:47:36,081] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-08 19:47:36,081] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-08 19:47:36,081] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-08 19:47:36,081] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-08 19:47:36,081] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-08 19:47:36,081] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-08 19:47:36,081] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-08 19:47:36,081] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-08 19:47:36,081] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-08 19:47:36,081] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-08 19:47:36,081] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-08 19:47:36,081] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-08 19:47:36,081] [INFO] [config.py:1012:print]   train_batch_size ............. 16
[2023-08-08 19:47:36,081] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  4
[2023-08-08 19:47:36,081] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-08 19:47:36,081] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-08 19:47:36,081] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-08 19:47:36,081] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-08 19:47:36,082] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-08 19:47:36,082] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-08 19:47:36,082] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-08 19:47:36,082] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 4, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.9116189479827881 seconds
Loading extension module utils...
Time to load utils op: 0.8044815063476562 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                                               | 0/63 [00:00<?, ?it/s]Loading extension module utils...
############### Example ###############
Time to load utils op: 0.9037275314331055 seconds
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following multiple choice question.

### Demonstration:
Input: For every 12 cans you recycle, you receive $0.50, and for every 5 kilograms of newspapers, you receive $1.50. If your family collected 144 cans and 20 kilograms of newspapers, how much money would you receive?
Rationales: To solve this problem, you first need to determine how many sets of each recyclable the family collected. 

First, you would need to calculate how many sets of cans have been collected:
There are 12 cans in a set, with 144 total cans. Therefore you can calculate the number of sets as 144 divided by 12, which equals 12.

Then, calculate the total payout for the cans:
Each set of cans earns $0.50. With 12 sets collected, you multiply 12 by $0.50 to get $6.00.

Second, you determine how many set of newspapers were collected:
One set is made up of 5 kilograms of newspapers, and there is a total of 20 kilograms. Therefore, the number of sets is 20 divided by 5, which equals 4.

Then, calculate the total payout for the newspapers:
Each set of newspapers earns $1.50. With 4 sets collected, you multiply 4 by $1.50 to get $6.00.

Finally, add together the amounts from the cans and newspapers:
$6.00 for cans and $6.00 for newspapers gives a total of $12.00. 

So, the family would receive $12.00 total for their recycling.
Answer: 12

Input: Betty picked 16 strawberries. Matthew picked 20 more strawberries than Betty and twice as many as Natalie. They used their strawberries to make jam. One jar of jam used 7 strawberries and they sold each jar at $4. How much money were they able to make from the strawberries they picked?
Rationales: Question: Betty picked 16 strawberries. Matthew picked 20 more strawberries than Betty and twice as many as Natalie. They used their strawberries to make jam. One jar of jam used 7 strawberries and they sold each jar at $4. How much money were they able to make from the strawberries they picked?

Reasoning:

Step 1: Determine how many strawberries Matthew picked. The problem tells us that Matthew picked 20 more strawberries than Betty, who picked 16. This can be calculated as: 
        Matthew = Betty + 20
                 = 16 + 20
                 = 36 strawberries.

Step 2: Determine how many strawberries Natalie picked. The problem tells us that Matthew picked twice as many strawberries as Natalie. This can be calculated as:
        Natalie = Matthew / 2
                 = 36 / 2
                 = 18 strawberries.

Step 3: Calculate the total strawberries picked by Betty, Matthew, and Natalie. This can be calculated as:
        Total strawberries = Betty + Matthew + Natalie
                           = 16 + 36 + 18
                           = 70 strawberries.

Step 4: Determine how many jars of jam they can make. The problem tells us that one jar of jam used 7 strawberries. This can be calculated as:
        Jars of jam = Total strawberries / Strawberries per jar
                    = 70 / 7
                    = 10 jars.

Step 5: Calculate how much money they made from selling the jars of jam. The problem tells us that they sold each jar for $4. This can be calculated as:
        Money made = Jars of jam * Price per jar
                   = 10 * 4
                   = $40.

Answer: $40.
Answer: 40

Input: Jack has a stack of books that is 12 inches thick. He knows from experience that 80 pages is one inch thick. If he has 6 books, how many pages is each one on average?
Rationales: Intermediate Reasoning Steps:
1. Jack's stack of books measures 12 inches in thickness.
2. From Jack's experience, we know that 1 inch correlates to 80 pages. 
3. To find out how many pages equal the total inches of the stack, we have to multiply the total inches (12) by pages per inch (80). This equation comes out to be 80 x 12 = 960 pages. 
4. Now we have that the total number of pages in the stack of books is 960. 
5. Jack has 6 books, and we need to determine how many pages each book contains on average. 
6. To find this, we divide the total number of pages (960) by the number of books (6).
7. This division, 960 / 6, is calculated as 160. 
8. Therefore, on average, each book in Jack's stack contains 160 pages.
Answer: 160

Input: James dumps his whole collection of 500 Legos on the floor and starts building a castle out of them.  He uses half the pieces before finishing and is told to put the rest away.  He puts all of the leftover pieces back in the box they came from, except for 5 missing pieces that he can't find.  How many Legos are in the box at the end?
Rationales: James starts with a total of 500 Legos.

Then, he uses half of them, which is 500 Legos divided by 2. This means he has used 250 Legos for his castle.

So, he has 250 Legos unused after building the castle.

However, there were 5 missing pieces that he couldn't find. 

Therefore, he was only able to return 250 Legos minus 5 missing Legos into the box.

Finally, there are 245 Legos in the box at the end.
Answer: 245

Input: Ines had $20 in her purse. She bought 3 pounds of peaches, which are $2 per pound at the local farmers’ market. How much did she have left?
Rationales: Ines initially has $20.
The cost of the peaches Ines bought can be calculated by multiplying the quantity (3 pounds) by the price per unit ($2 per pound). So, the cost is 3 * $2 = $6.
To find out how much she has left, subtract the cost of the peaches from her initial amount. That is $20 - $6 = $14. Answer: \boxed{14}.
Answer: 14

### Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid

### Response:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o5-tgsm8k-s42-rTrue
Loading extension module utils...
Time to load utils op: 0.9066815376281738 seconds
Evaluating commonsenseqa :   0%|                                                               | 0/63 [00:04<?, ?it/s]
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 137, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 115, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/minillm/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/minillm/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 137, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 115, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/minillm/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/minillm/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 137, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 115, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/minillm/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/minillm/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 137, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 115, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/minillm/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/minillm/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 689202) of binary: /home/ylu130/.conda/envs/distllm/bin/python
Traceback (most recent call last):
  File "/home/ylu130/.conda/envs/distllm/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 345, in wrapper
    return f(*args, **kwargs)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 761, in main
    run(args)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 752, in run
    elastic_launch(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 131, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 245, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
/home/ylu130/workspace/in-context-generalization/inference.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2023-08-08_19:47:48
  host      : ia1.wse.jhu.edu
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 689203)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2023-08-08_19:47:48
  host      : ia1.wse.jhu.edu
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 689204)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2023-08-08_19:47:48
  host      : ia1.wse.jhu.edu
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 689205)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2023-08-08_19:47:48
  host      : ia1.wse.jhu.edu
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 689202)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name gsm8k --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 4 --seed 42 --data-dir /scratch/ylu130/processed_data/commonsenseqa/out-domain/o6-tgsm8k-s42-rTrue --rationales --num-out-domain 6
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
using world size: 4
[nltk_data]   Package punkt is already up-to-date![nltk_data]   Package punkt is already up-to-date!

[2023-08-08 19:47:52,323] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/out-domain/o6-tgsm8k-s42-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 6
  out_domain_data_name ......... gsm8k
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o6-tgsm8k-s42-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 4
  clip_grad .................... 1.0
  seed ......................... 42
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                        | 0/9741 [00:00<?, ?it/s]  0%|▏                                                                             | 19/9741 [00:00<00:52, 185.39it/s]  0%|▎                                                                             | 39/9741 [00:00<00:51, 188.47it/s]  1%|▍                                                                             | 58/9741 [00:00<00:52, 182.86it/s]  1%|▌                                                                             | 77/9741 [00:00<00:57, 168.73it/s]  1%|▊                                                                             | 96/9741 [00:00<00:54, 175.62it/s]  1%|▉                                                                            | 114/9741 [00:00<00:59, 160.75it/s]  1%|█                                                                            | 133/9741 [00:00<00:57, 167.99it/s]  2%|█▏                                                                           | 152/9741 [00:00<00:55, 171.69it/s]  2%|█▎                                                                           | 170/9741 [00:00<00:56, 168.33it/s]  2%|█▍                                                                           | 187/9741 [00:01<01:03, 150.40it/s]  2%|█▌                                                                           | 205/9741 [00:01<01:00, 157.46it/s]  2%|█▊                                                                           | 225/9741 [00:01<00:56, 167.45it/s]  3%|█▉                                                                           | 244/9741 [00:01<00:55, 171.88it/s]  3%|██                                                                           | 263/9741 [00:01<00:54, 175.11it/s]  3%|██▏                                                                          | 281/9741 [00:01<00:55, 171.47it/s]  3%|██▎                                                                          | 300/9741 [00:01<00:53, 176.67it/s]  3%|██▌                                                                          | 320/9741 [00:01<00:51, 181.83it/s]  3%|██▋                                                                          | 340/9741 [00:01<00:51, 184.13it/s]  4%|██▊                                                                          | 359/9741 [00:02<00:51, 182.80it/s]  4%|██▉                                                                          | 378/9741 [00:02<00:51, 181.37it/s]  4%|███▏                                                                         | 397/9741 [00:02<00:52, 177.83it/s]  4%|███▎                                                                         | 417/9741 [00:02<00:50, 183.20it/s]  4%|███▍                                                                         | 437/9741 [00:02<00:49, 186.76it/s]  5%|███▌                                                                         | 456/9741 [00:02<00:49, 187.43it/s]  5%|███▊                                                                         | 475/9741 [00:02<00:50, 184.20it/s]  5%|███▉                                                                         | 494/9741 [00:02<00:54, 170.59it/s]  5%|████                                                                         | 512/9741 [00:02<00:53, 171.30it/s]  5%|████▏                                                                        | 531/9741 [00:03<00:52, 175.44it/s]  6%|████▎                                                                        | 551/9741 [00:03<00:51, 180.07it/s]  6%|████▌                                                                        | 570/9741 [00:03<00:50, 179.85it/s]  6%|████▋                                                                        | 589/9741 [00:03<00:50, 180.53it/s]  6%|████▊                                                                        | 608/9741 [00:03<00:51, 176.62it/s]  6%|████▉                                                                        | 626/9741 [00:03<00:51, 176.71it/s]  7%|█████                                                                        | 647/9741 [00:03<00:49, 182.85it/s]  7%|█████▎                                                                       | 666/9741 [00:03<00:50, 180.37it/s]  7%|█████▍                                                                       | 685/9741 [00:03<00:50, 181.11it/s]  7%|█████▌                                                                       | 704/9741 [00:03<00:49, 182.91it/s]  7%|█████▋                                                                       | 723/9741 [00:04<00:51, 174.52it/s]  8%|█████▊                                                                       | 742/9741 [00:04<00:50, 177.98it/s]  8%|██████                                                                       | 762/9741 [00:04<00:49, 182.06it/s]  8%|██████▏                                                                      | 781/9741 [00:04<00:50, 178.63it/s]  8%|██████▎                                                                      | 799/9741 [00:04<00:50, 176.36it/s]  8%|██████▍                                                                      | 818/9741 [00:04<00:50, 176.15it/s]  9%|██████▌                                                                      | 836/9741 [00:04<00:51, 173.47it/s]  9%|██████▊                                                                      | 857/9741 [00:04<00:48, 181.93it/s]  9%|██████▉                                                                      | 876/9741 [00:04<00:48, 181.87it/s]  9%|███████                                                                      | 895/9741 [00:05<00:48, 181.26it/s]  9%|███████▏                                                                     | 914/9741 [00:05<00:48, 181.22it/s] 10%|███████▍                                                                     | 933/9741 [00:05<00:48, 181.88it/s] 10%|███████▌                                                                     | 952/9741 [00:05<00:49, 178.47it/s] 10%|███████▋                                                                     | 973/9741 [00:05<00:47, 184.90it/s] 10%|███████▊                                                                     | 992/9741 [00:05<00:47, 185.46it/s] 10%|███████▉                                                                    | 1011/9741 [00:05<00:48, 181.32it/s] 11%|████████                                                                    | 1030/9741 [00:05<00:47, 182.21it/s] 11%|████████▏                                                                   | 1049/9741 [00:05<00:48, 179.11it/s] 11%|████████▎                                                                   | 1069/9741 [00:06<00:47, 182.69it/s] 11%|████████▌                                                                   | 1090/9741 [00:06<00:45, 188.82it/s] 11%|████████▋                                                                   | 1110/9741 [00:06<00:45, 190.15it/s] 12%|████████▊                                                                   | 1130/9741 [00:06<00:45, 190.71it/s] 12%|████████▉                                                                   | 1150/9741 [00:06<00:49, 173.81it/s] 12%|█████████                                                                   | 1168/9741 [00:06<00:53, 160.06it/s] 12%|█████████▎                                                                  | 1188/9741 [00:06<00:50, 170.17it/s] 12%|█████████▍                                                                  | 1208/9741 [00:06<00:47, 178.14it/s] 13%|█████████▌                                                                  | 1228/9741 [00:06<00:46, 181.83it/s] 13%|█████████▋                                                                  | 1248/9741 [00:07<00:45, 186.16it/s] 13%|█████████▉                                                                  | 1267/9741 [00:07<00:45, 184.70it/s] 13%|██████████                                                                  | 1288/9741 [00:07<00:44, 190.06it/s] 13%|██████████▏                                                                 | 1308/9741 [00:07<00:44, 190.75it/s] 14%|██████████▎                                                                 | 1328/9741 [00:07<00:43, 193.11it/s] 14%|██████████▌                                                                 | 1348/9741 [00:07<00:44, 190.73it/s] 14%|██████████▋                                                                 | 1368/9741 [00:07<00:45, 185.74it/s] 14%|██████████▊                                                                 | 1389/9741 [00:07<00:43, 190.27it/s] 14%|██████████▉                                                                 | 1409/9741 [00:07<00:43, 191.49it/s] 15%|███████████▏                                                                | 1429/9741 [00:07<00:43, 190.84it/s] 15%|███████████▎                                                                | 1449/9741 [00:08<00:51, 159.81it/s] 15%|███████████▍                                                                | 1466/9741 [00:08<00:51, 159.48it/s] 15%|███████████▌                                                                | 1487/9741 [00:08<00:48, 170.94it/s] 15%|███████████▊                                                                | 1507/9741 [00:08<00:46, 176.71it/s] 16%|███████████▉                                                                | 1527/9741 [00:08<00:45, 181.23it/s] 16%|████████████                                                                | 1547/9741 [00:08<00:44, 185.96it/s] 16%|████████████▏                                                               | 1566/9741 [00:08<00:44, 183.48it/s] 16%|████████████▎                                                               | 1586/9741 [00:08<00:43, 186.36it/s] 16%|████████████▌                                                               | 1607/9741 [00:08<00:42, 190.74it/s] 17%|████████████▋                                                               | 1627/9741 [00:09<00:43, 188.47it/s] 17%|████████████▊                                                               | 1646/9741 [00:09<00:46, 174.20it/s] 17%|████████████▉                                                               | 1664/9741 [00:09<00:49, 164.02it/s] 17%|█████████████▏                                                              | 1684/9741 [00:09<00:46, 172.04it/s] 17%|█████████████▎                                                              | 1703/9741 [00:09<00:45, 175.90it/s] 18%|█████████████▍                                                              | 1723/9741 [00:09<00:44, 180.13it/s] 18%|█████████████▌                                                              | 1742/9741 [00:09<00:43, 182.90it/s] 18%|█████████████▋                                                              | 1762/9741 [00:09<00:42, 187.79it/s] 18%|█████████████▉                                                              | 1782/9741 [00:09<00:42, 188.23it/s] 18%|██████████████                                                              | 1801/9741 [00:10<00:48, 165.10it/s] 19%|██████████████▏                                                             | 1821/9741 [00:10<00:45, 173.61it/s] 19%|██████████████▎                                                             | 1841/9741 [00:10<00:44, 178.81it/s] 19%|██████████████▌                                                             | 1861/9741 [00:10<00:42, 184.47it/s] 19%|██████████████▋                                                             | 1880/9741 [00:10<00:42, 184.54it/s] 20%|██████████████▊                                                             | 1900/9741 [00:10<00:41, 187.26it/s] 20%|██████████████▉                                                             | 1919/9741 [00:10<00:43, 179.78it/s] 20%|███████████████                                                             | 1938/9741 [00:10<00:44, 174.22it/s] 20%|███████████████▎                                                            | 1959/9741 [00:10<00:42, 182.23it/s] 20%|███████████████▍                                                            | 1978/9741 [00:11<00:42, 182.31it/s] 21%|███████████████▌                                                            | 1997/9741 [00:11<00:42, 180.89it/s] 21%|███████████████▋                                                            | 2016/9741 [00:11<00:48, 159.76it/s] 21%|███████████████▉                                                            | 2037/9741 [00:11<00:45, 171.04it/s] 21%|████████████████                                                            | 2057/9741 [00:11<00:43, 178.43it/s] 21%|████████████████▏                                                           | 2076/9741 [00:11<00:43, 176.43it/s] 22%|████████████████▎                                                           | 2096/9741 [00:11<00:42, 181.13it/s] 22%|████████████████▌                                                           | 2116/9741 [00:11<00:41, 184.57it/s] 22%|████████████████▋                                                           | 2137/9741 [00:11<00:40, 189.35it/s] 22%|████████████████▊                                                           | 2157/9741 [00:12<00:39, 191.24it/s] 22%|████████████████▉                                                           | 2177/9741 [00:12<00:40, 186.02it/s] 23%|█████████████████▏                                                          | 2197/9741 [00:12<00:39, 189.02it/s] 23%|█████████████████▎                                                          | 2217/9741 [00:12<00:39, 190.49it/s] 23%|█████████████████▍                                                          | 2237/9741 [00:12<00:38, 193.15it/s] 23%|█████████████████▌                                                          | 2257/9741 [00:12<00:38, 192.98it/s] 23%|█████████████████▊                                                          | 2277/9741 [00:12<00:38, 192.37it/s] 24%|█████████████████▉                                                          | 2297/9741 [00:12<00:42, 174.61it/s] 24%|██████████████████                                                          | 2315/9741 [00:12<00:45, 162.29it/s] 24%|██████████████████▏                                                         | 2335/9741 [00:13<00:43, 171.66it/s] 24%|██████████████████▎                                                         | 2355/9741 [00:13<00:41, 179.14it/s] 24%|██████████████████▌                                                         | 2374/9741 [00:13<00:41, 177.27it/s] 25%|██████████████████▋                                                         | 2392/9741 [00:13<00:43, 168.98it/s] 25%|██████████████████▊                                                         | 2410/9741 [00:13<00:47, 154.53it/s] 25%|██████████████████▉                                                         | 2430/9741 [00:13<00:43, 166.18it/s] 25%|███████████████████                                                         | 2451/9741 [00:13<00:41, 176.22it/s] 25%|███████████████████▎                                                        | 2471/9741 [00:13<00:40, 180.34it/s] 26%|███████████████████▍                                                        | 2490/9741 [00:13<00:40, 178.99it/s] 26%|███████████████████▌                                                        | 2510/9741 [00:14<00:39, 183.35it/s] 26%|███████████████████▋                                                        | 2530/9741 [00:14<00:38, 187.45it/s] 26%|███████████████████▉                                                        | 2550/9741 [00:14<00:37, 189.81it/s] 26%|████████████████████                                                        | 2570/9741 [00:14<00:37, 189.86it/s] 27%|████████████████████▏                                                       | 2590/9741 [00:14<00:37, 189.70it/s] 27%|████████████████████▎                                                       | 2610/9741 [00:14<00:42, 166.87it/s] 27%|████████████████████▌                                                       | 2628/9741 [00:14<00:42, 166.81it/s] 27%|████████████████████▋                                                       | 2648/9741 [00:14<00:40, 175.39it/s] 27%|████████████████████▊                                                       | 2667/9741 [00:14<00:39, 178.32it/s] 28%|████████████████████▉                                                       | 2687/9741 [00:15<00:38, 182.82it/s] 28%|█████████████████████                                                       | 2706/9741 [00:15<00:42, 164.32it/s] 28%|█████████████████████▎                                                      | 2726/9741 [00:15<00:40, 172.85it/s] 28%|█████████████████████▍                                                      | 2745/9741 [00:15<00:39, 177.00it/s] 28%|█████████████████████▌                                                      | 2764/9741 [00:15<00:38, 180.59it/s] 29%|█████████████████████▋                                                      | 2784/9741 [00:15<00:37, 185.02it/s] 29%|█████████████████████▊                                                      | 2803/9741 [00:15<00:37, 184.06it/s] 29%|██████████████████████                                                      | 2822/9741 [00:15<00:39, 175.24it/s] 29%|██████████████████████▏                                                     | 2843/9741 [00:15<00:37, 183.15it/s] 29%|██████████████████████▎                                                     | 2863/9741 [00:15<00:36, 187.03it/s] 30%|██████████████████████▍                                                     | 2883/9741 [00:16<00:36, 189.00it/s] 30%|██████████████████████▋                                                     | 2902/9741 [00:16<00:36, 188.64it/s] 30%|██████████████████████▊                                                     | 2921/9741 [00:16<00:37, 184.32it/s] 30%|██████████████████████▉                                                     | 2941/9741 [00:16<00:36, 186.95it/s] 30%|███████████████████████                                                     | 2962/9741 [00:16<00:35, 191.08it/s] 31%|███████████████████████▎                                                    | 2982/9741 [00:16<00:35, 191.72it/s] 31%|███████████████████████▍                                                    | 3002/9741 [00:16<00:35, 192.10it/s] 31%|███████████████████████▌                                                    | 3022/9741 [00:16<00:35, 187.26it/s] 31%|███████████████████████▋                                                    | 3043/9741 [00:16<00:35, 191.12it/s] 31%|███████████████████████▉                                                    | 3063/9741 [00:17<00:34, 192.59it/s] 32%|████████████████████████                                                    | 3083/9741 [00:17<00:34, 191.45it/s] 32%|████████████████████████▏                                                   | 3103/9741 [00:17<00:34, 193.03it/s] 32%|████████████████████████▎                                                   | 3123/9741 [00:17<00:34, 190.13it/s] 32%|████████████████████████▌                                                   | 3143/9741 [00:17<00:35, 188.20it/s] 32%|████████████████████████▋                                                   | 3163/9741 [00:17<00:34, 190.34it/s] 33%|████████████████████████▊                                                   | 3183/9741 [00:17<00:34, 190.82it/s] 33%|████████████████████████▉                                                   | 3203/9741 [00:17<00:34, 192.25it/s] 33%|█████████████████████████▏                                                  | 3223/9741 [00:17<00:34, 189.44it/s] 33%|█████████████████████████▎                                                  | 3242/9741 [00:17<00:34, 189.21it/s] 33%|█████████████████████████▍                                                  | 3263/9741 [00:18<00:33, 192.65it/s] 34%|█████████████████████████▌                                                  | 3283/9741 [00:18<00:33, 192.88it/s] 34%|█████████████████████████▊                                                  | 3303/9741 [00:18<00:33, 192.64it/s] 34%|█████████████████████████▉                                                  | 3323/9741 [00:18<00:33, 193.21it/s] 34%|██████████████████████████                                                  | 3343/9741 [00:18<00:35, 179.01it/s] 35%|██████████████████████████▏                                                 | 3363/9741 [00:18<00:34, 184.78it/s] 35%|██████████████████████████▍                                                 | 3383/9741 [00:18<00:33, 187.13it/s] 35%|██████████████████████████▌                                                 | 3402/9741 [00:18<00:34, 186.11it/s] 35%|██████████████████████████▋                                                 | 3421/9741 [00:18<00:38, 165.30it/s] 35%|██████████████████████████▊                                                 | 3440/9741 [00:19<00:36, 171.32it/s] 36%|██████████████████████████▉                                                 | 3460/9741 [00:19<00:35, 179.13it/s] 36%|███████████████████████████▏                                                | 3480/9741 [00:19<00:34, 183.01it/s] 36%|███████████████████████████▎                                                | 3499/9741 [00:19<00:35, 175.24it/s] 36%|███████████████████████████▍                                                | 3517/9741 [00:19<00:37, 165.34it/s] 36%|███████████████████████████▌                                                | 3537/9741 [00:19<00:35, 174.06it/s] 37%|███████████████████████████▋                                                | 3556/9741 [00:19<00:34, 178.35it/s] 37%|███████████████████████████▉                                                | 3576/9741 [00:19<00:33, 183.06it/s] 37%|████████████████████████████                                                | 3596/9741 [00:19<00:33, 185.70it/s] 37%|████████████████████████████▏                                               | 3616/9741 [00:20<00:32, 188.89it/s] 37%|████████████████████████████▎                                               | 3635/9741 [00:20<00:32, 187.83it/s] 38%|████████████████████████████▌                                               | 3654/9741 [00:20<00:32, 185.39it/s] 38%|████████████████████████████▋                                               | 3674/9741 [00:20<00:32, 187.47it/s] 38%|████████████████████████████▊                                               | 3695/9741 [00:20<00:31, 191.57it/s] 38%|████████████████████████████▉                                               | 3715/9741 [00:20<00:31, 192.38it/s] 38%|█████████████████████████████▏                                              | 3735/9741 [00:20<00:31, 188.63it/s] 39%|█████████████████████████████▎                                              | 3754/9741 [00:20<00:33, 176.70it/s] 39%|█████████████████████████████▍                                              | 3774/9741 [00:20<00:32, 182.38it/s] 39%|█████████████████████████████▌                                              | 3793/9741 [00:21<00:32, 182.18it/s] 39%|█████████████████████████████▋                                              | 3813/9741 [00:21<00:32, 184.25it/s] 39%|█████████████████████████████▉                                              | 3832/9741 [00:21<00:32, 184.09it/s] 40%|██████████████████████████████                                              | 3851/9741 [00:21<00:35, 166.97it/s] 40%|██████████████████████████████▏                                             | 3871/9741 [00:21<00:33, 174.93it/s] 40%|██████████████████████████████▎                                             | 3889/9741 [00:21<00:33, 174.77it/s] 40%|██████████████████████████████▍                                             | 3909/9741 [00:21<00:32, 179.86it/s] 40%|██████████████████████████████▋                                             | 3928/9741 [00:21<00:35, 162.33it/s] 41%|██████████████████████████████▊                                             | 3946/9741 [00:21<00:35, 164.49it/s] 41%|██████████████████████████████▉                                             | 3964/9741 [00:22<00:34, 167.98it/s] 41%|███████████████████████████████                                             | 3983/9741 [00:22<00:33, 172.79it/s] 41%|███████████████████████████████▏                                            | 4001/9741 [00:22<00:36, 158.05it/s] 41%|███████████████████████████████▎                                            | 4020/9741 [00:22<00:34, 165.12it/s] 41%|███████████████████████████████▌                                            | 4041/9741 [00:22<00:32, 175.37it/s] 42%|███████████████████████████████▋                                            | 4059/9741 [00:22<00:32, 175.75it/s] 42%|███████████████████████████████▊                                            | 4080/9741 [00:22<00:30, 183.35it/s] 42%|███████████████████████████████▉                                            | 4100/9741 [00:22<00:30, 186.87it/s] 42%|████████████████████████████████▏                                           | 4119/9741 [00:22<00:30, 183.63it/s] 42%|████████████████████████████████▎                                           | 4138/9741 [00:23<00:35, 156.14it/s] 43%|████████████████████████████████▍                                           | 4156/9741 [00:23<00:34, 160.45it/s] 43%|████████████████████████████████▌                                           | 4177/9741 [00:23<00:32, 171.87it/s] 43%|████████████████████████████████▋                                           | 4197/9741 [00:23<00:31, 178.06it/s] 43%|████████████████████████████████▉                                           | 4216/9741 [00:23<00:30, 178.90it/s] 43%|█████████████████████████████████                                           | 4235/9741 [00:23<00:36, 149.55it/s] 44%|█████████████████████████████████▏                                          | 4253/9741 [00:23<00:35, 156.32it/s] 44%|█████████████████████████████████▎                                          | 4270/9741 [00:23<00:35, 152.51it/s] 44%|█████████████████████████████████▍                                          | 4289/9741 [00:23<00:33, 160.93it/s] 44%|█████████████████████████████████▌                                          | 4309/9741 [00:24<00:32, 169.14it/s] 44%|█████████████████████████████████▊                                          | 4327/9741 [00:24<00:31, 171.71it/s] 45%|█████████████████████████████████▉                                          | 4346/9741 [00:24<00:30, 175.82it/s] 45%|██████████████████████████████████                                          | 4366/9741 [00:24<00:29, 181.15it/s] 45%|██████████████████████████████████▏                                         | 4386/9741 [00:24<00:29, 184.46it/s] 45%|██████████████████████████████████▎                                         | 4405/9741 [00:24<00:31, 167.23it/s] 45%|██████████████████████████████████▌                                         | 4423/9741 [00:24<00:32, 164.83it/s] 46%|██████████████████████████████████▋                                         | 4442/9741 [00:24<00:31, 169.72it/s] 46%|██████████████████████████████████▊                                         | 4462/9741 [00:24<00:29, 177.55it/s] 46%|██████████████████████████████████▉                                         | 4482/9741 [00:25<00:28, 181.45it/s] 46%|███████████████████████████████████                                         | 4501/9741 [00:25<00:32, 162.14it/s] 46%|███████████████████████████████████▏                                        | 4518/9741 [00:25<00:40, 129.46it/s] 47%|███████████████████████████████████▍                                        | 4538/9741 [00:25<00:35, 144.83it/s] 47%|███████████████████████████████████▌                                        | 4558/9741 [00:25<00:33, 156.63it/s] 47%|███████████████████████████████████▋                                        | 4578/9741 [00:25<00:30, 166.97it/s] 47%|███████████████████████████████████▊                                        | 4598/9741 [00:25<00:29, 174.13it/s] 47%|████████████████████████████████████                                        | 4617/9741 [00:25<00:28, 178.06it/s] 48%|████████████████████████████████████▏                                       | 4636/9741 [00:26<00:28, 180.32it/s] 48%|████████████████████████████████████▎                                       | 4655/9741 [00:26<00:28, 181.28it/s] 48%|████████████████████████████████████▍                                       | 4674/9741 [00:26<00:29, 171.77it/s] 48%|████████████████████████████████████▌                                       | 4692/9741 [00:26<00:29, 171.55it/s] 48%|████████████████████████████████████▊                                       | 4712/9741 [00:26<00:28, 178.00it/s] 49%|████████████████████████████████████▉                                       | 4731/9741 [00:26<00:27, 180.14it/s] 49%|█████████████████████████████████████▌                                       | 4750/9741 [00:26<00:51, 96.59it/s] 49%|█████████████████████████████████████▏                                      | 4770/9741 [00:27<00:43, 114.46it/s] 49%|█████████████████████████████████████▎                                      | 4790/9741 [00:27<00:37, 131.53it/s] 49%|█████████████████████████████████████▌                                      | 4809/9741 [00:27<00:34, 143.41it/s] 50%|█████████████████████████████████████▋                                      | 4827/9741 [00:27<00:32, 151.43it/s] 50%|█████████████████████████████████████▊                                      | 4846/9741 [00:27<00:30, 161.01it/s] 50%|█████████████████████████████████████▉                                      | 4866/9741 [00:27<00:28, 169.87it/s] 50%|██████████████████████████████████████                                      | 4886/9741 [00:27<00:27, 177.41it/s] 50%|██████████████████████████████████████▎                                     | 4907/9741 [00:27<00:26, 183.80it/s] 51%|██████████████████████████████████████▍                                     | 4927/9741 [00:27<00:25, 186.06it/s] 51%|██████████████████████████████████████▌                                     | 4947/9741 [00:28<00:27, 172.26it/s] 51%|██████████████████████████████████████▋                                     | 4965/9741 [00:28<00:28, 165.57it/s] 51%|██████████████████████████████████████▉                                     | 4985/9741 [00:28<00:27, 174.77it/s] 51%|███████████████████████████████████████                                     | 5004/9741 [00:28<00:26, 178.45it/s] 52%|███████████████████████████████████████▏                                    | 5023/9741 [00:28<00:26, 179.23it/s] 52%|███████████████████████████████████████▎                                    | 5042/9741 [00:28<00:30, 156.59it/s] 52%|███████████████████████████████████████▍                                    | 5060/9741 [00:28<00:29, 161.38it/s] 52%|███████████████████████████████████████▋                                    | 5081/9741 [00:28<00:27, 172.43it/s] 52%|███████████████████████████████████████▊                                    | 5100/9741 [00:28<00:26, 176.45it/s] 53%|███████████████████████████████████████▉                                    | 5118/9741 [00:29<00:26, 176.85it/s] 53%|████████████████████████████████████████                                    | 5136/9741 [00:29<00:27, 164.63it/s] 53%|████████████████████████████████████████▏                                   | 5156/9741 [00:29<00:26, 173.24it/s] 53%|████████████████████████████████████████▍                                   | 5175/9741 [00:29<00:25, 176.42it/s] 53%|████████████████████████████████████████▌                                   | 5194/9741 [00:29<00:25, 178.25it/s] 54%|████████████████████████████████████████▋                                   | 5212/9741 [00:29<00:25, 178.40it/s] 54%|████████████████████████████████████████▊                                   | 5232/9741 [00:29<00:24, 182.06it/s] 54%|████████████████████████████████████████▉                                   | 5252/9741 [00:29<00:24, 185.89it/s] 54%|█████████████████████████████████████████                                   | 5271/9741 [00:29<00:24, 184.90it/s] 54%|█████████████████████████████████████████▎                                  | 5290/9741 [00:29<00:24, 185.19it/s] 55%|█████████████████████████████████████████▍                                  | 5309/9741 [00:30<00:23, 185.70it/s] 55%|█████████████████████████████████████████▌                                  | 5329/9741 [00:30<00:23, 187.63it/s] 55%|█████████████████████████████████████████▋                                  | 5349/9741 [00:30<00:23, 188.63it/s] 55%|█████████████████████████████████████████▉                                  | 5369/9741 [00:30<00:23, 190.03it/s] 55%|██████████████████████████████████████████                                  | 5389/9741 [00:30<00:23, 187.39it/s] 56%|██████████████████████████████████████████▏                                 | 5409/9741 [00:30<00:22, 189.73it/s] 56%|██████████████████████████████████████████▎                                 | 5430/9741 [00:30<00:22, 193.04it/s] 56%|██████████████████████████████████████████▌                                 | 5450/9741 [00:30<00:22, 193.12it/s] 56%|██████████████████████████████████████████▋                                 | 5470/9741 [00:30<00:22, 191.04it/s] 56%|██████████████████████████████████████████▊                                 | 5490/9741 [00:31<00:23, 180.87it/s] 57%|██████████████████████████████████████████▉                                 | 5509/9741 [00:31<00:24, 171.70it/s] 57%|███████████████████████████████████████████▏                                | 5530/9741 [00:31<00:23, 180.33it/s] 57%|███████████████████████████████████████████▎                                | 5549/9741 [00:31<00:22, 182.68it/s] 57%|███████████████████████████████████████████▍                                | 5568/9741 [00:31<00:22, 183.03it/s] 57%|███████████████████████████████████████████▌                                | 5587/9741 [00:31<00:23, 177.50it/s] 58%|███████████████████████████████████████████▋                                | 5605/9741 [00:31<00:25, 162.40it/s] 58%|███████████████████████████████████████████▉                                | 5625/9741 [00:31<00:23, 172.02it/s] 58%|████████████████████████████████████████████                                | 5644/9741 [00:31<00:23, 176.83it/s] 58%|████████████████████████████████████████████▏                               | 5663/9741 [00:32<00:22, 178.23it/s] 58%|████████████████████████████████████████████▎                               | 5681/9741 [00:32<00:23, 175.76it/s] 59%|████████████████████████████████████████████▍                               | 5699/9741 [00:32<00:25, 156.80it/s] 59%|████████████████████████████████████████████▌                               | 5719/9741 [00:32<00:23, 167.90it/s] 59%|████████████████████████████████████████████▊                               | 5739/9741 [00:32<00:22, 175.80it/s] 59%|████████████████████████████████████████████▉                               | 5758/9741 [00:32<00:22, 178.07it/s] 59%|█████████████████████████████████████████████                               | 5777/9741 [00:32<00:21, 180.24it/s] 60%|█████████████████████████████████████████████▏                              | 5796/9741 [00:32<00:23, 170.36it/s] 60%|█████████████████████████████████████████████▍                              | 5816/9741 [00:32<00:22, 178.20it/s] 60%|█████████████████████████████████████████████▌                              | 5837/9741 [00:33<00:20, 186.37it/s] 60%|█████████████████████████████████████████████▋                              | 5857/9741 [00:33<00:20, 189.12it/s] 60%|█████████████████████████████████████████████▉                              | 5882/9741 [00:33<00:18, 204.75it/s] 61%|██████████████████████████████████████████████                              | 5906/9741 [00:33<00:17, 214.02it/s] 61%|██████████████████████████████████████████████▎                             | 5930/9741 [00:33<00:17, 219.91it/s] 61%|██████████████████████████████████████████████▍                             | 5959/9741 [00:33<00:15, 239.54it/s] 61%|██████████████████████████████████████████████▋                             | 5985/9741 [00:33<00:15, 244.54it/s] 62%|██████████████████████████████████████████████▉                             | 6010/9741 [00:33<00:15, 243.64it/s] 62%|███████████████████████████████████████████████                             | 6035/9741 [00:33<00:15, 236.34it/s] 62%|███████████████████████████████████████████████▎                            | 6063/9741 [00:33<00:14, 246.75it/s] 63%|███████████████████████████████████████████████▌                            | 6094/9741 [00:34<00:13, 264.65it/s] 63%|███████████████████████████████████████████████▊                            | 6126/9741 [00:34<00:12, 278.44it/s] 63%|████████████████████████████████████████████████                            | 6155/9741 [00:34<00:12, 281.21it/s] 63%|████████████████████████████████████████████████▎                           | 6185/9741 [00:34<00:12, 284.25it/s] 64%|████████████████████████████████████████████████▍                           | 6214/9741 [00:34<00:12, 276.41it/s] 64%|████████████████████████████████████████████████▋                           | 6242/9741 [00:34<00:14, 234.99it/s] 64%|████████████████████████████████████████████████▉                           | 6267/9741 [00:34<00:15, 222.04it/s] 65%|█████████████████████████████████████████████████                           | 6291/9741 [00:34<00:16, 214.91it/s] 65%|█████████████████████████████████████████████████▎                          | 6314/9741 [00:34<00:16, 203.58it/s] 65%|█████████████████████████████████████████████████▍                          | 6335/9741 [00:35<00:16, 203.06it/s] 65%|█████████████████████████████████████████████████▌                          | 6356/9741 [00:35<00:16, 203.59it/s] 65%|█████████████████████████████████████████████████▊                          | 6377/9741 [00:35<00:16, 204.04it/s] 66%|█████████████████████████████████████████████████▉                          | 6398/9741 [00:35<00:16, 204.46it/s] 66%|██████████████████████████████████████████████████                          | 6419/9741 [00:35<00:16, 204.54it/s] 66%|██████████████████████████████████████████████████▏                         | 6440/9741 [00:35<00:16, 201.42it/s] 66%|██████████████████████████████████████████████████▍                         | 6461/9741 [00:35<00:16, 202.57it/s] 67%|██████████████████████████████████████████████████▌                         | 6482/9741 [00:35<00:17, 190.63it/s] 67%|██████████████████████████████████████████████████▋                         | 6502/9741 [00:35<00:18, 179.37it/s] 67%|██████████████████████████████████████████████████▉                         | 6522/9741 [00:36<00:17, 184.70it/s] 67%|███████████████████████████████████████████████████                         | 6541/9741 [00:36<00:17, 178.90it/s] 67%|███████████████████████████████████████████████████▏                        | 6562/9741 [00:36<00:17, 186.40it/s] 68%|███████████████████████████████████████████████████▎                        | 6583/9741 [00:36<00:16, 192.08it/s] 68%|███████████████████████████████████████████████████▌                        | 6604/9741 [00:36<00:15, 196.23it/s] 68%|███████████████████████████████████████████████████▋                        | 6625/9741 [00:36<00:15, 199.40it/s] 68%|███████████████████████████████████████████████████▊                        | 6646/9741 [00:36<00:15, 198.18it/s] 68%|████████████████████████████████████████████████████                        | 6667/9741 [00:36<00:15, 199.98it/s] 69%|████████████████████████████████████████████████████▏                       | 6688/9741 [00:36<00:15, 201.46it/s] 69%|████████████████████████████████████████████████████▎                       | 6709/9741 [00:37<00:15, 201.90it/s] 69%|████████████████████████████████████████████████████▌                       | 6730/9741 [00:37<00:14, 202.51it/s] 69%|████████████████████████████████████████████████████▋                       | 6751/9741 [00:37<00:15, 192.22it/s] 70%|████████████████████████████████████████████████████▊                       | 6771/9741 [00:37<00:17, 168.94it/s] 70%|████████████████████████████████████████████████████▉                       | 6792/9741 [00:37<00:16, 178.73it/s] 70%|█████████████████████████████████████████████████████▏                      | 6811/9741 [00:37<00:16, 179.97it/s] 70%|█████████████████████████████████████████████████████▎                      | 6830/9741 [00:37<00:16, 181.84it/s] 70%|█████████████████████████████████████████████████████▍                      | 6851/9741 [00:37<00:15, 188.05it/s] 71%|█████████████████████████████████████████████████████▌                      | 6872/9741 [00:37<00:14, 192.89it/s] 71%|█████████████████████████████████████████████████████▊                      | 6893/9741 [00:38<00:14, 196.66it/s] 71%|█████████████████████████████████████████████████████▉                      | 6914/9741 [00:38<00:14, 199.33it/s] 71%|██████████████████████████████████████████████████████                      | 6935/9741 [00:38<00:13, 201.20it/s] 71%|██████████████████████████████████████████████████████▎                     | 6956/9741 [00:38<00:13, 202.52it/s] 72%|██████████████████████████████████████████████████████▍                     | 6977/9741 [00:38<00:13, 202.47it/s] 72%|██████████████████████████████████████████████████████▌                     | 6998/9741 [00:38<00:13, 201.85it/s] 72%|██████████████████████████████████████████████████████▊                     | 7019/9741 [00:38<00:13, 201.89it/s] 72%|██████████████████████████████████████████████████████▉                     | 7040/9741 [00:38<00:13, 202.01it/s] 72%|███████████████████████████████████████████████████████                     | 7061/9741 [00:38<00:13, 193.85it/s] 73%|███████████████████████████████████████████████████████▏                    | 7081/9741 [00:38<00:14, 185.59it/s] 73%|███████████████████████████████████████████████████████▍                    | 7100/9741 [00:39<00:14, 177.28it/s] 73%|███████████████████████████████████████████████████████▌                    | 7118/9741 [00:39<00:15, 170.36it/s] 73%|███████████████████████████████████████████████████████▋                    | 7137/9741 [00:39<00:14, 175.51it/s] 73%|███████████████████████████████████████████████████████▊                    | 7157/9741 [00:39<00:14, 179.23it/s] 74%|███████████████████████████████████████████████████████▉                    | 7176/9741 [00:39<00:15, 167.85it/s] 74%|████████████████████████████████████████████████████████▏                   | 7194/9741 [00:39<00:15, 168.96it/s] 74%|████████████████████████████████████████████████████████▎                   | 7213/9741 [00:39<00:14, 173.38it/s] 74%|████████████████████████████████████████████████████████▍                   | 7233/9741 [00:39<00:13, 180.45it/s] 74%|████████████████████████████████████████████████████████▌                   | 7252/9741 [00:39<00:14, 174.42it/s] 75%|████████████████████████████████████████████████████████▋                   | 7270/9741 [00:40<00:14, 168.99it/s] 75%|████████████████████████████████████████████████████████▊                   | 7288/9741 [00:40<00:14, 168.33it/s] 75%|████████████████████████████████████████████████████████▉                   | 7305/9741 [00:40<00:14, 166.74it/s] 75%|█████████████████████████████████████████████████████████▏                  | 7322/9741 [00:40<00:14, 165.49it/s] 75%|█████████████████████████████████████████████████████████▎                  | 7339/9741 [00:40<00:14, 166.20it/s] 76%|█████████████████████████████████████████████████████████▍                  | 7356/9741 [00:40<00:14, 165.05it/s] 76%|█████████████████████████████████████████████████████████▌                  | 7373/9741 [00:40<00:14, 165.68it/s] 76%|█████████████████████████████████████████████████████████▋                  | 7390/9741 [00:40<00:14, 165.70it/s] 76%|█████████████████████████████████████████████████████████▊                  | 7407/9741 [00:40<00:14, 164.55it/s] 76%|█████████████████████████████████████████████████████████▉                  | 7424/9741 [00:41<00:14, 164.66it/s] 76%|██████████████████████████████████████████████████████████                  | 7441/9741 [00:41<00:17, 127.81it/s] 77%|██████████████████████████████████████████████████████████▏                 | 7456/9741 [00:41<00:17, 128.90it/s] 77%|██████████████████████████████████████████████████████████▎                 | 7475/9741 [00:41<00:15, 143.06it/s] 77%|██████████████████████████████████████████████████████████▍                 | 7495/9741 [00:41<00:14, 157.42it/s] 77%|██████████████████████████████████████████████████████████▋                 | 7524/9741 [00:41<00:11, 191.94it/s] 78%|██████████████████████████████████████████████████████████▉                 | 7551/9741 [00:41<00:10, 212.29it/s] 78%|███████████████████████████████████████████████████████████                 | 7573/9741 [00:41<00:10, 209.98it/s] 78%|███████████████████████████████████████████████████████████▎                | 7595/9741 [00:41<00:11, 194.97it/s] 78%|███████████████████████████████████████████████████████████▍                | 7619/9741 [00:42<00:10, 204.42it/s] 78%|███████████████████████████████████████████████████████████▌                | 7640/9741 [00:42<00:11, 175.37it/s] 79%|███████████████████████████████████████████████████████████▊                | 7659/9741 [00:42<00:11, 175.27it/s] 79%|███████████████████████████████████████████████████████████▉                | 7678/9741 [00:42<00:12, 171.82it/s] 79%|████████████████████████████████████████████████████████████▏               | 7710/9741 [00:42<00:09, 209.44it/s] 79%|████████████████████████████████████████████████████████████▎               | 7737/9741 [00:42<00:08, 223.90it/s] 80%|████████████████████████████████████████████████████████████▌               | 7761/9741 [00:42<00:08, 222.37it/s] 80%|████████████████████████████████████████████████████████████▋               | 7784/9741 [00:42<00:09, 199.42it/s] 80%|████████████████████████████████████████████████████████████▉               | 7805/9741 [00:43<00:09, 199.20it/s] 80%|█████████████████████████████████████████████████████████████               | 7826/9741 [00:43<00:10, 176.03it/s] 81%|█████████████████████████████████████████████████████████████▏              | 7845/9741 [00:43<00:10, 175.72it/s] 81%|█████████████████████████████████████████████████████████████▎              | 7864/9741 [00:43<00:12, 152.69it/s] 81%|█████████████████████████████████████████████████████████████▍              | 7881/9741 [00:43<00:11, 155.84it/s] 81%|█████████████████████████████████████████████████████████████▋              | 7901/9741 [00:43<00:11, 165.07it/s] 81%|█████████████████████████████████████████████████████████████▊              | 7921/9741 [00:43<00:10, 173.96it/s] 82%|█████████████████████████████████████████████████████████████▉              | 7940/9741 [00:43<00:10, 176.25it/s] 82%|██████████████████████████████████████████████████████████████              | 7960/9741 [00:43<00:09, 180.33it/s] 82%|██████████████████████████████████████████████████████████████▎             | 7979/9741 [00:44<00:09, 179.60it/s] 82%|██████████████████████████████████████████████████████████████▍             | 7998/9741 [00:44<00:10, 171.21it/s] 82%|██████████████████████████████████████████████████████████████▌             | 8019/9741 [00:44<00:09, 179.41it/s] 83%|██████████████████████████████████████████████████████████████▋             | 8039/9741 [00:44<00:09, 184.51it/s] 83%|██████████████████████████████████████████████████████████████▊             | 8058/9741 [00:44<00:09, 179.26it/s] 83%|███████████████████████████████████████████████████████████████             | 8078/9741 [00:44<00:09, 183.78it/s] 83%|███████████████████████████████████████████████████████████████▏            | 8097/9741 [00:44<00:09, 176.95it/s] 83%|███████████████████████████████████████████████████████████████▎            | 8117/9741 [00:44<00:08, 182.02it/s] 84%|███████████████████████████████████████████████████████████████▍            | 8138/9741 [00:44<00:08, 188.37it/s] 84%|███████████████████████████████████████████████████████████████▋            | 8159/9741 [00:45<00:08, 192.75it/s] 84%|███████████████████████████████████████████████████████████████▊            | 8179/9741 [00:45<00:08, 193.81it/s] 84%|███████████████████████████████████████████████████████████████▉            | 8199/9741 [00:45<00:08, 189.03it/s] 84%|████████████████████████████████████████████████████████████████            | 8218/9741 [00:45<00:08, 180.95it/s] 85%|████████████████████████████████████████████████████████████████▎           | 8237/9741 [00:45<00:08, 173.45it/s] 85%|████████████████████████████████████████████████████████████████▍           | 8255/9741 [00:45<00:08, 171.66it/s] 85%|████████████████████████████████████████████████████████████████▌           | 8273/9741 [00:45<00:08, 169.16it/s] 85%|████████████████████████████████████████████████████████████████▋           | 8290/9741 [00:45<00:08, 168.52it/s] 85%|████████████████████████████████████████████████████████████████▊           | 8307/9741 [00:45<00:08, 164.07it/s] 85%|████████████████████████████████████████████████████████████████▉           | 8325/9741 [00:46<00:08, 167.77it/s] 86%|█████████████████████████████████████████████████████████████████           | 8342/9741 [00:46<00:08, 167.12it/s] 86%|█████████████████████████████████████████████████████████████████▏          | 8359/9741 [00:46<00:08, 164.36it/s] 86%|█████████████████████████████████████████████████████████████████▎          | 8376/9741 [00:46<00:08, 165.51it/s] 86%|█████████████████████████████████████████████████████████████████▍          | 8393/9741 [00:46<00:08, 161.52it/s] 86%|█████████████████████████████████████████████████████████████████▌          | 8410/9741 [00:46<00:08, 159.97it/s] 87%|█████████████████████████████████████████████████████████████████▋          | 8427/9741 [00:46<00:08, 154.57it/s] 87%|█████████████████████████████████████████████████████████████████▉          | 8444/9741 [00:46<00:08, 157.39it/s] 87%|██████████████████████████████████████████████████████████████████          | 8460/9741 [00:46<00:08, 150.94it/s] 87%|██████████████████████████████████████████████████████████████████▏         | 8476/9741 [00:47<00:08, 148.97it/s] 87%|██████████████████████████████████████████████████████████████████▎         | 8497/9741 [00:47<00:07, 165.01it/s] 87%|██████████████████████████████████████████████████████████████████▍         | 8518/9741 [00:47<00:06, 176.30it/s] 88%|██████████████████████████████████████████████████████████████████▌         | 8536/9741 [00:47<00:07, 171.51it/s] 88%|██████████████████████████████████████████████████████████████████▋         | 8555/9741 [00:47<00:06, 175.97it/s] 88%|██████████████████████████████████████████████████████████████████▉         | 8573/9741 [00:47<00:06, 167.52it/s] 88%|███████████████████████████████████████████████████████████████████         | 8590/9741 [00:47<00:07, 158.58it/s] 88%|███████████████████████████████████████████████████████████████████▏        | 8607/9741 [00:47<00:07, 144.41it/s] 89%|███████████████████████████████████████████████████████████████████▎        | 8622/9741 [00:47<00:07, 141.18it/s] 89%|███████████████████████████████████████████████████████████████████▍        | 8639/9741 [00:48<00:07, 147.69it/s] 89%|███████████████████████████████████████████████████████████████████▌        | 8654/9741 [00:48<00:07, 145.55it/s] 89%|███████████████████████████████████████████████████████████████████▋        | 8669/9741 [00:48<00:07, 146.11it/s] 89%|███████████████████████████████████████████████████████████████████▊        | 8684/9741 [00:48<00:07, 145.78it/s] 89%|███████████████████████████████████████████████████████████████████▊        | 8699/9741 [00:48<00:07, 145.16it/s] 89%|████████████████████████████████████████████████████████████████████        | 8717/9741 [00:48<00:06, 154.83it/s] 90%|████████████████████████████████████████████████████████████████████▏       | 8734/9741 [00:48<00:06, 158.37it/s] 90%|████████████████████████████████████████████████████████████████████▎       | 8750/9741 [00:48<00:06, 145.69it/s] 90%|████████████████████████████████████████████████████████████████████▍       | 8765/9741 [00:48<00:06, 144.41it/s] 90%|████████████████████████████████████████████████████████████████████▌       | 8780/9741 [00:49<00:06, 141.84it/s] 90%|████████████████████████████████████████████████████████████████████▌       | 8795/9741 [00:49<00:06, 141.71it/s] 90%|████████████████████████████████████████████████████████████████████▋       | 8810/9741 [00:49<00:06, 134.39it/s] 91%|████████████████████████████████████████████████████████████████████▉       | 8828/9741 [00:49<00:06, 146.36it/s] 91%|█████████████████████████████████████████████████████████████████████       | 8845/9741 [00:49<00:05, 151.57it/s] 91%|█████████████████████████████████████████████████████████████████████▏      | 8866/9741 [00:49<00:05, 166.47it/s] 91%|█████████████████████████████████████████████████████████████████████▎      | 8883/9741 [00:49<00:05, 163.03it/s] 91%|█████████████████████████████████████████████████████████████████████▍      | 8902/9741 [00:49<00:04, 169.94it/s] 92%|█████████████████████████████████████████████████████████████████████▌      | 8921/9741 [00:49<00:04, 174.07it/s] 92%|█████████████████████████████████████████████████████████████████████▊      | 8940/9741 [00:49<00:04, 177.29it/s] 92%|█████████████████████████████████████████████████████████████████████▉      | 8958/9741 [00:50<00:04, 176.25it/s] 92%|██████████████████████████████████████████████████████████████████████      | 8976/9741 [00:50<00:04, 172.47it/s] 92%|██████████████████████████████████████████████████████████████████████▏     | 8994/9741 [00:50<00:04, 169.88it/s] 93%|██████████████████████████████████████████████████████████████████████▎     | 9012/9741 [00:50<00:04, 161.55it/s] 93%|██████████████████████████████████████████████████████████████████████▍     | 9029/9741 [00:50<00:04, 154.83it/s] 93%|██████████████████████████████████████████████████████████████████████▌     | 9045/9741 [00:50<00:04, 152.85it/s] 93%|██████████████████████████████████████████████████████████████████████▋     | 9061/9741 [00:50<00:04, 138.92it/s] 93%|██████████████████████████████████████████████████████████████████████▊     | 9076/9741 [00:50<00:05, 129.74it/s] 93%|██████████████████████████████████████████████████████████████████████▉     | 9090/9741 [00:51<00:04, 130.77it/s] 93%|███████████████████████████████████████████████████████████████████████     | 9106/9741 [00:51<00:04, 130.93it/s] 94%|███████████████████████████████████████████████████████████████████████▏    | 9120/9741 [00:51<00:05, 120.31it/s] 94%|███████████████████████████████████████████████████████████████████████▎    | 9137/9741 [00:51<00:04, 130.85it/s] 94%|███████████████████████████████████████████████████████████████████████▍    | 9151/9741 [00:51<00:04, 125.41it/s] 94%|███████████████████████████████████████████████████████████████████████▍    | 9164/9741 [00:51<00:04, 123.83it/s] 94%|███████████████████████████████████████████████████████████████████████▌    | 9177/9741 [00:51<00:04, 124.12it/s] 94%|███████████████████████████████████████████████████████████████████████▋    | 9190/9741 [00:51<00:04, 124.39it/s] 94%|███████████████████████████████████████████████████████████████████████▊    | 9204/9741 [00:51<00:04, 128.04it/s] 95%|███████████████████████████████████████████████████████████████████████▉    | 9221/9741 [00:52<00:03, 139.64it/s] 95%|████████████████████████████████████████████████████████████████████████    | 9236/9741 [00:52<00:03, 139.42it/s] 95%|████████████████████████████████████████████████████████████████████████▏   | 9251/9741 [00:52<00:03, 132.45it/s] 95%|████████████████████████████████████████████████████████████████████████▎   | 9272/9741 [00:52<00:03, 153.01it/s] 95%|████████████████████████████████████████████████████████████████████████▌   | 9293/9741 [00:52<00:02, 166.93it/s] 96%|████████████████████████████████████████████████████████████████████████▋   | 9312/9741 [00:52<00:02, 172.03it/s] 96%|████████████████████████████████████████████████████████████████████████▊   | 9330/9741 [00:52<00:02, 167.29it/s] 96%|████████████████████████████████████████████████████████████████████████▉   | 9347/9741 [00:52<00:02, 148.80it/s] 96%|█████████████████████████████████████████████████████████████████████████   | 9368/9741 [00:52<00:02, 163.87it/s] 96%|█████████████████████████████████████████████████████████████████████████▏  | 9388/9741 [00:53<00:02, 173.38it/s] 97%|█████████████████████████████████████████████████████████████████████████▍  | 9407/9741 [00:53<00:01, 175.33it/s] 97%|█████████████████████████████████████████████████████████████████████████▌  | 9426/9741 [00:53<00:01, 177.24it/s] 97%|█████████████████████████████████████████████████████████████████████████▋  | 9445/9741 [00:53<00:01, 180.13it/s] 97%|█████████████████████████████████████████████████████████████████████████▊  | 9464/9741 [00:53<00:01, 172.11it/s] 97%|█████████████████████████████████████████████████████████████████████████▉  | 9483/9741 [00:53<00:01, 175.02it/s] 98%|██████████████████████████████████████████████████████████████████████████▏ | 9501/9741 [00:53<00:01, 158.42it/s] 98%|██████████████████████████████████████████████████████████████████████████▎ | 9520/9741 [00:53<00:01, 165.24it/s] 98%|██████████████████████████████████████████████████████████████████████████▍ | 9539/9741 [00:53<00:01, 168.83it/s] 98%|██████████████████████████████████████████████████████████████████████████▌ | 9557/9741 [00:54<00:01, 147.00it/s] 98%|██████████████████████████████████████████████████████████████████████████▋ | 9573/9741 [00:54<00:01, 147.41it/s] 98%|██████████████████████████████████████████████████████████████████████████▊ | 9592/9741 [00:54<00:00, 157.12it/s] 99%|██████████████████████████████████████████████████████████████████████████▉ | 9612/9741 [00:54<00:00, 168.31it/s] 99%|███████████████████████████████████████████████████████████████████████████▏| 9631/9741 [00:54<00:00, 173.06it/s] 99%|███████████████████████████████████████████████████████████████████████████▎| 9649/9741 [00:54<00:00, 166.09it/s] 99%|███████████████████████████████████████████████████████████████████████████▍| 9666/9741 [00:54<00:00, 150.65it/s] 99%|███████████████████████████████████████████████████████████████████████████▌| 9685/9741 [00:54<00:00, 159.37it/s]100%|███████████████████████████████████████████████████████████████████████████▋| 9705/9741 [00:54<00:00, 166.89it/s]100%|███████████████████████████████████████████████████████████████████████████▊| 9724/9741 [00:55<00:00, 171.55it/s]100%|████████████████████████████████████████████████████████████████████████████| 9741/9741 [00:55<00:00, 176.53it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                                | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████████████▋                                     | 1/3 [00:06<00:12,  6.29s/it]Loading checkpoint shards:   0%|                                                                | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  67%|█████████████████████████████████████▎                  | 2/3 [00:12<00:06,  6.36s/it]Loading checkpoint shards:  33%|██████████████████▋                                     | 1/3 [00:07<00:15,  7.59s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:17<00:00,  5.68s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:17<00:00,  5.86s/it]
Loading checkpoint shards:   0%|                                                                | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  67%|█████████████████████████████████████▎                  | 2/3 [00:15<00:07,  7.99s/it]Loading checkpoint shards:  33%|██████████████████▋                                     | 1/3 [00:08<00:16,  8.05s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:21<00:00,  6.92s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:21<00:00,  7.17s/it]
Loading checkpoint shards:  33%|██████████████████▋                                     | 1/3 [00:08<00:17,  8.59s/it]Loading checkpoint shards:  67%|█████████████████████████████████████▎                  | 2/3 [00:16<00:08,  8.49s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:23<00:00,  7.53s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:23<00:00,  7.74s/it]
Loading checkpoint shards:  67%|█████████████████████████████████████▎                  | 2/3 [00:17<00:08,  8.74s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:23<00:00,  7.35s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:23<00:00,  7.71s/it]
[2023-08-08 19:50:19,186] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
[2023-08-08 19:50:32,178] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-08 19:50:32,179] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-08 19:50:32,180] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-08 19:50:32,180] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-08 19:50:32,180] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-08 19:50:32,180] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-08 19:50:32,181] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-08 19:50:32,181] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-08 19:50:32,181] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-08 19:50:32,181] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-08 19:50:32,181] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-08 19:50:32,181] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f10ae480e80>
[2023-08-08 19:50:32,181] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-08 19:50:32,181] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-08 19:50:32,181] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-08 19:50:32,181] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-08 19:50:32,181] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-08 19:50:32,181] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-08 19:50:32,181] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-08 19:50:32,181] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-08 19:50:32,181] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-08 19:50:32,181] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-08 19:50:32,181] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-08 19:50:32,181] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-08 19:50:32,181] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-08 19:50:32,181] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-08 19:50:32,181] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-08 19:50:32,181] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-08 19:50:32,181] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-08 19:50:32,181] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-08 19:50:32,181] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-08 19:50:32,181] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-08 19:50:32,181] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-08 19:50:32,181] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-08 19:50:32,181] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-08 19:50:32,181] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-08 19:50:32,182] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-08 19:50:32,182] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-08 19:50:32,182] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-08 19:50:32,182] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-08 19:50:32,182] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-08 19:50:32,182] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-08 19:50:32,182] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-08 19:50:32,182] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-08 19:50:32,182] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f10debbef10>
[2023-08-08 19:50:32,182] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-08 19:50:32,182] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-08 19:50:32,182] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-08 19:50:32,182] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-08 19:50:32,182] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-08 19:50:32,182] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-08 19:50:32,182] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-08 19:50:32,182] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-08 19:50:32,182] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-08 19:50:32,182] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-08 19:50:32,182] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-08 19:50:32,182] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-08 19:50:32,182] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-08 19:50:32,182] [INFO] [config.py:1012:print]   train_batch_size ............. 16
[2023-08-08 19:50:32,182] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  4
[2023-08-08 19:50:32,182] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-08 19:50:32,182] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-08 19:50:32,182] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-08 19:50:32,182] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-08 19:50:32,182] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-08 19:50:32,182] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-08 19:50:32,182] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-08 19:50:32,183] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 4, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.7719793319702148 seconds
Loading extension module utils...
Time to load utils op: 0.706113338470459 seconds
Loading extension module utils...
Time to load utils op: 0.705679178237915 seconds
Loading extension module utils...
Time to load utils op: 0.8070394992828369 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                                               | 0/63 [00:00<?, ?it/s]############### Example ###############
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following multiple choice question.

### Demonstration:
Input: For every 12 cans you recycle, you receive $0.50, and for every 5 kilograms of newspapers, you receive $1.50. If your family collected 144 cans and 20 kilograms of newspapers, how much money would you receive?
Rationales: The first step to solve the problem is to figure out how many sets of 12 cans the family has collected. Since they collected 144 cans, and there are 12 cans in a set, they have collected 144/12 = 12 sets of cans. Since each set of cans can be recycled for $0.50, the family would earn 12 * $0.50 = $6 from recycling cans.

The next step is to determine how many sets of 5 kilograms of newspapers the family has collected. They've gathered 20 kilograms of newspapers, and there are 5 kilograms in a set, so they have 20/5 = 4 sets of newspapers. The family earns $1.50 for each set of newspaper they recycle, so they would earn 4 * $1.50 = $6 from recycling newspapers.

The total amount the family would receive for both cans and newspapers is the sum of the amounts they receive for each, which would be $6 (for cans) + $6 (for newspapers) = $12.
Answer: 12

Input: Betty picked 16 strawberries. Matthew picked 20 more strawberries than Betty and twice as many as Natalie. They used their strawberries to make jam. One jar of jam used 7 strawberries and they sold each jar at $4. How much money were they able to make from the strawberries they picked?
Rationales: Matthew picked more strawberries than Betty, so we first need to calculate how many strawberries he picked. From our given information, Matthew picked 20 more strawberries than Betty who picked 16 strawberries. So, Matthew picked 16 + 20 = 36 strawberries.

We know that Matthew picked twice as many strawberries as Natalie. Therefore, we have to divide the number of strawberries Matthew picked by 2 to find out how many strawberries Natalie picked. So, Natalie picked 36 / 2 = 18 strawberries.

Adding the number of strawberries each one of them picked, we find out the total amount of strawberries they all picked. Adding Betty's, Matthew's and Natalie's strawberries together, they altogether picked 16 + 36 + 18 = 70 strawberries.

To find out how many jars of jam they can make, we divide the total number of strawberries they picked by the number of strawberries required to make a jar of jam. So, they can make 70 / 7 = 10 jars of strawberries.

Finally, to calculate how much money they are able to make from selling the jams, we multiply the number of jars they could make by the selling price of each jar. They earn 10 x $4 = $40 from the strawberries they picked. Hence, the answer is $40.
Answer: 40

Input: Jack has a stack of books that is 12 inches thick. He knows from experience that 80 pages is one inch thick. If he has 6 books, how many pages is each one on average?
Rationales: First, Jack needs to determine the total number of pages he has in his stack of books. Since he knows from experience that 80 pages make up one inch, and his stack is 12 inches thick, he can do this by multiplying the number of pages per inch (80) by the total number of inches (12). This gives him a total of 960 pages. 

Once he knows the total number of pages, he can then find out how many pages each book has on average. He does this by dividing the total number of pages (960) by the total number of books (6). This gives him an average of 160 pages per book.
Answer: 160

Input: James dumps his whole collection of 500 Legos on the floor and starts building a castle out of them.  He uses half the pieces before finishing and is told to put the rest away.  He puts all of the leftover pieces back in the box they came from, except for 5 missing pieces that he can't find.  How many Legos are in the box at the end?
Rationales: First, you need to find out how many Legos James has left after building the castle. Since he uses half of his collection, that means he used 500/2 = 250 pieces, leaving 250 unutilized.

He is then instructed to put away the remaining pieces. However, he can't find 5 of them. Hence, he only puts away 250 - 5 = 245 Legos. 

Therefore, there are 245 Legos in the box at the end.
Answer: 245

Input: Ines had $20 in her purse. She bought 3 pounds of peaches, which are $2 per pound at the local farmers’ market. How much did she have left?
Rationales: 1. Ines started with $20.
2. The cost of peaches was $2 per pound and she bought 3 pounds. Therefore, the total cost for peaches was 3 pounds * $2 per pound = $6
3. To find out how much money Ines has left, we subtract the total cost of the peaches from the amount of money she had initially. 
   So, $20 - $6 = $14
4. Ines has $14 left after buying the peaches.
Answer: 14

Input: Aaron pays his actuary membership fees each year. The membership fee increases yearly by $10. If he pays $80 in the first year, how much does his membership cost, in dollars, in the sixth year?
Rationales: The question provides information about an increase of $10 each year for the membership. The first year costs $80, so we can increase this amount by $10 for each following year. For year 2, we add $10 to $80 to get $90. For year 3, we add $10 to $90 to get $100. For year 4, we add $10 to $100 to get $110. For year 5, we add $10 to $110 to get $120. Likewise, for the 6th year, we add $10 to last year's cost of $120, resulting in an amount of $130. Therefore, in the 6th year, the membership cost would be $130.
Answer: 130

### Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid

### Response:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o6-tgsm8k-s42-rTrue
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 137, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 115, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/minillm/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/minillm/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 137, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 115, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/minillm/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/minillm/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 137, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 115, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/minillm/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/minillm/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Evaluating commonsenseqa :   0%|                                                               | 0/63 [00:05<?, ?it/s]
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 137, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 115, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/minillm/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/minillm/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 696098) of binary: /home/ylu130/.conda/envs/distllm/bin/python
Traceback (most recent call last):
  File "/home/ylu130/.conda/envs/distllm/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 345, in wrapper
    return f(*args, **kwargs)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 761, in main
    run(args)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 752, in run
    elastic_launch(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 131, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 245, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
/home/ylu130/workspace/in-context-generalization/inference.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2023-08-08_19:50:44
  host      : ia1.wse.jhu.edu
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 696099)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2023-08-08_19:50:44
  host      : ia1.wse.jhu.edu
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 696100)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2023-08-08_19:50:44
  host      : ia1.wse.jhu.edu
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 696101)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2023-08-08_19:50:44
  host      : ia1.wse.jhu.edu
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 696098)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name gsm8k --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 4 --seed 42 --data-dir /scratch/ylu130/processed_data/commonsenseqa/out-domain/o7-tgsm8k-s42-rTrue --rationales --num-out-domain 7
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-08 19:50:49,825] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/out-domain/o7-tgsm8k-s42-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 7
  out_domain_data_name ......... gsm8k
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o7-tgsm8k-s42-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 4
  clip_grad .................... 1.0
  seed ......................... 42
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                        | 0/9741 [00:00<?, ?it/s]  0%|                                                                              | 12/9741 [00:00<01:27, 111.30it/s]  0%|▏                                                                             | 24/9741 [00:00<01:26, 112.71it/s]  0%|▎                                                                              | 36/9741 [00:00<01:45, 92.05it/s]  1%|▍                                                                             | 50/9741 [00:00<01:32, 105.26it/s]  1%|▌                                                                             | 63/9741 [00:00<01:27, 110.69it/s]  1%|▌                                                                             | 75/9741 [00:00<01:27, 110.55it/s]  1%|▋                                                                             | 87/9741 [00:00<01:26, 111.70it/s]  1%|▊                                                                             | 99/9741 [00:00<01:35, 100.50it/s]  1%|▊                                                                            | 110/9741 [00:01<01:34, 101.82it/s]  1%|▉                                                                            | 123/9741 [00:01<01:29, 107.71it/s]  1%|█                                                                            | 134/9741 [00:01<01:29, 107.04it/s]  1%|█▏                                                                            | 145/9741 [00:01<01:36, 99.50it/s]  2%|█▏                                                                            | 156/9741 [00:01<01:38, 97.39it/s]  2%|█▎                                                                            | 166/9741 [00:01<01:38, 96.77it/s]  2%|█▍                                                                           | 179/9741 [00:01<01:31, 104.11it/s]  2%|█▌                                                                           | 191/9741 [00:01<01:30, 105.10it/s]  2%|█▌                                                                            | 202/9741 [00:01<01:45, 90.59it/s]  2%|█▋                                                                            | 214/9741 [00:02<01:40, 94.90it/s]  2%|█▊                                                                            | 224/9741 [00:02<01:44, 91.39it/s]  2%|█▉                                                                            | 235/9741 [00:02<01:40, 94.95it/s]  3%|█▉                                                                           | 248/9741 [00:02<01:32, 102.96it/s]  3%|██                                                                           | 260/9741 [00:02<01:28, 107.35it/s]  3%|██▏                                                                          | 271/9741 [00:02<01:29, 105.87it/s]  3%|██▏                                                                          | 282/9741 [00:02<01:34, 100.38it/s]  3%|██▎                                                                           | 293/9741 [00:02<01:37, 96.97it/s]  3%|██▍                                                                          | 306/9741 [00:02<01:29, 104.85it/s]  3%|██▌                                                                          | 319/9741 [00:03<01:26, 109.40it/s]  3%|██▌                                                                          | 331/9741 [00:03<01:25, 109.72it/s]  4%|██▋                                                                          | 343/9741 [00:03<01:26, 108.37it/s]  4%|██▊                                                                          | 355/9741 [00:03<01:26, 108.76it/s]  4%|██▉                                                                           | 366/9741 [00:03<01:35, 98.42it/s]  4%|██▉                                                                          | 379/9741 [00:03<01:28, 105.43it/s]  4%|███                                                                          | 391/9741 [00:03<01:26, 108.65it/s]  4%|███▏                                                                         | 403/9741 [00:03<01:26, 107.94it/s]  4%|███▎                                                                          | 414/9741 [00:04<01:39, 93.50it/s]  4%|███▍                                                                          | 424/9741 [00:04<01:44, 89.55it/s]  4%|███▍                                                                         | 438/9741 [00:04<01:32, 100.92it/s]  5%|███▌                                                                         | 451/9741 [00:04<01:27, 106.45it/s]  5%|███▋                                                                         | 463/9741 [00:04<01:24, 109.36it/s]  5%|███▊                                                                          | 475/9741 [00:04<01:36, 96.40it/s]  5%|███▉                                                                          | 486/9741 [00:04<01:36, 95.48it/s]  5%|███▉                                                                          | 497/9741 [00:04<01:34, 98.31it/s]  5%|████                                                                          | 508/9741 [00:05<01:38, 94.17it/s]  5%|████                                                                         | 521/9741 [00:05<01:30, 101.81it/s]  5%|████▎                                                                         | 532/9741 [00:05<01:33, 98.52it/s]  6%|████▎                                                                         | 543/9741 [00:05<01:42, 89.38it/s]  6%|████▍                                                                         | 553/9741 [00:05<01:41, 90.49it/s]  6%|████▌                                                                         | 563/9741 [00:05<01:45, 87.12it/s]  6%|████▌                                                                         | 577/9741 [00:05<01:32, 98.91it/s]  6%|████▋                                                                        | 588/9741 [00:05<01:30, 100.93it/s]  6%|████▊                                                                         | 599/9741 [00:05<01:32, 99.29it/s]  6%|████▉                                                                         | 610/9741 [00:06<01:32, 98.57it/s]  6%|████▉                                                                         | 620/9741 [00:06<01:38, 92.80it/s]  6%|█████                                                                        | 633/9741 [00:06<01:28, 102.44it/s]  7%|█████                                                                        | 646/9741 [00:06<01:23, 108.33it/s]  7%|█████▏                                                                       | 657/9741 [00:06<01:28, 102.25it/s]  7%|█████▎                                                                        | 668/9741 [00:06<01:33, 97.52it/s]  7%|█████▍                                                                        | 678/9741 [00:06<01:37, 92.52it/s]  7%|█████▌                                                                       | 697/9741 [00:06<01:16, 118.22it/s]  7%|█████▋                                                                       | 713/9741 [00:06<01:10, 127.31it/s]  7%|█████▊                                                                       | 729/9741 [00:07<01:06, 135.33it/s]  8%|█████▊                                                                       | 743/9741 [00:07<01:07, 133.04it/s]  8%|█████▉                                                                       | 759/9741 [00:07<01:04, 139.65it/s]  8%|██████                                                                       | 774/9741 [00:07<01:13, 121.53it/s]  8%|██████▏                                                                      | 787/9741 [00:07<01:13, 121.24it/s]  8%|██████▎                                                                      | 800/9741 [00:07<01:16, 116.72it/s]  8%|██████▍                                                                      | 813/9741 [00:07<01:15, 118.61it/s]  9%|██████▌                                                                      | 828/9741 [00:07<01:10, 125.92it/s]  9%|██████▋                                                                      | 841/9741 [00:07<01:10, 125.53it/s]  9%|██████▊                                                                      | 861/9741 [00:08<01:00, 146.13it/s]  9%|██████▉                                                                      | 877/9741 [00:08<01:00, 147.18it/s]  9%|███████                                                                      | 892/9741 [00:08<01:02, 142.30it/s]  9%|███████▏                                                                     | 907/9741 [00:08<01:09, 126.27it/s]  9%|███████▎                                                                     | 923/9741 [00:08<01:05, 134.62it/s] 10%|███████▍                                                                     | 943/9741 [00:08<00:58, 150.49it/s] 10%|███████▌                                                                     | 959/9741 [00:08<00:57, 151.84it/s] 10%|███████▋                                                                     | 975/9741 [00:08<00:57, 151.31it/s] 10%|███████▊                                                                     | 991/9741 [00:09<01:07, 129.01it/s] 10%|███████▊                                                                    | 1008/9741 [00:09<01:03, 138.15it/s] 11%|███████▉                                                                    | 1023/9741 [00:09<01:02, 140.17it/s] 11%|████████                                                                    | 1039/9741 [00:09<01:00, 143.15it/s] 11%|████████▏                                                                   | 1054/9741 [00:09<01:07, 127.79it/s] 11%|████████▎                                                                   | 1069/9741 [00:09<01:06, 130.70it/s] 11%|████████▍                                                                   | 1083/9741 [00:09<01:13, 117.83it/s] 11%|████████▌                                                                   | 1100/9741 [00:09<01:06, 129.24it/s] 11%|████████▋                                                                   | 1114/9741 [00:09<01:10, 122.76it/s] 12%|████████▊                                                                   | 1129/9741 [00:10<01:07, 127.98it/s] 12%|████████▉                                                                   | 1143/9741 [00:10<01:11, 119.80it/s] 12%|█████████                                                                   | 1161/9741 [00:10<01:03, 134.31it/s] 12%|█████████▏                                                                  | 1177/9741 [00:10<01:00, 140.81it/s] 12%|█████████▎                                                                  | 1193/9741 [00:10<00:59, 143.95it/s] 12%|█████████▍                                                                  | 1208/9741 [00:10<01:00, 141.04it/s] 13%|█████████▌                                                                  | 1223/9741 [00:10<01:09, 122.46it/s] 13%|█████████▋                                                                  | 1240/9741 [00:10<01:04, 132.82it/s] 13%|█████████▊                                                                  | 1257/9741 [00:11<01:00, 141.30it/s] 13%|█████████▉                                                                  | 1273/9741 [00:11<00:58, 144.14it/s] 13%|██████████                                                                  | 1288/9741 [00:11<01:00, 140.61it/s] 13%|██████████▏                                                                 | 1303/9741 [00:11<01:07, 124.82it/s] 14%|██████████▎                                                                 | 1319/9741 [00:11<01:03, 133.02it/s] 14%|██████████▍                                                                 | 1333/9741 [00:11<01:10, 118.48it/s] 14%|██████████▌                                                                 | 1346/9741 [00:11<01:10, 119.13it/s] 14%|██████████▌                                                                 | 1359/9741 [00:11<01:11, 117.58it/s] 14%|██████████▋                                                                 | 1372/9741 [00:11<01:10, 118.69it/s] 14%|██████████▊                                                                 | 1388/9741 [00:12<01:04, 129.53it/s] 14%|██████████▉                                                                 | 1403/9741 [00:12<01:02, 132.38it/s] 15%|███████████                                                                 | 1418/9741 [00:12<01:01, 134.29it/s] 15%|███████████▏                                                                | 1432/9741 [00:12<01:06, 125.65it/s] 15%|███████████▎                                                                | 1447/9741 [00:12<01:03, 130.88it/s] 15%|███████████▍                                                                | 1464/9741 [00:12<00:59, 140.17it/s] 15%|███████████▌                                                                | 1480/9741 [00:12<00:56, 145.27it/s] 15%|███████████▋                                                                | 1495/9741 [00:12<00:57, 142.24it/s] 16%|███████████▊                                                                | 1510/9741 [00:12<01:03, 130.25it/s] 16%|███████████▉                                                                | 1524/9741 [00:13<01:04, 128.11it/s] 16%|███████████▉                                                                | 1537/9741 [00:13<01:08, 119.94it/s] 16%|████████████                                                                | 1551/9741 [00:13<01:06, 124.03it/s] 16%|████████████▏                                                               | 1564/9741 [00:13<01:07, 121.96it/s] 16%|████████████▎                                                               | 1577/9741 [00:13<01:09, 116.80it/s] 16%|████████████▍                                                               | 1589/9741 [00:13<01:11, 114.43it/s] 16%|████████████▌                                                               | 1603/9741 [00:13<01:07, 120.43it/s] 17%|████████████▋                                                               | 1620/9741 [00:13<01:00, 133.69it/s] 17%|████████████▊                                                               | 1638/9741 [00:13<00:55, 146.59it/s] 17%|████████████▉                                                               | 1655/9741 [00:14<00:53, 151.57it/s] 17%|█████████████                                                               | 1671/9741 [00:14<00:52, 153.14it/s] 17%|█████████████▏                                                              | 1687/9741 [00:14<00:54, 148.48it/s] 17%|█████████████▎                                                              | 1702/9741 [00:14<00:54, 147.07it/s] 18%|█████████████▍                                                              | 1719/9741 [00:14<00:52, 152.56it/s] 18%|█████████████▌                                                              | 1740/9741 [00:14<00:47, 167.28it/s] 18%|█████████████▋                                                              | 1757/9741 [00:14<00:48, 163.53it/s] 18%|█████████████▊                                                              | 1774/9741 [00:14<00:50, 158.60it/s] 18%|█████████████▉                                                              | 1790/9741 [00:15<01:01, 129.69it/s] 19%|██████████████                                                              | 1807/9741 [00:15<00:57, 139.14it/s] 19%|██████████████▏                                                             | 1824/9741 [00:15<00:54, 144.87it/s] 19%|██████████████▎                                                             | 1840/9741 [00:15<00:55, 143.09it/s] 19%|██████████████▍                                                             | 1855/9741 [00:15<00:59, 131.83it/s] 19%|██████████████▌                                                             | 1871/9741 [00:15<00:56, 139.10it/s] 19%|██████████████▋                                                             | 1889/9741 [00:15<00:52, 149.15it/s] 20%|██████████████▊                                                             | 1906/9741 [00:15<00:51, 152.61it/s] 20%|██████████████▉                                                             | 1922/9741 [00:15<00:53, 145.05it/s] 20%|███████████████                                                             | 1937/9741 [00:16<00:58, 133.73it/s] 20%|███████████████▏                                                            | 1953/9741 [00:16<00:55, 139.28it/s] 20%|███████████████▎                                                            | 1970/9741 [00:16<00:53, 145.86it/s] 20%|███████████████▌                                                            | 1988/9741 [00:16<00:50, 154.08it/s] 21%|███████████████▋                                                            | 2004/9741 [00:16<00:50, 154.08it/s] 21%|███████████████▊                                                            | 2020/9741 [00:16<00:55, 138.17it/s] 21%|███████████████▉                                                            | 2037/9741 [00:16<00:52, 146.26it/s] 21%|████████████████                                                            | 2053/9741 [00:16<00:51, 149.57it/s] 21%|████████████████▏                                                           | 2070/9741 [00:16<00:49, 154.16it/s] 21%|████████████████▎                                                           | 2086/9741 [00:17<00:52, 146.86it/s] 22%|████████████████▍                                                           | 2101/9741 [00:17<00:59, 129.04it/s] 22%|████████████████▌                                                           | 2117/9741 [00:17<00:55, 136.32it/s] 22%|████████████████▋                                                           | 2135/9741 [00:17<00:51, 146.61it/s] 22%|████████████████▊                                                           | 2154/9741 [00:17<00:48, 157.22it/s] 22%|████████████████▉                                                           | 2171/9741 [00:17<00:47, 158.95it/s] 22%|█████████████████                                                           | 2188/9741 [00:17<00:56, 133.13it/s] 23%|█████████████████▏                                                          | 2205/9741 [00:17<00:53, 140.61it/s] 23%|█████████████████▎                                                          | 2222/9741 [00:17<00:51, 147.10it/s] 23%|█████████████████▍                                                          | 2238/9741 [00:18<00:50, 150.00it/s] 23%|█████████████████▌                                                          | 2254/9741 [00:18<00:50, 147.17it/s] 23%|█████████████████▋                                                          | 2270/9741 [00:18<00:58, 127.82it/s] 23%|█████████████████▊                                                          | 2286/9741 [00:18<00:54, 135.59it/s] 24%|█████████████████▉                                                          | 2305/9741 [00:18<00:49, 148.92it/s] 24%|██████████████████                                                          | 2322/9741 [00:18<00:48, 153.75it/s] 24%|██████████████████▏                                                         | 2339/9741 [00:18<00:47, 157.14it/s] 24%|██████████████████▍                                                         | 2356/9741 [00:18<00:55, 133.67it/s] 24%|██████████████████▍                                                         | 2371/9741 [00:19<00:53, 137.71it/s] 25%|██████████████████▋                                                         | 2388/9741 [00:19<00:50, 144.38it/s] 25%|██████████████████▊                                                         | 2409/9741 [00:19<00:45, 160.45it/s] 25%|██████████████████▉                                                         | 2426/9741 [00:19<00:45, 159.31it/s] 25%|███████████████████                                                         | 2443/9741 [00:19<00:48, 149.02it/s] 25%|███████████████████▏                                                        | 2459/9741 [00:19<00:53, 136.68it/s] 25%|███████████████████▎                                                        | 2475/9741 [00:19<00:51, 142.07it/s] 26%|███████████████████▍                                                        | 2493/9741 [00:19<00:47, 151.98it/s] 26%|███████████████████▌                                                        | 2510/9741 [00:19<00:46, 154.21it/s] 26%|███████████████████▋                                                        | 2526/9741 [00:20<00:47, 152.01it/s] 26%|███████████████████▊                                                        | 2542/9741 [00:20<00:53, 134.41it/s] 26%|███████████████████▉                                                        | 2558/9741 [00:20<00:51, 138.87it/s] 26%|████████████████████                                                        | 2576/9741 [00:20<00:48, 147.95it/s] 27%|████████████████████▏                                                       | 2592/9741 [00:20<00:47, 150.38it/s] 27%|████████████████████▎                                                       | 2608/9741 [00:20<00:50, 140.18it/s] 27%|████████████████████▍                                                       | 2623/9741 [00:20<00:53, 132.57it/s] 27%|████████████████████▌                                                       | 2641/9741 [00:20<00:49, 144.71it/s] 27%|████████████████████▊                                                       | 2663/9741 [00:20<00:43, 162.78it/s] 28%|████████████████████▉                                                       | 2680/9741 [00:21<00:43, 162.49it/s] 28%|█████████████████████                                                       | 2697/9741 [00:21<00:47, 147.93it/s] 28%|█████████████████████▏                                                      | 2713/9741 [00:21<00:52, 133.41it/s] 28%|█████████████████████▎                                                      | 2727/9741 [00:21<00:55, 126.19it/s] 28%|█████████████████████▍                                                      | 2740/9741 [00:21<00:56, 124.15it/s] 28%|█████████████████████▍                                                      | 2754/9741 [00:21<00:54, 127.57it/s] 28%|█████████████████████▌                                                      | 2767/9741 [00:21<00:57, 122.00it/s] 29%|█████████████████████▋                                                      | 2780/9741 [00:21<01:00, 114.88it/s] 29%|█████████████████████▊                                                      | 2792/9741 [00:22<01:00, 115.26it/s] 29%|█████████████████████▉                                                      | 2804/9741 [00:22<00:59, 116.16it/s] 29%|█████████████████████▉                                                      | 2816/9741 [00:22<01:03, 109.00it/s] 29%|██████████████████████                                                      | 2832/9741 [00:22<00:56, 121.69it/s] 29%|██████████████████████▏                                                     | 2846/9741 [00:22<00:54, 126.46it/s] 29%|██████████████████████▎                                                     | 2859/9741 [00:22<01:01, 111.33it/s] 30%|██████████████████████▍                                                     | 2877/9741 [00:22<00:53, 128.02it/s] 30%|██████████████████████▌                                                     | 2893/9741 [00:22<00:50, 136.43it/s] 30%|██████████████████████▋                                                     | 2910/9741 [00:22<00:47, 144.24it/s] 30%|██████████████████████▊                                                     | 2925/9741 [00:23<00:47, 144.97it/s] 30%|██████████████████████▉                                                     | 2941/9741 [00:23<00:45, 148.62it/s] 30%|███████████████████████                                                     | 2957/9741 [00:23<00:46, 145.14it/s] 31%|███████████████████████▏                                                    | 2972/9741 [00:23<00:50, 134.16it/s] 31%|███████████████████████▎                                                    | 2986/9741 [00:23<00:51, 130.06it/s] 31%|███████████████████████▍                                                    | 3003/9741 [00:23<00:48, 139.56it/s] 31%|███████████████████████▌                                                    | 3018/9741 [00:23<00:47, 142.35it/s] 31%|███████████████████████▋                                                    | 3033/9741 [00:23<00:47, 140.95it/s] 31%|███████████████████████▊                                                    | 3050/9741 [00:23<00:45, 147.78it/s] 31%|███████████████████████▉                                                    | 3066/9741 [00:24<00:44, 148.61it/s] 32%|████████████████████████                                                    | 3082/9741 [00:24<00:44, 151.04it/s] 32%|████████████████████████▏                                                   | 3098/9741 [00:24<00:43, 152.17it/s] 32%|████████████████████████▎                                                   | 3114/9741 [00:24<00:48, 136.29it/s] 32%|████████████████████████▍                                                   | 3131/9741 [00:24<00:46, 143.48it/s] 32%|████████████████████████▌                                                   | 3150/9741 [00:24<00:42, 154.45it/s] 33%|████████████████████████▋                                                   | 3167/9741 [00:24<00:42, 155.99it/s] 33%|████████████████████████▊                                                   | 3183/9741 [00:24<00:42, 153.20it/s] 33%|████████████████████████▉                                                   | 3199/9741 [00:24<00:46, 140.70it/s] 33%|█████████████████████████                                                   | 3214/9741 [00:25<00:45, 142.37it/s] 33%|█████████████████████████▏                                                  | 3230/9741 [00:25<00:44, 147.04it/s] 33%|█████████████████████████▎                                                  | 3247/9741 [00:25<00:42, 153.25it/s] 33%|█████████████████████████▍                                                  | 3263/9741 [00:25<00:42, 153.33it/s] 34%|█████████████████████████▌                                                  | 3279/9741 [00:25<00:44, 145.77it/s] 34%|█████████████████████████▋                                                  | 3294/9741 [00:25<00:47, 134.78it/s] 34%|█████████████████████████▊                                                  | 3308/9741 [00:25<00:51, 124.85it/s] 34%|█████████████████████████▉                                                  | 3322/9741 [00:25<00:50, 127.20it/s] 34%|██████████████████████████                                                  | 3338/9741 [00:25<00:47, 134.75it/s] 34%|██████████████████████████▏                                                 | 3352/9741 [00:26<00:49, 129.74it/s] 35%|██████████████████████████▎                                                 | 3366/9741 [00:26<00:53, 119.94it/s] 35%|██████████████████████████▍                                                 | 3383/9741 [00:26<00:48, 131.14it/s] 35%|██████████████████████████▌                                                 | 3401/9741 [00:26<00:44, 142.36it/s] 35%|██████████████████████████▋                                                 | 3419/9741 [00:26<00:42, 150.12it/s] 35%|██████████████████████████▊                                                 | 3435/9741 [00:26<00:41, 151.91it/s] 35%|██████████████████████████▉                                                 | 3451/9741 [00:26<00:47, 132.25it/s] 36%|███████████████████████████                                                 | 3465/9741 [00:26<00:47, 132.88it/s] 36%|███████████████████████████▏                                                | 3482/9741 [00:27<00:44, 140.54it/s] 36%|███████████████████████████▎                                                | 3497/9741 [00:27<00:48, 128.76it/s] 36%|███████████████████████████▍                                                | 3511/9741 [00:27<00:54, 115.28it/s] 36%|███████████████████████████▍                                                | 3524/9741 [00:27<00:57, 107.61it/s] 36%|███████████████████████████▌                                                | 3538/9741 [00:27<00:54, 113.92it/s] 36%|███████████████████████████▋                                                | 3552/9741 [00:27<00:52, 118.27it/s] 37%|███████████████████████████▊                                                | 3565/9741 [00:27<00:52, 117.88it/s] 37%|███████████████████████████▉                                                | 3578/9741 [00:27<00:53, 115.52it/s] 37%|████████████████████████████                                                | 3590/9741 [00:27<00:53, 115.38it/s] 37%|████████████████████████████                                                | 3603/9741 [00:28<00:51, 118.25it/s] 37%|████████████████████████████▏                                               | 3615/9741 [00:28<00:51, 117.93it/s] 37%|████████████████████████████▎                                               | 3629/9741 [00:28<00:50, 122.06it/s] 37%|████████████████████████████▍                                               | 3642/9741 [00:28<00:49, 122.14it/s] 38%|████████████████████████████▌                                               | 3655/9741 [00:28<00:50, 119.66it/s] 38%|████████████████████████████▌                                               | 3668/9741 [00:28<00:58, 103.19it/s] 38%|████████████████████████████▋                                               | 3680/9741 [00:28<00:56, 107.20it/s] 38%|████████████████████████████▊                                               | 3693/9741 [00:28<00:53, 112.45it/s] 38%|████████████████████████████▉                                               | 3705/9741 [00:29<00:56, 105.95it/s] 38%|█████████████████████████████                                               | 3717/9741 [00:29<00:55, 108.88it/s] 38%|█████████████████████████████                                               | 3729/9741 [00:29<00:58, 102.00it/s] 38%|█████████████████████████████▌                                               | 3740/9741 [00:29<01:00, 99.78it/s] 39%|█████████████████████████████▎                                              | 3753/9741 [00:29<00:55, 107.18it/s] 39%|█████████████████████████████▎                                              | 3765/9741 [00:29<00:55, 107.73it/s] 39%|█████████████████████████████▍                                              | 3778/9741 [00:29<00:53, 111.98it/s] 39%|█████████████████████████████▌                                              | 3790/9741 [00:29<00:58, 102.03it/s] 39%|█████████████████████████████▋                                              | 3803/9741 [00:29<00:54, 108.25it/s] 39%|█████████████████████████████▊                                              | 3817/9741 [00:30<00:51, 114.85it/s] 39%|█████████████████████████████▊                                              | 3829/9741 [00:30<00:52, 112.69it/s] 39%|█████████████████████████████▉                                              | 3841/9741 [00:30<00:51, 113.46it/s] 40%|██████████████████████████████                                              | 3853/9741 [00:30<00:57, 102.09it/s] 40%|██████████████████████████████▏                                             | 3865/9741 [00:30<00:55, 106.72it/s] 40%|██████████████████████████████▎                                             | 3879/9741 [00:30<00:51, 113.37it/s] 40%|██████████████████████████████▎                                             | 3891/9741 [00:30<00:52, 110.64it/s] 40%|██████████████████████████████▍                                             | 3903/9741 [00:30<00:58, 100.19it/s] 40%|██████████████████████████████▌                                             | 3914/9741 [00:30<00:56, 102.42it/s] 40%|██████████████████████████████▋                                             | 3926/9741 [00:31<00:54, 107.03it/s] 40%|██████████████████████████████▋                                             | 3939/9741 [00:31<00:51, 113.29it/s] 41%|██████████████████████████████▊                                             | 3951/9741 [00:31<00:50, 114.93it/s] 41%|██████████████████████████████▉                                             | 3964/9741 [00:31<00:48, 118.11it/s] 41%|███████████████████████████████                                             | 3976/9741 [00:31<00:54, 105.33it/s] 41%|███████████████████████████████                                             | 3987/9741 [00:31<00:57, 100.72it/s] 41%|███████████████████████████████▏                                            | 4000/9741 [00:31<00:53, 107.74it/s] 41%|███████████████████████████████▎                                            | 4013/9741 [00:31<00:50, 112.39it/s] 41%|███████████████████████████████▍                                            | 4026/9741 [00:31<00:49, 115.86it/s] 41%|███████████████████████████████▌                                            | 4038/9741 [00:32<00:50, 113.33it/s] 42%|███████████████████████████████▌                                            | 4050/9741 [00:32<00:49, 115.10it/s] 42%|███████████████████████████████▋                                            | 4063/9741 [00:32<00:48, 117.39it/s] 42%|███████████████████████████████▊                                            | 4076/9741 [00:32<00:47, 119.05it/s] 42%|███████████████████████████████▉                                            | 4088/9741 [00:32<00:49, 113.50it/s] 42%|███████████████████████████████▉                                            | 4100/9741 [00:32<00:50, 112.29it/s] 42%|████████████████████████████████                                            | 4112/9741 [00:32<00:50, 112.40it/s] 42%|████████████████████████████████▏                                           | 4124/9741 [00:32<00:50, 112.13it/s] 42%|████████████████████████████████▎                                           | 4136/9741 [00:32<00:50, 111.77it/s] 43%|████████████████████████████████▎                                           | 4148/9741 [00:33<00:49, 111.98it/s] 43%|████████████████████████████████▍                                           | 4161/9741 [00:33<00:48, 116.07it/s] 43%|████████████████████████████████▌                                           | 4173/9741 [00:33<00:51, 107.15it/s] 43%|████████████████████████████████▋                                           | 4193/9741 [00:33<00:42, 131.89it/s] 43%|████████████████████████████████▊                                           | 4210/9741 [00:33<00:38, 142.42it/s] 43%|████████████████████████████████▉                                           | 4226/9741 [00:33<00:37, 147.28it/s] 44%|█████████████████████████████████                                           | 4241/9741 [00:33<00:41, 132.25it/s] 44%|█████████████████████████████████▏                                          | 4256/9741 [00:33<00:40, 136.84it/s] 44%|█████████████████████████████████▎                                          | 4271/9741 [00:33<00:40, 135.96it/s] 44%|█████████████████████████████████▍                                          | 4285/9741 [00:34<00:44, 122.04it/s] 44%|█████████████████████████████████▌                                          | 4302/9741 [00:34<00:40, 133.23it/s] 44%|█████████████████████████████████▋                                          | 4317/9741 [00:34<00:40, 135.25it/s] 44%|█████████████████████████████████▊                                          | 4333/9741 [00:34<00:38, 138.86it/s] 45%|█████████████████████████████████▉                                          | 4348/9741 [00:34<00:38, 138.88it/s] 45%|██████████████████████████████████                                          | 4363/9741 [00:34<00:44, 119.91it/s] 45%|██████████████████████████████████▏                                         | 4378/9741 [00:34<00:43, 124.56it/s] 45%|██████████████████████████████████▎                                         | 4393/9741 [00:34<00:40, 130.80it/s] 45%|██████████████████████████████████▍                                         | 4408/9741 [00:34<00:39, 135.38it/s] 45%|██████████████████████████████████▌                                         | 4422/9741 [00:35<00:39, 134.91it/s] 46%|██████████████████████████████████▌                                         | 4436/9741 [00:35<00:42, 123.46it/s] 46%|██████████████████████████████████▋                                         | 4453/9741 [00:35<00:39, 134.08it/s] 46%|██████████████████████████████████▊                                         | 4467/9741 [00:35<00:39, 135.21it/s] 46%|██████████████████████████████████▉                                         | 4482/9741 [00:35<00:37, 139.13it/s] 46%|███████████████████████████████████                                         | 4497/9741 [00:35<00:40, 129.46it/s] 46%|███████████████████████████████████▏                                        | 4511/9741 [00:35<00:49, 106.15it/s] 46%|███████████████████████████████████▎                                        | 4523/9741 [00:35<00:49, 106.12it/s] 47%|███████████████████████████████████▍                                        | 4538/9741 [00:36<00:44, 115.78it/s] 47%|███████████████████████████████████▌                                        | 4551/9741 [00:36<00:46, 110.78it/s] 47%|███████████████████████████████████▋                                        | 4567/9741 [00:36<00:41, 123.25it/s] 47%|███████████████████████████████████▋                                        | 4581/9741 [00:36<00:40, 126.10it/s] 47%|███████████████████████████████████▊                                        | 4594/9741 [00:36<00:42, 120.96it/s] 47%|███████████████████████████████████▉                                        | 4609/9741 [00:36<00:40, 127.20it/s] 47%|████████████████████████████████████                                        | 4622/9741 [00:36<00:43, 117.20it/s] 48%|████████████████████████████████████▏                                       | 4637/9741 [00:36<00:41, 123.30it/s] 48%|████████████████████████████████████▎                                       | 4650/9741 [00:36<00:41, 121.73it/s] 48%|████████████████████████████████████▍                                       | 4666/9741 [00:37<00:38, 131.29it/s] 48%|████████████████████████████████████▌                                       | 4680/9741 [00:37<00:40, 125.53it/s] 48%|████████████████████████████████████▌                                       | 4693/9741 [00:37<00:40, 123.88it/s] 48%|████████████████████████████████████▋                                       | 4708/9741 [00:37<00:38, 130.24it/s] 48%|████████████████████████████████████▊                                       | 4722/9741 [00:37<00:39, 127.97it/s] 49%|█████████████████████████████████████▍                                       | 4735/9741 [00:37<01:02, 79.56it/s] 49%|█████████████████████████████████████▌                                       | 4746/9741 [00:37<01:00, 81.94it/s] 49%|█████████████████████████████████████▋                                       | 4761/9741 [00:38<00:51, 95.80it/s] 49%|█████████████████████████████████████▎                                      | 4778/9741 [00:38<00:44, 112.22it/s] 49%|█████████████████████████████████████▍                                      | 4791/9741 [00:38<00:45, 108.40it/s] 49%|█████████████████████████████████████▍                                      | 4806/9741 [00:38<00:41, 118.41it/s] 49%|█████████████████████████████████████▌                                      | 4819/9741 [00:38<00:45, 108.73it/s] 50%|█████████████████████████████████████▋                                      | 4835/9741 [00:38<00:40, 119.96it/s] 50%|█████████████████████████████████████▊                                      | 4851/9741 [00:38<00:38, 128.46it/s] 50%|█████████████████████████████████████▉                                      | 4865/9741 [00:38<00:41, 117.67it/s] 50%|██████████████████████████████████████                                      | 4878/9741 [00:39<00:43, 111.56it/s] 50%|██████████████████████████████████████▏                                     | 4892/9741 [00:39<00:41, 117.00it/s] 50%|██████████████████████████████████████▎                                     | 4905/9741 [00:39<00:40, 119.47it/s] 50%|██████████████████████████████████████▎                                     | 4918/9741 [00:39<00:41, 115.28it/s] 51%|██████████████████████████████████████▍                                     | 4934/9741 [00:39<00:37, 126.53it/s] 51%|██████████████████████████████████████▌                                     | 4947/9741 [00:39<00:37, 126.70it/s] 51%|██████████████████████████████████████▋                                     | 4962/9741 [00:39<00:36, 131.62it/s] 51%|██████████████████████████████████████▊                                     | 4976/9741 [00:39<00:39, 120.47it/s] 51%|██████████████████████████████████████▉                                     | 4993/9741 [00:39<00:35, 131.94it/s] 51%|███████████████████████████████████████                                     | 5009/9741 [00:40<00:34, 137.68it/s] 52%|███████████████████████████████████████▏                                    | 5024/9741 [00:40<00:37, 125.46it/s] 52%|███████████████████████████████████████▎                                    | 5037/9741 [00:40<00:37, 124.06it/s] 52%|███████████████████████████████████████▍                                    | 5050/9741 [00:40<00:40, 116.39it/s] 52%|███████████████████████████████████████▌                                    | 5068/9741 [00:40<00:35, 133.01it/s] 52%|███████████████████████████████████████▋                                    | 5085/9741 [00:40<00:33, 139.16it/s] 52%|███████████████████████████████████████▊                                    | 5100/9741 [00:40<00:34, 133.75it/s] 52%|███████████████████████████████████████▉                                    | 5114/9741 [00:40<00:34, 135.16it/s] 53%|████████████████████████████████████████                                    | 5128/9741 [00:40<00:36, 125.88it/s] 53%|████████████████████████████████████████▏                                   | 5147/9741 [00:41<00:32, 141.71it/s] 53%|████████████████████████████████████████▎                                   | 5164/9741 [00:41<00:31, 147.03it/s] 53%|████████████████████████████████████████▍                                   | 5179/9741 [00:41<00:33, 135.71it/s] 53%|████████████████████████████████████████▌                                   | 5193/9741 [00:41<00:35, 126.56it/s] 53%|████████████████████████████████████████▌                                   | 5206/9741 [00:41<00:38, 117.08it/s] 54%|████████████████████████████████████████▊                                   | 5224/9741 [00:41<00:34, 132.14it/s] 54%|████████████████████████████████████████▉                                   | 5241/9741 [00:41<00:32, 139.30it/s] 54%|█████████████████████████████████████████                                   | 5256/9741 [00:41<00:36, 124.46it/s] 54%|█████████████████████████████████████████                                   | 5271/9741 [00:42<00:34, 128.90it/s] 54%|█████████████████████████████████████████▏                                  | 5285/9741 [00:42<00:36, 122.65it/s] 54%|█████████████████████████████████████████▎                                  | 5302/9741 [00:42<00:33, 133.30it/s] 55%|█████████████████████████████████████████▍                                  | 5319/9741 [00:42<00:31, 140.05it/s] 55%|█████████████████████████████████████████▌                                  | 5334/9741 [00:42<00:35, 125.07it/s] 55%|█████████████████████████████████████████▋                                  | 5347/9741 [00:42<00:37, 116.63it/s] 55%|█████████████████████████████████████████▊                                  | 5367/9741 [00:42<00:31, 137.11it/s] 55%|██████████████████████████████████████████                                  | 5384/9741 [00:42<00:30, 144.15it/s] 55%|██████████████████████████████████████████▏                                 | 5400/9741 [00:43<00:29, 145.89it/s] 56%|██████████████████████████████████████████▏                                 | 5415/9741 [00:43<00:31, 137.82it/s] 56%|██████████████████████████████████████████▎                                 | 5431/9741 [00:43<00:30, 139.75it/s] 56%|██████████████████████████████████████████▍                                 | 5446/9741 [00:43<00:32, 133.93it/s] 56%|██████████████████████████████████████████▋                                 | 5464/9741 [00:43<00:29, 145.43it/s] 56%|██████████████████████████████████████████▊                                 | 5481/9741 [00:43<00:28, 150.32it/s] 56%|██████████████████████████████████████████▉                                 | 5497/9741 [00:43<00:29, 146.07it/s] 57%|███████████████████████████████████████████                                 | 5512/9741 [00:43<00:29, 144.30it/s] 57%|███████████████████████████████████████████                                 | 5527/9741 [00:43<00:31, 133.95it/s] 57%|███████████████████████████████████████████▎                                | 5545/9741 [00:44<00:28, 145.59it/s] 57%|███████████████████████████████████████████▍                                | 5562/9741 [00:44<00:27, 152.07it/s] 57%|███████████████████████████████████████████▌                                | 5578/9741 [00:44<00:29, 139.28it/s] 57%|███████████████████████████████████████████▋                                | 5593/9741 [00:44<00:30, 134.49it/s] 58%|███████████████████████████████████████████▊                                | 5614/9741 [00:44<00:26, 153.82it/s] 58%|███████████████████████████████████████████▉                                | 5631/9741 [00:44<00:26, 157.68it/s] 58%|████████████████████████████████████████████                                | 5648/9741 [00:44<00:25, 160.19it/s] 58%|████████████████████████████████████████████▏                               | 5665/9741 [00:44<00:26, 156.17it/s] 58%|████████████████████████████████████████████▎                               | 5681/9741 [00:44<00:27, 148.99it/s] 58%|████████████████████████████████████████████▍                               | 5697/9741 [00:45<00:28, 143.71it/s] 59%|████████████████████████████████████████████▌                               | 5712/9741 [00:45<00:28, 139.96it/s] 59%|████████████████████████████████████████████▋                               | 5729/9741 [00:45<00:27, 146.93it/s] 59%|████████████████████████████████████████████▊                               | 5744/9741 [00:45<00:28, 140.88it/s] 59%|████████████████████████████████████████████▉                               | 5759/9741 [00:45<00:30, 130.57it/s] 59%|█████████████████████████████████████████████                               | 5773/9741 [00:45<00:31, 124.99it/s] 59%|█████████████████████████████████████████████▏                              | 5789/9741 [00:45<00:29, 132.50it/s] 60%|█████████████████████████████████████████████▎                              | 5805/9741 [00:45<00:28, 139.82it/s] 60%|█████████████████████████████████████████████▍                              | 5820/9741 [00:45<00:29, 134.45it/s] 60%|█████████████████████████████████████████████▌                              | 5834/9741 [00:46<00:31, 124.00it/s] 60%|█████████████████████████████████████████████▌                              | 5847/9741 [00:46<00:33, 116.49it/s] 60%|█████████████████████████████████████████████▊                              | 5867/9741 [00:46<00:28, 136.08it/s] 60%|█████████████████████████████████████████████▉                              | 5884/9741 [00:46<00:26, 144.67it/s] 61%|██████████████████████████████████████████████                              | 5902/9741 [00:46<00:25, 152.60it/s] 61%|██████████████████████████████████████████████▏                             | 5918/9741 [00:46<00:25, 148.18it/s] 61%|██████████████████████████████████████████████▎                             | 5934/9741 [00:46<00:27, 137.98it/s] 61%|██████████████████████████████████████████████▍                             | 5949/9741 [00:46<00:27, 138.77it/s] 61%|██████████████████████████████████████████████▌                             | 5966/9741 [00:47<00:25, 146.62it/s] 61%|██████████████████████████████████████████████▋                             | 5983/9741 [00:47<00:24, 150.79it/s] 62%|██████████████████████████████████████████████▊                             | 5999/9741 [00:47<00:28, 131.40it/s] 62%|██████████████████████████████████████████████▉                             | 6015/9741 [00:47<00:26, 138.08it/s] 62%|███████████████████████████████████████████████                             | 6037/9741 [00:47<00:23, 158.38it/s] 62%|███████████████████████████████████████████████▏                            | 6054/9741 [00:47<00:22, 161.54it/s] 62%|███████████████████████████████████████████████▎                            | 6071/9741 [00:47<00:23, 158.42it/s] 62%|███████████████████████████████████████████████▍                            | 6088/9741 [00:47<00:26, 140.01it/s] 63%|███████████████████████████████████████████████▋                            | 6105/9741 [00:47<00:24, 146.58it/s] 63%|███████████████████████████████████████████████▊                            | 6122/9741 [00:48<00:24, 150.67it/s] 63%|███████████████████████████████████████████████▉                            | 6142/9741 [00:48<00:22, 163.31it/s] 63%|████████████████████████████████████████████████                            | 6159/9741 [00:48<00:21, 165.09it/s] 63%|████████████████████████████████████████████████▏                           | 6176/9741 [00:48<00:23, 154.43it/s] 64%|████████████████████████████████████████████████▎                           | 6192/9741 [00:48<00:25, 139.19it/s] 64%|████████████████████████████████████████████████▍                           | 6209/9741 [00:48<00:24, 145.67it/s] 64%|████████████████████████████████████████████████▌                           | 6229/9741 [00:48<00:21, 159.76it/s] 64%|████████████████████████████████████████████████▋                           | 6246/9741 [00:48<00:21, 160.74it/s] 64%|████████████████████████████████████████████████▊                           | 6264/9741 [00:48<00:21, 164.62it/s] 64%|█████████████████████████████████████████████████                           | 6281/9741 [00:49<00:23, 148.76it/s] 65%|█████████████████████████████████████████████████▏                          | 6297/9741 [00:49<00:26, 132.36it/s] 65%|█████████████████████████████████████████████████▎                          | 6313/9741 [00:49<00:24, 137.55it/s] 65%|█████████████████████████████████████████████████▍                          | 6331/9741 [00:49<00:23, 147.80it/s] 65%|█████████████████████████████████████████████████▌                          | 6350/9741 [00:49<00:21, 157.27it/s] 65%|█████████████████████████████████████████████████▋                          | 6367/9741 [00:49<00:21, 155.61it/s] 66%|█████████████████████████████████████████████████▊                          | 6383/9741 [00:49<00:21, 155.78it/s] 66%|█████████████████████████████████████████████████▉                          | 6399/9741 [00:49<00:22, 150.08it/s] 66%|██████████████████████████████████████████████████                          | 6415/9741 [00:49<00:22, 150.26it/s] 66%|██████████████████████████████████████████████████▏                         | 6433/9741 [00:50<00:20, 158.19it/s] 66%|██████████████████████████████████████████████████▎                         | 6449/9741 [00:50<00:20, 157.07it/s] 66%|██████████████████████████████████████████████████▍                         | 6465/9741 [00:50<00:21, 152.21it/s] 67%|██████████████████████████████████████████████████▌                         | 6481/9741 [00:50<00:24, 135.75it/s] 67%|██████████████████████████████████████████████████▋                         | 6497/9741 [00:50<00:23, 139.40it/s] 67%|██████████████████████████████████████████████████▊                         | 6512/9741 [00:50<00:24, 131.40it/s] 67%|██████████████████████████████████████████████████▉                         | 6526/9741 [00:50<00:24, 129.79it/s] 67%|███████████████████████████████████████████████████                         | 6540/9741 [00:50<00:28, 113.91it/s] 67%|███████████████████████████████████████████████████▏                        | 6554/9741 [00:51<00:26, 118.89it/s] 67%|███████████████████████████████████████████████████▏                        | 6567/9741 [00:51<00:26, 121.40it/s] 68%|███████████████████████████████████████████████████▍                        | 6585/9741 [00:51<00:23, 136.65it/s] 68%|███████████████████████████████████████████████████▍                        | 6600/9741 [00:51<00:22, 139.62it/s] 68%|███████████████████████████████████████████████████▌                        | 6615/9741 [00:51<00:25, 122.15it/s] 68%|███████████████████████████████████████████████████▋                        | 6628/9741 [00:51<00:26, 117.24it/s] 68%|███████████████████████████████████████████████████▊                        | 6646/9741 [00:51<00:23, 131.01it/s] 68%|███████████████████████████████████████████████████▉                        | 6663/9741 [00:51<00:22, 139.54it/s] 69%|████████████████████████████████████████████████████                        | 6678/9741 [00:51<00:21, 141.64it/s] 69%|████████████████████████████████████████████████████▏                       | 6693/9741 [00:52<00:23, 128.45it/s] 69%|████████████████████████████████████████████████████▎                       | 6707/9741 [00:52<00:25, 119.71it/s] 69%|████████████████████████████████████████████████████▍                       | 6722/9741 [00:52<00:24, 125.18it/s] 69%|████████████████████████████████████████████████████▌                       | 6735/9741 [00:52<00:25, 118.28it/s] 69%|████████████████████████████████████████████████████▋                       | 6752/9741 [00:52<00:22, 130.37it/s] 69%|████████████████████████████████████████████████████▊                       | 6766/9741 [00:52<00:25, 116.31it/s] 70%|████████████████████████████████████████████████████▉                       | 6782/9741 [00:52<00:23, 126.71it/s] 70%|█████████████████████████████████████████████████████                       | 6796/9741 [00:52<00:24, 118.14it/s] 70%|█████████████████████████████████████████████████████▏                      | 6812/9741 [00:53<00:22, 128.54it/s] 70%|█████████████████████████████████████████████████████▎                      | 6826/9741 [00:53<00:22, 130.28it/s] 70%|█████████████████████████████████████████████████████▎                      | 6840/9741 [00:53<00:23, 120.97it/s] 70%|█████████████████████████████████████████████████████▍                      | 6854/9741 [00:53<00:23, 124.62it/s] 71%|█████████████████████████████████████████████████████▌                      | 6869/9741 [00:53<00:22, 129.79it/s] 71%|█████████████████████████████████████████████████████▋                      | 6886/9741 [00:53<00:20, 140.50it/s] 71%|█████████████████████████████████████████████████████▊                      | 6901/9741 [00:53<00:19, 143.01it/s] 71%|█████████████████████████████████████████████████████▉                      | 6916/9741 [00:53<00:21, 131.66it/s] 71%|██████████████████████████████████████████████████████                      | 6930/9741 [00:54<00:22, 122.44it/s] 71%|██████████████████████████████████████████████████████▏                     | 6943/9741 [00:54<00:23, 121.16it/s] 71%|██████████████████████████████████████████████████████▎                     | 6956/9741 [00:54<00:24, 114.08it/s] 72%|██████████████████████████████████████████████████████▍                     | 6975/9741 [00:54<00:20, 132.46it/s] 72%|██████████████████████████████████████████████████████▌                     | 6991/9741 [00:54<00:19, 137.95it/s] 72%|██████████████████████████████████████████████████████▋                     | 7006/9741 [00:54<00:21, 130.23it/s] 72%|██████████████████████████████████████████████████████▊                     | 7020/9741 [00:54<00:22, 122.03it/s] 72%|██████████████████████████████████████████████████████▊                     | 7033/9741 [00:54<00:23, 115.62it/s] 72%|███████████████████████████████████████████████████████                     | 7051/9741 [00:54<00:20, 130.19it/s] 73%|███████████████████████████████████████████████████████▏                    | 7067/9741 [00:55<00:19, 136.67it/s] 73%|███████████████████████████████████████████████████████▏                    | 7081/9741 [00:55<00:20, 128.09it/s] 73%|███████████████████████████████████████████████████████▎                    | 7095/9741 [00:55<00:20, 128.03it/s] 73%|███████████████████████████████████████████████████████▌                    | 7116/9741 [00:55<00:17, 149.00it/s] 73%|███████████████████████████████████████████████████████▋                    | 7134/9741 [00:55<00:16, 156.94it/s] 73%|███████████████████████████████████████████████████████▊                    | 7150/9741 [00:55<00:16, 157.43it/s] 74%|███████████████████████████████████████████████████████▉                    | 7166/9741 [00:55<00:19, 134.73it/s] 74%|████████████████████████████████████████████████████████                    | 7181/9741 [00:55<00:19, 133.71it/s] 74%|████████████████████████████████████████████████████████▏                   | 7195/9741 [00:55<00:19, 133.24it/s] 74%|████████████████████████████████████████████████████████▎                   | 7210/9741 [00:56<00:18, 135.19it/s] 74%|████████████████████████████████████████████████████████▎                   | 7224/9741 [00:56<00:20, 122.95it/s] 74%|████████████████████████████████████████████████████████▍                   | 7237/9741 [00:56<00:20, 121.44it/s] 74%|████████████████████████████████████████████████████████▌                   | 7250/9741 [00:56<00:22, 112.16it/s] 75%|████████████████████████████████████████████████████████▋                   | 7268/9741 [00:56<00:19, 128.13it/s] 75%|████████████████████████████████████████████████████████▊                   | 7282/9741 [00:56<00:19, 127.18it/s] 75%|████████████████████████████████████████████████████████▉                   | 7298/9741 [00:56<00:18, 134.91it/s] 75%|█████████████████████████████████████████████████████████                   | 7313/9741 [00:56<00:17, 136.24it/s] 75%|█████████████████████████████████████████████████████████▏                  | 7329/9741 [00:57<00:17, 141.28it/s] 75%|█████████████████████████████████████████████████████████▎                  | 7346/9741 [00:57<00:16, 147.00it/s] 76%|█████████████████████████████████████████████████████████▍                  | 7361/9741 [00:57<00:16, 147.48it/s] 76%|█████████████████████████████████████████████████████████▌                  | 7376/9741 [00:57<00:18, 130.86it/s] 76%|█████████████████████████████████████████████████████████▋                  | 7392/9741 [00:57<00:17, 137.33it/s] 76%|█████████████████████████████████████████████████████████▊                  | 7409/9741 [00:57<00:16, 144.54it/s] 76%|█████████████████████████████████████████████████████████▉                  | 7426/9741 [00:57<00:15, 151.08it/s] 76%|██████████████████████████████████████████████████████████                  | 7442/9741 [00:57<00:19, 115.35it/s] 77%|██████████████████████████████████████████████████████████▏                 | 7455/9741 [00:58<00:21, 107.18it/s] 77%|██████████████████████████████████████████████████████████▎                 | 7470/9741 [00:58<00:19, 116.50it/s] 77%|██████████████████████████████████████████████████████████▍                 | 7488/9741 [00:58<00:17, 131.44it/s] 77%|██████████████████████████████████████████████████████████▌                 | 7503/9741 [00:58<00:16, 133.98it/s] 77%|██████████████████████████████████████████████████████████▋                 | 7519/9741 [00:58<00:15, 140.11it/s] 77%|██████████████████████████████████████████████████████████▊                 | 7534/9741 [00:58<00:15, 141.00it/s] 78%|██████████████████████████████████████████████████████████▉                 | 7551/9741 [00:58<00:14, 147.70it/s] 78%|███████████████████████████████████████████████████████████                 | 7568/9741 [00:58<00:14, 152.39it/s] 78%|███████████████████████████████████████████████████████████▏                | 7584/9741 [00:58<00:14, 149.01it/s] 78%|███████████████████████████████████████████████████████████▎                | 7600/9741 [00:58<00:14, 145.50it/s] 78%|███████████████████████████████████████████████████████████▍                | 7615/9741 [00:59<00:14, 144.66it/s] 78%|███████████████████████████████████████████████████████████▌                | 7630/9741 [00:59<00:14, 142.66it/s] 78%|███████████████████████████████████████████████████████████▋                | 7645/9741 [00:59<00:14, 141.27it/s] 79%|███████████████████████████████████████████████████████████▊                | 7660/9741 [00:59<00:14, 141.85it/s] 79%|███████████████████████████████████████████████████████████▉                | 7675/9741 [00:59<00:14, 139.82it/s] 79%|███████████████████████████████████████████████████████████▉                | 7690/9741 [00:59<00:14, 141.81it/s] 79%|████████████████████████████████████████████████████████████                | 7705/9741 [00:59<00:14, 141.18it/s] 79%|████████████████████████████████████████████████████████████▏               | 7720/9741 [00:59<00:14, 140.34it/s] 79%|████████████████████████████████████████████████████████████▎               | 7735/9741 [00:59<00:14, 139.95it/s] 80%|████████████████████████████████████████████████████████████▍               | 7750/9741 [01:00<00:14, 138.79it/s] 80%|████████████████████████████████████████████████████████████▌               | 7764/9741 [01:00<00:14, 134.10it/s] 80%|████████████████████████████████████████████████████████████▋               | 7778/9741 [01:00<00:15, 130.35it/s] 80%|████████████████████████████████████████████████████████████▊               | 7794/9741 [01:00<00:14, 135.54it/s] 80%|████████████████████████████████████████████████████████████▉               | 7808/9741 [01:00<00:15, 124.08it/s] 80%|█████████████████████████████████████████████████████████████               | 7821/9741 [01:00<00:15, 120.98it/s] 80%|█████████████████████████████████████████████████████████████▏              | 7838/9741 [01:00<00:14, 133.28it/s] 81%|█████████████████████████████████████████████████████████████▎              | 7853/9741 [01:00<00:13, 134.91it/s] 81%|█████████████████████████████████████████████████████████████▍              | 7867/9741 [01:00<00:14, 130.57it/s] 81%|█████████████████████████████████████████████████████████████▍              | 7881/9741 [01:01<00:14, 131.84it/s] 81%|█████████████████████████████████████████████████████████████▌              | 7895/9741 [01:01<00:14, 123.19it/s] 81%|█████████████████████████████████████████████████████████████▋              | 7908/9741 [01:01<00:15, 119.10it/s] 81%|█████████████████████████████████████████████████████████████▊              | 7921/9741 [01:01<00:15, 114.57it/s] 81%|█████████████████████████████████████████████████████████████▉              | 7934/9741 [01:01<00:15, 118.01it/s] 82%|█████████████████████████████████████████████████████████████▉              | 7946/9741 [01:01<00:15, 117.17it/s] 82%|██████████████████████████████████████████████████████████████              | 7958/9741 [01:01<00:15, 112.41it/s] 82%|██████████████████████████████████████████████████████████████▏             | 7973/9741 [01:01<00:14, 121.28it/s] 82%|██████████████████████████████████████████████████████████████▎             | 7990/9741 [01:01<00:13, 134.53it/s] 82%|██████████████████████████████████████████████████████████████▍             | 8006/9741 [01:02<00:12, 139.50it/s] 82%|██████████████████████████████████████████████████████████████▌             | 8021/9741 [01:02<00:13, 127.84it/s] 82%|██████████████████████████████████████████████████████████████▋             | 8035/9741 [01:02<00:15, 107.65it/s] 83%|███████████████████████████████████████████████████████████████▌             | 8047/9741 [01:02<00:17, 99.20it/s] 83%|██████████████████████████████████████████████████████████████▉             | 8060/9741 [01:02<00:15, 105.41it/s] 83%|██████████████████████████████████████████████████████████████▉             | 8074/9741 [01:02<00:14, 113.33it/s] 83%|███████████████████████████████████████████████████████████████             | 8088/9741 [01:02<00:13, 118.56it/s] 83%|███████████████████████████████████████████████████████████████▏            | 8101/9741 [01:03<00:15, 106.65it/s] 83%|████████████████████████████████████████████████████████████████▏            | 8113/9741 [01:03<00:16, 96.53it/s] 83%|████████████████████████████████████████████████████████████████▏            | 8124/9741 [01:03<00:17, 91.12it/s] 84%|████████████████████████████████████████████████████████████████▎            | 8137/9741 [01:03<00:16, 98.95it/s] 84%|███████████████████████████████████████████████████████████████▌            | 8150/9741 [01:03<00:14, 106.45it/s] 84%|███████████████████████████████████████████████████████████████▋            | 8162/9741 [01:03<00:14, 109.01it/s] 84%|███████████████████████████████████████████████████████████████▊            | 8174/9741 [01:03<00:14, 108.64it/s] 84%|███████████████████████████████████████████████████████████████▊            | 8186/9741 [01:03<00:15, 100.13it/s] 84%|███████████████████████████████████████████████████████████████▉            | 8199/9741 [01:03<00:14, 105.86it/s] 84%|████████████████████████████████████████████████████████████████            | 8212/9741 [01:04<00:13, 110.79it/s] 84%|████████████████████████████████████████████████████████████████▏           | 8224/9741 [01:04<00:14, 107.29it/s] 85%|████████████████████████████████████████████████████████████████▎           | 8237/9741 [01:04<00:13, 113.21it/s] 85%|████████████████████████████████████████████████████████████████▎           | 8250/9741 [01:04<00:12, 115.55it/s] 85%|████████████████████████████████████████████████████████████████▍           | 8263/9741 [01:04<00:12, 119.20it/s] 85%|████████████████████████████████████████████████████████████████▌           | 8277/9741 [01:04<00:11, 122.74it/s] 85%|████████████████████████████████████████████████████████████████▋           | 8290/9741 [01:04<00:12, 116.57it/s] 85%|████████████████████████████████████████████████████████████████▊           | 8302/9741 [01:04<00:12, 117.19it/s] 85%|████████████████████████████████████████████████████████████████▊           | 8314/9741 [01:04<00:13, 105.90it/s] 85%|████████████████████████████████████████████████████████████████▉           | 8328/9741 [01:05<00:12, 114.36it/s] 86%|█████████████████████████████████████████████████████████████████           | 8341/9741 [01:05<00:11, 118.62it/s] 86%|█████████████████████████████████████████████████████████████████▏          | 8354/9741 [01:05<00:12, 114.07it/s] 86%|██████████████████████████████████████████████████████████████████▏          | 8366/9741 [01:05<00:14, 97.42it/s] 86%|██████████████████████████████████████████████████████████████████▏          | 8377/9741 [01:05<00:14, 96.02it/s] 86%|██████████████████████████████████████████████████████████████████▎          | 8387/9741 [01:05<00:13, 96.93it/s] 86%|█████████████████████████████████████████████████████████████████▌          | 8400/9741 [01:05<00:12, 105.59it/s] 86%|█████████████████████████████████████████████████████████████████▋          | 8412/9741 [01:05<00:12, 107.67it/s] 86%|█████████████████████████████████████████████████████████████████▋          | 8423/9741 [01:06<00:12, 104.96it/s] 87%|█████████████████████████████████████████████████████████████████▊          | 8435/9741 [01:06<00:12, 108.55it/s] 87%|█████████████████████████████████████████████████████████████████▉          | 8447/9741 [01:06<00:12, 107.54it/s] 87%|█████████████████████████████████████████████████████████████████▉          | 8458/9741 [01:06<00:12, 100.91it/s] 87%|██████████████████████████████████████████████████████████████████▉          | 8469/9741 [01:06<00:13, 96.62it/s] 87%|███████████████████████████████████████████████████████████████████          | 8480/9741 [01:06<00:12, 99.96it/s] 87%|██████████████████████████████████████████████████████████████████▎         | 8492/9741 [01:06<00:12, 103.38it/s] 87%|██████████████████████████████████████████████████████████████████▎         | 8503/9741 [01:06<00:12, 101.57it/s] 87%|██████████████████████████████████████████████████████████████████▍         | 8516/9741 [01:06<00:11, 105.91it/s] 88%|███████████████████████████████████████████████████████████████████▍         | 8527/9741 [01:07<00:12, 99.11it/s] 88%|██████████████████████████████████████████████████████████████████▋         | 8540/9741 [01:07<00:11, 106.26it/s] 88%|██████████████████████████████████████████████████████████████████▋         | 8551/9741 [01:07<00:11, 106.04it/s] 88%|██████████████████████████████████████████████████████████████████▊         | 8563/9741 [01:07<00:10, 108.11it/s] 88%|██████████████████████████████████████████████████████████████████▉         | 8574/9741 [01:07<00:11, 101.94it/s] 88%|███████████████████████████████████████████████████████████████████▊         | 8585/9741 [01:07<00:11, 98.93it/s] 88%|███████████████████████████████████████████████████████████████████         | 8599/9741 [01:07<00:10, 108.06it/s] 88%|███████████████████████████████████████████████████████████████████▏        | 8611/9741 [01:07<00:10, 109.05it/s] 89%|███████████████████████████████████████████████████████████████████▎        | 8622/9741 [01:07<00:10, 106.75it/s] 89%|███████████████████████████████████████████████████████████████████▎        | 8634/9741 [01:08<00:10, 109.61it/s] 89%|███████████████████████████████████████████████████████████████████▍        | 8648/9741 [01:08<00:09, 117.14it/s] 89%|███████████████████████████████████████████████████████████████████▌        | 8661/9741 [01:08<00:09, 119.80it/s] 89%|███████████████████████████████████████████████████████████████████▋        | 8674/9741 [01:08<00:09, 117.43it/s] 89%|███████████████████████████████████████████████████████████████████▊        | 8686/9741 [01:08<00:09, 116.27it/s] 89%|███████████████████████████████████████████████████████████████████▊        | 8698/9741 [01:08<00:09, 111.63it/s] 89%|███████████████████████████████████████████████████████████████████▉        | 8710/9741 [01:08<00:10, 101.55it/s] 90%|████████████████████████████████████████████████████████████████████        | 8723/9741 [01:08<00:09, 108.85it/s] 90%|████████████████████████████████████████████████████████████████████▏       | 8735/9741 [01:08<00:09, 107.51it/s] 90%|████████████████████████████████████████████████████████████████████▏       | 8746/9741 [01:09<00:09, 100.10it/s] 90%|████████████████████████████████████████████████████████████████████▎       | 8757/9741 [01:09<00:09, 102.27it/s] 90%|████████████████████████████████████████████████████████████████████▍       | 8771/9741 [01:09<00:08, 112.53it/s] 90%|████████████████████████████████████████████████████████████████████▌       | 8785/9741 [01:09<00:08, 118.53it/s] 90%|████████████████████████████████████████████████████████████████████▋       | 8798/9741 [01:09<00:08, 116.52it/s] 90%|████████████████████████████████████████████████████████████████████▋       | 8810/9741 [01:09<00:08, 115.96it/s] 91%|████████████████████████████████████████████████████████████████████▊       | 8822/9741 [01:09<00:08, 112.98it/s] 91%|████████████████████████████████████████████████████████████████████▉       | 8834/9741 [01:09<00:08, 102.44it/s] 91%|█████████████████████████████████████████████████████████████████████       | 8849/9741 [01:09<00:07, 113.85it/s] 91%|█████████████████████████████████████████████████████████████████████▏      | 8865/9741 [01:10<00:06, 126.04it/s] 91%|█████████████████████████████████████████████████████████████████████▎      | 8879/9741 [01:10<00:06, 128.13it/s] 91%|█████████████████████████████████████████████████████████████████████▍      | 8896/9741 [01:10<00:06, 139.55it/s] 91%|█████████████████████████████████████████████████████████████████████▌      | 8912/9741 [01:10<00:05, 144.53it/s] 92%|█████████████████████████████████████████████████████████████████████▋      | 8927/9741 [01:10<00:06, 130.09it/s] 92%|█████████████████████████████████████████████████████████████████████▊      | 8941/9741 [01:10<00:06, 120.04it/s] 92%|█████████████████████████████████████████████████████████████████████▉      | 8956/9741 [01:10<00:06, 124.66it/s] 92%|█████████████████████████████████████████████████████████████████████▉      | 8969/9741 [01:10<00:06, 117.92it/s] 92%|██████████████████████████████████████████████████████████████████████      | 8985/9741 [01:10<00:05, 128.35it/s] 92%|██████████████████████████████████████████████████████████████████████▏     | 9003/9741 [01:11<00:05, 139.85it/s] 93%|██████████████████████████████████████████████████████████████████████▎     | 9018/9741 [01:11<00:05, 125.74it/s] 93%|██████████████████████████████████████████████████████████████████████▍     | 9032/9741 [01:11<00:05, 118.91it/s] 93%|██████████████████████████████████████████████████████████████████████▌     | 9045/9741 [01:11<00:05, 120.76it/s] 93%|██████████████████████████████████████████████████████████████████████▋     | 9058/9741 [01:11<00:06, 112.61it/s] 93%|██████████████████████████████████████████████████████████████████████▊     | 9075/9741 [01:11<00:05, 125.48it/s] 93%|██████████████████████████████████████████████████████████████████████▉     | 9092/9741 [01:11<00:04, 135.42it/s] 93%|███████████████████████████████████████████████████████████████████████     | 9106/9741 [01:11<00:04, 133.95it/s] 94%|███████████████████████████████████████████████████████████████████████▏    | 9120/9741 [01:12<00:04, 134.53it/s] 94%|███████████████████████████████████████████████████████████████████████▎    | 9134/9741 [01:12<00:04, 125.93it/s] 94%|███████████████████████████████████████████████████████████████████████▍    | 9150/9741 [01:12<00:04, 132.89it/s] 94%|███████████████████████████████████████████████████████████████████████▌    | 9166/9741 [01:12<00:04, 140.22it/s] 94%|███████████████████████████████████████████████████████████████████████▋    | 9183/9741 [01:12<00:03, 148.34it/s] 94%|███████████████████████████████████████████████████████████████████████▊    | 9200/9741 [01:12<00:03, 154.01it/s] 95%|███████████████████████████████████████████████████████████████████████▉    | 9216/9741 [01:12<00:03, 148.38it/s] 95%|████████████████████████████████████████████████████████████████████████    | 9232/9741 [01:12<00:03, 150.17it/s] 95%|████████████████████████████████████████████████████████████████████████▏   | 9249/9741 [01:12<00:03, 153.43it/s] 95%|████████████████████████████████████████████████████████████████████████▎   | 9265/9741 [01:13<00:03, 135.03it/s] 95%|████████████████████████████████████████████████████████████████████████▍   | 9285/9741 [01:13<00:03, 151.65it/s] 95%|████████████████████████████████████████████████████████████████████████▌   | 9301/9741 [01:13<00:02, 148.02it/s] 96%|████████████████████████████████████████████████████████████████████████▋   | 9317/9741 [01:13<00:03, 138.61it/s] 96%|████████████████████████████████████████████████████████████████████████▊   | 9332/9741 [01:13<00:03, 125.36it/s] 96%|████████████████████████████████████████████████████████████████████████▉   | 9345/9741 [01:13<00:03, 124.42it/s] 96%|█████████████████████████████████████████████████████████████████████████   | 9358/9741 [01:13<00:03, 119.25it/s] 96%|█████████████████████████████████████████████████████████████████████████▏  | 9378/9741 [01:13<00:02, 138.64it/s] 96%|█████████████████████████████████████████████████████████████████████████▎  | 9395/9741 [01:13<00:02, 146.93it/s] 97%|█████████████████████████████████████████████████████████████████████████▍  | 9411/9741 [01:14<00:02, 142.98it/s] 97%|█████████████████████████████████████████████████████████████████████████▌  | 9426/9741 [01:14<00:02, 128.17it/s] 97%|█████████████████████████████████████████████████████████████████████████▋  | 9440/9741 [01:14<00:02, 125.41it/s] 97%|█████████████████████████████████████████████████████████████████████████▊  | 9457/9741 [01:14<00:02, 134.49it/s] 97%|█████████████████████████████████████████████████████████████████████████▉  | 9471/9741 [01:14<00:02, 122.30it/s] 97%|██████████████████████████████████████████████████████████████████████████  | 9486/9741 [01:14<00:01, 129.02it/s] 98%|██████████████████████████████████████████████████████████████████████████  | 9500/9741 [01:14<00:01, 131.87it/s] 98%|██████████████████████████████████████████████████████████████████████████▏ | 9514/9741 [01:14<00:01, 124.83it/s] 98%|██████████████████████████████████████████████████████████████████████████▎ | 9527/9741 [01:15<00:01, 125.63it/s] 98%|██████████████████████████████████████████████████████████████████████████▍ | 9540/9741 [01:15<00:01, 118.21it/s] 98%|██████████████████████████████████████████████████████████████████████████▌ | 9557/9741 [01:15<00:01, 131.76it/s] 98%|██████████████████████████████████████████████████████████████████████████▋ | 9571/9741 [01:15<00:01, 124.14it/s] 98%|██████████████████████████████████████████████████████████████████████████▊ | 9588/9741 [01:15<00:01, 135.06it/s] 99%|██████████████████████████████████████████████████████████████████████████▉ | 9605/9741 [01:15<00:00, 142.52it/s] 99%|███████████████████████████████████████████████████████████████████████████ | 9620/9741 [01:15<00:00, 140.57it/s] 99%|███████████████████████████████████████████████████████████████████████████▏| 9637/9741 [01:15<00:00, 147.38it/s] 99%|███████████████████████████████████████████████████████████████████████████▎| 9652/9741 [01:15<00:00, 140.08it/s] 99%|███████████████████████████████████████████████████████████████████████████▍| 9667/9741 [01:16<00:00, 124.24it/s] 99%|███████████████████████████████████████████████████████████████████████████▌| 9685/9741 [01:16<00:00, 137.95it/s]100%|███████████████████████████████████████████████████████████████████████████▋| 9700/9741 [01:16<00:00, 128.75it/s]100%|███████████████████████████████████████████████████████████████████████████▊| 9714/9741 [01:16<00:00, 129.66it/s]100%|███████████████████████████████████████████████████████████████████████████▉| 9728/9741 [01:16<00:00, 126.43it/s]100%|████████████████████████████████████████████████████████████████████████████| 9741/9741 [01:16<00:00, 123.21it/s]100%|████████████████████████████████████████████████████████████████████████████| 9741/9741 [01:16<00:00, 127.04it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                                | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████████████▋                                     | 1/3 [00:07<00:15,  7.52s/it]Loading checkpoint shards:  33%|██████████████████▋                                     | 1/3 [00:07<00:15,  7.54s/it]Loading checkpoint shards:  33%|██████████████████▋                                     | 1/3 [00:07<00:14,  7.17s/it]Loading checkpoint shards:  33%|██████████████████▋                                     | 1/3 [00:07<00:15,  7.71s/it]Loading checkpoint shards:  67%|█████████████████████████████████████▎                  | 2/3 [00:14<00:07,  7.46s/it]Loading checkpoint shards:  67%|█████████████████████████████████████▎                  | 2/3 [00:15<00:07,  7.69s/it]Loading checkpoint shards:  67%|█████████████████████████████████████▎                  | 2/3 [00:14<00:07,  7.46s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:20<00:00,  6.65s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:20<00:00,  6.88s/it]
Loading checkpoint shards:  67%|█████████████████████████████████████▎                  | 2/3 [00:15<00:08,  8.04s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:21<00:00,  6.84s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:21<00:00,  7.05s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:20<00:00,  6.75s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:20<00:00,  6.92s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:22<00:00,  7.29s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:22<00:00,  7.46s/it]
[2023-08-08 19:53:32,170] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
[2023-08-08 19:53:45,814] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-08 19:53:45,816] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-08 19:53:45,817] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-08 19:53:45,817] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-08 19:53:45,817] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-08 19:53:45,817] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-08 19:53:45,818] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-08 19:53:45,818] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-08 19:53:45,818] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-08 19:53:45,818] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-08 19:53:45,818] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-08 19:53:45,818] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f221dbd4e80>
[2023-08-08 19:53:45,818] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-08 19:53:45,819] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-08 19:53:45,819] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-08 19:53:45,819] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-08 19:53:45,819] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-08 19:53:45,819] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-08 19:53:45,819] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-08 19:53:45,819] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-08 19:53:45,819] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-08 19:53:45,819] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-08 19:53:45,819] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-08 19:53:45,819] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-08 19:53:45,819] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-08 19:53:45,819] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-08 19:53:45,819] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-08 19:53:45,819] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-08 19:53:45,819] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-08 19:53:45,819] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-08 19:53:45,819] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-08 19:53:45,819] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-08 19:53:45,819] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-08 19:53:45,819] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-08 19:53:45,819] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-08 19:53:45,819] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-08 19:53:45,819] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-08 19:53:45,819] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-08 19:53:45,819] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-08 19:53:45,819] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-08 19:53:45,819] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-08 19:53:45,819] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-08 19:53:45,820] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-08 19:53:45,820] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-08 19:53:45,820] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f221d864910>
[2023-08-08 19:53:45,820] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-08 19:53:45,820] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-08 19:53:45,820] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-08 19:53:45,820] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-08 19:53:45,820] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-08 19:53:45,820] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-08 19:53:45,820] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-08 19:53:45,820] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-08 19:53:45,820] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-08 19:53:45,820] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-08 19:53:45,820] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-08 19:53:45,820] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-08 19:53:45,820] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-08 19:53:45,820] [INFO] [config.py:1012:print]   train_batch_size ............. 16
[2023-08-08 19:53:45,820] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  4
[2023-08-08 19:53:45,820] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-08 19:53:45,820] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-08 19:53:45,820] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-08 19:53:45,820] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-08 19:53:45,820] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-08 19:53:45,820] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-08 19:53:45,821] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-08 19:53:45,821] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 4, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.770728588104248 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                                               | 0/63 [00:00<?, ?it/s]############### Example ###############
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following multiple choice question.

### Demonstration:
Input: For every 12 cans you recycle, you receive $0.50, and for every 5 kilograms of newspapers, you receive $1.50. If your family collected 144 cans and 20 kilograms of newspapers, how much money would you receive?
Rationales: The question provides the quantities of cans and newspapers collected and the amount received per given quantity of cans and newspapers recycled. 

Step 1: First, we need to determine how many sets of 12 cans the family collected. To do this, we divide the total number of cans collected (144) by the number of cans per set (12). 144 divided by 12 equals 12 sets.

Step 2: Then, we multiply the number of sets of cans (12) by the amount received per set of cans ($0.50) to find the total amount received for recycling the cans. 12 times $0.50 equals $6.

Step 3: Similarly, we need to determine how many sets of 5 kilograms of newspapers the family collected. To do this, we divide the total weight of the newspapers collected (20 kilograms) by the weight per set (5 kilograms). 20 divided by 5 equals 4 sets.

Step 4: We then multiply the number of sets of newspapers (4) by the amount received per set of newspapers ($1.50) to find the total amount received for recycling the newspapers. 4 times $1.50 equals $6.

Step 5: We add the amounts received for recycling the cans and the newspapers together to find the total amount received. $6 plus $6 equals $12. Therefore, the family would receive a total of $12 for recycling the 144 cans and 20 kilograms of newspapers.
Answer: 12

Input: Betty picked 16 strawberries. Matthew picked 20 more strawberries than Betty and twice as many as Natalie. They used their strawberries to make jam. One jar of jam used 7 strawberries and they sold each jar at $4. How much money were they able to make from the strawberries they picked?
Rationales: Betty picked 16 strawberries.
Matthew picked more than Betty, so he picked 16 strawberries + 20 strawberries = 36 strawberries.
Matthew also picked twice as many strawberries as Natalie, so Natalie picked 36 strawberries / 2 = 18 strawberries.
Adding up all the strawberries the three of them picked, they have 16 strawberries (Betty) + 36 strawberries (Matthew) + 18 strawberries (Natalie) = 70 strawberries in total.
Dividing the total number of strawberries by the number of strawberries needed for each jar of jam (7 strawberries per jar), they managed to make 70 strawberries / 7 = 10 jars of jam.
Since they sold each jar for $4, they earned 10 jars * $4/jar = $40 in total from selling their jam. So the answer is $40.
Answer: 40

Input: Jack has a stack of books that is 12 inches thick. He knows from experience that 80 pages is one inch thick. If he has 6 books, how many pages is each one on average?
Rationales: Given:

- The total thickness of Jack's books is 12 inches.
- 1 inch thickness is equivalent to 80 pages.
- Jack has 6 books.

By these premises, we can use the following steps to find the average number of pages per book:

Step 1: Find the total number of pages that has the thickness of all Jack's books. We can do this by multiplying the total thickness in inches by the number of pages per inch. In this case, it would be 80 pages/inch x 12 inches = 960 pages.

Step 2: Find the average number of pages in each book. We can do this by dividing the total number of pages by the number of books Jack has. So, it would be 960 pages / 6 books = 160 pages/book.

Therefore, each book has, on average, 160 pages.
Answer: 160

Input: James dumps his whole collection of 500 Legos on the floor and starts building a castle out of them.  He uses half the pieces before finishing and is told to put the rest away.  He puts all of the leftover pieces back in the box they came from, except for 5 missing pieces that he can't find.  How many Legos are in the box at the end?
Rationales: James starts with a total of 500 Legos.
When he starts building a castle, he uses half of the total Legos. In numbers, half of 500 is calculated as 500 divided by 2, which is equal to 250 Legos. So, 250 Legos are used and the same amount is left unused.
After he finishes building, he is told to put the unused Legos away. But he finds that 5 Legos are missing. Therefore, the number of Legos he puts back in the box is calculated as total unused Legos minus missing Legos, which is equal to 250-5, resulting in 245 Legos.
Therefore, the answer is 245 Legos are in the box at the end.
Answer: 245

Input: Ines had $20 in her purse. She bought 3 pounds of peaches, which are $2 per pound at the local farmers’ market. How much did she have left?
Rationales: Ines initially had $20. 
The peaches cost $2 per pound. 
She bought 3 pounds of peaches. 
Therefore, the total cost of peaches is 3 pounds * $2 per pound = $6. 
After buying the peaches, she is left with her initial money minus what she spent; which is $20 - $6 = $14.
Answer: 14

Input: Aaron pays his actuary membership fees each year. The membership fee increases yearly by $10. If he pays $80 in the first year, how much does his membership cost, in dollars, in the sixth year?
Rationales: Aaron pays $80 for the first year.
The membership fee increases by $10 in the second year, therefore he pays $80 + $10 = $90.
The membership fee increases by $10 again in the third year, therefore he pays $90 + $10 = $100.
Similarly, the membership fee again increases by $10 in the fourth year, therefore he pays $100 + $10 = $110.
In the fifth year, following the same pattern the membership fee increases by $10 yet again, leading to Aaron paying $110 + $10 = $120.
Finally, in the sixth year, the membership fee increases one last time by $10, Aaron therefore pays $120 + $10, which totals to $130 for the sixth year.
Answer: 130

Input: Joseph invested $1000 into a hedge fund. The fund promised a yearly interest rate of 10%. If he deposited an additional $100 every month into the account to add to his initial investment of $1000, how much money will he have in the fund after two years?
Rationales: Joseph initially invested $1000 into the hedge fund, and promised a yearly interest rate of 10%.

For the first year, he also deposited an additional $100 every month into the account. 
So, his total investment for the first year was $1000 (initial investment) + $100 * 12 (monthly deposit) = $2200.

The interest received from the hedge fund for the first year would be 10% of $2200, 
which is $2200 * 10% = $220.

Adding this to his investment for the first year, the total value of his investment by the end
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o7-tgsm8k-s42-rTrue
Loading extension module utils...
Time to load utils op: 0.7057487964630127 seconds
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.503873348236084 seconds
Time to load utils op: 0.7052786350250244 seconds
Evaluating commonsenseqa :   2%|▊                                                      | 1/63 [00:39<41:05, 39.77s/it]Evaluating commonsenseqa :   3%|█▋                                                     | 2/63 [01:18<40:04, 39.42s/it]Evaluating commonsenseqa :   5%|██▌                                                    | 3/63 [01:57<39:05, 39.09s/it]Evaluating commonsenseqa :   6%|███▍                                                   | 4/63 [02:37<38:36, 39.26s/it]Evaluating commonsenseqa :   8%|████▎                                                  | 5/63 [03:16<37:56, 39.25s/it]Evaluating commonsenseqa :  10%|█████▏                                                 | 6/63 [03:55<37:09, 39.12s/it]Evaluating commonsenseqa :  11%|██████                                                 | 7/63 [04:34<36:37, 39.24s/it]Evaluating commonsenseqa :  13%|██████▉                                                | 8/63 [05:14<36:07, 39.42s/it]Evaluating commonsenseqa :  14%|███████▊                                               | 9/63 [05:53<35:21, 39.30s/it]Evaluating commonsenseqa :  16%|████████▌                                             | 10/63 [06:32<34:37, 39.19s/it]Evaluating commonsenseqa :  17%|█████████▍                                            | 11/63 [07:11<33:53, 39.11s/it]Evaluating commonsenseqa :  19%|██████████▎                                           | 12/63 [07:50<33:18, 39.18s/it]Evaluating commonsenseqa :  21%|███████████▏                                          | 13/63 [08:30<32:46, 39.33s/it]Evaluating commonsenseqa :  22%|████████████                                          | 14/63 [09:09<32:02, 39.24s/it]Evaluating commonsenseqa :  24%|████████████▊                                         | 15/63 [09:48<31:15, 39.08s/it]Evaluating commonsenseqa :  25%|█████████████▋                                        | 16/63 [10:27<30:39, 39.13s/it]Evaluating commonsenseqa :  27%|██████████████▌                                       | 17/63 [11:06<30:03, 39.20s/it]Evaluating commonsenseqa :  29%|███████████████▍                                      | 18/63 [11:45<29:20, 39.13s/it]Evaluating commonsenseqa :  30%|████████████████▎                                     | 19/63 [12:25<28:45, 39.22s/it]Evaluating commonsenseqa :  32%|█████████████████▏                                    | 20/63 [13:04<28:06, 39.23s/it]Evaluating commonsenseqa :  33%|██████████████████                                    | 21/63 [13:43<27:24, 39.17s/it]Evaluating commonsenseqa :  35%|██████████████████▊                                   | 22/63 [14:22<26:45, 39.16s/it]Evaluating commonsenseqa :  37%|███████████████████▋                                  | 23/63 [15:01<26:03, 39.10s/it]Evaluating commonsenseqa :  38%|████████████████████▌                                 | 24/63 [15:40<25:24, 39.08s/it]Evaluating commonsenseqa :  40%|█████████████████████▍                                | 25/63 [16:19<24:48, 39.17s/it]Evaluating commonsenseqa :  41%|██████████████████████▎                               | 26/63 [16:59<24:08, 39.15s/it]Evaluating commonsenseqa :  43%|███████████████████████▏                              | 27/63 [17:38<23:35, 39.31s/it]Evaluating commonsenseqa :  44%|████████████████████████                              | 28/63 [18:18<22:55, 39.31s/it]Evaluating commonsenseqa :  46%|████████████████████████▊                             | 29/63 [18:57<22:13, 39.22s/it]Evaluating commonsenseqa :  48%|█████████████████████████▋                            | 30/63 [19:36<21:31, 39.14s/it]Evaluating commonsenseqa :  49%|██████████████████████████▌                           | 31/63 [20:15<20:57, 39.28s/it]Evaluating commonsenseqa :  51%|███████████████████████████▍                          | 32/63 [20:55<20:26, 39.57s/it]Evaluating commonsenseqa :  52%|████████████████████████████▎                         | 33/63 [21:35<19:43, 39.46s/it]Evaluating commonsenseqa :  54%|█████████████████████████████▏                        | 34/63 [22:13<18:57, 39.22s/it]Evaluating commonsenseqa :  56%|██████████████████████████████                        | 35/63 [22:52<18:14, 39.08s/it]Evaluating commonsenseqa :  57%|██████████████████████████████▊                       | 36/63 [23:31<17:36, 39.14s/it]Evaluating commonsenseqa :  59%|███████████████████████████████▋                      | 37/63 [24:11<17:01, 39.29s/it]Evaluating commonsenseqa :  60%|████████████████████████████████▌                     | 38/63 [24:51<16:27, 39.48s/it]Evaluating commonsenseqa :  62%|█████████████████████████████████▍                    | 39/63 [25:30<15:47, 39.49s/it]Evaluating commonsenseqa :  63%|██████████████████████████████████▎                   | 40/63 [26:10<15:07, 39.46s/it]Evaluating commonsenseqa :  65%|███████████████████████████████████▏                  | 41/63 [26:49<14:29, 39.50s/it]Evaluating commonsenseqa :  67%|████████████████████████████████████                  | 42/63 [27:29<13:49, 39.49s/it]Evaluating commonsenseqa :  68%|████████████████████████████████████▊                 | 43/63 [28:08<13:08, 39.45s/it]Evaluating commonsenseqa :  70%|█████████████████████████████████████▋                | 44/63 [28:47<12:27, 39.32s/it]Evaluating commonsenseqa :  71%|██████████████████████████████████████▌               | 45/63 [29:26<11:45, 39.20s/it]Evaluating commonsenseqa :  73%|███████████████████████████████████████▍              | 46/63 [30:06<11:10, 39.43s/it]Evaluating commonsenseqa :  75%|████████████████████████████████████████▎             | 47/63 [30:45<10:29, 39.34s/it]Evaluating commonsenseqa :  76%|█████████████████████████████████████████▏            | 48/63 [31:24<09:48, 39.24s/it]Evaluating commonsenseqa :  78%|██████████████████████████████████████████            | 49/63 [32:04<09:11, 39.37s/it]Evaluating commonsenseqa :  79%|██████████████████████████████████████████▊           | 50/63 [32:44<08:32, 39.45s/it]Evaluating commonsenseqa :  81%|███████████████████████████████████████████▋          | 51/63 [33:22<07:50, 39.22s/it]Evaluating commonsenseqa :  83%|████████████████████████████████████████████▌         | 52/63 [34:02<07:12, 39.29s/it]Evaluating commonsenseqa :  84%|█████████████████████████████████████████████▍        | 53/63 [34:41<06:32, 39.25s/it]Evaluating commonsenseqa :  86%|██████████████████████████████████████████████▎       | 54/63 [35:19<05:51, 39.07s/it]Evaluating commonsenseqa :  87%|███████████████████████████████████████████████▏      | 55/63 [35:59<05:14, 39.31s/it]Evaluating commonsenseqa :  89%|████████████████████████████████████████████████      | 56/63 [36:39<04:36, 39.54s/it]Evaluating commonsenseqa :  90%|████████████████████████████████████████████████▊     | 57/63 [37:19<03:57, 39.60s/it]Evaluating commonsenseqa :  92%|█████████████████████████████████████████████████▋    | 58/63 [37:58<03:17, 39.45s/it]Evaluating commonsenseqa :  94%|██████████████████████████████████████████████████▌   | 59/63 [38:38<02:38, 39.62s/it]Evaluating commonsenseqa :  95%|███████████████████████████████████████████████████▍  | 60/63 [39:17<01:58, 39.46s/it]Evaluating commonsenseqa :  97%|████████████████████████████████████████████████████▎ | 61/63 [39:57<01:18, 39.40s/it]Evaluating commonsenseqa :  98%|█████████████████████████████████████████████████████▏| 62/63 [40:36<00:39, 39.39s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████████| 63/63 [41:02<00:00, 35.48s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████████| 63/63 [41:02<00:00, 39.09s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 0.2297} | lm_loss 13.9486 | avg. gen lenth: 447.42
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name gsm8k --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 4 --seed 42 --data-dir /scratch/ylu130/processed_data/commonsenseqa/out-domain/o8-tgsm8k-s42-rTrue --rationales --num-out-domain 8
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
using world size: 4
[nltk_data]   Package punkt is already up-to-date!
[2023-08-08 20:34:58,261] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/out-domain/o8-tgsm8k-s42-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 8
  out_domain_data_name ......... gsm8k
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o8-tgsm8k-s42-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 4
  clip_grad .................... 1.0
  seed ......................... 42
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                        | 0/9741 [00:00<?, ?it/s]  0%|                                                                              | 12/9741 [00:00<01:25, 114.20it/s]  0%|▏                                                                             | 25/9741 [00:00<01:22, 118.22it/s]  0%|▎                                                                             | 38/9741 [00:00<01:20, 121.26it/s]  1%|▍                                                                             | 51/9741 [00:00<01:22, 117.80it/s]  1%|▌                                                                             | 63/9741 [00:00<01:23, 116.46it/s]  1%|▌                                                                             | 75/9741 [00:00<01:29, 107.41it/s]  1%|▋                                                                             | 87/9741 [00:00<01:27, 110.64it/s]  1%|▊                                                                            | 100/9741 [00:00<01:23, 114.84it/s]  1%|▉                                                                            | 112/9741 [00:00<01:24, 113.72it/s]  1%|▉                                                                            | 124/9741 [00:01<01:30, 106.12it/s]  1%|█                                                                             | 135/9741 [00:01<01:36, 99.33it/s]  2%|█▏                                                                           | 147/9741 [00:01<01:33, 102.55it/s]  2%|█▎                                                                           | 159/9741 [00:01<01:29, 107.15it/s]  2%|█▎                                                                           | 170/9741 [00:01<01:29, 107.37it/s]  2%|█▍                                                                           | 181/9741 [00:01<01:32, 103.76it/s]  2%|█▌                                                                            | 192/9741 [00:01<01:39, 96.17it/s]  2%|█▌                                                                            | 202/9741 [00:01<01:39, 95.79it/s]  2%|█▋                                                                           | 215/9741 [00:02<01:30, 104.92it/s]  2%|█▊                                                                           | 228/9741 [00:02<01:26, 110.09it/s]  2%|█▉                                                                           | 240/9741 [00:02<01:27, 108.35it/s]  3%|█▉                                                                           | 251/9741 [00:02<01:28, 107.08it/s]  3%|██                                                                           | 262/9741 [00:02<01:28, 107.32it/s]  3%|██▏                                                                           | 273/9741 [00:02<01:36, 98.07it/s]  3%|██▎                                                                          | 285/9741 [00:02<01:31, 103.10it/s]  3%|██▎                                                                          | 298/9741 [00:02<01:25, 110.42it/s]  3%|██▍                                                                          | 311/9741 [00:02<01:23, 113.53it/s]  3%|██▌                                                                          | 323/9741 [00:02<01:23, 113.41it/s]  3%|██▋                                                                          | 336/9741 [00:03<01:21, 115.52it/s]  4%|██▊                                                                          | 348/9741 [00:03<01:21, 115.43it/s]  4%|██▊                                                                          | 361/9741 [00:03<01:20, 115.89it/s]  4%|██▉                                                                          | 373/9741 [00:03<01:23, 111.93it/s]  4%|███                                                                          | 385/9741 [00:03<01:26, 108.06it/s]  4%|███▏                                                                         | 396/9741 [00:03<01:27, 107.11it/s]  4%|███▎                                                                          | 407/9741 [00:03<01:36, 96.87it/s]  4%|███▎                                                                         | 420/9741 [00:03<01:29, 104.53it/s]  4%|███▍                                                                         | 431/9741 [00:04<01:32, 100.22it/s]  5%|███▌                                                                          | 442/9741 [00:04<01:35, 97.16it/s]  5%|███▌                                                                          | 452/9741 [00:04<01:41, 91.71it/s]  5%|███▋                                                                          | 465/9741 [00:04<01:33, 99.60it/s]  5%|███▊                                                                         | 478/9741 [00:04<01:27, 106.18it/s]  5%|███▊                                                                         | 489/9741 [00:04<01:27, 105.89it/s]  5%|███▉                                                                         | 502/9741 [00:04<01:23, 110.38it/s]  5%|████                                                                         | 514/9741 [00:04<01:25, 107.81it/s]  5%|████▏                                                                        | 526/9741 [00:04<01:23, 109.94it/s]  6%|████▎                                                                        | 538/9741 [00:05<01:21, 112.31it/s]  6%|████▎                                                                        | 550/9741 [00:05<01:21, 112.74it/s]  6%|████▍                                                                        | 562/9741 [00:05<01:23, 110.06it/s]  6%|████▌                                                                        | 574/9741 [00:05<01:24, 108.40it/s]  6%|████▋                                                                        | 586/9741 [00:05<01:22, 110.44it/s]  6%|████▋                                                                        | 599/9741 [00:05<01:20, 113.50it/s]  6%|████▊                                                                        | 612/9741 [00:05<01:18, 116.98it/s]  6%|████▉                                                                        | 624/9741 [00:05<01:22, 110.86it/s]  7%|█████                                                                        | 636/9741 [00:05<01:24, 107.47it/s]  7%|█████                                                                        | 647/9741 [00:06<01:25, 106.89it/s]  7%|█████▏                                                                       | 658/9741 [00:06<01:24, 106.97it/s]  7%|█████▎                                                                       | 671/9741 [00:06<01:21, 110.79it/s]  7%|█████▍                                                                       | 684/9741 [00:06<01:19, 114.01it/s]  7%|█████▌                                                                       | 696/9741 [00:06<01:29, 101.18it/s]  7%|█████▋                                                                        | 707/9741 [00:06<01:31, 98.68it/s]  7%|█████▋                                                                       | 720/9741 [00:06<01:26, 104.67it/s]  8%|█████▊                                                                       | 732/9741 [00:06<01:24, 107.18it/s]  8%|█████▉                                                                       | 745/9741 [00:06<01:21, 110.72it/s]  8%|█████▉                                                                       | 757/9741 [00:07<01:23, 108.02it/s]  8%|██████                                                                       | 770/9741 [00:07<01:20, 111.65it/s]  8%|██████▏                                                                      | 783/9741 [00:07<01:18, 114.74it/s]  8%|██████▎                                                                      | 795/9741 [00:07<01:17, 116.08it/s]  8%|██████▍                                                                      | 808/9741 [00:07<01:15, 118.74it/s]  8%|██████▍                                                                      | 820/9741 [00:07<01:15, 117.68it/s]  9%|██████▌                                                                      | 832/9741 [00:07<01:15, 117.83it/s]  9%|██████▋                                                                      | 844/9741 [00:07<01:19, 111.59it/s]  9%|██████▊                                                                      | 857/9741 [00:07<01:17, 115.34it/s]  9%|██████▊                                                                      | 869/9741 [00:08<01:27, 101.79it/s]  9%|██████▉                                                                      | 880/9741 [00:08<01:26, 102.59it/s]  9%|███████                                                                      | 892/9741 [00:08<01:22, 107.22it/s]  9%|███████▏                                                                     | 904/9741 [00:08<01:21, 108.27it/s]  9%|███████▏                                                                     | 915/9741 [00:08<01:22, 107.31it/s] 10%|███████▍                                                                      | 926/9741 [00:08<01:33, 94.67it/s] 10%|███████▍                                                                     | 938/9741 [00:08<01:27, 100.13it/s] 10%|███████▌                                                                     | 950/9741 [00:08<01:25, 102.85it/s] 10%|███████▌                                                                     | 962/9741 [00:08<01:22, 106.59it/s] 10%|███████▋                                                                     | 975/9741 [00:09<01:19, 109.62it/s] 10%|███████▊                                                                     | 987/9741 [00:09<01:20, 108.25it/s] 10%|███████▉                                                                     | 999/9741 [00:09<01:20, 109.24it/s] 10%|███████▉                                                                    | 1011/9741 [00:09<01:18, 110.52it/s] 11%|███████▉                                                                    | 1024/9741 [00:09<01:16, 113.97it/s] 11%|████████                                                                    | 1036/9741 [00:09<01:17, 112.44it/s] 11%|████████▏                                                                   | 1049/9741 [00:09<01:14, 116.17it/s] 11%|████████▎                                                                   | 1061/9741 [00:09<01:15, 115.15it/s] 11%|████████▎                                                                   | 1073/9741 [00:09<01:19, 109.41it/s] 11%|████████▍                                                                   | 1086/9741 [00:10<01:15, 114.83it/s] 11%|████████▌                                                                   | 1099/9741 [00:10<01:12, 119.00it/s] 11%|████████▋                                                                   | 1111/9741 [00:10<01:12, 118.26it/s] 12%|████████▊                                                                   | 1124/9741 [00:10<01:12, 119.62it/s] 12%|████████▊                                                                   | 1137/9741 [00:10<01:16, 112.53it/s] 12%|████████▉                                                                   | 1149/9741 [00:10<01:16, 112.93it/s] 12%|█████████                                                                   | 1162/9741 [00:10<01:13, 116.94it/s] 12%|█████████▏                                                                  | 1174/9741 [00:10<01:14, 115.71it/s] 12%|█████████▎                                                                  | 1186/9741 [00:10<01:16, 112.56it/s] 12%|█████████▎                                                                  | 1198/9741 [00:11<01:22, 102.95it/s] 12%|█████████▍                                                                  | 1210/9741 [00:11<01:20, 106.59it/s] 13%|█████████▋                                                                   | 1221/9741 [00:11<01:28, 96.50it/s] 13%|█████████▋                                                                   | 1231/9741 [00:11<01:30, 94.45it/s] 13%|█████████▊                                                                   | 1241/9741 [00:11<01:35, 88.88it/s] 13%|█████████▉                                                                   | 1253/9741 [00:11<01:29, 94.71it/s] 13%|█████████▉                                                                  | 1266/9741 [00:11<01:22, 102.53it/s] 13%|██████████                                                                  | 1282/9741 [00:11<01:11, 117.69it/s] 13%|██████████                                                                  | 1296/9741 [00:11<01:09, 121.77it/s] 13%|██████████▏                                                                 | 1309/9741 [00:12<01:10, 120.16it/s] 14%|██████████▎                                                                 | 1322/9741 [00:12<01:15, 111.55it/s] 14%|██████████▍                                                                 | 1334/9741 [00:12<01:17, 108.37it/s] 14%|██████████▍                                                                 | 1345/9741 [00:12<01:18, 106.67it/s] 14%|██████████▌                                                                 | 1356/9741 [00:12<01:19, 105.58it/s] 14%|██████████▋                                                                 | 1367/9741 [00:12<01:18, 106.49it/s] 14%|██████████▊                                                                 | 1378/9741 [00:12<01:18, 107.06it/s] 14%|██████████▊                                                                 | 1389/9741 [00:12<01:19, 105.54it/s] 14%|██████████▉                                                                 | 1400/9741 [00:12<01:19, 104.83it/s] 15%|███████████                                                                 | 1413/9741 [00:13<01:16, 109.17it/s] 15%|███████████                                                                 | 1424/9741 [00:13<01:17, 107.73it/s] 15%|███████████▏                                                                | 1436/9741 [00:13<01:15, 110.65it/s] 15%|███████████▎                                                                | 1448/9741 [00:13<01:17, 107.11it/s] 15%|███████████▍                                                                | 1459/9741 [00:13<01:21, 101.21it/s] 15%|███████████▍                                                                | 1470/9741 [00:13<01:19, 103.40it/s] 15%|███████████▌                                                                | 1483/9741 [00:13<01:15, 109.76it/s] 15%|███████████▋                                                                | 1496/9741 [00:13<01:13, 112.88it/s] 15%|███████████▊                                                                | 1508/9741 [00:13<01:19, 103.03it/s] 16%|███████████▊                                                                | 1520/9741 [00:14<01:17, 105.58it/s] 16%|████████████                                                                 | 1531/9741 [00:14<01:23, 98.20it/s] 16%|████████████                                                                | 1543/9741 [00:14<01:19, 103.63it/s] 16%|████████████▏                                                               | 1555/9741 [00:14<01:17, 105.59it/s] 16%|████████████▏                                                               | 1566/9741 [00:14<01:20, 100.95it/s] 16%|████████████▍                                                                | 1577/9741 [00:14<01:26, 94.47it/s] 16%|████████████▍                                                               | 1590/9741 [00:14<01:19, 102.25it/s] 16%|████████████▌                                                               | 1603/9741 [00:14<01:14, 108.83it/s] 17%|████████████▌                                                               | 1615/9741 [00:14<01:15, 107.01it/s] 17%|████████████▋                                                               | 1626/9741 [00:15<01:16, 105.41it/s] 17%|████████████▉                                                                | 1637/9741 [00:15<01:24, 95.61it/s] 17%|████████████▊                                                               | 1650/9741 [00:15<01:17, 104.26it/s] 17%|████████████▉                                                               | 1663/9741 [00:15<01:13, 109.39it/s] 17%|█████████████                                                               | 1676/9741 [00:15<01:11, 112.51it/s] 17%|█████████████▏                                                              | 1688/9741 [00:15<01:18, 102.45it/s] 17%|█████████████▎                                                              | 1703/9741 [00:15<01:10, 113.66it/s] 18%|█████████████▍                                                              | 1719/9741 [00:15<01:04, 124.15it/s] 18%|█████████████▌                                                              | 1737/9741 [00:15<00:57, 138.59it/s] 18%|█████████████▋                                                              | 1753/9741 [00:16<00:55, 143.72it/s] 18%|█████████████▊                                                              | 1768/9741 [00:16<00:56, 141.35it/s] 18%|█████████████▉                                                              | 1783/9741 [00:16<01:03, 124.35it/s] 18%|██████████████                                                              | 1796/9741 [00:16<01:10, 113.45it/s] 19%|██████████████▏                                                             | 1815/9741 [00:16<01:00, 131.36it/s] 19%|██████████████▎                                                             | 1830/9741 [00:16<00:58, 136.18it/s] 19%|██████████████▍                                                             | 1845/9741 [00:16<00:58, 133.97it/s] 19%|██████████████▌                                                             | 1859/9741 [00:16<01:01, 128.80it/s] 19%|██████████████▌                                                             | 1874/9741 [00:17<00:59, 132.89it/s] 19%|██████████████▋                                                             | 1890/9741 [00:17<00:56, 139.85it/s] 20%|██████████████▊                                                             | 1905/9741 [00:17<00:55, 140.18it/s] 20%|██████████████▉                                                             | 1920/9741 [00:17<00:55, 140.53it/s] 20%|███████████████                                                             | 1935/9741 [00:17<00:56, 138.34it/s] 20%|███████████████▏                                                            | 1949/9741 [00:17<00:57, 135.22it/s] 20%|███████████████▎                                                            | 1963/9741 [00:17<00:57, 136.13it/s] 20%|███████████████▍                                                            | 1977/9741 [00:17<01:07, 114.69it/s] 20%|███████████████▌                                                            | 1991/9741 [00:17<01:04, 119.60it/s] 21%|███████████████▋                                                            | 2004/9741 [00:18<01:09, 110.61it/s] 21%|███████████████▋                                                            | 2016/9741 [00:18<01:13, 105.37it/s] 21%|███████████████▊                                                            | 2029/9741 [00:18<01:10, 109.28it/s] 21%|███████████████▉                                                            | 2041/9741 [00:18<01:11, 107.81it/s] 21%|████████████████                                                            | 2052/9741 [00:18<01:12, 106.73it/s] 21%|████████████████▎                                                            | 2063/9741 [00:18<01:21, 94.38it/s] 21%|████████████████▍                                                            | 2073/9741 [00:18<01:22, 92.64it/s] 21%|████████████████▍                                                            | 2083/9741 [00:18<01:22, 92.84it/s] 22%|████████████████▌                                                            | 2095/9741 [00:19<01:18, 97.67it/s] 22%|████████████████▋                                                            | 2106/9741 [00:19<01:17, 98.33it/s] 22%|████████████████▌                                                           | 2118/9741 [00:19<01:14, 102.72it/s] 22%|████████████████▋                                                           | 2131/9741 [00:19<01:10, 108.02it/s] 22%|████████████████▋                                                           | 2143/9741 [00:19<01:09, 109.12it/s] 22%|████████████████▊                                                           | 2155/9741 [00:19<01:08, 111.30it/s] 22%|████████████████▉                                                           | 2167/9741 [00:19<01:12, 104.60it/s] 22%|████████████████▉                                                           | 2178/9741 [00:19<01:12, 104.51it/s] 22%|█████████████████                                                           | 2191/9741 [00:19<01:09, 109.24it/s] 23%|█████████████████▏                                                          | 2203/9741 [00:20<01:08, 109.51it/s] 23%|█████████████████▎                                                          | 2216/9741 [00:20<01:06, 113.52it/s] 23%|█████████████████▍                                                          | 2229/9741 [00:20<01:06, 113.52it/s] 23%|█████████████████▍                                                          | 2241/9741 [00:20<01:07, 111.45it/s] 23%|█████████████████▌                                                          | 2253/9741 [00:20<01:07, 110.96it/s] 23%|█████████████████▋                                                          | 2265/9741 [00:20<01:08, 109.52it/s] 23%|█████████████████▊                                                          | 2278/9741 [00:20<01:05, 114.33it/s] 24%|█████████████████▊                                                          | 2291/9741 [00:20<01:04, 116.39it/s] 24%|█████████████████▉                                                          | 2303/9741 [00:20<01:05, 114.28it/s] 24%|██████████████████                                                          | 2315/9741 [00:21<01:08, 109.20it/s] 24%|██████████████████▏                                                         | 2326/9741 [00:21<01:08, 108.18it/s] 24%|██████████████████▏                                                         | 2337/9741 [00:21<01:13, 101.26it/s] 24%|██████████████████▌                                                          | 2348/9741 [00:21<01:16, 96.02it/s] 24%|██████████████████▍                                                         | 2360/9741 [00:21<01:12, 101.86it/s] 24%|██████████████████▋                                                          | 2371/9741 [00:21<01:16, 96.70it/s] 24%|██████████████████▊                                                          | 2381/9741 [00:21<01:18, 93.96it/s] 25%|██████████████████▋                                                         | 2394/9741 [00:21<01:12, 101.91it/s] 25%|██████████████████▊                                                         | 2405/9741 [00:21<01:10, 103.48it/s] 25%|███████████████████                                                          | 2416/9741 [00:22<01:15, 96.43it/s] 25%|███████████████████▏                                                         | 2426/9741 [00:22<01:16, 95.06it/s] 25%|███████████████████                                                         | 2438/9741 [00:22<01:12, 101.32it/s] 25%|███████████████████                                                         | 2450/9741 [00:22<01:08, 105.81it/s] 25%|███████████████████▏                                                        | 2461/9741 [00:22<01:09, 104.81it/s] 25%|███████████████████▎                                                        | 2472/9741 [00:22<01:09, 104.34it/s] 25%|███████████████████▎                                                        | 2483/9741 [00:22<01:09, 104.79it/s] 26%|███████████████████▋                                                         | 2494/9741 [00:22<01:13, 98.04it/s] 26%|███████████████████▌                                                        | 2505/9741 [00:22<01:12, 100.03it/s] 26%|███████████████████▋                                                        | 2521/9741 [00:23<01:02, 115.01it/s] 26%|███████████████████▊                                                        | 2533/9741 [00:23<01:01, 116.34it/s] 26%|███████████████████▊                                                        | 2547/9741 [00:23<01:00, 119.37it/s] 26%|███████████████████▉                                                        | 2559/9741 [00:23<01:03, 112.40it/s] 26%|████████████████████                                                        | 2574/9741 [00:23<00:59, 121.25it/s] 27%|████████████████████▏                                                       | 2590/9741 [00:23<00:54, 130.35it/s] 27%|████████████████████▎                                                       | 2604/9741 [00:23<00:55, 128.82it/s] 27%|████████████████████▍                                                       | 2619/9741 [00:23<00:53, 133.30it/s] 27%|████████████████████▌                                                       | 2634/9741 [00:23<00:52, 136.05it/s] 27%|████████████████████▋                                                       | 2648/9741 [00:24<00:54, 129.56it/s] 27%|████████████████████▊                                                       | 2662/9741 [00:24<00:59, 119.88it/s] 27%|████████████████████▉                                                       | 2677/9741 [00:24<00:55, 126.54it/s] 28%|█████████████████████                                                       | 2692/9741 [00:24<00:53, 130.71it/s] 28%|█████████████████████                                                       | 2706/9741 [00:24<00:53, 132.36it/s] 28%|█████████████████████▏                                                      | 2720/9741 [00:24<00:52, 133.97it/s] 28%|█████████████████████▎                                                      | 2736/9741 [00:24<00:50, 139.56it/s] 28%|█████████████████████▍                                                      | 2753/9741 [00:24<00:47, 147.48it/s] 28%|█████████████████████▌                                                      | 2768/9741 [00:24<00:47, 145.76it/s] 29%|█████████████████████▋                                                      | 2783/9741 [00:25<00:55, 125.80it/s] 29%|█████████████████████▊                                                      | 2797/9741 [00:25<00:56, 122.42it/s] 29%|█████████████████████▉                                                      | 2812/9741 [00:25<00:53, 128.55it/s] 29%|██████████████████████                                                      | 2826/9741 [00:25<00:53, 130.27it/s] 29%|██████████████████████▏                                                     | 2841/9741 [00:25<00:51, 134.45it/s] 29%|██████████████████████▎                                                     | 2856/9741 [00:25<00:50, 136.91it/s] 29%|██████████████████████▍                                                     | 2870/9741 [00:25<00:50, 136.24it/s] 30%|██████████████████████▌                                                     | 2886/9741 [00:25<00:48, 141.22it/s] 30%|██████████████████████▋                                                     | 2901/9741 [00:25<00:49, 138.84it/s] 30%|██████████████████████▊                                                     | 2916/9741 [00:26<00:49, 137.26it/s] 30%|██████████████████████▊                                                     | 2930/9741 [00:26<01:02, 108.50it/s] 30%|██████████████████████▉                                                     | 2942/9741 [00:26<01:01, 109.73it/s] 30%|███████████████████████                                                     | 2954/9741 [00:26<01:00, 111.33it/s] 30%|███████████████████████▏                                                    | 2966/9741 [00:26<01:00, 112.87it/s] 31%|███████████████████████▏                                                    | 2979/9741 [00:26<00:58, 115.13it/s] 31%|███████████████████████▎                                                    | 2991/9741 [00:26<00:58, 115.52it/s] 31%|███████████████████████▍                                                    | 3003/9741 [00:26<01:01, 109.79it/s] 31%|███████████████████████▌                                                    | 3015/9741 [00:26<01:06, 101.34it/s] 31%|███████████████████████▌                                                    | 3028/9741 [00:27<01:03, 105.69it/s] 31%|███████████████████████▋                                                    | 3039/9741 [00:27<01:04, 104.20it/s] 31%|████████████████████████                                                     | 3050/9741 [00:27<01:07, 99.55it/s] 31%|████████████████████████▏                                                    | 3061/9741 [00:27<01:13, 90.89it/s] 32%|████████████████████████▎                                                    | 3073/9741 [00:27<01:08, 97.52it/s] 32%|████████████████████████                                                    | 3085/9741 [00:27<01:04, 102.44it/s] 32%|████████████████████████▏                                                   | 3097/9741 [00:27<01:02, 105.68it/s] 32%|████████████████████████▎                                                   | 3110/9741 [00:27<01:00, 110.30it/s] 32%|████████████████████████▎                                                   | 3122/9741 [00:28<01:01, 107.44it/s] 32%|████████████████████████▍                                                   | 3134/9741 [00:28<01:00, 109.52it/s] 32%|████████████████████████▌                                                   | 3146/9741 [00:28<00:59, 110.03it/s] 32%|████████████████████████▋                                                   | 3159/9741 [00:28<00:58, 113.43it/s] 33%|████████████████████████▋                                                   | 3171/9741 [00:28<00:57, 114.84it/s] 33%|████████████████████████▊                                                   | 3183/9741 [00:28<00:58, 112.45it/s] 33%|████████████████████████▉                                                   | 3195/9741 [00:28<00:59, 109.50it/s] 33%|█████████████████████████                                                   | 3208/9741 [00:28<00:57, 113.28it/s] 33%|█████████████████████████▏                                                  | 3221/9741 [00:28<00:55, 117.78it/s] 33%|█████████████████████████▏                                                  | 3234/9741 [00:28<00:54, 118.89it/s] 33%|█████████████████████████▎                                                  | 3246/9741 [00:29<00:56, 114.65it/s] 33%|█████████████████████████▍                                                  | 3258/9741 [00:29<00:58, 111.31it/s] 34%|█████████████████████████▌                                                  | 3270/9741 [00:29<00:57, 113.32it/s] 34%|█████████████████████████▌                                                  | 3282/9741 [00:29<00:56, 113.61it/s] 34%|█████████████████████████▋                                                  | 3294/9741 [00:29<00:58, 110.89it/s] 34%|█████████████████████████▊                                                  | 3306/9741 [00:29<00:57, 112.15it/s] 34%|█████████████████████████▉                                                  | 3318/9741 [00:29<00:57, 111.40it/s] 34%|█████████████████████████▉                                                  | 3330/9741 [00:29<00:57, 110.79it/s] 34%|██████████████████████████▍                                                  | 3342/9741 [00:30<01:04, 99.21it/s] 34%|██████████████████████████▌                                                  | 3353/9741 [00:30<01:09, 92.48it/s] 35%|██████████████████████████▌                                                  | 3363/9741 [00:30<01:14, 86.09it/s] 35%|██████████████████████████▋                                                  | 3372/9741 [00:30<01:16, 82.78it/s] 35%|██████████████████████████▋                                                  | 3381/9741 [00:30<01:18, 81.38it/s] 35%|██████████████████████████▊                                                  | 3392/9741 [00:30<01:12, 88.04it/s] 35%|██████████████████████████▉                                                  | 3404/9741 [00:30<01:06, 95.77it/s] 35%|██████████████████████████▉                                                  | 3415/9741 [00:30<01:03, 99.60it/s] 35%|███████████████████████████                                                  | 3426/9741 [00:30<01:05, 96.00it/s] 35%|██████████████████████████▊                                                 | 3438/9741 [00:31<01:01, 102.01it/s] 35%|██████████████████████████▉                                                 | 3449/9741 [00:31<01:01, 102.74it/s] 36%|███████████████████████████▎                                                 | 3460/9741 [00:31<01:04, 97.38it/s] 36%|███████████████████████████▍                                                 | 3470/9741 [00:31<01:05, 95.53it/s] 36%|███████████████████████████▏                                                | 3482/9741 [00:31<01:02, 100.60it/s] 36%|███████████████████████████▎                                                | 3494/9741 [00:31<01:00, 103.26it/s] 36%|███████████████████████████▎                                                | 3505/9741 [00:31<00:59, 104.44it/s] 36%|███████████████████████████▍                                                | 3517/9741 [00:31<00:58, 106.52it/s] 36%|███████████████████████████▌                                                | 3528/9741 [00:31<00:58, 106.73it/s] 36%|███████████████████████████▌                                                | 3539/9741 [00:32<00:58, 105.81it/s] 36%|███████████████████████████▋                                                | 3552/9741 [00:32<00:56, 110.29it/s] 37%|███████████████████████████▊                                                | 3564/9741 [00:32<00:55, 111.24it/s] 37%|███████████████████████████▉                                                | 3576/9741 [00:32<00:57, 107.68it/s] 37%|███████████████████████████▉                                                | 3588/9741 [00:32<00:55, 110.00it/s] 37%|████████████████████████████                                                | 3600/9741 [00:32<00:58, 104.43it/s] 37%|████████████████████████████▌                                                | 3611/9741 [00:32<01:04, 94.90it/s] 37%|████████████████████████████▎                                               | 3623/9741 [00:32<01:00, 101.17it/s] 37%|████████████████████████████▎                                               | 3635/9741 [00:32<00:57, 105.63it/s] 37%|████████████████████████████▍                                               | 3646/9741 [00:33<00:57, 106.65it/s] 38%|████████████████████████████▌                                               | 3658/9741 [00:33<00:56, 108.56it/s] 38%|████████████████████████████▋                                               | 3670/9741 [00:33<00:54, 110.39it/s] 38%|████████████████████████████▋                                               | 3682/9741 [00:33<00:56, 107.72it/s] 38%|████████████████████████████▊                                               | 3694/9741 [00:33<00:54, 110.90it/s] 38%|████████████████████████████▉                                               | 3706/9741 [00:33<00:54, 111.33it/s] 38%|█████████████████████████████                                               | 3719/9741 [00:33<00:52, 115.15it/s] 38%|█████████████████████████████                                               | 3731/9741 [00:33<00:52, 113.47it/s] 38%|█████████████████████████████▏                                              | 3743/9741 [00:33<00:53, 113.12it/s] 39%|█████████████████████████████▎                                              | 3755/9741 [00:34<00:54, 110.80it/s] 39%|█████████████████████████████▍                                              | 3768/9741 [00:34<00:52, 113.74it/s] 39%|█████████████████████████████▍                                              | 3780/9741 [00:34<00:52, 113.62it/s] 39%|█████████████████████████████▌                                              | 3792/9741 [00:34<00:52, 113.97it/s] 39%|█████████████████████████████▋                                              | 3804/9741 [00:34<00:54, 109.82it/s] 39%|█████████████████████████████▊                                              | 3816/9741 [00:34<00:58, 100.71it/s] 39%|█████████████████████████████▊                                              | 3828/9741 [00:34<00:56, 104.08it/s] 39%|█████████████████████████████▉                                              | 3839/9741 [00:34<00:57, 102.83it/s] 40%|██████████████████████████████                                              | 3850/9741 [00:34<00:56, 104.01it/s] 40%|██████████████████████████████▏                                             | 3862/9741 [00:35<00:54, 108.28it/s] 40%|██████████████████████████████▏                                             | 3873/9741 [00:35<00:54, 108.57it/s] 40%|██████████████████████████████▎                                             | 3886/9741 [00:35<00:51, 113.00it/s] 40%|██████████████████████████████▍                                             | 3898/9741 [00:35<00:53, 108.95it/s] 40%|██████████████████████████████▌                                             | 3910/9741 [00:35<00:52, 111.36it/s] 40%|██████████████████████████████▌                                             | 3922/9741 [00:35<00:52, 111.17it/s] 40%|██████████████████████████████▋                                             | 3934/9741 [00:35<00:55, 105.47it/s] 40%|███████████████████████████████▏                                             | 3945/9741 [00:35<00:58, 99.93it/s] 41%|███████████████████████████████▎                                             | 3956/9741 [00:35<00:59, 97.94it/s] 41%|██████████████████████████████▉                                             | 3967/9741 [00:36<00:57, 100.16it/s] 41%|███████████████████████████████                                             | 3979/9741 [00:36<00:55, 104.29it/s] 41%|███████████████████████████████▏                                            | 3990/9741 [00:36<00:56, 102.58it/s] 41%|███████████████████████████████▏                                            | 4003/9741 [00:36<00:53, 107.84it/s] 41%|███████████████████████████████▎                                            | 4016/9741 [00:36<00:50, 113.15it/s] 41%|███████████████████████████████▍                                            | 4028/9741 [00:36<00:52, 108.05it/s] 41%|███████████████████████████████▌                                            | 4040/9741 [00:36<00:51, 110.84it/s] 42%|███████████████████████████████▌                                            | 4052/9741 [00:36<00:50, 113.04it/s] 42%|███████████████████████████████▋                                            | 4064/9741 [00:36<00:50, 111.52it/s] 42%|███████████████████████████████▊                                            | 4076/9741 [00:36<00:49, 113.58it/s] 42%|███████████████████████████████▉                                            | 4088/9741 [00:37<00:49, 113.46it/s] 42%|███████████████████████████████▉                                            | 4100/9741 [00:37<00:53, 105.55it/s] 42%|████████████████████████████████                                            | 4113/9741 [00:37<00:50, 111.26it/s] 42%|████████████████████████████████▏                                           | 4126/9741 [00:37<00:48, 115.10it/s] 42%|████████████████████████████████▎                                           | 4138/9741 [00:37<00:48, 116.35it/s] 43%|████████████████████████████████▍                                           | 4150/9741 [00:37<00:48, 116.23it/s] 43%|████████████████████████████████▍                                           | 4162/9741 [00:37<00:49, 113.63it/s] 43%|████████████████████████████████▌                                           | 4174/9741 [00:37<00:50, 110.68it/s] 43%|████████████████████████████████▋                                           | 4186/9741 [00:37<00:51, 108.85it/s] 43%|████████████████████████████████▋                                           | 4197/9741 [00:38<00:51, 107.56it/s] 43%|████████████████████████████████▊                                           | 4208/9741 [00:38<00:51, 106.73it/s] 43%|████████████████████████████████▉                                           | 4219/9741 [00:38<00:52, 105.09it/s] 43%|█████████████████████████████████                                           | 4230/9741 [00:38<00:52, 104.55it/s] 44%|█████████████████████████████████                                           | 4241/9741 [00:38<00:52, 104.98it/s] 44%|█████████████████████████████████▏                                          | 4252/9741 [00:38<00:52, 104.70it/s] 44%|█████████████████████████████████▎                                          | 4263/9741 [00:38<00:52, 105.09it/s] 44%|█████████████████████████████████▎                                          | 4274/9741 [00:38<00:51, 105.31it/s] 44%|█████████████████████████████████▍                                          | 4285/9741 [00:38<00:51, 105.18it/s] 44%|█████████████████████████████████▌                                          | 4296/9741 [00:39<00:51, 105.59it/s] 44%|█████████████████████████████████▌                                          | 4308/9741 [00:39<00:50, 107.86it/s] 44%|█████████████████████████████████▋                                          | 4319/9741 [00:39<00:50, 106.71it/s] 44%|██████████████████████████████████▏                                          | 4330/9741 [00:39<00:56, 95.28it/s] 45%|██████████████████████████████████▎                                          | 4340/9741 [00:39<00:56, 95.89it/s] 45%|██████████████████████████████████▍                                          | 4350/9741 [00:39<00:55, 96.79it/s] 45%|██████████████████████████████████▍                                          | 4361/9741 [00:39<00:55, 97.73it/s] 45%|██████████████████████████████████                                          | 4373/9741 [00:39<00:52, 103.00it/s] 45%|██████████████████████████████████▏                                         | 4386/9741 [00:39<00:49, 108.38it/s] 45%|██████████████████████████████████▎                                         | 4398/9741 [00:40<00:48, 109.92it/s] 45%|██████████████████████████████████▍                                         | 4410/9741 [00:40<00:47, 111.17it/s] 45%|██████████████████████████████████▌                                         | 4423/9741 [00:40<00:46, 115.43it/s] 46%|██████████████████████████████████▌                                         | 4435/9741 [00:40<00:46, 113.42it/s] 46%|██████████████████████████████████▋                                         | 4447/9741 [00:40<00:46, 114.85it/s] 46%|██████████████████████████████████▊                                         | 4460/9741 [00:40<00:44, 117.37it/s] 46%|██████████████████████████████████▉                                         | 4472/9741 [00:40<00:45, 114.80it/s] 46%|██████████████████████████████████▉                                         | 4485/9741 [00:40<00:44, 118.05it/s] 46%|███████████████████████████████████                                         | 4497/9741 [00:40<00:45, 115.41it/s] 46%|███████████████████████████████████▋                                         | 4509/9741 [00:41<01:03, 82.34it/s] 46%|███████████████████████████████████▋                                         | 4520/9741 [00:41<00:59, 87.10it/s] 47%|███████████████████████████████████▊                                         | 4530/9741 [00:41<01:02, 82.88it/s] 47%|███████████████████████████████████▉                                         | 4542/9741 [00:41<00:57, 90.11it/s] 47%|████████████████████████████████████                                         | 4555/9741 [00:41<00:52, 98.89it/s] 47%|███████████████████████████████████▌                                        | 4566/9741 [00:41<00:51, 101.39it/s] 47%|███████████████████████████████████▋                                        | 4577/9741 [00:41<00:51, 100.68it/s] 47%|███████████████████████████████████▊                                        | 4589/9741 [00:41<00:48, 105.77it/s] 47%|███████████████████████████████████▉                                        | 4601/9741 [00:41<00:47, 107.99it/s] 47%|███████████████████████████████████▉                                        | 4614/9741 [00:42<00:45, 111.76it/s] 47%|████████████████████████████████████                                        | 4626/9741 [00:42<00:47, 108.73it/s] 48%|████████████████████████████████████▏                                       | 4638/9741 [00:42<00:46, 110.19it/s] 48%|████████████████████████████████████▎                                       | 4650/9741 [00:42<00:46, 109.58it/s] 48%|████████████████████████████████████▎                                       | 4662/9741 [00:42<00:45, 111.32it/s] 48%|████████████████████████████████████▍                                       | 4675/9741 [00:42<00:44, 114.15it/s] 48%|████████████████████████████████████▌                                       | 4687/9741 [00:42<00:46, 109.84it/s] 48%|████████████████████████████████████▋                                       | 4699/9741 [00:42<00:45, 111.32it/s] 48%|████████████████████████████████████▊                                       | 4711/9741 [00:42<00:45, 111.55it/s] 48%|████████████████████████████████████▊                                       | 4723/9741 [00:43<00:44, 113.84it/s] 49%|█████████████████████████████████████▍                                       | 4735/9741 [00:43<01:14, 67.10it/s] 49%|█████████████████████████████████████▌                                       | 4747/9741 [00:43<01:05, 76.65it/s] 49%|█████████████████████████████████████▌                                       | 4759/9741 [00:43<00:58, 85.78it/s] 49%|█████████████████████████████████████▋                                       | 4772/9741 [00:43<00:52, 94.43it/s] 49%|█████████████████████████████████████▊                                       | 4784/9741 [00:43<00:49, 99.96it/s] 49%|█████████████████████████████████████▍                                      | 4796/9741 [00:43<00:47, 104.04it/s] 49%|█████████████████████████████████████▌                                      | 4808/9741 [00:44<00:46, 105.86it/s] 49%|█████████████████████████████████████▌                                      | 4820/9741 [00:44<00:45, 107.43it/s] 50%|█████████████████████████████████████▋                                      | 4834/9741 [00:44<00:42, 114.29it/s] 50%|█████████████████████████████████████▊                                      | 4847/9741 [00:44<00:41, 117.44it/s] 50%|█████████████████████████████████████▉                                      | 4860/9741 [00:44<00:40, 119.18it/s] 50%|██████████████████████████████████████                                      | 4873/9741 [00:44<00:42, 114.31it/s] 50%|██████████████████████████████████████                                      | 4885/9741 [00:44<00:43, 111.19it/s] 50%|██████████████████████████████████████▏                                     | 4898/9741 [00:44<00:42, 114.15it/s] 50%|██████████████████████████████████████▎                                     | 4910/9741 [00:44<00:41, 115.74it/s] 51%|██████████████████████████████████████▍                                     | 4923/9741 [00:45<00:40, 118.66it/s] 51%|██████████████████████████████████████▌                                     | 4935/9741 [00:45<00:42, 114.28it/s] 51%|██████████████████████████████████████▌                                     | 4947/9741 [00:45<00:43, 109.75it/s] 51%|██████████████████████████████████████▋                                     | 4959/9741 [00:45<00:42, 111.56it/s] 51%|██████████████████████████████████████▊                                     | 4971/9741 [00:45<00:42, 112.45it/s] 51%|██████████████████████████████████████▉                                     | 4984/9741 [00:45<00:40, 116.66it/s] 51%|██████████████████████████████████████▉                                     | 4996/9741 [00:45<00:40, 117.22it/s] 51%|███████████████████████████████████████                                     | 5010/9741 [00:45<00:39, 120.75it/s] 52%|███████████████████████████████████████▏                                    | 5023/9741 [00:45<00:39, 119.74it/s] 52%|███████████████████████████████████████▎                                    | 5036/9741 [00:46<00:39, 119.96it/s] 52%|███████████████████████████████████████▍                                    | 5049/9741 [00:46<00:39, 119.73it/s] 52%|███████████████████████████████████████▍                                    | 5061/9741 [00:46<00:40, 116.90it/s] 52%|███████████████████████████████████████▌                                    | 5074/9741 [00:46<00:39, 118.02it/s] 52%|███████████████████████████████████████▋                                    | 5086/9741 [00:46<00:41, 111.53it/s] 52%|███████████████████████████████████████▊                                    | 5099/9741 [00:46<00:40, 115.28it/s] 52%|███████████████████████████████████████▉                                    | 5111/9741 [00:46<00:39, 116.13it/s] 53%|███████████████████████████████████████▉                                    | 5123/9741 [00:46<00:39, 116.00it/s] 53%|████████████████████████████████████████                                    | 5135/9741 [00:46<00:42, 108.78it/s] 53%|████████████████████████████████████████▏                                   | 5146/9741 [00:47<00:44, 104.16it/s] 53%|████████████████████████████████████████▏                                   | 5158/9741 [00:47<00:42, 107.58it/s] 53%|████████████████████████████████████████▎                                   | 5170/9741 [00:47<00:41, 110.64it/s] 53%|████████████████████████████████████████▍                                   | 5183/9741 [00:47<00:39, 114.17it/s] 53%|████████████████████████████████████████▌                                   | 5196/9741 [00:47<00:39, 116.22it/s] 53%|████████████████████████████████████████▋                                   | 5208/9741 [00:47<00:39, 114.63it/s] 54%|████████████████████████████████████████▋                                   | 5220/9741 [00:47<00:40, 110.97it/s] 54%|████████████████████████████████████████▊                                   | 5232/9741 [00:47<00:39, 113.37it/s] 54%|████████████████████████████████████████▉                                   | 5244/9741 [00:47<00:39, 114.64it/s] 54%|█████████████████████████████████████████                                   | 5257/9741 [00:47<00:38, 116.73it/s] 54%|█████████████████████████████████████████                                   | 5269/9741 [00:48<00:39, 112.77it/s] 54%|█████████████████████████████████████████▏                                  | 5281/9741 [00:48<00:40, 110.52it/s] 54%|█████████████████████████████████████████▎                                  | 5293/9741 [00:48<00:39, 112.83it/s] 54%|█████████████████████████████████████████▍                                  | 5305/9741 [00:48<00:39, 113.46it/s] 55%|█████████████████████████████████████████▍                                  | 5318/9741 [00:48<00:38, 116.39it/s] 55%|█████████████████████████████████████████▌                                  | 5331/9741 [00:48<00:37, 118.88it/s] 55%|█████████████████████████████████████████▋                                  | 5343/9741 [00:48<00:37, 116.21it/s] 55%|█████████████████████████████████████████▊                                  | 5355/9741 [00:48<00:38, 112.85it/s] 55%|█████████████████████████████████████████▊                                  | 5367/9741 [00:48<00:38, 113.41it/s] 55%|█████████████████████████████████████████▉                                  | 5380/9741 [00:49<00:37, 115.73it/s] 55%|██████████████████████████████████████████                                  | 5393/9741 [00:49<00:36, 117.78it/s] 55%|██████████████████████████████████████████▏                                 | 5406/9741 [00:49<00:36, 118.19it/s] 56%|██████████████████████████████████████████▎                                 | 5418/9741 [00:49<00:38, 111.38it/s] 56%|██████████████████████████████████████████▎                                 | 5431/9741 [00:49<00:37, 114.22it/s] 56%|██████████████████████████████████████████▍                                 | 5443/9741 [00:49<00:37, 114.79it/s] 56%|██████████████████████████████████████████▌                                 | 5456/9741 [00:49<00:36, 117.61it/s] 56%|██████████████████████████████████████████▋                                 | 5468/9741 [00:49<00:36, 116.37it/s] 56%|██████████████████████████████████████████▊                                 | 5480/9741 [00:49<00:38, 111.37it/s] 56%|██████████████████████████████████████████▊                                 | 5492/9741 [00:50<00:38, 111.29it/s] 57%|██████████████████████████████████████████▉                                 | 5505/9741 [00:50<00:36, 114.87it/s] 57%|███████████████████████████████████████████                                 | 5519/9741 [00:50<00:35, 119.38it/s] 57%|███████████████████████████████████████████▏                                | 5532/9741 [00:50<00:34, 121.82it/s] 57%|███████████████████████████████████████████▎                                | 5545/9741 [00:50<00:36, 113.61it/s] 57%|███████████████████████████████████████████▎                                | 5557/9741 [00:50<00:36, 114.02it/s] 57%|███████████████████████████████████████████▍                                | 5570/9741 [00:50<00:35, 116.65it/s] 57%|███████████████████████████████████████████▌                                | 5584/9741 [00:50<00:33, 122.39it/s] 57%|███████████████████████████████████████████▋                                | 5600/9741 [00:50<00:31, 132.63it/s] 58%|███████████████████████████████████████████▊                                | 5614/9741 [00:50<00:31, 130.02it/s] 58%|███████████████████████████████████████████▉                                | 5629/9741 [00:51<00:30, 133.90it/s] 58%|████████████████████████████████████████████                                | 5644/9741 [00:51<00:29, 138.04it/s] 58%|████████████████████████████████████████████▏                               | 5659/9741 [00:51<00:28, 140.79it/s] 58%|████████████████████████████████████████████▎                               | 5674/9741 [00:51<00:32, 123.76it/s] 58%|████████████████████████████████████████████▎                               | 5687/9741 [00:51<00:33, 122.84it/s] 59%|████████████████████████████████████████████▍                               | 5700/9741 [00:51<00:34, 118.21it/s] 59%|████████████████████████████████████████████▌                               | 5713/9741 [00:51<00:33, 120.21it/s] 59%|████████████████████████████████████████████▋                               | 5726/9741 [00:51<00:33, 120.45it/s] 59%|████████████████████████████████████████████▊                               | 5739/9741 [00:52<00:33, 121.10it/s] 59%|████████████████████████████████████████████▉                               | 5752/9741 [00:52<00:35, 113.29it/s] 59%|████████████████████████████████████████████▉                               | 5764/9741 [00:52<00:37, 107.06it/s] 59%|█████████████████████████████████████████████                               | 5777/9741 [00:52<00:35, 111.79it/s] 59%|█████████████████████████████████████████████▏                              | 5790/9741 [00:52<00:34, 113.91it/s] 60%|█████████████████████████████████████████████▎                              | 5802/9741 [00:52<00:34, 113.70it/s] 60%|█████████████████████████████████████████████▉                               | 5814/9741 [00:52<00:39, 99.86it/s] 60%|█████████████████████████████████████████████▍                              | 5826/9741 [00:52<00:37, 103.50it/s] 60%|█████████████████████████████████████████████▌                              | 5839/9741 [00:52<00:35, 109.44it/s] 60%|█████████████████████████████████████████████▋                              | 5851/9741 [00:53<00:34, 111.79it/s] 60%|█████████████████████████████████████████████▋                              | 5863/9741 [00:53<00:34, 111.29it/s] 60%|█████████████████████████████████████████████▊                              | 5875/9741 [00:53<00:38, 101.12it/s] 60%|█████████████████████████████████████████████▉                              | 5888/9741 [00:53<00:35, 107.11it/s] 61%|██████████████████████████████████████████████                              | 5901/9741 [00:53<00:34, 110.66it/s] 61%|██████████████████████████████████████████████▏                             | 5913/9741 [00:53<00:34, 111.90it/s] 61%|██████████████████████████████████████████████▏                             | 5925/9741 [00:53<00:34, 110.37it/s] 61%|██████████████████████████████████████████████▎                             | 5937/9741 [00:53<00:35, 107.81it/s] 61%|██████████████████████████████████████████████▍                             | 5950/9741 [00:53<00:33, 113.04it/s] 61%|██████████████████████████████████████████████▌                             | 5963/9741 [00:54<00:32, 116.43it/s] 61%|██████████████████████████████████████████████▌                             | 5975/9741 [00:54<00:32, 116.59it/s] 61%|██████████████████████████████████████████████▋                             | 5988/9741 [00:54<00:31, 118.87it/s] 62%|██████████████████████████████████████████████▊                             | 6000/9741 [00:54<00:33, 113.13it/s] 62%|██████████████████████████████████████████████▉                             | 6012/9741 [00:54<00:35, 103.71it/s] 62%|██████████████████████████████████████████████▉                             | 6023/9741 [00:54<00:35, 104.80it/s] 62%|███████████████████████████████████████████████                             | 6036/9741 [00:54<00:33, 110.25it/s] 62%|███████████████████████████████████████████████▏                            | 6048/9741 [00:54<00:33, 108.87it/s] 62%|███████████████████████████████████████████████▎                            | 6059/9741 [00:54<00:35, 102.56it/s] 62%|███████████████████████████████████████████████▎                            | 6070/9741 [00:55<00:35, 103.43it/s] 62%|███████████████████████████████████████████████▍                            | 6082/9741 [00:55<00:34, 105.72it/s] 63%|███████████████████████████████████████████████▌                            | 6095/9741 [00:55<00:32, 110.60it/s] 63%|███████████████████████████████████████████████▋                            | 6108/9741 [00:55<00:31, 114.45it/s] 63%|███████████████████████████████████████████████▊                            | 6121/9741 [00:55<00:31, 115.99it/s] 63%|███████████████████████████████████████████████▊                            | 6133/9741 [00:55<00:34, 105.54it/s] 63%|███████████████████████████████████████████████▉                            | 6146/9741 [00:55<00:32, 111.13it/s] 63%|████████████████████████████████████████████████                            | 6159/9741 [00:55<00:31, 115.07it/s] 63%|████████████████████████████████████████████████▏                           | 6172/9741 [00:55<00:30, 116.89it/s] 63%|████████████████████████████████████████████████▎                           | 6185/9741 [00:56<00:29, 119.86it/s] 64%|████████████████████████████████████████████████▎                           | 6198/9741 [00:56<00:31, 112.60it/s] 64%|████████████████████████████████████████████████▍                           | 6210/9741 [00:56<00:31, 112.07it/s] 64%|████████████████████████████████████████████████▌                           | 6223/9741 [00:56<00:30, 116.22it/s] 64%|████████████████████████████████████████████████▋                           | 6236/9741 [00:56<00:29, 119.99it/s] 64%|████████████████████████████████████████████████▊                           | 6249/9741 [00:56<00:29, 119.38it/s] 64%|████████████████████████████████████████████████▊                           | 6262/9741 [00:56<00:33, 104.17it/s] 64%|████████████████████████████████████████████████▉                           | 6274/9741 [00:56<00:32, 107.51it/s] 65%|█████████████████████████████████████████████████                           | 6287/9741 [00:56<00:31, 111.35it/s] 65%|█████████████████████████████████████████████████▏                          | 6300/9741 [00:57<00:30, 114.32it/s] 65%|█████████████████████████████████████████████████▏                          | 6312/9741 [00:57<00:29, 115.05it/s] 65%|█████████████████████████████████████████████████▎                          | 6324/9741 [00:57<00:33, 101.99it/s] 65%|█████████████████████████████████████████████████▍                          | 6335/9741 [00:57<00:33, 102.06it/s] 65%|█████████████████████████████████████████████████▌                          | 6347/9741 [00:57<00:31, 106.51it/s] 65%|█████████████████████████████████████████████████▌                          | 6360/9741 [00:57<00:30, 112.26it/s] 65%|█████████████████████████████████████████████████▋                          | 6373/9741 [00:57<00:28, 116.25it/s] 66%|█████████████████████████████████████████████████▊                          | 6385/9741 [00:57<00:33, 101.49it/s] 66%|█████████████████████████████████████████████████▉                          | 6396/9741 [00:58<00:32, 103.10it/s] 66%|██████████████████████████████████████████████████                          | 6409/9741 [00:58<00:30, 108.60it/s] 66%|██████████████████████████████████████████████████                          | 6421/9741 [00:58<00:30, 108.66it/s] 66%|██████████████████████████████████████████████████▏                         | 6434/9741 [00:58<00:29, 112.31it/s] 66%|██████████████████████████████████████████████████▎                         | 6446/9741 [00:58<00:29, 111.23it/s] 66%|██████████████████████████████████████████████████▍                         | 6458/9741 [00:58<00:29, 110.05it/s] 66%|██████████████████████████████████████████████████▍                         | 6470/9741 [00:58<00:29, 111.66it/s] 67%|██████████████████████████████████████████████████▌                         | 6482/9741 [00:58<00:29, 111.85it/s] 67%|██████████████████████████████████████████████████▋                         | 6495/9741 [00:58<00:28, 115.05it/s] 67%|██████████████████████████████████████████████████▊                         | 6507/9741 [00:58<00:28, 113.96it/s] 67%|██████████████████████████████████████████████████▊                         | 6519/9741 [00:59<00:28, 113.94it/s] 67%|██████████████████████████████████████████████████▉                         | 6531/9741 [00:59<00:28, 111.13it/s] 67%|███████████████████████████████████████████████████                         | 6543/9741 [00:59<00:28, 112.48it/s] 67%|███████████████████████████████████████████████████▏                        | 6555/9741 [00:59<00:27, 113.96it/s] 67%|███████████████████████████████████████████████████▏                        | 6568/9741 [00:59<00:26, 118.40it/s] 68%|███████████████████████████████████████████████████▎                        | 6580/9741 [00:59<00:26, 117.15it/s] 68%|███████████████████████████████████████████████████▍                        | 6592/9741 [00:59<00:27, 115.01it/s] 68%|███████████████████████████████████████████████████▌                        | 6604/9741 [00:59<00:28, 110.50it/s] 68%|███████████████████████████████████████████████████▋                        | 6617/9741 [00:59<00:27, 113.95it/s] 68%|███████████████████████████████████████████████████▋                        | 6629/9741 [01:00<00:27, 115.21it/s] 68%|███████████████████████████████████████████████████▊                        | 6641/9741 [01:00<00:28, 109.21it/s] 68%|███████████████████████████████████████████████████▉                        | 6653/9741 [01:00<00:30, 102.20it/s] 68%|████████████████████████████████████████████████████                        | 6665/9741 [01:00<00:29, 104.53it/s] 69%|████████████████████████████████████████████████████                        | 6678/9741 [01:00<00:27, 109.77it/s] 69%|████████████████████████████████████████████████████▏                       | 6690/9741 [01:00<00:29, 105.13it/s] 69%|████████████████████████████████████████████████████▎                       | 6702/9741 [01:00<00:28, 107.99it/s] 69%|████████████████████████████████████████████████████▍                       | 6714/9741 [01:00<00:27, 111.02it/s] 69%|████████████████████████████████████████████████████▍                       | 6726/9741 [01:00<00:26, 113.09it/s] 69%|████████████████████████████████████████████████████▌                       | 6738/9741 [01:01<00:26, 111.90it/s] 69%|████████████████████████████████████████████████████▋                       | 6751/9741 [01:01<00:26, 114.61it/s] 69%|████████████████████████████████████████████████████▊                       | 6763/9741 [01:01<00:26, 111.69it/s] 70%|████████████████████████████████████████████████████▊                       | 6776/9741 [01:01<00:25, 115.55it/s] 70%|████████████████████████████████████████████████████▉                       | 6788/9741 [01:01<00:26, 113.01it/s] 70%|█████████████████████████████████████████████████████                       | 6800/9741 [01:01<00:26, 111.89it/s] 70%|█████████████████████████████████████████████████████▏                      | 6813/9741 [01:01<00:25, 115.01it/s] 70%|█████████████████████████████████████████████████████▎                      | 6827/9741 [01:01<00:24, 119.95it/s] 70%|█████████████████████████████████████████████████████▎                      | 6840/9741 [01:01<00:25, 115.10it/s] 70%|█████████████████████████████████████████████████████▍                      | 6852/9741 [01:02<00:25, 112.91it/s] 70%|█████████████████████████████████████████████████████▌                      | 6864/9741 [01:02<00:25, 111.76it/s] 71%|█████████████████████████████████████████████████████▋                      | 6877/9741 [01:02<00:24, 115.46it/s] 71%|█████████████████████████████████████████████████████▋                      | 6889/9741 [01:02<00:24, 115.66it/s] 71%|█████████████████████████████████████████████████████▊                      | 6902/9741 [01:02<00:24, 116.59it/s] 71%|█████████████████████████████████████████████████████▉                      | 6914/9741 [01:02<00:25, 111.15it/s] 71%|██████████████████████████████████████████████████████                      | 6927/9741 [01:02<00:24, 115.15it/s] 71%|██████████████████████████████████████████████████████▏                     | 6940/9741 [01:02<00:23, 117.12it/s] 71%|██████████████████████████████████████████████████████▏                     | 6953/9741 [01:02<00:23, 120.60it/s] 72%|██████████████████████████████████████████████████████▎                     | 6966/9741 [01:03<00:22, 121.91it/s] 72%|██████████████████████████████████████████████████████▍                     | 6979/9741 [01:03<00:24, 113.45it/s] 72%|██████████████████████████████████████████████████████▌                     | 6991/9741 [01:03<00:26, 104.49it/s] 72%|██████████████████████████████████████████████████████▋                     | 7004/9741 [01:03<00:24, 110.86it/s] 72%|██████████████████████████████████████████████████████▊                     | 7018/9741 [01:03<00:23, 116.40it/s] 72%|██████████████████████████████████████████████████████▊                     | 7031/9741 [01:03<00:23, 117.82it/s] 72%|██████████████████████████████████████████████████████▉                     | 7043/9741 [01:03<00:25, 105.67it/s] 72%|███████████████████████████████████████████████████████                     | 7054/9741 [01:03<00:25, 105.19it/s] 73%|███████████████████████████████████████████████████████▏                    | 7067/9741 [01:03<00:24, 110.60it/s] 73%|███████████████████████████████████████████████████████▏                    | 7080/9741 [01:04<00:23, 114.88it/s] 73%|███████████████████████████████████████████████████████▎                    | 7092/9741 [01:04<00:22, 115.77it/s] 73%|███████████████████████████████████████████████████████▍                    | 7104/9741 [01:04<00:24, 108.16it/s] 73%|███████████████████████████████████████████████████████▌                    | 7115/9741 [01:04<00:24, 108.51it/s] 73%|███████████████████████████████████████████████████████▌                    | 7128/9741 [01:04<00:22, 113.89it/s] 73%|███████████████████████████████████████████████████████▋                    | 7141/9741 [01:04<00:22, 117.28it/s] 73%|███████████████████████████████████████████████████████▊                    | 7153/9741 [01:04<00:21, 117.91it/s] 74%|███████████████████████████████████████████████████████▉                    | 7166/9741 [01:04<00:21, 119.26it/s] 74%|████████████████████████████████████████████████████████                    | 7178/9741 [01:04<00:25, 101.34it/s] 74%|████████████████████████████████████████████████████████                    | 7189/9741 [01:05<00:25, 101.97it/s] 74%|████████████████████████████████████████████████████████▏                   | 7202/9741 [01:05<00:23, 107.98it/s] 74%|████████████████████████████████████████████████████████▎                   | 7214/9741 [01:05<00:22, 110.93it/s] 74%|████████████████████████████████████████████████████████▍                   | 7226/9741 [01:05<00:22, 111.52it/s] 74%|████████████████████████████████████████████████████████▍                   | 7238/9741 [01:05<00:22, 113.34it/s] 74%|████████████████████████████████████████████████████████▌                   | 7250/9741 [01:05<00:22, 111.13it/s] 75%|████████████████████████████████████████████████████████▋                   | 7263/9741 [01:05<00:21, 114.90it/s] 75%|████████████████████████████████████████████████████████▊                   | 7276/9741 [01:05<00:21, 117.07it/s] 75%|████████████████████████████████████████████████████████▊                   | 7289/9741 [01:05<00:20, 118.31it/s] 75%|████████████████████████████████████████████████████████▉                   | 7301/9741 [01:06<00:21, 112.13it/s] 75%|█████████████████████████████████████████████████████████▊                   | 7313/9741 [01:06<00:24, 97.84it/s] 75%|█████████████████████████████████████████████████████████▏                  | 7326/9741 [01:06<00:23, 104.06it/s] 75%|█████████████████████████████████████████████████████████▎                  | 7340/9741 [01:06<00:21, 111.96it/s] 75%|█████████████████████████████████████████████████████████▎                  | 7353/9741 [01:06<00:20, 114.28it/s] 76%|█████████████████████████████████████████████████████████▍                  | 7365/9741 [01:06<00:21, 112.67it/s] 76%|█████████████████████████████████████████████████████████▌                  | 7377/9741 [01:06<00:21, 109.44it/s] 76%|█████████████████████████████████████████████████████████▋                  | 7390/9741 [01:06<00:20, 113.28it/s] 76%|█████████████████████████████████████████████████████████▊                  | 7406/9741 [01:06<00:18, 123.88it/s] 76%|█████████████████████████████████████████████████████████▉                  | 7421/9741 [01:07<00:17, 130.17it/s] 76%|██████████████████████████████████████████████████████████                  | 7435/9741 [01:07<00:22, 104.25it/s] 76%|██████████████████████████████████████████████████████████▏                 | 7451/9741 [01:07<00:19, 117.28it/s] 77%|██████████████████████████████████████████████████████████▎                 | 7468/9741 [01:07<00:17, 129.11it/s] 77%|██████████████████████████████████████████████████████████▍                 | 7485/9741 [01:07<00:16, 138.91it/s] 77%|██████████████████████████████████████████████████████████▌                 | 7500/9741 [01:07<00:15, 140.76it/s] 77%|██████████████████████████████████████████████████████████▋                 | 7515/9741 [01:07<00:15, 141.57it/s] 77%|██████████████████████████████████████████████████████████▋                 | 7530/9741 [01:07<00:15, 138.63it/s] 77%|██████████████████████████████████████████████████████████▊                 | 7545/9741 [01:07<00:15, 140.88it/s] 78%|██████████████████████████████████████████████████████████▉                 | 7561/9741 [01:08<00:14, 145.49it/s] 78%|███████████████████████████████████████████████████████████▏                | 7579/9741 [01:08<00:14, 153.81it/s] 78%|███████████████████████████████████████████████████████████▎                | 7595/9741 [01:08<00:14, 149.32it/s] 78%|███████████████████████████████████████████████████████████▍                | 7611/9741 [01:08<00:14, 145.50it/s] 78%|███████████████████████████████████████████████████████████▍                | 7626/9741 [01:08<00:14, 146.52it/s] 78%|███████████████████████████████████████████████████████████▌                | 7642/9741 [01:08<00:14, 149.03it/s] 79%|███████████████████████████████████████████████████████████▋                | 7657/9741 [01:08<00:14, 141.54it/s] 79%|███████████████████████████████████████████████████████████▊                | 7672/9741 [01:08<00:14, 143.32it/s] 79%|███████████████████████████████████████████████████████████▉                | 7687/9741 [01:08<00:14, 144.45it/s] 79%|████████████████████████████████████████████████████████████                | 7703/9741 [01:09<00:13, 147.70it/s] 79%|████████████████████████████████████████████████████████████▏               | 7719/9741 [01:09<00:13, 150.88it/s] 79%|████████████████████████████████████████████████████████████▎               | 7735/9741 [01:09<00:13, 144.39it/s] 80%|████████████████████████████████████████████████████████████▍               | 7751/9741 [01:09<00:13, 147.65it/s] 80%|████████████████████████████████████████████████████████████▌               | 7766/9741 [01:09<00:13, 144.06it/s] 80%|████████████████████████████████████████████████████████████▋               | 7782/9741 [01:09<00:13, 146.98it/s] 80%|████████████████████████████████████████████████████████████▊               | 7798/9741 [01:09<00:13, 147.87it/s] 80%|████████████████████████████████████████████████████████████▉               | 7815/9741 [01:09<00:12, 151.74it/s] 80%|█████████████████████████████████████████████████████████████               | 7831/9741 [01:09<00:12, 153.51it/s] 81%|█████████████████████████████████████████████████████████████▏              | 7847/9741 [01:10<00:14, 133.25it/s] 81%|█████████████████████████████████████████████████████████████▎              | 7861/9741 [01:10<00:15, 119.87it/s] 81%|█████████████████████████████████████████████████████████████▍              | 7874/9741 [01:10<00:17, 107.67it/s] 81%|█████████████████████████████████████████████████████████████▌              | 7887/9741 [01:10<00:16, 110.92it/s] 81%|█████████████████████████████████████████████████████████████▋              | 7899/9741 [01:10<00:16, 109.77it/s] 81%|█████████████████████████████████████████████████████████████▋              | 7911/9741 [01:10<00:16, 110.59it/s] 81%|█████████████████████████████████████████████████████████████▊              | 7923/9741 [01:10<00:16, 112.82it/s] 81%|█████████████████████████████████████████████████████████████▉              | 7936/9741 [01:10<00:15, 116.84it/s] 82%|██████████████████████████████████████████████████████████████              | 7948/9741 [01:11<00:15, 113.80it/s] 82%|██████████████████████████████████████████████████████████████              | 7961/9741 [01:11<00:15, 115.86it/s] 82%|██████████████████████████████████████████████████████████████▏             | 7973/9741 [01:11<00:15, 113.69it/s] 82%|██████████████████████████████████████████████████████████████▎             | 7985/9741 [01:11<00:15, 113.34it/s] 82%|██████████████████████████████████████████████████████████████▍             | 7998/9741 [01:11<00:15, 116.14it/s] 82%|██████████████████████████████████████████████████████████████▌             | 8012/9741 [01:11<00:14, 120.05it/s] 82%|██████████████████████████████████████████████████████████████▌             | 8025/9741 [01:11<00:14, 118.78it/s] 83%|██████████████████████████████████████████████████████████████▋             | 8037/9741 [01:11<00:15, 111.65it/s] 83%|██████████████████████████████████████████████████████████████▊             | 8049/9741 [01:11<00:15, 109.84it/s] 83%|██████████████████████████████████████████████████████████████▉             | 8062/9741 [01:12<00:14, 113.88it/s] 83%|███████████████████████████████████████████████████████████████             | 8075/9741 [01:12<00:14, 115.76it/s] 83%|███████████████████████████████████████████████████████████████             | 8088/9741 [01:12<00:14, 117.32it/s] 83%|███████████████████████████████████████████████████████████████▏            | 8101/9741 [01:12<00:13, 119.43it/s] 83%|███████████████████████████████████████████████████████████████▎            | 8113/9741 [01:12<00:14, 112.07it/s] 83%|███████████████████████████████████████████████████████████████▍            | 8125/9741 [01:12<00:14, 109.45it/s] 84%|███████████████████████████████████████████████████████████████▍            | 8138/9741 [01:12<00:14, 112.90it/s] 84%|███████████████████████████████████████████████████████████████▌            | 8151/9741 [01:12<00:13, 116.96it/s] 84%|███████████████████████████████████████████████████████████████▋            | 8163/9741 [01:12<00:13, 116.75it/s] 84%|███████████████████████████████████████████████████████████████▊            | 8175/9741 [01:13<00:14, 108.88it/s] 84%|███████████████████████████████████████████████████████████████▉            | 8187/9741 [01:13<00:14, 103.71it/s] 84%|███████████████████████████████████████████████████████████████▉            | 8199/9741 [01:13<00:14, 107.77it/s] 84%|████████████████████████████████████████████████████████████████            | 8212/9741 [01:13<00:13, 113.13it/s] 84%|████████████████████████████████████████████████████████████████▏           | 8225/9741 [01:13<00:13, 115.76it/s] 85%|████████████████████████████████████████████████████████████████▎           | 8237/9741 [01:13<00:14, 104.78it/s] 85%|████████████████████████████████████████████████████████████████▎           | 8248/9741 [01:13<00:14, 105.72it/s] 85%|████████████████████████████████████████████████████████████████▍           | 8259/9741 [01:13<00:13, 106.11it/s] 85%|████████████████████████████████████████████████████████████████▌           | 8270/9741 [01:13<00:13, 106.56it/s] 85%|████████████████████████████████████████████████████████████████▌           | 8281/9741 [01:13<00:13, 106.63it/s] 85%|████████████████████████████████████████████████████████████████▋           | 8292/9741 [01:14<00:13, 107.27it/s] 85%|████████████████████████████████████████████████████████████████▊           | 8303/9741 [01:14<00:13, 107.57it/s] 85%|████████████████████████████████████████████████████████████████▊           | 8314/9741 [01:14<00:13, 107.67it/s] 85%|████████████████████████████████████████████████████████████████▉           | 8325/9741 [01:14<00:13, 107.42it/s] 86%|█████████████████████████████████████████████████████████████████           | 8337/9741 [01:14<00:12, 108.29it/s] 86%|█████████████████████████████████████████████████████████████████▏          | 8348/9741 [01:14<00:13, 106.67it/s] 86%|█████████████████████████████████████████████████████████████████▏          | 8360/9741 [01:14<00:12, 110.50it/s] 86%|█████████████████████████████████████████████████████████████████▎          | 8373/9741 [01:14<00:11, 114.89it/s] 86%|█████████████████████████████████████████████████████████████████▍          | 8385/9741 [01:14<00:12, 109.81it/s] 86%|█████████████████████████████████████████████████████████████████▌          | 8397/9741 [01:15<00:12, 109.15it/s] 86%|█████████████████████████████████████████████████████████████████▌          | 8408/9741 [01:15<00:12, 109.35it/s] 86%|█████████████████████████████████████████████████████████████████▋          | 8419/9741 [01:15<00:12, 108.73it/s] 87%|█████████████████████████████████████████████████████████████████▊          | 8431/9741 [01:15<00:11, 111.01it/s] 87%|█████████████████████████████████████████████████████████████████▊          | 8443/9741 [01:15<00:11, 111.96it/s] 87%|█████████████████████████████████████████████████████████████████▉          | 8456/9741 [01:15<00:11, 114.74it/s] 87%|██████████████████████████████████████████████████████████████████          | 8469/9741 [01:15<00:10, 118.56it/s] 87%|██████████████████████████████████████████████████████████████████▏         | 8481/9741 [01:15<00:10, 116.96it/s] 87%|██████████████████████████████████████████████████████████████████▎         | 8493/9741 [01:15<00:10, 114.17it/s] 87%|██████████████████████████████████████████████████████████████████▎         | 8506/9741 [01:15<00:10, 117.39it/s] 87%|██████████████████████████████████████████████████████████████████▍         | 8519/9741 [01:16<00:10, 118.46it/s] 88%|██████████████████████████████████████████████████████████████████▌         | 8532/9741 [01:16<00:10, 120.58it/s] 88%|██████████████████████████████████████████████████████████████████▋         | 8545/9741 [01:16<00:09, 121.30it/s] 88%|██████████████████████████████████████████████████████████████████▊         | 8558/9741 [01:16<00:10, 113.93it/s] 88%|██████████████████████████████████████████████████████████████████▊         | 8571/9741 [01:16<00:09, 118.25it/s] 88%|██████████████████████████████████████████████████████████████████▉         | 8587/9741 [01:16<00:09, 128.21it/s] 88%|███████████████████████████████████████████████████████████████████         | 8602/9741 [01:16<00:08, 131.88it/s] 88%|███████████████████████████████████████████████████████████████████▏        | 8618/9741 [01:16<00:08, 138.81it/s] 89%|███████████████████████████████████████████████████████████████████▎        | 8632/9741 [01:16<00:08, 137.75it/s] 89%|███████████████████████████████████████████████████████████████████▍        | 8646/9741 [01:17<00:08, 135.80it/s] 89%|███████████████████████████████████████████████████████████████████▌        | 8661/9741 [01:17<00:07, 139.11it/s] 89%|███████████████████████████████████████████████████████████████████▋        | 8675/9741 [01:17<00:07, 138.60it/s] 89%|███████████████████████████████████████████████████████████████████▊        | 8690/9741 [01:17<00:07, 140.14it/s] 89%|███████████████████████████████████████████████████████████████████▉        | 8706/9741 [01:17<00:07, 143.41it/s] 90%|████████████████████████████████████████████████████████████████████        | 8721/9741 [01:17<00:07, 142.83it/s] 90%|████████████████████████████████████████████████████████████████████▏       | 8737/9741 [01:17<00:06, 146.94it/s] 90%|████████████████████████████████████████████████████████████████████▎       | 8752/9741 [01:17<00:06, 142.11it/s] 90%|████████████████████████████████████████████████████████████████████▍       | 8768/9741 [01:17<00:06, 144.63it/s] 90%|████████████████████████████████████████████████████████████████████▌       | 8785/9741 [01:18<00:06, 150.16it/s] 90%|████████████████████████████████████████████████████████████████████▋       | 8801/9741 [01:18<00:06, 142.24it/s] 91%|████████████████████████████████████████████████████████████████████▊       | 8816/9741 [01:18<00:07, 131.23it/s] 91%|████████████████████████████████████████████████████████████████████▉       | 8830/9741 [01:18<00:07, 118.98it/s] 91%|█████████████████████████████████████████████████████████████████████       | 8846/9741 [01:18<00:06, 128.96it/s] 91%|█████████████████████████████████████████████████████████████████████▏      | 8862/9741 [01:18<00:06, 135.99it/s] 91%|█████████████████████████████████████████████████████████████████████▎      | 8877/9741 [01:18<00:06, 137.96it/s] 91%|█████████████████████████████████████████████████████████████████████▍      | 8892/9741 [01:18<00:06, 140.63it/s] 91%|█████████████████████████████████████████████████████████████████████▍      | 8907/9741 [01:18<00:05, 141.33it/s] 92%|█████████████████████████████████████████████████████████████████████▋      | 8925/9741 [01:19<00:05, 150.63it/s] 92%|█████████████████████████████████████████████████████████████████████▊      | 8942/9741 [01:19<00:05, 154.96it/s] 92%|█████████████████████████████████████████████████████████████████████▉      | 8958/9741 [01:19<00:05, 146.73it/s] 92%|██████████████████████████████████████████████████████████████████████      | 8973/9741 [01:19<00:05, 146.69it/s] 92%|██████████████████████████████████████████████████████████████████████▏     | 8988/9741 [01:19<00:05, 145.03it/s] 92%|██████████████████████████████████████████████████████████████████████▏     | 9004/9741 [01:19<00:04, 149.06it/s] 93%|██████████████████████████████████████████████████████████████████████▎     | 9019/9741 [01:19<00:05, 143.42it/s] 93%|██████████████████████████████████████████████████████████████████████▍     | 9034/9741 [01:19<00:05, 131.70it/s] 93%|██████████████████████████████████████████████████████████████████████▌     | 9048/9741 [01:19<00:05, 130.95it/s] 93%|██████████████████████████████████████████████████████████████████████▋     | 9063/9741 [01:20<00:05, 134.27it/s] 93%|██████████████████████████████████████████████████████████████████████▊     | 9079/9741 [01:20<00:04, 139.73it/s] 93%|██████████████████████████████████████████████████████████████████████▉     | 9095/9741 [01:20<00:04, 144.05it/s] 94%|███████████████████████████████████████████████████████████████████████     | 9110/9741 [01:20<00:05, 121.94it/s] 94%|███████████████████████████████████████████████████████████████████████▏    | 9123/9741 [01:20<00:05, 112.68it/s] 94%|███████████████████████████████████████████████████████████████████████▎    | 9135/9741 [01:20<00:05, 102.45it/s] 94%|███████████████████████████████████████████████████████████████████████▎    | 9146/9741 [01:20<00:05, 103.96it/s] 94%|███████████████████████████████████████████████████████████████████████▍    | 9159/9741 [01:20<00:05, 108.93it/s] 94%|███████████████████████████████████████████████████████████████████████▌    | 9171/9741 [01:21<00:05, 108.98it/s] 94%|███████████████████████████████████████████████████████████████████████▋    | 9183/9741 [01:21<00:05, 109.28it/s] 94%|███████████████████████████████████████████████████████████████████████▋    | 9195/9741 [01:21<00:04, 109.26it/s] 95%|███████████████████████████████████████████████████████████████████████▊    | 9207/9741 [01:21<00:04, 112.15it/s] 95%|███████████████████████████████████████████████████████████████████████▉    | 9219/9741 [01:21<00:04, 114.03it/s] 95%|████████████████████████████████████████████████████████████████████████    | 9231/9741 [01:21<00:04, 112.73it/s] 95%|████████████████████████████████████████████████████████████████████████    | 9244/9741 [01:21<00:04, 115.19it/s] 95%|████████████████████████████████████████████████████████████████████████▏   | 9256/9741 [01:21<00:04, 112.45it/s] 95%|████████████████████████████████████████████████████████████████████████▎   | 9268/9741 [01:21<00:04, 113.46it/s] 95%|████████████████████████████████████████████████████████████████████████▍   | 9280/9741 [01:21<00:04, 112.92it/s] 95%|████████████████████████████████████████████████████████████████████████▍   | 9292/9741 [01:22<00:03, 114.53it/s] 96%|████████████████████████████████████████████████████████████████████████▌   | 9304/9741 [01:22<00:03, 115.14it/s] 96%|████████████████████████████████████████████████████████████████████████▋   | 9316/9741 [01:22<00:03, 116.18it/s] 96%|████████████████████████████████████████████████████████████████████████▊   | 9329/9741 [01:22<00:03, 119.13it/s] 96%|████████████████████████████████████████████████████████████████████████▉   | 9342/9741 [01:22<00:03, 119.78it/s] 96%|████████████████████████████████████████████████████████████████████████▉   | 9355/9741 [01:22<00:03, 122.23it/s] 96%|█████████████████████████████████████████████████████████████████████████   | 9368/9741 [01:22<00:03, 117.07it/s] 96%|█████████████████████████████████████████████████████████████████████████▏  | 9380/9741 [01:22<00:03, 113.08it/s] 96%|█████████████████████████████████████████████████████████████████████████▎  | 9393/9741 [01:22<00:02, 116.01it/s] 97%|█████████████████████████████████████████████████████████████████████████▍  | 9407/9741 [01:23<00:02, 120.83it/s] 97%|█████████████████████████████████████████████████████████████████████████▍  | 9420/9741 [01:23<00:02, 122.23it/s] 97%|█████████████████████████████████████████████████████████████████████████▌  | 9433/9741 [01:23<00:02, 121.62it/s] 97%|█████████████████████████████████████████████████████████████████████████▋  | 9446/9741 [01:23<00:02, 113.84it/s] 97%|█████████████████████████████████████████████████████████████████████████▊  | 9459/9741 [01:23<00:02, 116.45it/s] 97%|█████████████████████████████████████████████████████████████████████████▉  | 9471/9741 [01:23<00:02, 114.90it/s] 97%|█████████████████████████████████████████████████████████████████████████▉  | 9484/9741 [01:23<00:02, 116.62it/s] 97%|██████████████████████████████████████████████████████████████████████████  | 9496/9741 [01:23<00:02, 117.34it/s] 98%|██████████████████████████████████████████████████████████████████████████▏ | 9508/9741 [01:23<00:01, 117.05it/s] 98%|██████████████████████████████████████████████████████████████████████████▎ | 9520/9741 [01:24<00:01, 111.51it/s] 98%|██████████████████████████████████████████████████████████████████████████▎ | 9532/9741 [01:24<00:01, 112.95it/s] 98%|██████████████████████████████████████████████████████████████████████████▍ | 9546/9741 [01:24<00:01, 119.17it/s] 98%|██████████████████████████████████████████████████████████████████████████▌ | 9558/9741 [01:24<00:01, 115.45it/s] 98%|██████████████████████████████████████████████████████████████████████████▋ | 9570/9741 [01:24<00:01, 115.33it/s] 98%|██████████████████████████████████████████████████████████████████████████▊ | 9582/9741 [01:24<00:01, 115.43it/s] 98%|██████████████████████████████████████████████████████████████████████████▊ | 9594/9741 [01:24<00:01, 114.90it/s] 99%|██████████████████████████████████████████████████████████████████████████▉ | 9607/9741 [01:24<00:01, 118.37it/s] 99%|███████████████████████████████████████████████████████████████████████████ | 9619/9741 [01:24<00:01, 118.41it/s] 99%|███████████████████████████████████████████████████████████████████████████▏| 9631/9741 [01:24<00:00, 117.03it/s] 99%|███████████████████████████████████████████████████████████████████████████▏| 9643/9741 [01:25<00:00, 116.19it/s] 99%|███████████████████████████████████████████████████████████████████████████▎| 9655/9741 [01:25<00:00, 111.32it/s] 99%|███████████████████████████████████████████████████████████████████████████▍| 9667/9741 [01:25<00:00, 112.89it/s] 99%|███████████████████████████████████████████████████████████████████████████▌| 9679/9741 [01:25<00:00, 113.36it/s] 99%|███████████████████████████████████████████████████████████████████████████▌| 9691/9741 [01:25<00:00, 113.59it/s]100%|████████████████████████████████████████████████████████████████████████████▋| 9703/9741 [01:25<00:00, 97.95it/s]100%|████████████████████████████████████████████████████████████████████████████▊| 9714/9741 [01:25<00:00, 91.16it/s]100%|████████████████████████████████████████████████████████████████████████████▊| 9724/9741 [01:25<00:00, 91.16it/s]100%|████████████████████████████████████████████████████████████████████████████▉| 9736/9741 [01:26<00:00, 97.57it/s]100%|████████████████████████████████████████████████████████████████████████████| 9741/9741 [01:26<00:00, 113.17it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                                | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████████████▋                                     | 1/3 [00:07<00:15,  7.56s/it]Loading checkpoint shards:  33%|██████████████████▋                                     | 1/3 [00:07<00:15,  7.76s/it]Loading checkpoint shards:  33%|██████████████████▋                                     | 1/3 [00:08<00:16,  8.07s/it]Loading checkpoint shards:  33%|██████████████████▋                                     | 1/3 [00:08<00:17,  8.71s/it]Loading checkpoint shards:  67%|█████████████████████████████████████▎                  | 2/3 [00:15<00:07,  7.89s/it]Loading checkpoint shards:  67%|█████████████████████████████████████▎                  | 2/3 [00:14<00:07,  7.37s/it]Loading checkpoint shards:  67%|█████████████████████████████████████▎                  | 2/3 [00:15<00:07,  7.69s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:20<00:00,  6.71s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:20<00:00,  7.00s/it]
Loading checkpoint shards:  67%|█████████████████████████████████████▎                  | 2/3 [00:17<00:08,  8.59s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:20<00:00,  6.69s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:20<00:00,  6.94s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:21<00:00,  6.98s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:21<00:00,  7.18s/it]
[2023-08-08 20:37:51,814] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:23<00:00,  7.44s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:23<00:00,  7.76s/it]
[2023-08-08 20:38:07,240] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-08 20:38:07,241] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-08 20:38:07,242] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-08 20:38:07,243] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-08 20:38:07,243] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-08 20:38:07,243] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-08 20:38:07,243] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-08 20:38:07,243] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-08 20:38:07,244] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-08 20:38:07,244] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-08 20:38:07,244] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-08 20:38:07,244] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fe1a05e5e80>
[2023-08-08 20:38:07,244] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-08 20:38:07,244] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-08 20:38:07,244] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-08 20:38:07,244] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-08 20:38:07,244] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-08 20:38:07,244] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-08 20:38:07,244] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-08 20:38:07,244] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-08 20:38:07,244] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-08 20:38:07,244] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-08 20:38:07,244] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-08 20:38:07,244] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-08 20:38:07,244] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-08 20:38:07,244] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-08 20:38:07,244] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-08 20:38:07,244] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-08 20:38:07,244] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-08 20:38:07,244] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-08 20:38:07,244] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-08 20:38:07,244] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-08 20:38:07,244] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-08 20:38:07,244] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-08 20:38:07,244] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-08 20:38:07,244] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-08 20:38:07,244] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-08 20:38:07,244] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-08 20:38:07,244] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-08 20:38:07,244] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-08 20:38:07,244] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-08 20:38:07,244] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-08 20:38:07,245] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-08 20:38:07,245] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-08 20:38:07,245] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7fe19fd76910>
[2023-08-08 20:38:07,245] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-08 20:38:07,245] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-08 20:38:07,245] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-08 20:38:07,245] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-08 20:38:07,245] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-08 20:38:07,245] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-08 20:38:07,245] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-08 20:38:07,245] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-08 20:38:07,245] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-08 20:38:07,245] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-08 20:38:07,245] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-08 20:38:07,245] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-08 20:38:07,245] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-08 20:38:07,245] [INFO] [config.py:1012:print]   train_batch_size ............. 16
[2023-08-08 20:38:07,245] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  4
[2023-08-08 20:38:07,245] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-08 20:38:07,245] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-08 20:38:07,245] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-08 20:38:07,245] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-08 20:38:07,245] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-08 20:38:07,245] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-08 20:38:07,245] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-08 20:38:07,245] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 4, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.8810362815856934 seconds
Loading extension module utils...
Time to load utils op: 0.8044781684875488 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                                               | 0/63 [00:00<?, ?it/s]############### Example ###############
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following multiple choice question.

### Demonstration:
Input: For every 12 cans you recycle, you receive $0.50, and for every 5 kilograms of newspapers, you receive $1.50. If your family collected 144 cans and 20 kilograms of newspapers, how much money would you receive?
Rationales: The first step is to determine how many sets of 12 cans and 5 kilograms of newspapers the family collected. This is because the payment is given for every 12 cans and every 5 kilograms of newspapers, not for individual cans or kilograms. We can do this by dividing the total number of cans and kilograms of newspapers collected by the family by 12 and 5 respectively. 

The family collected 144 cans. Dividing 144 by 12, we get 12. This means the family collected 12 sets of 12 cans.

Similarly, the family collected 20 kilograms of newspapers. Dividing this by 5, we get 4. This means the family collected 4 sets of 5 kilograms of newspapers.

The next step is to calculate the total amount of money received for the cans and the newspapers. The family receives $0.50 for every set of 12 cans, and $1.50 for every 5 kilograms of newspapers. 

Multiplying $0.50 by the 12 sets of cans, we get $6. And multiplying $1.50 by the 4 sets of newspapers, we also get $6.

Finally, we add up these two amounts to find the total money received. $6 for the cans and $6 for the newspapers gives us a total of $12.
Answer: 12

Input: Betty picked 16 strawberries. Matthew picked 20 more strawberries than Betty and twice as many as Natalie. They used their strawberries to make jam. One jar of jam used 7 strawberries and they sold each jar at $4. How much money were they able to make from the strawberries they picked?
Rationales: Matthew picked 16 + 20 = 36 strawberries.
This is because the problem tells us that Matthew picked 20 more strawberries than Betty, who picked 16.

Natalie picked 36/2 = 18 strawberries.
This is because the problem says Matthew picked twice as many strawberries as Natalie, so to find how many Natalie picked, we divide Matthew's amount by 2.

They have 16 + 36 + 18 = 70 strawberries in total.
This is because we add together all the strawberries picked by Betty, Matthew, and Natalie.

They can make 70/7 = 10 jars of strawberries.
This is because the problem states that seven strawberries are needed for one jar of jam, so we divide the total number of strawberries by 7 to see how many jars they can make.

They earn 10 x $4 = $40 from the strawberries they picked.
This is because each jar of jam is sold for $4, so we multiply the number of jars they made by $4 to find out how much money they made.
Answer: 40

Input: Jack has a stack of books that is 12 inches thick. He knows from experience that 80 pages is one inch thick. If he has 6 books, how many pages is each one on average?
Rationales: 1. Start with the information that Jack's stack of books is 12 inches thick.
2. Based on Jack's experience, 80 pages make up one inch of thickness. Therefore, to find out the total number of pages in the stack, you need to multiply the thickness of the stack in inches by the number of pages per inch. This gives us 80 pages/inch * 12 inches = 960 pages.
3. Jack has 6 books in his stack. To find the average number of pages per book, we'll divide the total number of pages by the number of books. This gives us 960 pages / 6 books = 160 pages per book.
4. So on average, each of Jack's books is 160 pages long.
Answer: 160

Input: James dumps his whole collection of 500 Legos on the floor and starts building a castle out of them.  He uses half the pieces before finishing and is told to put the rest away.  He puts all of the leftover pieces back in the box they came from, except for 5 missing pieces that he can't find.  How many Legos are in the box at the end?
Rationales: James starts with 500 Lego pieces. Since he uses only half of them for his castle, therefore, half of the total number remains unused. 

Calculating half of his Lego collection, we get:
500/2 = 250. 

So, 250 Lego pieces remain unused. 

He puts all unused Lego pieces back in the box, but he can't find 5 of them. 

So, the number of Legos that eventually go in the box is still 250, excluding the 5 missing pieces. 

We can find that by subtracting the missing pieces from the unused pieces, we get:
250 - 5 = 245. 

Hence, James has 245 Lego pieces stored in the box in the end.
Answer: 245

Input: Ines had $20 in her purse. She bought 3 pounds of peaches, which are $2 per pound at the local farmers’ market. How much did she have left?
Rationales: 1. First, determine the total cost of the peaches that Ines bought. Since peaches are sold at $2 per pound and Ines bought 3 pounds, multiply these values together to get the total cost. So, $2/peach x 3 peaches = $6.
2. Next, subtract the cost of the peaches from the amount of money Ines had initially in her purse to find the amount she has left. So, Ines has $20 - $6 = $14 left.
Answer: 14

Input: Aaron pays his actuary membership fees each year. The membership fee increases yearly by $10. If he pays $80 in the first year, how much does his membership cost, in dollars, in the sixth year?
Rationales: Aaron's membership fee increases by $10 each year. So we simply add $10 to the fee of the previous year to find the fee for the current year.
In the first year, the fee was $80.
Therefore, in the second year, the fee is $80 + $10 = $90.
In the third year, the fee is $90 + $10 = $100.
In the fourth year, the fee is $100 + $10 = $110.
In the fifth year, the fee is $110 + $10 = $120.
Finally in the sixth year, the fee is $120 + $10 = $130.
So the membership fee in the sixth year is $130.
Answer: 130

Input: Joseph invested $1000 into a hedge fund. The fund promised a yearly interest rate of 10%. If he deposited an additional $100 every month into the account to add to his initial investment of $1000, how much money will he have in the fund after two years?
Rationales: First, we need to determine how much money Joseph deposits in the fund over a year, not considering the interest. His initial deposit is $1000, and he then deposits $100 monthly for 12 months, resulting in a total of $1000 + ($100 * 12) = $2200. 

Second, we calculate the yearly interest applied to his total deposit. The fund gives a 10% yearly percentage rate (APR), so 10% of $2200 is $2200 * 0.10 = $220. We add that interest to the total amount, so he ends his first year with $2200 + $220 = $2420.

For the
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o8-tgsm8k-s42-rTrue
Loading extension module utils...
Time to load utils op: 0.9061098098754883 seconds
Loading extension module utils...
Time to load utils op: 0.8047976493835449 seconds
Evaluating commonsenseqa :   2%|▊                                                      | 1/63 [00:39<40:50, 39.52s/it]Evaluating commonsenseqa :   3%|█▋                                                     | 2/63 [01:17<39:30, 38.85s/it]Evaluating commonsenseqa :   5%|██▌                                                    | 3/63 [01:55<38:03, 38.06s/it]Evaluating commonsenseqa :   6%|███▍                                                   | 4/63 [02:32<37:05, 37.71s/it]Evaluating commonsenseqa :   8%|████▎                                                  | 5/63 [03:09<36:27, 37.71s/it]Evaluating commonsenseqa :  10%|█████▏                                                 | 6/63 [03:47<35:54, 37.80s/it]Evaluating commonsenseqa :  11%|██████                                                 | 7/63 [04:25<35:17, 37.81s/it]Evaluating commonsenseqa :  13%|██████▉                                                | 8/63 [05:03<34:46, 37.93s/it]Evaluating commonsenseqa :  14%|███████▊                                               | 9/63 [05:42<34:13, 38.02s/it]Evaluating commonsenseqa :  16%|████████▌                                             | 10/63 [06:20<33:44, 38.20s/it]Evaluating commonsenseqa :  17%|█████████▍                                            | 11/63 [06:59<33:17, 38.41s/it]Evaluating commonsenseqa :  19%|██████████▎                                           | 12/63 [07:38<32:46, 38.56s/it]Evaluating commonsenseqa :  21%|███████████▏                                          | 13/63 [08:16<32:05, 38.51s/it]Evaluating commonsenseqa :  22%|████████████                                          | 14/63 [08:55<31:28, 38.54s/it]Evaluating commonsenseqa :  24%|████████████▊                                         | 15/63 [09:34<30:52, 38.60s/it]Evaluating commonsenseqa :  25%|█████████████▋                                        | 16/63 [10:12<30:14, 38.60s/it]Evaluating commonsenseqa :  27%|██████████████▌                                       | 17/63 [10:51<29:33, 38.55s/it]Evaluating commonsenseqa :  29%|███████████████▍                                      | 18/63 [11:29<28:53, 38.53s/it]Evaluating commonsenseqa :  30%|████████████████▎                                     | 19/63 [12:07<28:09, 38.39s/it]Evaluating commonsenseqa :  32%|█████████████████▏                                    | 20/63 [12:45<27:24, 38.25s/it]Evaluating commonsenseqa :  33%|██████████████████                                    | 21/63 [13:24<26:47, 38.28s/it]Evaluating commonsenseqa :  35%|██████████████████▊                                   | 22/63 [14:02<26:16, 38.46s/it]Evaluating commonsenseqa :  37%|███████████████████▋                                  | 23/63 [14:40<25:26, 38.16s/it]Evaluating commonsenseqa :  38%|████████████████████▌                                 | 24/63 [15:18<24:44, 38.06s/it]Evaluating commonsenseqa :  40%|█████████████████████▍                                | 25/63 [15:56<24:04, 38.01s/it]Evaluating commonsenseqa :  41%|██████████████████████▎                               | 26/63 [16:34<23:26, 38.01s/it]Evaluating commonsenseqa :  43%|███████████████████████▏                              | 27/63 [17:13<22:57, 38.27s/it]Evaluating commonsenseqa :  44%|████████████████████████                              | 28/63 [17:50<22:10, 38.01s/it]Evaluating commonsenseqa :  46%|████████████████████████▊                             | 29/63 [18:28<21:28, 37.89s/it]Evaluating commonsenseqa :  48%|█████████████████████████▋                            | 30/63 [19:06<21:00, 38.19s/it]Evaluating commonsenseqa :  49%|██████████████████████████▌                           | 31/63 [19:44<20:19, 38.12s/it]Evaluating commonsenseqa :  51%|███████████████████████████▍                          | 32/63 [20:23<19:48, 38.34s/it]Evaluating commonsenseqa :  52%|████████████████████████████▎                         | 33/63 [21:01<19:08, 38.28s/it]Evaluating commonsenseqa :  54%|█████████████████████████████▏                        | 34/63 [21:40<18:30, 38.28s/it]Evaluating commonsenseqa :  56%|██████████████████████████████                        | 35/63 [22:18<17:54, 38.37s/it]Evaluating commonsenseqa :  57%|██████████████████████████████▊                       | 36/63 [22:57<17:21, 38.57s/it]Evaluating commonsenseqa :  59%|███████████████████████████████▋                      | 37/63 [23:36<16:44, 38.63s/it]Evaluating commonsenseqa :  60%|████████████████████████████████▌                     | 38/63 [24:14<16:01, 38.45s/it]Evaluating commonsenseqa :  62%|█████████████████████████████████▍                    | 39/63 [24:52<15:17, 38.24s/it]Evaluating commonsenseqa :  63%|██████████████████████████████████▎                   | 40/63 [25:30<14:41, 38.30s/it]Evaluating commonsenseqa :  65%|███████████████████████████████████▏                  | 41/63 [26:09<14:06, 38.48s/it]Evaluating commonsenseqa :  67%|████████████████████████████████████                  | 42/63 [26:47<13:22, 38.19s/it]Evaluating commonsenseqa :  68%|████████████████████████████████████▊                 | 43/63 [27:25<12:43, 38.18s/it]Evaluating commonsenseqa :  70%|█████████████████████████████████████▋                | 44/63 [28:03<12:06, 38.21s/it]Evaluating commonsenseqa :  71%|██████████████████████████████████████▌               | 45/63 [28:41<11:27, 38.21s/it]Evaluating commonsenseqa :  73%|███████████████████████████████████████▍              | 46/63 [29:20<10:54, 38.48s/it]Evaluating commonsenseqa :  75%|████████████████████████████████████████▎             | 47/63 [29:59<10:15, 38.46s/it]Evaluating commonsenseqa :  76%|█████████████████████████████████████████▏            | 48/63 [30:36<09:31, 38.13s/it]Evaluating commonsenseqa :  78%|██████████████████████████████████████████            | 49/63 [31:15<08:54, 38.17s/it]Evaluating commonsenseqa :  79%|██████████████████████████████████████████▊           | 50/63 [31:52<08:14, 38.01s/it]Evaluating commonsenseqa :  81%|███████████████████████████████████████████▋          | 51/63 [32:30<07:35, 37.98s/it]Evaluating commonsenseqa :  83%|████████████████████████████████████████████▌         | 52/63 [33:08<06:58, 38.01s/it]Evaluating commonsenseqa :  84%|█████████████████████████████████████████████▍        | 53/63 [33:46<06:19, 37.94s/it]Evaluating commonsenseqa :  86%|██████████████████████████████████████████████▎       | 54/63 [34:25<05:43, 38.21s/it]Evaluating commonsenseqa :  87%|███████████████████████████████████████████████▏      | 55/63 [35:03<05:05, 38.22s/it]Evaluating commonsenseqa :  89%|████████████████████████████████████████████████      | 56/63 [35:41<04:26, 38.03s/it]Evaluating commonsenseqa :  90%|████████████████████████████████████████████████▊     | 57/63 [36:18<03:47, 37.88s/it]Evaluating commonsenseqa :  92%|█████████████████████████████████████████████████▋    | 58/63 [36:57<03:10, 38.06s/it]Evaluating commonsenseqa :  94%|██████████████████████████████████████████████████▌   | 59/63 [37:34<02:31, 37.88s/it]Evaluating commonsenseqa :  95%|███████████████████████████████████████████████████▍  | 60/63 [38:13<01:54, 38.12s/it]Evaluating commonsenseqa :  97%|████████████████████████████████████████████████████▎ | 61/63 [38:51<01:16, 38.18s/it]Evaluating commonsenseqa :  98%|█████████████████████████████████████████████████████▏| 62/63 [39:30<00:38, 38.26s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████████| 63/63 [39:54<00:00, 34.19s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████████| 63/63 [39:54<00:00, 38.01s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 0.2598} | lm_loss 14.0416 | avg. gen lenth: 439.828
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name gsm8k --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 4 --seed 42 --data-dir /scratch/ylu130/processed_data/commonsenseqa/out-domain/o5-tgsm8k-s42-rFalse --num-out-domain 5
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[2023-08-08 21:18:17,148] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/out-domain/o5-tgsm8k-s42-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 5
  out_domain_data_name ......... gsm8k
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o5-tgsm8k-s42-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 4
  clip_grad .................... 1.0
  seed ......................... 42
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                        | 0/9741 [00:00<?, ?it/s]  1%|▌                                                                             | 76/9741 [00:00<00:12, 754.84it/s]  2%|█▏                                                                           | 157/9741 [00:00<00:12, 782.06it/s]  2%|█▊                                                                           | 236/9741 [00:00<00:12, 732.43it/s]  3%|██▌                                                                          | 322/9741 [00:00<00:12, 778.57it/s]  4%|███▏                                                                         | 407/9741 [00:00<00:11, 802.05it/s]  5%|███▊                                                                         | 490/9741 [00:00<00:11, 810.73it/s]  6%|████▌                                                                        | 572/9741 [00:00<00:11, 782.33it/s]  7%|█████▏                                                                       | 651/9741 [00:00<00:12, 745.68it/s]  7%|█████▋                                                                       | 727/9741 [00:00<00:12, 739.18it/s]  8%|██████▍                                                                      | 812/9741 [00:01<00:11, 769.77it/s]  9%|███████                                                                      | 896/9741 [00:01<00:11, 788.17it/s] 10%|███████▋                                                                     | 980/9741 [00:01<00:10, 802.65it/s] 11%|████████▎                                                                   | 1063/9741 [00:01<00:10, 808.67it/s] 12%|████████▉                                                                   | 1145/9741 [00:01<00:11, 747.94it/s] 13%|█████████▌                                                                  | 1227/9741 [00:01<00:11, 767.59it/s] 13%|██████████▏                                                                 | 1311/9741 [00:01<00:10, 787.23it/s] 14%|██████████▉                                                                 | 1394/9741 [00:01<00:10, 797.59it/s] 15%|███████████▌                                                                | 1477/9741 [00:01<00:10, 806.78it/s] 16%|████████████▏                                                               | 1559/9741 [00:01<00:10, 810.16it/s] 17%|████████████▊                                                               | 1641/9741 [00:02<00:10, 795.14it/s] 18%|█████████████▍                                                              | 1723/9741 [00:02<00:10, 799.62it/s] 19%|██████████████                                                              | 1804/9741 [00:02<00:10, 779.79it/s] 19%|██████████████▋                                                             | 1887/9741 [00:02<00:09, 793.93it/s] 20%|███████████████▎                                                            | 1970/9741 [00:02<00:09, 804.37it/s] 21%|████████████████                                                            | 2051/9741 [00:02<00:09, 797.54it/s] 22%|████████████████▋                                                           | 2131/9741 [00:02<00:09, 771.28it/s] 23%|█████████████████▎                                                          | 2213/9741 [00:02<00:09, 785.01it/s] 24%|█████████████████▉                                                          | 2295/9741 [00:02<00:09, 794.89it/s] 24%|██████████████████▌                                                         | 2377/9741 [00:03<00:09, 797.82it/s] 25%|███████████████████▏                                                        | 2457/9741 [00:03<00:09, 778.61it/s] 26%|███████████████████▊                                                        | 2536/9741 [00:03<00:09, 765.56it/s] 27%|████████████████████▍                                                       | 2613/9741 [00:03<00:09, 740.16it/s] 28%|█████████████████████                                                       | 2697/9741 [00:03<00:09, 766.77it/s] 29%|█████████████████████▋                                                      | 2778/9741 [00:03<00:08, 778.01it/s] 29%|██████████████████████▎                                                     | 2863/9741 [00:03<00:08, 797.18it/s] 30%|██████████████████████▉                                                     | 2943/9741 [00:03<00:08, 790.98it/s] 31%|███████████████████████▌                                                    | 3023/9741 [00:03<00:08, 764.67it/s] 32%|████████████████████████▏                                                   | 3100/9741 [00:04<00:09, 690.55it/s] 33%|████████████████████████▋                                                   | 3171/9741 [00:04<00:10, 621.03it/s] 33%|█████████████████████████▍                                                  | 3255/9741 [00:04<00:09, 676.96it/s] 34%|██████████████████████████                                                  | 3335/9741 [00:04<00:09, 708.04it/s] 35%|██████████████████████████▌                                                 | 3408/9741 [00:04<00:09, 680.69it/s] 36%|███████████████████████████▏                                                | 3484/9741 [00:04<00:08, 701.28it/s] 37%|███████████████████████████▊                                                | 3562/9741 [00:04<00:08, 720.75it/s] 37%|████████████████████████████▍                                               | 3643/9741 [00:04<00:08, 745.34it/s] 38%|█████████████████████████████                                               | 3725/9741 [00:04<00:07, 764.57it/s] 39%|█████████████████████████████▋                                              | 3803/9741 [00:04<00:07, 755.62it/s] 40%|██████████████████████████████▎                                             | 3880/9741 [00:05<00:08, 719.74it/s] 41%|██████████████████████████████▊                                             | 3955/9741 [00:05<00:07, 728.25it/s] 41%|███████████████████████████████▍                                            | 4036/9741 [00:05<00:07, 751.44it/s] 42%|████████████████████████████████▏                                           | 4118/9741 [00:05<00:07, 771.00it/s] 43%|████████████████████████████████▋                                           | 4196/9741 [00:05<00:07, 760.95it/s] 44%|█████████████████████████████████▎                                          | 4273/9741 [00:05<00:07, 755.69it/s] 45%|█████████████████████████████████▉                                          | 4349/9741 [00:05<00:07, 712.13it/s] 45%|██████████████████████████████████▌                                         | 4430/9741 [00:05<00:07, 737.23it/s] 46%|███████████████████████████████████▏                                        | 4508/9741 [00:05<00:07, 728.44it/s] 47%|███████████████████████████████████▉                                        | 4612/9741 [00:06<00:06, 815.69it/s] 48%|████████████████████████████████████▊                                       | 4719/9741 [00:06<00:05, 886.84it/s] 49%|█████████████████████████████████████▌                                      | 4809/9741 [00:06<00:07, 687.43it/s] 50%|██████████████████████████████████████▎                                     | 4903/9741 [00:06<00:06, 748.74it/s] 52%|███████████████████████████████████████▏                                    | 5021/9741 [00:06<00:05, 859.62it/s] 53%|████████████████████████████████████████                                    | 5130/9741 [00:06<00:05, 920.27it/s] 54%|████████████████████████████████████████▊                                   | 5233/9741 [00:06<00:04, 950.43it/s] 55%|█████████████████████████████████████████▌                                  | 5332/9741 [00:06<00:04, 916.81it/s] 56%|██████████████████████████████████████████▌                                 | 5450/9741 [00:06<00:04, 988.48it/s] 57%|██████████████████████████████████████████▉                                | 5571/9741 [00:07<00:03, 1048.85it/s] 58%|███████████████████████████████████████████▋                               | 5678/9741 [00:07<00:03, 1029.90it/s] 59%|█████████████████████████████████████████████                               | 5783/9741 [00:07<00:04, 829.88it/s] 60%|█████████████████████████████████████████████▊                              | 5874/9741 [00:07<00:04, 823.01it/s] 61%|██████████████████████████████████████████████▌                             | 5965/9741 [00:07<00:04, 843.26it/s] 62%|███████████████████████████████████████████████▏                            | 6054/9741 [00:07<00:04, 838.87it/s] 63%|███████████████████████████████████████████████▉                            | 6141/9741 [00:07<00:04, 844.26it/s] 64%|████████████████████████████████████████████████▌                           | 6229/9741 [00:07<00:04, 853.25it/s] 65%|█████████████████████████████████████████████████▎                          | 6316/9741 [00:07<00:04, 829.26it/s] 66%|█████████████████████████████████████████████████▉                          | 6405/9741 [00:08<00:03, 845.33it/s] 67%|██████████████████████████████████████████████████▋                         | 6491/9741 [00:08<00:03, 834.71it/s] 68%|███████████████████████████████████████████████████▎                        | 6576/9741 [00:08<00:03, 825.04it/s] 68%|███████████████████████████████████████████████████▉                        | 6663/9741 [00:08<00:03, 835.87it/s] 69%|████████████████████████████████████████████████████▋                       | 6747/9741 [00:08<00:03, 819.73it/s] 70%|█████████████████████████████████████████████████████▎                      | 6830/9741 [00:08<00:03, 817.73it/s] 71%|█████████████████████████████████████████████████████▉                      | 6915/9741 [00:08<00:03, 825.83it/s] 72%|██████████████████████████████████████████████████████▌                     | 7001/9741 [00:08<00:03, 834.03it/s] 73%|███████████████████████████████████████████████████████▎                    | 7089/9741 [00:08<00:03, 846.03it/s] 74%|████████████████████████████████████████████████████████                    | 7178/9741 [00:09<00:02, 858.76it/s] 75%|████████████████████████████████████████████████████████▋                   | 7264/9741 [00:09<00:03, 815.46it/s] 75%|█████████████████████████████████████████████████████████▎                  | 7351/9741 [00:09<00:02, 830.64it/s] 76%|██████████████████████████████████████████████████████████                  | 7435/9741 [00:09<00:02, 831.35it/s] 77%|██████████████████████████████████████████████████████████▋                 | 7519/9741 [00:09<00:02, 813.27it/s] 78%|███████████████████████████████████████████████████████████▎                | 7607/9741 [00:09<00:02, 832.58it/s] 79%|████████████████████████████████████████████████████████████                | 7691/9741 [00:09<00:02, 818.04it/s] 80%|████████████████████████████████████████████████████████████▋               | 7774/9741 [00:09<00:02, 810.93it/s] 81%|█████████████████████████████████████████████████████████████▎              | 7858/9741 [00:09<00:02, 816.76it/s] 82%|█████████████████████████████████████████████████████████████▉              | 7945/9741 [00:09<00:02, 830.19it/s] 82%|██████████████████████████████████████████████████████████████▋             | 8035/9741 [00:10<00:02, 850.52it/s] 83%|███████████████████████████████████████████████████████████████▎            | 8121/9741 [00:10<00:02, 805.67it/s] 84%|████████████████████████████████████████████████████████████████            | 8203/9741 [00:10<00:01, 769.12it/s] 85%|████████████████████████████████████████████████████████████████▋           | 8291/9741 [00:10<00:01, 798.68it/s] 86%|█████████████████████████████████████████████████████████████████▍          | 8380/9741 [00:10<00:01, 822.38it/s] 87%|██████████████████████████████████████████████████████████████████          | 8463/9741 [00:10<00:01, 823.70it/s] 88%|██████████████████████████████████████████████████████████████████▋         | 8550/9741 [00:10<00:01, 835.45it/s] 89%|███████████████████████████████████████████████████████████████████▎        | 8634/9741 [00:10<00:01, 827.73it/s] 89%|████████████████████████████████████████████████████████████████████        | 8717/9741 [00:10<00:01, 812.32it/s] 90%|████████████████████████████████████████████████████████████████████▋       | 8806/9741 [00:11<00:01, 834.52it/s] 91%|█████████████████████████████████████████████████████████████████████▎      | 8890/9741 [00:11<00:01, 831.74it/s] 92%|██████████████████████████████████████████████████████████████████████      | 8975/9741 [00:11<00:00, 835.19it/s] 93%|██████████████████████████████████████████████████████████████████████▋     | 9062/9741 [00:11<00:00, 842.78it/s] 94%|███████████████████████████████████████████████████████████████████████▎    | 9147/9741 [00:11<00:00, 835.61it/s] 95%|████████████████████████████████████████████████████████████████████████    | 9236/9741 [00:11<00:00, 851.52it/s] 96%|████████████████████████████████████████████████████████████████████████▋   | 9322/9741 [00:11<00:00, 838.30it/s] 97%|█████████████████████████████████████████████████████████████████████████▍  | 9411/9741 [00:11<00:00, 851.39it/s] 97%|██████████████████████████████████████████████████████████████████████████  | 9497/9741 [00:11<00:00, 829.40it/s] 98%|██████████████████████████████████████████████████████████████████████████▊ | 9581/9741 [00:11<00:00, 822.14it/s] 99%|███████████████████████████████████████████████████████████████████████████▍| 9664/9741 [00:12<00:00, 801.73it/s]100%|████████████████████████████████████████████████████████████████████████████| 9741/9741 [00:12<00:00, 802.24it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                                | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████████████▋                                     | 1/3 [00:06<00:13,  6.70s/it]Loading checkpoint shards:  33%|██████████████████▋                                     | 1/3 [00:06<00:12,  6.14s/it]Loading checkpoint shards:  33%|██████████████████▋                                     | 1/3 [00:06<00:12,  6.00s/it]Loading checkpoint shards:   0%|                                                                | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  67%|█████████████████████████████████████▎                  | 2/3 [00:12<00:06,  6.09s/it]Loading checkpoint shards:  67%|█████████████████████████████████████▎                  | 2/3 [00:12<00:06,  6.23s/it]Loading checkpoint shards:  67%|█████████████████████████████████████▎                  | 2/3 [00:13<00:06,  6.57s/it]Loading checkpoint shards:  33%|██████████████████▋                                     | 1/3 [00:07<00:15,  7.79s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:17<00:00,  5.71s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:17<00:00,  5.95s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:17<00:00,  5.57s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:17<00:00,  5.70s/it]
[2023-08-08 21:19:42,564] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:17<00:00,  5.63s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:17<00:00,  5.78s/it]
Loading checkpoint shards:  67%|█████████████████████████████████████▎                  | 2/3 [00:14<00:07,  7.33s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:19<00:00,  6.08s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:19<00:00,  6.46s/it]
[2023-08-08 21:20:06,855] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-08 21:20:06,857] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-08 21:20:06,859] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-08 21:20:06,859] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-08 21:20:06,859] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-08 21:20:06,859] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-08 21:20:06,860] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-08 21:20:06,860] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-08 21:20:06,860] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-08 21:20:06,861] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-08 21:20:06,861] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-08 21:20:06,861] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f7781d45e80>
[2023-08-08 21:20:06,861] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-08 21:20:06,861] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-08 21:20:06,861] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-08 21:20:06,861] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-08 21:20:06,861] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-08 21:20:06,861] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-08 21:20:06,861] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-08 21:20:06,861] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-08 21:20:06,861] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-08 21:20:06,861] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-08 21:20:06,861] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-08 21:20:06,861] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-08 21:20:06,861] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-08 21:20:06,861] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-08 21:20:06,861] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-08 21:20:06,861] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-08 21:20:06,861] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-08 21:20:06,862] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-08 21:20:06,862] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-08 21:20:06,862] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-08 21:20:06,862] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-08 21:20:06,862] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-08 21:20:06,862] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-08 21:20:06,862] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-08 21:20:06,862] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-08 21:20:06,862] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-08 21:20:06,862] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-08 21:20:06,862] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-08 21:20:06,862] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-08 21:20:06,862] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-08 21:20:06,862] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-08 21:20:06,863] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-08 21:20:06,863] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f7767102f10>
[2023-08-08 21:20:06,863] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-08 21:20:06,863] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-08 21:20:06,863] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-08 21:20:06,863] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-08 21:20:06,863] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-08 21:20:06,863] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-08 21:20:06,863] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-08 21:20:06,863] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-08 21:20:06,863] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-08 21:20:06,863] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-08 21:20:06,863] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-08 21:20:06,863] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-08 21:20:06,863] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-08 21:20:06,863] [INFO] [config.py:1012:print]   train_batch_size ............. 16
[2023-08-08 21:20:06,863] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  4
[2023-08-08 21:20:06,863] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-08 21:20:06,863] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-08 21:20:06,863] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-08 21:20:06,863] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-08 21:20:06,864] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-08 21:20:06,864] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-08 21:20:06,864] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-08 21:20:06,864] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 4, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.5683290958404541 seconds
Loading extension module utils...
Time to load utils op: 0.5041847229003906 seconds
Loading extension module utils...
Time to load utils op: 0.5050675868988037 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                                               | 0/63 [00:00<?, ?it/s]############### Example ###############
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following multiple choice question.

### Demonstration:
Input: For every 12 cans you recycle, you receive $0.50, and for every 5 kilograms of newspapers, you receive $1.50. If your family collected 144 cans and 20 kilograms of newspapers, how much money would you receive?
Answer: 12

Input: Betty picked 16 strawberries. Matthew picked 20 more strawberries than Betty and twice as many as Natalie. They used their strawberries to make jam. One jar of jam used 7 strawberries and they sold each jar at $4. How much money were they able to make from the strawberries they picked?
Answer: 40

Input: Jack has a stack of books that is 12 inches thick. He knows from experience that 80 pages is one inch thick. If he has 6 books, how many pages is each one on average?
Answer: 160

Input: James dumps his whole collection of 500 Legos on the floor and starts building a castle out of them.  He uses half the pieces before finishing and is told to put the rest away.  He puts all of the leftover pieces back in the box they came from, except for 5 missing pieces that he can't find.  How many Legos are in the box at the end?
Answer: 245

Input: Ines had $20 in her purse. She bought 3 pounds of peaches, which are $2 per pound at the local farmers’ market. How much did she have left?
Answer: 14

### Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid

### Response:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o5-tgsm8k-s42-rFalse
Loading extension module utils...
Time to load utils op: 0.5050327777862549 seconds
Evaluating commonsenseqa :   2%|▊                                                      | 1/63 [00:52<54:29, 52.73s/it]Evaluating commonsenseqa :   3%|█▋                                                     | 2/63 [01:42<51:35, 50.75s/it]Evaluating commonsenseqa :   5%|██▌                                                    | 3/63 [01:57<34:31, 34.52s/it]Evaluating commonsenseqa :   6%|███▍                                                   | 4/63 [02:40<37:13, 37.86s/it]Evaluating commonsenseqa :   8%|████▎                                                  | 5/63 [03:19<37:07, 38.41s/it]Evaluating commonsenseqa :  10%|█████▏                                                 | 6/63 [04:00<37:08, 39.10s/it]Evaluating commonsenseqa :  11%|██████                                                 | 7/63 [04:28<33:18, 35.69s/it]Evaluating commonsenseqa :  13%|██████▉                                                | 8/63 [05:20<37:22, 40.78s/it]Evaluating commonsenseqa :  14%|███████▊                                               | 9/63 [06:11<39:35, 44.00s/it]Evaluating commonsenseqa :  16%|████████▌                                             | 10/63 [07:01<40:37, 45.99s/it]Evaluating commonsenseqa :  17%|█████████▍                                            | 11/63 [07:49<40:08, 46.31s/it]Evaluating commonsenseqa :  19%|██████████▎                                           | 12/63 [08:38<40:03, 47.12s/it]Evaluating commonsenseqa :  21%|███████████▏                                          | 13/63 [09:26<39:31, 47.42s/it]Evaluating commonsenseqa :  22%|████████████                                          | 14/63 [10:14<38:53, 47.62s/it]Evaluating commonsenseqa :  24%|████████████▊                                         | 15/63 [10:47<34:36, 43.25s/it]Evaluating commonsenseqa :  25%|█████████████▋                                        | 16/63 [11:30<33:46, 43.13s/it]Evaluating commonsenseqa :  27%|██████████████▌                                       | 17/63 [11:38<25:09, 32.81s/it]Evaluating commonsenseqa :  29%|███████████████▍                                      | 18/63 [12:31<29:02, 38.72s/it]Evaluating commonsenseqa :  30%|████████████████▎                                     | 19/63 [13:19<30:27, 41.53s/it]Evaluating commonsenseqa :  32%|█████████████████▏                                    | 20/63 [14:06<30:54, 43.12s/it]Evaluating commonsenseqa :  33%|██████████████████                                    | 21/63 [14:56<31:34, 45.11s/it]Evaluating commonsenseqa :  35%|██████████████████▊                                   | 22/63 [15:38<30:11, 44.18s/it]Evaluating commonsenseqa :  37%|███████████████████▋                                  | 23/63 [16:28<30:37, 45.94s/it]Evaluating commonsenseqa :  38%|████████████████████▌                                 | 24/63 [17:16<30:19, 46.66s/it]Evaluating commonsenseqa :  40%|█████████████████████▍                                | 25/63 [17:54<27:51, 43.98s/it]Evaluating commonsenseqa :  41%|██████████████████████▎                               | 26/63 [18:33<26:13, 42.52s/it]Evaluating commonsenseqa :  43%|███████████████████████▏                              | 27/63 [19:21<26:28, 44.13s/it]Evaluating commonsenseqa :  44%|████████████████████████                              | 28/63 [20:01<25:08, 43.09s/it]Evaluating commonsenseqa :  46%|████████████████████████▊                             | 29/63 [20:51<25:31, 45.03s/it]Evaluating commonsenseqa :  48%|█████████████████████████▋                            | 30/63 [21:44<26:02, 47.36s/it]Evaluating commonsenseqa :  49%|██████████████████████████▌                           | 31/63 [22:04<20:56, 39.28s/it]Evaluating commonsenseqa :  51%|███████████████████████████▍                          | 32/63 [22:52<21:38, 41.89s/it]Evaluating commonsenseqa :  52%|████████████████████████████▎                         | 33/63 [23:41<22:01, 44.04s/it]Evaluating commonsenseqa :  54%|█████████████████████████████▏                        | 34/63 [24:29<21:48, 45.12s/it]Evaluating commonsenseqa :  56%|██████████████████████████████                        | 35/63 [24:42<16:36, 35.59s/it]Evaluating commonsenseqa :  57%|██████████████████████████████▊                       | 36/63 [25:33<18:03, 40.13s/it]Evaluating commonsenseqa :  59%|███████████████████████████████▋                      | 37/63 [26:26<19:02, 43.95s/it]Evaluating commonsenseqa :  60%|████████████████████████████████▌                     | 38/63 [26:36<14:05, 33.81s/it]Evaluating commonsenseqa :  62%|█████████████████████████████████▍                    | 39/63 [27:24<15:12, 38.01s/it]Evaluating commonsenseqa :  63%|██████████████████████████████████▎                   | 40/63 [27:50<13:13, 34.49s/it]Evaluating commonsenseqa :  65%|███████████████████████████████████▏                  | 41/63 [28:38<14:10, 38.64s/it]Evaluating commonsenseqa :  67%|████████████████████████████████████                  | 42/63 [29:20<13:51, 39.61s/it]Evaluating commonsenseqa :  68%|████████████████████████████████████▊                 | 43/63 [30:06<13:49, 41.48s/it]Evaluating commonsenseqa :  70%|█████████████████████████████████████▋                | 44/63 [30:54<13:45, 43.46s/it]Evaluating commonsenseqa :  71%|██████████████████████████████████████▌               | 45/63 [31:41<13:23, 44.62s/it]Evaluating commonsenseqa :  73%|███████████████████████████████████████▍              | 46/63 [32:30<12:59, 45.87s/it]Evaluating commonsenseqa :  75%|████████████████████████████████████████▎             | 47/63 [33:12<11:53, 44.62s/it]Evaluating commonsenseqa :  76%|█████████████████████████████████████████▏            | 48/63 [33:22<08:33, 34.22s/it]Evaluating commonsenseqa :  78%|██████████████████████████████████████████            | 49/63 [34:00<08:16, 35.46s/it]Evaluating commonsenseqa :  79%|██████████████████████████████████████████▊           | 50/63 [34:49<08:34, 39.59s/it]Evaluating commonsenseqa :  81%|███████████████████████████████████████████▋          | 51/63 [35:35<08:16, 41.39s/it]Evaluating commonsenseqa :  83%|████████████████████████████████████████████▌         | 52/63 [35:47<05:58, 32.63s/it]Evaluating commonsenseqa :  84%|█████████████████████████████████████████████▍        | 53/63 [36:35<06:12, 37.26s/it]Evaluating commonsenseqa :  86%|██████████████████████████████████████████████▎       | 54/63 [37:18<05:48, 38.74s/it]Evaluating commonsenseqa :  87%|███████████████████████████████████████████████▏      | 55/63 [37:28<04:02, 30.36s/it]Evaluating commonsenseqa :  89%|████████████████████████████████████████████████      | 56/63 [38:15<04:06, 35.15s/it]Evaluating commonsenseqa :  90%|████████████████████████████████████████████████▊     | 57/63 [39:03<03:55, 39.24s/it]Evaluating commonsenseqa :  92%|█████████████████████████████████████████████████▋    | 58/63 [39:50<03:27, 41.45s/it]Evaluating commonsenseqa :  94%|██████████████████████████████████████████████████▌   | 59/63 [40:34<02:48, 42.22s/it]Evaluating commonsenseqa :  95%|███████████████████████████████████████████████████▍  | 60/63 [41:23<02:12, 44.24s/it]Evaluating commonsenseqa :  97%|████████████████████████████████████████████████████▎ | 61/63 [42:10<01:30, 45.21s/it]Evaluating commonsenseqa :  98%|█████████████████████████████████████████████████████▏| 62/63 [42:51<00:43, 43.83s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████████| 63/63 [43:20<00:00, 39.45s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████████| 63/63 [43:20<00:00, 41.28s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 2.5629} | lm_loss 7.6725 | avg. gen lenth: 222.336
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name gsm8k --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 4 --seed 42 --data-dir /scratch/ylu130/processed_data/commonsenseqa/out-domain/o6-tgsm8k-s42-rFalse --num-out-domain 6
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-08 22:03:35,159] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/out-domain/o6-tgsm8k-s42-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 6
  out_domain_data_name ......... gsm8k
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o6-tgsm8k-s42-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 4
  clip_grad .................... 1.0
  seed ......................... 42
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                        | 0/9741 [00:00<?, ?it/s]  1%|▌                                                                             | 66/9741 [00:00<00:14, 652.50it/s]  1%|█                                                                            | 132/9741 [00:00<00:15, 609.45it/s]  2%|█▌                                                                           | 194/9741 [00:00<00:16, 594.60it/s]  3%|██                                                                           | 254/9741 [00:00<00:16, 585.00it/s]  3%|██▍                                                                          | 313/9741 [00:00<00:16, 571.12it/s]  4%|██▉                                                                          | 371/9741 [00:00<00:17, 545.68it/s]  5%|███▍                                                                         | 442/9741 [00:00<00:15, 594.15it/s]  5%|████                                                                         | 513/9741 [00:00<00:14, 628.07it/s]  6%|████▌                                                                        | 577/9741 [00:00<00:14, 627.86it/s]  7%|█████                                                                        | 641/9741 [00:01<00:16, 556.37it/s]  7%|█████▋                                                                       | 715/9741 [00:01<00:14, 606.49it/s]  8%|██████▏                                                                      | 787/9741 [00:01<00:14, 637.06it/s]  9%|██████▊                                                                      | 855/9741 [00:01<00:13, 649.24it/s]  9%|███████▎                                                                     | 921/9741 [00:01<00:14, 608.35it/s] 10%|███████▊                                                                     | 984/9741 [00:01<00:14, 598.02it/s] 11%|████████▎                                                                   | 1060/9741 [00:01<00:13, 640.93it/s] 12%|████████▊                                                                   | 1127/9741 [00:01<00:13, 648.09it/s] 12%|█████████▎                                                                  | 1196/9741 [00:01<00:12, 657.90it/s] 13%|█████████▊                                                                  | 1263/9741 [00:02<00:14, 580.15it/s] 14%|██████████▍                                                                 | 1337/9741 [00:02<00:13, 622.79it/s] 14%|██████████▉                                                                 | 1408/9741 [00:02<00:12, 646.64it/s] 15%|███████████▌                                                                | 1475/9741 [00:02<00:12, 652.33it/s] 16%|████████████                                                                | 1542/9741 [00:02<00:13, 604.23it/s] 16%|████████████▌                                                               | 1604/9741 [00:02<00:13, 603.09it/s] 17%|█████████████                                                               | 1680/9741 [00:02<00:12, 644.81it/s] 18%|█████████████▋                                                              | 1751/9741 [00:02<00:12, 661.54it/s] 19%|██████████████▏                                                             | 1818/9741 [00:02<00:12, 643.56it/s] 19%|██████████████▋                                                             | 1883/9741 [00:03<00:13, 568.91it/s] 20%|███████████████▎                                                            | 1958/9741 [00:03<00:12, 614.61it/s] 21%|███████████████▊                                                            | 2028/9741 [00:03<00:12, 637.07it/s] 21%|████████████████▎                                                           | 2094/9741 [00:03<00:12, 630.01it/s] 22%|████████████████▊                                                           | 2159/9741 [00:03<00:13, 571.04it/s] 23%|█████████████████▍                                                          | 2229/9741 [00:03<00:12, 604.18it/s] 24%|█████████████████▉                                                          | 2302/9741 [00:03<00:11, 636.64it/s] 24%|██████████████████▍                                                         | 2369/9741 [00:03<00:11, 643.65it/s] 25%|██████████████████▉                                                         | 2435/9741 [00:03<00:11, 646.40it/s] 26%|███████████████████▌                                                        | 2501/9741 [00:04<00:12, 583.49it/s] 26%|████████████████████                                                        | 2576/9741 [00:04<00:11, 627.96it/s] 27%|████████████████████▋                                                       | 2648/9741 [00:04<00:10, 652.06it/s] 28%|█████████████████████▏                                                      | 2715/9741 [00:04<00:10, 647.16it/s] 29%|█████████████████████▋                                                      | 2781/9741 [00:04<00:11, 618.93it/s] 29%|██████████████████████▎                                                     | 2856/9741 [00:04<00:10, 654.03it/s] 30%|██████████████████████▊                                                     | 2926/9741 [00:04<00:10, 664.87it/s] 31%|███████████████████████▎                                                    | 2994/9741 [00:04<00:10, 659.49it/s] 31%|███████████████████████▉                                                    | 3061/9741 [00:04<00:11, 585.65it/s] 32%|████████████████████████▌                                                   | 3155/9741 [00:05<00:09, 679.54it/s] 34%|█████████████████████████▍                                                  | 3264/9741 [00:05<00:08, 791.75it/s] 34%|██████████████████████████                                                  | 3346/9741 [00:05<00:08, 790.02it/s] 35%|██████████████████████████▋                                                 | 3427/9741 [00:05<00:08, 712.04it/s] 36%|███████████████████████████▌                                                | 3531/9741 [00:05<00:07, 799.04it/s] 37%|████████████████████████████▍                                               | 3641/9741 [00:05<00:06, 880.23it/s] 38%|█████████████████████████████                                               | 3732/9741 [00:05<00:06, 864.68it/s] 39%|█████████████████████████████▊                                              | 3821/9741 [00:05<00:07, 751.92it/s] 40%|██████████████████████████████▋                                             | 3933/9741 [00:05<00:06, 846.02it/s] 41%|███████████████████████████████▌                                            | 4038/9741 [00:06<00:06, 899.71it/s] 42%|████████████████████████████████▏                                           | 4132/9741 [00:06<00:06, 887.96it/s] 43%|████████████████████████████████▉                                           | 4224/9741 [00:06<00:07, 781.55it/s] 45%|█████████████████████████████████▊                                          | 4336/9741 [00:06<00:06, 868.14it/s] 45%|██████████████████████████████████▌                                         | 4430/9741 [00:06<00:05, 885.92it/s] 46%|███████████████████████████████████▎                                        | 4522/9741 [00:06<00:06, 789.39it/s] 47%|███████████████████████████████████▉                                        | 4605/9741 [00:06<00:06, 786.23it/s] 48%|████████████████████████████████████▊                                       | 4719/9741 [00:06<00:05, 878.46it/s] 49%|█████████████████████████████████████▌                                      | 4810/9741 [00:07<00:08, 582.40it/s] 50%|██████████████████████████████████████                                      | 4883/9741 [00:07<00:08, 586.58it/s] 51%|██████████████████████████████████████▋                                     | 4953/9741 [00:07<00:08, 590.68it/s] 52%|███████████████████████████████████████▎                                    | 5037/9741 [00:07<00:07, 648.34it/s] 53%|████████████████████████████████████████▏                                   | 5147/9741 [00:07<00:06, 760.04it/s] 54%|████████████████████████████████████████▊                                   | 5231/9741 [00:07<00:05, 757.39it/s] 55%|█████████████████████████████████████████▍                                  | 5312/9741 [00:07<00:05, 746.29it/s] 55%|██████████████████████████████████████████                                  | 5399/9741 [00:07<00:05, 777.63it/s] 56%|██████████████████████████████████████████▊                                 | 5480/9741 [00:08<00:05, 762.19it/s] 57%|███████████████████████████████████████████▎                                | 5559/9741 [00:08<00:05, 748.33it/s] 58%|███████████████████████████████████████████▉                                | 5636/9741 [00:08<00:05, 738.53it/s] 59%|████████████████████████████████████████████▌                               | 5711/9741 [00:08<00:05, 730.66it/s] 59%|█████████████████████████████████████████████▏                              | 5785/9741 [00:08<00:05, 725.65it/s] 60%|█████████████████████████████████████████████▋                              | 5858/9741 [00:08<00:05, 719.83it/s] 61%|██████████████████████████████████████████████▎                             | 5935/9741 [00:08<00:05, 732.67it/s] 62%|██████████████████████████████████████████████▉                             | 6009/9741 [00:08<00:05, 731.29it/s] 62%|███████████████████████████████████████████████▍                            | 6083/9741 [00:08<00:05, 723.51it/s] 63%|████████████████████████████████████████████████                            | 6156/9741 [00:08<00:04, 720.02it/s] 64%|████████████████████████████████████████████████▌                           | 6229/9741 [00:09<00:04, 717.66it/s] 65%|█████████████████████████████████████████████████▏                          | 6301/9741 [00:09<00:04, 715.40it/s] 65%|█████████████████████████████████████████████████▋                          | 6373/9741 [00:09<00:04, 714.11it/s] 66%|██████████████████████████████████████████████████▎                         | 6445/9741 [00:09<00:04, 681.90it/s] 67%|██████████████████████████████████████████████████▊                         | 6514/9741 [00:09<00:05, 643.46it/s] 68%|███████████████████████████████████████████████████▎                        | 6579/9741 [00:09<00:05, 597.86it/s] 68%|███████████████████████████████████████████████████▉                        | 6657/9741 [00:09<00:04, 645.49it/s] 69%|████████████████████████████████████████████████████▍                       | 6723/9741 [00:09<00:04, 636.65it/s] 70%|████████████████████████████████████████████████████▉                       | 6788/9741 [00:09<00:04, 619.86it/s] 70%|█████████████████████████████████████████████████████▍                      | 6851/9741 [00:10<00:04, 602.23it/s] 71%|█████████████████████████████████████████████████████▉                      | 6915/9741 [00:10<00:04, 610.91it/s] 72%|██████████████████████████████████████████████████████▌                     | 6992/9741 [00:10<00:04, 654.25it/s] 72%|███████████████████████████████████████████████████████                     | 7062/9741 [00:10<00:04, 666.98it/s] 73%|███████████████████████████████████████████████████████▋                    | 7130/9741 [00:10<00:03, 654.23it/s] 74%|████████████████████████████████████████████████████████▏                   | 7196/9741 [00:10<00:04, 624.60it/s] 75%|████████████████████████████████████████████████████████▋                   | 7273/9741 [00:10<00:03, 663.68it/s] 75%|█████████████████████████████████████████████████████████▎                  | 7346/9741 [00:10<00:03, 681.78it/s] 76%|█████████████████████████████████████████████████████████▊                  | 7415/9741 [00:10<00:03, 680.87it/s] 77%|██████████████████████████████████████████████████████████▍                 | 7484/9741 [00:11<00:03, 606.91it/s] 78%|██████████████████████████████████████████████████████████▉                 | 7561/9741 [00:11<00:03, 650.97it/s] 78%|███████████████████████████████████████████████████████████▌                | 7633/9741 [00:11<00:03, 669.73it/s] 79%|████████████████████████████████████████████████████████████                | 7702/9741 [00:11<00:03, 658.73it/s] 80%|████████████████████████████████████████████████████████████▌               | 7769/9741 [00:11<00:03, 618.29it/s] 81%|█████████████████████████████████████████████████████████████▏              | 7847/9741 [00:11<00:02, 660.49it/s] 81%|█████████████████████████████████████████████████████████████▊              | 7918/9741 [00:11<00:02, 673.79it/s] 82%|██████████████████████████████████████████████████████████████▎             | 7987/9741 [00:11<00:02, 671.86it/s] 83%|██████████████████████████████████████████████████████████████▊             | 8055/9741 [00:11<00:02, 621.20it/s] 83%|███████████████████████████████████████████████████████████████▍            | 8132/9741 [00:12<00:02, 661.76it/s] 84%|████████████████████████████████████████████████████████████████            | 8207/9741 [00:12<00:02, 685.87it/s] 85%|████████████████████████████████████████████████████████████████▌           | 8277/9741 [00:12<00:02, 675.13it/s] 86%|█████████████████████████████████████████████████████████████████           | 8346/9741 [00:12<00:02, 631.32it/s] 86%|█████████████████████████████████████████████████████████████████▋          | 8423/9741 [00:12<00:01, 667.43it/s] 87%|██████████████████████████████████████████████████████████████████▎         | 8497/9741 [00:12<00:01, 686.92it/s] 88%|██████████████████████████████████████████████████████████████████▊         | 8567/9741 [00:12<00:01, 690.47it/s] 89%|███████████████████████████████████████████████████████████████████▍        | 8637/9741 [00:12<00:01, 621.93it/s] 89%|███████████████████████████████████████████████████████████████████▉        | 8714/9741 [00:12<00:01, 661.00it/s] 90%|████████████████████████████████████████████████████████████████████▌       | 8786/9741 [00:13<00:01, 675.27it/s] 91%|█████████████████████████████████████████████████████████████████████       | 8855/9741 [00:13<00:01, 675.26it/s] 92%|█████████████████████████████████████████████████████████████████████▋      | 8924/9741 [00:13<00:01, 625.02it/s] 92%|██████████████████████████████████████████████████████████████████████▏     | 9001/9741 [00:13<00:01, 663.00it/s] 93%|██████████████████████████████████████████████████████████████████████▊     | 9073/9741 [00:13<00:00, 676.10it/s] 94%|███████████████████████████████████████████████████████████████████████▎    | 9142/9741 [00:13<00:00, 672.18it/s] 95%|███████████████████████████████████████████████████████████████████████▊    | 9210/9741 [00:13<00:00, 616.16it/s] 95%|████████████████████████████████████████████████████████████████████████▍   | 9291/9741 [00:13<00:00, 668.93it/s] 96%|█████████████████████████████████████████████████████████████████████████▎  | 9394/9741 [00:13<00:00, 769.23it/s] 97%|█████████████████████████████████████████████████████████████████████████▉  | 9480/9741 [00:13<00:00, 794.50it/s] 98%|██████████████████████████████████████████████████████████████████████████▌ | 9561/9741 [00:14<00:00, 729.93it/s] 99%|███████████████████████████████████████████████████████████████████████████▍| 9675/9741 [00:14<00:00, 842.14it/s]100%|████████████████████████████████████████████████████████████████████████████| 9741/9741 [00:14<00:00, 681.98it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                                | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████████████▋                                     | 1/3 [00:06<00:13,  6.93s/it]Loading checkpoint shards:  33%|██████████████████▋                                     | 1/3 [00:07<00:14,  7.09s/it]Loading checkpoint shards:  33%|██████████████████▋                                     | 1/3 [00:07<00:15,  7.53s/it]Loading checkpoint shards:  33%|██████████████████▋                                     | 1/3 [00:07<00:15,  7.63s/it]Loading checkpoint shards:  67%|█████████████████████████████████████▎                  | 2/3 [00:13<00:06,  6.95s/it]Loading checkpoint shards:  67%|█████████████████████████████████████▎                  | 2/3 [00:13<00:06,  6.96s/it]Loading checkpoint shards:  67%|█████████████████████████████████████▎                  | 2/3 [00:14<00:07,  7.16s/it]Loading checkpoint shards:  67%|█████████████████████████████████████▎                  | 2/3 [00:15<00:07,  7.61s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:18<00:00,  5.85s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:18<00:00,  6.16s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:18<00:00,  5.93s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:18<00:00,  6.20s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:19<00:00,  6.32s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:19<00:00,  6.59s/it]
[2023-08-08 22:04:56,828] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:21<00:00,  6.92s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:21<00:00,  7.10s/it]
[2023-08-08 22:05:06,608] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-08 22:05:06,610] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-08 22:05:06,610] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-08 22:05:06,610] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-08 22:05:06,610] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-08 22:05:06,610] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-08 22:05:06,611] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-08 22:05:06,611] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-08 22:05:06,611] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-08 22:05:06,611] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-08 22:05:06,611] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-08 22:05:06,611] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fb30221be80>
[2023-08-08 22:05:06,611] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-08 22:05:06,611] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-08 22:05:06,611] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-08 22:05:06,611] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-08 22:05:06,611] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-08 22:05:06,611] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-08 22:05:06,611] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-08 22:05:06,611] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-08 22:05:06,611] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-08 22:05:06,611] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-08 22:05:06,611] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-08 22:05:06,611] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-08 22:05:06,611] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-08 22:05:06,611] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-08 22:05:06,611] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-08 22:05:06,611] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-08 22:05:06,611] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-08 22:05:06,612] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-08 22:05:06,612] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-08 22:05:06,612] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-08 22:05:06,612] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-08 22:05:06,612] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-08 22:05:06,612] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-08 22:05:06,612] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-08 22:05:06,612] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-08 22:05:06,612] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-08 22:05:06,612] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-08 22:05:06,612] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-08 22:05:06,612] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-08 22:05:06,612] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-08 22:05:06,612] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-08 22:05:06,612] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-08 22:05:06,612] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7fb2d7304f10>
[2023-08-08 22:05:06,612] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-08 22:05:06,612] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-08 22:05:06,612] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-08 22:05:06,612] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-08 22:05:06,612] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-08 22:05:06,612] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-08 22:05:06,612] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-08 22:05:06,612] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-08 22:05:06,612] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-08 22:05:06,612] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-08 22:05:06,612] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-08 22:05:06,612] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-08 22:05:06,612] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-08 22:05:06,612] [INFO] [config.py:1012:print]   train_batch_size ............. 16
[2023-08-08 22:05:06,612] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  4
[2023-08-08 22:05:06,612] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-08 22:05:06,612] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-08 22:05:06,612] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-08 22:05:06,612] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-08 22:05:06,612] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-08 22:05:06,612] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-08 22:05:06,613] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-08 22:05:06,613] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 4, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.5074417591094971 seconds
Loading extension module utils...
Time to load utils op: 0.5047707557678223 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                                               | 0/63 [00:00<?, ?it/s]############### Example ###############
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following multiple choice question.

### Demonstration:
Input: For every 12 cans you recycle, you receive $0.50, and for every 5 kilograms of newspapers, you receive $1.50. If your family collected 144 cans and 20 kilograms of newspapers, how much money would you receive?
Answer: 12

Input: Betty picked 16 strawberries. Matthew picked 20 more strawberries than Betty and twice as many as Natalie. They used their strawberries to make jam. One jar of jam used 7 strawberries and they sold each jar at $4. How much money were they able to make from the strawberries they picked?
Answer: 40

Input: Jack has a stack of books that is 12 inches thick. He knows from experience that 80 pages is one inch thick. If he has 6 books, how many pages is each one on average?
Answer: 160

Input: James dumps his whole collection of 500 Legos on the floor and starts building a castle out of them.  He uses half the pieces before finishing and is told to put the rest away.  He puts all of the leftover pieces back in the box they came from, except for 5 missing pieces that he can't find.  How many Legos are in the box at the end?
Answer: 245

Input: Ines had $20 in her purse. She bought 3 pounds of peaches, which are $2 per pound at the local farmers’ market. How much did she have left?
Answer: 14

Input: Aaron pays his actuary membership fees each year. The membership fee increases yearly by $10. If he pays $80 in the first year, how much does his membership cost, in dollars, in the sixth year?
Answer: 130

### Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid

### Response:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o6-tgsm8k-s42-rFalse
Loading extension module utils...
Time to load utils op: 0.5036337375640869 seconds
Loading extension module utils...
Time to load utils op: 0.5040826797485352 seconds
Evaluating commonsenseqa :   2%|▊                                                      | 1/63 [00:48<50:06, 48.48s/it]Evaluating commonsenseqa :   3%|█▋                                                     | 2/63 [01:35<48:26, 47.65s/it]Evaluating commonsenseqa :   5%|██▌                                                    | 3/63 [01:45<30:28, 30.48s/it]Evaluating commonsenseqa :   6%|███▍                                                   | 4/63 [02:33<36:33, 37.17s/it]Evaluating commonsenseqa :   8%|████▎                                                  | 5/63 [03:18<38:57, 40.30s/it]Evaluating commonsenseqa :  10%|█████▏                                                 | 6/63 [03:50<35:27, 37.33s/it]Evaluating commonsenseqa :  11%|██████                                                 | 7/63 [04:37<37:45, 40.45s/it]Evaluating commonsenseqa :  13%|██████▉                                                | 8/63 [05:27<39:51, 43.49s/it]Evaluating commonsenseqa :  14%|███████▊                                               | 9/63 [05:47<32:28, 36.09s/it]Evaluating commonsenseqa :  16%|████████▌                                             | 10/63 [06:35<35:19, 40.00s/it]Evaluating commonsenseqa :  17%|█████████▍                                            | 11/63 [07:23<36:39, 42.31s/it]Evaluating commonsenseqa :  19%|██████████▎                                           | 12/63 [08:10<37:12, 43.78s/it]Evaluating commonsenseqa :  21%|███████████▏                                          | 13/63 [08:58<37:37, 45.15s/it]Evaluating commonsenseqa :  22%|████████████                                          | 14/63 [09:09<28:20, 34.70s/it]Evaluating commonsenseqa :  24%|████████████▊                                         | 15/63 [09:57<30:59, 38.75s/it]Evaluating commonsenseqa :  25%|█████████████▋                                        | 16/63 [10:07<23:33, 30.07s/it]Evaluating commonsenseqa :  27%|██████████████▌                                       | 17/63 [10:57<27:33, 35.94s/it]Evaluating commonsenseqa :  29%|███████████████▍                                      | 18/63 [11:44<29:36, 39.48s/it]Evaluating commonsenseqa :  30%|████████████████▎                                     | 19/63 [12:32<30:47, 41.99s/it]Evaluating commonsenseqa :  32%|█████████████████▏                                    | 20/63 [13:20<31:22, 43.78s/it]Evaluating commonsenseqa :  33%|██████████████████                                    | 21/63 [13:44<26:29, 37.85s/it]Evaluating commonsenseqa :  35%|██████████████████▊                                   | 22/63 [14:33<28:08, 41.19s/it]Evaluating commonsenseqa :  37%|███████████████████▋                                  | 23/63 [14:55<23:31, 35.28s/it]Evaluating commonsenseqa :  38%|████████████████████▌                                 | 24/63 [15:42<25:16, 38.88s/it]Evaluating commonsenseqa :  40%|█████████████████████▍                                | 25/63 [16:23<25:05, 39.61s/it]Evaluating commonsenseqa :  41%|██████████████████████▎                               | 26/63 [16:41<20:27, 33.18s/it]Evaluating commonsenseqa :  43%|███████████████████████▏                              | 27/63 [17:28<22:16, 37.13s/it]Evaluating commonsenseqa :  44%|████████████████████████                              | 28/63 [18:14<23:17, 39.93s/it]Evaluating commonsenseqa :  46%|████████████████████████▊                             | 29/63 [18:40<20:08, 35.55s/it]Evaluating commonsenseqa :  48%|█████████████████████████▋                            | 30/63 [19:29<21:54, 39.83s/it]Evaluating commonsenseqa :  49%|██████████████████████████▌                           | 31/63 [20:18<22:39, 42.48s/it]Evaluating commonsenseqa :  51%|███████████████████████████▍                          | 32/63 [21:06<22:49, 44.18s/it]Evaluating commonsenseqa :  52%|████████████████████████████▎                         | 33/63 [21:53<22:32, 45.08s/it]Evaluating commonsenseqa :  54%|█████████████████████████████▏                        | 34/63 [22:42<22:15, 46.04s/it]Evaluating commonsenseqa :  56%|██████████████████████████████                        | 35/63 [23:30<21:49, 46.77s/it]Evaluating commonsenseqa :  57%|██████████████████████████████▊                       | 36/63 [24:16<20:55, 46.49s/it]Evaluating commonsenseqa :  59%|███████████████████████████████▋                      | 37/63 [25:03<20:11, 46.61s/it]Evaluating commonsenseqa :  60%|████████████████████████████████▌                     | 38/63 [25:51<19:34, 46.98s/it]Evaluating commonsenseqa :  62%|█████████████████████████████████▍                    | 39/63 [26:38<18:47, 46.98s/it]Evaluating commonsenseqa :  63%|██████████████████████████████████▎                   | 40/63 [26:58<14:57, 39.04s/it]Evaluating commonsenseqa :  65%|███████████████████████████████████▏                  | 41/63 [27:45<15:13, 41.53s/it]Evaluating commonsenseqa :  67%|████████████████████████████████████                  | 42/63 [28:07<12:29, 35.67s/it]Evaluating commonsenseqa :  68%|████████████████████████████████████▊                 | 43/63 [28:54<12:59, 38.98s/it]Evaluating commonsenseqa :  70%|█████████████████████████████████████▋                | 44/63 [29:16<10:44, 33.94s/it]Evaluating commonsenseqa :  71%|██████████████████████████████████████▌               | 45/63 [30:03<11:18, 37.71s/it]Evaluating commonsenseqa :  73%|███████████████████████████████████████▍              | 46/63 [30:30<09:49, 34.68s/it]Evaluating commonsenseqa :  75%|████████████████████████████████████████▎             | 47/63 [31:18<10:18, 38.67s/it]Evaluating commonsenseqa :  76%|█████████████████████████████████████████▏            | 48/63 [31:51<09:13, 36.89s/it]Evaluating commonsenseqa :  78%|██████████████████████████████████████████            | 49/63 [32:20<08:00, 34.34s/it]Evaluating commonsenseqa :  79%|██████████████████████████████████████████▊           | 50/63 [32:46<06:54, 31.92s/it]Evaluating commonsenseqa :  81%|███████████████████████████████████████████▋          | 51/63 [33:30<07:07, 35.60s/it]Evaluating commonsenseqa :  83%|████████████████████████████████████████████▌         | 52/63 [34:20<07:18, 39.86s/it]Evaluating commonsenseqa :  84%|█████████████████████████████████████████████▍        | 53/63 [35:08<07:04, 42.41s/it]Evaluating commonsenseqa :  86%|██████████████████████████████████████████████▎       | 54/63 [35:56<06:36, 44.05s/it]Evaluating commonsenseqa :  87%|███████████████████████████████████████████████▏      | 55/63 [36:43<05:59, 44.95s/it]Evaluating commonsenseqa :  89%|████████████████████████████████████████████████      | 56/63 [37:30<05:18, 45.52s/it]Evaluating commonsenseqa :  90%|████████████████████████████████████████████████▊     | 57/63 [38:17<04:35, 45.94s/it]Evaluating commonsenseqa :  92%|█████████████████████████████████████████████████▋    | 58/63 [38:43<03:20, 40.14s/it]Evaluating commonsenseqa :  94%|██████████████████████████████████████████████████▌   | 59/63 [39:15<02:30, 37.57s/it]Evaluating commonsenseqa :  95%|███████████████████████████████████████████████████▍  | 60/63 [40:05<02:03, 41.30s/it]Evaluating commonsenseqa :  97%|████████████████████████████████████████████████████▎ | 61/63 [40:39<01:17, 38.95s/it]Evaluating commonsenseqa :  98%|█████████████████████████████████████████████████████▏| 62/63 [41:25<00:41, 41.34s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████████| 63/63 [41:48<00:00, 35.73s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████████| 63/63 [41:48<00:00, 39.82s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 3.3646} | lm_loss 7.6935 | avg. gen lenth: 208.968
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name gsm8k --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 4 --seed 42 --data-dir /scratch/ylu130/processed_data/commonsenseqa/out-domain/o7-tgsm8k-s42-rFalse --num-out-domain 7
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[nltk_data]   Package punkt is already up-to-date!
[2023-08-08 22:48:29,434] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/out-domain/o7-tgsm8k-s42-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 7
  out_domain_data_name ......... gsm8k
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o7-tgsm8k-s42-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 4
  clip_grad .................... 1.0
  seed ......................... 42
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                        | 0/9741 [00:00<?, ?it/s]  1%|▍                                                                             | 51/9741 [00:00<00:19, 504.89it/s]  1%|▊                                                                            | 102/9741 [00:00<00:21, 458.82it/s]  2%|█▎                                                                           | 162/9741 [00:00<00:18, 517.25it/s]  2%|█▊                                                                           | 225/9741 [00:00<00:17, 557.88it/s]  3%|██▎                                                                          | 287/9741 [00:00<00:16, 575.55it/s]  4%|██▋                                                                          | 345/9741 [00:00<00:17, 547.84it/s]  4%|███▏                                                                         | 401/9741 [00:00<00:17, 537.88it/s]  5%|███▌                                                                         | 456/9741 [00:00<00:18, 499.19it/s]  5%|████                                                                         | 519/9741 [00:00<00:17, 536.33it/s]  6%|████▌                                                                        | 583/9741 [00:01<00:16, 565.19it/s]  7%|█████                                                                        | 641/9741 [00:01<00:16, 566.12it/s]  7%|█████▌                                                                       | 702/9741 [00:01<00:15, 578.96it/s]  8%|██████                                                                       | 761/9741 [00:01<00:15, 574.29it/s]  8%|██████▍                                                                      | 819/9741 [00:01<00:15, 574.40it/s]  9%|██████▉                                                                      | 880/9741 [00:01<00:15, 583.21it/s] 10%|███████▍                                                                     | 939/9741 [00:01<00:15, 568.70it/s] 10%|███████▉                                                                     | 999/9741 [00:01<00:15, 577.76it/s] 11%|████████▎                                                                   | 1061/9741 [00:01<00:14, 590.01it/s] 12%|████████▊                                                                   | 1123/9741 [00:01<00:14, 598.37it/s] 12%|█████████▏                                                                  | 1183/9741 [00:02<00:14, 598.49it/s] 13%|█████████▋                                                                  | 1243/9741 [00:02<00:14, 588.40it/s] 13%|██████████▏                                                                 | 1306/9741 [00:02<00:14, 600.45it/s] 14%|██████████▋                                                                 | 1370/9741 [00:02<00:13, 609.80it/s] 15%|███████████▏                                                                | 1432/9741 [00:02<00:14, 588.13it/s] 15%|███████████▋                                                                | 1492/9741 [00:02<00:14, 567.32it/s] 16%|████████████                                                                | 1554/9741 [00:02<00:14, 581.83it/s] 17%|████████████▌                                                               | 1616/9741 [00:02<00:13, 591.24it/s] 17%|█████████████                                                               | 1678/9741 [00:02<00:13, 599.11it/s] 18%|█████████████▌                                                              | 1739/9741 [00:03<00:13, 585.54it/s] 18%|██████████████                                                              | 1798/9741 [00:03<00:14, 543.29it/s] 19%|██████████████▌                                                             | 1860/9741 [00:03<00:13, 563.54it/s] 20%|███████████████                                                             | 1923/9741 [00:03<00:13, 579.63it/s] 20%|███████████████▍                                                            | 1982/9741 [00:03<00:13, 566.78it/s] 21%|███████████████▉                                                            | 2040/9741 [00:03<00:14, 536.04it/s] 22%|████████████████▎                                                           | 2095/9741 [00:03<00:14, 518.36it/s] 22%|████████████████▊                                                           | 2153/9741 [00:03<00:14, 534.80it/s] 23%|█████████████████▎                                                          | 2211/9741 [00:03<00:13, 546.32it/s] 23%|█████████████████▋                                                          | 2270/9741 [00:04<00:13, 556.51it/s] 24%|██████████████████▏                                                         | 2326/9741 [00:04<00:13, 543.93it/s] 24%|██████████████████▌                                                         | 2381/9741 [00:04<00:13, 527.27it/s] 25%|██████████████████▉                                                         | 2434/9741 [00:04<00:16, 441.65it/s] 26%|███████████████████▍                                                        | 2488/9741 [00:04<00:15, 465.41it/s] 26%|███████████████████▊                                                        | 2547/9741 [00:04<00:14, 497.54it/s] 27%|████████████████████▎                                                       | 2607/9741 [00:04<00:13, 523.71it/s] 27%|████████████████████▊                                                       | 2666/9741 [00:04<00:13, 540.31it/s] 28%|█████████████████████▏                                                      | 2722/9741 [00:04<00:12, 543.95it/s] 29%|█████████████████████▋                                                      | 2782/9741 [00:05<00:12, 558.13it/s] 29%|██████████████████████▏                                                     | 2844/9741 [00:05<00:12, 574.31it/s] 30%|██████████████████████▋                                                     | 2908/9741 [00:05<00:11, 591.61it/s] 30%|███████████████████████▏                                                    | 2971/9741 [00:05<00:11, 601.40it/s] 31%|███████████████████████▋                                                    | 3034/9741 [00:05<00:10, 609.79it/s] 32%|████████████████████████▏                                                   | 3096/9741 [00:05<00:11, 592.81it/s] 32%|████████████████████████▋                                                   | 3158/9741 [00:05<00:10, 599.99it/s] 33%|█████████████████████████                                                   | 3220/9741 [00:05<00:10, 605.64it/s] 34%|█████████████████████████▌                                                  | 3281/9741 [00:05<00:11, 586.87it/s] 34%|██████████████████████████                                                  | 3340/9741 [00:05<00:11, 547.69it/s] 35%|██████████████████████████▍                                                 | 3396/9741 [00:06<00:12, 520.68it/s] 35%|██████████████████████████▉                                                 | 3457/9741 [00:06<00:11, 542.78it/s] 36%|███████████████████████████▍                                                | 3519/9741 [00:06<00:11, 562.98it/s] 37%|███████████████████████████▉                                                | 3576/9741 [00:06<00:11, 547.23it/s] 37%|████████████████████████████▎                                               | 3632/9741 [00:06<00:11, 542.72it/s] 38%|████████████████████████████▊                                               | 3687/9741 [00:06<00:12, 487.94it/s] 38%|█████████████████████████████▏                                              | 3737/9741 [00:06<00:12, 472.45it/s] 39%|█████████████████████████████▋                                              | 3800/9741 [00:06<00:11, 513.72it/s] 40%|██████████████████████████████                                              | 3856/9741 [00:06<00:11, 524.17it/s] 40%|██████████████████████████████▌                                             | 3911/9741 [00:07<00:11, 528.99it/s] 41%|██████████████████████████████▉                                             | 3969/9741 [00:07<00:10, 541.03it/s] 41%|███████████████████████████████▍                                            | 4027/9741 [00:07<00:10, 550.04it/s] 42%|███████████████████████████████▉                                            | 4089/9741 [00:07<00:09, 568.21it/s] 43%|████████████████████████████████▎                                           | 4147/9741 [00:07<00:09, 560.03it/s] 43%|████████████████████████████████▊                                           | 4204/9741 [00:07<00:10, 540.29it/s] 44%|█████████████████████████████████▏                                          | 4259/9741 [00:07<00:10, 541.76it/s] 44%|█████████████████████████████████▋                                          | 4314/9741 [00:07<00:10, 534.35it/s] 45%|██████████████████████████████████▏                                         | 4376/9741 [00:07<00:09, 556.51it/s] 46%|██████████████████████████████████▌                                         | 4435/9741 [00:08<00:09, 562.17it/s] 46%|███████████████████████████████████                                         | 4492/9741 [00:08<00:09, 535.29it/s] 47%|███████████████████████████████████▍                                        | 4546/9741 [00:08<00:11, 464.73it/s] 47%|███████████████████████████████████▊                                        | 4595/9741 [00:08<00:10, 467.90it/s] 48%|████████████████████████████████████▎                                       | 4652/9741 [00:08<00:10, 494.51it/s] 49%|████████████████████████████████████▉                                       | 4735/9741 [00:08<00:10, 464.35it/s] 49%|█████████████████████████████████████▍                                      | 4806/9741 [00:08<00:09, 522.63it/s] 50%|█████████████████████████████████████▉                                      | 4861/9741 [00:08<00:09, 516.78it/s] 50%|██████████████████████████████████████▎                                     | 4915/9741 [00:08<00:09, 521.54it/s] 51%|███████████████████████████████████████                                     | 5008/9741 [00:09<00:07, 632.31it/s] 52%|███████████████████████████████████████▋                                    | 5091/9741 [00:09<00:06, 685.43it/s] 53%|████████████████████████████████████████▎                                   | 5162/9741 [00:09<00:06, 688.52it/s] 54%|████████████████████████████████████████▊                                   | 5233/9741 [00:09<00:07, 565.95it/s] 54%|█████████████████████████████████████████▍                                  | 5307/9741 [00:09<00:07, 609.24it/s] 55%|██████████████████████████████████████████▏                                 | 5401/9741 [00:09<00:06, 696.06it/s] 56%|██████████████████████████████████████████▋                                 | 5475/9741 [00:09<00:06, 700.58it/s] 57%|███████████████████████████████████████████▎                                | 5556/9741 [00:09<00:05, 729.06it/s] 58%|███████████████████████████████████████████▉                                | 5632/9741 [00:09<00:05, 733.88it/s] 59%|████████████████████████████████████████████▌                               | 5712/9741 [00:10<00:05, 750.80it/s] 60%|█████████████████████████████████████████████▎                              | 5808/9741 [00:10<00:04, 810.65it/s] 60%|█████████████████████████████████████████████▉                              | 5891/9741 [00:10<00:04, 797.18it/s] 61%|██████████████████████████████████████████████▌                             | 5972/9741 [00:10<00:05, 714.35it/s] 62%|███████████████████████████████████████████████▏                            | 6046/9741 [00:10<00:05, 671.25it/s] 63%|███████████████████████████████████████████████▊                            | 6126/9741 [00:10<00:05, 703.90it/s] 64%|████████████████████████████████████████████████▍                           | 6216/9741 [00:10<00:04, 755.33it/s] 65%|█████████████████████████████████████████████████                           | 6294/9741 [00:10<00:04, 760.65it/s] 65%|█████████████████████████████████████████████████▋                          | 6375/9741 [00:10<00:04, 774.71it/s] 66%|██████████████████████████████████████████████████▎                         | 6454/9741 [00:11<00:04, 775.50it/s] 67%|███████████████████████████████████████████████████                         | 6542/9741 [00:11<00:03, 805.36it/s] 68%|███████████████████████████████████████████████████▋                        | 6628/9741 [00:11<00:03, 817.56it/s] 69%|████████████████████████████████████████████████████▎                       | 6711/9741 [00:11<00:03, 801.61it/s] 70%|████████████████████████████████████████████████████▉                       | 6792/9741 [00:11<00:03, 801.81it/s] 71%|█████████████████████████████████████████████████████▋                      | 6874/9741 [00:11<00:03, 807.06it/s] 71%|██████████████████████████████████████████████████████▎                     | 6964/9741 [00:11<00:03, 834.44it/s] 72%|██████████████████████████████████████████████████████▉                     | 7048/9741 [00:11<00:03, 819.06it/s] 73%|███████████████████████████████████████████████████████▋                    | 7131/9741 [00:11<00:03, 806.02it/s] 74%|████████████████████████████████████████████████████████▎                   | 7212/9741 [00:11<00:03, 804.50it/s] 75%|████████████████████████████████████████████████████████▉                   | 7295/9741 [00:12<00:03, 809.01it/s] 76%|█████████████████████████████████████████████████████████▋                  | 7392/9741 [00:12<00:02, 853.94it/s] 77%|██████████████████████████████████████████████████████████▎                 | 7478/9741 [00:12<00:02, 794.72it/s] 78%|██████████████████████████████████████████████████████████▉                 | 7560/9741 [00:12<00:02, 800.86it/s] 78%|███████████████████████████████████████████████████████████▋                | 7646/9741 [00:12<00:02, 815.11it/s] 79%|████████████████████████████████████████████████████████████▎               | 7734/9741 [00:12<00:02, 833.75it/s] 80%|█████████████████████████████████████████████████████████████               | 7834/9741 [00:12<00:02, 879.81it/s] 81%|█████████████████████████████████████████████████████████████▊              | 7923/9741 [00:12<00:02, 859.12it/s] 82%|██████████████████████████████████████████████████████████████▍             | 8010/9741 [00:12<00:02, 813.75it/s] 83%|███████████████████████████████████████████████████████████████▏            | 8093/9741 [00:13<00:02, 811.40it/s] 84%|███████████████████████████████████████████████████████████████▊            | 8183/9741 [00:13<00:01, 835.21it/s] 85%|████████████████████████████████████████████████████████████████▌           | 8279/9741 [00:13<00:01, 868.96it/s] 86%|█████████████████████████████████████████████████████████████████▎          | 8367/9741 [00:13<00:01, 838.34it/s] 87%|█████████████████████████████████████████████████████████████████▉          | 8452/9741 [00:13<00:01, 682.52it/s] 88%|██████████████████████████████████████████████████████████████████▌         | 8527/9741 [00:13<00:01, 697.89it/s] 89%|███████████████████████████████████████████████████████████████████▎        | 8622/9741 [00:13<00:01, 763.59it/s] 89%|███████████████████████████████████████████████████████████████████▉        | 8702/9741 [00:13<00:01, 769.66it/s] 90%|████████████████████████████████████████████████████████████████████▌       | 8782/9741 [00:13<00:01, 691.57it/s] 91%|█████████████████████████████████████████████████████████████████████       | 8855/9741 [00:14<00:01, 682.78it/s] 92%|█████████████████████████████████████████████████████████████████████▊      | 8944/9741 [00:14<00:01, 737.83it/s] 93%|██████████████████████████████████████████████████████████████████████▌     | 9042/9741 [00:14<00:00, 804.05it/s] 94%|███████████████████████████████████████████████████████████████████████▏    | 9125/9741 [00:14<00:00, 776.14it/s] 95%|███████████████████████████████████████████████████████████████████████▊    | 9206/9741 [00:14<00:00, 782.97it/s] 95%|████████████████████████████████████████████████████████████████████████▍   | 9286/9741 [00:14<00:00, 680.91it/s] 96%|█████████████████████████████████████████████████████████████████████████   | 9358/9741 [00:14<00:00, 683.73it/s] 97%|█████████████████████████████████████████████████████████████████████████▋  | 9452/9741 [00:14<00:00, 751.82it/s] 98%|██████████████████████████████████████████████████████████████████████████▎ | 9530/9741 [00:14<00:00, 750.92it/s] 99%|██████████████████████████████████████████████████████████████████████████▉ | 9612/9741 [00:15<00:00, 769.97it/s] 99%|███████████████████████████████████████████████████████████████████████████▌| 9691/9741 [00:15<00:00, 723.28it/s]100%|████████████████████████████████████████████████████████████████████████████| 9741/9741 [00:15<00:00, 637.82it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                                | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████████████▋                                     | 1/3 [00:05<00:11,  5.91s/it]Loading checkpoint shards:  33%|██████████████████▋                                     | 1/3 [00:06<00:13,  6.86s/it]Loading checkpoint shards:  33%|██████████████████▋                                     | 1/3 [00:07<00:14,  7.14s/it]Loading checkpoint shards:  67%|█████████████████████████████████████▎                  | 2/3 [00:11<00:05,  5.90s/it]Loading checkpoint shards:  33%|██████████████████▋                                     | 1/3 [00:08<00:16,  8.25s/it]Loading checkpoint shards:  67%|█████████████████████████████████████▎                  | 2/3 [00:14<00:07,  7.11s/it]Loading checkpoint shards:  67%|█████████████████████████████████████▎                  | 2/3 [00:14<00:07,  7.12s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:16<00:00,  5.50s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:16<00:00,  5.61s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:19<00:00,  6.34s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:19<00:00,  6.53s/it]
Loading checkpoint shards:  67%|█████████████████████████████████████▎                  | 2/3 [00:15<00:07,  7.76s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:19<00:00,  6.31s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:19<00:00,  6.53s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:21<00:00,  6.78s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:21<00:00,  7.09s/it]
[2023-08-08 22:50:02,586] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
[2023-08-08 22:50:12,149] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-08 22:50:12,150] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-08 22:50:12,150] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-08 22:50:12,150] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-08 22:50:12,150] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-08 22:50:12,151] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-08 22:50:12,151] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-08 22:50:12,151] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-08 22:50:12,151] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-08 22:50:12,151] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-08 22:50:12,151] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-08 22:50:12,151] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f555b5c8e80>
[2023-08-08 22:50:12,151] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-08 22:50:12,151] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-08 22:50:12,151] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-08 22:50:12,151] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-08 22:50:12,151] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-08 22:50:12,151] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-08 22:50:12,151] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-08 22:50:12,151] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-08 22:50:12,151] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-08 22:50:12,151] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-08 22:50:12,151] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-08 22:50:12,151] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-08 22:50:12,151] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-08 22:50:12,151] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-08 22:50:12,151] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-08 22:50:12,151] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-08 22:50:12,151] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-08 22:50:12,152] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-08 22:50:12,152] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-08 22:50:12,152] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-08 22:50:12,152] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-08 22:50:12,152] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-08 22:50:12,152] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-08 22:50:12,152] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-08 22:50:12,152] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-08 22:50:12,152] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-08 22:50:12,152] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-08 22:50:12,152] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-08 22:50:12,152] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-08 22:50:12,152] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-08 22:50:12,152] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-08 22:50:12,152] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-08 22:50:12,152] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f5580acff10>
[2023-08-08 22:50:12,152] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-08 22:50:12,152] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-08 22:50:12,152] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-08 22:50:12,152] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-08 22:50:12,152] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-08 22:50:12,152] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-08 22:50:12,152] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-08 22:50:12,152] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-08 22:50:12,152] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-08 22:50:12,152] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-08 22:50:12,152] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-08 22:50:12,152] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-08 22:50:12,152] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-08 22:50:12,152] [INFO] [config.py:1012:print]   train_batch_size ............. 16
[2023-08-08 22:50:12,152] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  4
[2023-08-08 22:50:12,152] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-08 22:50:12,152] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-08 22:50:12,152] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-08 22:50:12,152] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-08 22:50:12,152] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-08 22:50:12,152] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-08 22:50:12,152] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-08 22:50:12,152] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 4, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.6446805000305176 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                                               | 0/63 [00:00<?, ?it/s]############### Example ###############
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following multiple choice question.

### Demonstration:
Input: For every 12 cans you recycle, you receive $0.50, and for every 5 kilograms of newspapers, you receive $1.50. If your family collected 144 cans and 20 kilograms of newspapers, how much money would you receive?
Answer: 12

Input: Betty picked 16 strawberries. Matthew picked 20 more strawberries than Betty and twice as many as Natalie. They used their strawberries to make jam. One jar of jam used 7 strawberries and they sold each jar at $4. How much money were they able to make from the strawberries they picked?
Answer: 40

Input: Jack has a stack of books that is 12 inches thick. He knows from experience that 80 pages is one inch thick. If he has 6 books, how many pages is each one on average?
Answer: 160

Input: James dumps his whole collection of 500 Legos on the floor and starts building a castle out of them.  He uses half the pieces before finishing and is told to put the rest away.  He puts all of the leftover pieces back in the box they came from, except for 5 missing pieces that he can't find.  How many Legos are in the box at the end?
Answer: 245

Input: Ines had $20 in her purse. She bought 3 pounds of peaches, which are $2 per pound at the local farmers’ market. How much did she have left?
Answer: 14

Input: Aaron pays his actuary membership fees each year. The membership fee increases yearly by $10. If he pays $80 in the first year, how much does his membership cost, in dollars, in the sixth year?
Answer: 130

Input: Joseph invested $1000 into a hedge fund. The fund promised a yearly interest rate of 10%. If he deposited an additional $100 every month into the account to add to his initial investment of $1000, how much money will he have in the fund after two years?
Answer: 3982

### Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid

### Response:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o7-tgsm8k-s42-rFalse
Loading extension module utils...
Time to load utils op: 0.6037628650665283 seconds
Loading extension module utils...
Time to load utils op: 0.6037631034851074 seconds
Loading extension module utils...
Time to load utils op: 0.7056610584259033 seconds
Evaluating commonsenseqa :   2%|▊                                                      | 1/63 [00:49<51:16, 49.62s/it]Evaluating commonsenseqa :   3%|█▋                                                     | 2/63 [01:40<51:23, 50.54s/it]Evaluating commonsenseqa :   5%|██▌                                                    | 3/63 [01:48<30:46, 30.77s/it]Evaluating commonsenseqa :   6%|███▍                                                   | 4/63 [02:35<36:54, 37.54s/it]Evaluating commonsenseqa :   8%|████▎                                                  | 5/63 [03:02<32:23, 33.51s/it]Evaluating commonsenseqa :  10%|█████▏                                                 | 6/63 [03:51<36:44, 38.67s/it]Evaluating commonsenseqa :  11%|██████                                                 | 7/63 [04:39<39:02, 41.82s/it]Evaluating commonsenseqa :  13%|██████▉                                                | 8/63 [05:01<32:41, 35.67s/it]Evaluating commonsenseqa :  14%|███████▊                                               | 9/63 [05:51<35:54, 39.90s/it]Evaluating commonsenseqa :  16%|████████▌                                             | 10/63 [06:40<37:57, 42.96s/it]Evaluating commonsenseqa :  17%|█████████▍                                            | 11/63 [07:27<38:06, 43.97s/it]Evaluating commonsenseqa :  19%|██████████▎                                           | 12/63 [08:12<37:44, 44.41s/it]Evaluating commonsenseqa :  21%|███████████▏                                          | 13/63 [08:38<32:16, 38.72s/it]Evaluating commonsenseqa :  22%|████████████                                          | 14/63 [09:25<33:51, 41.46s/it]Evaluating commonsenseqa :  24%|████████████▊                                         | 15/63 [09:54<30:00, 37.52s/it]Evaluating commonsenseqa :  25%|█████████████▋                                        | 16/63 [10:08<23:57, 30.58s/it]Evaluating commonsenseqa :  27%|██████████████▌                                       | 17/63 [10:55<27:13, 35.52s/it]Evaluating commonsenseqa :  29%|███████████████▍                                      | 18/63 [11:44<29:39, 39.54s/it]Evaluating commonsenseqa :  30%|████████████████▎                                     | 19/63 [12:31<30:34, 41.70s/it]Evaluating commonsenseqa :  32%|█████████████████▏                                    | 20/63 [13:16<30:36, 42.70s/it]Evaluating commonsenseqa :  33%|██████████████████                                    | 21/63 [14:02<30:35, 43.70s/it]Evaluating commonsenseqa :  35%|██████████████████▊                                   | 22/63 [14:49<30:33, 44.71s/it]Evaluating commonsenseqa :  37%|███████████████████▋                                  | 23/63 [15:38<30:34, 45.86s/it]Evaluating commonsenseqa :  38%|████████████████████▌                                 | 24/63 [16:27<30:31, 46.96s/it]Evaluating commonsenseqa :  40%|█████████████████████▍                                | 25/63 [16:54<25:59, 41.05s/it]Evaluating commonsenseqa :  41%|██████████████████████▎                               | 26/63 [17:42<26:26, 42.88s/it]Evaluating commonsenseqa :  43%|███████████████████████▏                              | 27/63 [18:31<26:52, 44.78s/it]Evaluating commonsenseqa :  44%|████████████████████████                              | 28/63 [18:40<19:49, 33.98s/it]Evaluating commonsenseqa :  46%|████████████████████████▊                             | 29/63 [19:28<21:42, 38.30s/it]Evaluating commonsenseqa :  48%|█████████████████████████▋                            | 30/63 [19:50<18:19, 33.33s/it]Evaluating commonsenseqa :  49%|██████████████████████████▌                           | 31/63 [20:35<19:38, 36.83s/it]Evaluating commonsenseqa :  51%|███████████████████████████▍                          | 32/63 [21:21<20:31, 39.71s/it]Evaluating commonsenseqa :  52%|████████████████████████████▎                         | 33/63 [21:27<14:50, 29.67s/it]Evaluating commonsenseqa :  54%|█████████████████████████████▏                        | 34/63 [22:08<15:56, 32.99s/it]Evaluating commonsenseqa :  56%|██████████████████████████████                        | 35/63 [22:49<16:27, 35.28s/it]Evaluating commonsenseqa :  57%|██████████████████████████████▊                       | 36/63 [23:40<18:00, 40.03s/it]Evaluating commonsenseqa :  59%|███████████████████████████████▋                      | 37/63 [24:30<18:39, 43.08s/it]Evaluating commonsenseqa :  60%|████████████████████████████████▌                     | 38/63 [25:16<18:18, 43.96s/it]Evaluating commonsenseqa :  62%|█████████████████████████████████▍                    | 39/63 [26:03<17:56, 44.86s/it]Evaluating commonsenseqa :  63%|██████████████████████████████████▎                   | 40/63 [26:49<17:17, 45.11s/it]Evaluating commonsenseqa :  65%|███████████████████████████████████▏                  | 41/63 [27:35<16:40, 45.47s/it]Evaluating commonsenseqa :  67%|████████████████████████████████████                  | 42/63 [28:21<15:56, 45.55s/it]Evaluating commonsenseqa :  68%|████████████████████████████████████▊                 | 43/63 [28:58<14:21, 43.08s/it]Evaluating commonsenseqa :  70%|█████████████████████████████████████▋                | 44/63 [29:36<13:07, 41.43s/it]Evaluating commonsenseqa :  71%|██████████████████████████████████████▌               | 45/63 [29:51<10:03, 33.52s/it]Evaluating commonsenseqa :  73%|███████████████████████████████████████▍              | 46/63 [30:20<09:07, 32.21s/it]Evaluating commonsenseqa :  75%|████████████████████████████████████████▎             | 47/63 [30:48<08:15, 30.95s/it]Evaluating commonsenseqa :  76%|█████████████████████████████████████████▏            | 48/63 [31:01<06:23, 25.57s/it]Evaluating commonsenseqa :  78%|██████████████████████████████████████████            | 49/63 [31:51<07:42, 33.05s/it]Evaluating commonsenseqa :  79%|██████████████████████████████████████████▊           | 50/63 [32:39<08:07, 37.48s/it]Evaluating commonsenseqa :  81%|███████████████████████████████████████████▋          | 51/63 [33:29<08:13, 41.16s/it]Evaluating commonsenseqa :  83%|████████████████████████████████████████████▌         | 52/63 [34:17<07:55, 43.20s/it]Evaluating commonsenseqa :  84%|█████████████████████████████████████████████▍        | 53/63 [35:02<07:19, 43.91s/it]Evaluating commonsenseqa :  86%|██████████████████████████████████████████████▎       | 54/63 [35:50<06:45, 45.11s/it]Evaluating commonsenseqa :  87%|███████████████████████████████████████████████▏      | 55/63 [36:14<05:08, 38.57s/it]Evaluating commonsenseqa :  89%|████████████████████████████████████████████████      | 56/63 [36:59<04:44, 40.65s/it]Evaluating commonsenseqa :  90%|████████████████████████████████████████████████▊     | 57/63 [37:46<04:14, 42.47s/it]Evaluating commonsenseqa :  92%|█████████████████████████████████████████████████▋    | 58/63 [38:18<03:16, 39.26s/it]Evaluating commonsenseqa :  94%|██████████████████████████████████████████████████▌   | 59/63 [38:24<01:57, 29.44s/it]Evaluating commonsenseqa :  95%|███████████████████████████████████████████████████▍  | 60/63 [39:15<01:47, 35.92s/it]Evaluating commonsenseqa :  97%|████████████████████████████████████████████████████▎ | 61/63 [40:06<01:20, 40.46s/it]Evaluating commonsenseqa :  98%|█████████████████████████████████████████████████████▏| 62/63 [40:55<00:42, 42.83s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████████| 63/63 [41:06<00:00, 33.48s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████████| 63/63 [41:06<00:00, 39.15s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 3.1727} | lm_loss 7.7507 | avg. gen lenth: 215.888
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name gsm8k --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 4 --seed 42 --data-dir /scratch/ylu130/processed_data/commonsenseqa/out-domain/o8-tgsm8k-s42-rFalse --num-out-domain 8
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
using world size: 4
[nltk_data]   Package punkt is already up-to-date!
[2023-08-08 23:31:47,956] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/out-domain/o8-tgsm8k-s42-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 8
  out_domain_data_name ......... gsm8k
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o8-tgsm8k-s42-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 4
  clip_grad .................... 1.0
  seed ......................... 42
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                        | 0/9741 [00:00<?, ?it/s]  1%|▍                                                                             | 54/9741 [00:00<00:18, 536.86it/s]  1%|▊                                                                            | 108/9741 [00:00<00:18, 507.57it/s]  2%|█▎                                                                           | 159/9741 [00:00<00:19, 494.72it/s]  2%|█▋                                                                           | 209/9741 [00:00<00:19, 478.82it/s]  3%|██                                                                           | 266/9741 [00:00<00:18, 507.08it/s]  3%|██▌                                                                          | 317/9741 [00:00<00:18, 502.86it/s]  4%|██▉                                                                          | 372/9741 [00:00<00:18, 516.19it/s]  4%|███▎                                                                         | 424/9741 [00:00<00:19, 487.34it/s]  5%|███▋                                                                         | 474/9741 [00:00<00:19, 477.66it/s]  5%|████▏                                                                        | 522/9741 [00:01<00:19, 475.99it/s]  6%|████▌                                                                        | 576/9741 [00:01<00:18, 493.12it/s]  6%|████▉                                                                        | 628/9741 [00:01<00:18, 500.91it/s]  7%|█████▍                                                                       | 681/9741 [00:01<00:17, 507.41it/s]  8%|█████▊                                                                       | 732/9741 [00:01<00:18, 497.81it/s]  8%|██████▏                                                                      | 782/9741 [00:01<00:18, 487.11it/s]  9%|██████▌                                                                      | 831/9741 [00:01<00:20, 429.00it/s]  9%|██████▉                                                                      | 876/9741 [00:01<00:21, 409.69it/s] 10%|███████▍                                                                     | 933/9741 [00:01<00:19, 449.85it/s] 10%|███████▊                                                                     | 987/9741 [00:02<00:18, 472.28it/s] 11%|████████                                                                    | 1036/9741 [00:02<00:18, 471.63it/s] 11%|████████▍                                                                   | 1084/9741 [00:02<00:19, 450.11it/s] 12%|████████▊                                                                   | 1130/9741 [00:02<00:21, 410.03it/s] 12%|█████████▏                                                                  | 1172/9741 [00:02<00:20, 411.70it/s] 13%|█████████▌                                                                  | 1227/9741 [00:02<00:18, 449.47it/s] 13%|█████████▉                                                                  | 1281/9741 [00:02<00:17, 474.53it/s] 14%|██████████▍                                                                 | 1330/9741 [00:02<00:18, 467.05it/s] 14%|██████████▊                                                                 | 1383/9741 [00:02<00:17, 483.82it/s] 15%|███████████▏                                                                | 1434/9741 [00:03<00:16, 490.12it/s] 15%|███████████▋                                                                | 1490/9741 [00:03<00:16, 509.66it/s] 16%|████████████                                                                | 1545/9741 [00:03<00:15, 520.29it/s] 16%|████████████▍                                                               | 1598/9741 [00:03<00:15, 516.79it/s] 17%|████████████▊                                                               | 1650/9741 [00:03<00:16, 494.61it/s] 17%|█████████████▎                                                              | 1701/9741 [00:03<00:16, 498.89it/s] 18%|█████████████▋                                                              | 1752/9741 [00:03<00:16, 489.37it/s] 18%|██████████████                                                              | 1802/9741 [00:03<00:16, 477.30it/s] 19%|██████████████▍                                                             | 1853/9741 [00:03<00:16, 485.73it/s] 20%|██████████████▊                                                             | 1903/9741 [00:03<00:16, 487.62it/s] 20%|███████████████▏                                                            | 1952/9741 [00:04<00:16, 472.51it/s] 21%|███████████████▋                                                            | 2005/9741 [00:04<00:15, 487.22it/s] 21%|████████████████                                                            | 2055/9741 [00:04<00:15, 489.60it/s] 22%|████████████████▍                                                           | 2110/9741 [00:04<00:15, 506.06it/s] 22%|████████████████▉                                                           | 2165/9741 [00:04<00:14, 517.50it/s] 23%|█████████████████▎                                                          | 2217/9741 [00:04<00:14, 515.18it/s] 23%|█████████████████▋                                                          | 2269/9741 [00:04<00:15, 476.35it/s] 24%|██████████████████                                                          | 2318/9741 [00:04<00:17, 424.38it/s] 24%|██████████████████▌                                                         | 2372/9741 [00:04<00:16, 453.91it/s] 25%|██████████████████▉                                                         | 2426/9741 [00:05<00:15, 477.11it/s] 25%|███████████████████▎                                                        | 2476/9741 [00:05<00:15, 482.23it/s] 26%|███████████████████▋                                                        | 2526/9741 [00:05<00:15, 472.34it/s] 26%|████████████████████                                                        | 2579/9741 [00:05<00:14, 487.03it/s] 27%|████████████████████▌                                                       | 2630/9741 [00:05<00:14, 493.07it/s] 28%|████████████████████▉                                                       | 2686/9741 [00:05<00:13, 510.54it/s] 28%|█████████████████████▎                                                      | 2739/9741 [00:05<00:13, 513.23it/s] 29%|█████████████████████▊                                                      | 2791/9741 [00:05<00:13, 501.61it/s] 29%|██████████████████████▏                                                     | 2842/9741 [00:05<00:14, 488.86it/s] 30%|██████████████████████▌                                                     | 2894/9741 [00:06<00:13, 494.98it/s] 30%|███████████████████████                                                     | 2949/9741 [00:06<00:13, 509.13it/s] 31%|███████████████████████▍                                                    | 3003/9741 [00:06<00:13, 516.50it/s] 31%|███████████████████████▊                                                    | 3056/9741 [00:06<00:12, 517.95it/s] 32%|████████████████████████▏                                                   | 3108/9741 [00:06<00:12, 510.31it/s] 32%|████████████████████████▋                                                   | 3160/9741 [00:06<00:13, 504.42it/s] 33%|█████████████████████████                                                   | 3211/9741 [00:06<00:14, 458.60it/s] 33%|█████████████████████████▍                                                  | 3258/9741 [00:06<00:14, 449.88it/s] 34%|█████████████████████████▊                                                  | 3316/9741 [00:06<00:13, 484.76it/s] 35%|██████████████████████████▎                                                 | 3371/9741 [00:06<00:12, 502.59it/s] 35%|██████████████████████████▋                                                 | 3422/9741 [00:07<00:12, 504.71it/s] 36%|███████████████████████████                                                 | 3474/9741 [00:07<00:12, 507.15it/s] 36%|███████████████████████████▌                                                | 3530/9741 [00:07<00:11, 522.46it/s] 37%|███████████████████████████▉                                                | 3587/9741 [00:07<00:11, 536.43it/s] 37%|████████████████████████████▍                                               | 3644/9741 [00:07<00:11, 543.74it/s] 38%|████████████████████████████▊                                               | 3699/9741 [00:07<00:11, 541.78it/s] 39%|█████████████████████████████▎                                              | 3754/9741 [00:07<00:11, 527.65it/s] 39%|█████████████████████████████▋                                              | 3809/9741 [00:07<00:11, 533.82it/s] 40%|██████████████████████████████▏                                             | 3864/9741 [00:07<00:10, 537.18it/s] 40%|██████████████████████████████▌                                             | 3920/9741 [00:07<00:10, 542.07it/s] 41%|███████████████████████████████                                             | 3975/9741 [00:08<00:11, 514.48it/s] 41%|███████████████████████████████▍                                            | 4027/9741 [00:08<00:11, 493.09it/s] 42%|███████████████████████████████▊                                            | 4077/9741 [00:08<00:11, 493.11it/s] 42%|████████████████████████████████▏                                           | 4133/9741 [00:08<00:10, 511.19it/s] 43%|████████████████████████████████▋                                           | 4187/9741 [00:08<00:10, 518.24it/s] 44%|█████████████████████████████████                                           | 4240/9741 [00:08<00:10, 505.26it/s] 44%|█████████████████████████████████▍                                          | 4291/9741 [00:08<00:10, 499.56it/s] 45%|█████████████████████████████████▉                                          | 4342/9741 [00:08<00:10, 492.43it/s] 45%|██████████████████████████████████▎                                         | 4398/9741 [00:08<00:10, 509.98it/s] 46%|██████████████████████████████████▊                                         | 4454/9741 [00:09<00:10, 521.98it/s] 46%|███████████████████████████████████▏                                        | 4508/9741 [00:09<00:10, 479.04it/s] 47%|███████████████████████████████████▌                                        | 4557/9741 [00:09<00:10, 472.98it/s] 47%|███████████████████████████████████▉                                        | 4605/9741 [00:09<00:11, 444.86it/s] 48%|████████████████████████████████████▎                                       | 4651/9741 [00:09<00:11, 446.29it/s] 48%|████████████████████████████████████▋                                       | 4707/9741 [00:09<00:10, 476.51it/s] 49%|█████████████████████████████████████                                       | 4756/9741 [00:09<00:14, 345.21it/s] 49%|█████████████████████████████████████▌                                      | 4809/9741 [00:09<00:12, 385.86it/s] 50%|█████████████████████████████████████▉                                      | 4861/9741 [00:10<00:11, 417.66it/s] 50%|██████████████████████████████████████▎                                     | 4918/9741 [00:10<00:10, 456.64it/s] 51%|██████████████████████████████████████▊                                     | 4975/9741 [00:10<00:09, 484.81it/s] 52%|███████████████████████████████████████▏                                    | 5027/9741 [00:10<00:09, 485.43it/s] 52%|███████████████████████████████████████▌                                    | 5078/9741 [00:10<00:09, 491.26it/s] 53%|████████████████████████████████████████                                    | 5129/9741 [00:10<00:09, 488.91it/s] 53%|████████████████████████████████████████▍                                   | 5185/9741 [00:10<00:08, 507.02it/s] 54%|████████████████████████████████████████▉                                   | 5243/9741 [00:10<00:08, 525.59it/s] 54%|█████████████████████████████████████████▎                                  | 5297/9741 [00:10<00:08, 517.32it/s] 55%|█████████████████████████████████████████▋                                  | 5350/9741 [00:10<00:08, 509.66it/s] 55%|██████████████████████████████████████████▏                                 | 5402/9741 [00:11<00:08, 507.33it/s] 56%|██████████████████████████████████████████▌                                 | 5454/9741 [00:11<00:08, 510.54it/s] 57%|██████████████████████████████████████████▉                                 | 5511/9741 [00:11<00:08, 526.41it/s] 57%|███████████████████████████████████████████▍                                | 5569/9741 [00:11<00:07, 541.68it/s] 58%|███████████████████████████████████████████▉                                | 5624/9741 [00:11<00:07, 538.22it/s] 58%|████████████████████████████████████████████▎                               | 5678/9741 [00:11<00:07, 536.10it/s] 59%|████████████████████████████████████████████▋                               | 5732/9741 [00:11<00:07, 534.01it/s] 59%|█████████████████████████████████████████████▏                              | 5787/9741 [00:11<00:07, 536.90it/s] 60%|█████████████████████████████████████████████▌                              | 5844/9741 [00:11<00:07, 546.35it/s] 61%|██████████████████████████████████████████████                              | 5902/9741 [00:12<00:06, 553.96it/s] 61%|██████████████████████████████████████████████▍                             | 5958/9741 [00:12<00:06, 548.26it/s] 62%|██████████████████████████████████████████████▉                             | 6013/9741 [00:12<00:07, 520.17it/s] 62%|███████████████████████████████████████████████▎                            | 6066/9741 [00:12<00:07, 504.89it/s] 63%|███████████████████████████████████████████████▊                            | 6125/9741 [00:12<00:06, 526.42it/s] 63%|████████████████████████████████████████████████▏                           | 6178/9741 [00:12<00:06, 525.72it/s] 64%|████████████████████████████████████████████████▌                           | 6231/9741 [00:12<00:06, 521.32it/s] 65%|█████████████████████████████████████████████████                           | 6285/9741 [00:12<00:06, 523.53it/s] 65%|█████████████████████████████████████████████████▍                          | 6341/9741 [00:12<00:06, 532.64it/s] 66%|██████████████████████████████████████████████████                          | 6419/9741 [00:12<00:05, 605.26it/s] 67%|██████████████████████████████████████████████████▋                         | 6501/9741 [00:13<00:04, 668.16it/s] 67%|███████████████████████████████████████████████████▎                        | 6572/9741 [00:13<00:04, 678.08it/s] 68%|███████████████████████████████████████████████████▊                        | 6647/9741 [00:13<00:04, 696.74it/s] 69%|████████████████████████████████████████████████████▍                       | 6717/9741 [00:13<00:04, 662.66it/s] 70%|████████████████████████████████████████████████████▉                       | 6784/9741 [00:13<00:04, 614.90it/s] 70%|█████████████████████████████████████████████████████▍                      | 6847/9741 [00:13<00:04, 604.22it/s] 71%|█████████████████████████████████████████████████████▉                      | 6908/9741 [00:13<00:04, 578.75it/s] 72%|██████████████████████████████████████████████████████▎                     | 6967/9741 [00:13<00:05, 493.64it/s] 72%|██████████████████████████████████████████████████████▊                     | 7019/9741 [00:14<00:05, 487.64it/s] 73%|███████████████████████████████████████████████████████▏                    | 7078/9741 [00:14<00:05, 512.39it/s] 73%|███████████████████████████████████████████████████████▋                    | 7131/9741 [00:14<00:05, 516.99it/s] 74%|████████████████████████████████████████████████████████                    | 7185/9741 [00:14<00:04, 521.91it/s] 74%|████████████████████████████████████████████████████████▌                   | 7242/9741 [00:14<00:04, 535.28it/s] 75%|████████████████████████████████████████████████████████▉                   | 7297/9741 [00:14<00:04, 538.83it/s] 76%|█████████████████████████████████████████████████████████▍                  | 7355/9741 [00:14<00:04, 547.76it/s] 76%|█████████████████████████████████████████████████████████▊                  | 7411/9741 [00:14<00:04, 534.27it/s] 77%|██████████████████████████████████████████████████████████▏                 | 7465/9741 [00:14<00:04, 499.47it/s] 77%|██████████████████████████████████████████████████████████▋                 | 7522/9741 [00:14<00:04, 518.01it/s] 78%|███████████████████████████████████████████████████████████                 | 7578/9741 [00:15<00:04, 529.48it/s] 78%|███████████████████████████████████████████████████████████▌                | 7632/9741 [00:15<00:04, 516.88it/s] 79%|███████████████████████████████████████████████████████████▉                | 7689/9741 [00:15<00:03, 529.94it/s] 80%|████████████████████████████████████████████████████████████▍               | 7748/9741 [00:15<00:03, 543.22it/s] 80%|████████████████████████████████████████████████████████████▉               | 7808/9741 [00:15<00:03, 557.44it/s] 81%|█████████████████████████████████████████████████████████████▎              | 7864/9741 [00:15<00:03, 544.70it/s] 81%|█████████████████████████████████████████████████████████████▊              | 7919/9741 [00:15<00:03, 526.39it/s] 82%|██████████████████████████████████████████████████████████████▏             | 7973/9741 [00:15<00:03, 529.51it/s] 82%|██████████████████████████████████████████████████████████████▋             | 8031/9741 [00:15<00:03, 542.56it/s] 83%|███████████████████████████████████████████████████████████████             | 8090/9741 [00:15<00:02, 554.66it/s] 84%|███████████████████████████████████████████████████████████████▌            | 8146/9741 [00:16<00:02, 543.85it/s] 84%|███████████████████████████████████████████████████████████████▉            | 8201/9741 [00:16<00:02, 541.24it/s] 85%|████████████████████████████████████████████████████████████████▍           | 8256/9741 [00:16<00:02, 536.44it/s] 85%|████████████████████████████████████████████████████████████████▊           | 8312/9741 [00:16<00:02, 541.98it/s] 86%|█████████████████████████████████████████████████████████████████▎          | 8370/9741 [00:16<00:02, 553.03it/s] 87%|█████████████████████████████████████████████████████████████████▋          | 8426/9741 [00:16<00:02, 546.00it/s] 87%|██████████████████████████████████████████████████████████████████▏         | 8481/9741 [00:16<00:02, 545.15it/s] 88%|██████████████████████████████████████████████████████████████████▌         | 8536/9741 [00:16<00:02, 541.07it/s] 88%|███████████████████████████████████████████████████████████████████         | 8591/9741 [00:16<00:02, 537.17it/s] 89%|███████████████████████████████████████████████████████████████████▍        | 8649/9741 [00:17<00:01, 548.64it/s] 89%|███████████████████████████████████████████████████████████████████▉        | 8704/9741 [00:17<00:01, 536.81it/s] 90%|████████████████████████████████████████████████████████████████████▎       | 8762/9741 [00:17<00:01, 547.56it/s] 91%|████████████████████████████████████████████████████████████████████▊       | 8819/9741 [00:17<00:01, 551.85it/s] 91%|█████████████████████████████████████████████████████████████████████▏      | 8875/9741 [00:17<00:01, 537.52it/s] 92%|█████████████████████████████████████████████████████████████████████▋      | 8929/9741 [00:17<00:01, 532.37it/s] 92%|██████████████████████████████████████████████████████████████████████      | 8985/9741 [00:17<00:01, 538.66it/s] 93%|██████████████████████████████████████████████████████████████████████▌     | 9043/9741 [00:17<00:01, 549.19it/s] 93%|███████████████████████████████████████████████████████████████████████     | 9102/9741 [00:17<00:01, 561.10it/s] 94%|███████████████████████████████████████████████████████████████████████▍    | 9159/9741 [00:17<00:01, 548.99it/s] 95%|███████████████████████████████████████████████████████████████████████▉    | 9215/9741 [00:18<00:00, 550.56it/s] 95%|████████████████████████████████████████████████████████████████████████▎   | 9273/9741 [00:18<00:00, 558.63it/s] 96%|████████████████████████████████████████████████████████████████████████▊   | 9332/9741 [00:18<00:00, 565.17it/s] 96%|█████████████████████████████████████████████████████████████████████████▎  | 9390/9741 [00:18<00:00, 568.92it/s] 97%|█████████████████████████████████████████████████████████████████████████▋  | 9447/9741 [00:18<00:00, 555.80it/s] 98%|██████████████████████████████████████████████████████████████████████████▏ | 9503/9741 [00:18<00:00, 541.19it/s] 98%|██████████████████████████████████████████████████████████████████████████▌ | 9561/9741 [00:18<00:00, 551.73it/s] 99%|███████████████████████████████████████████████████████████████████████████ | 9620/9741 [00:18<00:00, 561.81it/s] 99%|███████████████████████████████████████████████████████████████████████████▌| 9677/9741 [00:18<00:00, 558.95it/s]100%|███████████████████████████████████████████████████████████████████████████▉| 9733/9741 [00:18<00:00, 556.89it/s]100%|████████████████████████████████████████████████████████████████████████████| 9741/9741 [00:18<00:00, 512.83it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                                | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████████████▋                                     | 1/3 [00:05<00:11,  5.90s/it]Loading checkpoint shards:   0%|                                                                | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████████████▋                                     | 1/3 [00:06<00:13,  6.93s/it]Loading checkpoint shards:  33%|██████████████████▋                                     | 1/3 [00:06<00:13,  6.91s/it]Loading checkpoint shards:  67%|█████████████████████████████████████▎                  | 2/3 [00:12<00:06,  6.32s/it]Loading checkpoint shards:  33%|██████████████████▋                                     | 1/3 [00:07<00:15,  7.74s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:17<00:00,  5.49s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:17<00:00,  5.67s/it]
Loading checkpoint shards:  67%|█████████████████████████████████████▎                  | 2/3 [00:14<00:07,  7.28s/it]Loading checkpoint shards:  67%|█████████████████████████████████████▎                  | 2/3 [00:14<00:07,  7.37s/it]Loading checkpoint shards:  67%|█████████████████████████████████████▎                  | 2/3 [00:16<00:08,  8.15s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:20<00:00,  6.65s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:20<00:00,  6.79s/it]
[2023-08-08 23:33:24,615] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:20<00:00,  6.67s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:20<00:00,  6.82s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:22<00:00,  7.18s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████| 3/3 [00:22<00:00,  7.40s/it]
[2023-08-08 23:33:41,037] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-08 23:33:41,039] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-08 23:33:41,041] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-08 23:33:41,041] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-08 23:33:41,041] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-08 23:33:41,041] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-08 23:33:41,042] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-08 23:33:41,042] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-08 23:33:41,042] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-08 23:33:41,042] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-08 23:33:41,042] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-08 23:33:41,042] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fc3ccc1ce80>
[2023-08-08 23:33:41,042] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-08 23:33:41,042] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-08 23:33:41,042] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-08 23:33:41,042] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-08 23:33:41,042] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-08 23:33:41,042] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-08 23:33:41,042] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-08 23:33:41,042] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-08 23:33:41,042] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-08 23:33:41,043] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-08 23:33:41,043] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-08 23:33:41,043] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-08 23:33:41,043] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-08 23:33:41,043] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-08 23:33:41,043] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-08 23:33:41,043] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-08 23:33:41,043] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-08 23:33:41,043] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-08 23:33:41,043] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-08 23:33:41,043] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-08 23:33:41,043] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-08 23:33:41,043] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-08 23:33:41,043] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-08 23:33:41,043] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-08 23:33:41,043] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-08 23:33:41,043] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-08 23:33:41,043] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-08 23:33:41,043] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-08 23:33:41,043] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-08 23:33:41,044] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-08 23:33:41,044] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-08 23:33:41,044] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-08 23:33:41,044] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7fc3c5cb0f10>
[2023-08-08 23:33:41,044] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-08 23:33:41,044] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-08 23:33:41,044] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-08 23:33:41,044] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-08 23:33:41,044] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-08 23:33:41,044] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-08 23:33:41,044] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-08 23:33:41,044] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-08 23:33:41,044] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-08 23:33:41,044] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-08 23:33:41,044] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-08 23:33:41,044] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-08 23:33:41,044] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-08 23:33:41,044] [INFO] [config.py:1012:print]   train_batch_size ............. 16
[2023-08-08 23:33:41,044] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  4
[2023-08-08 23:33:41,044] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-08 23:33:41,044] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-08 23:33:41,044] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-08 23:33:41,044] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-08 23:33:41,045] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-08 23:33:41,045] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-08 23:33:41,045] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-08 23:33:41,045] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 4, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.5944247245788574 seconds
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.6068601608276367 seconds
Time to load utils op: 0.6065049171447754 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Loading extension module utils...
Time to load utils op: 0.6068189144134521 seconds
Evaluating commonsenseqa :   0%|                                                               | 0/63 [00:00<?, ?it/s]############### Example ###############
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following multiple choice question.

### Demonstration:
Input: For every 12 cans you recycle, you receive $0.50, and for every 5 kilograms of newspapers, you receive $1.50. If your family collected 144 cans and 20 kilograms of newspapers, how much money would you receive?
Answer: 12

Input: Betty picked 16 strawberries. Matthew picked 20 more strawberries than Betty and twice as many as Natalie. They used their strawberries to make jam. One jar of jam used 7 strawberries and they sold each jar at $4. How much money were they able to make from the strawberries they picked?
Answer: 40

Input: Jack has a stack of books that is 12 inches thick. He knows from experience that 80 pages is one inch thick. If he has 6 books, how many pages is each one on average?
Answer: 160

Input: James dumps his whole collection of 500 Legos on the floor and starts building a castle out of them.  He uses half the pieces before finishing and is told to put the rest away.  He puts all of the leftover pieces back in the box they came from, except for 5 missing pieces that he can't find.  How many Legos are in the box at the end?
Answer: 245

Input: Ines had $20 in her purse. She bought 3 pounds of peaches, which are $2 per pound at the local farmers’ market. How much did she have left?
Answer: 14

Input: Aaron pays his actuary membership fees each year. The membership fee increases yearly by $10. If he pays $80 in the first year, how much does his membership cost, in dollars, in the sixth year?
Answer: 130

Input: Joseph invested $1000 into a hedge fund. The fund promised a yearly interest rate of 10%. If he deposited an additional $100 every month into the account to add to his initial investment of $1000, how much money will he have in the fund after two years?
Answer: 3982

Input: The price of buying a wooden toy at the new Craftee And Best store is $20, and the cost of buying a hat is $10. If Kendra went to the shop with a $100 bill and bought two wooden toys and three hats, calculate the change she received.
Answer: 30

### Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid

### Response:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o8-tgsm8k-s42-rFalse
Evaluating commonsenseqa :   2%|▊                                                      | 1/63 [00:48<50:16, 48.65s/it]Evaluating commonsenseqa :   3%|█▋                                                     | 2/63 [01:23<41:19, 40.65s/it]Evaluating commonsenseqa :   5%|██▌                                                    | 3/63 [02:11<43:57, 43.96s/it]Evaluating commonsenseqa :   6%|███▍                                                   | 4/63 [02:55<43:14, 43.98s/it]Evaluating commonsenseqa :   8%|████▎                                                  | 5/63 [03:39<42:31, 43.99s/it]Evaluating commonsenseqa :  10%|█████▏                                                 | 6/63 [03:57<33:12, 34.95s/it]Evaluating commonsenseqa :  11%|██████                                                 | 7/63 [04:15<27:27, 29.42s/it]Evaluating commonsenseqa :  13%|██████▉                                                | 8/63 [04:49<28:31, 31.12s/it]Evaluating commonsenseqa :  14%|███████▊                                               | 9/63 [05:35<32:03, 35.61s/it]Evaluating commonsenseqa :  16%|████████▌                                             | 10/63 [06:22<34:36, 39.19s/it]Evaluating commonsenseqa :  17%|█████████▍                                            | 11/63 [06:46<29:56, 34.56s/it]Evaluating commonsenseqa :  19%|██████████▎                                           | 12/63 [07:32<32:22, 38.09s/it]Evaluating commonsenseqa :  21%|███████████▏                                          | 13/63 [07:56<28:10, 33.82s/it]Evaluating commonsenseqa :  22%|████████████                                          | 14/63 [08:40<30:04, 36.83s/it]Evaluating commonsenseqa :  24%|████████████▊                                         | 15/63 [09:20<30:08, 37.67s/it]Evaluating commonsenseqa :  25%|█████████████▋                                        | 16/63 [09:42<25:57, 33.15s/it]Evaluating commonsenseqa :  27%|██████████████▌                                       | 17/63 [10:29<28:33, 37.26s/it]Evaluating commonsenseqa :  29%|███████████████▍                                      | 18/63 [11:15<29:47, 39.73s/it]Evaluating commonsenseqa :  30%|████████████████▎                                     | 19/63 [12:00<30:18, 41.34s/it]Evaluating commonsenseqa :  32%|█████████████████▏                                    | 20/63 [12:21<25:14, 35.22s/it]Evaluating commonsenseqa :  33%|██████████████████                                    | 21/63 [13:06<26:49, 38.32s/it]Evaluating commonsenseqa :  35%|██████████████████▊                                   | 22/63 [13:40<25:17, 37.00s/it]Evaluating commonsenseqa :  37%|███████████████████▋                                  | 23/63 [14:23<25:52, 38.82s/it]Evaluating commonsenseqa :  38%|████████████████████▌                                 | 24/63 [15:07<26:14, 40.36s/it]Evaluating commonsenseqa :  40%|█████████████████████▍                                | 25/63 [15:47<25:26, 40.17s/it]Evaluating commonsenseqa :  41%|██████████████████████▎                               | 26/63 [16:33<25:54, 42.01s/it]Evaluating commonsenseqa :  43%|███████████████████████▏                              | 27/63 [17:20<26:05, 43.48s/it]Evaluating commonsenseqa :  44%|████████████████████████                              | 28/63 [17:37<20:38, 35.40s/it]Evaluating commonsenseqa :  46%|████████████████████████▊                             | 29/63 [18:11<19:56, 35.19s/it]Evaluating commonsenseqa :  48%|█████████████████████████▋                            | 30/63 [18:57<21:02, 38.26s/it]Evaluating commonsenseqa :  49%|██████████████████████████▌                           | 31/63 [19:42<21:34, 40.44s/it]Evaluating commonsenseqa :  51%|███████████████████████████▍                          | 32/63 [20:28<21:40, 41.94s/it]Evaluating commonsenseqa :  52%|████████████████████████████▎                         | 33/63 [21:13<21:26, 42.87s/it]Evaluating commonsenseqa :  54%|█████████████████████████████▏                        | 34/63 [21:57<20:58, 43.39s/it]Evaluating commonsenseqa :  56%|██████████████████████████████                        | 35/63 [22:40<20:09, 43.19s/it]Evaluating commonsenseqa :  57%|██████████████████████████████▊                       | 36/63 [23:26<19:50, 44.08s/it]Evaluating commonsenseqa :  59%|███████████████████████████████▋                      | 37/63 [24:12<19:18, 44.57s/it]Evaluating commonsenseqa :  60%|████████████████████████████████▌                     | 38/63 [24:57<18:37, 44.69s/it]Evaluating commonsenseqa :  62%|█████████████████████████████████▍                    | 39/63 [25:36<17:11, 42.97s/it]Evaluating commonsenseqa :  63%|██████████████████████████████████▎                   | 40/63 [26:06<15:02, 39.22s/it]Evaluating commonsenseqa :  65%|███████████████████████████████████▏                  | 41/63 [26:50<14:50, 40.46s/it]Evaluating commonsenseqa :  67%|████████████████████████████████████                  | 42/63 [27:31<14:16, 40.78s/it]Evaluating commonsenseqa :  68%|████████████████████████████████████▊                 | 43/63 [28:20<14:25, 43.27s/it]Evaluating commonsenseqa :  70%|█████████████████████████████████████▋                | 44/63 [29:07<13:58, 44.16s/it]Evaluating commonsenseqa :  71%|██████████████████████████████████████▌               | 45/63 [29:24<10:48, 36.01s/it]Evaluating commonsenseqa :  73%|███████████████████████████████████████▍              | 46/63 [30:09<10:59, 38.80s/it]Evaluating commonsenseqa :  75%|████████████████████████████████████████▎             | 47/63 [30:54<10:50, 40.66s/it]Evaluating commonsenseqa :  76%|█████████████████████████████████████████▏            | 48/63 [31:41<10:38, 42.54s/it]Evaluating commonsenseqa :  78%|██████████████████████████████████████████            | 49/63 [32:28<10:13, 43.85s/it]Evaluating commonsenseqa :  79%|██████████████████████████████████████████▊           | 50/63 [32:57<08:33, 39.53s/it]Evaluating commonsenseqa :  81%|███████████████████████████████████████████▋          | 51/63 [33:39<08:01, 40.13s/it]Evaluating commonsenseqa :  83%|████████████████████████████████████████████▌         | 52/63 [34:00<06:21, 34.64s/it]Evaluating commonsenseqa :  84%|█████████████████████████████████████████████▍        | 53/63 [34:46<06:19, 37.94s/it]Evaluating commonsenseqa :  86%|██████████████████████████████████████████████▎       | 54/63 [35:26<05:47, 38.56s/it]Evaluating commonsenseqa :  87%|███████████████████████████████████████████████▏      | 55/63 [36:11<05:24, 40.61s/it]Evaluating commonsenseqa :  89%|████████████████████████████████████████████████      | 56/63 [36:59<04:59, 42.72s/it]Evaluating commonsenseqa :  90%|████████████████████████████████████████████████▊     | 57/63 [37:44<04:20, 43.41s/it]Evaluating commonsenseqa :  92%|█████████████████████████████████████████████████▋    | 58/63 [38:28<03:38, 43.67s/it]Evaluating commonsenseqa :  94%|██████████████████████████████████████████████████▌   | 59/63 [39:14<02:57, 44.36s/it]Evaluating commonsenseqa :  95%|███████████████████████████████████████████████████▍  | 60/63 [40:00<02:14, 44.82s/it]Evaluating commonsenseqa :  97%|████████████████████████████████████████████████████▎ | 61/63 [40:23<01:16, 38.33s/it]Evaluating commonsenseqa :  98%|█████████████████████████████████████████████████████▏| 62/63 [41:02<00:38, 38.40s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████████| 63/63 [41:18<00:00, 31.59s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████████| 63/63 [41:18<00:00, 39.34s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 3.5432} | lm_loss 7.7967 | avg. gen lenth: 231.864
PYTHONPATH=/home/ylu130/workspace/in-context-generalization
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name gsm8k --save /home/ylu130/workspace/in-context-generalization/results --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --seed 42 --data-dir /scratch/ylu130/processed_data/commonsenseqa/out-domain/o6-tgsm8k-s42-rTrue --rationales --num-out-domain 6
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-09 18:17:01,337] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/out-domain/o6-tgsm8k-s42-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 6
  out_domain_data_name ......... gsm8k
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o6-tgsm8k-s42-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... False
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 42
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                        | 0/9741 [00:00<?, ?it/s]  0%|▏                                                                             | 21/9741 [00:00<00:46, 208.28it/s]  0%|▎                                                                             | 43/9741 [00:00<00:46, 209.93it/s]  1%|▌                                                                             | 65/9741 [00:00<00:46, 210.16it/s]  1%|▋                                                                             | 87/9741 [00:00<00:47, 203.29it/s]  1%|▊                                                                            | 108/9741 [00:00<00:46, 205.52it/s]  1%|█                                                                            | 129/9741 [00:00<00:46, 206.56it/s]  2%|█▏                                                                           | 150/9741 [00:00<00:46, 207.28it/s]  2%|█▎                                                                           | 171/9741 [00:00<00:46, 208.04it/s]  2%|█▌                                                                           | 192/9741 [00:00<00:45, 208.14it/s]  2%|█▋                                                                           | 213/9741 [00:01<00:46, 206.05it/s]  2%|█▊                                                                           | 234/9741 [00:01<00:45, 206.83it/s]  3%|██                                                                           | 255/9741 [00:01<00:45, 207.57it/s]  3%|██▏                                                                          | 276/9741 [00:01<00:45, 208.14it/s]  3%|██▎                                                                          | 298/9741 [00:01<00:45, 209.39it/s]  3%|██▌                                                                          | 319/9741 [00:01<00:45, 206.68it/s]  3%|██▋                                                                          | 340/9741 [00:01<00:45, 207.42it/s]  4%|██▊                                                                          | 362/9741 [00:01<00:44, 208.59it/s]  4%|███                                                                          | 383/9741 [00:01<00:44, 208.99it/s]  4%|███▏                                                                         | 406/9741 [00:01<00:43, 212.52it/s]  4%|███▍                                                                         | 428/9741 [00:02<00:43, 213.33it/s]  5%|███▌                                                                         | 451/9741 [00:02<00:42, 216.67it/s]  5%|███▋                                                                         | 474/9741 [00:02<00:42, 218.96it/s]  5%|███▉                                                                         | 497/9741 [00:02<00:41, 220.70it/s]  5%|████                                                                         | 520/9741 [00:02<00:41, 221.91it/s]  6%|████▎                                                                        | 543/9741 [00:02<00:41, 222.81it/s]  6%|████▍                                                                        | 566/9741 [00:02<00:41, 223.15it/s]  6%|████▋                                                                        | 589/9741 [00:02<00:40, 223.70it/s]  6%|████▊                                                                        | 612/9741 [00:02<00:40, 223.91it/s]  7%|█████                                                                        | 635/9741 [00:02<00:40, 224.13it/s]  7%|█████▏                                                                       | 658/9741 [00:03<00:40, 222.77it/s]  7%|█████▍                                                                       | 681/9741 [00:03<00:40, 223.23it/s]  7%|█████▌                                                                       | 704/9741 [00:03<00:40, 223.47it/s]  7%|█████▋                                                                       | 727/9741 [00:03<00:40, 223.60it/s]  8%|█████▉                                                                       | 754/9741 [00:03<00:38, 235.25it/s]  8%|██████▏                                                                      | 788/9741 [00:03<00:33, 265.78it/s]  8%|██████▌                                                                      | 823/974PYTHONPATH=/home/ylu130/workspace/in-context-generalization
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name gsm8k --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --seed 42 --data-dir /scratch/ylu130/processed_data/commonsenseqa/out-domain/o8-tgsm8k-s42-rFalse --num-out-domain 8
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-10 16:27:03,273] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/out-domain/o8-tgsm8k-s42-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 8
  out_domain_data_name ......... gsm8k
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o8-tgsm8k-s42-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 42
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                                                               | 0/9741 [00:00<?, ?it/s]  1%|▋                                                                                                                    | 55/9741 [00:00<00:17, 541.85it/s]  1%|█▎                                                                                                                  | 111/9741 [00:00<00:17, 548.25it/s]  2%|█▉                                                                                                                  | 167/9741 [00:00<00:17, 550.65it/s]  2%|██▋                                                                                                                 | 223/9741 [00:00<00:17, 545.82it/s]  3%|███▎                                                                                                                | 279/9741 [00:00<00:17, 547.55it/s]  3%|███▉                                                                                                                | 334/9741 [00:00<00:17, 547.32it/s]  4%|████▋                                                                                                               | 389/9741 [00:00<00:17, 539.53it/s]  5%|█████▎                                                                                                              | 443/9741 [00:00<00:17, 536.03it/s]  5%|█████▉                                                                                                              | 498/9741 [00:00<00:17, 539.32it/s]  6%|██████▌                                                                                                             | 553/9741 [00:01<00:16, 541.81it/s]  6%|███████▏                                                                                                            | 608/9741 [00:01<00:16, 543.19it/s]  7%|███████▉                                                                                                            | 663/9741 [00:01<00:16, 539.42it/s]  7%|████████▌                                                                                                           | 718/9741 [00:01<00:16, 540.43it/s]  8%|█████████▏                                                                                                          | 773/9741 [00:01<00:16, 542.77it/s]  9%|█████████▊                                                                                                          | 828/9741 [00:01<00:16, 543.86it/s]  9%|██████████▌                                                                                                         | 883/9741 [00:01<00:16, 541.89it/s] 10%|███████████▏                                                                                                        | 938/9741 [00:01<00:16, 542.95it/s] 10%|███████████▊                                                                                                        | 993/9741 [00:01<00:16, 539.82it/s] 11%|████████████▎                                                                                                      | 1048/9741 [00:01<00:16, 542.58it/s] 11%|█████████████                                                                                                      | 1106/9741 [00:02<00:15, 552.16it/s] 12%|█████████████▋                                                                                                     | 1164/9741 [00:02<00:15, 557.62it/s] 13%|██████████████▍                                                                                                    | 1222/9741 [00:02<00:15, 563.92it/s] 13%|███████████████                                                                                                    | 1280/9741 [00:02<00:14, 568.25it/s] 14%|███████████████▊                                                                                                   | 1338/9741 [00:02<00:14, 568.98it/s] 14%|████████████████▍                                                                                                  | 1395/9741 [00:02<00:14, 568.26it/s] 15%|█████████████████▏                                                                                                 | 1452/9741 [00:02<00:14, 568.29it/s] 16%|█████████████████▊                                                                                                 | 1510/9741 [00:02<00:14, 571.24it/s] 16%|██████████████████▌                                                                                                | 1568/9741 [00:02<00:14, 572.27it/s] 17%|███████████████████▏                                                                                               | 1626/9741 [00:02<00:14, 574.03it/s] 17%|███████████████████▉                                                                                               | 1685/9741 [00:03<00:13, 575.92it/s] 18%|████████████████████▌                                                                                              | 1744/9741 [00:03<00:13, 577.47it/s] 18%|█████████████████████▎                                                                                             | 1802/9741 [00:03<00:14, 552.58it/s] 19%|█████████████████████▉                                                                                             | 1859/9741 [00:03<00:14, 556.90it/s] 20%|██████████████████████▋                                                                                            | 1917/9741 [00:03<00:13, 562.03it/s] 20%|███████████████████████▎                                                                                           | 1975/9741 [00:03<00:13, 566.52it/s] 21%|███████████████████████▉                                                                                           | 2032/9741 [00:03<00:13, 567.30it/s] 21%|████████████████████████▋                                                                                          | 2090/9741 [00:03<00:13, 569.18it/s] 22%|█████████████████████████▎                                                                                         | 2148/9741 [00:03<00:13, 571.12it/s] 23%|██████████████████████████                                                                                         | 2206/9741 [00:03<00:13, 573.31it/s] 23%|██████████████████████████▋                                                                                        | 2264/9741 [00:04<00:13, 572.24it/s] 24%|███████████████████████████▍                                                                                       | 2322/9741 [00:04<00:12, 573.28it/s] 24%|████████████████████████████                                                                                       | 2380/9741 [00:04<00:12, 575.18it/s] 25%|█████████████████████████████▏                                                                                     | 2468/9741 [00:04<00:10, 666.11it/s] 26%|██████████████████████████████▏                                                                                    | 2555/9741 [00:04<00:09, 725.78it/s] 27%|███████████████████████████████▏                                                                                   | 2644/9741 [00:04<00:09, 772.79it/s] 28%|████████████████████████████████▏                                                                                  | 2731/9741 [00:04<00:08, 801.59it/s] 29%|█████████████████████████████████▎                                                                                 | 2819/9741 [00:04<00:08, 823.81it/s] 30%|██████████████████████████████████▎                                                                                | 2908/9741 [00:04<00:08, 841.43it/s] 31%|███████████████████████████████████▎                                                                               | 2996/9741 [00:04<00:07, 850.39it/s] 32%|████████████████████████████████████▍                                                                              | 3084/9741 [00:05<00:07, 858.69it/s] 33%|█████████████████████████████████████▍                                                                             | 3171/9741 [00:05<00:07, 861.44it/s] 33%|██████████████████████████████████████▍                                                                            | 3260/9741 [00:05<00:07, 868.64it/s] 34%|███████████████████████████████████████▌                                                                           | 3348/9741 [00:05<00:07, 869.43it/s] 35%|████████████████████████████████████████▌                                                                          | 3435/9741 [00:05<00:07, 868.72it/s] 36%|█████████████████████████████████████████▌                                                                         | 3523/9741 [00:05<00:07, 870.86it/s] 37%|██████████████████████████████████████████▋                                                                        | 3611/9741 [00:05<00:07, 870.46it/s] 38%|███████████████████████████████████████████▋                                                                       | 3700/9741 [00:05<00:06, 873.49it/s] 39%|████████████████████████████████████████████▋                                                                      | 3789/9741 [00:05<00:06, 876.09it/s] 40%|█████████████████████████████████████████████▊                                                                     | 3877/9741 [00:05<00:06, 874.47it/s] 41%|██████████████████████████████████████████████▊                                                                    | 3965/9741 [00:06<00:06, 875.79it/s] 42%|███████████████████████████████████████████████▊                                                                   | 4054/9741 [00:06<00:06, 877.82it/s] 43%|████████████████████████████████████████████████▉                                                                  | 4142/9741 [00:06<00:06, 875.22it/s] 43%|█████████████████████████████████████████████████▉                                                                 | 4230/9741 [00:06<00:06, 873.59it/s] 44%|██████████████████████████████████████████████████▉                                                                | 4318/9741 [00:06<00:06, 867.98it/s] 45%|████████████████████████████████████████████████████                                                               | 4405/9741 [00:06<00:06, 864.79it/s] 46%|█████████████████████████████████████████████████████                                                              | 4493/9741 [00:06<00:06, 868.16it/s] 47%|██████████████████████████████████████████████████████                                                             | 4580/9741 [00:06<00:06, 828.04it/s] 48%|███████████████████████████████████████████████████████                                                            | 4669/9741 [00:06<00:06, 843.70it/s] 49%|████████████████████████████████████████████████████████                                                           | 4754/9741 [00:07<00:07, 640.31it/s] 50%|█████████████████████████████████████████████████████████▏                                                         | 4842/9741 [00:07<00:07, 697.31it/s] 51%|██████████████████████████████████████████████████████████▏                                                        | 4930/9741 [00:07<00:06, 742.98it/s] 52%|███████████████████████████████████████████████████████████▏                                                       | 5018/9741 [00:07<00:06, 777.98it/s] 52%|████████████████████████████████████████████████████████████▎                                                      | 5104/9741 [00:07<00:05, 799.37it/s] 53%|█████████████████████████████████████████████████████████████▎                                                     | 5191/9741 [00:07<00:05, 817.22it/s] 54%|██████████████████████████████████████████████████████████████▎                                                    | 5279/9741 [00:07<00:05, 833.45it/s] 55%|███████████████████████████████████████████████████████████████▎                                                   | 5365/9741 [00:07<00:05, 816.04it/s] 56%|████████████████████████████████████████████████████████████████▍                                                  | 5453/9741 [00:07<00:05, 832.36it/s] 57%|█████████████████████████████████████████████████████████████████▍                                                 | 5545/9741 [00:08<00:04, 855.33it/s] 58%|██████████████████████████████████████████████████████████████████▌                                                | 5637/9741 [00:08<00:04, 871.64it/s] 59%|███████████████████████████████████████████████████████████████████▋                                               | 5730/9741 [00:08<00:04, 886.13it/s] 60%|████████████████████████████████████████████████████████████████████▋                                              | 5822/9741 [00:08<00:04, 895.69it/s] 61%|█████████████████████████████████████████████████████████████████████▊                                             | 5913/9741 [00:08<00:04, 899.47it/s] 62%|██████████████████████████████████████████████████████████████████████▉                                            | 6006/9741 [00:08<00:04, 906.12it/s] 63%|███████████████████████████████████████████████████████████████████████▉                                           | 6097/9741 [00:08<00:04, 901.83it/s] 64%|█████████████████████████████████████████████████████████████████████████                                          | 6189/9741 [00:08<00:03, 906.48it/s] 64%|██████████████████████████████████████████████████████████████████████████▏                                        | 6281/9741 [00:08<00:03, 909.05it/s] 65%|███████████████████████████████████████████████████████████████████████████▏                                       | 6372/9741 [00:08<00:03, 909.08it/s] 66%|████████████████████████████████████████████████████████████████████████████▎                                      | 6464/9741 [00:09<00:03, 912.00it/s] 67%|█████████████████████████████████████████████████████████████████████████████▍                                     | 6556/9741 [00:09<00:03, 911.11it/s] 68%|██████████████████████████████████████████████████████████████████████████████▍                                    | 6648/9741 [00:09<00:03, 912.03it/s] 69%|███████████████████████████████████████████████████████████████████████████████▌                                   | 6740/9741 [00:09<00:03, 914.20it/s] 70%|████████████████████████████████████████████████████████████████████████████████▋                                  | 6832/9741 [00:09<00:03, 912.68it/s] 71%|█████████████████████████████████████████████████████████████████████████████████▊                                 | 6925/9741 [00:09<00:03, 915.05it/s] 72%|██████████████████████████████████████████████████████████████████████████████████▊                                | 7017/9741 [00:09<00:02, 913.75it/s] 73%|███████████████████████████████████████████████████████████████████████████████████▉                               | 7109/9741 [00:09<00:02, 914.87it/s] 74%|█████████████████████████████████████████████████████████████████████████████████████                              | 7201/9741 [00:09<00:02, 915.92it/s] 75%|██████████████████████████████████████████████████████████████████████████████████████                             | 7293/9741 [00:09<00:02, 913.93it/s] 76%|███████████████████████████████████████████████████████████████████████████████████████▏                           | 7386/9741 [00:10<00:02, 916.08it/s] 77%|████████████████████████████████████████████████████████████████████████████████████████▎                          | 7478/9741 [00:10<00:02, 880.58it/s] 78%|█████████████████████████████████████████████████████████████████████████████████████████▎                         | 7570/9741 [00:10<00:02, 891.52it/s] 79%|██████████████████████████████████████████████████████████████████████████████████████████▍                        | 7662/9741 [00:10<00:02, 899.83it/s] 80%|███████████████████████████████████████████████████████████████████████████████████████████▌                       | 7754/9741 [00:10<00:02, 903.21it/s] 81%|████████████████████████████████████████████████████████████████████████████████████████████▋                      | 7846/9741 [00:10<00:02, 908.15it/s] 81%|█████████████████████████████████████████████████████████████████████████████████████████████▋                     | 7938/9741 [00:10<00:01, 909.52it/s] 82%|██████████████████████████████████████████████████████████████████████████████████████████████▊                    | 8030/9741 [00:10<00:01, 912.07it/s] 83%|███████████████████████████████████████████████████████████████████████████████████████████████▉                   | 8122/9741 [00:10<00:01, 910.41it/s] 84%|████████████████████████████████████████████████████████████████████████████████████████████████▉                  | 8214/9741 [00:10<00:01, 912.27it/s] 85%|██████████████████████████████████████████████████████████████████████████████████████████████████                 | 8306/9741 [00:11<00:01, 914.06it/s] 86%|███████████████████████████████████████████████████████████████████████████████████████████████████▏               | 8398/9741 [00:11<00:01, 912.70it/s] 87%|████████████████████████████████████████████████████████████████████████████████████████████████████▏              | 8490/9741 [00:11<00:01, 913.59it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████████████████▎             | 8582/9741 [00:11<00:01, 911.51it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████████████████▍            | 8674/9741 [00:11<00:01, 912.66it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████████████████████▍           | 8766/9741 [00:11<00:01, 914.13it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████████████████▌          | 8858/9741 [00:11<00:00, 911.57it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▋         | 8950/9741 [00:11<00:00, 913.46it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▋        | 9042/9741 [00:11<00:00, 910.40it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▊       | 9134/9741 [00:11<00:00, 909.66it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▉      | 9226/9741 [00:12<00:00, 910.05it/s] 96%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████     | 9318/9741 [00:12<00:00, 908.83it/s] 97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████    | 9410/9741 [00:12<00:00, 910.11it/s] 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏  | 9502/9741 [00:12<00:00, 906.78it/s] 98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎ | 9594/9741 [00:12<00:00, 907.97it/s] 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎| 9686/9741 [00:12<00:00, 908.56it/s]100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9741/9741 [00:12<00:00, 770.68it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                                                                       | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                                       | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                                       | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                                       | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███████████████████████████████▋                                                               | 1/3 [00:05<00:10,  5.40s/it]Loading checkpoint shards:  33%|███████████████████████████████▋                                                               | 1/3 [00:05<00:11,  5.90s/it]Loading checkpoint shards:  33%|███████████████████████████████▋                                                               | 1/3 [00:05<00:11,  5.71s/it]Loading checkpoint shards:  33%|███████████████████████████████▋                                                               | 1/3 [00:06<00:12,  6.28s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████████████████▎                               | 2/3 [00:11<00:05,  5.59s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████████████████▎                               | 2/3 [00:12<00:06,  6.07s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████████████████▎                               | 2/3 [00:11<00:05,  5.98s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████████████████▎                               | 2/3 [00:12<00:06,  6.05s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  4.94s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.10s/it]
Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:16<00:00,  5.22s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:16<00:00,  5.43s/it]
[2023-08-10 16:28:09,872] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:16<00:00,  5.14s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:16<00:00,  5.34s/it]
Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:18<00:00,  5.97s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:18<00:00,  6.02s/it]
[2023-08-10 16:28:27,605] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-10 16:28:27,606] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-10 16:28:27,607] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-10 16:28:27,607] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-10 16:28:27,607] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-10 16:28:27,607] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-10 16:28:27,608] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-10 16:28:27,608] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-10 16:28:27,608] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-10 16:28:27,608] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-10 16:28:27,608] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-10 16:28:27,608] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f3462de0ca0>
[2023-08-10 16:28:27,608] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-10 16:28:27,608] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-10 16:28:27,608] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-10 16:28:27,608] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-10 16:28:27,608] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-10 16:28:27,608] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-10 16:28:27,608] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-10 16:28:27,608] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-10 16:28:27,608] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-10 16:28:27,608] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-10 16:28:27,608] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-10 16:28:27,608] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-10 16:28:27,608] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-10 16:28:27,608] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-10 16:28:27,608] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-10 16:28:27,608] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-10 16:28:27,608] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-10 16:28:27,608] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-10 16:28:27,608] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-10 16:28:27,608] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-10 16:28:27,608] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-10 16:28:27,608] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-10 16:28:27,608] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-10 16:28:27,608] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-10 16:28:27,608] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-10 16:28:27,608] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-10 16:28:27,608] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-10 16:28:27,609] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-10 16:28:27,609] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-10 16:28:27,609] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-10 16:28:27,609] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-10 16:28:27,609] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-10 16:28:27,609] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f343bb346a0>
[2023-08-10 16:28:27,609] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-10 16:28:27,609] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-10 16:28:27,609] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-10 16:28:27,609] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-10 16:28:27,609] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-10 16:28:27,609] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-10 16:28:27,609] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-10 16:28:27,609] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-10 16:28:27,609] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-10 16:28:27,609] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-10 16:28:27,609] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-10 16:28:27,609] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-10 16:28:27,609] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-10 16:28:27,609] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-10 16:28:27,609] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-10 16:28:27,609] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-10 16:28:27,609] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-10 16:28:27,609] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-10 16:28:27,609] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-10 16:28:27,609] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-10 16:28:27,609] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-10 16:28:27,609] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-10 16:28:27,609] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.5225512981414795 seconds
Loading extension module utils...
Time to load utils op: 0.5047852993011475 seconds
Loading extension module utils...
Time to load utils op: 0.5047645568847656 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                                                                                      | 0/50 [00:00<?, ?it/s]############### Example ###############
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following multiple choice question.

### Demonstration:
Input: For every 12 cans you recycle, you receive $0.50, and for every 5 kilograms of newspapers, you receive $1.50. If your family collected 144 cans and 20 kilograms of newspapers, how much money would you receive?
Answer: 12

Input: Betty picked 16 strawberries. Matthew picked 20 more strawberries than Betty and twice as many as Natalie. They used their strawberries to make jam. One jar of jam used 7 strawberries and they sold each jar at $4. How much money were they able to make from the strawberries they picked?
Answer: 40

Input: Jack has a stack of books that is 12 inches thick. He knows from experience that 80 pages is one inch thick. If he has 6 books, how many pages is each one on average?
Answer: 160

Input: James dumps his whole collection of 500 Legos on the floor and starts building a castle out of them.  He uses half the pieces before finishing and is told to put the rest away.  He puts all of the leftover pieces back in the box they came from, except for 5 missing pieces that he can't find.  How many Legos are in the box at the end?
Answer: 245

Input: Ines had $20 in her purse. She bought 3 pounds of peaches, which are $2 per pound at the local farmers’ market. How much did she have left?
Answer: 14

Input: Aaron pays his actuary membership fees each year. The membership fee increases yearly by $10. If he pays $80 in the first year, how much does his membership cost, in dollars, in the sixth year?
Answer: 130

Input: Joseph invested $1000 into a hedge fund. The fund promised a yearly interest rate of 10%. If he deposited an additional $100 every month into the account to add to his initial investment of $1000, how much money will he have in the fund after two years?
Answer: 3982

Input: The price of buying a wooden toy at the new Craftee And Best store is $20, and the cost of buying a hat is $10. If Kendra went to the shop with a $100 bill and bought two wooden toys and three hats, calculate the change she received.
Answer: 30

### Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid

### Response:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o8-tgsm8k-s42-rFalse
Loading extension module utils...
Time to load utils op: 0.5045576095581055 seconds
Evaluating commonsenseqa :   2%|█▉                                                                                            | 1/50 [00:49<40:31, 49.61s/it]Evaluating commonsenseqa :   4%|███▊                                                                                          | 2/50 [01:38<39:08, 48.93s/it]Evaluating commonsenseqa :   6%|█████▋                                                                                        | 3/50 [02:27<38:37, 49.30s/it]Evaluating commonsenseqa :   8%|███████▌                                                                                      | 4/50 [03:16<37:35, 49.04s/it]Evaluating commonsenseqa :  10%|█████████▍                                                                                    | 5/50 [04:05<36:40, 48.90s/it]Evaluating commonsenseqa :  12%|███████████▎                                                                                  | 6/50 [04:53<35:45, 48.75s/it]Evaluating commonsenseqa :  14%|█████████████▏                                                                                | 7/50 [05:29<31:54, 44.53s/it]Evaluating commonsenseqa :  16%|███████████████                                                                               | 8/50 [06:01<28:27, 40.65s/it]Evaluating commonsenseqa :  18%|████████████████▉                                                                             | 9/50 [06:51<29:42, 43.46s/it]Evaluating commonsenseqa :  20%|██████████████████▌                                                                          | 10/50 [07:40<30:04, 45.10s/it]Evaluating commonsenseqa :  22%|████████████████████▍                                                                        | 11/50 [08:28<29:58, 46.12s/it]Evaluating commonsenseqa :  24%|██████████████████████▎                                                                      | 12/50 [09:17<29:41, 46.89s/it]Evaluating commonsenseqa :  26%|████████████████████████▏                                                                    | 13/50 [09:43<25:02, 40.62s/it]Evaluating commonsenseqa :  28%|██████████████████████████                                                                   | 14/50 [10:32<25:53, 43.15s/it]Evaluating commonsenseqa :  30%|███████████████████████████▉                                                                 | 15/50 [11:20<26:00, 44.58s/it]Evaluating commonsenseqa :  32%|█████████████████████████████▊                                                               | 16/50 [12:09<26:02, 45.96s/it]Evaluating commonsenseqa :  34%|███████████████████████████████▌                                                             | 17/50 [12:54<25:04, 45.60s/it]Evaluating commonsenseqa :  36%|█████████████████████████████████▍                                                           | 18/50 [13:42<24:44, 46.40s/it]Evaluating commonsenseqa :  38%|███████████████████████████████████▎                                                         | 19/50 [14:31<24:21, 47.16s/it]Evaluating commonsenseqa :  40%|█████████████████████████████████████▏                                                       | 20/50 [15:20<23:51, 47.72s/it]Evaluating commonsenseqa :  42%|███████████████████████████████████████                                                      | 21/50 [16:09<23:11, 48.00s/it]Evaluating commonsenseqa :  44%|████████████████████████████████████████▉                                                    | 22/50 [16:47<21:04, 45.14s/it]Evaluating commonsenseqa :  46%|██████████████████████████████████████████▊                                                  | 23/50 [17:36<20:49, 46.28s/it]Evaluating commonsenseqa :  48%|████████████████████████████████████████████▋                                                | 24/50 [18:24<20:12, 46.65s/it]Evaluating commonsenseqa :  50%|██████████████████████████████████████████████▌                                              | 25/50 [19:12<19:37, 47.09s/it]Evaluating commonsenseqa :  52%|████████████████████████████████████████████████▎                                            | 26/50 [20:00<19:01, 47.56s/it]Evaluating commonsenseqa :  54%|██████████████████████████████████████████████████▏                                          | 27/50 [20:49<18:19, 47.79s/it]Evaluating commonsenseqa :  56%|████████████████████████████████████████████████████                                         | 28/50 [21:37<17:36, 48.04s/it]Evaluating commonsenseqa :  58%|█████████████████████████████████████████████████████▉                                       | 29/50 [22:26<16:54, 48.33s/it]Evaluating commonsenseqa :  60%|███████████████████████████████████████████████████████▊                                     | 30/50 [23:15<16:09, 48.50s/it]Evaluating commonsenseqa :  62%|█████████████████████████████████████████████████████████▋                                   | 31/50 [23:49<13:56, 44.04s/it]Evaluating commonsenseqa :  64%|███████████████████████████████████████████████████████████▌                                 | 32/50 [24:37<13:36, 45.37s/it]Evaluating commonsenseqa :  66%|█████████████████████████████████████████████████████████████▍                               | 33/50 [25:19<12:31, 44.22s/it]Evaluating commonsenseqa :  68%|███████████████████████████████████████████████████████████████▏                             | 34/50 [26:09<12:13, 45.87s/it]Evaluating commonsenseqa :  70%|█████████████████████████████████████████████████████████████████                            | 35/50 [26:57<11:41, 46.76s/it]Evaluating commonsenseqa :  72%|██████████████████████████████████████████████████████████████████▉                          | 36/50 [27:38<10:26, 44.78s/it]Evaluating commonsenseqa :  74%|████████████████████████████████████████████████████████████████████▊                        | 37/50 [28:26<09:57, 45.99s/it]Evaluating commonsenseqa :  76%|██████████████████████████████████████████████████████████████████████▋                      | 38/50 [29:15<09:22, 46.86s/it]Evaluating commonsenseqa :  78%|████████████████████████████████████████████████████████████████████████▌                    | 39/50 [30:04<08:42, 47.50s/it]Evaluating commonsenseqa :  80%|██████████████████████████████████████████████████████████████████████████▍                  | 40/50 [30:53<07:58, 47.86s/it]Evaluating commonsenseqa :  82%|████████████████████████████████████████████████████████████████████████████▎                | 41/50 [31:24<06:24, 42.70s/it]Evaluating commonsenseqa :  84%|██████████████████████████████████████████████████████████████████████████████               | 42/50 [32:12<05:56, 44.53s/it]Evaluating commonsenseqa :  86%|███████████████████████████████████████████████████████████████████████████████▉             | 43/50 [33:01<05:21, 45.87s/it]Evaluating commonsenseqa :  88%|█████████████████████████████████████████████████████████████████████████████████▊           | 44/50 [33:50<04:39, 46.61s/it]Evaluating commonsenseqa :  90%|███████████████████████████████████████████████████████████████████████████████████▋         | 45/50 [34:39<03:56, 47.28s/it]Evaluating commonsenseqa :  92%|█████████████████████████████████████████████████████████████████████████████████████▌       | 46/50 [35:28<03:11, 47.90s/it]Evaluating commonsenseqa :  94%|███████████████████████████████████████████████████████████████████████████████████████▍     | 47/50 [36:17<02:24, 48.18s/it]^CTraceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
Evaluating commonsenseqa :  94%|███████████████████████████████████████████████████████████████████████████████████████▍     | 47/50 [36:51<02:21, 47.06s/it]
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2509, in sample
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2509, in sample
WARNING:torch.distributed.elastic.agent.server.api:Received 2 death signal, shutting down workers
    next_token_scores = logits_processor(input_ids, next_token_logits)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/logits_process.py", line 92, in __call__
    scores = processor(input_ids, scores)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/logits_process.py", line 487, in __call__
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 2511138 closing signal SIGINT
    banned_batch_tokens = _calc_banned_ngram_tokens(self.ngram_size, input_ids, num_batch_hypotheses, cur_len)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/logits_process.py", line 460, in _calc_banned_ngram_tokens
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/logits_process.py", line 92, in __call__
    scores = processor(input_ids, scores)
      File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/logits_process.py", line 487, in __call__
generated_ngrams = _get_ngrams(ngram_size, prev_input_ids, num_hypos)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/logits_process.py", line 441, in _get_ngrams
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 2511139 closing signal SIGINT
    generated_ngram[prev_ngram_tuple] = generated_ngram.get(prev_ngram_tuple, []) + [ngram[-1]]
    banned_batch_tokens = _calc_banned_ngram_tokens(self.ngram_size, input_ids, num_batch_hypotheses, cur_len)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/logits_process.py", line 460, in _calc_banned_ngram_tokens
KeyboardInterrupt
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 2511141 closing signal SIGINT
    generated_ngrams = _get_ngrams(ngram_size, prev_input_ids, num_hypos)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/logits_process.py", line 441, in _get_ngrams
Exception ignored in: <module 'threading' from '/home/ylu130/.conda/envs/distllm/lib/python3.9/threading.py'>
Traceback (most recent call last):
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/threading.py", line 1450, in _shutdown
    generated_ngram[prev_ngram_tuple] = generated_ngram.get(prev_ngram_tuple, []) + [ngram[-1]]
KeyboardInterrupt
    if _main_thread.ident == get_ident():
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/threading.py", line 1119, in ident
    return self._ident
KeyboardInterrupt: 
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2509, in sample
    next_token_scores = logits_processor(input_ids, next_token_logits)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/logits_process.py", line 92, in __call__
    scores = processor(input_ids, scores)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/logits_process.py", line 487, in __call__
    banned_batch_tokens = _calc_banned_ngram_tokens(self.ngram_size, input_ids, num_batch_hypotheses, cur_len)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/logits_process.py", line 460, in _calc_banned_ngram_tokens
    generated_ngrams = _get_ngrams(ngram_size, prev_input_ids, num_hypos)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/logits_process.py", line 437, in _get_ngrams
    gen_tokens = prev_input_ids[idx].tolist()
KeyboardInterrupt
^CWARNING:torch.distributed.elastic.multiprocessing.api:Sending process 2511138 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 2511139 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 2511141 closing signal SIGTERM
^C^CTraceback (most recent call last):
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py", line 709, in run
    result = self._invoke_run(role)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py", line 850, in _invoke_run
    time.sleep(monitor_interval)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 60, in _terminate_process_handler
    raise SignalException(f"Process {os.getpid()} got signal: {sigval}", sigval=sigval)
torch.distributed.elastic.multiprocessing.api.SignalException: Process 2511066 got signal: 2

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py", line 716, in run
    self._shutdown(e.sigval)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/local_elastic_agent.py", line 193, in _shutdown
    self._pcontext.close(death_sig)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 330, in close
    self._close(death_sig=death_sig, timeout=timeout)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 707, in _close
    handler.proc.wait(time_to_wait)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/subprocess.py", line 1189, in wait
    return self._wait(timeout=timeout)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/subprocess.py", line 1927, in _wait
    time.sleep(delay)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 60, in _terminate_process_handler
    raise SignalException(f"Process {os.getpid()} got signal: {sigval}", sigval=sigval)
torch.distributed.elastic.multiprocessing.api.SignalException: Process 2511066 got signal: 2

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 236, in launch_agent
    result = agent.run()
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/metrics/api.py", line 125, in wrapper
    result = f(*args, **kwargs)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py", line 721, in run
    self._shutdown()
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/local_elastic_agent.py", line 193, in _shutdown
    self._pcontext.close(death_sig)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 330, in close
    self._close(death_sig=death_sig, timeout=timeout)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 707, in _close
    handler.proc.wait(time_to_wait)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/subprocess.py", line 1189, in wait
    return self._wait(timeout=timeout)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/subprocess.py", line 1927, in _wait
    time.sleep(delay)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 60, in _terminate_process_handler
    raise SignalException(f"Process {os.getpid()} got signal: {sigval}", sigval=sigval)
torch.distributed.elastic.multiprocessing.api.SignalException: Process 2511066 got signal: 2

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ylu130/.conda/envs/distllm/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 345, in wrapper
    return f(*args, **kwargs)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 761, in main
    run(args)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 752, in run
    elastic_launch(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 131, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 258, in launch_agent
    events.record(agent.get_event_failed())
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py", line 726, in get_event_failed
    return self._construct_event(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py", line 784, in _construct_event
    "hostname": _get_fq_hostname(),
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py", line 385, in _get_fq_hostname
    return socket.getfqdn(socket.gethostname())
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/socket.py", line 792, in getfqdn
    hostname, aliases, ipaddrs = gethostbyaddr(name)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 60, in _terminate_process_handler
    raise SignalException(f"Process {os.getpid()} got signal: {sigval}", sigval=sigval)
torch.distributed.elastic.multiprocessing.api.SignalException: Process 2511066 got signal: 2
^C