PYTHONPATH=/home/ylu130/workspace/in-context-generalization
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name gsm8k --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name commonsenseqa --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --max-prompt-length 4096 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 2 --data-dir /scratch/ylu130/processed_data/gsm8k/out-domain/o4-tcommonsenseqa-s1-rTrue --seed 1 --rationales --num-out-domain 4
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date![nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!

using world size: 4
[2023-08-15 21:48:36,434] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... gsm8k
  data_dir ..................... /scratch/ylu130/processed_data/gsm8k/out-domain/o4-tcommonsenseqa-s1-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 4
  out_domain_data_name ......... commonsenseqa
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 4096
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o4-tcommonsenseqa-s1-rTrue-m4096
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 2
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                 | 0/7473 [00:00<?, ?it/s]  0%|▏                                                                      | 19/7473 [00:00<00:39, 189.93it/s]  1%|▎                                                                      | 39/7473 [00:00<00:38, 192.63it/s]  1%|▌                                                                      | 59/7473 [00:00<00:38, 194.50it/s]  1%|▊                                                                      | 79/7473 [00:00<00:37, 194.93it/s]  1%|▉                                                                      | 99/7473 [00:00<00:37, 195.48it/s]  2%|█                                                                     | 119/7473 [00:00<00:37, 195.13it/s]  2%|█▎                                                                    | 139/7473 [00:00<00:37, 195.57it/s]  2%|█▍                                                                    | 159/7473 [00:00<00:37, 196.51it/s]  2%|█▋                                                                    | 179/7473 [00:00<00:37, 196.37it/s]  3%|█▊                                                                    | 199/7473 [00:01<00:36, 196.76it/s]  3%|██                                                                    | 219/7473 [00:01<00:36, 196.90it/s]  3%|██▏                                                                   | 239/7473 [00:01<00:36, 196.27it/s]  3%|██▍                                                                   | 259/7473 [00:01<00:37, 194.25it/s]  4%|██▌                                                                   | 279/7473 [00:01<00:36, 195.65it/s]  4%|██▊                                                                   | 300/7473 [00:01<00:36, 198.44it/s]  4%|███                                                                   | 321/7473 [00:01<00:35, 200.85it/s]  5%|███▏                                                                  | 342/7473 [00:01<00:35, 202.02it/s]  5%|███▍                                                                  | 363/7473 [00:01<00:35, 202.84it/s]  5%|███▌                                                                  | 384/7473 [00:01<00:34, 204.13it/s]  5%|███▊                                                                  | 405/7473 [00:02<00:34, 203.61it/s]  6%|███▉                                                                  | 426/7473 [00:02<00:34, 204.24it/s]  6%|████▏                                                                 | 447/7473 [00:02<00:34, 204.17it/s]  6%|████▍                                                                 | 468/7473 [00:02<00:34, 204.67it/s]  7%|████▌                                                                 | 489/7473 [00:02<00:34, 203.62it/s]  7%|████▊                                                                 | 510/7473 [00:02<00:34, 204.03it/s]  7%|████▉                                                                 | 531/7473 [00:02<00:33, 204.97it/s]  7%|█████▏                                                                | 556/7473 [00:02<00:31, 217.48it/s]  8%|█████▌                                                                | 588/7473 [00:02<00:27, 245.95it/s]  8%|█████▊                                                                | 620/7473 [00:02<00:25, 265.43it/s]  9%|██████                                                                | 652/7473 [00:03<00:24, 279.82it/s]  9%|██████▍                                                               | 684/7473 [00:03<00:23, 290.51it/s] 10%|██████▋                                                               | 715/7473 [00:03<00:22, 296.01it/s] 10%|██████▉                                                               | 745/7473 [00:03<00:22, 296.68it/s] 10%|███████▎                                                              | 775/7473 [00:03<00:22, 293.23it/s] 11%|███████▌                                                              | 805/7473 [00:03<00:22, 294.82it/s] 11%|███████▊                                                              | 837/7473 [00:03<00:22, 299.80it/s] 12%|████████▏                                                             | 869/7473 [00:03<00:21, 303.07it/s] 12%|████████▍                                                             | 901/7473 [00:03<00:21, 305.26it/s] 12%|████████▋                                                             | 932/7473 [00:03<00:21, 305.31it/s] 13%|█████████                                                             | 963/7473 [00:04<00:21, 302.15it/s] 13%|█████████▎                                                            | 995/7473 [00:04<00:21, 304.60it/s] 14%|█████████▍                                                           | 1026/7473 [00:04<00:21, 306.13it/s] 14%|█████████▊                                                           | 1057/7473 [00:04<00:20, 307.23it/s] 15%|██████████                                                           | 1089/7473 [00:04<00:20, 308.52it/s] 15%|██████████▎                                                          | 1120/7473 [00:04<00:20, 307.54it/s] 15%|██████████▋                                                          | 1151/7473 [00:04<00:20, 307.90it/s] 16%|██████████▉                                                          | 1182/7473 [00:04<00:20, 306.05it/s] 16%|███████████▏                                                         | 1213/7473 [00:04<00:20, 306.60it/s] 17%|███████████▍                                                         | 1244/7473 [00:05<00:20, 307.17it/s] 17%|███████████▊                                                         | 1275/7473 [00:05<00:20, 307.73it/s] 17%|████████████                                                         | 1306/7473 [00:05<00:20, 308.16it/s] 18%|████████████▎                                                        | 1338/7473 [00:05<00:19, 308.82it/s] 18%|████████████▋                                                        | 1369/7473 [00:05<00:19, 308.88it/s] 19%|████████████▉                                                        | 1400/7473 [00:05<00:19, 305.81it/s] 19%|█████████████▏                                                       | 1431/7473 [00:05<00:19, 306.62it/s] 20%|█████████████▍                                                       | 1462/7473 [00:05<00:19, 307.41it/s] 20%|█████████████▊                                                       | 1494/7473 [00:05<00:19, 308.26it/s] 20%|██████████████                                                       | 1526/7473 [00:05<00:19, 308.83it/s] 21%|██████████████▍                                                      | 1557/7473 [00:06<00:19, 308.07it/s] 21%|██████████████▋                                                      | 1588/7473 [00:06<00:19, 307.42it/s] 22%|██████████████▉                                                      | 1619/7473 [00:06<00:19, 305.66it/s] 22%|███████████████▏                                                     | 1650/7473 [00:06<00:18, 306.62it/s] 23%|███████████████▌                                                     | 1682/7473 [00:06<00:18, 307.72it/s] 23%|███████████████▊                                                     | 1713/7473 [00:06<00:18, 307.92it/s] 23%|████████████████                                                     | 1744/7473 [00:06<00:18, 301.64it/s] 24%|████████████████▍                                                    | 1775/7473 [00:06<00:19, 298.51it/s] 24%|████████████████▋                                                    | 1806/7473 [00:06<00:18, 301.75it/s] 25%|████████████████▉                                                    | 1837/7473 [00:06<00:18, 303.53it/s] 25%|█████████████████▏                                                   | 1868/7473 [00:07<00:18, 303.66it/s] 25%|█████████████████▌                                                   | 1899/7473 [00:07<00:18, 305.18it/s] 26%|█████████████████▊                                                   | 1930/7473 [00:07<00:18, 304.98it/s] 26%|██████████████████                                                   | 1961/7473 [00:07<00:17, 306.24it/s] 27%|██████████████████▍                                                  | 1992/7473 [00:07<00:17, 307.09it/s] 27%|██████████████████▋                                                  | 2023/7473 [00:07<00:17, 307.60it/s] 27%|██████████████████▉                                                  | 2054/7473 [00:07<00:17, 307.04it/s] 28%|███████████████████▎                                                 | 2085/7473 [00:07<00:17, 305.82it/s] 28%|███████████████████▌                                                 | 2116/7473 [00:07<00:17, 305.15it/s] 29%|███████████████████▊                                                 | 2148/7473 [00:07<00:17, 306.71it/s] 29%|████████████████████                                                 | 2179/7473 [00:08<00:17, 307.67it/s] 30%|████████████████████▍                                                | 2210/7473 [00:08<00:17, 308.23it/s] 30%|████████████████████▋                                                | 2241/7473 [00:08<00:16, 308.47it/s] 30%|████████████████████▉                                                | 2272/7473 [00:08<00:16, 308.32it/s] 31%|█████████████████████▎                                               | 2303/7473 [00:08<00:16, 307.01it/s] 31%|█████████████████████▌                                               | 2334/7473 [00:08<00:16, 304.54it/s] 32%|█████████████████████▊                                               | 2365/7473 [00:08<00:16, 305.63it/s] 32%|██████████████████████                                               | 2396/7473 [00:08<00:16, 306.43it/s] 32%|██████████████████████▍                                              | 2428/7473 [00:08<00:16, 307.81it/s] 33%|██████████████████████▋                                              | 2460/7473 [00:08<00:16, 308.57it/s] 33%|███████████████████████                                              | 2491/7473 [00:09<00:16, 308.50it/s] 34%|███████████████████████▎                                             | 2522/7473 [00:09<00:18, 269.01it/s] 34%|███████████████████████▌                                             | 2553/7473 [00:09<00:17, 279.39it/s] 35%|███████████████████████▊                                             | 2582/7473 [00:09<00:17, 280.31it/s] 35%|████████████████████████                                             | 2612/7473 [00:09<00:17, 284.31it/s] 35%|████████████████████████▍                                            | 2643/7473 [00:09<00:16, 291.07it/s] 36%|████████████████████████▋                                            | 2674/7473 [00:09<00:16, 296.35it/s] 36%|████████████████████████▉                                            | 2705/7473 [00:09<00:15, 299.66it/s] 37%|█████████████████████████▎                                           | 2736/7473 [00:09<00:15, 301.93it/s] 37%|█████████████████████████▌                                           | 2767/7473 [00:10<00:15, 301.63it/s] 37%|█████████████████████████▊                                           | 2798/7473 [00:10<00:15, 303.56it/s] 38%|██████████████████████████                                           | 2829/7473 [00:10<00:15, 305.19it/s] 38%|██████████████████████████▍                                          | 2860/7473 [00:10<00:15, 305.51it/s] 39%|██████████████████████████▋                                          | 2891/7473 [00:10<00:14, 305.80it/s] 39%|██████████████████████████▉                                          | 2922/7473 [00:10<00:14, 306.54it/s] 40%|███████████████████████████▎                                         | 2953/7473 [00:10<00:14, 307.18it/s] 40%|███████████████████████████▌                                         | 2984/7473 [00:10<00:14, 305.78it/s] 40%|███████████████████████████▊                                         | 3015/7473 [00:10<00:14, 306.25it/s] 41%|████████████████████████████                                         | 3046/7473 [00:10<00:14, 305.74it/s] 41%|████████████████████████████▍                                        | 3077/7473 [00:11<00:14, 295.94it/s] 42%|████████████████████████████▋                                        | 3108/7473 [00:11<00:14, 299.56it/s] 42%|████████████████████████████▉                                        | 3139/7473 [00:11<00:14, 301.32it/s] 42%|█████████████████████████████▎                                       | 3170/7473 [00:11<00:14, 303.28it/s] 43%|█████████████████████████████▌                                       | 3201/7473 [00:11<00:14, 302.74it/s] 43%|█████████████████████████████▊                                       | 3232/7473 [00:11<00:13, 304.29it/s] 44%|██████████████████████████████▏                                      | 3263/7473 [00:11<00:13, 305.64it/s] 44%|██████████████████████████████▍                                      | 3294/7473 [00:11<00:13, 305.32it/s] 44%|██████████████████████████████▋                                      | 3325/7473 [00:11<00:13, 305.86it/s] 45%|██████████████████████████████▉                                      | 3356/7473 [00:11<00:13, 306.02it/s] 45%|███████████████████████████████▎                                     | 3387/7473 [00:12<00:13, 306.35it/s] 46%|███████████████████████████████▌                                     | 3418/7473 [00:12<00:13, 306.97it/s] 46%|███████████████████████████████▊                                     | 3449/7473 [00:12<00:13, 305.39it/s] 47%|████████████████████████████████▏                                    | 3480/7473 [00:12<00:13, 305.96it/s] 47%|████████████████████████████████▍                                    | 3511/7473 [00:12<00:12, 306.71it/s] 47%|████████████████████████████████▋                                    | 3542/7473 [00:12<00:13, 292.95it/s] 48%|████████████████████████████████▉                                    | 3573/7473 [00:12<00:13, 296.98it/s] 48%|█████████████████████████████████▎                                   | 3604/7473 [00:12<00:12, 299.60it/s] 49%|█████████████████████████████████▌                                   | 3635/7473 [00:12<00:12, 301.20it/s] 49%|█████████████████████████████████▊                                   | 3666/7473 [00:12<00:12, 300.24it/s] 49%|██████████████████████████████████▏                                  | 3697/7473 [00:13<00:12, 301.79it/s] 50%|██████████████████████████████████▍                                  | 3728/7473 [00:13<00:12, 303.24it/s] 50%|██████████████████████████████████▋                                  | 3759/7473 [00:13<00:12, 304.10it/s] 51%|██████████████████████████████████▉                                  | 3790/7473 [00:13<00:12, 304.21it/s] 51%|███████████████████████████████████▎                                 | 3821/7473 [00:13<00:11, 305.31it/s] 52%|███████████████████████████████████▌                                 | 3852/7473 [00:13<00:11, 304.87it/s] 52%|███████████████████████████████████▊                                 | 3883/7473 [00:13<00:12, 291.88it/s] 52%|████████████████████████████████████▏                                | 3914/7473 [00:13<00:11, 296.59it/s] 53%|████████████████████████████████████▍                                | 3945/7473 [00:13<00:11, 299.87it/s] 53%|████████████████████████████████████▋                                | 3976/7473 [00:14<00:11, 302.10it/s] 54%|████████████████████████████████████▉                                | 4007/7473 [00:14<00:11, 304.00it/s] 54%|█████████████████████████████████████▎                               | 4038/7473 [00:14<00:11, 305.25it/s] 54%|█████████████████████████████████████▌                               | 4069/7473 [00:14<00:11, 305.11it/s] 55%|█████████████████████████████████████▊                               | 4100/7473 [00:14<00:11, 305.71it/s] 55%|██████████████████████████████████████▏                              | 4131/7473 [00:14<00:11, 303.25it/s] 56%|██████████████████████████████████████▍                              | 4162/7473 [00:14<00:10, 304.17it/s] 56%|██████████████████████████████████████▋                              | 4193/7473 [00:14<00:10, 304.45it/s] 57%|███████████████████████████████████████                              | 4224/7473 [00:14<00:10, 304.77it/s] 57%|███████████████████████████████████████▎                             | 4255/7473 [00:14<00:10, 304.68it/s] 57%|███████████████████████████████████████▌                             | 4286/7473 [00:15<00:10, 304.42it/s] 58%|███████████████████████████████████████▊                             | 4317/7473 [00:15<00:10, 301.77it/s] 58%|████████████████████████████████████████▏                            | 4348/7473 [00:15<00:10, 303.71it/s] 59%|████████████████████████████████████████▍                            | 4380/7473 [00:15<00:10, 305.89it/s] 59%|████████████████████████████████████████▋                            | 4412/7473 [00:15<00:09, 307.75it/s] 59%|█████████████████████████████████████████                            | 4444/7473 [00:15<00:09, 308.83it/s] 60%|█████████████████████████████████████████▎                           | 4476/7473 [00:15<00:09, 309.68it/s] 60%|█████████████████████████████████████████▌                           | 4508/7473 [00:15<00:09, 310.02it/s] 61%|█████████████████████████████████████████▉                           | 4540/7473 [00:15<00:09, 310.83it/s] 61%|██████████████████████████████████████████▏                          | 4572/7473 [00:15<00:09, 307.04it/s] 62%|██████████████████████████████████████████▌                          | 4604/7473 [00:16<00:09, 308.64it/s] 62%|██████████████████████████████████████████▊                          | 4636/7473 [00:16<00:09, 309.41it/s] 62%|███████████████████████████████████████████                          | 4668/7473 [00:16<00:09, 310.23it/s] 63%|███████████████████████████████████████████▍                         | 4700/7473 [00:16<00:08, 310.67it/s] 63%|███████████████████████████████████████████▋                         | 4732/7473 [00:16<00:08, 311.11it/s] 64%|███████████████████████████████████████████▉                         | 4764/7473 [00:16<00:08, 311.63it/s] 64%|████████████████████████████████████████████▎                        | 4796/7473 [00:16<00:08, 310.10it/s] 65%|████████████████████████████████████████████▌                        | 4828/7473 [00:16<00:08, 310.86it/s] 65%|████████████████████████████████████████████▊                        | 4860/7473 [00:16<00:08, 308.22it/s] 65%|█████████████████████████████████████████████▏                       | 4892/7473 [00:16<00:08, 309.47it/s] 66%|█████████████████████████████████████████████▍                       | 4924/7473 [00:17<00:08, 310.41it/s] 66%|█████████████████████████████████████████████▊                       | 4956/7473 [00:17<00:08, 310.89it/s] 67%|██████████████████████████████████████████████                       | 4988/7473 [00:17<00:07, 310.85it/s] 67%|██████████████████████████████████████████████▎                      | 5020/7473 [00:17<00:08, 306.42it/s] 68%|██████████████████████████████████████████████▋                      | 5051/7473 [00:17<00:08, 301.42it/s] 68%|██████████████████████████████████████████████▉                      | 5083/7473 [00:17<00:07, 304.16it/s] 68%|███████████████████████████████████████████████▏                     | 5114/7473 [00:17<00:07, 304.56it/s] 69%|███████████████████████████████████████████████▌                     | 5146/7473 [00:17<00:07, 306.38it/s] 69%|███████████████████████████████████████████████▊                     | 5178/7473 [00:17<00:07, 308.04it/s] 70%|████████████████████████████████████████████████                     | 5210/7473 [00:18<00:07, 308.86it/s] 70%|████████████████████████████████████████████████▍                    | 5242/7473 [00:18<00:08, 271.17it/s] 71%|████████████████████████████████████████████████▋                    | 5273/7473 [00:18<00:07, 280.86it/s] 71%|████████████████████████████████████████████████▉                    | 5305/7473 [00:18<00:07, 289.16it/s] 71%|█████████████████████████████████████████████████▎                   | 5336/7473 [00:18<00:07, 294.74it/s] 72%|█████████████████████████████████████████████████▌                   | 5367/7473 [00:18<00:07, 299.06it/s] 72%|█████████████████████████████████████████████████▊                   | 5398/7473 [00:18<00:06, 302.12it/s] 73%|██████████████████████████████████████████████████▏                  | 5429/7473 [00:18<00:06, 303.96it/s] 73%|██████████████████████████████████████████████████▍                  | 5461/7473 [00:18<00:06, 305.83it/s] 73%|██████████████████████████████████████████████████▋                  | 5492/7473 [00:19<00:09, 204.53it/s] 74%|███████████████████████████████████████████████████                  | 5524/7473 [00:19<00:08, 228.26it/s] 74%|███████████████████████████████████████████████████▎                 | 5555/7473 [00:19<00:07, 247.58it/s] 75%|███████████████████████████████████████████████████▌                 | 5586/7473 [00:19<00:07, 263.07it/s] 75%|███████████████████████████████████████████████████▊                 | 5617/7473 [00:19<00:06, 275.25it/s] 76%|████████████████████████████████████████████████████▏                | 5647/7473 [00:19<00:06, 277.18it/s] 76%|████████████████████████████████████████████████████▍                | 5678/7473 [00:19<00:06, 285.07it/s] 76%|████████████████████████████████████████████████████▋                | 5710/7473 [00:19<00:06, 292.37it/s] 77%|█████████████████████████████████████████████████████                | 5742/7473 [00:19<00:05, 298.31it/s] 77%|█████████████████████████████████████████████████████▎               | 5774/7473 [00:20<00:05, 302.49it/s] 78%|█████████████████████████████████████████████████████▌               | 5806/7473 [00:20<00:05, 305.11it/s] 78%|█████████████████████████████████████████████████████▉               | 5837/7473 [00:20<00:05, 306.50it/s] 79%|██████████████████████████████████████████████████████▏              | 5869/7473 [00:20<00:05, 308.06it/s] 79%|██████████████████████████████████████████████████████▍              | 5900/7473 [00:20<00:05, 298.09it/s] 79%|██████████████████████████████████████████████████████▊              | 5931/7473 [00:20<00:05, 301.30it/s] 80%|███████████████████████████████████████████████████████              | 5962/7473 [00:20<00:04, 302.91it/s] 80%|███████████████████████████████████████████████████████▎             | 5993/7473 [00:20<00:04, 304.88it/s] 81%|███████████████████████████████████████████████████████▌             | 6024/7473 [00:20<00:04, 306.25it/s] 81%|███████████████████████████████████████████████████████▉             | 6056/7473 [00:21<00:04, 307.53it/s] 81%|████████████████████████████████████████████████████████▏            | 6088/7473 [00:21<00:04, 308.83it/s] 82%|████████████████████████████████████████████████████████▌            | 6120/7473 [00:21<00:04, 309.38it/s] 82%|████████████████████████████████████████████████████████▊            | 6151/7473 [00:21<00:04, 307.80it/s] 83%|█████████████████████████████████████████████████████████            | 6182/7473 [00:21<00:04, 308.40it/s] 83%|█████████████████████████████████████████████████████████▍           | 6214/7473 [00:21<00:04, 309.37it/s] 84%|█████████████████████████████████████████████████████████▋           | 6245/7473 [00:21<00:03, 309.50it/s] 84%|█████████████████████████████████████████████████████████▉           | 6277/7473 [00:21<00:03, 309.79it/s] 84%|██████████████████████████████████████████████████████████▎          | 6309/7473 [00:21<00:03, 310.01it/s] 85%|██████████████████████████████████████████████████████████▌          | 6341/7473 [00:21<00:03, 310.36it/s] 85%|██████████████████████████████████████████████████████████▊          | 6373/7473 [00:22<00:03, 307.88it/s] 86%|███████████████████████████████████████████████████████████▏         | 6404/7473 [00:22<00:03, 308.28it/s] 86%|███████████████████████████████████████████████████████████▍         | 6435/7473 [00:22<00:03, 308.59it/s] 87%|███████████████████████████████████████████████████████████▋         | 6466/7473 [00:22<00:03, 308.99it/s] 87%|███████████████████████████████████████████████████████████▉         | 6498/7473 [00:22<00:03, 309.51it/s] 87%|████████████████████████████████████████████████████████████▎        | 6529/7473 [00:22<00:03, 309.42it/s] 88%|████████████████████████████████████████████████████████████▌        | 6560/7473 [00:22<00:03, 298.62it/s] 88%|████████████████████████████████████████████████████████████▊        | 6591/7473 [00:22<00:02, 301.00it/s] 89%|█████████████████████████████████████████████████████████████▏       | 6623/7473 [00:22<00:02, 304.12it/s] 89%|█████████████████████████████████████████████████████████████▍       | 6655/7473 [00:22<00:02, 306.05it/s] 89%|█████████████████████████████████████████████████████████████▋       | 6687/7473 [00:23<00:02, 307.34it/s] 90%|██████████████████████████████████████████████████████████████       | 6719/7473 [00:23<00:02, 308.87it/s] 90%|██████████████████████████████████████████████████████████████▎      | 6751/7473 [00:23<00:02, 309.78it/s] 91%|██████████████████████████████████████████████████████████████▌      | 6782/7473 [00:23<00:02, 309.77it/s] 91%|██████████████████████████████████████████████████████████████▉      | 6813/7473 [00:23<00:02, 308.29it/s] 92%|███████████████████████████████████████████████████████████████▏     | 6844/7473 [00:23<00:02, 308.75it/s] 92%|███████████████████████████████████████████████████████████████▍     | 6876/7473 [00:23<00:01, 309.71it/s] 92%|███████████████████████████████████████████████████████████████▊     | 6908/7473 [00:23<00:01, 310.73it/s] 93%|████████████████████████████████████████████████████████████████     | 6940/7473 [00:23<00:01, 311.06it/s] 93%|████████████████████████████████████████████████████████████████▎    | 6972/7473 [00:23<00:01, 310.89it/s] 94%|████████████████████████████████████████████████████████████████▋    | 7004/7473 [00:24<00:01, 311.09it/s] 94%|████████████████████████████████████████████████████████████████▉    | 7036/7473 [00:24<00:01, 308.97it/s] 95%|█████████████████████████████████████████████████████████████████▎   | 7068/7473 [00:24<00:01, 310.05it/s] 95%|█████████████████████████████████████████████████████████████████▌   | 7100/7473 [00:24<00:01, 308.85it/s] 95%|█████████████████████████████████████████████████████████████████▊   | 7131/7473 [00:24<00:01, 308.78it/s] 96%|██████████████████████████████████████████████████████████████████▏  | 7163/7473 [00:24<00:01, 309.17it/s] 96%|██████████████████████████████████████████████████████████████████▍  | 7195/7473 [00:24<00:00, 309.74it/s] 97%|██████████████████████████████████████████████████████████████████▋  | 7227/7473 [00:24<00:00, 310.36it/s] 97%|███████████████████████████████████████████████████████████████████  | 7259/7473 [00:24<00:00, 311.23it/s] 98%|███████████████████████████████████████████████████████████████████▎ | 7291/7473 [00:25<00:00, 309.80it/s] 98%|███████████████████████████████████████████████████████████████████▌ | 7323/7473 [00:25<00:00, 310.48it/s] 98%|███████████████████████████████████████████████████████████████████▉ | 7355/7473 [00:25<00:00, 310.44it/s] 99%|████████████████████████████████████████████████████████████████████▏| 7387/7473 [00:25<00:00, 311.17it/s] 99%|████████████████████████████████████████████████████████████████████▌| 7419/7473 [00:25<00:00, 308.48it/s]100%|████████████████████████████████████████████████████████████████████▊| 7450/7473 [00:25<00:00, 259.73it/s]100%|█████████████████████████████████████████████████████████████████████| 7473/7473 [00:25<00:00, 290.86it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                         | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                         | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                         | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                         | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|████████████████▎                                | 1/3 [00:04<00:09,  4.88s/it]Loading checkpoint shards:  33%|████████████████▎                                | 1/3 [00:04<00:09,  4.90s/it]Loading checkpoint shards:  33%|████████████████▎                                | 1/3 [00:05<00:10,  5.43s/it]Loading checkpoint shards:  33%|████████████████▎                                | 1/3 [00:05<00:10,  5.11s/it]Loading checkpoint shards:  67%|████████████████████████████████▋                | 2/3 [00:10<00:05,  5.10s/it]Loading checkpoint shards:  67%|████████████████████████████████▋                | 2/3 [00:09<00:05,  5.00s/it]Loading checkpoint shards:  67%|████████████████████████████████▋                | 2/3 [00:10<00:05,  5.48s/it]Loading checkpoint shards:  67%|████████████████████████████████▋                | 2/3 [00:10<00:05,  5.27s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.51s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.65s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.39s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.54s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:15<00:00,  4.89s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.04s/it]
[2023-08-15 21:49:55,364] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.02s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.07s/it]
[2023-08-15 21:50:09,342] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-15 21:50:09,343] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-15 21:50:09,344] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-15 21:50:09,344] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-15 21:50:09,344] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-15 21:50:09,344] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-15 21:50:09,344] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-15 21:50:09,344] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-15 21:50:09,344] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-15 21:50:09,344] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-15 21:50:09,344] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-15 21:50:09,344] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fb81fa74fd0>
[2023-08-15 21:50:09,344] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-15 21:50:09,344] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-15 21:50:09,344] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-15 21:50:09,344] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-15 21:50:09,344] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-15 21:50:09,345] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-15 21:50:09,345] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-15 21:50:09,345] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-15 21:50:09,345] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-15 21:50:09,345] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-15 21:50:09,345] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-15 21:50:09,345] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-15 21:50:09,345] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-15 21:50:09,345] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-15 21:50:09,345] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-15 21:50:09,345] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-15 21:50:09,345] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-15 21:50:09,345] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-15 21:50:09,345] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-15 21:50:09,345] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-15 21:50:09,345] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-15 21:50:09,345] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-15 21:50:09,345] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-15 21:50:09,345] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-15 21:50:09,345] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-15 21:50:09,345] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-15 21:50:09,345] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-15 21:50:09,345] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-15 21:50:09,345] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-15 21:50:09,345] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-15 21:50:09,345] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-15 21:50:09,345] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-15 21:50:09,345] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7fb81fa74be0>
[2023-08-15 21:50:09,345] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-15 21:50:09,345] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-15 21:50:09,345] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-15 21:50:09,345] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-15 21:50:09,345] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-15 21:50:09,345] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-15 21:50:09,345] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-15 21:50:09,346] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-15 21:50:09,346] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-15 21:50:09,346] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-15 21:50:09,346] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-15 21:50:09,346] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-15 21:50:09,346] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-15 21:50:09,346] [INFO] [config.py:1012:print]   train_batch_size ............. 8
[2023-08-15 21:50:09,346] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  2
[2023-08-15 21:50:09,346] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-15 21:50:09,346] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-15 21:50:09,346] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-15 21:50:09,346] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-15 21:50:09,346] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-15 21:50:09,346] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-15 21:50:09,346] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-15 21:50:09,346] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.7132513523101807 seconds
Loading extension module utils...
Time to load utils op: 0.7052192687988281 seconds
Loading extension module utils...
Time to load utils op: 0.7050542831420898 seconds
Loading extension module utils...
Time to load utils op: 0.7051613330841064 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating gsm8k :   0%|                                                               | 0/125 [00:00<?, ?it/s]############### Example ###############
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following grade math question.

### Demonstration:
Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Rationales: 1. First, consider what the problem is asking. It is questioning where you could find a type of plumbing that would not help you if you were in need of a drink of water.
2. In the process of elimination, start with evaluating each option and its probability of having drinkable water. 
3. Option A is oil refineries. These facilities primarily process oil, not water. As such, most of the plumbing found in oil refineries is used for the transportation of oil and other types of fuels. Drinking the water from oil refineries would have myriad health risks due to potential contamination or exposure to harmful chemicals.
4. Next, option B is a wall. Plumbing inside walls typically carries water. This water could be from the municipal supply or well, which provides potable water inside a house.
5. Option C is a "show." It's somewhat ambiguous, but it could refer to a home show or trade show, where there could be live displays of plumbing in action. In that case, it's likely there would be clean water accessible.
6. Option D is "own home," which most definitely would provide drinkable water coming from faucets, showers, and refrigerators.
7. Finally, option E is a water fountain. Water fountains are specifically designed to provide drinking water.
8. After comparing all the options, the most sensible option is "A: oil refineries." It is the only choice where the primary function does not involve the usage or transportation of drinkable water. Therefore, you could find a type of plumbing that would not be of use to you for drinking purposes.
Answer: A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Rationales: 1. First, we need to clarify the meaning of each option in the context of "beginning work".
2. "Working" cannot be the answer because when a person is beginning to work, they are technically already working.
3. "Resting" cannot be the answer either, as it is opposite to the premise. When a person is beginning to work, they certainly are not resting.
4. "Tiredness" is a state that might come during or after work, but it doesn't necessarily relate to the immediate state of beginning work. However, it does not fit as the best answer.
5. "Momentum" is a term that speaks more to the energy or drive to do work, and while it may build as a person begins work, it's not something that the person isn't doing. 
6. This leaves us with "accomplishing". When a person is just beginning to work, they may not have accomplished anything yet, as accomplishing usually indicates completion or reaching a desired outcome.
7. Therefore, "accomplishing" is the correct answer.
Answer: D: accomplishing

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Rationales: 1. The question asks us where we can find pens that have a company logo.
2. The 'company logo' part of the question suggests that the pens are likely distributed or used in a professional environment where branding is important. 
3. Choice B suggests "on a pencil" which is illogical because pencils and pens are two different types of writing tools. So, this can't be correct.
4. Choice C suggests "write sentences on paper". This is not a place where pens could be found, it's rather an action you do with a pen, hence it is incorrect.
5. Choice D: "school", while pens are indeed commonly used in this setting, pens with company logos are designed to promote the brand, they are not common or usually distributed at schools. So this is not likely the answer.
6. Choice E: "backpack" is too generic, while you may find pens inside it, this doesn't necessarily mean they would be pens with a company logo. 
7. That leaves choice A: "office", offices are professional environments where items like pens can have a company logo for branding purposes.
8. Therefore, the logical choice and answer is A: office.
Answer: A: office

Input: Billy called out to John, and listened for what? Choices:  A: silence B: response C: communication D: hanging up E: whisper
Rationales: 1. The question tells us that Billy called out to John. This tells us that Billy is attempting some form of communication with John.
2. The phrase "listened for" indicates that Billy is waiting for some sort of feedback or answer from John.
3. We can eliminate answer choice A - "silence" because Billy wouldn't call out to John to hear silence.
4. Answer choice C - "communication" could potentially be a match, but in the context of the question, communication is too broad. Billy is specifically looking for something from John, and not just general communication.
5. Answer choice D - "hanging up" and E - "whisper" are irrelevant as Billy is presumably not using a phone, and there's nothing in the context to suggest that Billy wants John to whisper.
6. Therefore, the correct answer is B: "response", because Billy called out to John and therefore would naturally be waiting for a response.
Answer: B: response

### Input:Natalia sold clips to 48 of her friends in April, and then she sold half as many clips in May. How many clips did Natalia sell altogether in April and May?

### Response:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o4-tcommonsenseqa-s1-rTrue-m4096
Evaluating gsm8k :   1%|▍                                                    | 1/125 [00:49<1:42:22, 49.54s/it]Evaluating gsm8k :   2%|▊                                                    | 2/125 [01:16<1:14:41, 36.43s/it]Evaluating gsm8k :   2%|█▎                                                   | 3/125 [02:04<1:24:33, 41.58s/it]Evaluating gsm8k :   3%|█▋                                                   | 4/125 [02:52<1:28:37, 43.95s/it]Evaluating gsm8k :   4%|██                                                   | 5/125 [03:29<1:23:27, 41.73s/it]Evaluating gsm8k :   5%|██▌                                                  | 6/125 [04:17<1:27:02, 43.89s/it]Evaluating gsm8k :   6%|██▉                                                  | 7/125 [05:05<1:28:46, 45.14s/it]Evaluating gsm8k :   6%|███▍                                                 | 8/125 [05:32<1:16:44, 39.35s/it]Evaluating gsm8k :   7%|███▊                                                 | 9/125 [06:21<1:21:46, 42.30s/it]Evaluating gsm8k :   8%|████▏                                               | 10/125 [07:09<1:24:41, 44.19s/it]Evaluating gsm8k :   9%|████▌                                               | 11/125 [07:57<1:26:13, 45.38s/it]Evaluating gsm8k :  10%|████▉                                               | 12/125 [08:46<1:27:14, 46.33s/it]Evaluating gsm8k :  10%|█████▍                                              | 13/125 [09:23<1:20:59, 43.39s/it]Evaluating gsm8k :  11%|█████▊                                              | 14/125 [10:10<1:22:48, 44.76s/it]Evaluating gsm8k :  12%|██████▏                                             | 15/125 [10:58<1:23:32, 45.57s/it]Evaluating gsm8k :  13%|██████▋                                             | 16/125 [11:43<1:22:34, 45.46s/it]Evaluating gsm8k :  14%|███████                                             | 17/125 [12:31<1:23:14, 46.25s/it]Evaluating gsm8k :  14%|███████▍                                            | 18/125 [13:19<1:23:19, 46.73s/it]Evaluating gsm8k :  15%|███████▉                                            | 19/125 [13:37<1:07:10, 38.03s/it]Evaluating gsm8k :  16%|████████▋                                             | 20/125 [13:59<58:09, 33.23s/it]Evaluating gsm8k :  17%|████████▋                                           | 21/125 [14:47<1:05:31, 37.81s/it]Evaluating gsm8k :  18%|█████████▏                                          | 22/125 [15:36<1:10:24, 41.01s/it]Evaluating gsm8k :  18%|█████████▌                                          | 23/125 [16:24<1:13:16, 43.10s/it]Evaluating gsm8k :  19%|█████████▉                                          | 24/125 [17:12<1:14:56, 44.52s/it]Evaluating gsm8k :  20%|██████████▍                                         | 25/125 [18:00<1:16:02, 45.62s/it]Evaluating gsm8k :  21%|██████████▊                                         | 26/125 [18:48<1:16:28, 46.34s/it]Evaluating gsm8k :  22%|███████████▏                                        | 27/125 [19:36<1:16:22, 46.76s/it]Evaluating gsm8k :  22%|███████████▋                                        | 28/125 [20:23<1:16:05, 47.07s/it]Evaluating gsm8k :  23%|████████████                                        | 29/125 [20:42<1:01:37, 38.51s/it]Evaluating gsm8k :  24%|████████████▍                                       | 30/125 [21:31<1:06:05, 41.74s/it]Evaluating gsm8k :  25%|████████████▉                                       | 31/125 [22:16<1:06:40, 42.56s/it]Evaluating gsm8k :  26%|█████████████▊                                        | 32/125 [22:30<52:54, 34.14s/it]Evaluating gsm8k :  26%|██████████████▎                                       | 33/125 [23:19<59:03, 38.52s/it]Evaluating gsm8k :  27%|██████████████▏                                     | 34/125 [24:04<1:01:33, 40.59s/it]Evaluating gsm8k :  28%|███████████████                                       | 35/125 [24:25<51:55, 34.61s/it]Evaluating gsm8k :  29%|███████████████▌                                      | 36/125 [25:13<57:13, 38.57s/it]Evaluating gsm8k :  30%|███████████████▍                                    | 37/125 [26:02<1:01:10, 41.71s/it]Evaluating gsm8k :  30%|███████████████▊                                    | 38/125 [26:51<1:03:30, 43.80s/it]Evaluating gsm8k :  31%|████████████████▏                                   | 39/125 [27:38<1:04:17, 44.85s/it]Evaluating gsm8k :  32%|████████████████▋                                   | 40/125 [28:26<1:04:59, 45.87s/it]Evaluating gsm8k :  33%|█████████████████▋                                    | 41/125 [28:57<57:52, 41.34s/it]Evaluating gsm8k :  34%|█████████████████▍                                  | 42/125 [29:46<1:00:14, 43.55s/it]Evaluating gsm8k :  34%|██████████████████▌                                   | 43/125 [30:22<56:47, 41.55s/it]Evaluating gsm8k :  35%|███████████████████                                   | 44/125 [31:10<58:39, 43.44s/it]Evaluating gsm8k :  36%|███████████████████▍                                  | 45/125 [31:58<59:38, 44.73s/it]Evaluating gsm8k :  37%|███████████████████▏                                | 46/125 [32:47<1:00:30, 45.96s/it]Evaluating gsm8k :  38%|███████████████████▌                                | 47/125 [33:36<1:00:50, 46.80s/it]Evaluating gsm8k :  38%|███████████████████▉                                | 48/125 [34:24<1:00:31, 47.16s/it]Evaluating gsm8k :  39%|█████████████████████▏                                | 49/125 [34:46<50:24, 39.80s/it]Evaluating gsm8k :  40%|█████████████████████▌                                | 50/125 [35:34<52:40, 42.14s/it]Evaluating gsm8k :  41%|██████████████████████                                | 51/125 [35:58<45:24, 36.81s/it]Evaluating gsm8k :  42%|██████████████████████▍                               | 52/125 [36:46<48:52, 40.18s/it]Evaluating gsm8k :  42%|██████████████████████▉                               | 53/125 [37:34<50:56, 42.45s/it]Evaluating gsm8k :  43%|███████████████████████▎                              | 54/125 [38:10<47:58, 40.54s/it]Evaluating gsm8k :  44%|███████████████████████▊                              | 55/125 [38:52<47:36, 40.81s/it]Evaluating gsm8k :  45%|████████████████████████▏                             | 56/125 [39:30<46:10, 40.16s/it]Evaluating gsm8k :  46%|████████████████████████▌                             | 57/125 [40:19<48:35, 42.87s/it]Evaluating gsm8k :  46%|█████████████████████████                             | 58/125 [40:47<42:53, 38.41s/it]Evaluating gsm8k :  47%|█████████████████████████▍                            | 59/125 [41:35<45:20, 41.22s/it]Evaluating gsm8k :  48%|█████████████████████████▉                            | 60/125 [41:51<36:27, 33.66s/it]Evaluating gsm8k :  49%|██████████████████████████▎                           | 61/125 [42:40<40:44, 38.20s/it]Evaluating gsm8k :  50%|██████████████████████████▊                           | 62/125 [43:28<43:13, 41.17s/it]Evaluating gsm8k :  50%|███████████████████████████▏                          | 63/125 [44:16<44:44, 43.29s/it]Evaluating gsm8k :  51%|███████████████████████████▋                          | 64/125 [45:04<45:26, 44.70s/it]Evaluating gsm8k :  52%|████████████████████████████                          | 65/125 [45:36<40:48, 40.80s/it]Evaluating gsm8k :  53%|████████████████████████████▌                         | 66/125 [46:24<42:12, 42.92s/it]Evaluating gsm8k :  54%|████████████████████████████▉                         | 67/125 [47:12<43:04, 44.57s/it]Evaluating gsm8k :  54%|█████████████████████████████▍                        | 68/125 [48:01<43:32, 45.84s/it]Evaluating gsm8k :  55%|█████████████████████████████▊                        | 69/125 [48:31<38:26, 41.18s/it]Evaluating gsm8k :  56%|██████████████████████████████▏                       | 70/125 [49:00<34:13, 37.33s/it]Evaluating gsm8k :  57%|██████████████████████████████▋                       | 71/125 [49:49<36:45, 40.85s/it]Evaluating gsm8k :  58%|███████████████████████████████                       | 72/125 [50:36<37:41, 42.67s/it]Evaluating gsm8k :  58%|███████████████████████████████▌                      | 73/125 [51:25<38:37, 44.58s/it]Evaluating gsm8k :  59%|███████████████████████████████▉                      | 74/125 [52:14<39:02, 45.94s/it]Evaluating gsm8k :  60%|████████████████████████████████▍                     | 75/125 [53:02<38:52, 46.65s/it]Evaluating gsm8k :  61%|████████████████████████████████▊                     | 76/125 [53:51<38:32, 47.19s/it]Evaluating gsm8k :  62%|█████████████████████████████████▎                    | 77/125 [54:23<34:12, 42.77s/it]Evaluating gsm8k :  62%|█████████████████████████████████▋                    | 78/125 [55:11<34:44, 44.35s/it]Evaluating gsm8k :  63%|██████████████████████████████████▏                   | 79/125 [55:59<34:49, 45.43s/it]Evaluating gsm8k :  64%|██████████████████████████████████▌                   | 80/125 [56:47<34:38, 46.18s/it]Evaluating gsm8k :  65%|██████████████████████████████████▉                   | 81/125 [57:14<29:34, 40.34s/it]Evaluating gsm8k :  66%|███████████████████████████████████▍                  | 82/125 [58:02<30:36, 42.72s/it]Evaluating gsm8k :  66%|███████████████████████████████████▊                  | 83/125 [58:33<27:28, 39.26s/it]Evaluating gsm8k :  67%|████████████████████████████████████▎                 | 84/125 [59:21<28:35, 41.84s/it]Evaluating gsm8k :  68%|███████████████████████████████████▎                | 85/125 [1:00:09<29:03, 43.60s/it]Evaluating gsm8k :  69%|███████████████████████████████████▊                | 86/125 [1:00:57<29:15, 45.00s/it]Evaluating gsm8k :  70%|████████████████████████████████████▏               | 87/125 [1:01:45<29:03, 45.88s/it]Evaluating gsm8k :  70%|████████████████████████████████████▌               | 88/125 [1:02:17<25:46, 41.80s/it]Evaluating gsm8k :  71%|█████████████████████████████████████               | 89/125 [1:02:41<21:55, 36.53s/it]Evaluating gsm8k :  72%|█████████████████████████████████████▍              | 90/125 [1:03:30<23:30, 40.29s/it]Evaluating gsm8k :  73%|█████████████████████████████████████▊              | 91/125 [1:03:41<17:46, 31.37s/it]Evaluating gsm8k :  74%|██████████████████████████████████████▎             | 92/125 [1:04:29<20:00, 36.37s/it]Evaluating gsm8k :  74%|██████████████████████████████████████▋             | 93/125 [1:05:17<21:19, 39.97s/it]Evaluating gsm8k :  75%|███████████████████████████████████████             | 94/125 [1:06:06<21:54, 42.39s/it]Evaluating gsm8k :  76%|███████████████████████████████████████▌            | 95/125 [1:06:26<17:51, 35.70s/it]Evaluating gsm8k :  77%|███████████████████████████████████████▉            | 96/125 [1:07:14<19:06, 39.53s/it]Evaluating gsm8k :  78%|████████████████████████████████████████▎           | 97/125 [1:08:03<19:45, 42.35s/it]Evaluating gsm8k :  78%|████████████████████████████████████████▊           | 98/125 [1:08:51<19:47, 43.99s/it]Evaluating gsm8k :  79%|█████████████████████████████████████████▏          | 99/125 [1:09:02<14:51, 34.30s/it]Evaluating gsm8k :  80%|████████████████████████████████████████▊          | 100/125 [1:09:51<16:02, 38.51s/it]Evaluating gsm8k :  81%|█████████████████████████████████████████▏         | 101/125 [1:10:38<16:30, 41.25s/it]Evaluating gsm8k :  82%|█████████████████████████████████████████▌         | 102/125 [1:11:14<15:07, 39.46s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████         | 103/125 [1:12:01<15:21, 41.88s/it]Evaluating gsm8k :  83%|██████████████████████████████████████████▍        | 104/125 [1:12:28<13:03, 37.29s/it]Evaluating gsm8k :  84%|██████████████████████████████████████████▊        | 105/125 [1:13:16<13:32, 40.62s/it]Evaluating gsm8k :  85%|███████████████████████████████████████████▏       | 106/125 [1:13:48<12:01, 37.97s/it]Evaluating gsm8k :  86%|███████████████████████████████████████████▋       | 107/125 [1:14:25<11:17, 37.63s/it]Evaluating gsm8k :  86%|████████████████████████████████████████████       | 108/125 [1:15:14<11:38, 41.07s/it]Evaluating gsm8k :  87%|████████████████████████████████████████████▍      | 109/125 [1:15:59<11:16, 42.27s/it]Evaluating gsm8k :  88%|████████████████████████████████████████████▉      | 110/125 [1:16:47<11:01, 44.09s/it]Evaluating gsm8k :  89%|█████████████████████████████████████████████▎     | 111/125 [1:17:36<10:36, 45.44s/it]Evaluating gsm8k :  90%|█████████████████████████████████████████████▋     | 112/125 [1:18:23<09:56, 45.87s/it]Evaluating gsm8k :  90%|██████████████████████████████████████████████     | 113/125 [1:19:11<09:18, 46.55s/it]Evaluating gsm8k :  91%|██████████████████████████████████████████████▌    | 114/125 [1:19:59<08:35, 46.88s/it]Evaluating gsm8k :  92%|██████████████████████████████████████████████▉    | 115/125 [1:20:37<07:21, 44.20s/it]Evaluating gsm8k :  93%|███████████████████████████████████████████████▎   | 116/125 [1:21:25<06:48, 45.43s/it]Evaluating gsm8k :  94%|███████████████████████████████████████████████▋   | 117/125 [1:21:42<04:55, 36.98s/it]Evaluating gsm8k :  94%|████████████████████████████████████████████████▏  | 118/125 [1:22:31<04:43, 40.47s/it]Evaluating gsm8k :  95%|████████████████████████████████████████████████▌  | 119/125 [1:22:51<03:26, 34.34s/it]Evaluating gsm8k :  96%|████████████████████████████████████████████████▉  | 120/125 [1:23:17<02:39, 31.92s/it]Evaluating gsm8k :  97%|█████████████████████████████████████████████████▎ | 121/125 [1:24:05<02:27, 36.76s/it]Evaluating gsm8k :  98%|█████████████████████████████████████████████████▊ | 122/125 [1:24:28<01:38, 32.75s/it]Evaluating gsm8k :  98%|██████████████████████████████████████████████████▏| 123/125 [1:25:10<01:10, 35.26s/it]Evaluating gsm8k :  99%|██████████████████████████████████████████████████▌| 124/125 [1:25:59<00:39, 39.51s/it]Evaluating gsm8k : 100%|███████████████████████████████████████████████████| 125/125 [1:26:48<00:00, 42.47s/it]Evaluating gsm8k : 100%|███████████████████████████████████████████████████| 125/125 [1:26:48<00:00, 41.67s/it]
name: gsm8k | {'exact_match': 0.0, 'rougeL': 0.1597} | lm_loss 10.1663 | avg. gen lenth: 332.088
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name gsm8k --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name commonsenseqa --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --max-prompt-length 4096 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 2 --data-dir /scratch/ylu130/processed_data/gsm8k/out-domain/o5-tcommonsenseqa-s1-rTrue --seed 1 --rationales --num-out-domain 5
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-15 23:22:18,524] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... gsm8k
  data_dir ..................... /scratch/ylu130/processed_data/gsm8k/out-domain/o5-tcommonsenseqa-s1-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 5
  out_domain_data_name ......... commonsenseqa
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 4096
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o5-tcommonsenseqa-s1-rTrue-m4096
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 2
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                 | 0/7473 [00:00<?, ?it/s]  0%|▏                                                                      | 18/7473 [00:00<00:41, 178.17it/s]  0%|▎                                                                      | 36/7473 [00:00<00:41, 177.55it/s]  1%|▌                                                                      | 54/7473 [00:00<00:41, 178.09it/s]  1%|▋                                                                      | 72/7473 [00:00<00:41, 178.49it/s]  1%|▊                                                                      | 90/7473 [00:00<00:41, 178.89it/s]  1%|█                                                                     | 108/7473 [00:00<00:41, 178.01it/s]  2%|█▏                                                                    | 126/7473 [00:00<00:41, 177.81it/s]  2%|█▎                                                                    | 144/7473 [00:00<00:41, 175.41it/s]  2%|█▌                                                                    | 162/7473 [00:00<00:41, 176.38it/s]  2%|█▋                                                                    | 180/7473 [00:01<00:41, 176.53it/s]  3%|█▊                                                                    | 198/7473 [00:01<00:41, 176.94it/s]  3%|██                                                                    | 216/7473 [00:01<00:40, 177.46it/s]  3%|██▏                                                                   | 234/7473 [00:01<00:40, 177.46it/s]  3%|██▎                                                                   | 252/7473 [00:01<00:41, 175.51it/s]  4%|██▌                                                                   | 270/7473 [00:01<00:40, 176.14it/s]  4%|██▋                                                                   | 288/7473 [00:01<00:40, 176.73it/s]  4%|██▊                                                                   | 306/7473 [00:01<00:40, 176.80it/s]  4%|███                                                                   | 324/7473 [00:01<00:40, 175.46it/s]  5%|███▏                                                                  | 342/7473 [00:01<00:40, 175.36it/s]  5%|███▎                                                                  | 360/7473 [00:02<00:40, 175.88it/s]  5%|███▌                                                                  | 379/7473 [00:02<00:39, 179.21it/s]  5%|███▊                                                                  | 406/7473 [00:02<00:34, 205.36it/s]  6%|████                                                                  | 433/7473 [00:02<00:31, 223.92it/s]  6%|████▎                                                                 | 460/7473 [00:02<00:29, 237.07it/s]  7%|████▌                                                                 | 487/7473 [00:02<00:28, 244.77it/s]  7%|████▊                                                                 | 514/7473 [00:02<00:27, 251.64it/s]  7%|█████                                                                 | 541/7473 [00:02<00:27, 256.32it/s]  8%|█████▎                                                                | 568/7473 [00:02<00:26, 258.80it/s]  8%|█████▌                                                                | 595/7473 [00:02<00:26, 260.88it/s]  8%|█████▊                                                                | 622/7473 [00:03<00:26, 262.69it/s]  9%|██████                                                                | 649/7473 [00:03<00:25, 263.00it/s]  9%|██████▎                                                               | 676/7473 [00:03<00:25, 265.06it/s]  9%|██████▌                                                               | 703/7473 [00:03<00:25, 264.84it/s] 10%|██████▊                                                               | 731/7473 [00:03<00:25, 266.56it/s] 10%|███████                                                               | 758/7473 [00:03<00:25, 266.70it/s] 11%|███████▎                                                              | 785/7473 [00:03<00:25, 266.68it/s] 11%|███████▌                                                              | 812/7473 [00:03<00:24, 266.85it/s] 11%|███████▊                                                              | 839/7473 [00:03<00:24, 266.58it/s] 12%|████████                                                              | 866/7473 [00:03<00:24, 264.90it/s] 12%|████████▎                                                             | 894/7473 [00:04<00:24, 267.34it/s] 12%|████████▋                                                             | 922/7473 [00:04<00:24, 269.40it/s] 13%|████████▉                                                             | 949/7473 [00:04<00:24, 269.48it/s] 13%|█████████▏                                                            | 976/7473 [00:04<00:24, 268.23it/s] 13%|█████████▎                                                           | 1004/7473 [00:04<00:23, 269.74it/s] 14%|█████████▌                                                           | 1032/7473 [00:04<00:23, 271.63it/s] 14%|█████████▊                                                           | 1060/7473 [00:04<00:23, 273.00it/s] 15%|██████████                                                           | 1088/7473 [00:04<00:23, 273.53it/s] 15%|██████████▎                                                          | 1116/7473 [00:04<00:23, 273.53it/s] 15%|██████████▌                                                          | 1144/7473 [00:04<00:23, 271.68it/s] 16%|██████████▊                                                          | 1172/7473 [00:05<00:23, 268.46it/s] 16%|███████████                                                          | 1200/7473 [00:05<00:23, 270.23it/s] 16%|███████████▎                                                         | 1228/7473 [00:05<00:23, 271.16it/s] 17%|███████████▌                                                         | 1256/7473 [00:05<00:22, 272.05it/s] 17%|███████████▊                                                         | 1284/7473 [00:05<00:22, 272.97it/s] 18%|████████████                                                         | 1312/7473 [00:05<00:22, 273.53it/s] 18%|████████████▎                                                        | 1340/7473 [00:05<00:22, 273.30it/s] 18%|████████████▋                                                        | 1368/7473 [00:05<00:22, 273.54it/s] 19%|████████████▉                                                        | 1396/7473 [00:05<00:22, 271.51it/s] 19%|█████████████▏                                                       | 1424/7473 [00:06<00:22, 271.64it/s] 19%|█████████████▍                                                       | 1452/7473 [00:06<00:22, 269.28it/s] 20%|█████████████▋                                                       | 1480/7473 [00:06<00:22, 269.96it/s] 20%|█████████████▉                                                       | 1508/7473 [00:06<00:21, 271.88it/s] 21%|██████████████▏                                                      | 1536/7473 [00:06<00:21, 272.66it/s] 21%|██████████████▍                                                      | 1564/7473 [00:06<00:21, 272.32it/s] 21%|██████████████▋                                                      | 1592/7473 [00:06<00:21, 272.21it/s] 22%|██████████████▉                                                      | 1620/7473 [00:06<00:21, 270.76it/s] 22%|███████████████▏                                                     | 1648/7473 [00:06<00:21, 271.95it/s] 22%|███████████████▍                                                     | 1676/7473 [00:06<00:21, 272.80it/s] 23%|███████████████▋                                                     | 1704/7473 [00:07<00:21, 273.23it/s] 23%|███████████████▉                                                     | 1732/7473 [00:07<00:21, 272.39it/s] 24%|████████████████▎                                                    | 1760/7473 [00:07<00:21, 270.75it/s] 24%|████████████████▌                                                    | 1788/7473 [00:07<00:20, 271.04it/s] 24%|████████████████▊                                                    | 1816/7473 [00:07<00:20, 271.31it/s] 25%|█████████████████                                                    | 1844/7473 [00:07<00:20, 269.78it/s] 25%|█████████████████▎                                                   | 1872/7473 [00:07<00:20, 270.92it/s] 25%|█████████████████▌                                                   | 1900/7473 [00:07<00:20, 271.18it/s] 26%|█████████████████▊                                                   | 1928/7473 [00:07<00:20, 271.50it/s] 26%|██████████████████                                                   | 1956/7473 [00:07<00:20, 272.16it/s] 27%|██████████████████▎                                                  | 1984/7473 [00:08<00:20, 272.22it/s] 27%|██████████████████▌                                                  | 2012/7473 [00:08<00:20, 270.15it/s] 27%|██████████████████▊                                                  | 2040/7473 [00:08<00:20, 270.99it/s] 28%|███████████████████                                                  | 2068/7473 [00:08<00:20, 270.10it/s] 28%|███████████████████▎                                                 | 2096/7473 [00:08<00:19, 271.22it/s] 28%|███████████████████▌                                                 | 2124/7473 [00:08<00:19, 271.09it/s] 29%|███████████████████▊                                                 | 2152/7473 [00:08<00:19, 272.05it/s] 29%|████████████████████▏                                                | 2180/7473 [00:08<00:19, 272.59it/s] 30%|████████████████████▍                                                | 2208/7473 [00:08<00:19, 273.00it/s] 30%|████████████████████▋                                                | 2236/7473 [00:09<00:19, 272.83it/s] 30%|████████████████████▉                                                | 2264/7473 [00:09<00:19, 271.65it/s] 31%|█████████████████████▏                                               | 2292/7473 [00:09<00:19, 269.83it/s] 31%|█████████████████████▍                                               | 2319/7473 [00:09<00:19, 268.58it/s] 31%|█████████████████████▋                                               | 2346/7473 [00:09<00:19, 266.99it/s] 32%|█████████████████████▉                                               | 2373/7473 [00:09<00:19, 267.82it/s] 32%|██████████████████████▏                                              | 2401/7473 [00:09<00:18, 269.77it/s] 33%|██████████████████████▍                                              | 2429/7473 [00:09<00:18, 270.95it/s] 33%|██████████████████████▋                                              | 2457/7473 [00:09<00:18, 271.80it/s] 33%|██████████████████████▉                                              | 2485/7473 [00:09<00:18, 272.09it/s] 34%|███████████████████████▏                                             | 2513/7473 [00:10<00:18, 272.16it/s] 34%|███████████████████████▍                                             | 2541/7473 [00:10<00:20, 244.89it/s] 34%|███████████████████████▋                                             | 2569/7473 [00:10<00:19, 252.43it/s] 35%|███████████████████████▉                                             | 2596/7473 [00:10<00:18, 257.17it/s] 35%|████████████████████████▏                                            | 2624/7473 [00:10<00:18, 260.99it/s] 35%|████████████████████████▍                                            | 2652/7473 [00:10<00:18, 264.34it/s] 36%|████████████████████████▋                                            | 2680/7473 [00:10<00:17, 267.22it/s] 36%|█████████████████████████                                            | 2708/7473 [00:10<00:17, 269.12it/s] 37%|█████████████████████████▎                                           | 2736/7473 [00:10<00:17, 270.55it/s] 37%|█████████████████████████▌                                           | 2764/7473 [00:10<00:17, 269.67it/s] 37%|█████████████████████████▊                                           | 2792/7473 [00:11<00:17, 270.94it/s] 38%|██████████████████████████                                           | 2820/7473 [00:11<00:17, 271.80it/s] 38%|██████████████████████████▎                                          | 2848/7473 [00:11<00:16, 272.83it/s] 38%|██████████████████████████▌                                          | 2876/7473 [00:11<00:16, 272.56it/s] 39%|██████████████████████████▊                                          | 2904/7473 [00:11<00:16, 272.79it/s] 39%|███████████████████████████                                          | 2932/7473 [00:11<00:16, 273.59it/s] 40%|███████████████████████████▎                                         | 2960/7473 [00:11<00:17, 263.61it/s] 40%|███████████████████████████▌                                         | 2987/7473 [00:11<00:17, 262.55it/s] 40%|███████████████████████████▊                                         | 3015/7473 [00:11<00:16, 265.60it/s] 41%|████████████████████████████                                         | 3043/7473 [00:12<00:16, 267.84it/s] 41%|████████████████████████████▎                                        | 3071/7473 [00:12<00:16, 269.78it/s] 41%|████████████████████████████▌                                        | 3099/7473 [00:12<00:16, 269.78it/s] 42%|████████████████████████████▊                                        | 3126/7473 [00:12<00:16, 269.80it/s] 42%|█████████████████████████████                                        | 3154/7473 [00:12<00:15, 270.60it/s] 43%|█████████████████████████████▍                                       | 3182/7473 [00:12<00:15, 268.83it/s] 43%|█████████████████████████████▋                                       | 3209/7473 [00:12<00:15, 267.91it/s] 43%|█████████████████████████████▉                                       | 3237/7473 [00:12<00:15, 269.15it/s] 44%|██████████████████████████████▏                                      | 3265/7473 [00:12<00:15, 270.02it/s] 44%|██████████████████████████████▍                                      | 3293/7473 [00:12<00:15, 271.00it/s] 44%|██████████████████████████████▋                                      | 3321/7473 [00:13<00:15, 271.59it/s] 45%|██████████████████████████████▉                                      | 3349/7473 [00:13<00:15, 270.96it/s] 45%|███████████████████████████████▏                                     | 3377/7473 [00:13<00:15, 271.32it/s] 46%|███████████████████████████████▍                                     | 3405/7473 [00:13<00:14, 271.92it/s] 46%|███████████████████████████████▋                                     | 3433/7473 [00:13<00:14, 269.76it/s] 46%|███████████████████████████████▉                                     | 3461/7473 [00:13<00:14, 270.26it/s] 47%|████████████████████████████████▏                                    | 3489/7473 [00:13<00:14, 271.03it/s] 47%|████████████████████████████████▍                                    | 3517/7473 [00:13<00:14, 271.50it/s] 47%|████████████████████████████████▋                                    | 3545/7473 [00:13<00:14, 271.63it/s] 48%|████████████████████████████████▉                                    | 3573/7473 [00:13<00:14, 271.02it/s] 48%|█████████████████████████████████▏                                   | 3601/7473 [00:14<00:14, 270.58it/s] 49%|█████████████████████████████████▌                                   | 3629/7473 [00:14<00:14, 268.47it/s] 49%|█████████████████████████████████▊                                   | 3656/7473 [00:14<00:14, 266.09it/s] 49%|██████████████████████████████████                                   | 3684/7473 [00:14<00:14, 268.11it/s] 50%|██████████████████████████████████▎                                  | 3712/7473 [00:14<00:13, 269.13it/s] 50%|██████████████████████████████████▌                                  | 3740/7473 [00:14<00:13, 270.08it/s] 50%|██████████████████████████████████▊                                  | 3768/7473 [00:14<00:13, 270.71it/s] 51%|███████████████████████████████████                                  | 3796/7473 [00:14<00:13, 271.45it/s] 51%|███████████████████████████████████▎                                 | 3824/7473 [00:14<00:13, 271.76it/s] 52%|███████████████████████████████████▌                                 | 3852/7473 [00:15<00:13, 271.95it/s] 52%|███████████████████████████████████▊                                 | 3880/7473 [00:15<00:13, 269.38it/s] 52%|████████████████████████████████████                                 | 3907/7473 [00:15<00:13, 269.10it/s] 53%|████████████████████████████████████▎                                | 3935/7473 [00:15<00:13, 270.39it/s] 53%|████████████████████████████████████▌                                | 3963/7473 [00:15<00:12, 270.44it/s] 53%|████████████████████████████████████▊                                | 3991/7473 [00:15<00:12, 270.18it/s] 54%|█████████████████████████████████████                                | 4019/7473 [00:15<00:12, 270.94it/s] 54%|█████████████████████████████████████▎                               | 4047/7473 [00:15<00:12, 271.72it/s] 55%|█████████████████████████████████████▋                               | 4075/7473 [00:15<00:12, 271.81it/s] 55%|█████████████████████████████████████▉                               | 4103/7473 [00:15<00:12, 269.08it/s] 55%|██████████████████████████████████████▏                              | 4130/7473 [00:16<00:12, 267.26it/s] 56%|██████████████████████████████████████▍                              | 4158/7473 [00:16<00:12, 268.54it/s] 56%|██████████████████████████████████████▋                              | 4185/7473 [00:16<00:12, 268.30it/s] 56%|██████████████████████████████████████▉                              | 4213/7473 [00:16<00:12, 269.51it/s] 57%|███████████████████████████████████████▏                             | 4241/7473 [00:16<00:11, 270.46it/s] 57%|███████████████████████████████████████▍                             | 4269/7473 [00:16<00:11, 269.70it/s] 57%|███████████████████████████████████████▋                             | 4296/7473 [00:16<00:11, 269.19it/s] 58%|███████████████████████████████████████▉                             | 4324/7473 [00:16<00:11, 270.00it/s] 58%|████████████████████████████████████████▏                            | 4351/7473 [00:16<00:11, 269.57it/s] 59%|████████████████████████████████████████▍                            | 4379/7473 [00:16<00:11, 270.02it/s] 59%|████████████████████████████████████████▋                            | 4407/7473 [00:17<00:11, 270.53it/s] 59%|████████████████████████████████████████▉                            | 4435/7473 [00:17<00:11, 270.62it/s] 60%|█████████████████████████████████████████▏                           | 4463/7473 [00:17<00:11, 271.10it/s] 60%|█████████████████████████████████████████▍                           | 4491/7473 [00:17<00:11, 270.78it/s] 60%|█████████████████████████████████████████▋                           | 4519/7473 [00:17<00:10, 270.50it/s] 61%|█████████████████████████████████████████▉                           | 4547/7473 [00:17<00:10, 269.28it/s] 61%|██████████████████████████████████████████▏                          | 4574/7473 [00:17<00:10, 267.12it/s] 62%|██████████████████████████████████████████▍                          | 4602/7473 [00:17<00:10, 268.19it/s] 62%|██████████████████████████████████████████▋                          | 4630/7473 [00:17<00:10, 269.60it/s] 62%|███████████████████████████████████████████                          | 4658/7473 [00:18<00:10, 269.77it/s] 63%|███████████████████████████████████████████▎                         | 4685/7473 [00:18<00:10, 267.96it/s] 63%|███████████████████████████████████████████▌                         | 4712/7473 [00:18<00:10, 268.11it/s] 63%|███████████████████████████████████████████▊                         | 4739/7473 [00:18<00:10, 268.39it/s] 64%|████████████████████████████████████████████                         | 4767/7473 [00:18<00:10, 269.53it/s] 64%|████████████████████████████████████████████▎                        | 4794/7473 [00:18<00:09, 268.33it/s] 65%|████████████████████████████████████████████▌                        | 4821/7473 [00:18<00:09, 268.81it/s] 65%|████████████████████████████████████████████▊                        | 4849/7473 [00:18<00:09, 269.93it/s] 65%|█████████████████████████████████████████████                        | 4877/7473 [00:18<00:09, 270.31it/s] 66%|█████████████████████████████████████████████▎                       | 4905/7473 [00:18<00:09, 271.58it/s] 66%|█████████████████████████████████████████████▌                       | 4933/7473 [00:19<00:09, 270.99it/s] 66%|█████████████████████████████████████████████▊                       | 4961/7473 [00:19<00:09, 271.43it/s] 67%|██████████████████████████████████████████████                       | 4989/7473 [00:19<00:09, 270.82it/s] 67%|██████████████████████████████████████████████▎                      | 5017/7473 [00:19<00:09, 262.54it/s] 67%|██████████████████████████████████████████████▌                      | 5044/7473 [00:19<00:09, 262.53it/s] 68%|██████████████████████████████████████████████▊                      | 5072/7473 [00:19<00:09, 265.51it/s] 68%|███████████████████████████████████████████████                      | 5100/7473 [00:19<00:08, 267.52it/s] 69%|███████████████████████████████████████████████▎                     | 5128/7473 [00:19<00:08, 268.83it/s] 69%|███████████████████████████████████████████████▌                     | 5156/7473 [00:19<00:08, 269.62it/s] 69%|███████████████████████████████████████████████▊                     | 5184/7473 [00:19<00:08, 270.77it/s] 70%|████████████████████████████████████████████████                     | 5212/7473 [00:20<00:08, 271.35it/s] 70%|████████████████████████████████████████████████▍                    | 5240/7473 [00:20<00:08, 270.96it/s] 70%|████████████████████████████████████████████████▋                    | 5268/7473 [00:20<00:09, 236.82it/s] 71%|████████████████████████████████████████████████▉                    | 5295/7473 [00:20<00:08, 245.13it/s] 71%|█████████████████████████████████████████████████▏                   | 5322/7473 [00:20<00:08, 251.39it/s] 72%|█████████████████████████████████████████████████▍                   | 5350/7473 [00:20<00:08, 256.98it/s] 72%|█████████████████████████████████████████████████▋                   | 5378/7473 [00:20<00:08, 261.53it/s] 72%|█████████████████████████████████████████████████▉                   | 5406/7473 [00:20<00:07, 264.81it/s] 73%|██████████████████████████████████████████████████▏                  | 5434/7473 [00:20<00:07, 267.07it/s] 73%|██████████████████████████████████████████████████▍                  | 5462/7473 [00:21<00:07, 268.01it/s] 73%|██████████████████████████████████████████████████▋                  | 5489/7473 [00:21<00:11, 176.04it/s] 74%|██████████████████████████████████████████████████▉                  | 5517/7473 [00:21<00:09, 196.83it/s] 74%|███████████████████████████████████████████████████▏                 | 5544/7473 [00:21<00:09, 212.13it/s] 75%|███████████████████████████████████████████████████▍                 | 5571/7473 [00:21<00:08, 226.50it/s] 75%|███████████████████████████████████████████████████▋                 | 5598/7473 [00:21<00:07, 237.78it/s] 75%|███████████████████████████████████████████████████▉                 | 5626/7473 [00:21<00:07, 247.45it/s] 76%|████████████████████████████████████████████████████▏                | 5654/7473 [00:21<00:07, 254.78it/s] 76%|████████████████████████████████████████████████████▍                | 5681/7473 [00:22<00:06, 258.12it/s] 76%|████████████████████████████████████████████████████▋                | 5709/7473 [00:22<00:06, 261.89it/s] 77%|████████████████████████████████████████████████████▉                | 5737/7473 [00:22<00:06, 264.49it/s] 77%|█████████████████████████████████████████████████████▏               | 5764/7473 [00:22<00:06, 266.02it/s] 78%|█████████████████████████████████████████████████████▍               | 5792/7473 [00:22<00:06, 267.58it/s] 78%|█████████████████████████████████████████████████████▋               | 5819/7473 [00:22<00:06, 267.99it/s] 78%|█████████████████████████████████████████████████████▉               | 5846/7473 [00:22<00:06, 266.54it/s] 79%|██████████████████████████████████████████████████████▏              | 5873/7473 [00:22<00:05, 267.54it/s] 79%|██████████████████████████████████████████████████████▍              | 5900/7473 [00:22<00:05, 266.49it/s] 79%|██████████████████████████████████████████████████████▋              | 5928/7473 [00:22<00:05, 267.60it/s] 80%|██████████████████████████████████████████████████████▉              | 5956/7473 [00:23<00:05, 268.46it/s] 80%|███████████████████████████████████████████████████████▎             | 5984/7473 [00:23<00:05, 268.86it/s] 80%|███████████████████████████████████████████████████████▌             | 6011/7473 [00:23<00:05, 268.54it/s] 81%|███████████████████████████████████████████████████████▊             | 6039/7473 [00:23<00:05, 269.04it/s] 81%|████████████████████████████████████████████████████████             | 6067/7473 [00:23<00:05, 269.79it/s] 82%|████████████████████████████████████████████████████████▎            | 6095/7473 [00:23<00:05, 270.00it/s] 82%|████████████████████████████████████████████████████████▌            | 6123/7473 [00:23<00:05, 268.31it/s] 82%|████████████████████████████████████████████████████████▊            | 6150/7473 [00:23<00:04, 265.07it/s] 83%|█████████████████████████████████████████████████████████            | 6178/7473 [00:23<00:04, 266.61it/s] 83%|█████████████████████████████████████████████████████████▎           | 6206/7473 [00:23<00:04, 267.94it/s] 83%|█████████████████████████████████████████████████████████▌           | 6233/7473 [00:24<00:04, 267.80it/s] 84%|█████████████████████████████████████████████████████████▊           | 6261/7473 [00:24<00:04, 268.78it/s] 84%|██████████████████████████████████████████████████████████           | 6288/7473 [00:24<00:04, 268.50it/s] 85%|██████████████████████████████████████████████████████████▎          | 6316/7473 [00:24<00:04, 269.31it/s] 85%|██████████████████████████████████████████████████████████▌          | 6343/7473 [00:24<00:04, 269.41it/s] 85%|██████████████████████████████████████████████████████████▊          | 6370/7473 [00:24<00:04, 267.54it/s] 86%|███████████████████████████████████████████████████████████          | 6397/7473 [00:24<00:04, 267.49it/s] 86%|███████████████████████████████████████████████████████████▎         | 6424/7473 [00:24<00:03, 264.53it/s] 86%|███████████████████████████████████████████████████████████▌         | 6451/7473 [00:24<00:03, 264.77it/s] 87%|███████████████████████████████████████████████████████████▊         | 6478/7473 [00:25<00:03, 266.31it/s] 87%|████████████████████████████████████████████████████████████         | 6506/7473 [00:25<00:03, 267.53it/s] 87%|████████████████████████████████████████████████████████████▎        | 6533/7473 [00:25<00:03, 268.23it/s] 88%|████████████████████████████████████████████████████████████▌        | 6561/7473 [00:25<00:03, 269.04it/s] 88%|████████████████████████████████████████████████████████████▊        | 6588/7473 [00:25<00:03, 267.53it/s] 89%|█████████████████████████████████████████████████████████████        | 6615/7473 [00:25<00:03, 267.91it/s] 89%|█████████████████████████████████████████████████████████████▎       | 6642/7473 [00:25<00:03, 268.02it/s] 89%|█████████████████████████████████████████████████████████████▌       | 6669/7473 [00:25<00:02, 268.40it/s] 90%|█████████████████████████████████████████████████████████████▊       | 6696/7473 [00:25<00:02, 268.42it/s] 90%|██████████████████████████████████████████████████████████████       | 6723/7473 [00:25<00:02, 266.38it/s] 90%|██████████████████████████████████████████████████████████████▎      | 6750/7473 [00:26<00:02, 267.27it/s] 91%|██████████████████████████████████████████████████████████████▌      | 6777/7473 [00:26<00:02, 267.64it/s] 91%|██████████████████████████████████████████████████████████████▊      | 6804/7473 [00:26<00:02, 268.29it/s] 91%|███████████████████████████████████████████████████████████████      | 6831/7473 [00:26<00:02, 266.09it/s] 92%|███████████████████████████████████████████████████████████████▎     | 6858/7473 [00:26<00:02, 266.76it/s] 92%|███████████████████████████████████████████████████████████████▌     | 6886/7473 [00:26<00:02, 268.20it/s] 93%|███████████████████████████████████████████████████████████████▊     | 6914/7473 [00:26<00:02, 269.21it/s] 93%|████████████████████████████████████████████████████████████████     | 6942/7473 [00:26<00:01, 269.66it/s] 93%|████████████████████████████████████████████████████████████████▎    | 6969/7473 [00:26<00:01, 269.07it/s] 94%|████████████████████████████████████████████████████████████████▌    | 6996/7473 [00:26<00:01, 266.67it/s] 94%|████████████████████████████████████████████████████████████████▊    | 7023/7473 [00:27<00:01, 267.39it/s] 94%|█████████████████████████████████████████████████████████████████    | 7050/7473 [00:27<00:01, 266.18it/s] 95%|█████████████████████████████████████████████████████████████████▎   | 7078/7473 [00:27<00:01, 267.73it/s] 95%|█████████████████████████████████████████████████████████████████▌   | 7106/7473 [00:27<00:01, 269.02it/s] 95%|█████████████████████████████████████████████████████████████████▊   | 7133/7473 [00:27<00:01, 269.02it/s] 96%|██████████████████████████████████████████████████████████████████   | 7161/7473 [00:27<00:01, 269.65it/s] 96%|██████████████████████████████████████████████████████████████████▍  | 7189/7473 [00:27<00:01, 269.81it/s] 97%|██████████████████████████████████████████████████████████████████▋  | 7217/7473 [00:27<00:00, 270.26it/s] 97%|██████████████████████████████████████████████████████████████████▉  | 7245/7473 [00:27<00:00, 271.08it/s] 97%|███████████████████████████████████████████████████████████████████▏ | 7273/7473 [00:27<00:00, 268.03it/s] 98%|███████████████████████████████████████████████████████████████████▍ | 7300/7473 [00:28<00:00, 266.31it/s] 98%|███████████████████████████████████████████████████████████████████▋ | 7328/7473 [00:28<00:00, 267.64it/s] 98%|███████████████████████████████████████████████████████████████████▉ | 7356/7473 [00:28<00:00, 268.76it/s] 99%|████████████████████████████████████████████████████████████████████▏| 7383/7473 [00:28<00:00, 268.75it/s] 99%|████████████████████████████████████████████████████████████████████▍| 7411/7473 [00:28<00:00, 269.33it/s]100%|████████████████████████████████████████████████████████████████████▋| 7439/7473 [00:28<00:00, 270.38it/s]100%|████████████████████████████████████████████████████████████████████▉| 7467/7473 [00:28<00:00, 270.48it/s]100%|█████████████████████████████████████████████████████████████████████| 7473/7473 [00:28<00:00, 260.21it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                         | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                         | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                         | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                         | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|████████████████▎                                | 1/3 [00:05<00:10,  5.46s/it]Loading checkpoint shards:  33%|████████████████▎                                | 1/3 [00:05<00:11,  5.57s/it]Loading checkpoint shards:  33%|████████████████▎                                | 1/3 [00:05<00:11,  5.54s/it]Loading checkpoint shards:  33%|████████████████▎                                | 1/3 [00:05<00:11,  5.79s/it]Loading checkpoint shards:  67%|████████████████████████████████▋                | 2/3 [00:10<00:05,  5.38s/it]Loading checkpoint shards:  67%|████████████████████████████████▋                | 2/3 [00:11<00:05,  5.57s/it]Loading checkpoint shards:  67%|████████████████████████████████▋                | 2/3 [00:11<00:05,  5.53s/it]Loading checkpoint shards:  67%|████████████████████████████████▋                | 2/3 [00:13<00:06,  6.69s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.72s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.92s/it]
[2023-08-15 23:23:39,661] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:15<00:00,  4.89s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.06s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:15<00:00,  4.84s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.03s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:17<00:00,  5.78s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:17<00:00,  5.94s/it]
[2023-08-15 23:23:59,575] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-15 23:23:59,576] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-15 23:23:59,577] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-15 23:23:59,577] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-15 23:23:59,577] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-15 23:23:59,577] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-15 23:23:59,577] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-15 23:23:59,577] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-15 23:23:59,577] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-15 23:23:59,577] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-15 23:23:59,577] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-15 23:23:59,577] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fbe4028fc70>
[2023-08-15 23:23:59,577] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-15 23:23:59,577] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-15 23:23:59,577] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-15 23:23:59,577] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-15 23:23:59,577] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-15 23:23:59,578] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-15 23:23:59,578] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-15 23:23:59,578] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-15 23:23:59,578] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-15 23:23:59,578] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-15 23:23:59,578] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-15 23:23:59,578] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-15 23:23:59,578] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-15 23:23:59,578] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-15 23:23:59,578] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-15 23:23:59,578] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-15 23:23:59,578] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-15 23:23:59,578] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-15 23:23:59,578] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-15 23:23:59,578] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-15 23:23:59,578] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-15 23:23:59,578] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-15 23:23:59,578] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-15 23:23:59,578] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-15 23:23:59,578] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-15 23:23:59,578] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-15 23:23:59,578] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-15 23:23:59,578] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-15 23:23:59,578] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-15 23:23:59,578] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-15 23:23:59,578] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-15 23:23:59,578] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-15 23:23:59,578] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7fbe4028fdc0>
[2023-08-15 23:23:59,578] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-15 23:23:59,578] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-15 23:23:59,578] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-15 23:23:59,578] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-15 23:23:59,578] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-15 23:23:59,578] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-15 23:23:59,578] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-15 23:23:59,578] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-15 23:23:59,579] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-15 23:23:59,579] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-15 23:23:59,579] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-15 23:23:59,579] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-15 23:23:59,579] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-15 23:23:59,579] [INFO] [config.py:1012:print]   train_batch_size ............. 8
[2023-08-15 23:23:59,579] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  2
[2023-08-15 23:23:59,579] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-15 23:23:59,579] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-15 23:23:59,579] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-15 23:23:59,579] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-15 23:23:59,579] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-15 23:23:59,579] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-15 23:23:59,579] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-15 23:23:59,579] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.6018946170806885 seconds
Loading extension module utils...
Time to load utils op: 0.6046617031097412 seconds
Loading extension module utils...
Time to load utils op: 0.6050665378570557 seconds
Loading extension module utils...
Time to load utils op: 0.6048531532287598 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating gsm8k :   0%|                                                               | 0/125 [00:00<?, ?it/s]############### Example ###############
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following grade math question.

### Demonstration:
Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Rationales: 1. The question is asking where you can find plumbing that won't be useful if you are thirsty. 
2. To answer the question, we need to consider the five choices provided and which of the places mentioned would not have water suitable for drinking. 
3. A wall (option B) may contain plumbing, but its purpose is generally to route water to outlets like faucets or showerheads, where one could, in theory, get water to drink. 
4. A shower (option C) and one's home (option D) actually have essential plumbing to provide water, and hence, they would be useful when you are thirsty.
5. A water fountain (option E), by its very definition, also provides water, so it would be beneficial if one were thirsty as well.
6. An oil refinery (option A), however, involves a complex plumbing system dedicated to the refining of oil - not water. This plumbing would indeed not be of use when you are thirsty, as the fluids transported within this system are not safe or appropriate for human consumption.
7. Therefore, the answer is A: oil refineries as it's the only plumbing in the options given that wouldn't satisfy your thirst.
Answer: A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Rationales: 1. First, understand the meaning of the question - "When a person is beginning work, what aren't they doing yet?" This question implies to focus on an activity that doesn't occur at the start of the work.
2. Now, review the given choices: A: working, B: resting, C: tiredness, D: accomplishing, E: momentum.
3. Choice A: working - When a person is beginning work, they are already engaging in work. So, they are working. Eliminate this option.
4. Choice B: resting - When a person is beginning work, it implies that they are not resting as the two actions are contradictory. Therefore, this option, too, is not appropriate.
5. Choice C: tiredness - As the question is about the action just at the beginning of work, feeling tired generally comes after working for a while, hence it cannot be considered here. However, the answer choice asked here for the action, not a feeling or state, so this option can be eliminated.
6. Choice D: accomplishing - This implies achieving or finishing tasks. As the question mentions the beginning of work, no task has been finished yet. So, at the beginning of work, a person couldn't be accomplishing anything. It seems to fit the context of the question.
7. Choice E: momentum - Generally, momentum is gained as a person progresses through their work. At the beginning of the work, the momentum would be low or not existent at all. But, momentum like tiredness is rather a state or condition than an action, so it should be eliminated. 
8. Therefore, the answer is D: accomplishing, referring to the activities that haven't taken place when a person is just starting to work.
Answer: D: accomplishing

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Rationales: 1. The question is asking about where one might find pens with a company logo.
2. The first step in solving this problem is understanding that pens with a company logo are typically distributed in professional settings, such as promotional events or at the company's offices.
3. Now, I examine the options. Option B, on a pencil, is incorrect because a pencil is an item and not a location.
4. Option C, writing sentences on paper, is a wrong answer because it's an action, not a place to find pens with a company logo.
5. Option D, a school, could potentially have pens with a company logo. However, it's less likely since schools often not directly associated with companies.
6. Option E, a backpack, while it is possible to physically find a pen there, it does not necessarily mean it will always carry a pen with a company logo.
7. Therefore, out of the given choices, the most likely place to find pens with a company logo is an office, option A.
Answer: A: office

Input: Billy called out to John, and listened for what? Choices:  A: silence B: response C: communication D: hanging up E: whisper
Rationales: 1. The question tells us that Billy called out to John, which indicates that he is trying to communicate with him.
2. When someone initiates a conversation, specifically by calling out, they are typically seeking some form of a reply. 
3. The question then asks what Billy is listening for after calling out to John.
4. This suggests that Billy is expecting something from John. 
5. Reviewing the choices offered, "response" best describes what Billy would be listening for.
6. Therefore, the answer is B: response.
Answer: B: response

Input: The lizard frightened the hiker, it's movements made what rustle? Choices:  A: garden B: trees C: books D: rocks E: bushes
Rationales: 1. The question is asking for what the lizard's movements made rustle, which means to make a soft, muffled cracking sound.
2. The options are a garden, trees, books, rocks, and bushes.
3. The act of rustling pertains to objects that are lightweight enough to be disturbed by small movements and also have surfaces that can rub against each other to produce a sound.  
4. Thus, we can rule out the choices of garden and rocks since these are not typically associated with the rustling sound, and books because it's uncommon to find books in a hiking environment where a lizard might frighten a hiker.
5. Between trees and bushes, bushes are more likely to rustle because they are lower to the ground where a lizard would typically move.
6. Therefore, the answer is E: bushes. The lizard's movements made the bushes rustle.
Answer: E: bushes

### Input:Natalia sold clips to 48 of her friends in April, and then she sold half as many clips in May. How many clips did Natalia sell altogether in April and May?

### Response:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o5-tcommonsenseqa-s1-rTrue-m4096
Evaluating gsm8k :   1%|▍                                                    | 1/125 [00:49<1:41:20, 49.04s/it]Evaluating gsm8k :   2%|▊                                                    | 2/125 [01:35<1:37:39, 47.64s/it]Evaluating gsm8k :   2%|█▎                                                   | 3/125 [01:57<1:12:35, 35.70s/it]Evaluating gsm8k :   3%|█▋                                                   | 4/125 [02:43<1:20:37, 39.98s/it]Evaluating gsm8k :   4%|██                                                   | 5/125 [03:29<1:24:16, 42.14s/it]Evaluating gsm8k :   5%|██▌                                                  | 6/125 [04:07<1:20:23, 40.53s/it]Evaluating gsm8k :   6%|██▉                                                  | 7/125 [04:53<1:23:22, 42.39s/it]Evaluating gsm8k :   6%|███▍                                                 | 8/125 [05:40<1:25:24, 43.80s/it]Evaluating gsm8k :   7%|███▊                                                 | 9/125 [06:23<1:24:24, 43.66s/it]Evaluating gsm8k :   8%|████▏                                               | 10/125 [07:10<1:25:32, 44.63s/it]Evaluating gsm8k :   9%|████▌                                               | 11/125 [07:47<1:20:43, 42.49s/it]Evaluating gsm8k :  10%|████▉                                               | 12/125 [08:04<1:05:11, 34.61s/it]Evaluating gsm8k :  10%|█████▍                                              | 13/125 [08:51<1:11:40, 38.39s/it]Evaluating gsm8k :  11%|█████▊                                              | 14/125 [09:38<1:15:50, 40.99s/it]Evaluating gsm8k :  12%|██████▏                                             | 15/125 [10:04<1:06:55, 36.51s/it]Evaluating gsm8k :  13%|██████▋                                             | 16/125 [10:50<1:11:37, 39.43s/it]Evaluating gsm8k :  14%|███████                                             | 17/125 [11:38<1:15:06, 41.73s/it]Evaluating gsm8k :  14%|███████▍                                            | 18/125 [12:24<1:16:52, 43.11s/it]Evaluating gsm8k :  15%|███████▉                                            | 19/125 [13:10<1:17:39, 43.96s/it]Evaluating gsm8k :  16%|████████▎                                           | 20/125 [13:56<1:18:10, 44.67s/it]Evaluating gsm8k :  17%|████████▋                                           | 21/125 [14:43<1:18:45, 45.44s/it]Evaluating gsm8k :  18%|█████████▏                                          | 22/125 [15:30<1:18:43, 45.86s/it]Evaluating gsm8k :  18%|█████████▌                                          | 23/125 [16:02<1:11:02, 41.79s/it]Evaluating gsm8k :  19%|██████████▎                                           | 24/125 [16:14<54:56, 32.63s/it]Evaluating gsm8k :  20%|██████████▊                                           | 25/125 [16:41<51:34, 30.94s/it]Evaluating gsm8k :  21%|███████████▏                                          | 26/125 [17:28<59:07, 35.83s/it]Evaluating gsm8k :  22%|███████████▋                                          | 27/125 [17:55<53:59, 33.06s/it]Evaluating gsm8k :  22%|████████████                                          | 28/125 [18:38<58:33, 36.22s/it]Evaluating gsm8k :  23%|████████████                                        | 29/125 [19:26<1:03:27, 39.66s/it]Evaluating gsm8k :  24%|████████████▍                                       | 30/125 [20:12<1:05:56, 41.65s/it]Evaluating gsm8k :  25%|████████████▉                                       | 31/125 [20:59<1:07:44, 43.24s/it]Evaluating gsm8k :  26%|█████████████▎                                      | 32/125 [21:46<1:08:34, 44.24s/it]Evaluating gsm8k :  26%|█████████████▋                                      | 33/125 [22:32<1:08:43, 44.82s/it]Evaluating gsm8k :  27%|██████████████▏                                     | 34/125 [23:18<1:08:30, 45.17s/it]Evaluating gsm8k :  28%|██████████████▌                                     | 35/125 [24:04<1:08:08, 45.43s/it]Evaluating gsm8k :  29%|██████████████▉                                     | 36/125 [24:50<1:07:39, 45.61s/it]Evaluating gsm8k :  30%|███████████████▍                                    | 37/125 [25:36<1:07:08, 45.78s/it]Evaluating gsm8k :  30%|███████████████▊                                    | 38/125 [26:15<1:03:30, 43.80s/it]Evaluating gsm8k :  31%|████████████████▏                                   | 39/125 [26:55<1:00:51, 42.46s/it]Evaluating gsm8k :  32%|█████████████████▎                                    | 40/125 [27:16<51:01, 36.02s/it]Evaluating gsm8k :  33%|█████████████████▋                                    | 41/125 [28:02<54:43, 39.09s/it]Evaluating gsm8k :  34%|██████████████████▏                                   | 42/125 [28:49<57:15, 41.39s/it]Evaluating gsm8k :  34%|██████████████████▌                                   | 43/125 [29:35<58:38, 42.91s/it]Evaluating gsm8k :  35%|███████████████████                                   | 44/125 [30:08<54:00, 40.01s/it]Evaluating gsm8k :  36%|███████████████████▍                                  | 45/125 [30:53<55:23, 41.54s/it]Evaluating gsm8k :  37%|███████████████████▊                                  | 46/125 [31:39<56:26, 42.86s/it]Evaluating gsm8k :  38%|████████████████████▎                                 | 47/125 [32:26<57:07, 43.94s/it]Evaluating gsm8k :  38%|████████████████████▋                                 | 48/125 [33:12<57:18, 44.66s/it]Evaluating gsm8k :  39%|█████████████████████▏                                | 49/125 [33:58<57:00, 45.00s/it]Evaluating gsm8k :  40%|█████████████████████▌                                | 50/125 [34:26<49:49, 39.86s/it]Evaluating gsm8k :  41%|██████████████████████                                | 51/125 [35:12<51:40, 41.89s/it]Evaluating gsm8k :  42%|██████████████████████▍                               | 52/125 [35:46<47:49, 39.31s/it]Evaluating gsm8k :  42%|██████████████████████▉                               | 53/125 [36:32<49:31, 41.27s/it]Evaluating gsm8k :  43%|███████████████████████▎                              | 54/125 [37:18<50:40, 42.82s/it]Evaluating gsm8k :  44%|███████████████████████▊                              | 55/125 [37:35<40:51, 35.02s/it]Evaluating gsm8k :  45%|████████████████████████▏                             | 56/125 [38:21<44:05, 38.34s/it]Evaluating gsm8k :  46%|████████████████████████▌                             | 57/125 [38:48<39:38, 34.98s/it]Evaluating gsm8k :  46%|█████████████████████████                             | 58/125 [39:21<38:28, 34.46s/it]Evaluating gsm8k :  47%|█████████████████████████▍                            | 59/125 [40:08<41:58, 38.17s/it]Evaluating gsm8k :  48%|█████████████████████████▉                            | 60/125 [40:54<43:48, 40.44s/it]Evaluating gsm8k :  49%|██████████████████████████▎                           | 61/125 [41:40<44:54, 42.11s/it]Evaluating gsm8k :  50%|██████████████████████████▊                           | 62/125 [42:26<45:21, 43.19s/it]Evaluating gsm8k :  50%|███████████████████████████▏                          | 63/125 [43:11<45:28, 44.01s/it]Evaluating gsm8k :  51%|███████████████████████████▋                          | 64/125 [43:56<44:45, 44.02s/it]Evaluating gsm8k :  52%|████████████████████████████                          | 65/125 [44:43<44:59, 44.99s/it]Evaluating gsm8k :  53%|████████████████████████████▌                         | 66/125 [45:18<41:21, 42.06s/it]Evaluating gsm8k :  54%|████████████████████████████▉                         | 67/125 [46:04<41:42, 43.15s/it]Evaluating gsm8k :  54%|█████████████████████████████▍                        | 68/125 [46:50<41:45, 43.96s/it]Evaluating gsm8k :  55%|█████████████████████████████▊                        | 69/125 [47:36<41:37, 44.59s/it]Evaluating gsm8k :  56%|██████████████████████████████▏                       | 70/125 [48:00<35:13, 38.43s/it]Evaluating gsm8k :  57%|██████████████████████████████▋                       | 71/125 [48:46<36:38, 40.72s/it]Evaluating gsm8k :  58%|███████████████████████████████                       | 72/125 [49:32<37:25, 42.38s/it]Evaluating gsm8k :  58%|███████████████████████████████▌                      | 73/125 [50:18<37:41, 43.49s/it]Evaluating gsm8k :  59%|███████████████████████████████▉                      | 74/125 [51:05<37:47, 44.46s/it]Evaluating gsm8k :  60%|████████████████████████████████▍                     | 75/125 [51:50<37:18, 44.78s/it]Evaluating gsm8k :  61%|████████████████████████████████▊                     | 76/125 [52:36<36:49, 45.09s/it]Evaluating gsm8k :  62%|█████████████████████████████████▎                    | 77/125 [53:23<36:28, 45.60s/it]Evaluating gsm8k :  62%|█████████████████████████████████▋                    | 78/125 [54:09<35:46, 45.68s/it]Evaluating gsm8k :  63%|██████████████████████████████████▏                   | 79/125 [54:42<32:10, 41.96s/it]Evaluating gsm8k :  64%|██████████████████████████████████▌                   | 80/125 [54:58<25:43, 34.30s/it]Evaluating gsm8k :  65%|██████████████████████████████████▉                   | 81/125 [55:45<27:53, 38.04s/it]Evaluating gsm8k :  66%|███████████████████████████████████▍                  | 82/125 [56:26<27:57, 39.00s/it]Evaluating gsm8k :  66%|███████████████████████████████████▊                  | 83/125 [57:12<28:46, 41.10s/it]Evaluating gsm8k :  67%|████████████████████████████████████▎                 | 84/125 [57:36<24:31, 35.90s/it]Evaluating gsm8k :  68%|████████████████████████████████████▋                 | 85/125 [58:15<24:35, 36.88s/it]Evaluating gsm8k :  69%|█████████████████████████████████████▏                | 86/125 [59:02<25:46, 39.64s/it]Evaluating gsm8k :  70%|█████████████████████████████████████▌                | 87/125 [59:47<26:16, 41.49s/it]Evaluating gsm8k :  70%|████████████████████████████████████▌               | 88/125 [1:00:33<26:20, 42.70s/it]Evaluating gsm8k :  71%|█████████████████████████████████████               | 89/125 [1:01:18<26:09, 43.58s/it]Evaluating gsm8k :  72%|█████████████████████████████████████▍              | 90/125 [1:01:38<21:15, 36.46s/it]Evaluating gsm8k :  73%|█████████████████████████████████████▊              | 91/125 [1:01:47<16:01, 28.28s/it]Evaluating gsm8k :  74%|██████████████████████████████████████▎             | 92/125 [1:02:34<18:28, 33.60s/it]Evaluating gsm8k :  74%|██████████████████████████████████████▋             | 93/125 [1:03:19<19:51, 37.25s/it]Evaluating gsm8k :  75%|███████████████████████████████████████             | 94/125 [1:04:06<20:38, 39.96s/it]Evaluating gsm8k :  76%|███████████████████████████████████████▌            | 95/125 [1:04:21<16:18, 32.61s/it]Evaluating gsm8k :  77%|███████████████████████████████████████▉            | 96/125 [1:05:07<17:39, 36.52s/it]Evaluating gsm8k :  78%|████████████████████████████████████████▎           | 97/125 [1:05:24<14:25, 30.89s/it]Evaluating gsm8k :  78%|████████████████████████████████████████▊           | 98/125 [1:06:11<15:57, 35.46s/it]Evaluating gsm8k :  79%|█████████████████████████████████████████▏          | 99/125 [1:06:56<16:43, 38.60s/it]Evaluating gsm8k :  80%|████████████████████████████████████████▊          | 100/125 [1:07:17<13:52, 33.29s/it]Evaluating gsm8k :  81%|█████████████████████████████████████████▏         | 101/125 [1:08:04<14:54, 37.25s/it]Evaluating gsm8k :  82%|█████████████████████████████████████████▌         | 102/125 [1:08:50<15:16, 39.87s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████         | 103/125 [1:09:02<11:32, 31.48s/it]Evaluating gsm8k :  83%|██████████████████████████████████████████▍        | 104/125 [1:09:49<12:41, 36.25s/it]Evaluating gsm8k :  84%|██████████████████████████████████████████▊        | 105/125 [1:10:35<13:04, 39.21s/it]Evaluating gsm8k :  85%|███████████████████████████████████████████▏       | 106/125 [1:11:23<13:12, 41.70s/it]Evaluating gsm8k :  86%|███████████████████████████████████████████▋       | 107/125 [1:12:09<12:54, 43.02s/it]Evaluating gsm8k :  86%|████████████████████████████████████████████       | 108/125 [1:12:55<12:26, 43.93s/it]Evaluating gsm8k :  87%|████████████████████████████████████████████▍      | 109/125 [1:13:41<11:52, 44.56s/it]Evaluating gsm8k :  88%|████████████████████████████████████████████▉      | 110/125 [1:14:07<09:44, 38.99s/it]Evaluating gsm8k :  89%|█████████████████████████████████████████████▎     | 111/125 [1:14:53<09:34, 41.07s/it]Evaluating gsm8k :  90%|█████████████████████████████████████████████▋     | 112/125 [1:15:29<08:36, 39.70s/it]Evaluating gsm8k :  90%|██████████████████████████████████████████████     | 113/125 [1:16:15<08:17, 41.44s/it]Evaluating gsm8k :  91%|██████████████████████████████████████████████▌    | 114/125 [1:16:47<07:05, 38.68s/it]Evaluating gsm8k :  92%|██████████████████████████████████████████████▉    | 115/125 [1:17:34<06:52, 41.29s/it]Evaluating gsm8k :  93%|███████████████████████████████████████████████▎   | 116/125 [1:18:21<06:26, 42.92s/it]Evaluating gsm8k :  94%|███████████████████████████████████████████████▋   | 117/125 [1:19:07<05:51, 43.91s/it]Evaluating gsm8k :  94%|████████████████████████████████████████████████▏  | 118/125 [1:19:53<05:11, 44.52s/it]Evaluating gsm8k :  95%|████████████████████████████████████████████████▌  | 119/125 [1:20:39<04:29, 44.98s/it]Evaluating gsm8k :  96%|████████████████████████████████████████████████▉  | 120/125 [1:21:26<03:46, 45.34s/it]Evaluating gsm8k :  97%|█████████████████████████████████████████████████▎ | 121/125 [1:21:46<02:31, 37.90s/it]Evaluating gsm8k :  98%|█████████████████████████████████████████████████▊ | 122/125 [1:22:16<01:46, 35.43s/it]Evaluating gsm8k :  98%|██████████████████████████████████████████████████▏| 123/125 [1:23:02<01:17, 38.59s/it]Evaluating gsm8k :  99%|██████████████████████████████████████████████████▌| 124/125 [1:23:31<00:35, 35.79s/it]Evaluating gsm8k : 100%|███████████████████████████████████████████████████| 125/125 [1:24:18<00:00, 39.19s/it]Evaluating gsm8k : 100%|███████████████████████████████████████████████████| 125/125 [1:24:18<00:00, 40.47s/it]
name: gsm8k | {'exact_match': 0.0, 'rougeL': 0.2165} | lm_loss 10.295 | avg. gen lenth: 356.164
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name gsm8k --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name commonsenseqa --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --max-prompt-length 4096 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 2 --data-dir /scratch/ylu130/processed_data/gsm8k/out-domain/o6-tcommonsenseqa-s1-rTrue --seed 1 --rationales --num-out-domain 6
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-16 00:51:45,497] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... gsm8k
  data_dir ..................... /scratch/ylu130/processed_data/gsm8k/out-domain/o6-tcommonsenseqa-s1-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 6
  out_domain_data_name ......... commonsenseqa
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 4096
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o6-tcommonsenseqa-s1-rTrue-m4096
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 2
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                 | 0/7473 [00:00<?, ?it/s]  0%|                                                                       | 13/7473 [00:00<01:01, 122.16it/s]  0%|▏                                                                      | 26/7473 [00:00<01:00, 122.80it/s]  1%|▎                                                                      | 39/7473 [00:00<01:00, 123.31it/s]  1%|▍                                                                      | 52/7473 [00:00<01:00, 123.35it/s]  1%|▌                                                                      | 65/7473 [00:00<01:00, 123.25it/s]  1%|▋                                                                      | 78/7473 [00:00<00:59, 123.85it/s]  1%|▊                                                                      | 91/7473 [00:00<01:00, 122.70it/s]  1%|▉                                                                     | 104/7473 [00:00<00:59, 123.32it/s]  2%|█                                                                     | 117/7473 [00:00<00:59, 124.22it/s]  2%|█▏                                                                    | 130/7473 [00:01<00:58, 124.66it/s]  2%|█▎                                                                    | 143/7473 [00:01<00:58, 124.94it/s]  2%|█▍                                                                    | 156/7473 [00:01<00:58, 125.23it/s]  2%|█▌                                                                    | 169/7473 [00:01<00:58, 125.09it/s]  2%|█▋                                                                    | 182/7473 [00:01<00:58, 125.45it/s]  3%|█▊                                                                    | 195/7473 [00:01<00:57, 125.51it/s]  3%|█▉                                                                    | 208/7473 [00:01<00:58, 124.70it/s]  3%|██                                                                    | 221/7473 [00:01<00:58, 124.76it/s]  3%|██▏                                                                   | 234/7473 [00:01<00:58, 124.73it/s]  3%|██▎                                                                   | 247/7473 [00:01<00:57, 124.73it/s]  3%|██▍                                                                   | 260/7473 [00:02<00:58, 122.54it/s]  4%|██▌                                                                   | 273/7473 [00:02<00:58, 123.49it/s]  4%|██▋                                                                   | 291/7473 [00:02<00:51, 139.62it/s]  4%|██▉                                                                   | 311/7473 [00:02<00:46, 155.26it/s]  4%|███                                                                   | 331/7473 [00:02<00:43, 166.02it/s]  5%|███▎                                                                  | 351/7473 [00:02<00:41, 173.39it/s]  5%|███▍                                                                  | 370/7473 [00:02<00:39, 178.19it/s]  5%|███▋                                                                  | 390/7473 [00:02<00:38, 182.10it/s]  5%|███▊                                                                  | 409/7473 [00:02<00:38, 184.39it/s]  6%|████                                                                  | 428/7473 [00:03<00:37, 185.57it/s]  6%|████▏                                                                 | 448/7473 [00:03<00:37, 186.97it/s]  6%|████▍                                                                 | 468/7473 [00:03<00:37, 188.18it/s]  7%|████▌                                                                 | 487/7473 [00:03<00:37, 187.23it/s]  7%|████▋                                                                 | 507/7473 [00:03<00:36, 188.38it/s]  7%|████▉                                                                 | 527/7473 [00:03<00:36, 189.64it/s]  7%|█████                                                                 | 547/7473 [00:03<00:36, 190.59it/s]  8%|█████▎                                                                | 567/7473 [00:03<00:36, 190.93it/s]  8%|█████▍                                                                | 587/7473 [00:03<00:36, 190.76it/s]  8%|█████▋                                                                | 607/7473 [00:03<00:36, 190.69it/s]  8%|█████▊                                                                | 627/7473 [00:04<00:35, 190.60it/s]  9%|██████                                                                | 647/7473 [00:04<00:35, 191.03it/s]  9%|██████▏                                                               | 667/7473 [00:04<00:35, 189.58it/s]  9%|██████▍                                                               | 687/7473 [00:04<00:35, 190.21it/s]  9%|██████▌                                                               | 707/7473 [00:04<00:36, 187.83it/s] 10%|██████▊                                                               | 727/7473 [00:04<00:35, 189.28it/s] 10%|██████▉                                                               | 747/7473 [00:04<00:35, 189.96it/s] 10%|███████▏                                                              | 767/7473 [00:04<00:35, 190.54it/s] 11%|███████▎                                                              | 787/7473 [00:04<00:35, 190.62it/s] 11%|███████▌                                                              | 807/7473 [00:05<00:34, 190.77it/s] 11%|███████▋                                                              | 827/7473 [00:05<00:34, 190.86it/s] 11%|███████▉                                                              | 847/7473 [00:05<00:34, 191.14it/s] 12%|████████                                                              | 867/7473 [00:05<00:34, 191.15it/s] 12%|████████▎                                                             | 887/7473 [00:05<00:34, 191.32it/s] 12%|████████▍                                                             | 907/7473 [00:05<00:34, 191.39it/s] 12%|████████▋                                                             | 927/7473 [00:05<00:34, 191.05it/s] 13%|████████▊                                                             | 947/7473 [00:05<00:34, 189.74it/s] 13%|█████████                                                             | 967/7473 [00:05<00:34, 190.05it/s] 13%|█████████▏                                                            | 987/7473 [00:05<00:34, 190.71it/s] 13%|█████████▎                                                           | 1007/7473 [00:06<00:33, 190.65it/s] 14%|█████████▍                                                           | 1027/7473 [00:06<00:33, 191.13it/s] 14%|█████████▋                                                           | 1047/7473 [00:06<00:33, 191.02it/s] 14%|█████████▊                                                           | 1067/7473 [00:06<00:33, 191.40it/s] 15%|██████████                                                           | 1087/7473 [00:06<00:33, 191.54it/s] 15%|██████████▏                                                          | 1107/7473 [00:06<00:33, 191.33it/s] 15%|██████████▍                                                          | 1127/7473 [00:06<00:33, 191.15it/s] 15%|██████████▌                                                          | 1147/7473 [00:06<00:33, 191.17it/s] 16%|██████████▊                                                          | 1167/7473 [00:06<00:33, 189.57it/s] 16%|██████████▉                                                          | 1187/7473 [00:07<00:33, 190.20it/s] 16%|███████████▏                                                         | 1207/7473 [00:07<00:32, 190.36it/s] 16%|███████████▎                                                         | 1227/7473 [00:07<00:32, 190.67it/s] 17%|███████████▌                                                         | 1247/7473 [00:07<00:32, 190.05it/s] 17%|███████████▋                                                         | 1267/7473 [00:07<00:32, 190.55it/s] 17%|███████████▉                                                         | 1287/7473 [00:07<00:32, 190.77it/s] 17%|████████████                                                         | 1307/7473 [00:07<00:32, 191.00it/s] 18%|████████████▎                                                        | 1327/7473 [00:07<00:32, 191.25it/s] 18%|████████████▍                                                        | 1347/7473 [00:07<00:32, 191.15it/s] 18%|████████████▌                                                        | 1367/7473 [00:07<00:31, 191.38it/s] 19%|████████████▊                                                        | 1387/7473 [00:08<00:32, 188.95it/s] 19%|████████████▉                                                        | 1407/7473 [00:08<00:31, 189.60it/s] 19%|█████████████▏                                                       | 1427/7473 [00:08<00:31, 190.17it/s] 19%|█████████████▎                                                       | 1447/7473 [00:08<00:31, 190.49it/s] 20%|█████████████▌                                                       | 1467/7473 [00:08<00:31, 190.66it/s] 20%|█████████████▋                                                       | 1487/7473 [00:08<00:31, 190.93it/s] 20%|█████████████▉                                                       | 1507/7473 [00:08<00:31, 191.22it/s] 20%|██████████████                                                       | 1527/7473 [00:08<00:31, 191.65it/s] 21%|██████████████▎                                                      | 1547/7473 [00:08<00:30, 191.28it/s] 21%|██████████████▍                                                      | 1567/7473 [00:08<00:31, 190.40it/s] 21%|██████████████▋                                                      | 1587/7473 [00:09<00:30, 190.24it/s] 22%|██████████████▊                                                      | 1607/7473 [00:09<00:30, 190.37it/s] 22%|███████████████                                                      | 1627/7473 [00:09<00:30, 189.14it/s] 22%|███████████████▏                                                     | 1647/7473 [00:09<00:30, 190.07it/s] 22%|███████████████▍                                                     | 1667/7473 [00:09<00:30, 189.71it/s] 23%|███████████████▌                                                     | 1687/7473 [00:09<00:30, 190.30it/s] 23%|███████████████▊                                                     | 1707/7473 [00:09<00:30, 190.02it/s] 23%|███████████████▉                                                     | 1727/7473 [00:09<00:30, 190.21it/s] 23%|████████████████▏                                                    | 1747/7473 [00:09<00:30, 190.03it/s] 24%|████████████████▎                                                    | 1767/7473 [00:10<00:30, 190.02it/s] 24%|████████████████▍                                                    | 1787/7473 [00:10<00:29, 189.98it/s] 24%|████████████████▋                                                    | 1806/7473 [00:10<00:29, 189.76it/s] 24%|████████████████▊                                                    | 1825/7473 [00:10<00:29, 189.34it/s] 25%|█████████████████                                                    | 1844/7473 [00:10<00:29, 187.77it/s] 25%|█████████████████▏                                                   | 1864/7473 [00:10<00:29, 188.47it/s] 25%|█████████████████▍                                                   | 1883/7473 [00:10<00:29, 188.86it/s] 25%|█████████████████▌                                                   | 1902/7473 [00:10<00:29, 188.88it/s] 26%|█████████████████▋                                                   | 1921/7473 [00:10<00:29, 188.90it/s] 26%|█████████████████▉                                                   | 1940/7473 [00:10<00:29, 189.08it/s] 26%|██████████████████                                                   | 1960/7473 [00:11<00:29, 189.63it/s] 26%|██████████████████▎                                                  | 1980/7473 [00:11<00:28, 189.87it/s] 27%|██████████████████▍                                                  | 1999/7473 [00:11<00:28, 189.90it/s] 27%|██████████████████▋                                                  | 2019/7473 [00:11<00:28, 190.00it/s] 27%|██████████████████▊                                                  | 2039/7473 [00:11<00:28, 190.17it/s] 28%|███████████████████                                                  | 2059/7473 [00:11<00:28, 190.21it/s] 28%|███████████████████▏                                                 | 2079/7473 [00:11<00:28, 188.44it/s] 28%|███████████████████▍                                                 | 2099/7473 [00:11<00:28, 188.93it/s] 28%|███████████████████▌                                                 | 2118/7473 [00:11<00:28, 188.82it/s] 29%|███████████████████▋                                                 | 2137/7473 [00:12<00:28, 189.02it/s] 29%|███████████████████▉                                                 | 2157/7473 [00:12<00:28, 189.46it/s] 29%|████████████████████                                                 | 2177/7473 [00:12<00:27, 190.13it/s] 29%|████████████████████▎                                                | 2197/7473 [00:12<00:27, 189.96it/s] 30%|████████████████████▍                                                | 2216/7473 [00:12<00:27, 189.24it/s] 30%|████████████████████▋                                                | 2236/7473 [00:12<00:27, 189.87it/s] 30%|████████████████████▊                                                | 2256/7473 [00:12<00:27, 190.26it/s] 30%|█████████████████████                                                | 2276/7473 [00:12<00:27, 190.61it/s] 31%|█████████████████████▏                                               | 2296/7473 [00:12<00:27, 189.45it/s] 31%|█████████████████████▍                                               | 2316/7473 [00:12<00:27, 190.56it/s] 31%|█████████████████████▌                                               | 2336/7473 [00:13<00:26, 190.91it/s] 32%|█████████████████████▊                                               | 2356/7473 [00:13<00:26, 190.87it/s] 32%|█████████████████████▉                                               | 2376/7473 [00:13<00:26, 191.12it/s] 32%|██████████████████████                                               | 2396/7473 [00:13<00:26, 191.24it/s] 32%|██████████████████████▎                                              | 2416/7473 [00:13<00:26, 191.69it/s] 33%|██████████████████████▍                                              | 2436/7473 [00:13<00:26, 191.78it/s] 33%|██████████████████████▋                                              | 2456/7473 [00:13<00:26, 191.79it/s] 33%|██████████████████████▊                                              | 2476/7473 [00:13<00:26, 191.28it/s] 33%|███████████████████████                                              | 2496/7473 [00:13<00:26, 191.17it/s] 34%|███████████████████████▏                                             | 2516/7473 [00:13<00:25, 191.02it/s] 34%|███████████████████████▍                                             | 2536/7473 [00:14<00:29, 167.92it/s] 34%|███████████████████████▌                                             | 2556/7473 [00:14<00:28, 174.23it/s] 34%|███████████████████████▊                                             | 2576/7473 [00:14<00:27, 179.11it/s] 35%|███████████████████████▉                                             | 2596/7473 [00:14<00:26, 182.56it/s] 35%|████████████████████████▏                                            | 2616/7473 [00:14<00:26, 185.20it/s] 35%|████████████████████████▎                                            | 2636/7473 [00:14<00:25, 186.95it/s] 36%|████████████████████████▌                                            | 2656/7473 [00:14<00:25, 188.56it/s] 36%|████████████████████████▋                                            | 2676/7473 [00:14<00:25, 189.41it/s] 36%|████████████████████████▉                                            | 2696/7473 [00:14<00:25, 189.74it/s] 36%|█████████████████████████                                            | 2716/7473 [00:15<00:25, 189.90it/s] 37%|█████████████████████████▎                                           | 2736/7473 [00:15<00:24, 190.08it/s] 37%|█████████████████████████▍                                           | 2756/7473 [00:15<00:24, 189.08it/s] 37%|█████████████████████████▋                                           | 2776/7473 [00:15<00:24, 189.68it/s] 37%|█████████████████████████▊                                           | 2796/7473 [00:15<00:24, 190.06it/s] 38%|██████████████████████████                                           | 2816/7473 [00:15<00:24, 190.25it/s] 38%|██████████████████████████▏                                          | 2836/7473 [00:15<00:24, 190.67it/s] 38%|██████████████████████████▎                                          | 2856/7473 [00:15<00:24, 189.29it/s] 38%|██████████████████████████▌                                          | 2876/7473 [00:15<00:24, 189.55it/s] 39%|██████████████████████████▋                                          | 2896/7473 [00:16<00:24, 189.93it/s] 39%|██████████████████████████▉                                          | 2916/7473 [00:16<00:23, 190.40it/s] 39%|███████████████████████████                                          | 2936/7473 [00:16<00:23, 191.03it/s] 40%|███████████████████████████▎                                         | 2956/7473 [00:16<00:23, 190.98it/s] 40%|███████████████████████████▍                                         | 2976/7473 [00:16<00:23, 188.52it/s] 40%|███████████████████████████▋                                         | 2996/7473 [00:16<00:23, 189.27it/s] 40%|███████████████████████████▊                                         | 3016/7473 [00:16<00:23, 189.69it/s] 41%|████████████████████████████                                         | 3036/7473 [00:16<00:23, 189.95it/s] 41%|████████████████████████████▏                                        | 3056/7473 [00:16<00:23, 190.34it/s] 41%|████████████████████████████▍                                        | 3076/7473 [00:16<00:23, 190.45it/s] 41%|████████████████████████████▌                                        | 3096/7473 [00:17<00:22, 190.65it/s] 42%|████████████████████████████▊                                        | 3116/7473 [00:17<00:22, 190.12it/s] 42%|████████████████████████████▉                                        | 3136/7473 [00:17<00:22, 190.18it/s] 42%|█████████████████████████████▏                                       | 3156/7473 [00:17<00:22, 190.37it/s] 42%|█████████████████████████████▎                                       | 3176/7473 [00:17<00:22, 189.12it/s] 43%|█████████████████████████████▌                                       | 3195/7473 [00:17<00:22, 189.28it/s] 43%|█████████████████████████████▋                                       | 3214/7473 [00:17<00:22, 188.21it/s] 43%|█████████████████████████████▊                                       | 3233/7473 [00:17<00:22, 188.49it/s] 44%|██████████████████████████████                                       | 3253/7473 [00:17<00:22, 189.49it/s] 44%|██████████████████████████████▏                                      | 3273/7473 [00:18<00:22, 190.00it/s] 44%|██████████████████████████████▍                                      | 3293/7473 [00:18<00:21, 190.46it/s] 44%|██████████████████████████████▌                                      | 3313/7473 [00:18<00:21, 190.59it/s] 45%|██████████████████████████████▊                                      | 3333/7473 [00:18<00:21, 189.80it/s] 45%|██████████████████████████████▉                                      | 3353/7473 [00:18<00:21, 190.06it/s] 45%|███████████████████████████████▏                                     | 3373/7473 [00:18<00:21, 190.27it/s] 45%|███████████████████████████████▎                                     | 3393/7473 [00:18<00:21, 190.17it/s] 46%|███████████████████████████████▌                                     | 3413/7473 [00:18<00:21, 190.39it/s] 46%|███████████████████████████████▋                                     | 3433/7473 [00:18<00:21, 189.02it/s] 46%|███████████████████████████████▊                                     | 3452/7473 [00:18<00:21, 189.24it/s] 46%|████████████████████████████████                                     | 3471/7473 [00:19<00:21, 189.33it/s] 47%|████████████████████████████████▏                                    | 3491/7473 [00:19<00:20, 190.15it/s] 47%|████████████████████████████████▍                                    | 3511/7473 [00:19<00:20, 190.55it/s] 47%|████████████████████████████████▌                                    | 3531/7473 [00:19<00:20, 190.64it/s] 48%|████████████████████████████████▊                                    | 3551/7473 [00:19<00:20, 190.72it/s] 48%|████████████████████████████████▉                                    | 3571/7473 [00:19<00:20, 190.90it/s] 48%|█████████████████████████████████▏                                   | 3591/7473 [00:19<00:20, 190.17it/s] 48%|█████████████████████████████████▎                                   | 3611/7473 [00:19<00:20, 190.33it/s] 49%|█████████████████████████████████▌                                   | 3631/7473 [00:19<00:20, 190.50it/s] 49%|█████████████████████████████████▋                                   | 3651/7473 [00:20<00:20, 189.95it/s] 49%|█████████████████████████████████▉                                   | 3670/7473 [00:20<00:20, 188.54it/s] 49%|██████████████████████████████████                                   | 3690/7473 [00:20<00:20, 189.14it/s] 50%|██████████████████████████████████▏                                  | 3709/7473 [00:20<00:19, 189.36it/s] 50%|██████████████████████████████████▍                                  | 3728/7473 [00:20<00:19, 189.39it/s] 50%|██████████████████████████████████▌                                  | 3747/7473 [00:20<00:19, 189.55it/s] 50%|██████████████████████████████████▊                                  | 3767/7473 [00:20<00:19, 189.74it/s] 51%|██████████████████████████████████▉                                  | 3787/7473 [00:20<00:19, 190.00it/s] 51%|███████████████████████████████████▏                                 | 3807/7473 [00:20<00:19, 190.36it/s] 51%|███████████████████████████████████▎                                 | 3827/7473 [00:20<00:19, 190.52it/s] 51%|███████████████████████████████████▌                                 | 3847/7473 [00:21<00:19, 190.62it/s] 52%|███████████████████████████████████▋                                 | 3867/7473 [00:21<00:18, 190.63it/s] 52%|███████████████████████████████████▉                                 | 3887/7473 [00:21<00:18, 188.81it/s] 52%|████████████████████████████████████                                 | 3907/7473 [00:21<00:18, 189.59it/s] 53%|████████████████████████████████████▎                                | 3927/7473 [00:21<00:18, 189.95it/s] 53%|████████████████████████████████████▍                                | 3947/7473 [00:21<00:18, 190.09it/s] 53%|████████████████████████████████████▋                                | 3967/7473 [00:21<00:18, 190.26it/s] 53%|████████████████████████████████████▊                                | 3987/7473 [00:21<00:18, 190.25it/s] 54%|████████████████████████████████████▉                                | 4007/7473 [00:21<00:18, 190.36it/s] 54%|█████████████████████████████████████▏                               | 4027/7473 [00:21<00:18, 190.62it/s] 54%|█████████████████████████████████████▎                               | 4047/7473 [00:22<00:17, 190.75it/s] 54%|█████████████████████████████████████▌                               | 4067/7473 [00:22<00:17, 190.62it/s] 55%|█████████████████████████████████████▋                               | 4087/7473 [00:22<00:17, 190.32it/s] 55%|█████████████████████████████████████▉                               | 4107/7473 [00:22<00:17, 190.07it/s] 55%|██████████████████████████████████████                               | 4127/7473 [00:22<00:17, 188.26it/s] 55%|██████████████████████████████████████▎                              | 4146/7473 [00:22<00:17, 188.73it/s] 56%|██████████████████████████████████████▍                              | 4166/7473 [00:22<00:17, 189.43it/s] 56%|██████████████████████████████████████▋                              | 4185/7473 [00:22<00:17, 189.23it/s] 56%|██████████████████████████████████████▊                              | 4205/7473 [00:22<00:17, 189.64it/s] 57%|███████████████████████████████████████                              | 4225/7473 [00:23<00:17, 189.89it/s] 57%|███████████████████████████████████████▏                             | 4245/7473 [00:23<00:16, 190.25it/s] 57%|███████████████████████████████████████▍                             | 4265/7473 [00:23<00:16, 190.36it/s] 57%|███████████████████████████████████████▌                             | 4285/7473 [00:23<00:16, 190.39it/s] 58%|███████████████████████████████████████▋                             | 4305/7473 [00:23<00:16, 190.09it/s] 58%|███████████████████████████████████████▉                             | 4325/7473 [00:23<00:16, 190.47it/s] 58%|████████████████████████████████████████                             | 4345/7473 [00:23<00:16, 189.13it/s] 58%|████████████████████████████████████████▎                            | 4364/7473 [00:23<00:16, 188.34it/s] 59%|████████████████████████████████████████▍                            | 4384/7473 [00:23<00:16, 189.03it/s] 59%|████████████████████████████████████████▋                            | 4404/7473 [00:23<00:16, 189.60it/s] 59%|████████████████████████████████████████▊                            | 4423/7473 [00:24<00:16, 189.38it/s] 59%|█████████████████████████████████████████                            | 4443/7473 [00:24<00:15, 189.63it/s] 60%|█████████████████████████████████████████▏                           | 4462/7473 [00:24<00:15, 189.70it/s] 60%|█████████████████████████████████████████▍                           | 4482/7473 [00:24<00:15, 190.14it/s] 60%|█████████████████████████████████████████▌                           | 4502/7473 [00:24<00:15, 190.18it/s] 61%|█████████████████████████████████████████▊                           | 4522/7473 [00:24<00:15, 190.40it/s] 61%|█████████████████████████████████████████▉                           | 4542/7473 [00:24<00:15, 190.82it/s] 61%|██████████████████████████████████████████                           | 4562/7473 [00:24<00:15, 189.55it/s] 61%|██████████████████████████████████████████▎                          | 4582/7473 [00:24<00:15, 189.99it/s] 62%|██████████████████████████████████████████▍                          | 4602/7473 [00:25<00:15, 190.25it/s] 62%|██████████████████████████████████████████▋                          | 4622/7473 [00:25<00:14, 190.57it/s] 62%|██████████████████████████████████████████▊                          | 4642/7473 [00:25<00:14, 190.47it/s] 62%|███████████████████████████████████████████                          | 4662/7473 [00:25<00:14, 190.66it/s] 63%|███████████████████████████████████████████▏                         | 4682/7473 [00:25<00:14, 190.62it/s] 63%|███████████████████████████████████████████▍                         | 4702/7473 [00:25<00:14, 190.68it/s] 63%|███████████████████████████████████████████▌                         | 4722/7473 [00:25<00:14, 190.78it/s] 63%|███████████████████████████████████████████▊                         | 4742/7473 [00:25<00:14, 190.94it/s] 64%|███████████████████████████████████████████▉                         | 4762/7473 [00:25<00:14, 190.99it/s] 64%|████████████████████████████████████████████▏                        | 4782/7473 [00:25<00:14, 190.97it/s] 64%|████████████████████████████████████████████▎                        | 4802/7473 [00:26<00:14, 189.07it/s] 65%|████████████████████████████████████████████▌                        | 4822/7473 [00:26<00:13, 189.75it/s] 65%|████████████████████████████████████████████▋                        | 4842/7473 [00:26<00:13, 189.90it/s] 65%|████████████████████████████████████████████▉                        | 4862/7473 [00:26<00:13, 190.08it/s] 65%|█████████████████████████████████████████████                        | 4882/7473 [00:26<00:13, 190.15it/s] 66%|█████████████████████████████████████████████▎                       | 4902/7473 [00:26<00:13, 190.71it/s] 66%|█████████████████████████████████████████████▍                       | 4922/7473 [00:26<00:13, 190.74it/s] 66%|█████████████████████████████████████████████▋                       | 4942/7473 [00:26<00:13, 190.66it/s] 66%|█████████████████████████████████████████████▊                       | 4962/7473 [00:26<00:13, 190.72it/s] 67%|██████████████████████████████████████████████                       | 4982/7473 [00:27<00:13, 190.59it/s] 67%|██████████████████████████████████████████████▏                      | 5002/7473 [00:27<00:12, 190.52it/s] 67%|██████████████████████████████████████████████▎                      | 5022/7473 [00:27<00:12, 189.17it/s] 67%|██████████████████████████████████████████████▌                      | 5042/7473 [00:27<00:12, 189.73it/s] 68%|██████████████████████████████████████████████▋                      | 5062/7473 [00:27<00:12, 190.11it/s] 68%|██████████████████████████████████████████████▉                      | 5082/7473 [00:27<00:12, 190.02it/s] 68%|███████████████████████████████████████████████                      | 5102/7473 [00:27<00:12, 190.13it/s] 69%|███████████████████████████████████████████████▎                     | 5122/7473 [00:27<00:12, 190.21it/s] 69%|███████████████████████████████████████████████▍                     | 5142/7473 [00:27<00:12, 190.28it/s] 69%|███████████████████████████████████████████████▋                     | 5162/7473 [00:27<00:12, 190.49it/s] 69%|███████████████████████████████████████████████▊                     | 5182/7473 [00:28<00:12, 190.73it/s] 70%|████████████████████████████████████████████████                     | 5202/7473 [00:28<00:11, 190.72it/s] 70%|████████████████████████████████████████████████▏                    | 5222/7473 [00:28<00:11, 190.63it/s] 70%|████████████████████████████████████████████████▍                    | 5242/7473 [00:28<00:11, 190.05it/s] 70%|████████████████████████████████████████████████▌                    | 5262/7473 [00:28<00:13, 169.73it/s] 71%|████████████████████████████████████████████████▊                    | 5282/7473 [00:28<00:12, 175.60it/s] 71%|████████████████████████████████████████████████▉                    | 5301/7473 [00:28<00:12, 179.32it/s] 71%|█████████████████████████████████████████████████                    | 5320/7473 [00:28<00:11, 181.70it/s] 71%|█████████████████████████████████████████████████▎                   | 5339/7473 [00:28<00:11, 183.51it/s] 72%|█████████████████████████████████████████████████▍                   | 5358/7473 [00:29<00:11, 184.70it/s] 72%|█████████████████████████████████████████████████▋                   | 5377/7473 [00:29<00:11, 185.85it/s] 72%|█████████████████████████████████████████████████▊                   | 5396/7473 [00:29<00:11, 186.78it/s] 72%|█████████████████████████████████████████████████▉                   | 5415/7473 [00:29<00:10, 187.34it/s] 73%|██████████████████████████████████████████████████▏                  | 5434/7473 [00:29<00:10, 187.91it/s] 73%|██████████████████████████████████████████████████▎                  | 5453/7473 [00:29<00:10, 187.99it/s] 73%|██████████████████████████████████████████████████▌                  | 5472/7473 [00:29<00:15, 126.12it/s] 73%|██████████████████████████████████████████████████▋                  | 5491/7473 [00:29<00:14, 139.77it/s] 74%|██████████████████████████████████████████████████▉                  | 5510/7473 [00:30<00:12, 151.47it/s] 74%|███████████████████████████████████████████████████                  | 5529/7473 [00:30<00:12, 160.86it/s] 74%|███████████████████████████████████████████████████▏                 | 5548/7473 [00:30<00:11, 167.74it/s] 74%|███████████████████████████████████████████████████▍                 | 5567/7473 [00:30<00:10, 173.48it/s] 75%|███████████████████████████████████████████████████▌                 | 5586/7473 [00:30<00:10, 177.37it/s] 75%|███████████████████████████████████████████████████▊                 | 5605/7473 [00:30<00:10, 180.55it/s] 75%|███████████████████████████████████████████████████▉                 | 5624/7473 [00:30<00:10, 183.09it/s] 76%|████████████████████████████████████████████████████                 | 5643/7473 [00:30<00:09, 184.11it/s] 76%|████████████████████████████████████████████████████▎                | 5663/7473 [00:30<00:09, 186.41it/s] 76%|████████████████████████████████████████████████████▍                | 5682/7473 [00:30<00:09, 185.86it/s] 76%|████████████████████████████████████████████████████▋                | 5702/7473 [00:31<00:09, 187.44it/s] 77%|████████████████████████████████████████████████████▊                | 5721/7473 [00:31<00:09, 188.05it/s] 77%|█████████████████████████████████████████████████████                | 5741/7473 [00:31<00:09, 189.04it/s] 77%|█████████████████████████████████████████████████████▏               | 5761/7473 [00:31<00:09, 189.64it/s] 77%|█████████████████████████████████████████████████████▍               | 5781/7473 [00:31<00:08, 189.85it/s] 78%|█████████████████████████████████████████████████████▌               | 5801/7473 [00:31<00:08, 189.92it/s] 78%|█████████████████████████████████████████████████████▋               | 5821/7473 [00:31<00:08, 189.87it/s] 78%|█████████████████████████████████████████████████████▉               | 5841/7473 [00:31<00:08, 190.04it/s] 78%|██████████████████████████████████████████████████████               | 5861/7473 [00:31<00:08, 190.21it/s] 79%|██████████████████████████████████████████████████████▎              | 5881/7473 [00:31<00:08, 190.19it/s] 79%|██████████████████████████████████████████████████████▍              | 5901/7473 [00:32<00:08, 188.40it/s] 79%|██████████████████████████████████████████████████████▋              | 5920/7473 [00:32<00:08, 188.65it/s] 79%|██████████████████████████████████████████████████████▊              | 5939/7473 [00:32<00:08, 188.91it/s] 80%|███████████████████████████████████████████████████████              | 5958/7473 [00:32<00:08, 188.98it/s] 80%|███████████████████████████████████████████████████████▏             | 5977/7473 [00:32<00:07, 189.03it/s] 80%|███████████████████████████████████████████████████████▎             | 5996/7473 [00:32<00:07, 189.09it/s] 80%|███████████████████████████████████████████████████████▌             | 6015/7473 [00:32<00:07, 189.26it/s] 81%|███████████████████████████████████████████████████████▋             | 6034/7473 [00:32<00:07, 189.47it/s] 81%|███████████████████████████████████████████████████████▉             | 6054/7473 [00:32<00:07, 190.10it/s] 81%|████████████████████████████████████████████████████████             | 6074/7473 [00:32<00:07, 189.12it/s] 82%|████████████████████████████████████████████████████████▎            | 6094/7473 [00:33<00:07, 189.46it/s] 82%|████████████████████████████████████████████████████████▍            | 6114/7473 [00:33<00:07, 189.68it/s] 82%|████████████████████████████████████████████████████████▋            | 6133/7473 [00:33<00:07, 188.22it/s] 82%|████████████████████████████████████████████████████████▊            | 6153/7473 [00:33<00:06, 189.00it/s] 83%|████████████████████████████████████████████████████████▉            | 6172/7473 [00:33<00:06, 188.97it/s] 83%|█████████████████████████████████████████████████████████▏           | 6192/7473 [00:33<00:06, 189.71it/s] 83%|█████████████████████████████████████████████████████████▎           | 6212/7473 [00:33<00:06, 189.90it/s] 83%|█████████████████████████████████████████████████████████▌           | 6231/7473 [00:33<00:06, 189.69it/s] 84%|█████████████████████████████████████████████████████████▋           | 6251/7473 [00:33<00:06, 190.21it/s] 84%|█████████████████████████████████████████████████████████▉           | 6271/7473 [00:34<00:06, 190.14it/s] 84%|██████████████████████████████████████████████████████████           | 6291/7473 [00:34<00:06, 189.84it/s] 84%|██████████████████████████████████████████████████████████▎          | 6311/7473 [00:34<00:06, 190.26it/s] 85%|██████████████████████████████████████████████████████████▍          | 6331/7473 [00:34<00:06, 190.33it/s] 85%|██████████████████████████████████████████████████████████▋          | 6351/7473 [00:34<00:05, 190.26it/s] 85%|██████████████████████████████████████████████████████████▊          | 6371/7473 [00:34<00:05, 188.49it/s] 86%|███████████████████████████████████████████████████████████          | 6390/7473 [00:34<00:05, 188.81it/s] 86%|███████████████████████████████████████████████████████████▏         | 6410/7473 [00:34<00:05, 189.21it/s] 86%|███████████████████████████████████████████████████████████▎         | 6429/7473 [00:34<00:05, 189.16it/s] 86%|███████████████████████████████████████████████████████████▌         | 6449/7473 [00:34<00:05, 189.52it/s] 87%|███████████████████████████████████████████████████████████▋         | 6468/7473 [00:35<00:05, 189.47it/s] 87%|███████████████████████████████████████████████████████████▉         | 6487/7473 [00:35<00:05, 188.68it/s] 87%|████████████████████████████████████████████████████████████         | 6507/7473 [00:35<00:05, 189.06it/s] 87%|████████████████████████████████████████████████████████████▎        | 6526/7473 [00:35<00:05, 189.18it/s] 88%|████████████████████████████████████████████████████████████▍        | 6546/7473 [00:35<00:04, 189.70it/s] 88%|████████████████████████████████████████████████████████████▋        | 6566/7473 [00:35<00:04, 190.00it/s] 88%|████████████████████████████████████████████████████████████▊        | 6585/7473 [00:35<00:04, 187.95it/s] 88%|████████████████████████████████████████████████████████████▉        | 6605/7473 [00:35<00:04, 188.80it/s] 89%|█████████████████████████████████████████████████████████████▏       | 6624/7473 [00:35<00:04, 188.99it/s] 89%|█████████████████████████████████████████████████████████████▎       | 6643/7473 [00:35<00:04, 189.06it/s] 89%|█████████████████████████████████████████████████████████████▌       | 6663/7473 [00:36<00:04, 189.40it/s] 89%|█████████████████████████████████████████████████████████████▋       | 6682/7473 [00:36<00:04, 189.57it/s] 90%|█████████████████████████████████████████████████████████████▊       | 6701/7473 [00:36<00:04, 189.63it/s] 90%|██████████████████████████████████████████████████████████████       | 6720/7473 [00:36<00:03, 189.43it/s] 90%|██████████████████████████████████████████████████████████████▏      | 6740/7473 [00:36<00:03, 189.68it/s] 90%|██████████████████████████████████████████████████████████████▍      | 6759/7473 [00:36<00:03, 189.71it/s] 91%|██████████████████████████████████████████████████████████████▌      | 6778/7473 [00:36<00:03, 189.72it/s] 91%|██████████████████████████████████████████████████████████████▊      | 6798/7473 [00:36<00:03, 189.83it/s] 91%|██████████████████████████████████████████████████████████████▉      | 6817/7473 [00:36<00:03, 187.83it/s] 91%|███████████████████████████████████████████████████████████████      | 6836/7473 [00:37<00:03, 188.29it/s] 92%|███████████████████████████████████████████████████████████████▎     | 6856/7473 [00:37<00:03, 188.96it/s] 92%|███████████████████████████████████████████████████████████████▍     | 6876/7473 [00:37<00:03, 189.55it/s] 92%|███████████████████████████████████████████████████████████████▋     | 6895/7473 [00:37<00:03, 188.32it/s] 93%|███████████████████████████████████████████████████████████████▊     | 6915/7473 [00:37<00:02, 188.87it/s] 93%|████████████████████████████████████████████████████████████████     | 6934/7473 [00:37<00:02, 189.16it/s] 93%|████████████████████████████████████████████████████████████████▏    | 6953/7473 [00:37<00:02, 189.33it/s] 93%|████████████████████████████████████████████████████████████████▎    | 6972/7473 [00:37<00:02, 189.52it/s] 94%|████████████████████████████████████████████████████████████████▌    | 6992/7473 [00:37<00:02, 189.64it/s] 94%|████████████████████████████████████████████████████████████████▋    | 7011/7473 [00:37<00:02, 189.51it/s] 94%|████████████████████████████████████████████████████████████████▉    | 7030/7473 [00:38<00:02, 189.32it/s] 94%|█████████████████████████████████████████████████████████████████    | 7049/7473 [00:38<00:02, 187.59it/s] 95%|█████████████████████████████████████████████████████████████████▎   | 7068/7473 [00:38<00:02, 188.28it/s] 95%|█████████████████████████████████████████████████████████████████▍   | 7088/7473 [00:38<00:02, 188.94it/s] 95%|█████████████████████████████████████████████████████████████████▋   | 7108/7473 [00:38<00:01, 189.46it/s] 95%|█████████████████████████████████████████████████████████████████▊   | 7127/7473 [00:38<00:01, 189.43it/s] 96%|█████████████████████████████████████████████████████████████████▉   | 7146/7473 [00:38<00:01, 189.32it/s] 96%|██████████████████████████████████████████████████████████████████▏  | 7165/7473 [00:38<00:01, 189.24it/s] 96%|██████████████████████████████████████████████████████████████████▎  | 7184/7473 [00:38<00:01, 189.33it/s] 96%|██████████████████████████████████████████████████████████████████▌  | 7204/7473 [00:38<00:01, 189.55it/s] 97%|██████████████████████████████████████████████████████████████████▋  | 7223/7473 [00:39<00:01, 189.67it/s] 97%|██████████████████████████████████████████████████████████████████▉  | 7243/7473 [00:39<00:01, 189.98it/s] 97%|███████████████████████████████████████████████████████████████████  | 7262/7473 [00:39<00:01, 188.25it/s] 97%|███████████████████████████████████████████████████████████████████▏ | 7282/7473 [00:39<00:01, 188.97it/s] 98%|███████████████████████████████████████████████████████████████████▍ | 7302/7473 [00:39<00:00, 189.32it/s] 98%|███████████████████████████████████████████████████████████████████▌ | 7321/7473 [00:39<00:00, 188.14it/s] 98%|███████████████████████████████████████████████████████████████████▊ | 7340/7473 [00:39<00:00, 188.25it/s] 98%|███████████████████████████████████████████████████████████████████▉ | 7359/7473 [00:39<00:00, 188.63it/s] 99%|████████████████████████████████████████████████████████████████████ | 7378/7473 [00:39<00:00, 188.65it/s] 99%|████████████████████████████████████████████████████████████████████▎| 7398/7473 [00:39<00:00, 189.35it/s] 99%|████████████████████████████████████████████████████████████████████▍| 7417/7473 [00:40<00:00, 189.27it/s]100%|████████████████████████████████████████████████████████████████████▋| 7436/7473 [00:40<00:00, 189.19it/s]100%|████████████████████████████████████████████████████████████████████▊| 7455/7473 [00:40<00:00, 189.13it/s]100%|█████████████████████████████████████████████████████████████████████| 7473/7473 [00:40<00:00, 185.05it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                         | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                         | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                         | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                         | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|████████████████▎                                | 1/3 [00:05<00:10,  5.17s/it]Loading checkpoint shards:  33%|████████████████▎                                | 1/3 [00:05<00:10,  5.30s/it]Loading checkpoint shards:  33%|████████████████▎                                | 1/3 [00:05<00:11,  5.71s/it]Loading checkpoint shards:  33%|████████████████▎                                | 1/3 [00:05<00:10,  5.32s/it]Loading checkpoint shards:  67%|████████████████████████████████▋                | 2/3 [00:10<00:04,  4.99s/it]Loading checkpoint shards:  67%|████████████████████████████████▋                | 2/3 [00:10<00:05,  5.28s/it]Loading checkpoint shards:  67%|████████████████████████████████▋                | 2/3 [00:10<00:05,  5.29s/it]Loading checkpoint shards:  67%|████████████████████████████████▋                | 2/3 [00:12<00:06,  6.32s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.45s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.61s/it]
[2023-08-16 00:53:17,492] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.70s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.86s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.75s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.90s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:18<00:00,  6.00s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:18<00:00,  6.03s/it]
[2023-08-16 00:53:34,551] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-16 00:53:34,553] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-16 00:53:34,553] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-16 00:53:34,553] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-16 00:53:34,553] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-16 00:53:34,553] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-16 00:53:34,554] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-16 00:53:34,554] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-16 00:53:34,554] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-16 00:53:34,554] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-16 00:53:34,554] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-16 00:53:34,554] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f132f0dafd0>
[2023-08-16 00:53:34,554] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-16 00:53:34,554] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-16 00:53:34,554] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-16 00:53:34,554] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-16 00:53:34,554] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-16 00:53:34,554] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-16 00:53:34,554] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-16 00:53:34,554] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-16 00:53:34,554] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-16 00:53:34,554] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-16 00:53:34,554] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-16 00:53:34,554] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-16 00:53:34,554] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-16 00:53:34,555] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-16 00:53:34,555] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-16 00:53:34,555] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-16 00:53:34,555] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-16 00:53:34,555] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-16 00:53:34,555] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-16 00:53:34,555] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-16 00:53:34,555] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-16 00:53:34,555] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-16 00:53:34,555] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-16 00:53:34,555] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-16 00:53:34,555] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-16 00:53:34,555] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-16 00:53:34,555] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-16 00:53:34,555] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-16 00:53:34,555] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-16 00:53:34,555] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-16 00:53:34,555] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-16 00:53:34,555] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-16 00:53:34,555] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f132f0dabe0>
[2023-08-16 00:53:34,555] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-16 00:53:34,555] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-16 00:53:34,555] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-16 00:53:34,555] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-16 00:53:34,555] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-16 00:53:34,555] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-16 00:53:34,555] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-16 00:53:34,555] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-16 00:53:34,555] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-16 00:53:34,555] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-16 00:53:34,555] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-16 00:53:34,555] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-16 00:53:34,555] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-16 00:53:34,555] [INFO] [config.py:1012:print]   train_batch_size ............. 8
[2023-08-16 00:53:34,555] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  2
[2023-08-16 00:53:34,555] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-16 00:53:34,556] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-16 00:53:34,556] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-16 00:53:34,556] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-16 00:53:34,556] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-16 00:53:34,556] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-16 00:53:34,556] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-16 00:53:34,556] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.713249921798706 seconds
Loading extension module utils...
Time to load utils op: 0.7052569389343262 seconds
Loading extension module utils...
Time to load utils op: 0.7047710418701172 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating gsm8k :   0%|                                                               | 0/125 [00:00<?, ?it/s]############### Example ###############
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following grade math question.

### Demonstration:
Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Rationales: 1. The question asks where you could find some plumbing that would not be useful to you if you were thirsty.
2. This means we're looking for a place that has plumbing but doesn't provide potable, or drinkable, water.
3. Let's analyze each choice:
4. Option A: Oil Refineries. These are places where crude oil is processed and refined into more useful products such as petrol, diesel, and other chemical products. While they may have plumbing to facilitate the movement of oil, the purpose is not meant for drinking water. Hence this could be a possible answer.
5. Option B: Wall. The wall might contain plumbing as part of the building's infrastructure, but it is primarily designed to transport water to useful locations like faucets, not for drinking directly. This isn't a strong answer.
6. Option C: Show. The term "show" appears somewhat ambiguous in this context. It could refer to a television show, a play, a showcase, etc. None of these interpretations seem to involve plumbing let alone providing drinking water. However, the question refers to a place so this seems an unlikely answer.
7. Option D: Own Home. In your own home, the plumbing systems serve various purposes like providing drinking water through faucets and taps. Therefore, if you were thirsty at home, the plumbing would be useful to you.
8. Option E: Water Fountain. A water fountain also provides drinking water, so it would be useful if you were thirsty.
9. Only option A, oil refineries, involves plumbing that doesn't normally provide drinking water.
10. Thus, the answer is A: oil refineries.
Answer: A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Rationales: 1. The question is asking what a person isn't doing "yet" when they are beginning work.
2. This implies that the answer would be something that generally happens later in the work process.
3. Looking at choice A: "working", we can rule this out because a person is already engaging in work when they are beginning work.
4. Choice B: "resting", can also be ruled out because resting generally happens after or in-between work, so it doesn't quite answer the question.
5. Similarly, choice C: "tiredness", does not fit because it's a condition that might occur while or after working.
6. For choice E: "momentum", it's possible to start work with momentum so this option doesn't generally happen later in the work process.
7. This leaves us with choice D: "accomplishing". Advancement or achievement ("accomplishing") usually comes after having put significant time and effort into the work. Therefore, this is the best choice. 
8. So, when a person is beginning work, they aren't yet accomplishing. This aligns very well with the process of working. Hence, the answer is D: accomplishing.
Answer: D: accomplishing

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Rationales: 1. The question asks for a location where one might find pens with a company logo.
2. The possible answers are various places or things: an office, a pencil, writing sentences on paper, a school, or a backpack.
3. A company logo on a pen is often a promotional item that is commonly used in a corporate environment.
4. The places where you might find such items are generally offices or corporate events. Therefore, the most logical option is the office, as it is a working environment.
5. Out of all the other options, none consistently have pens with a company logo. Though a pencil, school, or backpack could occasionally contain these pens, they're not as likely because they are not specifically related to a corporate environment. 
6. And writing sentences on paper is not a location, so it's incorrect.
7. Therefore, after analyzing each choice, the answer is A: office, because this location is most likely to have pens with a company logo due to corporate use.
Answer: A: office

Input: Billy called out to John, and listened for what? Choices:  A: silence B: response C: communication D: hanging up E: whisper
Rationales: 1. The question describes a situation where Billy called out to John. 
2. If someone calls out to another person, they are usually looking for a reply or wanting to get their attention.
3. This means that Billy would be expecting something coming back from John in return.
4. Let's explore the multiple choice answers. Option A: Billy might not expect silence because when you call out to someone, you want them to say something in return.
5. Option C: communication could be a potential answer, but it is quite broad. A response is a specific form of communication that happens when one person replies to another's words or actions.
6. Option D: hanging up is irrelevant because the situation does not involve using a phone.
7. Option E: a whisper could be considered a kind of response, but it is not necessarily what one would expect in this context. The response could be loud or soft, quick or slow, depending on the scenario.
8. Hence, the best choice is B: response, which is what one would commonly expect after calling out to someone.
Answer: B: response

Input: The lizard frightened the hiker, it's movements made what rustle? Choices:  A: garden B: trees C: books D: rocks E: bushes
Rationales: 1. The question is asking about the origin of the sound that frightened the hiker. 
2. The sound is described as a rustle, which typically refers to a soft, muffled crackling sound like that made by the movement of dry leaves or paper.
3. The answer choices given are garden, trees, books, rocks and bushes. We need to select an option where a lizard's movement could cause a rustling sound.
4. Consider 'garden'- the lizard can move in a garden, but a garden itself isn't known to produce a rustling sound specifically.
5. As for 'trees' and 'books', rustling could potentially happen due to wind or movement, but lizards don't typically move on these surfaces enough to cause a rustle.
6. 'Rocks' do not make a rustling sound when moved, ruling out this option.
7. Now, consider 'bushes'. Lizards often move inside and between bushes, where leaves could produce a rustling sound.
8. Hence, E: bushes is the answer. The lizard's movements made the bushes rustle, causing the hiker to be frightened.
Answer: E: bushes

Input: The man spent big money and time maintaining his lawn, it was part of keeping up with the Joneses where? Choices:  A: front yard B: suburbia C: neighborhood D: back yard E: golf course
Rationales: 1. The phrase "keeping up with the Joneses" refers to the comparison and competition one experiences amongst their neighbors where they strive to have the latest and greatest possessions or appearances.
2. In this case, the man is spending money and time maintaining his lawn, which is likely seen by his neighbors.
3. While options like "front yard", "neighborhood", and "back yard" can be places where the man's lawn is located and hence seen by his neighbors, they do not encompass the broader societal setting in which the pressures of "keeping up with the Joneses" occur.
4. Same with "golf course", this term neither implies the residence of the individual nor does it highlight the neighborhood aspect of the phrase.
5. On the other hand, "suburbia" implies a suburban setting where groups of residential houses are present and thus is often associated with the societal pressures of comparisons amongst neighbors or "keeping up with the Joneses".
6. Therefore, answer B: "suburbia" is the appropriate choice as it best fits the context of where "keeping up with the Joneses" takes place.
Answer: B: suburbia

### Input:Natalia sold clips to 48 of her friends in April, and then she sold half as many clips in May. How many clips did Natalia sell altogether in April and May?

### Response:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o6-tcommonsenseqa-s1-rTrue-m4096
Loading extension module utils...
Time to load utils op: 0.8052318096160889 seconds
Evaluating gsm8k :   1%|▍                                                      | 1/125 [00:27<56:19, 27.25s/it]Evaluating gsm8k :   2%|▊                                                    | 2/125 [01:09<1:13:21, 35.78s/it]Evaluating gsm8k :   2%|█▎                                                   | 3/125 [01:42<1:10:13, 34.53s/it]Evaluating gsm8k :   3%|█▊                                                     | 4/125 [02:01<57:52, 28.70s/it]Evaluating gsm8k :   4%|██▏                                                    | 5/125 [02:23<52:09, 26.08s/it]Evaluating gsm8k :   5%|██▌                                                  | 6/125 [03:04<1:02:15, 31.39s/it]Evaluating gsm8k :   6%|██▉                                                  | 7/125 [03:46<1:08:18, 34.74s/it]Evaluating gsm8k :   6%|███▌                                                   | 8/125 [04:08<59:36, 30.57s/it]Evaluating gsm8k :   7%|███▊                                                 | 9/125 [04:50<1:06:18, 34.30s/it]Evaluating gsm8k :   8%|████▏                                               | 10/125 [05:32<1:10:06, 36.58s/it]Evaluating gsm8k :   9%|████▌                                               | 11/125 [06:14<1:12:28, 38.15s/it]Evaluating gsm8k :  10%|████▉                                               | 12/125 [06:55<1:13:51, 39.22s/it]Evaluating gsm8k :  10%|█████▍                                              | 13/125 [07:37<1:14:37, 39.98s/it]Evaluating gsm8k :  11%|█████▊                                              | 14/125 [08:19<1:15:00, 40.54s/it]Evaluating gsm8k :  12%|██████▏                                             | 15/125 [09:00<1:14:42, 40.75s/it]Evaluating gsm8k :  13%|██████▋                                             | 16/125 [09:32<1:09:12, 38.10s/it]Evaluating gsm8k :  14%|███████                                             | 17/125 [10:14<1:10:35, 39.22s/it]Evaluating gsm8k :  14%|███████▍                                            | 18/125 [10:56<1:11:22, 40.03s/it]Evaluating gsm8k :  15%|███████▉                                            | 19/125 [11:37<1:11:24, 40.42s/it]Evaluating gsm8k :  16%|████████▎                                           | 20/125 [12:19<1:11:31, 40.87s/it]Evaluating gsm8k :  17%|████████▋                                           | 21/125 [13:01<1:11:40, 41.35s/it]Evaluating gsm8k :  18%|█████████▏                                          | 22/125 [13:35<1:06:58, 39.01s/it]Evaluating gsm8k :  18%|█████████▌                                          | 23/125 [14:17<1:07:46, 39.87s/it]Evaluating gsm8k :  19%|█████████▉                                          | 24/125 [14:58<1:07:58, 40.38s/it]Evaluating gsm8k :  20%|██████████▍                                         | 25/125 [15:40<1:07:59, 40.80s/it]Evaluating gsm8k :  21%|██████████▊                                         | 26/125 [16:22<1:07:44, 41.06s/it]Evaluating gsm8k :  22%|███████████▏                                        | 27/125 [17:03<1:07:18, 41.21s/it]Evaluating gsm8k :  22%|███████████▋                                        | 28/125 [17:45<1:06:51, 41.36s/it]Evaluating gsm8k :  23%|████████████                                        | 29/125 [18:27<1:06:23, 41.50s/it]Evaluating gsm8k :  24%|████████████▍                                       | 30/125 [19:09<1:05:44, 41.52s/it]Evaluating gsm8k :  25%|████████████▉                                       | 31/125 [19:41<1:00:55, 38.89s/it]Evaluating gsm8k :  26%|█████████████▎                                      | 32/125 [20:23<1:01:30, 39.68s/it]Evaluating gsm8k :  26%|██████████████▎                                       | 33/125 [20:58<58:35, 38.22s/it]Evaluating gsm8k :  27%|██████████████▋                                       | 34/125 [21:17<49:25, 32.59s/it]Evaluating gsm8k :  28%|███████████████                                       | 35/125 [21:40<44:19, 29.55s/it]Evaluating gsm8k :  29%|███████████████▌                                      | 36/125 [22:21<49:07, 33.12s/it]Evaluating gsm8k :  30%|███████████████▉                                      | 37/125 [22:44<44:06, 30.07s/it]Evaluating gsm8k :  30%|████████████████▍                                     | 38/125 [23:14<43:39, 30.11s/it]Evaluating gsm8k :  31%|████████████████▊                                     | 39/125 [23:49<45:14, 31.56s/it]Evaluating gsm8k :  32%|█████████████████▎                                    | 40/125 [24:32<49:19, 34.81s/it]Evaluating gsm8k :  33%|█████████████████▋                                    | 41/125 [24:56<44:20, 31.68s/it]Evaluating gsm8k :  34%|██████████████████▏                                   | 42/125 [25:25<42:40, 30.85s/it]Evaluating gsm8k :  34%|██████████████████▌                                   | 43/125 [26:06<46:35, 34.09s/it]Evaluating gsm8k :  35%|███████████████████                                   | 44/125 [26:49<49:20, 36.56s/it]Evaluating gsm8k :  36%|███████████████████▍                                  | 45/125 [27:23<47:53, 35.92s/it]Evaluating gsm8k :  37%|███████████████████▊                                  | 46/125 [28:05<49:42, 37.75s/it]Evaluating gsm8k :  38%|████████████████████▎                                 | 47/125 [28:48<50:52, 39.13s/it]Evaluating gsm8k :  38%|████████████████████▋                                 | 48/125 [29:02<40:37, 31.65s/it]Evaluating gsm8k :  39%|█████████████████████▏                                | 49/125 [29:43<43:48, 34.58s/it]Evaluating gsm8k :  40%|█████████████████████▌                                | 50/125 [30:25<46:01, 36.83s/it]Evaluating gsm8k :  41%|██████████████████████                                | 51/125 [30:58<43:56, 35.62s/it]Evaluating gsm8k :  42%|██████████████████████▍                               | 52/125 [31:29<41:32, 34.15s/it]Evaluating gsm8k :  42%|██████████████████████▉                               | 53/125 [32:10<43:35, 36.33s/it]Evaluating gsm8k :  43%|███████████████████████▎                              | 54/125 [32:52<44:49, 37.88s/it]Evaluating gsm8k :  44%|███████████████████████▊                              | 55/125 [33:29<44:07, 37.83s/it]Evaluating gsm8k :  45%|████████████████████████▏                             | 56/125 [34:12<45:02, 39.17s/it]Evaluating gsm8k :  46%|████████████████████████▌                             | 57/125 [34:54<45:29, 40.14s/it]Evaluating gsm8k :  46%|█████████████████████████                             | 58/125 [35:14<37:54, 33.95s/it]Evaluating gsm8k :  47%|█████████████████████████▍                            | 59/125 [35:56<39:58, 36.34s/it]Evaluating gsm8k :  48%|█████████████████████████▉                            | 60/125 [36:38<41:12, 38.04s/it]Evaluating gsm8k :  49%|██████████████████████████▎                           | 61/125 [37:13<39:44, 37.26s/it]Evaluating gsm8k :  50%|██████████████████████████▊                           | 62/125 [37:54<40:23, 38.46s/it]Evaluating gsm8k :  50%|███████████████████████████▏                          | 63/125 [38:32<39:38, 38.37s/it]Evaluating gsm8k :  51%|███████████████████████████▋                          | 64/125 [39:14<39:55, 39.28s/it]Evaluating gsm8k :  52%|████████████████████████████                          | 65/125 [39:56<40:06, 40.11s/it]Evaluating gsm8k :  53%|████████████████████████████▌                         | 66/125 [40:38<40:07, 40.81s/it]Evaluating gsm8k :  54%|████████████████████████████▉                         | 67/125 [41:20<39:46, 41.15s/it]Evaluating gsm8k :  54%|█████████████████████████████▍                        | 68/125 [41:45<34:23, 36.19s/it]Evaluating gsm8k :  55%|█████████████████████████████▊                        | 69/125 [42:19<33:04, 35.43s/it]Evaluating gsm8k :  56%|██████████████████████████████▏                       | 70/125 [43:00<34:11, 37.30s/it]Evaluating gsm8k :  57%|██████████████████████████████▋                       | 71/125 [43:43<35:01, 38.91s/it]Evaluating gsm8k :  58%|███████████████████████████████                       | 72/125 [44:24<34:59, 39.61s/it]Evaluating gsm8k :  58%|███████████████████████████████▌                      | 73/125 [45:06<34:57, 40.34s/it]Evaluating gsm8k :  59%|███████████████████████████████▉                      | 74/125 [45:48<34:39, 40.78s/it]Evaluating gsm8k :  60%|████████████████████████████████▍                     | 75/125 [46:29<34:10, 41.00s/it]Evaluating gsm8k :  61%|████████████████████████████████▊                     | 76/125 [47:09<33:03, 40.49s/it]Evaluating gsm8k :  62%|█████████████████████████████████▎                    | 77/125 [47:50<32:39, 40.82s/it]Evaluating gsm8k :  62%|█████████████████████████████████▋                    | 78/125 [48:32<32:16, 41.21s/it]Evaluating gsm8k :  63%|██████████████████████████████████▏                   | 79/125 [49:14<31:42, 41.35s/it]Evaluating gsm8k :  64%|██████████████████████████████████▌                   | 80/125 [49:42<27:53, 37.18s/it]Evaluating gsm8k :  65%|██████████████████████████████████▉                   | 81/125 [50:23<28:08, 38.38s/it]Evaluating gsm8k :  66%|███████████████████████████████████▍                  | 82/125 [50:50<25:09, 35.10s/it]Evaluating gsm8k :  66%|███████████████████████████████████▊                  | 83/125 [51:04<19:59, 28.57s/it]Evaluating gsm8k :  67%|████████████████████████████████████▎                 | 84/125 [51:45<22:12, 32.50s/it]Evaluating gsm8k :  68%|████████████████████████████████████▋                 | 85/125 [52:27<23:36, 35.41s/it]Evaluating gsm8k :  69%|█████████████████████████████████████▏                | 86/125 [53:09<24:15, 37.32s/it]Evaluating gsm8k :  70%|█████████████████████████████████████▌                | 87/125 [53:46<23:31, 37.16s/it]Evaluating gsm8k :  70%|██████████████████████████████████████                | 88/125 [54:28<23:44, 38.49s/it]Evaluating gsm8k :  71%|██████████████████████████████████████▍               | 89/125 [55:09<23:41, 39.47s/it]Evaluating gsm8k :  72%|██████████████████████████████████████▉               | 90/125 [55:51<23:26, 40.18s/it]Evaluating gsm8k :  73%|███████████████████████████████████████▎              | 91/125 [56:33<23:07, 40.79s/it]Evaluating gsm8k :  74%|███████████████████████████████████████▋              | 92/125 [57:16<22:43, 41.31s/it]Evaluating gsm8k :  74%|████████████████████████████████████████▏             | 93/125 [57:33<18:13, 34.18s/it]Evaluating gsm8k :  75%|████████████████████████████████████████▌             | 94/125 [57:58<16:06, 31.19s/it]Evaluating gsm8k :  76%|█████████████████████████████████████████             | 95/125 [58:40<17:19, 34.64s/it]Evaluating gsm8k :  77%|█████████████████████████████████████████▍            | 96/125 [59:22<17:43, 36.66s/it]Evaluating gsm8k :  78%|████████████████████████████████████████▎           | 97/125 [1:00:03<17:48, 38.18s/it]Evaluating gsm8k :  78%|████████████████████████████████████████▊           | 98/125 [1:00:28<15:18, 34.03s/it]Evaluating gsm8k :  79%|█████████████████████████████████████████▏          | 99/125 [1:01:10<15:48, 36.47s/it]Evaluating gsm8k :  80%|████████████████████████████████████████▊          | 100/125 [1:01:52<15:51, 38.08s/it]Evaluating gsm8k :  81%|█████████████████████████████████████████▏         | 101/125 [1:02:34<15:41, 39.25s/it]Evaluating gsm8k :  82%|█████████████████████████████████████████▌         | 102/125 [1:02:55<12:55, 33.73s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████         | 103/125 [1:03:36<13:14, 36.09s/it]Evaluating gsm8k :  83%|██████████████████████████████████████████▍        | 104/125 [1:04:18<13:15, 37.88s/it]Evaluating gsm8k :  84%|██████████████████████████████████████████▊        | 105/125 [1:05:00<13:02, 39.14s/it]Evaluating gsm8k :  85%|███████████████████████████████████████████▏       | 106/125 [1:05:42<12:39, 39.98s/it]Evaluating gsm8k :  86%|███████████████████████████████████████████▋       | 107/125 [1:06:24<12:06, 40.39s/it]Evaluating gsm8k :  86%|████████████████████████████████████████████       | 108/125 [1:07:01<11:10, 39.45s/it]Evaluating gsm8k :  87%|████████████████████████████████████████████▍      | 109/125 [1:07:43<10:42, 40.19s/it]Evaluating gsm8k :  88%|████████████████████████████████████████████▉      | 110/125 [1:08:25<10:11, 40.77s/it]Evaluating gsm8k :  89%|█████████████████████████████████████████████▎     | 111/125 [1:09:05<09:28, 40.64s/it]Evaluating gsm8k :  90%|█████████████████████████████████████████████▋     | 112/125 [1:09:47<08:53, 41.07s/it]Evaluating gsm8k :  90%|██████████████████████████████████████████████     | 113/125 [1:10:29<08:13, 41.16s/it]Evaluating gsm8k :  91%|██████████████████████████████████████████████▌    | 114/125 [1:11:11<07:36, 41.54s/it]Evaluating gsm8k :  92%|██████████████████████████████████████████████▉    | 115/125 [1:11:42<06:24, 38.47s/it]Evaluating gsm8k :  93%|███████████████████████████████████████████████▎   | 116/125 [1:12:09<05:12, 34.77s/it]Evaluating gsm8k :  94%|███████████████████████████████████████████████▋   | 117/125 [1:12:50<04:53, 36.69s/it]Evaluating gsm8k :  94%|████████████████████████████████████████████████▏  | 118/125 [1:13:31<04:26, 38.04s/it]Evaluating gsm8k :  95%|████████████████████████████████████████████████▌  | 119/125 [1:14:14<03:56, 39.46s/it]Evaluating gsm8k :  96%|████████████████████████████████████████████████▉  | 120/125 [1:14:56<03:21, 40.26s/it]Evaluating gsm8k :  97%|█████████████████████████████████████████████████▎ | 121/125 [1:15:37<02:42, 40.66s/it]Evaluating gsm8k :  98%|█████████████████████████████████████████████████▊ | 122/125 [1:16:19<02:02, 40.97s/it]Evaluating gsm8k :  98%|██████████████████████████████████████████████████▏| 123/125 [1:17:02<01:22, 41.44s/it]Evaluating gsm8k :  99%|██████████████████████████████████████████████████▌| 124/125 [1:17:26<00:36, 36.31s/it]Evaluating gsm8k : 100%|███████████████████████████████████████████████████| 125/125 [1:18:08<00:00, 38.05s/it]Evaluating gsm8k : 100%|███████████████████████████████████████████████████| 125/125 [1:18:08<00:00, 37.51s/it]
name: gsm8k | {'exact_match': 0.0, 'rougeL': 0.263} | lm_loss 10.0812 | avg. gen lenth: 359.612
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name gsm8k --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name commonsenseqa --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --max-prompt-length 4096 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 2 --data-dir /scratch/ylu130/processed_data/gsm8k/out-domain/o7-tcommonsenseqa-s1-rTrue --seed 1 --rationales --num-out-domain 7
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-16 02:11:51,384] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... gsm8k
  data_dir ..................... /scratch/ylu130/processed_data/gsm8k/out-domain/o7-tcommonsenseqa-s1-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 7
  out_domain_data_name ......... commonsenseqa
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 4096
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o7-tcommonsenseqa-s1-rTrue-m4096
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 2
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                 | 0/7473 [00:00<?, ?it/s]  0%|▏                                                                      | 14/7473 [00:00<00:57, 130.72it/s]  0%|▎                                                                      | 28/7473 [00:00<00:56, 130.95it/s]  1%|▍                                                                      | 42/7473 [00:00<00:56, 131.13it/s]  1%|▌                                                                      | 56/7473 [00:00<00:56, 131.37it/s]  1%|▋                                                                      | 70/7473 [00:00<00:56, 131.42it/s]  1%|▊                                                                      | 84/7473 [00:00<00:56, 131.60it/s]  1%|▉                                                                      | 98/7473 [00:00<00:55, 131.81it/s]  1%|█                                                                     | 112/7473 [00:00<00:55, 131.69it/s]  2%|█▏                                                                    | 126/7473 [00:00<00:55, 131.64it/s]  2%|█▎                                                                    | 140/7473 [00:01<00:56, 129.40it/s]  2%|█▍                                                                    | 154/7473 [00:01<00:56, 130.24it/s]  2%|█▌                                                                    | 168/7473 [00:01<00:55, 130.57it/s]  2%|█▋                                                                    | 182/7473 [00:01<00:55, 130.95it/s]  3%|█▊                                                                    | 196/7473 [00:01<00:55, 131.15it/s]  3%|█▉                                                                    | 210/7473 [00:01<00:55, 131.63it/s]  3%|██                                                                    | 224/7473 [00:01<00:55, 131.74it/s]  3%|██▏                                                                   | 238/7473 [00:01<00:55, 131.33it/s]  3%|██▎                                                                   | 252/7473 [00:01<00:55, 130.09it/s]  4%|██▍                                                                   | 266/7473 [00:02<00:55, 130.83it/s]  4%|██▌                                                                   | 280/7473 [00:02<00:55, 129.32it/s]  4%|██▊                                                                   | 294/7473 [00:02<00:55, 130.08it/s]  4%|██▉                                                                   | 308/7473 [00:02<00:54, 130.33it/s]  4%|███                                                                   | 322/7473 [00:02<00:54, 131.11it/s]  5%|███▏                                                                  | 339/7473 [00:02<00:50, 141.26it/s]  5%|███▎                                                                  | 360/7473 [00:02<00:44, 159.00it/s]  5%|███▌                                                                  | 381/7473 [00:02<00:41, 171.43it/s]  5%|███▊                                                                  | 401/7473 [00:02<00:39, 179.49it/s]  6%|███▉                                                                  | 422/7473 [00:02<00:37, 185.97it/s]  6%|████▏                                                                 | 442/7473 [00:03<00:37, 189.72it/s]  6%|████▎                                                                 | 462/7473 [00:03<00:36, 192.51it/s]  6%|████▌                                                                 | 482/7473 [00:03<00:36, 192.95it/s]  7%|████▋                                                                 | 503/7473 [00:03<00:35, 195.03it/s]  7%|████▉                                                                 | 524/7473 [00:03<00:35, 197.18it/s]  7%|█████                                                                 | 544/7473 [00:03<00:35, 197.47it/s]  8%|█████▎                                                                | 565/7473 [00:03<00:34, 198.76it/s]  8%|█████▍                                                                | 586/7473 [00:03<00:34, 199.23it/s]  8%|█████▋                                                                | 607/7473 [00:03<00:34, 199.48it/s]  8%|█████▊                                                                | 627/7473 [00:04<00:34, 199.61it/s]  9%|██████                                                                | 648/7473 [00:04<00:34, 200.01it/s]  9%|██████▎                                                               | 669/7473 [00:04<00:33, 201.08it/s]  9%|██████▍                                                               | 690/7473 [00:04<00:33, 201.62it/s] 10%|██████▋                                                               | 711/7473 [00:04<00:33, 199.29it/s] 10%|██████▊                                                               | 732/7473 [00:04<00:33, 200.29it/s] 10%|███████                                                               | 753/7473 [00:04<00:33, 201.22it/s] 10%|███████▎                                                              | 774/7473 [00:04<00:33, 200.98it/s] 11%|███████▍                                                              | 795/7473 [00:04<00:33, 201.05it/s] 11%|███████▋                                                              | 816/7473 [00:04<00:33, 200.31it/s] 11%|███████▊                                                              | 837/7473 [00:05<00:33, 199.99it/s] 11%|████████                                                              | 858/7473 [00:05<00:33, 200.22it/s] 12%|████████▏                                                             | 879/7473 [00:05<00:32, 200.65it/s] 12%|████████▍                                                             | 900/7473 [00:05<00:32, 200.81it/s] 12%|████████▋                                                             | 921/7473 [00:05<00:32, 201.17it/s] 13%|████████▊                                                             | 942/7473 [00:05<00:32, 199.04it/s] 13%|█████████                                                             | 963/7473 [00:05<00:32, 198.95it/s] 13%|█████████▏                                                            | 984/7473 [00:05<00:32, 199.79it/s] 13%|█████████▎                                                           | 1005/7473 [00:05<00:32, 200.11it/s] 14%|█████████▍                                                           | 1026/7473 [00:05<00:32, 200.88it/s] 14%|█████████▋                                                           | 1047/7473 [00:06<00:32, 199.53it/s] 14%|█████████▊                                                           | 1067/7473 [00:06<00:32, 199.19it/s] 15%|██████████                                                           | 1088/7473 [00:06<00:31, 199.87it/s] 15%|██████████▏                                                          | 1109/7473 [00:06<00:31, 200.12it/s] 15%|██████████▍                                                          | 1130/7473 [00:06<00:31, 200.42it/s] 15%|██████████▋                                                          | 1151/7473 [00:06<00:31, 200.82it/s] 16%|██████████▊                                                          | 1172/7473 [00:06<00:31, 199.29it/s] 16%|███████████                                                          | 1193/7473 [00:06<00:31, 199.72it/s] 16%|███████████▏                                                         | 1214/7473 [00:06<00:31, 200.15it/s] 17%|███████████▍                                                         | 1235/7473 [00:07<00:31, 198.37it/s] 17%|███████████▌                                                         | 1255/7473 [00:07<00:31, 197.97it/s] 17%|███████████▊                                                         | 1275/7473 [00:07<00:31, 196.62it/s] 17%|███████████▉                                                         | 1296/7473 [00:07<00:31, 198.04it/s] 18%|████████████▏                                                        | 1317/7473 [00:07<00:30, 199.29it/s] 18%|████████████▎                                                        | 1337/7473 [00:07<00:30, 199.25it/s] 18%|████████████▌                                                        | 1358/7473 [00:07<00:30, 199.80it/s] 18%|████████████▋                                                        | 1379/7473 [00:07<00:30, 200.23it/s] 19%|████████████▉                                                        | 1400/7473 [00:07<00:30, 197.78it/s] 19%|█████████████                                                        | 1421/7473 [00:07<00:30, 198.57it/s] 19%|█████████████▎                                                       | 1442/7473 [00:08<00:30, 199.26it/s] 20%|█████████████▌                                                       | 1463/7473 [00:08<00:30, 199.78it/s] 20%|█████████████▋                                                       | 1483/7473 [00:08<00:30, 198.80it/s] 20%|█████████████▉                                                       | 1503/7473 [00:08<00:30, 198.09it/s] 20%|██████████████                                                       | 1524/7473 [00:08<00:29, 199.11it/s] 21%|██████████████▎                                                      | 1545/7473 [00:08<00:29, 199.78it/s] 21%|██████████████▍                                                      | 1565/7473 [00:08<00:29, 199.56it/s] 21%|██████████████▋                                                      | 1585/7473 [00:08<00:29, 199.03it/s] 21%|██████████████▊                                                      | 1605/7473 [00:08<00:29, 199.04it/s] 22%|███████████████                                                      | 1625/7473 [00:09<00:29, 197.51it/s] 22%|███████████████▏                                                     | 1646/7473 [00:09<00:29, 198.54it/s] 22%|███████████████▍                                                     | 1666/7473 [00:09<00:29, 198.28it/s] 23%|███████████████▌                                                     | 1686/7473 [00:09<00:29, 197.79it/s] 23%|███████████████▊                                                     | 1706/7473 [00:09<00:29, 196.78it/s] 23%|███████████████▉                                                     | 1727/7473 [00:09<00:29, 197.94it/s] 23%|████████████████▏                                                    | 1747/7473 [00:09<00:28, 197.50it/s] 24%|████████████████▎                                                    | 1767/7473 [00:09<00:28, 198.04it/s] 24%|████████████████▌                                                    | 1788/7473 [00:09<00:28, 198.69it/s] 24%|████████████████▋                                                    | 1809/7473 [00:09<00:28, 199.37it/s] 24%|████████████████▉                                                    | 1829/7473 [00:10<00:28, 198.82it/s] 25%|█████████████████                                                    | 1849/7473 [00:10<00:28, 197.55it/s] 25%|█████████████████▎                                                   | 1870/7473 [00:10<00:28, 198.59it/s] 25%|█████████████████▍                                                   | 1891/7473 [00:10<00:28, 199.19it/s] 26%|█████████████████▋                                                   | 1911/7473 [00:10<00:28, 197.10it/s] 26%|█████████████████▊                                                   | 1931/7473 [00:10<00:28, 195.73it/s] 26%|██████████████████                                                   | 1952/7473 [00:10<00:27, 197.29it/s] 26%|██████████████████▏                                                  | 1973/7473 [00:10<00:27, 198.45it/s] 27%|██████████████████▍                                                  | 1993/7473 [00:10<00:27, 198.67it/s] 27%|██████████████████▌                                                  | 2014/7473 [00:10<00:27, 199.48it/s] 27%|██████████████████▊                                                  | 2035/7473 [00:11<00:27, 200.10it/s] 28%|██████████████████▉                                                  | 2056/7473 [00:11<00:27, 200.35it/s] 28%|███████████████████▏                                                 | 2077/7473 [00:11<00:27, 197.78it/s] 28%|███████████████████▎                                                 | 2098/7473 [00:11<00:27, 198.75it/s] 28%|███████████████████▌                                                 | 2118/7473 [00:11<00:26, 198.66it/s] 29%|███████████████████▋                                                 | 2138/7473 [00:11<00:27, 197.35it/s] 29%|███████████████████▉                                                 | 2158/7473 [00:11<00:27, 196.63it/s] 29%|████████████████████                                                 | 2179/7473 [00:11<00:26, 197.86it/s] 29%|████████████████████▎                                                | 2199/7473 [00:11<00:26, 198.37it/s] 30%|████████████████████▍                                                | 2220/7473 [00:12<00:26, 199.34it/s] 30%|████████████████████▋                                                | 2240/7473 [00:12<00:26, 199.11it/s] 30%|████████████████████▊                                                | 2260/7473 [00:12<00:26, 199.16it/s] 31%|█████████████████████                                                | 2280/7473 [00:12<00:26, 199.22it/s] 31%|█████████████████████▏                                               | 2300/7473 [00:12<00:26, 197.87it/s] 31%|█████████████████████▍                                               | 2320/7473 [00:12<00:26, 198.13it/s] 31%|█████████████████████▌                                               | 2340/7473 [00:12<00:25, 198.36it/s] 32%|█████████████████████▊                                               | 2360/7473 [00:12<00:25, 197.77it/s] 32%|█████████████████████▉                                               | 2380/7473 [00:12<00:25, 198.40it/s] 32%|██████████████████████▏                                              | 2400/7473 [00:12<00:25, 198.80it/s] 32%|██████████████████████▎                                              | 2421/7473 [00:13<00:25, 199.57it/s] 33%|██████████████████████▌                                              | 2442/7473 [00:13<00:25, 200.44it/s] 33%|██████████████████████▋                                              | 2463/7473 [00:13<00:24, 200.61it/s] 33%|██████████████████████▉                                              | 2484/7473 [00:13<00:24, 200.15it/s] 34%|███████████████████████▏                                             | 2505/7473 [00:13<00:24, 199.37it/s] 34%|███████████████████████▎                                             | 2525/7473 [00:13<00:28, 174.20it/s] 34%|███████████████████████▍                                             | 2543/7473 [00:13<00:28, 175.00it/s] 34%|███████████████████████▋                                             | 2563/7473 [00:13<00:27, 180.55it/s] 35%|███████████████████████▊                                             | 2583/7473 [00:13<00:26, 185.92it/s] 35%|████████████████████████                                             | 2604/7473 [00:13<00:25, 190.24it/s] 35%|████████████████████████▏                                            | 2625/7473 [00:14<00:25, 193.36it/s] 35%|████████████████████████▍                                            | 2645/7473 [00:14<00:24, 195.21it/s] 36%|████████████████████████▌                                            | 2666/7473 [00:14<00:24, 197.17it/s] 36%|████████████████████████▊                                            | 2687/7473 [00:14<00:24, 198.30it/s] 36%|█████████████████████████                                            | 2708/7473 [00:14<00:23, 198.85it/s] 37%|█████████████████████████▏                                           | 2728/7473 [00:14<00:23, 198.99it/s] 37%|█████████████████████████▎                                           | 2748/7473 [00:14<00:23, 197.78it/s] 37%|█████████████████████████▌                                           | 2768/7473 [00:14<00:23, 197.56it/s] 37%|█████████████████████████▋                                           | 2788/7473 [00:14<00:23, 196.64it/s] 38%|█████████████████████████▉                                           | 2808/7473 [00:15<00:23, 197.34it/s] 38%|██████████████████████████                                           | 2828/7473 [00:15<00:23, 197.99it/s] 38%|██████████████████████████▎                                          | 2849/7473 [00:15<00:23, 198.89it/s] 38%|██████████████████████████▍                                          | 2869/7473 [00:15<00:23, 199.00it/s] 39%|██████████████████████████▋                                          | 2889/7473 [00:15<00:23, 199.19it/s] 39%|██████████████████████████▊                                          | 2910/7473 [00:15<00:22, 199.76it/s] 39%|███████████████████████████                                          | 2930/7473 [00:15<00:22, 199.58it/s] 39%|███████████████████████████▏                                         | 2951/7473 [00:15<00:22, 200.00it/s] 40%|███████████████████████████▍                                         | 2972/7473 [00:15<00:22, 200.09it/s] 40%|███████████████████████████▋                                         | 2993/7473 [00:15<00:22, 196.27it/s] 40%|███████████████████████████▊                                         | 3013/7473 [00:16<00:22, 196.07it/s] 41%|████████████████████████████                                         | 3033/7473 [00:16<00:22, 196.96it/s] 41%|████████████████████████████▏                                        | 3053/7473 [00:16<00:22, 197.77it/s] 41%|████████████████████████████▎                                        | 3073/7473 [00:16<00:22, 198.37it/s] 41%|████████████████████████████▌                                        | 3094/7473 [00:16<00:22, 199.03it/s] 42%|████████████████████████████▊                                        | 3114/7473 [00:16<00:21, 198.61it/s] 42%|████████████████████████████▉                                        | 3134/7473 [00:16<00:21, 198.65it/s] 42%|█████████████████████████████                                        | 3154/7473 [00:16<00:21, 198.99it/s] 42%|█████████████████████████████▎                                       | 3174/7473 [00:16<00:21, 198.35it/s] 43%|█████████████████████████████▍                                       | 3194/7473 [00:16<00:21, 198.50it/s] 43%|█████████████████████████████▋                                       | 3214/7473 [00:17<00:21, 197.51it/s] 43%|█████████████████████████████▊                                       | 3234/7473 [00:17<00:21, 193.72it/s] 44%|██████████████████████████████                                       | 3254/7473 [00:17<00:22, 191.52it/s] 44%|██████████████████████████████▏                                      | 3274/7473 [00:17<00:21, 192.59it/s] 44%|██████████████████████████████▍                                      | 3294/7473 [00:17<00:21, 194.71it/s] 44%|██████████████████████████████▌                                      | 3315/7473 [00:17<00:21, 196.38it/s] 45%|██████████████████████████████▊                                      | 3335/7473 [00:17<00:21, 195.98it/s] 45%|██████████████████████████████▉                                      | 3355/7473 [00:17<00:20, 197.15it/s] 45%|███████████████████████████████▏                                     | 3375/7473 [00:17<00:20, 197.82it/s] 45%|███████████████████████████████▎                                     | 3395/7473 [00:17<00:20, 198.10it/s] 46%|███████████████████████████████▌                                     | 3415/7473 [00:18<00:20, 198.27it/s] 46%|███████████████████████████████▋                                     | 3435/7473 [00:18<00:20, 197.15it/s] 46%|███████████████████████████████▉                                     | 3455/7473 [00:18<00:20, 197.79it/s] 47%|████████████████████████████████                                     | 3475/7473 [00:18<00:20, 197.93it/s] 47%|████████████████████████████████▎                                    | 3495/7473 [00:18<00:20, 197.13it/s] 47%|████████████████████████████████▍                                    | 3516/7473 [00:18<00:19, 198.14it/s] 47%|████████████████████████████████▋                                    | 3536/7473 [00:18<00:19, 198.33it/s] 48%|████████████████████████████████▊                                    | 3556/7473 [00:18<00:19, 198.73it/s] 48%|█████████████████████████████████                                    | 3577/7473 [00:18<00:19, 199.19it/s] 48%|█████████████████████████████████▏                                   | 3598/7473 [00:19<00:19, 199.69it/s] 48%|█████████████████████████████████▍                                   | 3619/7473 [00:19<00:19, 199.81it/s] 49%|█████████████████████████████████▌                                   | 3639/7473 [00:19<00:19, 199.25it/s] 49%|█████████████████████████████████▊                                   | 3659/7473 [00:19<00:19, 197.70it/s] 49%|█████████████████████████████████▉                                   | 3680/7473 [00:19<00:19, 198.43it/s] 50%|██████████████████████████████████▏                                  | 3701/7473 [00:19<00:18, 198.95it/s] 50%|██████████████████████████████████▎                                  | 3721/7473 [00:19<00:18, 198.58it/s] 50%|██████████████████████████████████▌                                  | 3741/7473 [00:19<00:18, 198.32it/s] 50%|██████████████████████████████████▋                                  | 3761/7473 [00:19<00:18, 198.60it/s] 51%|██████████████████████████████████▉                                  | 3781/7473 [00:19<00:18, 198.61it/s] 51%|███████████████████████████████████                                  | 3801/7473 [00:20<00:18, 198.76it/s] 51%|███████████████████████████████████▎                                 | 3822/7473 [00:20<00:18, 199.26it/s] 51%|███████████████████████████████████▍                                 | 3842/7473 [00:20<00:18, 197.51it/s] 52%|███████████████████████████████████▋                                 | 3862/7473 [00:20<00:18, 197.76it/s] 52%|███████████████████████████████████▊                                 | 3882/7473 [00:20<00:18, 196.33it/s] 52%|████████████████████████████████████                                 | 3903/7473 [00:20<00:18, 197.66it/s] 53%|████████████████████████████████████▏                                | 3924/7473 [00:20<00:17, 198.42it/s] 53%|████████████████████████████████████▍                                | 3944/7473 [00:20<00:17, 198.54it/s] 53%|████████████████████████████████████▌                                | 3964/7473 [00:20<00:17, 198.75it/s] 53%|████████████████████████████████████▊                                | 3984/7473 [00:20<00:17, 198.93it/s] 54%|████████████████████████████████████▉                                | 4005/7473 [00:21<00:17, 199.38it/s] 54%|█████████████████████████████████████▏                               | 4025/7473 [00:21<00:17, 199.28it/s] 54%|█████████████████████████████████████▎                               | 4045/7473 [00:21<00:17, 199.04it/s] 54%|█████████████████████████████████████▌                               | 4065/7473 [00:21<00:17, 199.18it/s] 55%|█████████████████████████████████████▋                               | 4085/7473 [00:21<00:17, 198.72it/s] 55%|█████████████████████████████████████▉                               | 4105/7473 [00:21<00:16, 198.44it/s] 55%|██████████████████████████████████████                               | 4125/7473 [00:21<00:17, 195.62it/s] 55%|██████████████████████████████████████▎                              | 4145/7473 [00:21<00:16, 196.51it/s] 56%|██████████████████████████████████████▍                              | 4165/7473 [00:21<00:16, 195.44it/s] 56%|██████████████████████████████████████▋                              | 4185/7473 [00:21<00:16, 196.22it/s] 56%|██████████████████████████████████████▊                              | 4205/7473 [00:22<00:16, 196.96it/s] 57%|███████████████████████████████████████                              | 4225/7473 [00:22<00:16, 197.29it/s] 57%|███████████████████████████████████████▏                             | 4245/7473 [00:22<00:16, 197.55it/s] 57%|███████████████████████████████████████▍                             | 4265/7473 [00:22<00:16, 197.97it/s] 57%|███████████████████████████████████████▌                             | 4285/7473 [00:22<00:16, 197.82it/s] 58%|███████████████████████████████████████▋                             | 4305/7473 [00:22<00:15, 198.07it/s] 58%|███████████████████████████████████████▉                             | 4325/7473 [00:22<00:15, 198.31it/s] 58%|████████████████████████████████████████                             | 4345/7473 [00:22<00:15, 197.32it/s] 58%|████████████████████████████████████████▎                            | 4365/7473 [00:22<00:15, 197.58it/s] 59%|████████████████████████████████████████▍                            | 4385/7473 [00:22<00:15, 197.74it/s] 59%|████████████████████████████████████████▋                            | 4405/7473 [00:23<00:15, 198.04it/s] 59%|████████████████████████████████████████▊                            | 4425/7473 [00:23<00:15, 198.16it/s] 59%|█████████████████████████████████████████                            | 4445/7473 [00:23<00:15, 198.13it/s] 60%|█████████████████████████████████████████▏                           | 4465/7473 [00:23<00:15, 198.10it/s] 60%|█████████████████████████████████████████▍                           | 4485/7473 [00:23<00:15, 198.18it/s] 60%|█████████████████████████████████████████▌                           | 4505/7473 [00:23<00:15, 196.69it/s] 61%|█████████████████████████████████████████▊                           | 4525/7473 [00:23<00:15, 195.83it/s] 61%|█████████████████████████████████████████▉                           | 4545/7473 [00:23<00:14, 196.63it/s] 61%|██████████████████████████████████████████▏                          | 4565/7473 [00:23<00:14, 195.99it/s] 61%|██████████████████████████████████████████▎                          | 4585/7473 [00:24<00:14, 196.74it/s] 62%|██████████████████████████████████████████▌                          | 4605/7473 [00:24<00:14, 197.26it/s] 62%|██████████████████████████████████████████▋                          | 4625/7473 [00:24<00:14, 197.70it/s] 62%|██████████████████████████████████████████▉                          | 4645/7473 [00:24<00:14, 197.88it/s] 62%|███████████████████████████████████████████                          | 4665/7473 [00:24<00:14, 198.25it/s] 63%|███████████████████████████████████████████▎                         | 4685/7473 [00:24<00:14, 198.57it/s] 63%|███████████████████████████████████████████▍                         | 4705/7473 [00:24<00:13, 198.31it/s] 63%|███████████████████████████████████████████▋                         | 4726/7473 [00:24<00:13, 198.82it/s] 64%|███████████████████████████████████████████▊                         | 4746/7473 [00:24<00:13, 199.04it/s] 64%|████████████████████████████████████████████                         | 4767/7473 [00:24<00:13, 199.53it/s] 64%|████████████████████████████████████████████▏                        | 4787/7473 [00:25<00:13, 199.54it/s] 64%|████████████████████████████████████████████▍                        | 4807/7473 [00:25<00:13, 197.74it/s] 65%|████████████████████████████████████████████▌                        | 4828/7473 [00:25<00:13, 198.59it/s] 65%|████████████████████████████████████████████▊                        | 4848/7473 [00:25<00:13, 197.55it/s] 65%|████████████████████████████████████████████▉                        | 4868/7473 [00:25<00:13, 197.65it/s] 65%|█████████████████████████████████████████████▏                       | 4889/7473 [00:25<00:13, 198.45it/s] 66%|█████████████████████████████████████████████▎                       | 4910/7473 [00:25<00:12, 199.02it/s] 66%|█████████████████████████████████████████████▌                       | 4930/7473 [00:25<00:12, 198.58it/s] 66%|█████████████████████████████████████████████▋                       | 4950/7473 [00:25<00:12, 198.55it/s] 67%|█████████████████████████████████████████████▉                       | 4970/7473 [00:25<00:12, 198.12it/s] 67%|██████████████████████████████████████████████                       | 4990/7473 [00:26<00:12, 198.21it/s] 67%|██████████████████████████████████████████████▎                      | 5010/7473 [00:26<00:12, 198.25it/s] 67%|██████████████████████████████████████████████▍                      | 5030/7473 [00:26<00:12, 196.28it/s] 68%|██████████████████████████████████████████████▋                      | 5051/7473 [00:26<00:12, 197.58it/s] 68%|██████████████████████████████████████████████▊                      | 5072/7473 [00:26<00:12, 198.48it/s] 68%|███████████████████████████████████████████████                      | 5092/7473 [00:26<00:11, 198.91it/s] 68%|███████████████████████████████████████████████▏                     | 5112/7473 [00:26<00:11, 198.99it/s] 69%|███████████████████████████████████████████████▍                     | 5133/7473 [00:26<00:11, 199.32it/s] 69%|███████████████████████████████████████████████▌                     | 5153/7473 [00:26<00:11, 199.51it/s] 69%|███████████████████████████████████████████████▊                     | 5173/7473 [00:26<00:11, 197.33it/s] 69%|███████████████████████████████████████████████▉                     | 5193/7473 [00:27<00:11, 196.84it/s] 70%|████████████████████████████████████████████████▏                    | 5213/7473 [00:27<00:11, 197.68it/s] 70%|████████████████████████████████████████████████▎                    | 5233/7473 [00:27<00:11, 197.59it/s] 70%|████████████████████████████████████████████████▌                    | 5253/7473 [00:27<00:13, 165.23it/s] 71%|████████████████████████████████████████████████▋                    | 5273/7473 [00:27<00:12, 174.06it/s] 71%|████████████████████████████████████████████████▊                    | 5292/7473 [00:27<00:12, 175.72it/s] 71%|█████████████████████████████████████████████████                    | 5312/7473 [00:27<00:11, 182.00it/s] 71%|█████████████████████████████████████████████████▏                   | 5332/7473 [00:27<00:11, 186.55it/s] 72%|█████████████████████████████████████████████████▍                   | 5352/7473 [00:27<00:11, 190.18it/s] 72%|█████████████████████████████████████████████████▌                   | 5373/7473 [00:28<00:10, 193.18it/s] 72%|█████████████████████████████████████████████████▊                   | 5394/7473 [00:28<00:10, 195.33it/s] 72%|█████████████████████████████████████████████████▉                   | 5414/7473 [00:28<00:10, 196.49it/s] 73%|██████████████████████████████████████████████████▏                  | 5434/7473 [00:28<00:10, 197.41it/s] 73%|██████████████████████████████████████████████████▎                  | 5454/7473 [00:28<00:10, 198.02it/s] 73%|██████████████████████████████████████████████████▌                  | 5474/7473 [00:28<00:16, 122.90it/s] 74%|██████████████████████████████████████████████████▋                  | 5494/7473 [00:28<00:14, 138.64it/s] 74%|██████████████████████████████████████████████████▉                  | 5514/7473 [00:28<00:12, 152.35it/s] 74%|███████████████████████████████████████████████████                  | 5535/7473 [00:29<00:11, 164.49it/s] 74%|███████████████████████████████████████████████████▎                 | 5556/7473 [00:29<00:11, 174.07it/s] 75%|███████████████████████████████████████████████████▍                 | 5576/7473 [00:29<00:10, 180.71it/s] 75%|███████████████████████████████████████████████████▋                 | 5596/7473 [00:29<00:10, 185.42it/s] 75%|███████████████████████████████████████████████████▊                 | 5616/7473 [00:29<00:09, 189.39it/s] 75%|████████████████████████████████████████████████████                 | 5636/7473 [00:29<00:09, 192.20it/s] 76%|████████████████████████████████████████████████████▏                | 5656/7473 [00:29<00:09, 194.21it/s] 76%|████████████████████████████████████████████████████▍                | 5676/7473 [00:29<00:09, 192.92it/s] 76%|████████████████████████████████████████████████████▌                | 5696/7473 [00:29<00:09, 194.16it/s] 76%|████████████████████████████████████████████████████▊                | 5716/7473 [00:29<00:08, 195.52it/s] 77%|████████████████████████████████████████████████████▉                | 5736/7473 [00:30<00:08, 196.59it/s] 77%|█████████████████████████████████████████████████████▏               | 5756/7473 [00:30<00:08, 191.78it/s] 77%|█████████████████████████████████████████████████████▎               | 5776/7473 [00:30<00:08, 193.99it/s] 78%|█████████████████████████████████████████████████████▌               | 5796/7473 [00:30<00:08, 195.03it/s] 78%|█████████████████████████████████████████████████████▋               | 5816/7473 [00:30<00:08, 196.04it/s] 78%|█████████████████████████████████████████████████████▉               | 5836/7473 [00:30<00:08, 196.49it/s] 78%|██████████████████████████████████████████████████████               | 5856/7473 [00:30<00:08, 196.16it/s] 79%|██████████████████████████████████████████████████████▎              | 5876/7473 [00:30<00:08, 196.78it/s] 79%|██████████████████████████████████████████████████████▍              | 5896/7473 [00:30<00:07, 197.27it/s] 79%|██████████████████████████████████████████████████████▌              | 5916/7473 [00:31<00:07, 195.78it/s] 79%|██████████████████████████████████████████████████████▊              | 5936/7473 [00:31<00:07, 196.34it/s] 80%|██████████████████████████████████████████████████████▉              | 5956/7473 [00:31<00:07, 196.54it/s] 80%|███████████████████████████████████████████████████████▏             | 5976/7473 [00:31<00:07, 196.80it/s] 80%|███████████████████████████████████████████████████████▎             | 5996/7473 [00:31<00:07, 197.21it/s] 81%|███████████████████████████████████████████████████████▌             | 6016/7473 [00:31<00:07, 197.34it/s] 81%|███████████████████████████████████████████████████████▋             | 6036/7473 [00:31<00:07, 197.36it/s] 81%|███████████████████████████████████████████████████████▉             | 6056/7473 [00:31<00:07, 198.04it/s] 81%|████████████████████████████████████████████████████████             | 6076/7473 [00:31<00:07, 198.00it/s] 82%|████████████████████████████████████████████████████████▎            | 6096/7473 [00:31<00:06, 198.54it/s] 82%|████████████████████████████████████████████████████████▍            | 6116/7473 [00:32<00:06, 198.90it/s] 82%|████████████████████████████████████████████████████████▋            | 6136/7473 [00:32<00:06, 197.18it/s] 82%|████████████████████████████████████████████████████████▊            | 6156/7473 [00:32<00:06, 197.59it/s] 83%|█████████████████████████████████████████████████████████            | 6176/7473 [00:32<00:06, 198.07it/s] 83%|█████████████████████████████████████████████████████████▏           | 6197/7473 [00:32<00:06, 198.61it/s] 83%|█████████████████████████████████████████████████████████▍           | 6217/7473 [00:32<00:06, 198.43it/s] 83%|█████████████████████████████████████████████████████████▌           | 6237/7473 [00:32<00:06, 198.61it/s] 84%|█████████████████████████████████████████████████████████▊           | 6257/7473 [00:32<00:06, 198.47it/s] 84%|█████████████████████████████████████████████████████████▉           | 6277/7473 [00:32<00:06, 198.72it/s] 84%|██████████████████████████████████████████████████████████▏          | 6297/7473 [00:32<00:05, 197.11it/s] 85%|██████████████████████████████████████████████████████████▎          | 6317/7473 [00:33<00:05, 196.32it/s] 85%|██████████████████████████████████████████████████████████▌          | 6337/7473 [00:33<00:05, 196.72it/s] 85%|██████████████████████████████████████████████████████████▋          | 6357/7473 [00:33<00:05, 194.91it/s] 85%|██████████████████████████████████████████████████████████▉          | 6377/7473 [00:33<00:05, 194.78it/s] 86%|███████████████████████████████████████████████████████████          | 6397/7473 [00:33<00:05, 195.32it/s] 86%|███████████████████████████████████████████████████████████▏         | 6417/7473 [00:33<00:05, 196.58it/s] 86%|███████████████████████████████████████████████████████████▍         | 6437/7473 [00:33<00:05, 197.10it/s] 86%|███████████████████████████████████████████████████████████▌         | 6457/7473 [00:33<00:05, 197.32it/s] 87%|███████████████████████████████████████████████████████████▊         | 6477/7473 [00:33<00:05, 197.72it/s] 87%|███████████████████████████████████████████████████████████▉         | 6497/7473 [00:33<00:04, 198.22it/s] 87%|████████████████████████████████████████████████████████████▏        | 6517/7473 [00:34<00:04, 198.12it/s] 87%|████████████████████████████████████████████████████████████▎        | 6537/7473 [00:34<00:04, 197.75it/s] 88%|████████████████████████████████████████████████████████████▌        | 6557/7473 [00:34<00:04, 197.80it/s] 88%|████████████████████████████████████████████████████████████▋        | 6577/7473 [00:34<00:04, 198.24it/s] 88%|████████████████████████████████████████████████████████████▉        | 6597/7473 [00:34<00:04, 197.17it/s] 89%|█████████████████████████████████████████████████████████████        | 6617/7473 [00:34<00:04, 197.66it/s] 89%|█████████████████████████████████████████████████████████████▎       | 6637/7473 [00:34<00:04, 197.37it/s] 89%|█████████████████████████████████████████████████████████████▍       | 6657/7473 [00:34<00:04, 197.74it/s] 89%|█████████████████████████████████████████████████████████████▋       | 6677/7473 [00:34<00:04, 197.68it/s] 90%|█████████████████████████████████████████████████████████████▊       | 6698/7473 [00:34<00:03, 198.41it/s] 90%|██████████████████████████████████████████████████████████████       | 6718/7473 [00:35<00:03, 198.17it/s] 90%|██████████████████████████████████████████████████████████████▏      | 6738/7473 [00:35<00:03, 197.71it/s] 90%|██████████████████████████████████████████████████████████████▍      | 6758/7473 [00:35<00:03, 196.80it/s] 91%|██████████████████████████████████████████████████████████████▌      | 6778/7473 [00:35<00:03, 197.06it/s] 91%|██████████████████████████████████████████████████████████████▊      | 6798/7473 [00:35<00:03, 197.51it/s] 91%|██████████████████████████████████████████████████████████████▉      | 6818/7473 [00:35<00:03, 196.01it/s] 92%|███████████████████████████████████████████████████████████████▏     | 6838/7473 [00:35<00:03, 196.63it/s] 92%|███████████████████████████████████████████████████████████████▎     | 6858/7473 [00:35<00:03, 196.78it/s] 92%|███████████████████████████████████████████████████████████████▌     | 6879/7473 [00:35<00:03, 197.79it/s] 92%|███████████████████████████████████████████████████████████████▋     | 6899/7473 [00:35<00:02, 197.97it/s] 93%|███████████████████████████████████████████████████████████████▉     | 6919/7473 [00:36<00:02, 198.30it/s] 93%|████████████████████████████████████████████████████████████████     | 6939/7473 [00:36<00:02, 198.66it/s] 93%|████████████████████████████████████████████████████████████████▎    | 6959/7473 [00:36<00:02, 197.97it/s] 93%|████████████████████████████████████████████████████████████████▍    | 6979/7473 [00:36<00:02, 198.04it/s] 94%|████████████████████████████████████████████████████████████████▌    | 6999/7473 [00:36<00:02, 197.80it/s] 94%|████████████████████████████████████████████████████████████████▊    | 7019/7473 [00:36<00:02, 198.06it/s] 94%|████████████████████████████████████████████████████████████████▉    | 7039/7473 [00:36<00:02, 196.53it/s] 94%|█████████████████████████████████████████████████████████████████▏   | 7059/7473 [00:36<00:02, 196.43it/s] 95%|█████████████████████████████████████████████████████████████████▎   | 7079/7473 [00:36<00:02, 196.98it/s] 95%|█████████████████████████████████████████████████████████████████▌   | 7099/7473 [00:37<00:01, 197.80it/s] 95%|█████████████████████████████████████████████████████████████████▋   | 7119/7473 [00:37<00:01, 197.93it/s] 96%|█████████████████████████████████████████████████████████████████▉   | 7139/7473 [00:37<00:01, 197.74it/s] 96%|██████████████████████████████████████████████████████████████████   | 7159/7473 [00:37<00:01, 196.50it/s] 96%|██████████████████████████████████████████████████████████████████▎  | 7179/7473 [00:37<00:01, 195.91it/s] 96%|██████████████████████████████████████████████████████████████████▍  | 7199/7473 [00:37<00:01, 196.87it/s] 97%|██████████████████████████████████████████████████████████████████▋  | 7219/7473 [00:37<00:01, 197.13it/s] 97%|██████████████████████████████████████████████████████████████████▊  | 7239/7473 [00:37<00:01, 197.97it/s] 97%|███████████████████████████████████████████████████████████████████  | 7259/7473 [00:37<00:01, 197.79it/s] 97%|███████████████████████████████████████████████████████████████████▏ | 7279/7473 [00:37<00:00, 196.66it/s] 98%|███████████████████████████████████████████████████████████████████▍ | 7299/7473 [00:38<00:00, 197.19it/s] 98%|███████████████████████████████████████████████████████████████████▌ | 7319/7473 [00:38<00:00, 197.47it/s] 98%|███████████████████████████████████████████████████████████████████▊ | 7339/7473 [00:38<00:00, 197.81it/s] 98%|███████████████████████████████████████████████████████████████████▉ | 7359/7473 [00:38<00:00, 198.14it/s] 99%|████████████████████████████████████████████████████████████████████▏| 7379/7473 [00:38<00:00, 197.09it/s] 99%|████████████████████████████████████████████████████████████████████▎| 7399/7473 [00:38<00:00, 197.68it/s] 99%|████████████████████████████████████████████████████████████████████▌| 7419/7473 [00:38<00:00, 197.87it/s]100%|████████████████████████████████████████████████████████████████████▋| 7439/7473 [00:38<00:00, 198.29it/s]100%|████████████████████████████████████████████████████████████████████▊| 7459/7473 [00:38<00:00, 198.13it/s]100%|█████████████████████████████████████████████████████████████████████| 7473/7473 [00:38<00:00, 192.13it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                         | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                         | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                         | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                         | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|████████████████▎                                | 1/3 [00:04<00:09,  4.87s/it]Loading checkpoint shards:  33%|████████████████▎                                | 1/3 [00:05<00:10,  5.42s/it]Loading checkpoint shards:  33%|████████████████▎                                | 1/3 [00:05<00:10,  5.40s/it]Loading checkpoint shards:  33%|████████████████▎                                | 1/3 [00:05<00:10,  5.36s/it]Loading checkpoint shards:  67%|████████████████████████████████▋                | 2/3 [00:09<00:04,  4.88s/it]Loading checkpoint shards:  67%|████████████████████████████████▋                | 2/3 [00:10<00:05,  5.20s/it]Loading checkpoint shards:  67%|████████████████████████████████▋                | 2/3 [00:10<00:05,  5.18s/it]Loading checkpoint shards:  67%|████████████████████████████████▋                | 2/3 [00:11<00:06,  6.04s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.33s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.48s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.56s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.75s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.57s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.76s/it]
[2023-08-16 02:13:22,826] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.15s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.33s/it]
[2023-08-16 02:13:36,400] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-16 02:13:36,402] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-16 02:13:36,402] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-16 02:13:36,402] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-16 02:13:36,402] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-16 02:13:36,402] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-16 02:13:36,403] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-16 02:13:36,403] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-16 02:13:36,403] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-16 02:13:36,403] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-16 02:13:36,403] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-16 02:13:36,403] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7efc792b0fd0>
[2023-08-16 02:13:36,403] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-16 02:13:36,403] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-16 02:13:36,403] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-16 02:13:36,403] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-16 02:13:36,403] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-16 02:13:36,403] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-16 02:13:36,403] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-16 02:13:36,403] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-16 02:13:36,403] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-16 02:13:36,403] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-16 02:13:36,403] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-16 02:13:36,403] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-16 02:13:36,403] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-16 02:13:36,403] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-16 02:13:36,403] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-16 02:13:36,403] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-16 02:13:36,403] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-16 02:13:36,403] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-16 02:13:36,403] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-16 02:13:36,403] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-16 02:13:36,403] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-16 02:13:36,403] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-16 02:13:36,403] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-16 02:13:36,404] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-16 02:13:36,404] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-16 02:13:36,404] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-16 02:13:36,404] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-16 02:13:36,404] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-16 02:13:36,404] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-16 02:13:36,404] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-16 02:13:36,404] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-16 02:13:36,404] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-16 02:13:36,404] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7efc792b0be0>
[2023-08-16 02:13:36,404] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-16 02:13:36,404] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-16 02:13:36,404] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-16 02:13:36,404] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-16 02:13:36,404] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-16 02:13:36,404] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-16 02:13:36,404] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-16 02:13:36,404] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-16 02:13:36,404] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-16 02:13:36,404] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-16 02:13:36,404] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-16 02:13:36,404] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-16 02:13:36,404] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-16 02:13:36,404] [INFO] [config.py:1012:print]   train_batch_size ............. 8
[2023-08-16 02:13:36,404] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  2
[2023-08-16 02:13:36,404] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-16 02:13:36,404] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-16 02:13:36,404] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-16 02:13:36,404] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-16 02:13:36,404] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-16 02:13:36,404] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-16 02:13:36,404] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-16 02:13:36,405] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.6171233654022217 seconds
Loading extension module utils...
Time to load utils op: 0.4045891761779785 seconds
Loading extension module utils...
Time to load utils op: 0.6050496101379395 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating gsm8k :   0%|                                                               | 0/125 [00:00<?, ?it/s]############### Example ###############
Loading extension module utils...
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following grade math question.

### Demonstration:
Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Rationales: 1. The question is asking to identify a location that has plumbing but will not be of use when thirsty.
2. So, it would help to consider what kind of liquid might be flowing through the plumbing in each option.
3. In the "own home" and "water fountain," it is likely to find potable water, which would be of use when thirsty.
4. The "wall" might contain pipes that carry water, so this option could potentially be of use when thirsty.
5. "Show" is a bit vague, but if it refers to a show or event, there might be water facilities available too. 
6. However, in "oil refineries," the plumbing does not transport water at all, but is used for the refining of oil. This would not be useful if you were thirsty, as you cannot drink oil.
7. Hence the answer is A: oil refineries.
Answer: A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Rationales: 1. This question asks about what a person "isn't doing yet" when they are "beginning work".
2. This phrase implies that the person has only just begun their work and therefore can not have done certain things yet.
3. Let's analyze the options:
- A: working. Now, this is not the answer because the person has already begun their work, which means they are currently working.
- B: resting. This answer might make sense, because when a person starts working, they are not resting. But this does not usually imply an accomplishment.
- C: tiredness. This answer might not be correct because while it's true that when a person starts working, they are not typically tired, it doesn't exactly imply something they haven't done yet.
- E: momentum. This is not necessarily accurate because while it's true that someone might not yet have momentum when starting, it doesn't speak to an action or something they haven't done yet.
4. On the other hand, D: accomplishing definitely can be something the person hasn't done yet since they have just begun their work, the accomplishment would come after the work is completed.
5. Therefore, the correct answer is D: accomplishing.
Answer: D: accomplishing

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Rationales: 1. Pens with a company logo are usually items that are used for promotional purposes.
2. Companies often use these pens at their offices for staff members.
3. Staff members can also give these pens to visitors or clients, so they are often found in workplaces or business events.
4. While pens can indeed be found in places like school or a backpack, pens specifically with a company logo are not typically associated with these places.
5. Therefore, the most logical location to find pens with a company logo is an office. Hence, the answer is A: office.
Answer: A: office

Input: Billy called out to John, and listened for what? Choices:  A: silence B: response C: communication D: hanging up E: whisper
Rationales: 1. The question is asking what Billy is waiting to hear after he has called out to John. 
2. We look at each of the provided options and consider them in relation to the situation described:
   A: Silence would not be expected after somebody calls out to another person.
   C: Communication is too broad a term and does not denote a specific reaction from John.
   D: Hanging up would not apply since the scenario does not involve a phone call.
   E: Whisper is too specific, the scenario implies that Billy is waiting for an audible and clear answer not a whisper.
3. Hence, we look at B: Response. A response is precisely what a person would expect after they call out to someone; they are waiting for that person to respond.
4. Therefore, the most logical answer to the question is B: Response.
Answer: B: response

Input: The lizard frightened the hiker, it's movements made what rustle? Choices:  A: garden B: trees C: books D: rocks E: bushes
Rationales: 1. The question asks us what rustled due to the lizard's movement when it frightened the hiker.
2. Let's analyze the options one by one. 
3. Option A: A garden might rustle, but it generally refers to an area with a variety of plants and wouldn’t collectively rustle by the movement of a small creature like a lizard.
4. Option B: Trees are too large to rustle due to a lizard's movements.
5. Option C: Books can rustle, but it's unlikely in this context since hikers wouldn't typically encounter books on a trail.
6. Option D: Rocks don’t rustle at all, they are hard and would not create a rustling sound due to a small creature's movement.
7. Option E: Bushes are smaller plants, often found along hiking trails, and could rustle due to a small creature's movement.
8. By a process of elimination and logical analysis, the answer is E: bushes.
Answer: E: bushes

Input: The man spent big money and time maintaining his lawn, it was part of keeping up with the Joneses where? Choices:  A: front yard B: suburbia C: neighborhood D: back yard E: golf course
Rationales: 1. The phrase "keeping up with the Joneses" refers to a situation where a person tries to match their neighbors' social and economic status by emulating their lifestyle and consumer behavior. 
2. The notion of 'keeping up with the Joneses' is usually associated with suburban life or lifestyle, where maintaining lawns and houses is considered as status symbols.
3. While other options such as front yard, neighborhood, back yard, and golf course all can be places where a well-maintained lawn could exist, none of them are as tightly correlated with the context of 'keeping up with the Joneses' as the suburbia, which encapsulates an entire lifestyle and social context.
4. Therefore, taking the whole context into consideration, the most appropropriate and encompassing answer is B: suburbia.
Answer: B: suburbia

Input: What would a human do if they want to get to a store that he or she can see? Choices:  A: cross road B: see around C: drink coffee D: dream dreams E: think critically
Rationales: 1. The question is asking for the action a human would most likely take if they want to get to a store that they can see.
2. To answer, we should think about the most straightforward or necessary act for someone who can see a store and wishes to reach it.
3. Let's look at the options: "cross the road," "see around," "drink coffee," "dream dreams," "think critically."
4. "Drink coffee," "dream dreams," and "think critically" aren't directly related to the act of reaching a visible destination. They could be actions one might take, but they aren't necessary or related to the process of getting to a visually spotted location. Thus, we can eliminate these choices.
5. "See around" could be a potential answer as someone might need to see around to get to a certain place, but it is not the most direct or clear action required in reaching a visible store. So we can remove this as well.
6. That leaves us with the option "cross the road." This is the most plausible answer because when a human sees a store and desires to reach it, one essential action might be to cross a road if the store is situated on the other side of the road. Hence, this is the answer.
7. So, the answer is A: cross the road.
Answer: A: cross road

### Input:Natalia sold clips to 48 of her friends in April, and then she sold half as many clips in May. How many clips did Natalia sell altogether in April and May?

### Response:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o7-tcommonsenseqa-s1-rTrue-m4096
Time to load utils op: 0.6047158241271973 seconds
Evaluating gsm8k :   1%|▍                                                    | 1/125 [00:44<1:31:23, 44.22s/it]Evaluating gsm8k :   2%|▊                                                    | 2/125 [01:07<1:05:54, 32.15s/it]Evaluating gsm8k :   2%|█▎                                                   | 3/125 [01:51<1:15:32, 37.15s/it]Evaluating gsm8k :   3%|█▋                                                   | 4/125 [02:33<1:19:32, 39.44s/it]Evaluating gsm8k :   4%|██                                                   | 5/125 [03:11<1:17:10, 38.59s/it]Evaluating gsm8k :   5%|██▌                                                  | 6/125 [03:53<1:19:06, 39.89s/it]Evaluating gsm8k :   6%|██▉                                                  | 7/125 [04:36<1:20:43, 41.05s/it]Evaluating gsm8k :   6%|███▍                                                 | 8/125 [05:18<1:20:36, 41.34s/it]Evaluating gsm8k :   7%|███▊                                                 | 9/125 [05:58<1:18:39, 40.69s/it]Evaluating gsm8k :   8%|████▏                                               | 10/125 [06:40<1:19:08, 41.29s/it]Evaluating gsm8k :   9%|████▌                                               | 11/125 [07:21<1:18:09, 41.14s/it]Evaluating gsm8k :  10%|█████▏                                                | 12/125 [07:31<59:34, 31.64s/it]Evaluating gsm8k :  10%|█████▍                                              | 13/125 [08:13<1:05:13, 34.94s/it]Evaluating gsm8k :  11%|██████                                                | 14/125 [08:33<55:56, 30.24s/it]Evaluating gsm8k :  12%|██████▏                                             | 15/125 [09:16<1:02:30, 34.10s/it]Evaluating gsm8k :  13%|██████▋                                             | 16/125 [09:58<1:06:32, 36.63s/it]Evaluating gsm8k :  14%|███████▎                                              | 17/125 [10:20<57:44, 32.07s/it]Evaluating gsm8k :  14%|███████▍                                            | 18/125 [11:03<1:02:58, 35.31s/it]Evaluating gsm8k :  15%|███████▉                                            | 19/125 [11:45<1:05:54, 37.31s/it]Evaluating gsm8k :  16%|████████▎                                           | 20/125 [12:28<1:08:15, 39.00s/it]Evaluating gsm8k :  17%|█████████                                             | 21/125 [12:37<52:15, 30.15s/it]Evaluating gsm8k :  18%|█████████▌                                            | 22/125 [13:16<56:23, 32.85s/it]Evaluating gsm8k :  18%|█████████▌                                          | 23/125 [13:59<1:00:56, 35.84s/it]Evaluating gsm8k :  19%|█████████▉                                          | 24/125 [14:41<1:03:31, 37.74s/it]Evaluating gsm8k :  20%|██████████▍                                         | 25/125 [15:25<1:05:39, 39.39s/it]Evaluating gsm8k :  21%|██████████▊                                         | 26/125 [16:08<1:07:04, 40.65s/it]Evaluating gsm8k :  22%|███████████▋                                          | 27/125 [16:28<56:02, 34.31s/it]Evaluating gsm8k :  22%|████████████                                          | 28/125 [17:10<59:27, 36.78s/it]Evaluating gsm8k :  23%|████████████                                        | 29/125 [17:53<1:01:45, 38.60s/it]Evaluating gsm8k :  24%|████████████▍                                       | 30/125 [18:36<1:02:56, 39.75s/it]Evaluating gsm8k :  25%|████████████▉                                       | 31/125 [19:19<1:04:01, 40.87s/it]Evaluating gsm8k :  26%|█████████████▎                                      | 32/125 [20:02<1:04:11, 41.41s/it]Evaluating gsm8k :  26%|█████████████▋                                      | 33/125 [20:43<1:03:29, 41.41s/it]Evaluating gsm8k :  27%|██████████████▏                                     | 34/125 [21:26<1:03:26, 41.83s/it]Evaluating gsm8k :  28%|██████████████▌                                     | 35/125 [22:07<1:02:28, 41.65s/it]Evaluating gsm8k :  29%|███████████████▌                                      | 36/125 [22:34<55:20, 37.31s/it]Evaluating gsm8k :  30%|███████████████▉                                      | 37/125 [23:17<56:57, 38.84s/it]Evaluating gsm8k :  30%|████████████████▍                                     | 38/125 [23:45<51:47, 35.72s/it]Evaluating gsm8k :  31%|████████████████▊                                     | 39/125 [24:27<53:54, 37.61s/it]Evaluating gsm8k :  32%|█████████████████▎                                    | 40/125 [25:10<55:34, 39.22s/it]Evaluating gsm8k :  33%|█████████████████▋                                    | 41/125 [25:43<52:27, 37.47s/it]Evaluating gsm8k :  34%|██████████████████▏                                   | 42/125 [26:26<53:54, 38.97s/it]Evaluating gsm8k :  34%|██████████████████▌                                   | 43/125 [27:09<55:04, 40.29s/it]Evaluating gsm8k :  35%|███████████████████                                   | 44/125 [27:52<55:14, 40.92s/it]Evaluating gsm8k :  36%|███████████████████▍                                  | 45/125 [28:34<55:11, 41.40s/it]Evaluating gsm8k :  37%|███████████████████▊                                  | 46/125 [29:17<54:57, 41.74s/it]Evaluating gsm8k :  38%|████████████████████▎                                 | 47/125 [29:59<54:29, 41.92s/it]Evaluating gsm8k :  38%|████████████████████▋                                 | 48/125 [30:42<54:01, 42.10s/it]Evaluating gsm8k :  39%|█████████████████████▏                                | 49/125 [31:24<53:29, 42.23s/it]Evaluating gsm8k :  40%|█████████████████████▌                                | 50/125 [31:39<42:26, 33.96s/it]Evaluating gsm8k :  41%|██████████████████████                                | 51/125 [32:22<45:17, 36.72s/it]Evaluating gsm8k :  42%|██████████████████████▍                               | 52/125 [32:55<43:25, 35.69s/it]Evaluating gsm8k :  42%|██████████████████████▉                               | 53/125 [33:38<45:20, 37.78s/it]Evaluating gsm8k :  43%|███████████████████████▎                              | 54/125 [34:21<46:27, 39.26s/it]Evaluating gsm8k :  44%|███████████████████████▊                              | 55/125 [35:04<47:10, 40.44s/it]Evaluating gsm8k :  45%|████████████████████████▏                             | 56/125 [35:28<40:51, 35.53s/it]Evaluating gsm8k :  46%|████████████████████████▌                             | 57/125 [36:11<42:43, 37.70s/it]Evaluating gsm8k :  46%|█████████████████████████                             | 58/125 [36:53<43:35, 39.04s/it]Evaluating gsm8k :  47%|█████████████████████████▍                            | 59/125 [37:35<44:05, 40.08s/it]Evaluating gsm8k :  48%|█████████████████████████▉                            | 60/125 [38:18<44:16, 40.87s/it]Evaluating gsm8k :  49%|██████████████████████████▎                           | 61/125 [39:01<44:09, 41.40s/it]Evaluating gsm8k :  50%|██████████████████████████▊                           | 62/125 [39:43<43:41, 41.62s/it]Evaluating gsm8k :  50%|███████████████████████████▏                          | 63/125 [40:25<43:14, 41.84s/it]Evaluating gsm8k :  51%|███████████████████████████▋                          | 64/125 [41:08<42:41, 42.00s/it]Evaluating gsm8k :  52%|████████████████████████████                          | 65/125 [41:51<42:19, 42.32s/it]Evaluating gsm8k :  53%|████████████████████████████▌                         | 66/125 [42:26<39:34, 40.25s/it]Evaluating gsm8k :  54%|████████████████████████████▉                         | 67/125 [43:08<39:30, 40.86s/it]Evaluating gsm8k :  54%|█████████████████████████████▍                        | 68/125 [43:37<35:25, 37.30s/it]Evaluating gsm8k :  55%|█████████████████████████████▊                        | 69/125 [43:59<30:31, 32.70s/it]Evaluating gsm8k :  56%|██████████████████████████████▏                       | 70/125 [44:42<32:36, 35.58s/it]Evaluating gsm8k :  57%|██████████████████████████████▋                       | 71/125 [45:24<33:54, 37.68s/it]Evaluating gsm8k :  58%|███████████████████████████████                       | 72/125 [45:55<31:20, 35.49s/it]Evaluating gsm8k :  58%|███████████████████████████████▌                      | 73/125 [46:38<32:53, 37.96s/it]Evaluating gsm8k :  59%|███████████████████████████████▉                      | 74/125 [47:20<33:19, 39.21s/it]Evaluating gsm8k :  60%|████████████████████████████████▍                     | 75/125 [48:03<33:27, 40.14s/it]Evaluating gsm8k :  61%|████████████████████████████████▊                     | 76/125 [48:45<33:13, 40.69s/it]Evaluating gsm8k :  62%|█████████████████████████████████▎                    | 77/125 [49:07<28:07, 35.16s/it]Evaluating gsm8k :  62%|█████████████████████████████████▋                    | 78/125 [49:50<29:21, 37.47s/it]Evaluating gsm8k :  63%|██████████████████████████████████▏                   | 79/125 [50:07<24:07, 31.46s/it]Evaluating gsm8k :  64%|██████████████████████████████████▌                   | 80/125 [50:49<25:55, 34.58s/it]Evaluating gsm8k :  65%|██████████████████████████████████▉                   | 81/125 [51:14<23:10, 31.61s/it]Evaluating gsm8k :  66%|███████████████████████████████████▍                  | 82/125 [51:57<25:04, 34.99s/it]Evaluating gsm8k :  66%|███████████████████████████████████▊                  | 83/125 [52:39<26:01, 37.17s/it]Evaluating gsm8k :  67%|████████████████████████████████████▎                 | 84/125 [53:10<24:12, 35.43s/it]Evaluating gsm8k :  68%|████████████████████████████████████▋                 | 85/125 [53:53<25:00, 37.51s/it]Evaluating gsm8k :  69%|█████████████████████████████████████▏                | 86/125 [54:29<24:11, 37.23s/it]Evaluating gsm8k :  70%|█████████████████████████████████████▌                | 87/125 [55:12<24:32, 38.75s/it]Evaluating gsm8k :  70%|██████████████████████████████████████                | 88/125 [55:54<24:33, 39.83s/it]Evaluating gsm8k :  71%|██████████████████████████████████████▍               | 89/125 [56:36<24:16, 40.46s/it]Evaluating gsm8k :  72%|██████████████████████████████████████▉               | 90/125 [57:10<22:27, 38.49s/it]Evaluating gsm8k :  73%|███████████████████████████████████████▎              | 91/125 [57:52<22:25, 39.58s/it]Evaluating gsm8k :  74%|███████████████████████████████████████▋              | 92/125 [58:24<20:32, 37.34s/it]Evaluating gsm8k :  74%|████████████████████████████████████████▏             | 93/125 [59:07<20:45, 38.93s/it]Evaluating gsm8k :  75%|████████████████████████████████████████▌             | 94/125 [59:49<20:40, 40.01s/it]Evaluating gsm8k :  76%|███████████████████████████████████████▌            | 95/125 [1:00:32<20:24, 40.82s/it]Evaluating gsm8k :  77%|███████████████████████████████████████▉            | 96/125 [1:01:14<19:55, 41.23s/it]Evaluating gsm8k :  78%|████████████████████████████████████████▎           | 97/125 [1:01:46<17:58, 38.52s/it]Evaluating gsm8k :  78%|████████████████████████████████████████▊           | 98/125 [1:02:29<17:56, 39.88s/it]Evaluating gsm8k :  79%|█████████████████████████████████████████▏          | 99/125 [1:03:12<17:37, 40.67s/it]Evaluating gsm8k :  80%|████████████████████████████████████████▊          | 100/125 [1:03:44<15:54, 38.19s/it]Evaluating gsm8k :  81%|█████████████████████████████████████████▏         | 101/125 [1:04:26<15:45, 39.41s/it]Evaluating gsm8k :  82%|█████████████████████████████████████████▌         | 102/125 [1:05:09<15:26, 40.28s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████         | 103/125 [1:05:23<11:55, 32.54s/it]Evaluating gsm8k :  83%|██████████████████████████████████████████▍        | 104/125 [1:06:07<12:32, 35.81s/it]Evaluating gsm8k :  84%|██████████████████████████████████████████▊        | 105/125 [1:06:49<12:36, 37.84s/it]Evaluating gsm8k :  85%|███████████████████████████████████████████▏       | 106/125 [1:07:32<12:28, 39.38s/it]Evaluating gsm8k :  86%|███████████████████████████████████████████▋       | 107/125 [1:08:14<12:04, 40.25s/it]Evaluating gsm8k :  86%|████████████████████████████████████████████       | 108/125 [1:08:57<11:35, 40.89s/it]Evaluating gsm8k :  87%|████████████████████████████████████████████▍      | 109/125 [1:09:11<08:44, 32.79s/it]Evaluating gsm8k :  88%|████████████████████████████████████████████▉      | 110/125 [1:09:31<07:15, 29.02s/it]Evaluating gsm8k :  89%|█████████████████████████████████████████████▎     | 111/125 [1:10:13<07:42, 33.01s/it]Evaluating gsm8k :  90%|█████████████████████████████████████████████▋     | 112/125 [1:10:56<07:46, 35.89s/it]Evaluating gsm8k :  90%|██████████████████████████████████████████████     | 113/125 [1:11:38<07:32, 37.71s/it]Evaluating gsm8k :  91%|██████████████████████████████████████████████▌    | 114/125 [1:12:21<07:11, 39.25s/it]Evaluating gsm8k :  92%|██████████████████████████████████████████████▉    | 115/125 [1:13:03<06:41, 40.17s/it]Evaluating gsm8k :  93%|███████████████████████████████████████████████▎   | 116/125 [1:13:45<06:07, 40.84s/it]Evaluating gsm8k :  94%|███████████████████████████████████████████████▋   | 117/125 [1:14:22<05:16, 39.61s/it]Evaluating gsm8k :  94%|████████████████████████████████████████████████▏  | 118/125 [1:15:04<04:42, 40.34s/it]Evaluating gsm8k :  95%|████████████████████████████████████████████████▌  | 119/125 [1:15:39<03:52, 38.76s/it]Evaluating gsm8k :  96%|████████████████████████████████████████████████▉  | 120/125 [1:16:22<03:20, 40.08s/it]Evaluating gsm8k :  97%|█████████████████████████████████████████████████▎ | 121/125 [1:17:04<02:42, 40.67s/it]Evaluating gsm8k :  98%|█████████████████████████████████████████████████▊ | 122/125 [1:17:47<02:04, 41.35s/it]Evaluating gsm8k :  98%|██████████████████████████████████████████████████▏| 123/125 [1:18:30<01:23, 41.69s/it]Evaluating gsm8k :  99%|██████████████████████████████████████████████████▌| 124/125 [1:19:13<00:42, 42.13s/it]Evaluating gsm8k : 100%|███████████████████████████████████████████████████| 125/125 [1:19:55<00:00, 42.17s/it]Evaluating gsm8k : 100%|███████████████████████████████████████████████████| 125/125 [1:19:55<00:00, 38.37s/it]
name: gsm8k | {'exact_match': 0.0, 'rougeL': 0.2815} | lm_loss 10.0844 | avg. gen lenth: 365.34
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name gsm8k --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name commonsenseqa --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --max-prompt-length 4096 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 2 --data-dir /scratch/ylu130/processed_data/gsm8k/out-domain/o8-tcommonsenseqa-s1-rTrue --seed 1 --rationales --num-out-domain 8
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-16 03:36:53,541] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... gsm8k
  data_dir ..................... /scratch/ylu130/processed_data/gsm8k/out-domain/o8-tcommonsenseqa-s1-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 8
  out_domain_data_name ......... commonsenseqa
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 4096
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o8-tcommonsenseqa-s1-rTrue-m4096
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 2
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                 | 0/7473 [00:00<?, ?it/s]  0%|                                                                       | 12/7473 [00:00<01:05, 113.47it/s]  0%|▏                                                                      | 24/7473 [00:00<01:05, 114.15it/s]  0%|▎                                                                      | 36/7473 [00:00<01:05, 114.11it/s]  1%|▍                                                                      | 48/7473 [00:00<01:04, 114.38it/s]  1%|▌                                                                      | 60/7473 [00:00<01:04, 114.42it/s]  1%|▋                                                                      | 72/7473 [00:00<01:05, 112.54it/s]  1%|▊                                                                      | 84/7473 [00:00<01:05, 113.28it/s]  1%|▉                                                                      | 96/7473 [00:00<01:04, 113.89it/s]  1%|█                                                                     | 108/7473 [00:00<01:04, 114.04it/s]  2%|█                                                                     | 120/7473 [00:01<01:04, 114.30it/s]  2%|█▏                                                                    | 132/7473 [00:01<01:04, 114.43it/s]  2%|█▎                                                                    | 144/7473 [00:01<01:04, 114.51it/s]  2%|█▍                                                                    | 156/7473 [00:01<01:03, 114.70it/s]  2%|█▌                                                                    | 168/7473 [00:01<01:03, 114.65it/s]  2%|█▋                                                                    | 180/7473 [00:01<01:03, 114.81it/s]  3%|█▊                                                                    | 192/7473 [00:01<01:04, 113.65it/s]  3%|█▉                                                                    | 204/7473 [00:01<01:03, 113.90it/s]  3%|██                                                                    | 216/7473 [00:01<01:03, 114.32it/s]  3%|██▏                                                                   | 228/7473 [00:01<01:03, 114.44it/s]  3%|██▎                                                                   | 244/7473 [00:02<00:56, 127.21it/s]  3%|██▍                                                                   | 261/7473 [00:02<00:51, 138.93it/s]  4%|██▌                                                                   | 279/7473 [00:02<00:48, 149.63it/s]  4%|██▊                                                                   | 297/7473 [00:02<00:45, 157.60it/s]  4%|██▉                                                                   | 315/7473 [00:02<00:43, 163.05it/s]  4%|███                                                                   | 333/7473 [00:02<00:42, 166.92it/s]  5%|███▎                                                                  | 351/7473 [00:02<00:42, 169.52it/s]  5%|███▍                                                                  | 369/7473 [00:02<00:41, 171.28it/s]  5%|███▋                                                                  | 387/7473 [00:02<00:41, 172.64it/s]  5%|███▊                                                                  | 405/7473 [00:03<00:40, 173.06it/s]  6%|███▉                                                                  | 423/7473 [00:03<00:40, 173.63it/s]  6%|████▏                                                                 | 441/7473 [00:03<00:40, 174.10it/s]  6%|████▎                                                                 | 459/7473 [00:03<00:40, 174.34it/s]  6%|████▍                                                                 | 477/7473 [00:03<00:40, 172.91it/s]  7%|████▋                                                                 | 495/7473 [00:03<00:40, 173.77it/s]  7%|████▊                                                                 | 513/7473 [00:03<00:39, 174.35it/s]  7%|████▉                                                                 | 531/7473 [00:03<00:39, 174.98it/s]  7%|█████▏                                                                | 549/7473 [00:03<00:39, 175.28it/s]  8%|█████▎                                                                | 567/7473 [00:03<00:39, 175.50it/s]  8%|█████▍                                                                | 585/7473 [00:04<00:39, 175.29it/s]  8%|█████▋                                                                | 603/7473 [00:04<00:39, 175.07it/s]  8%|█████▊                                                                | 621/7473 [00:04<00:39, 173.66it/s]  9%|█████▉                                                                | 639/7473 [00:04<00:39, 174.31it/s]  9%|██████▏                                                               | 657/7473 [00:04<00:39, 174.70it/s]  9%|██████▎                                                               | 675/7473 [00:04<00:38, 175.23it/s]  9%|██████▍                                                               | 693/7473 [00:04<00:38, 175.37it/s] 10%|██████▋                                                               | 711/7473 [00:04<00:38, 174.02it/s] 10%|██████▊                                                               | 729/7473 [00:04<00:38, 174.91it/s] 10%|██████▉                                                               | 747/7473 [00:04<00:38, 175.27it/s] 10%|███████▏                                                              | 765/7473 [00:05<00:38, 175.41it/s] 10%|███████▎                                                              | 783/7473 [00:05<00:38, 175.29it/s] 11%|███████▌                                                              | 801/7473 [00:05<00:38, 175.37it/s] 11%|███████▋                                                              | 819/7473 [00:05<00:37, 175.19it/s] 11%|███████▊                                                              | 837/7473 [00:05<00:37, 175.45it/s] 11%|████████                                                              | 855/7473 [00:05<00:38, 173.84it/s] 12%|████████▏                                                             | 873/7473 [00:05<00:37, 174.36it/s] 12%|████████▎                                                             | 891/7473 [00:05<00:37, 174.86it/s] 12%|████████▌                                                             | 909/7473 [00:05<00:37, 175.01it/s] 12%|████████▋                                                             | 927/7473 [00:06<00:37, 174.90it/s] 13%|████████▊                                                             | 945/7473 [00:06<00:37, 173.50it/s] 13%|█████████                                                             | 963/7473 [00:06<00:37, 173.23it/s] 13%|█████████▏                                                            | 981/7473 [00:06<00:37, 173.08it/s] 13%|█████████▎                                                            | 999/7473 [00:06<00:37, 172.13it/s] 14%|█████████▍                                                           | 1017/7473 [00:06<00:37, 173.35it/s] 14%|█████████▌                                                           | 1035/7473 [00:06<00:37, 173.86it/s] 14%|█████████▋                                                           | 1053/7473 [00:06<00:36, 174.60it/s] 14%|█████████▉                                                           | 1071/7473 [00:06<00:36, 175.18it/s] 15%|██████████                                                           | 1089/7473 [00:06<00:36, 173.47it/s] 15%|██████████▏                                                          | 1107/7473 [00:07<00:36, 173.82it/s] 15%|██████████▍                                                          | 1125/7473 [00:07<00:36, 174.36it/s] 15%|██████████▌                                                          | 1143/7473 [00:07<00:36, 174.35it/s] 16%|██████████▋                                                          | 1161/7473 [00:07<00:36, 170.89it/s] 16%|██████████▉                                                          | 1179/7473 [00:07<00:36, 172.09it/s] 16%|███████████                                                          | 1197/7473 [00:07<00:36, 173.04it/s] 16%|███████████▏                                                         | 1215/7473 [00:07<00:36, 173.64it/s] 16%|███████████▍                                                         | 1233/7473 [00:07<00:35, 173.98it/s] 17%|███████████▌                                                         | 1251/7473 [00:07<00:35, 174.44it/s] 17%|███████████▋                                                         | 1269/7473 [00:07<00:35, 174.77it/s] 17%|███████████▉                                                         | 1287/7473 [00:08<00:35, 175.00it/s] 17%|████████████                                                         | 1305/7473 [00:08<00:35, 174.96it/s] 18%|████████████▏                                                        | 1323/7473 [00:08<00:35, 175.11it/s] 18%|████████████▍                                                        | 1341/7473 [00:08<00:35, 174.96it/s] 18%|████████████▌                                                        | 1359/7473 [00:08<00:35, 173.95it/s] 18%|████████████▋                                                        | 1377/7473 [00:08<00:35, 172.85it/s] 19%|████████████▉                                                        | 1395/7473 [00:08<00:35, 171.41it/s] 19%|█████████████                                                        | 1413/7473 [00:08<00:35, 172.44it/s] 19%|█████████████▏                                                       | 1431/7473 [00:08<00:34, 173.20it/s] 19%|█████████████▍                                                       | 1449/7473 [00:09<00:34, 174.07it/s] 20%|█████████████▌                                                       | 1467/7473 [00:09<00:34, 174.44it/s] 20%|█████████████▋                                                       | 1485/7473 [00:09<00:34, 174.66it/s] 20%|█████████████▉                                                       | 1503/7473 [00:09<00:34, 174.99it/s] 20%|██████████████                                                       | 1521/7473 [00:09<00:33, 175.32it/s] 21%|██████████████▏                                                      | 1539/7473 [00:09<00:33, 175.32it/s] 21%|██████████████▍                                                      | 1557/7473 [00:09<00:33, 174.95it/s] 21%|██████████████▌                                                      | 1575/7473 [00:09<00:33, 174.71it/s] 21%|██████████████▋                                                      | 1593/7473 [00:09<00:33, 174.81it/s] 22%|██████████████▊                                                      | 1611/7473 [00:09<00:33, 173.32it/s] 22%|███████████████                                                      | 1629/7473 [00:10<00:33, 173.22it/s] 22%|███████████████▏                                                     | 1647/7473 [00:10<00:33, 174.10it/s] 22%|███████████████▎                                                     | 1665/7473 [00:10<00:33, 174.21it/s] 23%|███████████████▌                                                     | 1683/7473 [00:10<00:33, 174.44it/s] 23%|███████████████▋                                                     | 1701/7473 [00:10<00:33, 174.55it/s] 23%|███████████████▊                                                     | 1719/7473 [00:10<00:33, 174.10it/s] 23%|████████████████                                                     | 1737/7473 [00:10<00:32, 174.47it/s] 23%|████████████████▏                                                    | 1755/7473 [00:10<00:32, 174.81it/s] 24%|████████████████▎                                                    | 1773/7473 [00:10<00:32, 174.66it/s] 24%|████████████████▌                                                    | 1791/7473 [00:10<00:32, 174.57it/s] 24%|████████████████▋                                                    | 1809/7473 [00:11<00:32, 174.80it/s] 24%|████████████████▊                                                    | 1827/7473 [00:11<00:32, 174.53it/s] 25%|█████████████████                                                    | 1845/7473 [00:11<00:32, 172.98it/s] 25%|█████████████████▏                                                   | 1863/7473 [00:11<00:32, 173.55it/s] 25%|█████████████████▎                                                   | 1881/7473 [00:11<00:32, 174.15it/s] 25%|█████████████████▌                                                   | 1899/7473 [00:11<00:31, 174.40it/s] 26%|█████████████████▋                                                   | 1917/7473 [00:11<00:31, 174.22it/s] 26%|█████████████████▊                                                   | 1935/7473 [00:11<00:31, 174.70it/s] 26%|██████████████████                                                   | 1953/7473 [00:11<00:31, 175.50it/s] 26%|██████████████████▏                                                  | 1971/7473 [00:12<00:31, 175.98it/s] 27%|██████████████████▎                                                  | 1989/7473 [00:12<00:31, 176.26it/s] 27%|██████████████████▌                                                  | 2007/7473 [00:12<00:31, 176.14it/s] 27%|██████████████████▋                                                  | 2025/7473 [00:12<00:30, 176.53it/s] 27%|██████████████████▊                                                  | 2043/7473 [00:12<00:30, 176.27it/s] 28%|███████████████████                                                  | 2061/7473 [00:12<00:30, 176.53it/s] 28%|███████████████████▏                                                 | 2079/7473 [00:12<00:30, 174.72it/s] 28%|███████████████████▎                                                 | 2097/7473 [00:12<00:30, 175.56it/s] 28%|███████████████████▌                                                 | 2115/7473 [00:12<00:30, 175.55it/s] 29%|███████████████████▋                                                 | 2133/7473 [00:12<00:30, 175.54it/s] 29%|███████████████████▊                                                 | 2151/7473 [00:13<00:30, 176.16it/s] 29%|████████████████████                                                 | 2169/7473 [00:13<00:30, 176.46it/s] 29%|████████████████████▏                                                | 2187/7473 [00:13<00:29, 176.36it/s] 30%|████████████████████▎                                                | 2205/7473 [00:13<00:29, 176.67it/s] 30%|████████████████████▌                                                | 2223/7473 [00:13<00:29, 176.98it/s] 30%|████████████████████▋                                                | 2241/7473 [00:13<00:29, 176.78it/s] 30%|████████████████████▊                                                | 2259/7473 [00:13<00:29, 176.65it/s] 30%|█████████████████████                                                | 2277/7473 [00:13<00:29, 176.53it/s] 31%|█████████████████████▏                                               | 2295/7473 [00:13<00:29, 174.95it/s] 31%|█████████████████████▎                                               | 2313/7473 [00:13<00:29, 174.96it/s] 31%|█████████████████████▌                                               | 2331/7473 [00:14<00:29, 175.24it/s] 31%|█████████████████████▋                                               | 2349/7473 [00:14<00:29, 175.42it/s] 32%|█████████████████████▊                                               | 2367/7473 [00:14<00:29, 175.85it/s] 32%|██████████████████████                                               | 2385/7473 [00:14<00:28, 175.81it/s] 32%|██████████████████████▏                                              | 2403/7473 [00:14<00:28, 176.22it/s] 32%|██████████████████████▎                                              | 2421/7473 [00:14<00:28, 176.46it/s] 33%|██████████████████████▌                                              | 2439/7473 [00:14<00:28, 176.79it/s] 33%|██████████████████████▋                                              | 2457/7473 [00:14<00:28, 176.89it/s] 33%|██████████████████████▊                                              | 2475/7473 [00:14<00:28, 176.69it/s] 33%|███████████████████████                                              | 2493/7473 [00:14<00:28, 176.46it/s] 34%|███████████████████████▏                                             | 2511/7473 [00:15<00:28, 176.70it/s] 34%|███████████████████████▎                                             | 2529/7473 [00:15<00:32, 153.28it/s] 34%|███████████████████████▌                                             | 2547/7473 [00:15<00:31, 158.60it/s] 34%|███████████████████████▋                                             | 2565/7473 [00:15<00:29, 163.65it/s] 35%|███████████████████████▊                                             | 2583/7473 [00:15<00:29, 167.65it/s] 35%|████████████████████████                                             | 2601/7473 [00:15<00:28, 170.10it/s] 35%|████████████████████████▏                                            | 2619/7473 [00:15<00:28, 172.11it/s] 35%|████████████████████████▎                                            | 2637/7473 [00:15<00:28, 172.27it/s] 36%|████████████████████████▌                                            | 2655/7473 [00:15<00:27, 173.78it/s] 36%|████████████████████████▋                                            | 2673/7473 [00:16<00:27, 174.58it/s] 36%|████████████████████████▊                                            | 2691/7473 [00:16<00:27, 175.33it/s] 36%|█████████████████████████                                            | 2709/7473 [00:16<00:27, 175.41it/s] 36%|█████████████████████████▏                                           | 2727/7473 [00:16<00:27, 174.01it/s] 37%|█████████████████████████▎                                           | 2745/7473 [00:16<00:27, 174.48it/s] 37%|█████████████████████████▌                                           | 2763/7473 [00:16<00:27, 173.43it/s] 37%|█████████████████████████▋                                           | 2781/7473 [00:16<00:26, 174.56it/s] 37%|█████████████████████████▊                                           | 2799/7473 [00:16<00:26, 175.23it/s] 38%|██████████████████████████                                           | 2817/7473 [00:16<00:26, 175.73it/s] 38%|██████████████████████████▏                                          | 2835/7473 [00:16<00:26, 176.08it/s] 38%|██████████████████████████▎                                          | 2853/7473 [00:17<00:26, 174.76it/s] 38%|██████████████████████████▌                                          | 2871/7473 [00:17<00:26, 175.30it/s] 39%|██████████████████████████▋                                          | 2889/7473 [00:17<00:26, 175.73it/s] 39%|██████████████████████████▊                                          | 2907/7473 [00:17<00:25, 176.31it/s] 39%|███████████████████████████                                          | 2925/7473 [00:17<00:25, 176.67it/s] 39%|███████████████████████████▏                                         | 2943/7473 [00:17<00:25, 176.93it/s] 40%|███████████████████████████▎                                         | 2961/7473 [00:17<00:25, 177.19it/s] 40%|███████████████████████████▌                                         | 2979/7473 [00:17<00:25, 175.29it/s] 40%|███████████████████████████▋                                         | 2997/7473 [00:17<00:25, 175.84it/s] 40%|███████████████████████████▊                                         | 3015/7473 [00:17<00:25, 175.83it/s] 41%|████████████████████████████                                         | 3033/7473 [00:18<00:25, 176.13it/s] 41%|████████████████████████████▏                                        | 3051/7473 [00:18<00:25, 176.29it/s] 41%|████████████████████████████▎                                        | 3069/7473 [00:18<00:24, 176.46it/s] 41%|████████████████████████████▌                                        | 3087/7473 [00:18<00:25, 171.60it/s] 42%|████████████████████████████▋                                        | 3105/7473 [00:18<00:25, 172.47it/s] 42%|████████████████████████████▊                                        | 3123/7473 [00:18<00:25, 173.40it/s] 42%|█████████████████████████████                                        | 3141/7473 [00:18<00:24, 174.10it/s] 42%|█████████████████████████████▏                                       | 3159/7473 [00:18<00:24, 173.24it/s] 43%|█████████████████████████████▎                                       | 3177/7473 [00:18<00:24, 174.42it/s] 43%|█████████████████████████████▌                                       | 3195/7473 [00:19<00:24, 174.96it/s] 43%|█████████████████████████████▋                                       | 3213/7473 [00:19<00:24, 173.98it/s] 43%|█████████████████████████████▊                                       | 3231/7473 [00:19<00:24, 173.78it/s] 43%|█████████████████████████████▉                                       | 3249/7473 [00:19<00:24, 174.51it/s] 44%|██████████████████████████████▏                                      | 3267/7473 [00:19<00:23, 175.35it/s] 44%|██████████████████████████████▎                                      | 3285/7473 [00:19<00:23, 176.02it/s] 44%|██████████████████████████████▍                                      | 3303/7473 [00:19<00:23, 176.29it/s] 44%|██████████████████████████████▋                                      | 3321/7473 [00:19<00:23, 176.40it/s] 45%|██████████████████████████████▊                                      | 3339/7473 [00:19<00:23, 175.94it/s] 45%|██████████████████████████████▉                                      | 3357/7473 [00:19<00:23, 176.20it/s] 45%|███████████████████████████████▏                                     | 3375/7473 [00:20<00:23, 176.26it/s] 45%|███████████████████████████████▎                                     | 3393/7473 [00:20<00:23, 176.21it/s] 46%|███████████████████████████████▍                                     | 3411/7473 [00:20<00:23, 176.51it/s] 46%|███████████████████████████████▋                                     | 3429/7473 [00:20<00:23, 174.73it/s] 46%|███████████████████████████████▊                                     | 3447/7473 [00:20<00:23, 173.27it/s] 46%|███████████████████████████████▉                                     | 3465/7473 [00:20<00:23, 174.02it/s] 47%|████████████████████████████████▏                                    | 3483/7473 [00:20<00:22, 174.89it/s] 47%|████████████████████████████████▎                                    | 3501/7473 [00:20<00:22, 175.66it/s] 47%|████████████████████████████████▍                                    | 3519/7473 [00:20<00:22, 175.83it/s] 47%|████████████████████████████████▋                                    | 3537/7473 [00:20<00:22, 176.15it/s] 48%|████████████████████████████████▊                                    | 3555/7473 [00:21<00:22, 176.18it/s] 48%|████████████████████████████████▉                                    | 3573/7473 [00:21<00:22, 176.51it/s] 48%|█████████████████████████████████▏                                   | 3591/7473 [00:21<00:21, 176.56it/s] 48%|█████████████████████████████████▎                                   | 3609/7473 [00:21<00:21, 176.30it/s] 49%|█████████████████████████████████▍                                   | 3627/7473 [00:21<00:22, 171.03it/s] 49%|█████████████████████████████████▋                                   | 3645/7473 [00:21<00:22, 172.26it/s] 49%|█████████████████████████████████▊                                   | 3663/7473 [00:21<00:22, 171.79it/s] 49%|█████████████████████████████████▉                                   | 3681/7473 [00:21<00:21, 173.13it/s] 49%|██████████████████████████████████▏                                  | 3699/7473 [00:21<00:21, 174.15it/s] 50%|██████████████████████████████████▎                                  | 3717/7473 [00:22<00:21, 174.62it/s] 50%|██████████████████████████████████▍                                  | 3735/7473 [00:22<00:21, 175.28it/s] 50%|██████████████████████████████████▋                                  | 3753/7473 [00:22<00:21, 174.05it/s] 50%|██████████████████████████████████▊                                  | 3771/7473 [00:22<00:21, 174.68it/s] 51%|██████████████████████████████████▉                                  | 3789/7473 [00:22<00:21, 174.75it/s] 51%|███████████████████████████████████▏                                 | 3807/7473 [00:22<00:20, 175.21it/s] 51%|███████████████████████████████████▎                                 | 3825/7473 [00:22<00:20, 175.15it/s] 51%|███████████████████████████████████▍                                 | 3843/7473 [00:22<00:20, 175.58it/s] 52%|███████████████████████████████████▋                                 | 3861/7473 [00:22<00:20, 175.56it/s] 52%|███████████████████████████████████▊                                 | 3879/7473 [00:22<00:20, 175.69it/s] 52%|███████████████████████████████████▉                                 | 3897/7473 [00:23<00:20, 173.77it/s] 52%|████████████████████████████████████▏                                | 3915/7473 [00:23<00:20, 174.69it/s] 53%|████████████████████████████████████▎                                | 3933/7473 [00:23<00:20, 174.93it/s] 53%|████████████████████████████████████▍                                | 3951/7473 [00:23<00:20, 175.29it/s] 53%|████████████████████████████████████▋                                | 3969/7473 [00:23<00:19, 175.65it/s] 53%|████████████████████████████████████▊                                | 3987/7473 [00:23<00:19, 176.07it/s] 54%|████████████████████████████████████▉                                | 4005/7473 [00:23<00:19, 176.38it/s] 54%|█████████████████████████████████████▏                               | 4023/7473 [00:23<00:19, 176.52it/s] 54%|█████████████████████████████████████▎                               | 4041/7473 [00:23<00:19, 176.67it/s] 54%|█████████████████████████████████████▍                               | 4059/7473 [00:23<00:19, 176.86it/s] 55%|█████████████████████████████████████▋                               | 4077/7473 [00:24<00:19, 176.64it/s] 55%|█████████████████████████████████████▊                               | 4095/7473 [00:24<00:19, 176.67it/s] 55%|█████████████████████████████████████▉                               | 4113/7473 [00:24<00:19, 174.50it/s] 55%|██████████████████████████████████████▏                              | 4131/7473 [00:24<00:19, 174.71it/s] 56%|██████████████████████████████████████▎                              | 4149/7473 [00:24<00:19, 174.71it/s] 56%|██████████████████████████████████████▍                              | 4167/7473 [00:24<00:18, 175.32it/s] 56%|██████████████████████████████████████▋                              | 4185/7473 [00:24<00:18, 175.49it/s] 56%|██████████████████████████████████████▊                              | 4203/7473 [00:24<00:18, 175.82it/s] 56%|██████████████████████████████████████▉                              | 4221/7473 [00:24<00:18, 176.09it/s] 57%|███████████████████████████████████████▏                             | 4239/7473 [00:24<00:18, 176.46it/s] 57%|███████████████████████████████████████▎                             | 4257/7473 [00:25<00:18, 176.41it/s] 57%|███████████████████████████████████████▍                             | 4275/7473 [00:25<00:18, 175.96it/s] 57%|███████████████████████████████████████▋                             | 4293/7473 [00:25<00:18, 176.13it/s] 58%|███████████████████████████████████████▊                             | 4311/7473 [00:25<00:17, 176.37it/s] 58%|███████████████████████████████████████▉                             | 4329/7473 [00:25<00:17, 176.55it/s] 58%|████████████████████████████████████████▏                            | 4347/7473 [00:25<00:17, 175.02it/s] 58%|████████████████████████████████████████▎                            | 4365/7473 [00:25<00:17, 175.15it/s] 59%|████████████████████████████████████████▍                            | 4383/7473 [00:25<00:17, 175.26it/s] 59%|████████████████████████████████████████▋                            | 4401/7473 [00:25<00:17, 175.76it/s] 59%|████████████████████████████████████████▊                            | 4419/7473 [00:26<00:17, 175.81it/s] 59%|████████████████████████████████████████▉                            | 4437/7473 [00:26<00:17, 175.83it/s] 60%|█████████████████████████████████████████▏                           | 4455/7473 [00:26<00:17, 175.58it/s] 60%|█████████████████████████████████████████▎                           | 4473/7473 [00:26<00:17, 176.00it/s] 60%|█████████████████████████████████████████▍                           | 4491/7473 [00:26<00:17, 174.66it/s] 60%|█████████████████████████████████████████▋                           | 4509/7473 [00:26<00:16, 174.73it/s] 61%|█████████████████████████████████████████▊                           | 4527/7473 [00:26<00:16, 175.14it/s] 61%|█████████████████████████████████████████▉                           | 4545/7473 [00:26<00:16, 175.69it/s] 61%|██████████████████████████████████████████▏                          | 4563/7473 [00:26<00:16, 174.13it/s] 61%|██████████████████████████████████████████▎                          | 4581/7473 [00:26<00:16, 174.69it/s] 62%|██████████████████████████████████████████▍                          | 4599/7473 [00:27<00:16, 174.81it/s] 62%|██████████████████████████████████████████▋                          | 4617/7473 [00:27<00:16, 175.39it/s] 62%|██████████████████████████████████████████▊                          | 4635/7473 [00:27<00:16, 173.83it/s] 62%|██████████████████████████████████████████▉                          | 4653/7473 [00:27<00:16, 174.36it/s] 63%|███████████████████████████████████████████▏                         | 4671/7473 [00:27<00:16, 174.84it/s] 63%|███████████████████████████████████████████▎                         | 4689/7473 [00:27<00:15, 175.59it/s] 63%|███████████████████████████████████████████▍                         | 4707/7473 [00:27<00:15, 175.39it/s] 63%|███████████████████████████████████████████▋                         | 4725/7473 [00:27<00:15, 176.02it/s] 63%|███████████████████████████████████████████▊                         | 4743/7473 [00:27<00:15, 176.09it/s] 64%|███████████████████████████████████████████▉                         | 4761/7473 [00:27<00:15, 176.43it/s] 64%|████████████████████████████████████████████▏                        | 4779/7473 [00:28<00:15, 176.43it/s] 64%|████████████████████████████████████████████▎                        | 4797/7473 [00:28<00:15, 174.63it/s] 64%|████████████████████████████████████████████▍                        | 4815/7473 [00:28<00:15, 175.13it/s] 65%|████████████████████████████████████████████▌                        | 4833/7473 [00:28<00:15, 175.64it/s] 65%|████████████████████████████████████████████▊                        | 4851/7473 [00:28<00:14, 175.42it/s] 65%|████████████████████████████████████████████▉                        | 4869/7473 [00:28<00:14, 175.30it/s] 65%|█████████████████████████████████████████████                        | 4887/7473 [00:28<00:14, 175.77it/s] 66%|█████████████████████████████████████████████▎                       | 4905/7473 [00:28<00:14, 176.32it/s] 66%|█████████████████████████████████████████████▍                       | 4923/7473 [00:28<00:14, 176.31it/s] 66%|█████████████████████████████████████████████▌                       | 4941/7473 [00:28<00:14, 175.94it/s] 66%|█████████████████████████████████████████████▊                       | 4959/7473 [00:29<00:14, 175.89it/s] 67%|█████████████████████████████████████████████▉                       | 4977/7473 [00:29<00:14, 175.89it/s] 67%|██████████████████████████████████████████████                       | 4995/7473 [00:29<00:14, 176.02it/s] 67%|██████████████████████████████████████████████▎                      | 5013/7473 [00:29<00:13, 176.40it/s] 67%|██████████████████████████████████████████████▍                      | 5031/7473 [00:29<00:14, 174.07it/s] 68%|██████████████████████████████████████████████▌                      | 5049/7473 [00:29<00:13, 174.91it/s] 68%|██████████████████████████████████████████████▊                      | 5067/7473 [00:29<00:13, 175.41it/s] 68%|██████████████████████████████████████████████▉                      | 5085/7473 [00:29<00:13, 175.73it/s] 68%|███████████████████████████████████████████████                      | 5103/7473 [00:29<00:13, 175.87it/s] 69%|███████████████████████████████████████████████▎                     | 5121/7473 [00:30<00:13, 176.01it/s] 69%|███████████████████████████████████████████████▍                     | 5139/7473 [00:30<00:13, 176.26it/s] 69%|███████████████████████████████████████████████▌                     | 5157/7473 [00:30<00:13, 176.40it/s] 69%|███████████████████████████████████████████████▊                     | 5175/7473 [00:30<00:13, 176.66it/s] 69%|███████████████████████████████████████████████▉                     | 5193/7473 [00:30<00:12, 176.57it/s] 70%|████████████████████████████████████████████████                     | 5211/7473 [00:30<00:12, 176.26it/s] 70%|████████████████████████████████████████████████▎                    | 5229/7473 [00:30<00:12, 176.42it/s] 70%|████████████████████████████████████████████████▍                    | 5247/7473 [00:30<00:14, 151.22it/s] 70%|████████████████████████████████████████████████▌                    | 5265/7473 [00:30<00:13, 157.79it/s] 71%|████████████████████████████████████████████████▊                    | 5283/7473 [00:30<00:13, 162.92it/s] 71%|████████████████████████████████████████████████▉                    | 5301/7473 [00:31<00:13, 166.73it/s] 71%|█████████████████████████████████████████████████                    | 5319/7473 [00:31<00:12, 169.17it/s] 71%|█████████████████████████████████████████████████▎                   | 5337/7473 [00:31<00:12, 170.56it/s] 72%|█████████████████████████████████████████████████▍                   | 5355/7473 [00:31<00:12, 171.15it/s] 72%|█████████████████████████████████████████████████▌                   | 5373/7473 [00:31<00:12, 171.75it/s] 72%|█████████████████████████████████████████████████▊                   | 5391/7473 [00:31<00:12, 171.98it/s] 72%|█████████████████████████████████████████████████▉                   | 5409/7473 [00:31<00:11, 173.38it/s] 73%|██████████████████████████████████████████████████                   | 5427/7473 [00:31<00:11, 174.33it/s] 73%|██████████████████████████████████████████████████▎                  | 5445/7473 [00:31<00:11, 174.99it/s] 73%|██████████████████████████████████████████████████▍                  | 5463/7473 [00:32<00:11, 174.83it/s] 73%|██████████████████████████████████████████████████▌                  | 5481/7473 [00:32<00:18, 109.01it/s] 74%|██████████████████████████████████████████████████▊                  | 5499/7473 [00:32<00:16, 123.16it/s] 74%|██████████████████████████████████████████████████▉                  | 5517/7473 [00:32<00:14, 135.44it/s] 74%|███████████████████████████████████████████████████                  | 5535/7473 [00:32<00:13, 145.56it/s] 74%|███████████████████████████████████████████████████▎                 | 5553/7473 [00:32<00:12, 153.64it/s] 75%|███████████████████████████████████████████████████▍                 | 5571/7473 [00:32<00:11, 159.96it/s] 75%|███████████████████████████████████████████████████▌                 | 5589/7473 [00:32<00:11, 164.41it/s] 75%|███████████████████████████████████████████████████▊                 | 5607/7473 [00:33<00:11, 167.82it/s] 75%|███████████████████████████████████████████████████▉                 | 5625/7473 [00:33<00:10, 170.32it/s] 76%|████████████████████████████████████████████████████                 | 5643/7473 [00:33<00:10, 172.25it/s] 76%|████████████████████████████████████████████████████▎                | 5661/7473 [00:33<00:10, 173.65it/s] 76%|████████████████████████████████████████████████████▍                | 5679/7473 [00:33<00:10, 172.56it/s] 76%|████████████████████████████████████████████████████▌                | 5697/7473 [00:33<00:10, 173.85it/s] 76%|████████████████████████████████████████████████████▊                | 5715/7473 [00:33<00:10, 174.36it/s] 77%|████████████████████████████████████████████████████▉                | 5733/7473 [00:33<00:09, 175.07it/s] 77%|█████████████████████████████████████████████████████                | 5751/7473 [00:33<00:09, 175.32it/s] 77%|█████████████████████████████████████████████████████▎               | 5769/7473 [00:33<00:09, 175.74it/s] 77%|█████████████████████████████████████████████████████▍               | 5787/7473 [00:34<00:09, 175.88it/s] 78%|█████████████████████████████████████████████████████▌               | 5805/7473 [00:34<00:09, 175.77it/s] 78%|█████████████████████████████████████████████████████▊               | 5823/7473 [00:34<00:09, 175.46it/s] 78%|█████████████████████████████████████████████████████▉               | 5841/7473 [00:34<00:09, 175.65it/s] 78%|██████████████████████████████████████████████████████               | 5859/7473 [00:34<00:09, 176.13it/s] 79%|██████████████████████████████████████████████████████▎              | 5877/7473 [00:34<00:09, 175.97it/s] 79%|██████████████████████████████████████████████████████▍              | 5895/7473 [00:34<00:08, 176.06it/s] 79%|██████████████████████████████████████████████████████▌              | 5913/7473 [00:34<00:08, 174.56it/s] 79%|██████████████████████████████████████████████████████▊              | 5931/7473 [00:34<00:08, 174.88it/s] 80%|██████████████████████████████████████████████████████▉              | 5949/7473 [00:34<00:08, 175.05it/s] 80%|███████████████████████████████████████████████████████              | 5967/7473 [00:35<00:08, 175.20it/s] 80%|███████████████████████████████████████████████████████▎             | 5985/7473 [00:35<00:08, 175.71it/s] 80%|███████████████████████████████████████████████████████▍             | 6003/7473 [00:35<00:08, 175.75it/s] 81%|███████████████████████████████████████████████████████▌             | 6021/7473 [00:35<00:08, 176.10it/s] 81%|███████████████████████████████████████████████████████▊             | 6039/7473 [00:35<00:08, 176.05it/s] 81%|███████████████████████████████████████████████████████▉             | 6057/7473 [00:35<00:08, 176.53it/s] 81%|████████████████████████████████████████████████████████             | 6075/7473 [00:35<00:07, 176.56it/s] 82%|████████████████████████████████████████████████████████▎            | 6093/7473 [00:35<00:07, 176.62it/s] 82%|████████████████████████████████████████████████████████▍            | 6111/7473 [00:35<00:07, 176.44it/s] 82%|████████████████████████████████████████████████████████▌            | 6129/7473 [00:36<00:07, 174.56it/s] 82%|████████████████████████████████████████████████████████▊            | 6147/7473 [00:36<00:07, 174.95it/s] 82%|████████████████████████████████████████████████████████▉            | 6165/7473 [00:36<00:07, 175.66it/s] 83%|█████████████████████████████████████████████████████████            | 6183/7473 [00:36<00:07, 175.81it/s] 83%|█████████████████████████████████████████████████████████▎           | 6201/7473 [00:36<00:07, 174.40it/s] 83%|█████████████████████████████████████████████████████████▍           | 6219/7473 [00:36<00:07, 173.84it/s] 83%|█████████████████████████████████████████████████████████▌           | 6237/7473 [00:36<00:07, 174.45it/s] 84%|█████████████████████████████████████████████████████████▊           | 6255/7473 [00:36<00:06, 175.31it/s] 84%|█████████████████████████████████████████████████████████▉           | 6273/7473 [00:36<00:06, 175.71it/s] 84%|██████████████████████████████████████████████████████████           | 6291/7473 [00:36<00:06, 175.54it/s] 84%|██████████████████████████████████████████████████████████▎          | 6309/7473 [00:37<00:06, 175.54it/s] 85%|██████████████████████████████████████████████████████████▍          | 6327/7473 [00:37<00:06, 175.37it/s] 85%|██████████████████████████████████████████████████████████▌          | 6345/7473 [00:37<00:06, 175.07it/s] 85%|██████████████████████████████████████████████████████████▊          | 6363/7473 [00:37<00:06, 173.20it/s] 85%|██████████████████████████████████████████████████████████▉          | 6381/7473 [00:37<00:06, 172.94it/s] 86%|███████████████████████████████████████████████████████████          | 6399/7473 [00:37<00:06, 173.33it/s] 86%|███████████████████████████████████████████████████████████▏         | 6417/7473 [00:37<00:06, 172.55it/s] 86%|███████████████████████████████████████████████████████████▍         | 6435/7473 [00:37<00:06, 172.85it/s] 86%|███████████████████████████████████████████████████████████▌         | 6453/7473 [00:37<00:05, 173.17it/s] 87%|███████████████████████████████████████████████████████████▋         | 6471/7473 [00:37<00:05, 173.49it/s] 87%|███████████████████████████████████████████████████████████▉         | 6489/7473 [00:38<00:05, 173.61it/s] 87%|████████████████████████████████████████████████████████████         | 6507/7473 [00:38<00:05, 173.86it/s] 87%|████████████████████████████████████████████████████████████▏        | 6525/7473 [00:38<00:05, 173.57it/s] 88%|████████████████████████████████████████████████████████████▍        | 6543/7473 [00:38<00:05, 173.95it/s] 88%|████████████████████████████████████████████████████████████▌        | 6561/7473 [00:38<00:05, 174.11it/s] 88%|████████████████████████████████████████████████████████████▋        | 6579/7473 [00:38<00:05, 173.78it/s] 88%|████████████████████████████████████████████████████████████▉        | 6597/7473 [00:38<00:05, 172.60it/s] 89%|█████████████████████████████████████████████████████████████        | 6615/7473 [00:38<00:04, 173.15it/s] 89%|█████████████████████████████████████████████████████████████▏       | 6633/7473 [00:38<00:04, 173.17it/s] 89%|█████████████████████████████████████████████████████████████▍       | 6651/7473 [00:39<00:04, 173.42it/s] 89%|█████████████████████████████████████████████████████████████▌       | 6669/7473 [00:39<00:04, 173.34it/s] 89%|█████████████████████████████████████████████████████████████▋       | 6687/7473 [00:39<00:04, 173.58it/s] 90%|█████████████████████████████████████████████████████████████▉       | 6705/7473 [00:39<00:04, 173.74it/s] 90%|██████████████████████████████████████████████████████████████       | 6723/7473 [00:39<00:04, 173.75it/s] 90%|██████████████████████████████████████████████████████████████▏      | 6741/7473 [00:39<00:04, 173.95it/s] 90%|██████████████████████████████████████████████████████████████▍      | 6759/7473 [00:39<00:04, 173.91it/s] 91%|██████████████████████████████████████████████████████████████▌      | 6777/7473 [00:39<00:04, 173.71it/s] 91%|██████████████████████████████████████████████████████████████▋      | 6795/7473 [00:39<00:03, 174.06it/s] 91%|██████████████████████████████████████████████████████████████▉      | 6813/7473 [00:39<00:03, 172.22it/s] 91%|███████████████████████████████████████████████████████████████      | 6831/7473 [00:40<00:03, 172.65it/s] 92%|███████████████████████████████████████████████████████████████▏     | 6849/7473 [00:40<00:03, 173.09it/s] 92%|███████████████████████████████████████████████████████████████▍     | 6867/7473 [00:40<00:03, 173.29it/s] 92%|███████████████████████████████████████████████████████████████▌     | 6885/7473 [00:40<00:03, 173.75it/s] 92%|███████████████████████████████████████████████████████████████▋     | 6903/7473 [00:40<00:03, 173.80it/s] 93%|███████████████████████████████████████████████████████████████▉     | 6921/7473 [00:40<00:03, 173.81it/s] 93%|████████████████████████████████████████████████████████████████     | 6939/7473 [00:40<00:03, 173.95it/s] 93%|████████████████████████████████████████████████████████████████▏    | 6957/7473 [00:40<00:02, 173.83it/s] 93%|████████████████████████████████████████████████████████████████▍    | 6975/7473 [00:40<00:02, 173.91it/s] 94%|████████████████████████████████████████████████████████████████▌    | 6993/7473 [00:40<00:02, 173.80it/s] 94%|████████████████████████████████████████████████████████████████▋    | 7011/7473 [00:41<00:02, 173.87it/s] 94%|████████████████████████████████████████████████████████████████▉    | 7029/7473 [00:41<00:02, 173.86it/s] 94%|█████████████████████████████████████████████████████████████████    | 7047/7473 [00:41<00:02, 171.71it/s] 95%|█████████████████████████████████████████████████████████████████▏   | 7065/7473 [00:41<00:02, 172.45it/s] 95%|█████████████████████████████████████████████████████████████████▍   | 7083/7473 [00:41<00:02, 173.13it/s] 95%|█████████████████████████████████████████████████████████████████▌   | 7101/7473 [00:41<00:02, 173.62it/s] 95%|█████████████████████████████████████████████████████████████████▋   | 7119/7473 [00:41<00:02, 173.49it/s] 96%|█████████████████████████████████████████████████████████████████▉   | 7137/7473 [00:41<00:01, 171.87it/s] 96%|██████████████████████████████████████████████████████████████████   | 7155/7473 [00:41<00:01, 164.65it/s] 96%|██████████████████████████████████████████████████████████████████▏  | 7172/7473 [00:42<00:01, 165.18it/s] 96%|██████████████████████████████████████████████████████████████████▍  | 7190/7473 [00:42<00:01, 167.69it/s] 96%|██████████████████████████████████████████████████████████████████▌  | 7208/7473 [00:42<00:01, 169.46it/s] 97%|██████████████████████████████████████████████████████████████████▋  | 7226/7473 [00:42<00:01, 170.83it/s] 97%|██████████████████████████████████████████████████████████████████▉  | 7244/7473 [00:42<00:01, 165.39it/s] 97%|███████████████████████████████████████████████████████████████████  | 7262/7473 [00:42<00:01, 166.32it/s] 97%|███████████████████████████████████████████████████████████████████▏ | 7279/7473 [00:42<00:01, 167.24it/s] 98%|███████████████████████████████████████████████████████████████████▎ | 7296/7473 [00:42<00:01, 165.70it/s] 98%|███████████████████████████████████████████████████████████████████▌ | 7314/7473 [00:42<00:00, 168.18it/s] 98%|███████████████████████████████████████████████████████████████████▋ | 7332/7473 [00:42<00:00, 169.72it/s] 98%|███████████████████████████████████████████████████████████████████▊ | 7350/7473 [00:43<00:00, 170.84it/s] 99%|████████████████████████████████████████████████████████████████████ | 7368/7473 [00:43<00:00, 171.51it/s] 99%|████████████████████████████████████████████████████████████████████▏| 7386/7473 [00:43<00:00, 172.45it/s] 99%|████████████████████████████████████████████████████████████████████▎| 7404/7473 [00:43<00:00, 172.93it/s] 99%|████████████████████████████████████████████████████████████████████▌| 7422/7473 [00:43<00:00, 173.36it/s]100%|████████████████████████████████████████████████████████████████████▋| 7440/7473 [00:43<00:00, 173.77it/s]100%|████████████████████████████████████████████████████████████████████▊| 7458/7473 [00:43<00:00, 173.83it/s]100%|█████████████████████████████████████████████████████████████████████| 7473/7473 [00:43<00:00, 170.66it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                         | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                         | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                         | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                         | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|████████████████▎                                | 1/3 [00:05<00:10,  5.34s/it]Loading checkpoint shards:  33%|████████████████▎                                | 1/3 [00:05<00:10,  5.02s/it]Loading checkpoint shards:  33%|████████████████▎                                | 1/3 [00:05<00:10,  5.30s/it]Loading checkpoint shards:  33%|████████████████▎                                | 1/3 [00:05<00:10,  5.40s/it]Loading checkpoint shards:  67%|████████████████████████████████▋                | 2/3 [00:09<00:04,  4.90s/it]Loading checkpoint shards:  67%|████████████████████████████████▋                | 2/3 [00:10<00:05,  5.20s/it]Loading checkpoint shards:  67%|████████████████████████████████▋                | 2/3 [00:10<00:05,  5.37s/it]Loading checkpoint shards:  67%|████████████████████████████████▋                | 2/3 [00:10<00:05,  5.35s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.30s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.47s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.68s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.83s/it]
[2023-08-16 03:38:29,688] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.73s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.90s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.83s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.97s/it]
[2023-08-16 03:38:40,505] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-16 03:38:40,506] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-16 03:38:40,506] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-16 03:38:40,506] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-16 03:38:40,506] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-16 03:38:40,506] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f5b81c5cfd0>
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f5b81c5cbe0>
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-16 03:38:40,507] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-16 03:38:40,508] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-16 03:38:40,508] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-16 03:38:40,508] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-16 03:38:40,508] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-16 03:38:40,508] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-16 03:38:40,508] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-16 03:38:40,508] [INFO] [config.py:1012:print]   train_batch_size ............. 8
[2023-08-16 03:38:40,508] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  2
[2023-08-16 03:38:40,508] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-16 03:38:40,508] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-16 03:38:40,508] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-16 03:38:40,508] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-16 03:38:40,508] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-16 03:38:40,508] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-16 03:38:40,508] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-16 03:38:40,508] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.6489219665527344 seconds
Loading extension module utils...
Time to load utils op: 0.604727029800415 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Loading extension module utils...
Evaluating gsm8k :   0%|                                                               | 0/125 [00:00<?, ?it/s]Time to load utils op: 0.5045938491821289 seconds
############### Example ###############
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following grade math question.

### Demonstration:
Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Rationales: 1. The question asks where you would find plumbing that would not be useful if you were thirsty.
2. The key here is to understand the connection between "plumbing" and "thirsty".
3. You would typically use plumbing to access water, particularly clean drinkable water when you're thirsty.
4. Therefore, we can assume that we're looking for a choice where the plumbing does not supply water, or at least not drinkable water.
5. Looking at the choices, "oil refineries", "wall", "show", "own home", and "water fountain", we need to determine which of these would not supply drinkable water from their plumbing. 
6. Walls and shows wouldn't have plumbing itself, but your own home and a water fountain would typically have plumbing that supplies drinkable water.
7. An oil refinery, however, is a place where the plumbing system is used to transport oil, not water.
8. Therefore, you can't drink anything from the plumbing of an oil refinery, hence it would not be of use if you were thirsty.
9. Thus, the answer is A: oil refineries.
Answer: A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Rationales: Intermediate Reasoning Steps:

1. The question asks about the activity that a person is not engaging in yet when they are beginning work.
2. It cannot be A: working. Since the person is beginning work, they are actually performing this activity.
3. It cannot be B: resting. Resting indicates a period of inactivity or relaxation, which is different from beginning work.
4. It cannot be C: tiredness. This is an emotional state, not an action. Besides, someone can feel tired either before starting work, during work or after work. So, this does not relate directly to the action of starting work.
5. It cannot be E: momentum. Momentum generally refers to the force or speed of movement. Although starting work can involve gaining momentum, the term does not directly refer to an action that a person could be engaging in or not.
6. Therefore, the only option left is D: accomplishing. When a person is beginning work, they have not accomplished anything related to that work yet. They are only embarking on the task at hand but they have not yet achieved any results. Thus, they aren't accomplishing anything yet at the very moment they begin to work.
Answer: D: accomplishing

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Rationales: 1. First, the question asks about a pen with a company logo.
2. This usually indicates a pen that is customized with some business branding.
3. While you may find pens in a few of the given choices like a school or backpack, the pens are typically not company-branded.
4. The most common place to find company-branded pens is in an office setting, as companies often provide custom pens for their employees or for promotional purposes.
5. Therefore, the answer should be the option that corresponds with an office setting, which in these choices, is option A: office.
Answer: A: office

Input: Billy called out to John, and listened for what? Choices:  A: silence B: response C: communication D: hanging up E: whisper
Rationales: 1. The question talks about Billy calling out to John. 
2. Calling out to someone typically indicates a desire to communicate, or the initiation of a conversation.
3. For communication to work, it usually requires some kind of reaction or response from the other party.
4. So Billy, having initiated the conversation, would be waiting for a reaction or a reply from John.
5. Thus, the correct option is that Billy listened for a response (option B).
Answer: B: response

Input: The lizard frightened the hiker, it's movements made what rustle? Choices:  A: garden B: trees C: books D: rocks E: bushes
Rationales: 1. The question is asking what the lizard's movements made rustle. 
2. 'Rustle' refers to a soft, muffled crackling sound like that made by the movement of dry leaves or paper. 
3. Now, among the given options, we need to choose a noun that is more likely to produce a rustling sound when disturbed by a lizard. 
4. A lizard in a garden can't 'rustle' the entire garden, as there are open spaces and not all parts of a garden would make a rustle noise. So we eliminate option A. 
5. Moving to option B, trees, it's unlikely. Lizards are not typically large or strong enough to rustle trees. Hence, we can eliminate option B.
6. Lizards don't interact with books, so, option C can be eliminated.
7. Rocks can't 'rustle', hence we can eliminate option D.
8. Among the remaining options, bushes are likely to make a rustling sound when a lizard scurries through them. This makes sense since most lizards live in or around bushes in the wild.
9. Therefore, E: bushes is the most appropriate answer.
Answer: E: bushes

Input: The man spent big money and time maintaining his lawn, it was part of keeping up with the Joneses where? Choices:  A: front yard B: suburbia C: neighborhood D: back yard E: golf course
Rationales: 1. The question is asking where the man is keeping up with the Joneses by spending big money and time maintaining his lawn.
2. The phrase "keeping up with the Joneses" typically refers to trying to match or surpass the lifestyle or perceived wealth of neighbors or peers, suggesting that the man is doing this in a residential setting. 
3. The given options are: front yard, suburbia, neighborhood, back yard, and golf course.
4. The options front yard and back yard refer to specific portions of a piece of property and not a broader residential setting.
5. The option golf course could suggest a scenario where a man is maintaining his lawn to match a golf course standard, but this does not match the idea of personally keeping up with neighbors or peers.
6. The options suburbia and neighborhood both suggest a residential setting where the phenomenon of "keeping up with the joneses" commonly occurs. 
7. Yet, the term suburbia not only refers to a residential area, but also carries a cultural connotation of a place where people strive to maintain a certain image of wealth or status, which aligns better with the phrase "keeping up with the Joneses".
8. Therefore, the answer is B: suburbia.
Answer: B: suburbia

Input: What would a human do if they want to get to a store that he or she can see? Choices:  A: cross road B: see around C: drink coffee D: dream dreams E: think critically
Rationales: 1. The question asks what a human would need to do to reach a store they can see.
2. This implies there is some physical distance between the human and the store.
3. Therefore, they would need to perform some action that helps them cover that distance.
4. Looking at the available choices, "drinking coffee," "dreaming dreams," and "thinking critically" do not directly contribute to physical movement.
5. "Seeing around" would be beneficial in observing the environment but it doesn't ensure movement towards the store.
6. Therefore, the only option that involves some form of movement and could physically bring a person closer to the store is "cross the road".
7. So, the answer to the question is A: cross road.
Answer: A: cross road

Input: Where would you grab an object contained by a doorway? Choices:  A: television B: control panel C: opening doors D: doorknob E: doorway
Rationales: 1. To start solving this, we need to understand the question. It's asking where we would grab an object that is contained by a doorway.
2. We can first eliminate option A: television, as it is an object that is usually found inside a room rather than in a doorway.
3. Option B: control panel is also not likely as control panels are usually not found in a doorway.
4. We can also eliminate option C: opening doors because this refers to an action rather than a location.
5. Option D: doorknob, while it is an object often found associated with a door, it's not a part of the doorway and usually used to open or close a door, not to contain an object. 
6. Therefore, that leaves us with option E: doorway. A doorway can contain an object, and you can also grab the object from that doorway. So, the answer is E: doorway.
Answer: E: doorway

### Input:Natalia sold clips to 48 of her friends in April, and then she sold half as many clips in May. How many clips did Natalia sell altogether in April and May?

### Response:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o8-tcommonsenseqa-s1-rTrue-m4096
Loading extension module utils...
Time to load utils op: 0.5044765472412109 seconds
Evaluating gsm8k :   1%|▍                                                      | 1/125 [00:22<47:01, 22.75s/it]Evaluating gsm8k :   2%|▉                                                      | 2/125 [00:50<52:51, 25.78s/it]Evaluating gsm8k :   2%|█▎                                                   | 3/125 [01:31<1:06:21, 32.63s/it]Evaluating gsm8k :   3%|█▋                                                   | 4/125 [02:11<1:12:04, 35.74s/it]Evaluating gsm8k :   4%|██                                                   | 5/125 [02:52<1:14:50, 37.42s/it]Evaluating gsm8k :   5%|██▌                                                  | 6/125 [03:32<1:16:17, 38.47s/it]Evaluating gsm8k :   6%|██▉                                                  | 7/125 [04:13<1:17:15, 39.28s/it]Evaluating gsm8k :   6%|███▍                                                 | 8/125 [04:54<1:17:14, 39.61s/it]Evaluating gsm8k :   7%|███▊                                                 | 9/125 [05:35<1:17:24, 40.04s/it]Evaluating gsm8k :   8%|████▏                                               | 10/125 [05:58<1:06:44, 34.82s/it]Evaluating gsm8k :   9%|████▌                                               | 11/125 [06:39<1:09:58, 36.82s/it]Evaluating gsm8k :  10%|████▉                                               | 12/125 [07:20<1:11:28, 37.95s/it]Evaluating gsm8k :  10%|█████▍                                              | 13/125 [08:01<1:12:31, 38.85s/it]Evaluating gsm8k :  11%|█████▊                                              | 14/125 [08:42<1:13:11, 39.57s/it]Evaluating gsm8k :  12%|██████▏                                             | 15/125 [09:22<1:13:06, 39.88s/it]Evaluating gsm8k :  13%|██████▉                                               | 16/125 [09:32<55:45, 30.69s/it]Evaluating gsm8k :  14%|███████                                             | 17/125 [10:13<1:01:10, 33.99s/it]Evaluating gsm8k :  14%|███████▍                                            | 18/125 [10:54<1:04:15, 36.04s/it]Evaluating gsm8k :  15%|███████▉                                            | 19/125 [11:35<1:05:59, 37.35s/it]Evaluating gsm8k :  16%|████████▎                                           | 20/125 [12:15<1:07:03, 38.32s/it]Evaluating gsm8k :  17%|█████████                                             | 21/125 [12:38<58:12, 33.58s/it]Evaluating gsm8k :  18%|█████████▏                                          | 22/125 [13:19<1:01:22, 35.75s/it]Evaluating gsm8k :  18%|█████████▉                                            | 23/125 [13:41<54:14, 31.90s/it]Evaluating gsm8k :  19%|██████████▎                                           | 24/125 [14:22<58:18, 34.64s/it]Evaluating gsm8k :  20%|██████████▍                                         | 25/125 [15:04<1:01:10, 36.70s/it]Evaluating gsm8k :  21%|██████████▊                                         | 26/125 [15:45<1:02:35, 37.93s/it]Evaluating gsm8k :  22%|███████████▋                                          | 27/125 [16:14<57:30, 35.21s/it]Evaluating gsm8k :  22%|████████████                                          | 28/125 [16:54<59:28, 36.79s/it]Evaluating gsm8k :  23%|████████████                                        | 29/125 [17:35<1:00:50, 38.03s/it]Evaluating gsm8k :  24%|████████████▉                                         | 30/125 [18:06<57:03, 36.04s/it]Evaluating gsm8k :  25%|█████████████▍                                        | 31/125 [18:48<59:03, 37.69s/it]Evaluating gsm8k :  26%|█████████████▊                                        | 32/125 [19:11<51:30, 33.23s/it]Evaluating gsm8k :  26%|██████████████▎                                       | 33/125 [19:34<46:18, 30.20s/it]Evaluating gsm8k :  27%|██████████████▋                                       | 34/125 [20:15<50:51, 33.54s/it]Evaluating gsm8k :  28%|███████████████                                       | 35/125 [20:57<53:46, 35.85s/it]Evaluating gsm8k :  29%|███████████████▌                                      | 36/125 [21:37<55:23, 37.34s/it]Evaluating gsm8k :  30%|███████████████▉                                      | 37/125 [22:18<56:16, 38.37s/it]Evaluating gsm8k :  30%|████████████████▍                                     | 38/125 [22:59<56:37, 39.05s/it]Evaluating gsm8k :  31%|████████████████▊                                     | 39/125 [23:39<56:33, 39.46s/it]Evaluating gsm8k :  32%|█████████████████▎                                    | 40/125 [24:20<56:31, 39.90s/it]Evaluating gsm8k :  33%|█████████████████▋                                    | 41/125 [25:01<56:13, 40.16s/it]Evaluating gsm8k :  34%|██████████████████▏                                   | 42/125 [25:42<55:49, 40.36s/it]Evaluating gsm8k :  34%|██████████████████▌                                   | 43/125 [26:23<55:21, 40.51s/it]Evaluating gsm8k :  35%|███████████████████                                   | 44/125 [27:04<55:03, 40.79s/it]Evaluating gsm8k :  36%|███████████████████▍                                  | 45/125 [27:45<54:30, 40.88s/it]Evaluating gsm8k :  37%|███████████████████▊                                  | 46/125 [27:59<43:11, 32.80s/it]Evaluating gsm8k :  38%|████████████████████▎                                 | 47/125 [28:40<45:44, 35.18s/it]Evaluating gsm8k :  38%|████████████████████▋                                 | 48/125 [29:21<47:37, 37.10s/it]Evaluating gsm8k :  39%|█████████████████████▏                                | 49/125 [30:02<48:13, 38.08s/it]Evaluating gsm8k :  40%|█████████████████████▌                                | 50/125 [30:42<48:37, 38.89s/it]Evaluating gsm8k :  41%|██████████████████████                                | 51/125 [31:23<48:36, 39.41s/it]Evaluating gsm8k :  42%|██████████████████████▍                               | 52/125 [32:04<48:31, 39.88s/it]Evaluating gsm8k :  42%|██████████████████████▉                               | 53/125 [32:45<48:06, 40.09s/it]Evaluating gsm8k :  43%|███████████████████████▎                              | 54/125 [33:18<45:12, 38.20s/it]Evaluating gsm8k :  44%|███████████████████████▊                              | 55/125 [34:00<45:41, 39.16s/it]Evaluating gsm8k :  45%|████████████████████████▏                             | 56/125 [34:41<45:46, 39.80s/it]Evaluating gsm8k :  46%|████████████████████████▌                             | 57/125 [35:10<41:20, 36.48s/it]Evaluating gsm8k :  46%|█████████████████████████                             | 58/125 [35:50<42:01, 37.64s/it]Evaluating gsm8k :  47%|█████████████████████████▍                            | 59/125 [36:31<42:33, 38.69s/it]Evaluating gsm8k :  48%|█████████████████████████▉                            | 60/125 [37:12<42:36, 39.33s/it]Evaluating gsm8k :  49%|██████████████████████████▎                           | 61/125 [37:52<41:58, 39.35s/it]Evaluating gsm8k :  50%|██████████████████████████▊                           | 62/125 [38:32<41:38, 39.65s/it]Evaluating gsm8k :  50%|███████████████████████████▏                          | 63/125 [39:12<41:11, 39.86s/it]Evaluating gsm8k :  51%|███████████████████████████▋                          | 64/125 [39:53<40:42, 40.04s/it]Evaluating gsm8k :  52%|████████████████████████████                          | 65/125 [40:33<40:14, 40.23s/it]Evaluating gsm8k :  53%|████████████████████████████▌                         | 66/125 [41:14<39:37, 40.30s/it]Evaluating gsm8k :  54%|████████████████████████████▉                         | 67/125 [41:54<38:57, 40.30s/it]Evaluating gsm8k :  54%|█████████████████████████████▍                        | 68/125 [42:35<38:29, 40.52s/it]Evaluating gsm8k :  55%|█████████████████████████████▊                        | 69/125 [43:16<37:48, 40.51s/it]Evaluating gsm8k :  56%|██████████████████████████████▏                       | 70/125 [43:56<37:11, 40.57s/it]Evaluating gsm8k :  57%|██████████████████████████████▋                       | 71/125 [44:37<36:31, 40.59s/it]Evaluating gsm8k :  58%|███████████████████████████████                       | 72/125 [44:57<30:29, 34.52s/it]Evaluating gsm8k :  58%|███████████████████████████████▌                      | 73/125 [45:38<31:33, 36.41s/it]Evaluating gsm8k :  59%|███████████████████████████████▉                      | 74/125 [46:18<31:55, 37.55s/it]Evaluating gsm8k :  60%|████████████████████████████████▍                     | 75/125 [46:52<30:19, 36.38s/it]Evaluating gsm8k :  61%|████████████████████████████████▊                     | 76/125 [47:32<30:39, 37.53s/it]Evaluating gsm8k :  62%|█████████████████████████████████▎                    | 77/125 [47:50<25:21, 31.70s/it]Evaluating gsm8k :  62%|█████████████████████████████████▋                    | 78/125 [48:31<26:50, 34.27s/it]Evaluating gsm8k :  63%|██████████████████████████████████▏                   | 79/125 [49:11<27:41, 36.13s/it]Evaluating gsm8k :  64%|██████████████████████████████████▌                   | 80/125 [49:51<28:01, 37.36s/it]Evaluating gsm8k :  65%|██████████████████████████████████▉                   | 81/125 [50:04<21:52, 29.83s/it]Evaluating gsm8k :  66%|███████████████████████████████████▍                  | 82/125 [50:44<23:44, 33.12s/it]Evaluating gsm8k :  66%|███████████████████████████████████▊                  | 83/125 [51:24<24:36, 35.15s/it]Evaluating gsm8k :  67%|████████████████████████████████████▎                 | 84/125 [52:05<25:03, 36.67s/it]Evaluating gsm8k :  68%|████████████████████████████████████▋                 | 85/125 [52:45<25:14, 37.86s/it]Evaluating gsm8k :  69%|█████████████████████████████████████▏                | 86/125 [53:25<25:05, 38.60s/it]Evaluating gsm8k :  70%|█████████████████████████████████████▌                | 87/125 [54:06<24:47, 39.16s/it]Evaluating gsm8k :  70%|██████████████████████████████████████                | 88/125 [54:32<21:40, 35.16s/it]Evaluating gsm8k :  71%|██████████████████████████████████████▍               | 89/125 [55:12<21:57, 36.59s/it]Evaluating gsm8k :  72%|██████████████████████████████████████▉               | 90/125 [55:52<22:04, 37.84s/it]Evaluating gsm8k :  73%|███████████████████████████████████████▎              | 91/125 [56:33<21:50, 38.54s/it]Evaluating gsm8k :  74%|███████████████████████████████████████▋              | 92/125 [57:13<21:30, 39.12s/it]Evaluating gsm8k :  74%|████████████████████████████████████████▏             | 93/125 [57:42<19:14, 36.09s/it]Evaluating gsm8k :  75%|████████████████████████████████████████▌             | 94/125 [57:49<14:07, 27.34s/it]Evaluating gsm8k :  76%|█████████████████████████████████████████             | 95/125 [58:13<13:11, 26.37s/it]Evaluating gsm8k :  77%|█████████████████████████████████████████▍            | 96/125 [58:53<14:42, 30.43s/it]Evaluating gsm8k :  78%|█████████████████████████████████████████▉            | 97/125 [59:33<15:35, 33.41s/it]Evaluating gsm8k :  78%|████████████████████████████████████████▊           | 98/125 [1:00:14<15:58, 35.52s/it]Evaluating gsm8k :  79%|█████████████████████████████████████████▏          | 99/125 [1:00:29<12:47, 29.51s/it]Evaluating gsm8k :  80%|████████████████████████████████████████▊          | 100/125 [1:01:10<13:41, 32.85s/it]Evaluating gsm8k :  81%|█████████████████████████████████████████▏         | 101/125 [1:01:50<14:02, 35.11s/it]Evaluating gsm8k :  82%|█████████████████████████████████████████▌         | 102/125 [1:02:31<14:02, 36.63s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████         | 103/125 [1:03:06<13:20, 36.41s/it]Evaluating gsm8k :  83%|██████████████████████████████████████████▍        | 104/125 [1:03:47<13:11, 37.71s/it]Evaluating gsm8k :  84%|██████████████████████████████████████████▊        | 105/125 [1:04:28<12:50, 38.52s/it]Evaluating gsm8k :  85%|███████████████████████████████████████████▏       | 106/125 [1:05:09<12:27, 39.37s/it]Evaluating gsm8k :  86%|███████████████████████████████████████████▋       | 107/125 [1:05:43<11:17, 37.63s/it]Evaluating gsm8k :  86%|████████████████████████████████████████████       | 108/125 [1:06:23<10:54, 38.49s/it]Evaluating gsm8k :  87%|████████████████████████████████████████████▍      | 109/125 [1:07:04<10:25, 39.11s/it]Evaluating gsm8k :  88%|████████████████████████████████████████████▉      | 110/125 [1:07:44<09:53, 39.54s/it]Evaluating gsm8k :  89%|█████████████████████████████████████████████▎     | 111/125 [1:08:25<09:17, 39.83s/it]Evaluating gsm8k :  90%|█████████████████████████████████████████████▋     | 112/125 [1:09:06<08:44, 40.33s/it]Evaluating gsm8k :  90%|██████████████████████████████████████████████     | 113/125 [1:09:46<08:02, 40.20s/it]Evaluating gsm8k :  91%|██████████████████████████████████████████████▌    | 114/125 [1:10:26<07:22, 40.24s/it]Evaluating gsm8k :  92%|██████████████████████████████████████████████▉    | 115/125 [1:11:07<06:44, 40.42s/it]Evaluating gsm8k :  93%|███████████████████████████████████████████████▎   | 116/125 [1:11:48<06:04, 40.46s/it]Evaluating gsm8k :  94%|███████████████████████████████████████████████▋   | 117/125 [1:12:15<04:52, 36.60s/it]Evaluating gsm8k :  94%|████████████████████████████████████████████████▏  | 118/125 [1:12:56<04:25, 37.86s/it]Evaluating gsm8k :  95%|████████████████████████████████████████████████▌  | 119/125 [1:13:37<03:51, 38.64s/it]Evaluating gsm8k :  96%|████████████████████████████████████████████████▉  | 120/125 [1:14:18<03:17, 39.48s/it]Evaluating gsm8k :  97%|█████████████████████████████████████████████████▎ | 121/125 [1:14:59<02:39, 39.89s/it]Evaluating gsm8k :  98%|█████████████████████████████████████████████████▊ | 122/125 [1:15:22<01:44, 34.90s/it]Evaluating gsm8k :  98%|██████████████████████████████████████████████████▏| 123/125 [1:15:42<01:00, 30.26s/it]Evaluating gsm8k :  99%|██████████████████████████████████████████████████▌| 124/125 [1:16:23<00:33, 33.60s/it]Evaluating gsm8k : 100%|███████████████████████████████████████████████████| 125/125 [1:16:55<00:00, 33.09s/it]Evaluating gsm8k : 100%|███████████████████████████████████████████████████| 125/125 [1:16:55<00:00, 36.92s/it]
name: gsm8k | {'exact_match': 0.0, 'rougeL': 0.1983} | lm_loss 10.1258 | avg. gen lenth: 368.856
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name gsm8k --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name commonsenseqa --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --max-prompt-length 4096 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 2 --data-dir /scratch/ylu130/processed_data/gsm8k/out-domain/o9-tcommonsenseqa-s1-rTrue --seed 1 --rationales --num-out-domain 9
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
using world size: 4
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[2023-08-16 04:57:54,836] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... gsm8k
  data_dir ..................... /scratch/ylu130/processed_data/gsm8k/out-domain/o9-tcommonsenseqa-s1-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 9
  out_domain_data_name ......... commonsenseqa
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 4096
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o9-tcommonsenseqa-s1-rTrue-m4096
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 2
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                 | 0/7473 [00:00<?, ?it/s]  0%|                                                                         | 9/7473 [00:00<01:30, 82.71it/s]  0%|▏                                                                       | 18/7473 [00:00<01:29, 83.01it/s]  0%|▎                                                                       | 27/7473 [00:00<01:30, 82.63it/s]  0%|▎                                                                       | 36/7473 [00:00<01:29, 82.89it/s]  1%|▍                                                                       | 45/7473 [00:00<01:29, 82.87it/s]  1%|▌                                                                       | 54/7473 [00:00<01:30, 81.79it/s]  1%|▌                                                                       | 63/7473 [00:00<01:30, 81.98it/s]  1%|▋                                                                       | 72/7473 [00:00<01:29, 82.47it/s]  1%|▊                                                                       | 81/7473 [00:00<01:29, 82.70it/s]  1%|▊                                                                       | 90/7473 [00:01<01:29, 82.85it/s]  1%|▉                                                                       | 99/7473 [00:01<01:28, 83.01it/s]  1%|█                                                                      | 108/7473 [00:01<01:28, 82.84it/s]  2%|█                                                                      | 117/7473 [00:01<01:28, 83.01it/s]  2%|█▏                                                                     | 126/7473 [00:01<01:28, 83.08it/s]  2%|█▎                                                                     | 135/7473 [00:01<01:29, 81.98it/s]  2%|█▎                                                                     | 144/7473 [00:01<01:29, 82.24it/s]  2%|█▍                                                                     | 153/7473 [00:01<01:28, 82.65it/s]  2%|█▌                                                                     | 162/7473 [00:01<01:28, 82.86it/s]  2%|█▌                                                                     | 171/7473 [00:02<01:28, 82.82it/s]  2%|█▋                                                                     | 180/7473 [00:02<01:27, 82.97it/s]  3%|█▊                                                                     | 189/7473 [00:02<01:27, 83.14it/s]  3%|█▉                                                                     | 198/7473 [00:02<01:27, 83.21it/s]  3%|█▉                                                                     | 207/7473 [00:02<01:27, 83.20it/s]  3%|██                                                                     | 216/7473 [00:02<01:27, 83.11it/s]  3%|██▏                                                                    | 225/7473 [00:02<01:27, 83.01it/s]  3%|██▏                                                                    | 234/7473 [00:02<01:27, 82.79it/s]  3%|██▎                                                                    | 243/7473 [00:02<01:27, 82.83it/s]  3%|██▍                                                                    | 255/7473 [00:03<01:18, 91.88it/s]  4%|██▌                                                                   | 268/7473 [00:03<01:10, 101.80it/s]  4%|██▋                                                                   | 281/7473 [00:03<01:05, 109.01it/s]  4%|██▊                                                                   | 294/7473 [00:03<01:02, 114.42it/s]  4%|██▉                                                                   | 307/7473 [00:03<01:00, 117.64it/s]  4%|██▉                                                                   | 320/7473 [00:03<00:59, 120.73it/s]  4%|███                                                                   | 333/7473 [00:03<00:58, 122.62it/s]  5%|███▏                                                                  | 346/7473 [00:03<00:57, 123.97it/s]  5%|███▎                                                                  | 359/7473 [00:03<00:57, 124.75it/s]  5%|███▍                                                                  | 372/7473 [00:03<00:56, 125.02it/s]  5%|███▌                                                                  | 385/7473 [00:04<00:56, 125.78it/s]  5%|███▋                                                                  | 398/7473 [00:04<00:56, 125.82it/s]  5%|███▊                                                                  | 411/7473 [00:04<00:56, 125.21it/s]  6%|███▉                                                                  | 424/7473 [00:04<00:56, 125.05it/s]  6%|████                                                                  | 437/7473 [00:04<00:56, 125.52it/s]  6%|████▏                                                                 | 450/7473 [00:04<00:55, 126.05it/s]  6%|████▎                                                                 | 463/7473 [00:04<00:55, 126.22it/s]  6%|████▍                                                                 | 476/7473 [00:04<00:56, 124.50it/s]  7%|████▌                                                                 | 489/7473 [00:04<00:56, 124.13it/s]  7%|████▋                                                                 | 502/7473 [00:05<00:55, 124.65it/s]  7%|████▊                                                                 | 515/7473 [00:05<00:55, 125.49it/s]  7%|████▉                                                                 | 528/7473 [00:05<00:55, 125.09it/s]  7%|█████                                                                 | 541/7473 [00:05<00:55, 125.73it/s]  7%|█████▏                                                                | 554/7473 [00:05<00:54, 126.11it/s]  8%|█████▎                                                                | 567/7473 [00:05<00:54, 126.17it/s]  8%|█████▍                                                                | 580/7473 [00:05<00:54, 126.20it/s]  8%|█████▌                                                                | 593/7473 [00:05<00:54, 126.31it/s]  8%|█████▋                                                                | 606/7473 [00:05<00:54, 126.31it/s]  8%|█████▊                                                                | 619/7473 [00:05<00:54, 126.29it/s]  8%|█████▉                                                                | 632/7473 [00:06<00:53, 126.75it/s]  9%|██████                                                                | 645/7473 [00:06<00:53, 126.73it/s]  9%|██████▏                                                               | 658/7473 [00:06<00:53, 126.94it/s]  9%|██████▎                                                               | 671/7473 [00:06<00:53, 127.05it/s]  9%|██████▍                                                               | 684/7473 [00:06<00:53, 125.75it/s]  9%|██████▌                                                               | 697/7473 [00:06<00:54, 123.99it/s] 10%|██████▋                                                               | 710/7473 [00:06<00:55, 122.11it/s] 10%|██████▊                                                               | 723/7473 [00:06<00:54, 123.40it/s] 10%|██████▉                                                               | 736/7473 [00:06<00:54, 124.11it/s] 10%|███████                                                               | 749/7473 [00:06<00:54, 123.74it/s] 10%|███████▏                                                              | 762/7473 [00:07<00:53, 124.46it/s] 10%|███████▎                                                              | 775/7473 [00:07<00:53, 125.23it/s] 11%|███████▍                                                              | 788/7473 [00:07<00:53, 125.78it/s] 11%|███████▌                                                              | 801/7473 [00:07<00:52, 126.20it/s] 11%|███████▌                                                              | 814/7473 [00:07<00:52, 126.03it/s] 11%|███████▋                                                              | 827/7473 [00:07<00:52, 126.23it/s] 11%|███████▊                                                              | 840/7473 [00:07<00:52, 126.53it/s] 11%|███████▉                                                              | 853/7473 [00:07<00:52, 126.85it/s] 12%|████████                                                              | 866/7473 [00:07<00:52, 126.82it/s] 12%|████████▏                                                             | 879/7473 [00:07<00:52, 126.79it/s] 12%|████████▎                                                             | 892/7473 [00:08<00:51, 126.93it/s] 12%|████████▍                                                             | 905/7473 [00:08<00:51, 127.00it/s] 12%|████████▌                                                             | 918/7473 [00:08<00:51, 127.05it/s] 12%|████████▋                                                             | 931/7473 [00:08<00:52, 125.14it/s] 13%|████████▊                                                             | 944/7473 [00:08<00:52, 124.81it/s] 13%|████████▉                                                             | 957/7473 [00:08<00:52, 125.20it/s] 13%|█████████                                                             | 970/7473 [00:08<00:51, 125.89it/s] 13%|█████████▏                                                            | 983/7473 [00:08<00:51, 126.32it/s] 13%|█████████▎                                                            | 996/7473 [00:08<00:51, 126.34it/s] 14%|█████████▎                                                           | 1009/7473 [00:09<00:51, 125.11it/s] 14%|█████████▍                                                           | 1022/7473 [00:09<00:51, 125.40it/s] 14%|█████████▌                                                           | 1035/7473 [00:09<00:51, 125.83it/s] 14%|█████████▋                                                           | 1048/7473 [00:09<00:50, 126.25it/s] 14%|█████████▊                                                           | 1061/7473 [00:09<00:50, 126.57it/s] 14%|█████████▉                                                           | 1074/7473 [00:09<00:50, 126.04it/s] 15%|██████████                                                           | 1087/7473 [00:09<00:50, 126.49it/s] 15%|██████████▏                                                          | 1100/7473 [00:09<00:50, 126.54it/s] 15%|██████████▎                                                          | 1113/7473 [00:09<00:50, 126.53it/s] 15%|██████████▍                                                          | 1126/7473 [00:09<00:50, 126.61it/s] 15%|██████████▌                                                          | 1139/7473 [00:10<00:49, 126.74it/s] 15%|██████████▋                                                          | 1152/7473 [00:10<00:49, 126.81it/s] 16%|██████████▊                                                          | 1165/7473 [00:10<00:50, 124.92it/s] 16%|██████████▉                                                          | 1178/7473 [00:10<00:50, 125.05it/s] 16%|██████████▉                                                          | 1191/7473 [00:10<00:50, 124.76it/s] 16%|███████████                                                          | 1204/7473 [00:10<00:50, 124.82it/s] 16%|███████████▏                                                         | 1217/7473 [00:10<00:50, 125.08it/s] 16%|███████████▎                                                         | 1230/7473 [00:10<00:49, 125.10it/s] 17%|███████████▍                                                         | 1243/7473 [00:10<00:49, 125.20it/s] 17%|███████████▌                                                         | 1256/7473 [00:10<00:49, 125.27it/s] 17%|███████████▋                                                         | 1269/7473 [00:11<00:49, 125.28it/s] 17%|███████████▊                                                         | 1282/7473 [00:11<00:49, 125.05it/s] 17%|███████████▉                                                         | 1295/7473 [00:11<00:49, 124.75it/s] 18%|████████████                                                         | 1308/7473 [00:11<00:49, 124.86it/s] 18%|████████████▏                                                        | 1321/7473 [00:11<00:49, 124.69it/s] 18%|████████████▎                                                        | 1334/7473 [00:11<00:49, 124.74it/s] 18%|████████████▍                                                        | 1347/7473 [00:11<00:49, 124.42it/s] 18%|████████████▌                                                        | 1360/7473 [00:11<00:49, 124.55it/s] 18%|████████████▋                                                        | 1373/7473 [00:11<00:48, 124.74it/s] 19%|████████████▊                                                        | 1386/7473 [00:12<00:49, 123.09it/s] 19%|████████████▉                                                        | 1399/7473 [00:12<00:49, 123.44it/s] 19%|█████████████                                                        | 1412/7473 [00:12<00:48, 123.90it/s] 19%|█████████████▏                                                       | 1425/7473 [00:12<00:48, 124.08it/s] 19%|█████████████▎                                                       | 1438/7473 [00:12<00:48, 124.27it/s] 19%|█████████████▍                                                       | 1451/7473 [00:12<00:48, 124.17it/s] 20%|█████████████▌                                                       | 1464/7473 [00:12<00:48, 124.10it/s] 20%|█████████████▋                                                       | 1477/7473 [00:12<00:48, 123.80it/s] 20%|█████████████▊                                                       | 1490/7473 [00:12<00:48, 122.42it/s] 20%|█████████████▉                                                       | 1503/7473 [00:12<00:48, 122.49it/s] 20%|█████████████▉                                                       | 1516/7473 [00:13<00:48, 123.48it/s] 20%|██████████████                                                       | 1529/7473 [00:13<00:47, 123.99it/s] 21%|██████████████▏                                                      | 1542/7473 [00:13<00:47, 123.99it/s] 21%|██████████████▎                                                      | 1555/7473 [00:13<00:47, 124.06it/s] 21%|██████████████▍                                                      | 1568/7473 [00:13<00:47, 124.06it/s] 21%|██████████████▌                                                      | 1581/7473 [00:13<00:47, 124.11it/s] 21%|██████████████▋                                                      | 1594/7473 [00:13<00:47, 124.33it/s] 22%|██████████████▊                                                      | 1607/7473 [00:13<00:47, 124.52it/s] 22%|██████████████▉                                                      | 1620/7473 [00:13<00:47, 123.01it/s] 22%|███████████████                                                      | 1633/7473 [00:14<00:47, 122.21it/s] 22%|███████████████▏                                                     | 1646/7473 [00:14<00:47, 122.61it/s] 22%|███████████████▎                                                     | 1659/7473 [00:14<00:47, 123.05it/s] 22%|███████████████▍                                                     | 1672/7473 [00:14<00:46, 123.74it/s] 23%|███████████████▌                                                     | 1685/7473 [00:14<00:46, 124.01it/s] 23%|███████████████▋                                                     | 1698/7473 [00:14<00:46, 124.41it/s] 23%|███████████████▊                                                     | 1711/7473 [00:14<00:46, 124.25it/s] 23%|███████████████▉                                                     | 1724/7473 [00:14<00:46, 124.71it/s] 23%|████████████████                                                     | 1737/7473 [00:14<00:45, 124.90it/s] 23%|████████████████▏                                                    | 1750/7473 [00:14<00:45, 124.78it/s] 24%|████████████████▎                                                    | 1763/7473 [00:15<00:45, 124.73it/s] 24%|████████████████▍                                                    | 1776/7473 [00:15<00:45, 124.81it/s] 24%|████████████████▌                                                    | 1789/7473 [00:15<00:45, 124.77it/s] 24%|████████████████▋                                                    | 1802/7473 [00:15<00:45, 124.91it/s] 24%|████████████████▊                                                    | 1815/7473 [00:15<00:45, 125.23it/s] 24%|████████████████▉                                                    | 1828/7473 [00:15<00:45, 124.63it/s] 25%|████████████████▉                                                    | 1841/7473 [00:15<00:45, 123.24it/s] 25%|█████████████████                                                    | 1854/7473 [00:15<00:45, 123.70it/s] 25%|█████████████████▏                                                   | 1867/7473 [00:15<00:45, 124.26it/s] 25%|█████████████████▎                                                   | 1880/7473 [00:16<00:44, 124.57it/s] 25%|█████████████████▍                                                   | 1893/7473 [00:16<00:44, 124.64it/s] 26%|█████████████████▌                                                   | 1906/7473 [00:16<00:44, 124.08it/s] 26%|█████████████████▋                                                   | 1919/7473 [00:16<00:45, 123.32it/s] 26%|█████████████████▊                                                   | 1932/7473 [00:16<00:44, 123.84it/s] 26%|█████████████████▉                                                   | 1945/7473 [00:16<00:44, 124.15it/s] 26%|██████████████████                                                   | 1958/7473 [00:16<00:44, 124.82it/s] 26%|██████████████████▏                                                  | 1971/7473 [00:16<00:43, 125.49it/s] 27%|██████████████████▎                                                  | 1984/7473 [00:16<00:43, 125.95it/s] 27%|██████████████████▍                                                  | 1997/7473 [00:16<00:43, 126.16it/s] 27%|██████████████████▌                                                  | 2010/7473 [00:17<00:43, 126.18it/s] 27%|██████████████████▋                                                  | 2023/7473 [00:17<00:43, 126.50it/s] 27%|██████████████████▊                                                  | 2036/7473 [00:17<00:42, 126.52it/s] 27%|██████████████████▉                                                  | 2049/7473 [00:17<00:42, 126.50it/s] 28%|███████████████████                                                  | 2062/7473 [00:17<00:42, 126.65it/s] 28%|███████████████████▏                                                 | 2075/7473 [00:17<00:43, 124.46it/s] 28%|███████████████████▎                                                 | 2088/7473 [00:17<00:43, 125.22it/s] 28%|███████████████████▍                                                 | 2101/7473 [00:17<00:42, 125.91it/s] 28%|███████████████████▌                                                 | 2114/7473 [00:17<00:42, 125.82it/s] 28%|███████████████████▋                                                 | 2127/7473 [00:17<00:42, 124.76it/s] 29%|███████████████████▊                                                 | 2140/7473 [00:18<00:42, 125.37it/s] 29%|███████████████████▉                                                 | 2153/7473 [00:18<00:42, 125.89it/s] 29%|███████████████████▉                                                 | 2166/7473 [00:18<00:42, 125.75it/s] 29%|████████████████████                                                 | 2179/7473 [00:18<00:42, 125.79it/s] 29%|████████████████████▏                                                | 2192/7473 [00:18<00:41, 125.94it/s] 30%|████████████████████▎                                                | 2205/7473 [00:18<00:41, 126.38it/s] 30%|████████████████████▍                                                | 2218/7473 [00:18<00:41, 126.76it/s] 30%|████████████████████▌                                                | 2231/7473 [00:18<00:41, 126.33it/s] 30%|████████████████████▋                                                | 2244/7473 [00:18<00:41, 126.38it/s] 30%|████████████████████▊                                                | 2257/7473 [00:19<00:41, 126.49it/s] 30%|████████████████████▉                                                | 2270/7473 [00:19<00:41, 126.58it/s] 31%|█████████████████████                                                | 2283/7473 [00:19<00:41, 126.13it/s] 31%|█████████████████████▏                                               | 2296/7473 [00:19<00:41, 124.63it/s] 31%|█████████████████████▎                                               | 2309/7473 [00:19<00:41, 125.11it/s] 31%|█████████████████████▍                                               | 2322/7473 [00:19<00:41, 125.43it/s] 31%|█████████████████████▌                                               | 2335/7473 [00:19<00:41, 125.11it/s] 31%|█████████████████████▋                                               | 2348/7473 [00:19<00:41, 124.27it/s] 32%|█████████████████████▊                                               | 2361/7473 [00:19<00:40, 125.16it/s] 32%|█████████████████████▉                                               | 2374/7473 [00:19<00:40, 125.57it/s] 32%|██████████████████████                                               | 2387/7473 [00:20<00:40, 125.52it/s] 32%|██████████████████████▏                                              | 2400/7473 [00:20<00:40, 125.89it/s] 32%|██████████████████████▎                                              | 2413/7473 [00:20<00:40, 126.17it/s] 32%|██████████████████████▍                                              | 2426/7473 [00:20<00:39, 126.38it/s] 33%|██████████████████████▌                                              | 2439/7473 [00:20<00:40, 125.66it/s] 33%|██████████████████████▋                                              | 2452/7473 [00:20<00:39, 125.75it/s] 33%|██████████████████████▊                                              | 2465/7473 [00:20<00:39, 125.97it/s] 33%|██████████████████████▉                                              | 2478/7473 [00:20<00:39, 126.29it/s] 33%|███████████████████████                                              | 2491/7473 [00:20<00:39, 126.06it/s] 34%|███████████████████████                                              | 2504/7473 [00:20<00:39, 126.20it/s] 34%|███████████████████████▏                                             | 2517/7473 [00:21<00:39, 126.20it/s] 34%|███████████████████████▎                                             | 2530/7473 [00:21<00:46, 105.77it/s] 34%|███████████████████████▍                                             | 2543/7473 [00:21<00:44, 110.84it/s] 34%|███████████████████████▌                                             | 2556/7473 [00:21<00:43, 113.76it/s] 34%|███████████████████████▋                                             | 2569/7473 [00:21<00:42, 116.60it/s] 35%|███████████████████████▊                                             | 2582/7473 [00:21<00:40, 119.57it/s] 35%|███████████████████████▉                                             | 2595/7473 [00:21<00:40, 121.10it/s] 35%|████████████████████████                                             | 2608/7473 [00:21<00:39, 122.50it/s] 35%|████████████████████████▏                                            | 2621/7473 [00:21<00:39, 123.70it/s] 35%|████████████████████████▎                                            | 2634/7473 [00:22<00:38, 124.30it/s] 35%|████████████████████████▍                                            | 2647/7473 [00:22<00:38, 125.01it/s] 36%|████████████████████████▌                                            | 2660/7473 [00:22<00:38, 125.70it/s] 36%|████████████████████████▋                                            | 2673/7473 [00:22<00:38, 126.07it/s] 36%|████████████████████████▊                                            | 2686/7473 [00:22<00:37, 126.25it/s] 36%|████████████████████████▉                                            | 2699/7473 [00:22<00:37, 125.86it/s] 36%|█████████████████████████                                            | 2712/7473 [00:22<00:37, 126.33it/s] 36%|█████████████████████████▏                                           | 2725/7473 [00:22<00:37, 126.39it/s] 37%|█████████████████████████▎                                           | 2738/7473 [00:22<00:37, 126.14it/s] 37%|█████████████████████████▍                                           | 2751/7473 [00:23<00:37, 124.70it/s] 37%|█████████████████████████▌                                           | 2764/7473 [00:23<00:37, 125.32it/s] 37%|█████████████████████████▋                                           | 2777/7473 [00:23<00:37, 125.87it/s] 37%|█████████████████████████▊                                           | 2790/7473 [00:23<00:37, 126.17it/s] 38%|█████████████████████████▉                                           | 2803/7473 [00:23<00:37, 125.63it/s] 38%|██████████████████████████                                           | 2816/7473 [00:23<00:37, 125.79it/s] 38%|██████████████████████████                                           | 2829/7473 [00:23<00:37, 124.81it/s] 38%|██████████████████████████▏                                          | 2842/7473 [00:23<00:37, 124.98it/s] 38%|██████████████████████████▎                                          | 2855/7473 [00:23<00:36, 125.04it/s] 38%|██████████████████████████▍                                          | 2868/7473 [00:23<00:36, 124.93it/s] 39%|██████████████████████████▌                                          | 2881/7473 [00:24<00:36, 124.94it/s] 39%|██████████████████████████▋                                          | 2894/7473 [00:24<00:36, 124.94it/s] 39%|██████████████████████████▊                                          | 2907/7473 [00:24<00:36, 125.50it/s] 39%|██████████████████████████▉                                          | 2920/7473 [00:24<00:36, 125.85it/s] 39%|███████████████████████████                                          | 2933/7473 [00:24<00:35, 126.34it/s] 39%|███████████████████████████▏                                         | 2946/7473 [00:24<00:35, 126.03it/s] 40%|███████████████████████████▎                                         | 2959/7473 [00:24<00:36, 125.33it/s] 40%|███████████████████████████▍                                         | 2972/7473 [00:24<00:35, 125.16it/s] 40%|███████████████████████████▌                                         | 2985/7473 [00:24<00:36, 124.13it/s] 40%|███████████████████████████▋                                         | 2998/7473 [00:24<00:36, 124.21it/s] 40%|███████████████████████████▊                                         | 3011/7473 [00:25<00:35, 124.26it/s] 40%|███████████████████████████▉                                         | 3024/7473 [00:25<00:35, 124.50it/s] 41%|████████████████████████████                                         | 3037/7473 [00:25<00:35, 125.14it/s] 41%|████████████████████████████▏                                        | 3050/7473 [00:25<00:35, 124.99it/s] 41%|████████████████████████████▎                                        | 3063/7473 [00:25<00:35, 125.34it/s] 41%|████████████████████████████▍                                        | 3076/7473 [00:25<00:35, 125.33it/s] 41%|████████████████████████████▌                                        | 3089/7473 [00:25<00:34, 125.70it/s] 42%|████████████████████████████▋                                        | 3102/7473 [00:25<00:34, 125.13it/s] 42%|████████████████████████████▊                                        | 3115/7473 [00:25<00:34, 124.55it/s] 42%|████████████████████████████▉                                        | 3128/7473 [00:26<00:34, 125.01it/s] 42%|█████████████████████████████                                        | 3141/7473 [00:26<00:34, 125.05it/s] 42%|█████████████████████████████                                        | 3154/7473 [00:26<00:34, 125.21it/s] 42%|█████████████████████████████▏                                       | 3167/7473 [00:26<00:34, 125.46it/s] 43%|█████████████████████████████▎                                       | 3180/7473 [00:26<00:34, 125.72it/s] 43%|█████████████████████████████▍                                       | 3193/7473 [00:26<00:33, 125.96it/s] 43%|█████████████████████████████▌                                       | 3206/7473 [00:26<00:34, 124.54it/s] 43%|█████████████████████████████▋                                       | 3219/7473 [00:26<00:34, 124.87it/s] 43%|█████████████████████████████▊                                       | 3232/7473 [00:26<00:33, 125.29it/s] 43%|█████████████████████████████▉                                       | 3245/7473 [00:26<00:33, 125.73it/s] 44%|██████████████████████████████                                       | 3258/7473 [00:27<00:33, 125.66it/s] 44%|██████████████████████████████▏                                      | 3271/7473 [00:27<00:33, 125.25it/s] 44%|██████████████████████████████▎                                      | 3284/7473 [00:27<00:33, 125.43it/s] 44%|██████████████████████████████▍                                      | 3297/7473 [00:27<00:33, 125.49it/s] 44%|██████████████████████████████▌                                      | 3310/7473 [00:27<00:33, 125.21it/s] 44%|██████████████████████████████▋                                      | 3323/7473 [00:27<00:33, 125.58it/s] 45%|██████████████████████████████▊                                      | 3336/7473 [00:27<00:33, 124.96it/s] 45%|██████████████████████████████▉                                      | 3349/7473 [00:27<00:32, 125.47it/s] 45%|███████████████████████████████                                      | 3362/7473 [00:27<00:32, 125.66it/s] 45%|███████████████████████████████▏                                     | 3375/7473 [00:28<00:32, 125.38it/s] 45%|███████████████████████████████▎                                     | 3388/7473 [00:28<00:32, 125.57it/s] 46%|███████████████████████████████▍                                     | 3401/7473 [00:28<00:32, 125.74it/s] 46%|███████████████████████████████▌                                     | 3414/7473 [00:28<00:32, 125.40it/s] 46%|███████████████████████████████▋                                     | 3427/7473 [00:28<00:32, 124.03it/s] 46%|███████████████████████████████▊                                     | 3440/7473 [00:28<00:32, 124.66it/s] 46%|███████████████████████████████▉                                     | 3453/7473 [00:28<00:32, 125.01it/s] 46%|████████████████████████████████                                     | 3466/7473 [00:28<00:31, 125.22it/s] 47%|████████████████████████████████                                     | 3479/7473 [00:28<00:31, 125.37it/s] 47%|████████████████████████████████▏                                    | 3492/7473 [00:28<00:31, 125.74it/s] 47%|████████████████████████████████▎                                    | 3505/7473 [00:29<00:31, 126.07it/s] 47%|████████████████████████████████▍                                    | 3518/7473 [00:29<00:31, 125.85it/s] 47%|████████████████████████████████▌                                    | 3531/7473 [00:29<00:31, 125.83it/s] 47%|████████████████████████████████▋                                    | 3544/7473 [00:29<00:31, 125.98it/s] 48%|████████████████████████████████▊                                    | 3557/7473 [00:29<00:31, 126.13it/s] 48%|████████████████████████████████▉                                    | 3570/7473 [00:29<00:30, 126.05it/s] 48%|█████████████████████████████████                                    | 3583/7473 [00:29<00:31, 125.10it/s] 48%|█████████████████████████████████▏                                   | 3596/7473 [00:29<00:31, 124.39it/s] 48%|█████████████████████████████████▎                                   | 3609/7473 [00:29<00:31, 123.76it/s] 48%|█████████████████████████████████▍                                   | 3622/7473 [00:29<00:31, 124.16it/s] 49%|█████████████████████████████████▌                                   | 3635/7473 [00:30<00:30, 124.35it/s] 49%|█████████████████████████████████▋                                   | 3648/7473 [00:30<00:30, 124.71it/s] 49%|█████████████████████████████████▊                                   | 3661/7473 [00:30<00:30, 123.57it/s] 49%|█████████████████████████████████▉                                   | 3674/7473 [00:30<00:30, 123.66it/s] 49%|██████████████████████████████████                                   | 3687/7473 [00:30<00:30, 124.26it/s] 50%|██████████████████████████████████▏                                  | 3700/7473 [00:30<00:30, 124.68it/s] 50%|██████████████████████████████████▎                                  | 3713/7473 [00:30<00:30, 125.04it/s] 50%|██████████████████████████████████▍                                  | 3726/7473 [00:30<00:29, 125.00it/s] 50%|██████████████████████████████████▌                                  | 3739/7473 [00:30<00:29, 124.47it/s] 50%|██████████████████████████████████▋                                  | 3752/7473 [00:31<00:29, 124.39it/s] 50%|██████████████████████████████████▊                                  | 3765/7473 [00:31<00:29, 124.84it/s] 51%|██████████████████████████████████▉                                  | 3778/7473 [00:31<00:29, 125.03it/s] 51%|███████████████████████████████████                                  | 3791/7473 [00:31<00:29, 125.37it/s] 51%|███████████████████████████████████                                  | 3804/7473 [00:31<00:29, 125.79it/s] 51%|███████████████████████████████████▏                                 | 3817/7473 [00:31<00:28, 126.11it/s] 51%|███████████████████████████████████▎                                 | 3830/7473 [00:31<00:28, 125.64it/s] 51%|███████████████████████████████████▍                                 | 3843/7473 [00:31<00:28, 125.55it/s] 52%|███████████████████████████████████▌                                 | 3856/7473 [00:31<00:28, 125.58it/s] 52%|███████████████████████████████████▋                                 | 3869/7473 [00:31<00:28, 125.55it/s] 52%|███████████████████████████████████▊                                 | 3882/7473 [00:32<00:29, 123.31it/s] 52%|███████████████████████████████████▉                                 | 3895/7473 [00:32<00:28, 123.95it/s] 52%|████████████████████████████████████                                 | 3908/7473 [00:32<00:28, 124.64it/s] 52%|████████████████████████████████████▏                                | 3921/7473 [00:32<00:28, 125.13it/s] 53%|████████████████████████████████████▎                                | 3934/7473 [00:32<00:28, 124.65it/s] 53%|████████████████████████████████████▍                                | 3947/7473 [00:32<00:28, 125.14it/s] 53%|████████████████████████████████████▌                                | 3960/7473 [00:32<00:27, 125.54it/s] 53%|████████████████████████████████████▋                                | 3973/7473 [00:32<00:27, 125.52it/s] 53%|████████████████████████████████████▊                                | 3986/7473 [00:32<00:27, 125.44it/s] 54%|████████████████████████████████████▉                                | 3999/7473 [00:32<00:27, 125.56it/s] 54%|█████████████████████████████████████                                | 4012/7473 [00:33<00:27, 125.26it/s] 54%|█████████████████████████████████████▏                               | 4025/7473 [00:33<00:27, 124.99it/s] 54%|█████████████████████████████████████▎                               | 4038/7473 [00:33<00:27, 125.27it/s] 54%|█████████████████████████████████████▍                               | 4051/7473 [00:33<00:27, 125.51it/s] 54%|█████████████████████████████████████▌                               | 4064/7473 [00:33<00:27, 125.90it/s] 55%|█████████████████████████████████████▋                               | 4077/7473 [00:33<00:27, 125.69it/s] 55%|█████████████████████████████████████▊                               | 4090/7473 [00:33<00:26, 125.44it/s] 55%|█████████████████████████████████████▉                               | 4103/7473 [00:33<00:26, 125.45it/s] 55%|██████████████████████████████████████                               | 4116/7473 [00:33<00:27, 123.88it/s] 55%|██████████████████████████████████████                               | 4129/7473 [00:34<00:26, 124.02it/s] 55%|██████████████████████████████████████▏                              | 4142/7473 [00:34<00:26, 123.43it/s] 56%|██████████████████████████████████████▎                              | 4155/7473 [00:34<00:26, 123.57it/s] 56%|██████████████████████████████████████▍                              | 4168/7473 [00:34<00:26, 124.39it/s] 56%|██████████████████████████████████████▌                              | 4181/7473 [00:34<00:26, 124.75it/s] 56%|██████████████████████████████████████▋                              | 4194/7473 [00:34<00:26, 125.00it/s] 56%|██████████████████████████████████████▊                              | 4207/7473 [00:34<00:26, 124.89it/s] 56%|██████████████████████████████████████▉                              | 4220/7473 [00:34<00:25, 125.28it/s] 57%|███████████████████████████████████████                              | 4233/7473 [00:34<00:25, 125.43it/s] 57%|███████████████████████████████████████▏                             | 4246/7473 [00:34<00:25, 125.53it/s] 57%|███████████████████████████████████████▎                             | 4259/7473 [00:35<00:25, 125.79it/s] 57%|███████████████████████████████████████▍                             | 4272/7473 [00:35<00:25, 124.94it/s] 57%|███████████████████████████████████████▌                             | 4285/7473 [00:35<00:25, 124.13it/s] 58%|███████████████████████████████████████▋                             | 4298/7473 [00:35<00:25, 124.62it/s] 58%|███████████████████████████████████████▊                             | 4311/7473 [00:35<00:25, 125.14it/s] 58%|███████████████████████████████████████▉                             | 4324/7473 [00:35<00:25, 125.63it/s] 58%|████████████████████████████████████████                             | 4337/7473 [00:35<00:25, 123.62it/s] 58%|████████████████████████████████████████▏                            | 4350/7473 [00:35<00:25, 124.33it/s] 58%|████████████████████████████████████████▎                            | 4363/7473 [00:35<00:24, 124.82it/s] 59%|████████████████████████████████████████▍                            | 4376/7473 [00:36<00:24, 125.19it/s] 59%|████████████████████████████████████████▌                            | 4389/7473 [00:36<00:24, 125.02it/s] 59%|████████████████████████████████████████▋                            | 4402/7473 [00:36<00:24, 125.38it/s] 59%|████████████████████████████████████████▊                            | 4415/7473 [00:36<00:24, 125.37it/s] 59%|████████████████████████████████████████▉                            | 4428/7473 [00:36<00:24, 124.98it/s] 59%|█████████████████████████████████████████                            | 4441/7473 [00:36<00:24, 125.03it/s] 60%|█████████████████████████████████████████                            | 4454/7473 [00:36<00:24, 124.74it/s] 60%|█████████████████████████████████████████▏                           | 4467/7473 [00:36<00:24, 125.23it/s] 60%|█████████████████████████████████████████▎                           | 4480/7473 [00:36<00:24, 124.25it/s] 60%|█████████████████████████████████████████▍                           | 4493/7473 [00:36<00:23, 124.51it/s] 60%|█████████████████████████████████████████▌                           | 4506/7473 [00:37<00:23, 124.79it/s] 60%|█████████████████████████████████████████▋                           | 4519/7473 [00:37<00:23, 124.96it/s] 61%|█████████████████████████████████████████▊                           | 4532/7473 [00:37<00:23, 125.25it/s] 61%|█████████████████████████████████████████▉                           | 4545/7473 [00:37<00:23, 125.15it/s] 61%|██████████████████████████████████████████                           | 4558/7473 [00:37<00:23, 125.04it/s] 61%|██████████████████████████████████████████▏                          | 4571/7473 [00:37<00:23, 123.76it/s] 61%|██████████████████████████████████████████▎                          | 4584/7473 [00:37<00:23, 124.34it/s] 62%|██████████████████████████████████████████▍                          | 4597/7473 [00:37<00:23, 124.31it/s] 62%|██████████████████████████████████████████▌                          | 4610/7473 [00:37<00:22, 124.99it/s] 62%|██████████████████████████████████████████▋                          | 4623/7473 [00:37<00:22, 125.24it/s] 62%|██████████████████████████████████████████▊                          | 4636/7473 [00:38<00:22, 125.11it/s] 62%|██████████████████████████████████████████▉                          | 4649/7473 [00:38<00:22, 125.17it/s] 62%|███████████████████████████████████████████                          | 4662/7473 [00:38<00:22, 125.53it/s] 63%|███████████████████████████████████████████▏                         | 4675/7473 [00:38<00:22, 125.03it/s] 63%|███████████████████████████████████████████▎                         | 4688/7473 [00:38<00:22, 124.80it/s] 63%|███████████████████████████████████████████▍                         | 4701/7473 [00:38<00:22, 124.70it/s] 63%|███████████████████████████████████████████▌                         | 4714/7473 [00:38<00:22, 125.17it/s] 63%|███████████████████████████████████████████▋                         | 4727/7473 [00:38<00:21, 125.53it/s] 63%|███████████████████████████████████████████▊                         | 4740/7473 [00:38<00:21, 125.54it/s] 64%|███████████████████████████████████████████▉                         | 4753/7473 [00:39<00:21, 125.64it/s] 64%|████████████████████████████████████████████                         | 4766/7473 [00:39<00:21, 124.89it/s] 64%|████████████████████████████████████████████▏                        | 4779/7473 [00:39<00:21, 124.84it/s] 64%|████████████████████████████████████████████▏                        | 4792/7473 [00:39<00:21, 123.39it/s] 64%|████████████████████████████████████████████▎                        | 4805/7473 [00:39<00:21, 123.91it/s] 64%|████████████████████████████████████████████▍                        | 4818/7473 [00:39<00:21, 124.59it/s] 65%|████████████████████████████████████████████▌                        | 4831/7473 [00:39<00:21, 125.15it/s] 65%|████████████████████████████████████████████▋                        | 4844/7473 [00:39<00:21, 124.83it/s] 65%|████████████████████████████████████████████▊                        | 4857/7473 [00:39<00:20, 124.92it/s] 65%|████████████████████████████████████████████▉                        | 4870/7473 [00:39<00:20, 125.19it/s] 65%|█████████████████████████████████████████████                        | 4883/7473 [00:40<00:20, 125.42it/s] 66%|█████████████████████████████████████████████▏                       | 4896/7473 [00:40<00:20, 125.61it/s] 66%|█████████████████████████████████████████████▎                       | 4909/7473 [00:40<00:20, 125.73it/s] 66%|█████████████████████████████████████████████▍                       | 4922/7473 [00:40<00:20, 125.75it/s] 66%|█████████████████████████████████████████████▌                       | 4935/7473 [00:40<00:20, 125.53it/s] 66%|█████████████████████████████████████████████▋                       | 4948/7473 [00:40<00:20, 124.61it/s] 66%|█████████████████████████████████████████████▊                       | 4961/7473 [00:40<00:20, 124.58it/s] 67%|█████████████████████████████████████████████▉                       | 4974/7473 [00:40<00:20, 124.80it/s] 67%|██████████████████████████████████████████████                       | 4987/7473 [00:40<00:19, 125.02it/s] 67%|██████████████████████████████████████████████▏                      | 5000/7473 [00:41<00:19, 125.30it/s] 67%|██████████████████████████████████████████████▎                      | 5013/7473 [00:41<00:19, 125.63it/s] 67%|██████████████████████████████████████████████▍                      | 5026/7473 [00:41<00:19, 124.22it/s] 67%|██████████████████████████████████████████████▌                      | 5039/7473 [00:41<00:19, 123.58it/s] 68%|██████████████████████████████████████████████▋                      | 5052/7473 [00:41<00:19, 124.07it/s] 68%|██████████████████████████████████████████████▊                      | 5065/7473 [00:41<00:19, 124.84it/s] 68%|██████████████████████████████████████████████▉                      | 5078/7473 [00:41<00:19, 125.00it/s] 68%|███████████████████████████████████████████████                      | 5091/7473 [00:41<00:19, 123.98it/s] 68%|███████████████████████████████████████████████▏                     | 5104/7473 [00:41<00:19, 123.85it/s] 68%|███████████████████████████████████████████████▏                     | 5117/7473 [00:41<00:18, 124.02it/s] 69%|███████████████████████████████████████████████▎                     | 5130/7473 [00:42<00:18, 124.02it/s] 69%|███████████████████████████████████████████████▍                     | 5143/7473 [00:42<00:18, 124.45it/s] 69%|███████████████████████████████████████████████▌                     | 5156/7473 [00:42<00:18, 125.12it/s] 69%|███████████████████████████████████████████████▋                     | 5169/7473 [00:42<00:18, 125.31it/s] 69%|███████████████████████████████████████████████▊                     | 5182/7473 [00:42<00:18, 125.60it/s] 70%|███████████████████████████████████████████████▉                     | 5195/7473 [00:42<00:18, 125.65it/s] 70%|████████████████████████████████████████████████                     | 5208/7473 [00:42<00:18, 125.76it/s] 70%|████████████████████████████████████████████████▏                    | 5221/7473 [00:42<00:17, 125.84it/s] 70%|████████████████████████████████████████████████▎                    | 5234/7473 [00:42<00:17, 125.67it/s] 70%|████████████████████████████████████████████████▍                    | 5247/7473 [00:43<00:20, 108.06it/s] 70%|████████████████████████████████████████████████▌                    | 5260/7473 [00:43<00:19, 111.96it/s] 71%|████████████████████████████████████████████████▋                    | 5273/7473 [00:43<00:19, 115.65it/s] 71%|████████████████████████████████████████████████▊                    | 5286/7473 [00:43<00:18, 118.30it/s] 71%|████████████████████████████████████████████████▉                    | 5299/7473 [00:43<00:18, 119.33it/s] 71%|█████████████████████████████████████████████████                    | 5312/7473 [00:43<00:17, 121.19it/s] 71%|█████████████████████████████████████████████████▏                   | 5325/7473 [00:43<00:17, 122.12it/s] 71%|█████████████████████████████████████████████████▎                   | 5338/7473 [00:43<00:17, 122.96it/s] 72%|█████████████████████████████████████████████████▍                   | 5351/7473 [00:43<00:17, 123.79it/s] 72%|█████████████████████████████████████████████████▌                   | 5364/7473 [00:43<00:17, 123.53it/s] 72%|█████████████████████████████████████████████████▋                   | 5377/7473 [00:44<00:16, 123.80it/s] 72%|█████████████████████████████████████████████████▊                   | 5390/7473 [00:44<00:16, 124.50it/s] 72%|█████████████████████████████████████████████████▉                   | 5403/7473 [00:44<00:16, 124.98it/s] 72%|██████████████████████████████████████████████████                   | 5416/7473 [00:44<00:16, 124.79it/s] 73%|██████████████████████████████████████████████████▏                  | 5429/7473 [00:44<00:16, 125.28it/s] 73%|██████████████████████████████████████████████████▏                  | 5442/7473 [00:44<00:16, 125.66it/s] 73%|██████████████████████████████████████████████████▎                  | 5455/7473 [00:44<00:16, 124.93it/s] 73%|██████████████████████████████████████████████████▍                  | 5468/7473 [00:44<00:16, 123.94it/s] 73%|███████████████████████████████████████████████████▎                  | 5481/7473 [00:45<00:27, 72.77it/s] 74%|███████████████████████████████████████████████████▍                  | 5494/7473 [00:45<00:23, 83.15it/s] 74%|███████████████████████████████████████████████████▌                  | 5507/7473 [00:45<00:21, 92.28it/s] 74%|██████████████████████████████████████████████████▉                  | 5520/7473 [00:45<00:19, 100.50it/s] 74%|███████████████████████████████████████████████████                  | 5533/7473 [00:45<00:18, 106.64it/s] 74%|███████████████████████████████████████████████████▏                 | 5546/7473 [00:45<00:17, 110.86it/s] 74%|███████████████████████████████████████████████████▎                 | 5559/7473 [00:45<00:16, 114.98it/s] 75%|███████████████████████████████████████████████████▍                 | 5572/7473 [00:45<00:16, 117.28it/s] 75%|███████████████████████████████████████████████████▌                 | 5585/7473 [00:46<00:15, 118.60it/s] 75%|███████████████████████████████████████████████████▋                 | 5598/7473 [00:46<00:15, 120.69it/s] 75%|███████████████████████████████████████████████████▊                 | 5611/7473 [00:46<00:15, 122.38it/s] 75%|███████████████████████████████████████████████████▉                 | 5624/7473 [00:46<00:15, 123.22it/s] 75%|████████████████████████████████████████████████████                 | 5637/7473 [00:46<00:14, 124.00it/s] 76%|████████████████████████████████████████████████████▏                | 5650/7473 [00:46<00:14, 124.84it/s] 76%|████████████████████████████████████████████████████▎                | 5663/7473 [00:46<00:14, 125.31it/s] 76%|████████████████████████████████████████████████████▍                | 5676/7473 [00:46<00:14, 123.91it/s] 76%|████████████████████████████████████████████████████▌                | 5689/7473 [00:46<00:14, 124.52it/s] 76%|████████████████████████████████████████████████████▋                | 5702/7473 [00:46<00:14, 124.70it/s] 76%|████████████████████████████████████████████████████▊                | 5715/7473 [00:47<00:14, 123.65it/s] 77%|████████████████████████████████████████████████████▉                | 5728/7473 [00:47<00:14, 123.75it/s] 77%|█████████████████████████████████████████████████████                | 5741/7473 [00:47<00:13, 124.46it/s] 77%|█████████████████████████████████████████████████████▏               | 5754/7473 [00:47<00:13, 124.97it/s] 77%|█████████████████████████████████████████████████████▏               | 5767/7473 [00:47<00:13, 125.01it/s] 77%|█████████████████████████████████████████████████████▎               | 5780/7473 [00:47<00:13, 125.37it/s] 78%|█████████████████████████████████████████████████████▍               | 5793/7473 [00:47<00:13, 125.50it/s] 78%|█████████████████████████████████████████████████████▌               | 5806/7473 [00:47<00:13, 125.66it/s] 78%|█████████████████████████████████████████████████████▋               | 5819/7473 [00:47<00:13, 124.26it/s] 78%|█████████████████████████████████████████████████████▊               | 5832/7473 [00:47<00:13, 124.56it/s] 78%|█████████████████████████████████████████████████████▉               | 5845/7473 [00:48<00:13, 123.90it/s] 78%|██████████████████████████████████████████████████████               | 5858/7473 [00:48<00:13, 123.92it/s] 79%|██████████████████████████████████████████████████████▏              | 5871/7473 [00:48<00:12, 124.52it/s] 79%|██████████████████████████████████████████████████████▎              | 5884/7473 [00:48<00:12, 124.93it/s] 79%|██████████████████████████████████████████████████████▍              | 5897/7473 [00:48<00:12, 125.12it/s] 79%|██████████████████████████████████████████████████████▌              | 5910/7473 [00:48<00:12, 123.81it/s] 79%|██████████████████████████████████████████████████████▋              | 5923/7473 [00:48<00:12, 124.13it/s] 79%|██████████████████████████████████████████████████████▊              | 5936/7473 [00:48<00:12, 124.66it/s] 80%|██████████████████████████████████████████████████████▉              | 5949/7473 [00:48<00:12, 124.86it/s] 80%|███████████████████████████████████████████████████████              | 5962/7473 [00:49<00:12, 124.84it/s] 80%|███████████████████████████████████████████████████████▏             | 5975/7473 [00:49<00:12, 124.53it/s] 80%|███████████████████████████████████████████████████████▎             | 5988/7473 [00:49<00:11, 124.29it/s] 80%|███████████████████████████████████████████████████████▍             | 6001/7473 [00:49<00:11, 124.63it/s] 80%|███████████████████████████████████████████████████████▌             | 6014/7473 [00:49<00:11, 124.86it/s] 81%|███████████████████████████████████████████████████████▋             | 6027/7473 [00:49<00:11, 124.80it/s] 81%|███████████████████████████████████████████████████████▊             | 6040/7473 [00:49<00:11, 125.12it/s] 81%|███████████████████████████████████████████████████████▉             | 6053/7473 [00:49<00:11, 125.55it/s] 81%|████████████████████████████████████████████████████████             | 6066/7473 [00:49<00:11, 125.24it/s] 81%|████████████████████████████████████████████████████████▏            | 6079/7473 [00:49<00:11, 125.49it/s] 82%|████████████████████████████████████████████████████████▏            | 6092/7473 [00:50<00:11, 124.56it/s] 82%|████████████████████████████████████████████████████████▎            | 6105/7473 [00:50<00:10, 124.79it/s] 82%|████████████████████████████████████████████████████████▍            | 6118/7473 [00:50<00:10, 123.28it/s] 82%|████████████████████████████████████████████████████████▌            | 6131/7473 [00:50<00:10, 122.06it/s] 82%|████████████████████████████████████████████████████████▋            | 6144/7473 [00:50<00:10, 122.88it/s] 82%|████████████████████████████████████████████████████████▊            | 6157/7473 [00:50<00:10, 123.83it/s] 83%|████████████████████████████████████████████████████████▉            | 6170/7473 [00:50<00:10, 124.35it/s] 83%|█████████████████████████████████████████████████████████            | 6183/7473 [00:50<00:10, 124.69it/s] 83%|█████████████████████████████████████████████████████████▏           | 6196/7473 [00:50<00:10, 125.18it/s] 83%|█████████████████████████████████████████████████████████▎           | 6209/7473 [00:51<00:10, 125.44it/s] 83%|█████████████████████████████████████████████████████████▍           | 6222/7473 [00:51<00:09, 125.37it/s] 83%|█████████████████████████████████████████████████████████▌           | 6235/7473 [00:51<00:09, 125.30it/s] 84%|█████████████████████████████████████████████████████████▋           | 6248/7473 [00:51<00:09, 124.48it/s] 84%|█████████████████████████████████████████████████████████▊           | 6261/7473 [00:51<00:09, 123.84it/s] 84%|█████████████████████████████████████████████████████████▉           | 6274/7473 [00:51<00:09, 124.55it/s] 84%|██████████████████████████████████████████████████████████           | 6287/7473 [00:51<00:09, 124.59it/s] 84%|██████████████████████████████████████████████████████████▏          | 6300/7473 [00:51<00:09, 125.01it/s] 84%|██████████████████████████████████████████████████████████▎          | 6313/7473 [00:51<00:09, 125.14it/s] 85%|██████████████████████████████████████████████████████████▍          | 6326/7473 [00:51<00:09, 125.49it/s] 85%|██████████████████████████████████████████████████████████▌          | 6339/7473 [00:52<00:09, 125.76it/s] 85%|██████████████████████████████████████████████████████████▋          | 6352/7473 [00:52<00:08, 125.66it/s] 85%|██████████████████████████████████████████████████████████▊          | 6365/7473 [00:52<00:08, 124.11it/s] 85%|██████████████████████████████████████████████████████████▉          | 6378/7473 [00:52<00:08, 122.89it/s] 86%|███████████████████████████████████████████████████████████          | 6391/7473 [00:52<00:08, 122.06it/s] 86%|███████████████████████████████████████████████████████████▏         | 6404/7473 [00:52<00:08, 122.57it/s] 86%|███████████████████████████████████████████████████████████▏         | 6417/7473 [00:52<00:08, 123.51it/s] 86%|███████████████████████████████████████████████████████████▎         | 6430/7473 [00:52<00:08, 124.05it/s] 86%|███████████████████████████████████████████████████████████▍         | 6443/7473 [00:52<00:08, 124.57it/s] 86%|███████████████████████████████████████████████████████████▌         | 6456/7473 [00:52<00:08, 124.69it/s] 87%|███████████████████████████████████████████████████████████▋         | 6469/7473 [00:53<00:08, 124.65it/s] 87%|███████████████████████████████████████████████████████████▊         | 6482/7473 [00:53<00:07, 125.08it/s] 87%|███████████████████████████████████████████████████████████▉         | 6495/7473 [00:53<00:07, 125.38it/s] 87%|████████████████████████████████████████████████████████████         | 6508/7473 [00:53<00:07, 125.35it/s] 87%|████████████████████████████████████████████████████████████▏        | 6521/7473 [00:53<00:07, 124.70it/s] 87%|████████████████████████████████████████████████████████████▎        | 6534/7473 [00:53<00:07, 124.35it/s] 88%|████████████████████████████████████████████████████████████▍        | 6547/7473 [00:53<00:07, 124.83it/s] 88%|████████████████████████████████████████████████████████████▌        | 6560/7473 [00:53<00:07, 124.68it/s] 88%|████████████████████████████████████████████████████████████▋        | 6573/7473 [00:53<00:07, 124.98it/s] 88%|████████████████████████████████████████████████████████████▊        | 6586/7473 [00:54<00:07, 123.29it/s] 88%|████████████████████████████████████████████████████████████▉        | 6599/7473 [00:54<00:07, 124.08it/s] 88%|█████████████████████████████████████████████████████████████        | 6612/7473 [00:54<00:06, 124.35it/s] 89%|█████████████████████████████████████████████████████████████▏       | 6625/7473 [00:54<00:06, 124.66it/s] 89%|█████████████████████████████████████████████████████████████▎       | 6638/7473 [00:54<00:06, 124.80it/s] 89%|█████████████████████████████████████████████████████████████▍       | 6651/7473 [00:54<00:06, 123.39it/s] 89%|█████████████████████████████████████████████████████████████▌       | 6664/7473 [00:54<00:06, 122.90it/s] 89%|█████████████████████████████████████████████████████████████▋       | 6677/7473 [00:54<00:06, 123.18it/s] 90%|█████████████████████████████████████████████████████████████▊       | 6690/7473 [00:54<00:06, 123.73it/s] 90%|█████████████████████████████████████████████████████████████▉       | 6703/7473 [00:54<00:06, 123.95it/s] 90%|██████████████████████████████████████████████████████████████       | 6716/7473 [00:55<00:06, 123.69it/s] 90%|██████████████████████████████████████████████████████████████▏      | 6729/7473 [00:55<00:05, 124.51it/s] 90%|██████████████████████████████████████████████████████████████▎      | 6742/7473 [00:55<00:05, 124.83it/s] 90%|██████████████████████████████████████████████████████████████▎      | 6755/7473 [00:55<00:05, 124.57it/s] 91%|██████████████████████████████████████████████████████████████▍      | 6768/7473 [00:55<00:05, 124.67it/s] 91%|██████████████████████████████████████████████████████████████▌      | 6781/7473 [00:55<00:05, 124.99it/s] 91%|██████████████████████████████████████████████████████████████▋      | 6794/7473 [00:55<00:05, 124.84it/s] 91%|██████████████████████████████████████████████████████████████▊      | 6807/7473 [00:55<00:05, 123.37it/s] 91%|██████████████████████████████████████████████████████████████▉      | 6820/7473 [00:55<00:05, 121.81it/s] 91%|███████████████████████████████████████████████████████████████      | 6833/7473 [00:56<00:05, 123.03it/s] 92%|███████████████████████████████████████████████████████████████▏     | 6846/7473 [00:56<00:05, 123.88it/s] 92%|███████████████████████████████████████████████████████████████▎     | 6859/7473 [00:56<00:04, 123.86it/s] 92%|███████████████████████████████████████████████████████████████▍     | 6872/7473 [00:56<00:04, 124.47it/s] 92%|███████████████████████████████████████████████████████████████▌     | 6885/7473 [00:56<00:04, 124.94it/s] 92%|███████████████████████████████████████████████████████████████▋     | 6898/7473 [00:56<00:04, 125.24it/s] 92%|███████████████████████████████████████████████████████████████▊     | 6911/7473 [00:56<00:04, 125.65it/s] 93%|███████████████████████████████████████████████████████████████▉     | 6924/7473 [00:56<00:04, 123.69it/s] 93%|████████████████████████████████████████████████████████████████     | 6937/7473 [00:56<00:04, 124.41it/s] 93%|████████████████████████████████████████████████████████████████▏    | 6950/7473 [00:56<00:04, 124.81it/s] 93%|████████████████████████████████████████████████████████████████▎    | 6963/7473 [00:57<00:04, 124.43it/s] 93%|████████████████████████████████████████████████████████████████▍    | 6976/7473 [00:57<00:04, 124.11it/s] 94%|████████████████████████████████████████████████████████████████▌    | 6989/7473 [00:57<00:03, 124.59it/s] 94%|████████████████████████████████████████████████████████████████▋    | 7002/7473 [00:57<00:03, 125.03it/s] 94%|████████████████████████████████████████████████████████████████▊    | 7015/7473 [00:57<00:03, 125.15it/s] 94%|████████████████████████████████████████████████████████████████▉    | 7028/7473 [00:57<00:03, 124.96it/s] 94%|█████████████████████████████████████████████████████████████████    | 7041/7473 [00:57<00:03, 123.65it/s] 94%|█████████████████████████████████████████████████████████████████▏   | 7054/7473 [00:57<00:03, 124.35it/s] 95%|█████████████████████████████████████████████████████████████████▎   | 7067/7473 [00:57<00:03, 124.38it/s] 95%|█████████████████████████████████████████████████████████████████▎   | 7080/7473 [00:58<00:03, 124.36it/s] 95%|█████████████████████████████████████████████████████████████████▍   | 7093/7473 [00:58<00:03, 124.93it/s] 95%|█████████████████████████████████████████████████████████████████▌   | 7106/7473 [00:58<00:02, 125.18it/s] 95%|█████████████████████████████████████████████████████████████████▋   | 7119/7473 [00:58<00:02, 124.90it/s] 95%|█████████████████████████████████████████████████████████████████▊   | 7132/7473 [00:58<00:02, 124.41it/s] 96%|█████████████████████████████████████████████████████████████████▉   | 7145/7473 [00:58<00:02, 124.77it/s] 96%|██████████████████████████████████████████████████████████████████   | 7158/7473 [00:58<00:02, 125.09it/s] 96%|██████████████████████████████████████████████████████████████████▏  | 7171/7473 [00:58<00:02, 125.37it/s] 96%|██████████████████████████████████████████████████████████████████▎  | 7184/7473 [00:58<00:02, 124.90it/s] 96%|██████████████████████████████████████████████████████████████████▍  | 7197/7473 [00:58<00:02, 124.34it/s] 96%|██████████████████████████████████████████████████████████████████▌  | 7210/7473 [00:59<00:02, 124.84it/s] 97%|██████████████████████████████████████████████████████████████████▋  | 7223/7473 [00:59<00:01, 125.18it/s] 97%|██████████████████████████████████████████████████████████████████▊  | 7236/7473 [00:59<00:01, 125.11it/s] 97%|██████████████████████████████████████████████████████████████████▉  | 7249/7473 [00:59<00:01, 125.20it/s] 97%|███████████████████████████████████████████████████████████████████  | 7262/7473 [00:59<00:01, 124.01it/s] 97%|███████████████████████████████████████████████████████████████████▏ | 7275/7473 [00:59<00:01, 123.89it/s] 98%|███████████████████████████████████████████████████████████████████▎ | 7288/7473 [00:59<00:01, 124.44it/s] 98%|███████████████████████████████████████████████████████████████████▍ | 7301/7473 [00:59<00:01, 124.37it/s] 98%|███████████████████████████████████████████████████████████████████▌ | 7314/7473 [00:59<00:01, 124.26it/s] 98%|███████████████████████████████████████████████████████████████████▋ | 7327/7473 [00:59<00:01, 124.70it/s] 98%|███████████████████████████████████████████████████████████████████▊ | 7340/7473 [01:00<00:01, 124.72it/s] 98%|███████████████████████████████████████████████████████████████████▉ | 7353/7473 [01:00<00:00, 124.25it/s] 99%|████████████████████████████████████████████████████████████████████ | 7366/7473 [01:00<00:00, 124.37it/s] 99%|████████████████████████████████████████████████████████████████████▏| 7379/7473 [01:00<00:00, 124.71it/s] 99%|████████████████████████████████████████████████████████████████████▎| 7392/7473 [01:00<00:00, 125.25it/s] 99%|████████████████████████████████████████████████████████████████████▎| 7405/7473 [01:00<00:00, 124.62it/s] 99%|████████████████████████████████████████████████████████████████████▍| 7418/7473 [01:00<00:00, 124.49it/s] 99%|████████████████████████████████████████████████████████████████████▌| 7431/7473 [01:00<00:00, 124.83it/s]100%|████████████████████████████████████████████████████████████████████▋| 7444/7473 [01:00<00:00, 125.12it/s]100%|████████████████████████████████████████████████████████████████████▊| 7457/7473 [01:01<00:00, 124.12it/s]100%|████████████████████████████████████████████████████████████████████▉| 7470/7473 [01:01<00:00, 124.13it/s]100%|█████████████████████████████████████████████████████████████████████| 7473/7473 [01:01<00:00, 122.18it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                         | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                         | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                         | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                         | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|████████████████▎                                | 1/3 [00:05<00:10,  5.22s/it]Loading checkpoint shards:  33%|████████████████▎                                | 1/3 [00:05<00:11,  5.70s/it]Loading checkpoint shards:  33%|████████████████▎                                | 1/3 [00:05<00:11,  5.53s/it]Loading checkpoint shards:  33%|████████████████▎                                | 1/3 [00:05<00:10,  5.48s/it]Loading checkpoint shards:  67%|████████████████████████████████▋                | 2/3 [00:10<00:05,  5.33s/it]Loading checkpoint shards:  67%|████████████████████████████████▋                | 2/3 [00:11<00:05,  5.58s/it]Loading checkpoint shards:  67%|████████████████████████████████▋                | 2/3 [00:11<00:05,  5.54s/it]Loading checkpoint shards:  67%|████████████████████████████████▋                | 2/3 [00:11<00:05,  5.56s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.79s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.92s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:15<00:00,  4.95s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.13s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.24s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.32s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:16<00:00,  5.41s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:16<00:00,  5.44s/it]
[2023-08-16 04:59:50,610] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
[2023-08-16 05:00:02,864] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-16 05:00:02,866] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-16 05:00:02,866] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-16 05:00:02,866] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-16 05:00:02,867] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-16 05:00:02,867] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-16 05:00:02,867] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-16 05:00:02,867] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-16 05:00:02,867] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-16 05:00:02,868] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-16 05:00:02,868] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-16 05:00:02,868] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f4dafb53070>
[2023-08-16 05:00:02,868] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-16 05:00:02,868] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-16 05:00:02,868] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-16 05:00:02,868] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-16 05:00:02,868] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-16 05:00:02,868] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-16 05:00:02,868] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-16 05:00:02,868] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-16 05:00:02,868] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-16 05:00:02,868] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-16 05:00:02,868] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-16 05:00:02,868] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-16 05:00:02,868] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-16 05:00:02,868] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-16 05:00:02,868] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-16 05:00:02,868] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-16 05:00:02,868] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-16 05:00:02,868] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-16 05:00:02,868] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-16 05:00:02,868] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-16 05:00:02,868] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-16 05:00:02,868] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-16 05:00:02,868] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-16 05:00:02,868] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-16 05:00:02,868] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-16 05:00:02,868] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-16 05:00:02,868] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-16 05:00:02,868] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-16 05:00:02,868] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-16 05:00:02,868] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-16 05:00:02,869] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-16 05:00:02,869] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-16 05:00:02,869] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f4dafb53c10>
[2023-08-16 05:00:02,869] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-16 05:00:02,869] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-16 05:00:02,869] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-16 05:00:02,869] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-16 05:00:02,869] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-16 05:00:02,869] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-16 05:00:02,869] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-16 05:00:02,869] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-16 05:00:02,869] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-16 05:00:02,869] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-16 05:00:02,869] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-16 05:00:02,869] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-16 05:00:02,869] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-16 05:00:02,869] [INFO] [config.py:1012:print]   train_batch_size ............. 8
[2023-08-16 05:00:02,869] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  2
[2023-08-16 05:00:02,869] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-16 05:00:02,869] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-16 05:00:02,869] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-16 05:00:02,869] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-16 05:00:02,869] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-16 05:00:02,869] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-16 05:00:02,869] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-16 05:00:02,869] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.8293278217315674 seconds
Loading extension module utils...
Time to load utils op: 0.7050461769104004 seconds
Loading extension module utils...
Time to load utils op: 0.5046467781066895 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating gsm8k :   0%|                                                               | 0/125 [00:00<?, ?it/s]############### Example ###############
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following grade math question.

### Demonstration:
Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Rationales: 1. The question asks where you could find plumbing that would not be usable if you're thirsty.
2. This implies that the plumbing in question doesn't carry drinkable water.
3. Considering the choices given:
    - A: oil refineries
    - B: wall
    - C: show
    - D: own home
    - E: water fountain
4. B: Wall, although it has plumbing, this could actually distribute water depending on the context (a household, for instance), so we cannot directly eliminate this.
5. D: Own home and E: water fountain are locations where one would usually expect to find usable, drinkable water, so these options can be eliminated.
6. C: Show isn't a clear option since the term "show" is very vague and can mean numerous things, but usually, shows involve places where potable water could potentially be accessible.
7. A: Oil refineries are places where plumbing exists, but it's used for transferring oil, not water.
8. Therefore, of all the options given, the only place where you're guaranteed to find plumbing that wouldn't be of use if you're thirsty is in an oil refinery. Thus the answer is A: oil refineries.
Answer: A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Rationales: 1. First, consider the meaning of each option. Working means carrying out tasks or duties, resting is being in a state of motionlessness or sleep, tiredness is a state of needing rest, accomplishing refers to achieving or completing a task or aim, momentum refers to the quantity of motion of a moving body.

2. The question is asking us to figure out what a person isn't doing when they are just starting to work.

3. Option A, working, is incorrect because the person is just starting to work, which means they are indeed working.

4. Option B, resting, may initially seem correct since a person who is just beginning to work is not resting. However, the question asks for what a person 'isn't doing yet', implying that this is something they will eventually do. Resting doesn't fit this description as resting is an opposite action to working. 

5. Option C, tiredness, is not correct because tiredness isn't something a person does. It's a state of being.

6. Option E, momentum, also doesn't fit because in this context, it is more of a state or characteristic the work might gain rather than an action performed by a person.

7. Considering all the options, we can deduce that option D, accomplishing, is the right answer. When a person is just beginning to work, they haven't had the time to accomplish or completely finish tasks yet. It is something they will eventually do, but haven't started doing yet, fitting the description given in the question.
Answer: D: accomplishing

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Rationales: 1. The question is asking about where one can find pens that carry a company logo.
2. This implies that the place needs to be a setting where company goods or merchandise are in use or distributed.
3. Option B, on a pencil, doesn't make sense because a pen is a different object from a pencil. So it's not possible to find a pen with a logo on a pencil.
4. Option C, write sentences on paper, is not a place at all, rather it is an action. This therefore doesn't fit the question's requirements.
5. While options D: school and E: backpack could potentially be places where a pen is placed, they are less associated with company logos.
6. Option A, office, however, is a common setting for businesses where official company merchandise, such as logoed pens, are commonly used or distributed to employees and visitors.
7. So, the answer is A: office.
Answer: A: office

Input: Billy called out to John, and listened for what? Choices:  A: silence B: response C: communication D: hanging up E: whisper
Rationales: 1. The question is about a situation in which Billy is calling out to John.
2. When we "call out" to someone, it usually means to gain their attention or ask for something.
3. After calling out to someone, the inevitable expectation is a response from the person called. The reason behind Billy calling out is to initiate a dialogue or communication.
4. Therefore, we can rule out "silence," as it doesn't fit the context of expecting something after calling out to someone.
5. "Hanging up" and "whisper" are also easily ruled out as they don't fit the context of Billy calling out to John.
6. Although "communication" may seem a possible choice, it is commonly understood that communication is a process that begins with a response.
7. Hence, the most fitting answer to the question "Billy called out to John, and listened for what?" would be "B: response," as this is the immediate expectation after Billy's action of calling out.
Answer: B: response

Input: The lizard frightened the hiker, it's movements made what rustle? Choices:  A: garden B: trees C: books D: rocks E: bushes
Rationales: 1. The question asks what the lizard's movements caused to rustle.
2. Rustling is usually referred to when leaves or some other light, thin objects move against each other, so they produce a soft, light sound.
3. We can eliminate choices A and C. A garden cannot rustle, it is too large and includes many objects. Books do not make sense in this context because there is no reason to believe that a lizard and a hiker would be near books in this scenario.
4. We can also eliminate choices B and D. Trees are too large to rustle from a tiny lizard's movements. Rocks cannot rustle because they are hard, heavy objects, not light, thin objects.
5. That leaves us with choice E: bushes, which makes sense in the given context. Bushes are made up of multiple thin, light objects (leaves and small branches) that would produce a rustling sound if a lizard moved through them.
6. Therefore, the answer is E: bushes.
Answer: E: bushes

Input: The man spent big money and time maintaining his lawn, it was part of keeping up with the Joneses where? Choices:  A: front yard B: suburbia C: neighborhood D: back yard E: golf course
Rationales: 1. The question requires an understanding of the phrase "keeping up with the Joneses". This phrase typically refers to attempting to maintain social equality with one's peers or neighbors in terms of material possessions or lifestyle.
2. Hence, the context required for this question will be a setting where there is a competition or tendency among individuals or families to follow socio-economic trends.
3. Analyzing the given choices, 'front yard' and 'back yard' are too specific and do not specifically imply this competition or trend.
4. A 'golf course' is unrelated to the typical neighborhood setting which would contain such a trend.
5. The 'neighborhood' could be correct but it’s a broad term and does not necessarily imply there is the type of socio-economic competition described.
6. So, the term'suburbia' refers specifically to residential areas especially on the outskirts of a city and these regions are notorious for having residents that try to keep up with the societal trends of their neighbors.
7. Therefore the most plausible option is B: suburbia.
Answer: B: suburbia

Input: What would a human do if they want to get to a store that he or she can see? Choices:  A: cross road B: see around C: drink coffee D: dream dreams E: think critically
Rationales: The goal mentioned in the question is to get to a store that a person can see. 

This suggests that they are relatively close to the store but some sort of obstacle or distance is in the way.

The given choices are actions that a person could possibly do. 

Option B: see around, does not directly take them closer to the store. 

Option C: drink coffee, while enjoyable, does not move them any closer to the store.

Option D: dream dreams, is an internal mental activity and will not physically move them to the store. 

Option E: think critically, may be necessary to solve complex problems, but in this case the solution is simple and does not require deep analytical thinking.

The only option that allows a person to physically move closer to the store is A: cross road. 

Therefore, the answer is A: cross road.
Answer: A: cross road

Input: Where would you grab an object contained by a doorway? Choices:  A: television B: control panel C: opening doors D: doorknob E: doorway
Rationales: 1. The question is asking in which object you would get the object contained by a doorway from all the provided options.
2. A television has no relevance to a doorway, hence cannot hold an object contained by a doorway.
3. Similarly, a control panel is not an object that holds other objects, nor is it specifically related to doorways.
4. Opening doors could potentially hold an object, but it more accurately describes an action rather than a location or object.
5. The doorknob is part of the door, and while it's related to the door, it does not contain objects, it's used to open or close the door.
6. Therefore, the possible answer will be E: doorway. It's the only choice that could contain or hold an object as it includes the entire door framework.
7. Thus, the answer is E: doorway.
Answer: E: doorway

Input: Sarah knew she was committing perjury, so there was a lot of what feeling between her and the prosecutor? Choices:  A: arrest B: tension C: shame D: attraction E: embarrassment
Rationales: 1. The question asks us to identify the feeling between Sarah and the prosecutor.
2. The situation described is that Sarah is knowingly committing perjury, which is a legal term for telling lies under oath.
3. Given the situation, we can eliminate the options that would miss the mark in the context.
4. 'Arrest' is an event, not a feeling, so we can remove option A.
5. 'Attraction' doesn't fit the context as it implies a positive emotional connection, which isn't likely in a situation involving perjury, so we can eliminate option D.
6. 'Embarrassment' and'shame' could potentially be feelings Sarah herself is experiencing, but the question asks about the feeling between her and the prosecutor, so options C and E are not correct.
7. This leaves us with 'tension' (option B). Tension typically refers to a strained relationship or situation, often involving conflict or stress.
8. In such a context where one person is knowingly breaking the law and the other person (the prosecutor) is trying to establish the truth, one can reasonably infer that there will be a significant strain or 'tension' between them.
9. Therefore, the correct answer is B: tension.
Answer: B: tension

### Input:Natalia sold clips to 48 of her friends in April, and then she sold half as many clips in May. How many clips did Natalia sell altogether in April and May?

### Response:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o9-tcommonsenseqa-s1-rTrue-m4096
Loading extension module utils...
Time to load utils op: 0.7048768997192383 seconds
Evaluating gsm8k :   1%|▍                                                    | 1/125 [00:35<1:12:29, 35.08s/it]Evaluating gsm8k :   2%|▊                                                    | 2/125 [01:12<1:14:42, 36.44s/it]Evaluating gsm8k :   2%|█▎                                                   | 3/125 [01:50<1:15:14, 37.00s/it]Evaluating gsm8k :   3%|█▋                                                   | 4/125 [02:27<1:14:54, 37.14s/it]Evaluating gsm8k :   4%|██                                                   | 5/125 [03:05<1:14:41, 37.35s/it]Evaluating gsm8k :   5%|██▌                                                  | 6/125 [03:37<1:10:28, 35.54s/it]Evaluating gsm8k :   6%|██▉                                                  | 7/125 [04:14<1:11:12, 36.20s/it]Evaluating gsm8k :   6%|███▍                                                 | 8/125 [04:52<1:11:36, 36.72s/it]Evaluating gsm8k :   7%|███▊                                                 | 9/125 [05:30<1:11:33, 37.01s/it]Evaluating gsm8k :   8%|████▏                                               | 10/125 [06:08<1:11:23, 37.25s/it]Evaluating gsm8k :   9%|████▌                                               | 11/125 [06:46<1:11:25, 37.59s/it]Evaluating gsm8k :  10%|████▉                                               | 12/125 [07:23<1:10:45, 37.57s/it]Evaluating gsm8k :  10%|█████▍                                              | 13/125 [08:02<1:10:34, 37.81s/it]Evaluating gsm8k :  11%|█████▊                                              | 14/125 [08:36<1:07:41, 36.59s/it]Evaluating gsm8k :  12%|██████▏                                             | 15/125 [09:14<1:07:53, 37.04s/it]Evaluating gsm8k :  13%|██████▋                                             | 16/125 [09:45<1:03:54, 35.18s/it]Evaluating gsm8k :  14%|███████                                             | 17/125 [10:23<1:04:54, 36.06s/it]Evaluating gsm8k :  14%|███████▍                                            | 18/125 [10:55<1:02:10, 34.86s/it]Evaluating gsm8k :  15%|███████▉                                            | 19/125 [11:32<1:02:58, 35.64s/it]Evaluating gsm8k :  16%|████████▋                                             | 20/125 [11:46<51:09, 29.24s/it]Evaluating gsm8k :  17%|█████████                                             | 21/125 [12:18<51:55, 29.96s/it]Evaluating gsm8k :  18%|█████████▌                                            | 22/125 [12:56<55:33, 32.36s/it]Evaluating gsm8k :  18%|█████████▉                                            | 23/125 [13:19<50:05, 29.47s/it]Evaluating gsm8k :  19%|██████████▎                                           | 24/125 [13:56<53:39, 31.87s/it]Evaluating gsm8k :  20%|██████████▊                                           | 25/125 [14:34<56:09, 33.69s/it]Evaluating gsm8k :  21%|███████████▏                                          | 26/125 [15:04<53:35, 32.48s/it]Evaluating gsm8k :  22%|███████████▋                                          | 27/125 [15:31<50:13, 30.75s/it]Evaluating gsm8k :  22%|████████████                                          | 28/125 [16:03<50:42, 31.37s/it]Evaluating gsm8k :  23%|████████████▌                                         | 29/125 [16:41<53:10, 33.23s/it]Evaluating gsm8k :  24%|████████████▉                                         | 30/125 [17:19<54:42, 34.56s/it]Evaluating gsm8k :  25%|█████████████▍                                        | 31/125 [17:57<55:46, 35.60s/it]Evaluating gsm8k :  26%|█████████████▊                                        | 32/125 [18:34<56:00, 36.14s/it]Evaluating gsm8k :  26%|██████████████▎                                       | 33/125 [19:12<56:10, 36.63s/it]Evaluating gsm8k :  27%|██████████████▋                                       | 34/125 [19:50<56:09, 37.03s/it]Evaluating gsm8k :  28%|███████████████                                       | 35/125 [20:27<55:43, 37.15s/it]Evaluating gsm8k :  29%|███████████████▌                                      | 36/125 [21:05<55:19, 37.30s/it]Evaluating gsm8k :  30%|███████████████▉                                      | 37/125 [21:42<54:49, 37.38s/it]Evaluating gsm8k :  30%|████████████████▍                                     | 38/125 [22:16<52:23, 36.13s/it]Evaluating gsm8k :  31%|████████████████▊                                     | 39/125 [22:53<52:23, 36.55s/it]Evaluating gsm8k :  32%|█████████████████▎                                    | 40/125 [23:10<43:26, 30.67s/it]Evaluating gsm8k :  33%|█████████████████▋                                    | 41/125 [23:24<35:52, 25.63s/it]Evaluating gsm8k :  34%|██████████████████▏                                   | 42/125 [23:49<35:08, 25.41s/it]Evaluating gsm8k :  34%|██████████████████▌                                   | 43/125 [24:27<39:46, 29.10s/it]Evaluating gsm8k :  35%|███████████████████                                   | 44/125 [25:04<42:49, 31.72s/it]Evaluating gsm8k :  36%|███████████████████▍                                  | 45/125 [25:42<44:36, 33.46s/it]Evaluating gsm8k :  37%|███████████████████▊                                  | 46/125 [26:20<45:48, 34.79s/it]Evaluating gsm8k :  38%|████████████████████▎                                 | 47/125 [26:58<46:21, 35.66s/it]Evaluating gsm8k :  38%|████████████████████▋                                 | 48/125 [27:17<39:22, 30.68s/it]Evaluating gsm8k :  39%|█████████████████████▏                                | 49/125 [27:54<41:33, 32.81s/it]Evaluating gsm8k :  40%|█████████████████████▌                                | 50/125 [28:32<42:54, 34.32s/it]Evaluating gsm8k :  41%|██████████████████████                                | 51/125 [29:10<43:39, 35.39s/it]Evaluating gsm8k :  42%|██████████████████████▍                               | 52/125 [29:37<39:59, 32.87s/it]Evaluating gsm8k :  42%|██████████████████████▉                               | 53/125 [30:15<41:07, 34.27s/it]Evaluating gsm8k :  43%|███████████████████████▎                              | 54/125 [30:53<41:56, 35.45s/it]Evaluating gsm8k :  44%|███████████████████████▊                              | 55/125 [31:31<42:07, 36.11s/it]Evaluating gsm8k :  45%|████████████████████████▏                             | 56/125 [31:55<37:34, 32.68s/it]Evaluating gsm8k :  46%|████████████████████████▌                             | 57/125 [32:33<38:55, 34.35s/it]Evaluating gsm8k :  46%|█████████████████████████                             | 58/125 [32:50<32:27, 29.07s/it]Evaluating gsm8k :  47%|█████████████████████████▍                            | 59/125 [33:08<28:08, 25.59s/it]Evaluating gsm8k :  48%|█████████████████████████▉                            | 60/125 [33:45<31:31, 29.10s/it]Evaluating gsm8k :  49%|██████████████████████████▎                           | 61/125 [34:23<33:51, 31.74s/it]Evaluating gsm8k :  50%|██████████████████████████▊                           | 62/125 [35:01<35:14, 33.56s/it]Evaluating gsm8k :  50%|███████████████████████████▏                          | 63/125 [35:38<35:59, 34.84s/it]Evaluating gsm8k :  51%|███████████████████████████▋                          | 64/125 [35:57<30:26, 29.95s/it]Evaluating gsm8k :  52%|████████████████████████████                          | 65/125 [36:35<32:17, 32.30s/it]Evaluating gsm8k :  53%|████████████████████████████▌                         | 66/125 [36:51<27:08, 27.61s/it]Evaluating gsm8k :  54%|████████████████████████████▉                         | 67/125 [37:26<28:50, 29.83s/it]Evaluating gsm8k :  54%|█████████████████████████████▍                        | 68/125 [37:59<28:58, 30.50s/it]Evaluating gsm8k :  55%|█████████████████████████████▊                        | 69/125 [38:37<30:34, 32.76s/it]Evaluating gsm8k :  56%|██████████████████████████████▏                       | 70/125 [39:14<31:23, 34.25s/it]Evaluating gsm8k :  57%|██████████████████████████████▋                       | 71/125 [39:52<31:47, 35.33s/it]Evaluating gsm8k :  58%|███████████████████████████████                       | 72/125 [40:23<30:02, 34.01s/it]Evaluating gsm8k :  58%|███████████████████████████████▌                      | 73/125 [40:47<26:58, 31.12s/it]Evaluating gsm8k :  59%|███████████████████████████████▉                      | 74/125 [41:14<25:10, 29.62s/it]Evaluating gsm8k :  60%|████████████████████████████████▍                     | 75/125 [41:50<26:21, 31.63s/it]Evaluating gsm8k :  61%|████████████████████████████████▊                     | 76/125 [42:27<27:15, 33.39s/it]Evaluating gsm8k :  62%|█████████████████████████████████▎                    | 77/125 [42:56<25:28, 31.84s/it]Evaluating gsm8k :  62%|█████████████████████████████████▋                    | 78/125 [43:33<26:19, 33.60s/it]Evaluating gsm8k :  63%|██████████████████████████████████▏                   | 79/125 [43:51<22:11, 28.95s/it]Evaluating gsm8k :  64%|██████████████████████████████████▌                   | 80/125 [44:29<23:36, 31.48s/it]Evaluating gsm8k :  65%|██████████████████████████████████▉                   | 81/125 [45:07<24:37, 33.57s/it]Evaluating gsm8k :  66%|███████████████████████████████████▍                  | 82/125 [45:45<25:00, 34.90s/it]Evaluating gsm8k :  66%|███████████████████████████████████▊                  | 83/125 [46:23<25:02, 35.77s/it]Evaluating gsm8k :  67%|████████████████████████████████████▎                 | 84/125 [46:44<21:27, 31.41s/it]Evaluating gsm8k :  68%|████████████████████████████████████▋                 | 85/125 [47:22<22:16, 33.42s/it]Evaluating gsm8k :  69%|█████████████████████████████████████▏                | 86/125 [48:00<22:31, 34.65s/it]Evaluating gsm8k :  70%|█████████████████████████████████████▌                | 87/125 [48:38<22:36, 35.70s/it]Evaluating gsm8k :  70%|██████████████████████████████████████                | 88/125 [48:51<17:49, 28.91s/it]Evaluating gsm8k :  71%|██████████████████████████████████████▍               | 89/125 [49:29<19:01, 31.72s/it]Evaluating gsm8k :  72%|██████████████████████████████████████▉               | 90/125 [49:49<16:19, 28.00s/it]Evaluating gsm8k :  73%|███████████████████████████████████████▎              | 91/125 [50:15<15:34, 27.50s/it]Evaluating gsm8k :  74%|███████████████████████████████████████▋              | 92/125 [50:53<16:52, 30.68s/it]Evaluating gsm8k :  74%|████████████████████████████████████████▏             | 93/125 [51:31<17:29, 32.80s/it]Evaluating gsm8k :  75%|████████████████████████████████████████▌             | 94/125 [51:56<15:45, 30.49s/it]Evaluating gsm8k :  76%|█████████████████████████████████████████             | 95/125 [52:34<16:21, 32.70s/it]Evaluating gsm8k :  77%|█████████████████████████████████████████▍            | 96/125 [53:11<16:29, 34.14s/it]Evaluating gsm8k :  78%|█████████████████████████████████████████▉            | 97/125 [53:49<16:28, 35.32s/it]Evaluating gsm8k :  78%|██████████████████████████████████████████▎           | 98/125 [54:27<16:14, 36.09s/it]Evaluating gsm8k :  79%|██████████████████████████████████████████▊           | 99/125 [55:05<15:51, 36.59s/it]Evaluating gsm8k :  80%|██████████████████████████████████████████▍          | 100/125 [55:43<15:22, 36.90s/it]Evaluating gsm8k :  81%|██████████████████████████████████████████▊          | 101/125 [56:07<13:12, 33.01s/it]Evaluating gsm8k :  82%|███████████████████████████████████████████▏         | 102/125 [56:44<13:11, 34.40s/it]Evaluating gsm8k :  82%|███████████████████████████████████████████▋         | 103/125 [57:22<12:58, 35.39s/it]Evaluating gsm8k :  83%|████████████████████████████████████████████         | 104/125 [58:00<12:39, 36.15s/it]Evaluating gsm8k :  84%|████████████████████████████████████████████▌        | 105/125 [58:38<12:13, 36.69s/it]Evaluating gsm8k :  85%|████████████████████████████████████████████▉        | 106/125 [59:16<11:46, 37.16s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████▎       | 107/125 [59:40<09:59, 33.30s/it]Evaluating gsm8k :  86%|████████████████████████████████████████████       | 108/125 [1:00:18<09:50, 34.73s/it]Evaluating gsm8k :  87%|████████████████████████████████████████████▍      | 109/125 [1:00:57<09:33, 35.86s/it]Evaluating gsm8k :  88%|████████████████████████████████████████████▉      | 110/125 [1:01:35<09:06, 36.41s/it]Evaluating gsm8k :  89%|█████████████████████████████████████████████▎     | 111/125 [1:02:00<07:45, 33.23s/it]Evaluating gsm8k :  90%|█████████████████████████████████████████████▋     | 112/125 [1:02:10<05:40, 26.19s/it]Evaluating gsm8k :  90%|██████████████████████████████████████████████     | 113/125 [1:02:48<05:56, 29.70s/it]Evaluating gsm8k :  91%|██████████████████████████████████████████████▌    | 114/125 [1:03:26<05:55, 32.28s/it]Evaluating gsm8k :  92%|██████████████████████████████████████████████▉    | 115/125 [1:04:04<05:39, 33.97s/it]Evaluating gsm8k :  93%|███████████████████████████████████████████████▎   | 116/125 [1:04:42<05:16, 35.15s/it]Evaluating gsm8k :  94%|███████████████████████████████████████████████▋   | 117/125 [1:05:10<04:24, 33.02s/it]Evaluating gsm8k :  94%|████████████████████████████████████████████████▏  | 118/125 [1:05:48<04:01, 34.47s/it]Evaluating gsm8k :  95%|████████████████████████████████████████████████▌  | 119/125 [1:06:27<03:33, 35.63s/it]Evaluating gsm8k :  96%|████████████████████████████████████████████████▉  | 120/125 [1:07:04<03:01, 36.33s/it]Evaluating gsm8k :  97%|█████████████████████████████████████████████████▎ | 121/125 [1:07:41<02:25, 36.43s/it]Evaluating gsm8k :  98%|█████████████████████████████████████████████████▊ | 122/125 [1:08:19<01:50, 36.98s/it]Evaluating gsm8k :  98%|██████████████████████████████████████████████████▏| 123/125 [1:08:46<01:07, 33.84s/it]Evaluating gsm8k :  99%|██████████████████████████████████████████████████▌| 124/125 [1:09:24<00:35, 35.02s/it]Evaluating gsm8k : 100%|███████████████████████████████████████████████████| 125/125 [1:09:56<00:00, 34.16s/it]Evaluating gsm8k : 100%|███████████████████████████████████████████████████| 125/125 [1:09:56<00:00, 33.57s/it]
name: gsm8k | {'exact_match': 0.0, 'rougeL': 0.1782} | lm_loss 10.0483 | avg. gen lenth: 361.372
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name gsm8k --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name commonsenseqa --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --max-prompt-length 4096 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 2 --data-dir /scratch/ylu130/processed_data/gsm8k/out-domain/o4-tcommonsenseqa-s1-rFalse --seed 1 --num-out-domain 4
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-16 06:11:10,922] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... gsm8k
  data_dir ..................... /scratch/ylu130/processed_data/gsm8k/out-domain/o4-tcommonsenseqa-s1-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 4
  out_domain_data_name ......... commonsenseqa
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 4096
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o4-tcommonsenseqa-s1-rFalse-m4096
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 2
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                 | 0/7473 [00:00<?, ?it/s]  2%|█                                                                    | 118/7473 [00:00<00:06, 1173.20it/s]  3%|██▏                                                                  | 239/7473 [00:00<00:06, 1189.63it/s]  5%|███▎                                                                 | 359/7473 [00:00<00:05, 1193.16it/s]  6%|████▍                                                                | 479/7473 [00:00<00:05, 1190.13it/s]  8%|█████▌                                                               | 600/7473 [00:00<00:05, 1194.56it/s] 10%|██████▋                                                              | 721/7473 [00:00<00:05, 1198.65it/s] 11%|███████▊                                                             | 842/7473 [00:00<00:05, 1200.22it/s] 13%|████████▉                                                            | 963/7473 [00:00<00:05, 1201.69it/s] 15%|█████████▊                                                          | 1084/7473 [00:00<00:05, 1181.30it/s] 16%|██████████▉                                                         | 1203/7473 [00:01<00:05, 1180.00it/s] 18%|████████████                                                        | 1324/7473 [00:01<00:05, 1188.28it/s] 19%|█████████████▏                                                      | 1443/7473 [00:01<00:05, 1187.26it/s] 21%|██████████████▏                                                     | 1563/7473 [00:01<00:04, 1190.89it/s] 23%|███████████████▎                                                    | 1683/7473 [00:01<00:04, 1191.31it/s] 24%|████████████████▍                                                   | 1803/7473 [00:01<00:04, 1191.38it/s] 26%|█████████████████▍                                                  | 1923/7473 [00:01<00:04, 1187.64it/s] 27%|██████████████████▌                                                 | 2043/7473 [00:01<00:04, 1191.04it/s] 29%|███████████████████▋                                                | 2163/7473 [00:01<00:04, 1190.90it/s] 31%|████████████████████▊                                               | 2283/7473 [00:01<00:04, 1188.52it/s] 32%|█████████████████████▊                                              | 2403/7473 [00:02<00:04, 1190.79it/s] 34%|██████████████████████▉                                             | 2523/7473 [00:02<00:04, 1159.65it/s] 35%|████████████████████████                                            | 2644/7473 [00:02<00:04, 1173.86it/s] 37%|█████████████████████████▏                                          | 2765/7473 [00:02<00:03, 1182.52it/s] 39%|██████████████████████████▎                                         | 2886/7473 [00:02<00:03, 1189.15it/s] 40%|███████████████████████████▎                                        | 3008/7473 [00:02<00:03, 1197.09it/s] 42%|████████████████████████████▍                                       | 3128/7473 [00:02<00:03, 1194.64it/s] 43%|█████████████████████████████▌                                      | 3249/7473 [00:02<00:03, 1197.66it/s] 46%|███████████████████████████████▏                                    | 3430/7473 [00:02<00:02, 1378.93it/s] 48%|████████████████████████████████▉                                   | 3613/7473 [00:02<00:02, 1511.76it/s] 51%|██████████████████████████████████▌                                 | 3794/7473 [00:03<00:02, 1599.28it/s] 53%|████████████████████████████████████▏                               | 3976/7473 [00:03<00:02, 1664.05it/s] 56%|█████████████████████████████████████▊                              | 4157/7473 [00:03<00:01, 1706.96it/s] 58%|███████████████████████████████████████▍                            | 4339/7473 [00:03<00:01, 1740.34it/s] 60%|█████████████████████████████████████████▏                          | 4520/7473 [00:03<00:01, 1760.54it/s] 63%|██████████████████████████████████████████▊                         | 4702/7473 [00:03<00:01, 1775.65it/s] 65%|████████████████████████████████████████████▍                       | 4882/7473 [00:03<00:01, 1780.28it/s] 68%|██████████████████████████████████████████████                      | 5064/7473 [00:03<00:01, 1789.75it/s] 70%|███████████████████████████████████████████████▋                    | 5244/7473 [00:03<00:01, 1764.01it/s] 73%|█████████████████████████████████████████████████▎                  | 5426/7473 [00:03<00:01, 1777.22it/s] 75%|██████████████████████████████████████████████████▉                 | 5604/7473 [00:04<00:01, 1375.51it/s] 77%|████████████████████████████████████████████████████▋               | 5785/7473 [00:04<00:01, 1481.29it/s] 80%|██████████████████████████████████████████████████████▎             | 5964/7473 [00:04<00:00, 1561.69it/s] 82%|███████████████████████████████████████████████████████▉            | 6147/7473 [00:04<00:00, 1632.96it/s] 85%|█████████████████████████████████████████████████████████▌          | 6331/7473 [00:04<00:00, 1690.51it/s] 87%|███████████████████████████████████████████████████████████▏        | 6511/7473 [00:04<00:00, 1718.89it/s] 90%|████████████████████████████████████████████████████████████▉       | 6692/7473 [00:04<00:00, 1745.06it/s] 92%|██████████████████████████████████████████████████████████████▌     | 6873/7473 [00:04<00:00, 1763.23it/s] 94%|████████████████████████████████████████████████████████████████▏   | 7054/7473 [00:04<00:00, 1776.02it/s] 97%|█████████████████████████████████████████████████████████████████▊  | 7236/7473 [00:05<00:00, 1786.82it/s] 99%|███████████████████████████████████████████████████████████████████▍| 7418/7473 [00:05<00:00, 1795.72it/s]100%|████████████████████████████████████████████████████████████████████| 7473/7473 [00:05<00:00, 1444.94it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                         | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                         | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                         | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                         | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|████████████████▎                                | 1/3 [00:05<00:10,  5.08s/it]Loading checkpoint shards:  33%|████████████████▎                                | 1/3 [00:05<00:10,  5.30s/it]Loading checkpoint shards:  33%|████████████████▎                                | 1/3 [00:05<00:10,  5.40s/it]Loading checkpoint shards:  33%|████████████████▎                                | 1/3 [00:05<00:10,  5.47s/it]Loading checkpoint shards:  67%|████████████████████████████████▋                | 2/3 [00:10<00:05,  5.03s/it]Loading checkpoint shards:  67%|████████████████████████████████▋                | 2/3 [00:10<00:05,  5.36s/it]Loading checkpoint shards:  67%|████████████████████████████████▋                | 2/3 [00:10<00:05,  5.37s/it]Loading checkpoint shards:  67%|████████████████████████████████▋                | 2/3 [00:11<00:05,  5.51s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.39s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.57s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.80s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.94s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.72s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.90s/it]
[2023-08-16 06:12:08,146] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.82s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:14<00:00,  5.00s/it]
[2023-08-16 06:12:17,164] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-16 06:12:17,165] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-16 06:12:17,166] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-16 06:12:17,166] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-16 06:12:17,166] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-16 06:12:17,166] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-16 06:12:17,166] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-16 06:12:17,166] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-16 06:12:17,166] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-16 06:12:17,166] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-16 06:12:17,166] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-16 06:12:17,166] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f70a0d36fd0>
[2023-08-16 06:12:17,166] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-16 06:12:17,166] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-16 06:12:17,166] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-16 06:12:17,166] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-16 06:12:17,166] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-16 06:12:17,166] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-16 06:12:17,166] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-16 06:12:17,166] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-16 06:12:17,166] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-16 06:12:17,166] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-16 06:12:17,166] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-16 06:12:17,166] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-16 06:12:17,166] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-16 06:12:17,166] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-16 06:12:17,166] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-16 06:12:17,166] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-16 06:12:17,166] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-16 06:12:17,166] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-16 06:12:17,167] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-16 06:12:17,167] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-16 06:12:17,167] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-16 06:12:17,167] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-16 06:12:17,167] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-16 06:12:17,167] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-16 06:12:17,167] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-16 06:12:17,167] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-16 06:12:17,167] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-16 06:12:17,167] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-16 06:12:17,167] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-16 06:12:17,167] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-16 06:12:17,167] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-16 06:12:17,167] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-16 06:12:17,167] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f70a0d36be0>
[2023-08-16 06:12:17,167] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-16 06:12:17,167] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-16 06:12:17,167] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-16 06:12:17,167] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-16 06:12:17,167] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-16 06:12:17,167] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-16 06:12:17,167] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-16 06:12:17,167] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-16 06:12:17,167] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-16 06:12:17,167] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-16 06:12:17,167] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-16 06:12:17,167] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-16 06:12:17,167] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-16 06:12:17,167] [INFO] [config.py:1012:print]   train_batch_size ............. 8
[2023-08-16 06:12:17,167] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  2
[2023-08-16 06:12:17,167] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-16 06:12:17,167] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-16 06:12:17,167] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-16 06:12:17,167] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-16 06:12:17,167] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-16 06:12:17,167] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-16 06:12:17,167] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-16 06:12:17,167] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.3944246768951416 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating gsm8k :   0%|                                                               | 0/125 [00:00<?, ?it/s]Loading extension module utils...
Loading extension module utils...
############### Example ###############
Time to load utils op: 0.3045845031738281 seconds
Time to load utils op: 0.4044468402862549 seconds
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following grade math question.

### Demonstration:
Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Answer: A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Answer: D: accomplishing

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Answer: A: office

Input: Billy called out to John, and listened for what? Choices:  A: silence B: response C: communication D: hanging up E: whisper
Answer: B: response

### Input:Natalia sold clips to 48 of her friends in April, and then she sold half as many clips in May. How many clips did Natalia sell altogether in April and May?

### Response:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o4-tcommonsenseqa-s1-rFalse-m4096
Loading extension module utils...
Time to load utils op: 0.30378007888793945 seconds
Evaluating gsm8k :   1%|▍                                                    | 1/125 [00:42<1:27:03, 42.13s/it]Evaluating gsm8k :   2%|▊                                                    | 2/125 [01:08<1:07:56, 33.14s/it]Evaluating gsm8k :   2%|█▎                                                     | 3/125 [01:31<57:52, 28.46s/it]Evaluating gsm8k :   3%|█▊                                                     | 4/125 [01:38<40:05, 19.88s/it]Evaluating gsm8k :   4%|██                                                   | 5/125 [02:40<1:10:10, 35.09s/it]Evaluating gsm8k :   5%|██▌                                                  | 6/125 [03:34<1:22:10, 41.43s/it]Evaluating gsm8k :   6%|██▉                                                  | 7/125 [04:09<1:17:27, 39.39s/it]Evaluating gsm8k :   6%|███▍                                                 | 8/125 [04:24<1:01:26, 31.51s/it]Evaluating gsm8k :   7%|███▊                                                 | 9/125 [05:07<1:08:06, 35.23s/it]Evaluating gsm8k :   8%|████▏                                               | 10/125 [05:56<1:15:43, 39.51s/it]Evaluating gsm8k :   9%|████▌                                               | 11/125 [06:19<1:05:35, 34.52s/it]Evaluating gsm8k :  10%|████▉                                               | 12/125 [06:49<1:02:10, 33.02s/it]Evaluating gsm8k :  10%|█████▌                                                | 13/125 [07:09<54:16, 29.07s/it]Evaluating gsm8k :  11%|█████▊                                              | 14/125 [08:13<1:13:10, 39.56s/it]Evaluating gsm8k :  12%|██████▏                                             | 15/125 [09:16<1:25:32, 46.66s/it]Evaluating gsm8k :  13%|██████▋                                             | 16/125 [10:11<1:29:11, 49.09s/it]Evaluating gsm8k :  14%|███████                                             | 17/125 [10:43<1:19:10, 43.99s/it]Evaluating gsm8k :  14%|███████▍                                            | 18/125 [11:45<1:28:27, 49.61s/it]Evaluating gsm8k :  15%|███████▉                                            | 19/125 [12:04<1:11:15, 40.33s/it]Evaluating gsm8k :  16%|████████▎                                           | 20/125 [12:25<1:00:27, 34.55s/it]Evaluating gsm8k :  17%|████████▋                                           | 21/125 [13:29<1:15:17, 43.44s/it]Evaluating gsm8k :  18%|█████████▏                                          | 22/125 [14:34<1:25:13, 49.64s/it]Evaluating gsm8k :  18%|█████████▌                                          | 23/125 [14:41<1:02:47, 36.93s/it]Evaluating gsm8k :  19%|█████████▉                                          | 24/125 [15:25<1:05:53, 39.14s/it]Evaluating gsm8k :  20%|██████████▍                                         | 25/125 [16:10<1:07:55, 40.75s/it]Evaluating gsm8k :  21%|██████████▊                                         | 26/125 [16:53<1:08:33, 41.55s/it]Evaluating gsm8k :  22%|███████████▋                                          | 27/125 [17:13<57:28, 35.19s/it]Evaluating gsm8k :  22%|████████████                                          | 28/125 [17:36<50:57, 31.52s/it]Evaluating gsm8k :  23%|████████████▌                                         | 29/125 [17:52<42:43, 26.70s/it]Evaluating gsm8k :  24%|████████████▉                                         | 30/125 [18:55<59:34, 37.62s/it]Evaluating gsm8k :  25%|█████████████▍                                        | 31/125 [19:02<44:41, 28.52s/it]Evaluating gsm8k :  26%|█████████████▊                                        | 32/125 [19:13<35:59, 23.22s/it]Evaluating gsm8k :  26%|██████████████▎                                       | 33/125 [20:13<52:21, 34.15s/it]Evaluating gsm8k :  27%|██████████████▋                                       | 34/125 [20:34<46:06, 30.41s/it]Evaluating gsm8k :  28%|███████████████                                       | 35/125 [20:50<38:44, 25.83s/it]Evaluating gsm8k :  29%|███████████████▌                                      | 36/125 [21:12<36:45, 24.78s/it]Evaluating gsm8k :  30%|███████████████▉                                      | 37/125 [21:24<30:41, 20.92s/it]Evaluating gsm8k :  30%|████████████████▍                                     | 38/125 [22:26<48:09, 33.21s/it]Evaluating gsm8k :  31%|████████████████▏                                   | 39/125 [23:29<1:00:29, 42.20s/it]Evaluating gsm8k :  32%|█████████████████▎                                    | 40/125 [23:47<49:35, 35.01s/it]Evaluating gsm8k :  33%|█████████████████▋                                    | 41/125 [24:14<45:28, 32.48s/it]Evaluating gsm8k :  34%|██████████████████▏                                   | 42/125 [24:31<38:30, 27.83s/it]Evaluating gsm8k :  34%|██████████████████▌                                   | 43/125 [25:29<50:22, 36.87s/it]Evaluating gsm8k :  35%|██████████████████▎                                 | 44/125 [26:31<1:00:07, 44.54s/it]Evaluating gsm8k :  36%|███████████████████▍                                  | 45/125 [26:40<45:10, 33.88s/it]Evaluating gsm8k :  37%|███████████████████▊                                  | 46/125 [27:43<56:12, 42.69s/it]Evaluating gsm8k :  38%|███████████████████▌                                | 47/125 [28:46<1:03:26, 48.80s/it]Evaluating gsm8k :  38%|███████████████████▉                                | 48/125 [29:50<1:08:21, 53.26s/it]Evaluating gsm8k :  39%|█████████████████████▏                                | 49/125 [30:15<56:53, 44.92s/it]Evaluating gsm8k :  40%|█████████████████████▌                                | 50/125 [30:41<48:46, 39.02s/it]Evaluating gsm8k :  41%|██████████████████████                                | 51/125 [30:58<40:10, 32.58s/it]Evaluating gsm8k :  42%|██████████████████████▍                               | 52/125 [31:06<30:36, 25.15s/it]Evaluating gsm8k :  42%|██████████████████████▉                               | 53/125 [31:23<27:21, 22.79s/it]Evaluating gsm8k :  43%|███████████████████████▎                              | 54/125 [31:32<22:02, 18.63s/it]Evaluating gsm8k :  44%|███████████████████████▊                              | 55/125 [31:47<20:26, 17.53s/it]Evaluating gsm8k :  45%|████████████████████████▏                             | 56/125 [32:22<25:58, 22.59s/it]Evaluating gsm8k :  46%|████████████████████████▌                             | 57/125 [32:56<29:29, 26.03s/it]Evaluating gsm8k :  46%|█████████████████████████                             | 58/125 [34:00<41:43, 37.37s/it]Evaluating gsm8k :  47%|█████████████████████████▍                            | 59/125 [34:25<37:06, 33.73s/it]Evaluating gsm8k :  48%|█████████████████████████▉                            | 60/125 [34:51<34:11, 31.55s/it]Evaluating gsm8k :  49%|██████████████████████████▎                           | 61/125 [35:54<43:29, 40.78s/it]Evaluating gsm8k :  50%|██████████████████████████▊                           | 62/125 [36:48<47:06, 44.86s/it]Evaluating gsm8k :  50%|███████████████████████████▏                          | 63/125 [37:51<51:58, 50.29s/it]Evaluating gsm8k :  51%|███████████████████████████▋                          | 64/125 [38:24<45:50, 45.08s/it]Evaluating gsm8k :  52%|████████████████████████████                          | 65/125 [39:03<43:11, 43.20s/it]Evaluating gsm8k :  53%|████████████████████████████▌                         | 66/125 [39:16<33:33, 34.13s/it]Evaluating gsm8k :  54%|████████████████████████████▉                         | 67/125 [40:20<41:43, 43.17s/it]Evaluating gsm8k :  54%|█████████████████████████████▍                        | 68/125 [41:23<46:47, 49.26s/it]Evaluating gsm8k :  55%|█████████████████████████████▊                        | 69/125 [41:38<36:20, 38.95s/it]Evaluating gsm8k :  56%|██████████████████████████████▏                       | 70/125 [42:18<35:57, 39.23s/it]Evaluating gsm8k :  57%|██████████████████████████████▋                       | 71/125 [42:47<32:34, 36.19s/it]Evaluating gsm8k :  58%|███████████████████████████████                       | 72/125 [42:57<25:04, 28.39s/it]Evaluating gsm8k :  58%|███████████████████████████████▌                      | 73/125 [43:10<20:35, 23.75s/it]Evaluating gsm8k :  59%|███████████████████████████████▉                      | 74/125 [43:21<16:57, 19.94s/it]Evaluating gsm8k :  60%|████████████████████████████████▍                     | 75/125 [43:34<14:42, 17.65s/it]Evaluating gsm8k :  61%|████████████████████████████████▊                     | 76/125 [43:59<16:15, 19.90s/it]Evaluating gsm8k :  62%|█████████████████████████████████▎                    | 77/125 [44:18<15:44, 19.68s/it]Evaluating gsm8k :  62%|█████████████████████████████████▋                    | 78/125 [44:52<18:44, 23.92s/it]Evaluating gsm8k :  63%|██████████████████████████████████▏                   | 79/125 [45:08<16:31, 21.55s/it]Evaluating gsm8k :  64%|██████████████████████████████████▌                   | 80/125 [45:20<13:56, 18.60s/it]Evaluating gsm8k :  65%|██████████████████████████████████▉                   | 81/125 [45:33<12:26, 16.95s/it]Evaluating gsm8k :  66%|███████████████████████████████████▍                  | 82/125 [46:32<21:11, 29.58s/it]Evaluating gsm8k :  66%|███████████████████████████████████▊                  | 83/125 [47:15<23:32, 33.63s/it]Evaluating gsm8k :  67%|████████████████████████████████████▎                 | 84/125 [47:59<25:04, 36.70s/it]Evaluating gsm8k :  68%|████████████████████████████████████▋                 | 85/125 [48:46<26:30, 39.77s/it]Evaluating gsm8k :  69%|█████████████████████████████████████▏                | 86/125 [48:55<19:57, 30.69s/it]Evaluating gsm8k :  70%|█████████████████████████████████████▌                | 87/125 [49:27<19:41, 31.10s/it]Evaluating gsm8k :  70%|██████████████████████████████████████                | 88/125 [49:42<16:13, 26.31s/it]Evaluating gsm8k :  71%|██████████████████████████████████████▍               | 89/125 [49:52<12:44, 21.23s/it]Evaluating gsm8k :  72%|██████████████████████████████████████▉               | 90/125 [50:40<17:10, 29.44s/it]Evaluating gsm8k :  73%|███████████████████████████████████████▎              | 91/125 [51:06<16:06, 28.42s/it]Evaluating gsm8k :  74%|███████████████████████████████████████▋              | 92/125 [51:27<14:19, 26.05s/it]Evaluating gsm8k :  74%|████████████████████████████████████████▏             | 93/125 [51:47<12:53, 24.17s/it]Evaluating gsm8k :  75%|████████████████████████████████████████▌             | 94/125 [52:50<18:38, 36.07s/it]Evaluating gsm8k :  76%|█████████████████████████████████████████             | 95/125 [53:18<16:46, 33.54s/it]Evaluating gsm8k :  77%|█████████████████████████████████████████▍            | 96/125 [54:12<19:11, 39.72s/it]Evaluating gsm8k :  78%|█████████████████████████████████████████▉            | 97/125 [54:39<16:44, 35.88s/it]Evaluating gsm8k :  78%|██████████████████████████████████████████▎           | 98/125 [55:29<18:00, 40.02s/it]Evaluating gsm8k :  79%|██████████████████████████████████████████▊           | 99/125 [56:08<17:11, 39.66s/it]Evaluating gsm8k :  80%|██████████████████████████████████████████▍          | 100/125 [56:28<14:03, 33.74s/it]Evaluating gsm8k :  81%|██████████████████████████████████████████▊          | 101/125 [57:08<14:21, 35.90s/it]Evaluating gsm8k :  82%|███████████████████████████████████████████▏         | 102/125 [58:11<16:46, 43.76s/it]Evaluating gsm8k :  82%|███████████████████████████████████████████▋         | 103/125 [58:55<16:09, 44.09s/it]Evaluating gsm8k :  83%|████████████████████████████████████████████         | 104/125 [59:48<16:20, 46.69s/it]Evaluating gsm8k :  84%|██████████████████████████████████████████▊        | 105/125 [1:00:15<13:33, 40.70s/it]Evaluating gsm8k :  85%|███████████████████████████████████████████▏       | 106/125 [1:00:59<13:09, 41.58s/it]Evaluating gsm8k :  86%|███████████████████████████████████████████▋       | 107/125 [1:01:14<10:06, 33.67s/it]Evaluating gsm8k :  86%|████████████████████████████████████████████       | 108/125 [1:02:02<10:46, 38.06s/it]Evaluating gsm8k :  87%|████████████████████████████████████████████▍      | 109/125 [1:02:13<07:57, 29.82s/it]Evaluating gsm8k :  88%|████████████████████████████████████████████▉      | 110/125 [1:02:39<07:12, 28.83s/it]Evaluating gsm8k :  89%|█████████████████████████████████████████████▎     | 111/125 [1:03:42<09:06, 39.06s/it]Evaluating gsm8k :  90%|█████████████████████████████████████████████▋     | 112/125 [1:04:45<10:01, 46.23s/it]Evaluating gsm8k :  90%|██████████████████████████████████████████████     | 113/125 [1:05:18<08:27, 42.33s/it]Evaluating gsm8k :  91%|██████████████████████████████████████████████▌    | 114/125 [1:05:28<05:58, 32.55s/it]Evaluating gsm8k :  92%|██████████████████████████████████████████████▉    | 115/125 [1:06:00<05:22, 32.23s/it]Evaluating gsm8k :  93%|███████████████████████████████████████████████▎   | 116/125 [1:06:36<05:00, 33.44s/it]Evaluating gsm8k :  94%|███████████████████████████████████████████████▋   | 117/125 [1:07:40<05:41, 42.73s/it]Evaluating gsm8k :  94%|████████████████████████████████████████████████▏  | 118/125 [1:08:03<04:17, 36.76s/it]Evaluating gsm8k :  95%|████████████████████████████████████████████████▌  | 119/125 [1:08:32<03:27, 34.53s/it]Evaluating gsm8k :  96%|████████████████████████████████████████████████▉  | 120/125 [1:09:32<03:29, 41.93s/it]Evaluating gsm8k :  97%|█████████████████████████████████████████████████▎ | 121/125 [1:09:54<02:24, 36.14s/it]Evaluating gsm8k :  98%|█████████████████████████████████████████████████▊ | 122/125 [1:10:29<01:47, 35.71s/it]Evaluating gsm8k :  98%|██████████████████████████████████████████████████▏| 123/125 [1:11:03<01:10, 35.35s/it]Evaluating gsm8k :  99%|██████████████████████████████████████████████████▌| 124/125 [1:12:06<00:43, 43.62s/it]Evaluating gsm8k : 100%|███████████████████████████████████████████████████| 125/125 [1:12:18<00:00, 34.05s/it]Evaluating gsm8k : 100%|███████████████████████████████████████████████████| 125/125 [1:12:18<00:00, 34.71s/it]
name: gsm8k | {'exact_match': 0.4, 'rougeL': 0.5912} | lm_loss 9.6827 | avg. gen lenth: 174.012
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name gsm8k --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name commonsenseqa --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --max-prompt-length 4096 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 2 --data-dir /scratch/ylu130/processed_data/gsm8k/out-domain/o5-tcommonsenseqa-s1-rFalse --seed 1 --num-out-domain 5
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-16 07:33:57,412] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... gsm8k
  data_dir ..................... /scratch/ylu130/processed_data/gsm8k/out-domain/o5-tcommonsenseqa-s1-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 5
  out_domain_data_name ......... commonsenseqa
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 4096
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o5-tcommonsenseqa-s1-rFalse-m4096
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 2
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                 | 0/7473 [00:00<?, ?it/s]  1%|▉                                                                    | 106/7473 [00:00<00:06, 1059.73it/s]  3%|█▉                                                                   | 215/7473 [00:00<00:06, 1075.19it/s]  4%|██▉                                                                  | 323/7473 [00:00<00:06, 1073.14it/s]  6%|███▉                                                                 | 431/7473 [00:00<00:06, 1070.44it/s]  7%|████▉                                                                | 539/7473 [00:00<00:06, 1072.08it/s]  9%|█████▉                                                               | 647/7473 [00:00<00:06, 1072.08it/s] 10%|██████▉                                                              | 758/7473 [00:00<00:06, 1081.42it/s] 12%|████████                                                             | 867/7473 [00:00<00:06, 1080.64it/s] 13%|█████████                                                            | 976/7473 [00:00<00:06, 1060.16it/s] 15%|█████████▊                                                          | 1085/7473 [00:01<00:05, 1068.78it/s] 16%|██████████▊                                                         | 1192/7473 [00:01<00:05, 1067.82it/s] 17%|███████████▊                                                        | 1300/7473 [00:01<00:05, 1070.52it/s] 19%|████████████▊                                                       | 1408/7473 [00:01<00:05, 1071.78it/s] 20%|█████████████▊                                                      | 1517/7473 [00:01<00:05, 1076.38it/s] 22%|██████████████▊                                                     | 1625/7473 [00:01<00:05, 1071.97it/s] 23%|███████████████▊                                                    | 1734/7473 [00:01<00:05, 1077.22it/s] 25%|████████████████▊                                                   | 1842/7473 [00:01<00:05, 1073.33it/s] 26%|█████████████████▋                                                  | 1950/7473 [00:01<00:05, 1072.21it/s] 28%|██████████████████▋                                                 | 2058/7473 [00:01<00:05, 1071.30it/s] 29%|███████████████████▋                                                | 2166/7473 [00:02<00:04, 1068.59it/s] 30%|████████████████████▋                                               | 2275/7473 [00:02<00:04, 1072.70it/s] 32%|█████████████████████▋                                              | 2383/7473 [00:02<00:04, 1072.37it/s] 33%|██████████████████████▋                                             | 2493/7473 [00:02<00:04, 1077.92it/s] 35%|███████████████████████▋                                            | 2601/7473 [00:02<00:04, 1045.70it/s] 36%|████████████████████████▋                                           | 2711/7473 [00:02<00:04, 1061.39it/s] 38%|██████████████████████████                                          | 2868/7473 [00:02<00:03, 1210.04it/s] 41%|███████████████████████████▌                                        | 3033/7473 [00:02<00:03, 1339.27it/s] 43%|█████████████████████████████                                       | 3196/7473 [00:02<00:03, 1425.26it/s] 45%|██████████████████████████████▌                                     | 3360/7473 [00:02<00:02, 1487.12it/s] 47%|████████████████████████████████                                    | 3523/7473 [00:03<00:02, 1528.28it/s] 49%|█████████████████████████████████▌                                  | 3685/7473 [00:03<00:02, 1554.32it/s] 51%|██████████████████████████████████▉                                 | 3842/7473 [00:03<00:02, 1557.73it/s] 54%|████████████████████████████████████▍                               | 4005/7473 [00:03<00:02, 1578.81it/s] 56%|█████████████████████████████████████▉                              | 4166/7473 [00:03<00:02, 1586.15it/s] 58%|███████████████████████████████████████▎                            | 4327/7473 [00:03<00:01, 1592.55it/s] 60%|████████████████████████████████████████▊                           | 4489/7473 [00:03<00:01, 1598.53it/s] 62%|██████████████████████████████████████████▎                         | 4652/7473 [00:03<00:01, 1605.86it/s] 64%|███████████████████████████████████████████▊                        | 4816/7473 [00:03<00:01, 1614.78it/s] 67%|█████████████████████████████████████████████▎                      | 4980/7473 [00:03<00:01, 1621.46it/s] 69%|██████████████████████████████████████████████▊                     | 5144/7473 [00:04<00:01, 1624.29it/s] 71%|████████████████████████████████████████████████▎                   | 5307/7473 [00:04<00:01, 1590.21it/s] 73%|█████████████████████████████████████████████████▊                  | 5471/7473 [00:04<00:01, 1261.92it/s] 75%|███████████████████████████████████████████████████▎                | 5633/7473 [00:04<00:01, 1350.59it/s] 77%|████████████████████████████████████████████████████▋               | 5785/7473 [00:04<00:01, 1393.45it/s] 79%|██████████████████████████████████████████████████████              | 5940/7473 [00:04<00:01, 1435.63it/s] 82%|███████████████████████████████████████████████████████▌            | 6101/7473 [00:04<00:00, 1482.23it/s] 84%|████████████████████████████████████████████████████████▉           | 6264/7473 [00:04<00:00, 1522.59it/s] 86%|██████████████████████████████████████████████████████████▍         | 6426/7473 [00:04<00:00, 1550.20it/s] 88%|███████████████████████████████████████████████████████████▉        | 6590/7473 [00:05<00:00, 1576.29it/s] 90%|█████████████████████████████████████████████████████████████▍      | 6754/7473 [00:05<00:00, 1594.12it/s] 93%|██████████████████████████████████████████████████████████████▉     | 6918/7473 [00:05<00:00, 1605.15it/s] 95%|████████████████████████████████████████████████████████████████▍   | 7080/7473 [00:05<00:00, 1608.01it/s] 97%|█████████████████████████████████████████████████████████████████▉  | 7245/7473 [00:05<00:00, 1619.14it/s] 99%|███████████████████████████████████████████████████████████████████▍| 7408/7473 [00:05<00:00, 1615.14it/s]100%|████████████████████████████████████████████████████████████████████| 7473/7473 [00:05<00:00, 1338.47it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                         | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                         | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                         | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                         | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|████████████████▎                                | 1/3 [00:05<00:10,  5.04s/it]Loading checkpoint shards:  33%|████████████████▎                                | 1/3 [00:05<00:10,  5.15s/it]Loading checkpoint shards:  33%|████████████████▎                                | 1/3 [00:06<00:13,  6.66s/it]Loading checkpoint shards:  33%|████████████████▎                                | 1/3 [00:05<00:11,  5.66s/it]Loading checkpoint shards:  67%|████████████████████████████████▋                | 2/3 [00:10<00:05,  5.15s/it]Loading checkpoint shards:  67%|████████████████████████████████▋                | 2/3 [00:10<00:05,  5.49s/it]Loading checkpoint shards:  67%|████████████████████████████████▋                | 2/3 [00:12<00:05,  5.95s/it]Loading checkpoint shards:  67%|████████████████████████████████▋                | 2/3 [00:11<00:05,  5.48s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.44s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.62s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.84s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.98s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:17<00:00,  5.52s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:17<00:00,  5.71s/it]
[2023-08-16 07:34:57,643] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:15<00:00,  4.84s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.03s/it]
[2023-08-16 07:35:07,542] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-16 07:35:07,543] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-16 07:35:07,543] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-16 07:35:07,543] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-16 07:35:07,543] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-16 07:35:07,544] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-16 07:35:07,544] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-16 07:35:07,544] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-16 07:35:07,544] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-16 07:35:07,544] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-16 07:35:07,544] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-16 07:35:07,544] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fa312c9ec70>
[2023-08-16 07:35:07,544] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-16 07:35:07,544] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-16 07:35:07,544] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-16 07:35:07,544] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-16 07:35:07,544] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-16 07:35:07,544] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-16 07:35:07,544] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-16 07:35:07,544] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-16 07:35:07,544] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-16 07:35:07,544] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-16 07:35:07,544] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-16 07:35:07,544] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-16 07:35:07,544] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-16 07:35:07,544] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-16 07:35:07,544] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-16 07:35:07,544] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-16 07:35:07,544] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-16 07:35:07,544] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-16 07:35:07,544] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-16 07:35:07,544] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-16 07:35:07,544] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-16 07:35:07,544] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-16 07:35:07,544] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-16 07:35:07,544] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-16 07:35:07,544] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-16 07:35:07,544] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-16 07:35:07,544] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-16 07:35:07,544] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-16 07:35:07,544] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-16 07:35:07,544] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-16 07:35:07,545] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-16 07:35:07,545] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-16 07:35:07,545] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7fa312c9edc0>
[2023-08-16 07:35:07,545] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-16 07:35:07,545] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-16 07:35:07,545] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-16 07:35:07,545] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-16 07:35:07,545] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-16 07:35:07,545] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-16 07:35:07,545] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-16 07:35:07,545] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-16 07:35:07,545] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-16 07:35:07,545] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-16 07:35:07,545] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-16 07:35:07,545] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-16 07:35:07,545] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-16 07:35:07,545] [INFO] [config.py:1012:print]   train_batch_size ............. 8
[2023-08-16 07:35:07,545] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  2
[2023-08-16 07:35:07,545] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-16 07:35:07,545] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-16 07:35:07,545] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-16 07:35:07,545] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-16 07:35:07,545] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-16 07:35:07,545] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-16 07:35:07,545] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-16 07:35:07,545] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.4041903018951416 seconds
Loading extension module utils...
Time to load utils op: 0.4051985740661621 seconds
Loading extension module utils...
Time to load utils op: 0.4045844078063965 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating gsm8k :   0%|                                                               | 0/125 [00:00<?, ?it/s]############### Example ###############
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following grade math question.

### Demonstration:
Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Answer: A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Answer: D: accomplishing

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Answer: A: office

Input: Billy called out to John, and listened for what? Choices:  A: silence B: response C: communication D: hanging up E: whisper
Answer: B: response

Input: The lizard frightened the hiker, it's movements made what rustle? Choices:  A: garden B: trees C: books D: rocks E: bushes
Answer: E: bushes

### Input:Natalia sold clips to 48 of her friends in April, and then she sold half as many clips in May. How many clips did Natalia sell altogether in April and May?

### Response:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o5-tcommonsenseqa-s1-rFalse-m4096
Loading extension module utils...
Time to load utils op: 0.40538954734802246 seconds
Evaluating gsm8k :   1%|▍                                                    | 1/125 [01:04<2:12:18, 64.02s/it]Evaluating gsm8k :   2%|▊                                                    | 2/125 [01:44<1:43:08, 50.32s/it]Evaluating gsm8k :   2%|█▎                                                   | 3/125 [02:47<1:53:51, 56.00s/it]Evaluating gsm8k :   3%|█▋                                                   | 4/125 [03:31<1:43:20, 51.25s/it]Evaluating gsm8k :   4%|██                                                   | 5/125 [03:45<1:15:38, 37.82s/it]Evaluating gsm8k :   5%|██▌                                                  | 6/125 [04:31<1:20:14, 40.46s/it]Evaluating gsm8k :   6%|██▉                                                  | 7/125 [05:13<1:21:05, 41.23s/it]Evaluating gsm8k :   6%|███▍                                                 | 8/125 [05:40<1:11:03, 36.44s/it]Evaluating gsm8k :   7%|███▊                                                 | 9/125 [06:42<1:26:17, 44.64s/it]Evaluating gsm8k :   8%|████▏                                               | 10/125 [07:05<1:12:27, 37.80s/it]Evaluating gsm8k :   9%|████▌                                               | 11/125 [08:09<1:26:58, 45.78s/it]Evaluating gsm8k :  10%|████▉                                               | 12/125 [08:27<1:10:25, 37.39s/it]Evaluating gsm8k :  10%|█████▌                                                | 13/125 [08:33<52:19, 28.03s/it]Evaluating gsm8k :  11%|█████▊                                              | 14/125 [09:36<1:11:08, 38.46s/it]Evaluating gsm8k :  12%|██████▏                                             | 15/125 [09:58<1:01:27, 33.52s/it]Evaluating gsm8k :  13%|██████▋                                             | 16/125 [10:49<1:10:17, 38.69s/it]Evaluating gsm8k :  14%|███████                                             | 17/125 [11:23<1:07:21, 37.42s/it]Evaluating gsm8k :  14%|███████▍                                            | 18/125 [11:50<1:01:13, 34.33s/it]Evaluating gsm8k :  15%|████████▏                                             | 19/125 [12:21<58:40, 33.22s/it]Evaluating gsm8k :  16%|████████▎                                           | 20/125 [13:24<1:13:38, 42.08s/it]Evaluating gsm8k :  17%|████████▋                                           | 21/125 [13:43<1:01:21, 35.40s/it]Evaluating gsm8k :  18%|█████████▌                                            | 22/125 [14:10<56:14, 32.76s/it]Evaluating gsm8k :  18%|█████████▉                                            | 23/125 [14:27<47:41, 28.05s/it]Evaluating gsm8k :  19%|██████████▎                                           | 24/125 [14:42<40:43, 24.19s/it]Evaluating gsm8k :  20%|██████████▊                                           | 25/125 [15:17<45:26, 27.26s/it]Evaluating gsm8k :  21%|███████████▏                                          | 26/125 [15:24<35:01, 21.23s/it]Evaluating gsm8k :  22%|███████████▋                                          | 27/125 [16:27<55:02, 33.70s/it]Evaluating gsm8k :  22%|███████████▋                                        | 28/125 [17:29<1:08:35, 42.43s/it]Evaluating gsm8k :  23%|████████████                                        | 29/125 [18:07<1:05:45, 41.10s/it]Evaluating gsm8k :  24%|████████████▉                                         | 30/125 [18:26<54:29, 34.42s/it]Evaluating gsm8k :  25%|█████████████▍                                        | 31/125 [19:02<54:18, 34.67s/it]Evaluating gsm8k :  26%|█████████████▎                                      | 32/125 [20:04<1:06:41, 43.03s/it]Evaluating gsm8k :  26%|█████████████▋                                      | 33/125 [20:35<1:00:28, 39.44s/it]Evaluating gsm8k :  27%|██████████████▏                                     | 34/125 [21:28<1:05:46, 43.36s/it]Evaluating gsm8k :  28%|██████████████▌                                     | 35/125 [22:01<1:00:35, 40.39s/it]Evaluating gsm8k :  29%|███████████████▌                                      | 36/125 [22:18<49:21, 33.27s/it]Evaluating gsm8k :  30%|███████████████▍                                    | 37/125 [23:20<1:01:28, 41.92s/it]Evaluating gsm8k :  30%|███████████████▊                                    | 38/125 [24:21<1:09:21, 47.84s/it]Evaluating gsm8k :  31%|████████████████▏                                   | 39/125 [25:04<1:06:17, 46.25s/it]Evaluating gsm8k :  32%|████████████████▋                                   | 40/125 [25:38<1:00:23, 42.62s/it]Evaluating gsm8k :  33%|█████████████████                                   | 41/125 [26:42<1:08:26, 48.89s/it]Evaluating gsm8k :  34%|█████████████████▍                                  | 42/125 [27:44<1:13:06, 52.85s/it]Evaluating gsm8k :  34%|██████████████████▌                                   | 43/125 [27:53<54:16, 39.71s/it]Evaluating gsm8k :  35%|███████████████████                                   | 44/125 [28:24<50:12, 37.20s/it]Evaluating gsm8k :  36%|███████████████████▍                                  | 45/125 [28:46<43:23, 32.54s/it]Evaluating gsm8k :  37%|███████████████████▊                                  | 46/125 [29:09<39:00, 29.62s/it]Evaluating gsm8k :  38%|████████████████████▎                                 | 47/125 [30:11<51:22, 39.52s/it]Evaluating gsm8k :  38%|████████████████████▋                                 | 48/125 [30:30<42:52, 33.41s/it]Evaluating gsm8k :  39%|█████████████████████▏                                | 49/125 [31:32<52:58, 41.83s/it]Evaluating gsm8k :  40%|█████████████████████▌                                | 50/125 [32:23<55:36, 44.49s/it]Evaluating gsm8k :  41%|██████████████████████                                | 51/125 [32:42<45:28, 36.87s/it]Evaluating gsm8k :  42%|██████████████████████▍                               | 52/125 [32:59<37:51, 31.12s/it]Evaluating gsm8k :  42%|██████████████████████▉                               | 53/125 [33:25<35:14, 29.36s/it]Evaluating gsm8k :  43%|███████████████████████▎                              | 54/125 [34:11<40:43, 34.42s/it]Evaluating gsm8k :  44%|███████████████████████▊                              | 55/125 [35:12<49:35, 42.50s/it]Evaluating gsm8k :  45%|████████████████████████▏                             | 56/125 [35:35<42:09, 36.66s/it]Evaluating gsm8k :  46%|████████████████████████▌                             | 57/125 [36:33<48:45, 43.02s/it]Evaluating gsm8k :  46%|█████████████████████████                             | 58/125 [37:34<53:55, 48.29s/it]Evaluating gsm8k :  47%|█████████████████████████▍                            | 59/125 [37:55<44:14, 40.21s/it]Evaluating gsm8k :  48%|█████████████████████████▉                            | 60/125 [38:32<42:27, 39.19s/it]Evaluating gsm8k :  49%|██████████████████████████▎                           | 61/125 [38:53<35:56, 33.70s/it]Evaluating gsm8k :  50%|██████████████████████████▊                           | 62/125 [39:54<44:10, 42.07s/it]Evaluating gsm8k :  50%|███████████████████████████▏                          | 63/125 [40:08<34:41, 33.58s/it]Evaluating gsm8k :  51%|███████████████████████████▋                          | 64/125 [40:58<39:13, 38.59s/it]Evaluating gsm8k :  52%|████████████████████████████                          | 65/125 [41:46<41:08, 41.14s/it]Evaluating gsm8k :  53%|████████████████████████████▌                         | 66/125 [42:49<46:57, 47.75s/it]Evaluating gsm8k :  54%|████████████████████████████▉                         | 67/125 [43:13<39:18, 40.66s/it]Evaluating gsm8k :  54%|█████████████████████████████▍                        | 68/125 [43:48<36:58, 38.93s/it]Evaluating gsm8k :  55%|█████████████████████████████▊                        | 69/125 [44:33<38:03, 40.77s/it]Evaluating gsm8k :  56%|██████████████████████████████▏                       | 70/125 [45:23<40:05, 43.73s/it]Evaluating gsm8k :  57%|██████████████████████████████▋                       | 71/125 [45:40<32:02, 35.60s/it]Evaluating gsm8k :  58%|███████████████████████████████                       | 72/125 [46:36<36:44, 41.60s/it]Evaluating gsm8k :  58%|███████████████████████████████▌                      | 73/125 [46:52<29:29, 34.03s/it]Evaluating gsm8k :  59%|███████████████████████████████▉                      | 74/125 [47:55<36:25, 42.84s/it]Evaluating gsm8k :  60%|████████████████████████████████▍                     | 75/125 [48:20<31:09, 37.38s/it]Evaluating gsm8k :  61%|████████████████████████████████▊                     | 76/125 [49:22<36:39, 44.89s/it]Evaluating gsm8k :  62%|█████████████████████████████████▎                    | 77/125 [50:21<39:11, 49.00s/it]Evaluating gsm8k :  62%|█████████████████████████████████▋                    | 78/125 [51:23<41:23, 52.84s/it]Evaluating gsm8k :  63%|██████████████████████████████████▏                   | 79/125 [51:57<36:18, 47.37s/it]Evaluating gsm8k :  64%|██████████████████████████████████▌                   | 80/125 [53:00<38:52, 51.84s/it]Evaluating gsm8k :  65%|██████████████████████████████████▉                   | 81/125 [53:54<38:37, 52.66s/it]Evaluating gsm8k :  66%|███████████████████████████████████▍                  | 82/125 [54:34<35:02, 48.89s/it]Evaluating gsm8k :  66%|███████████████████████████████████▊                  | 83/125 [55:37<37:00, 52.87s/it]Evaluating gsm8k :  67%|████████████████████████████████████▎                 | 84/125 [55:56<29:13, 42.76s/it]Evaluating gsm8k :  68%|████████████████████████████████████▋                 | 85/125 [56:38<28:28, 42.71s/it]Evaluating gsm8k :  69%|█████████████████████████████████████▏                | 86/125 [57:27<28:58, 44.57s/it]Evaluating gsm8k :  70%|█████████████████████████████████████▌                | 87/125 [58:29<31:35, 49.87s/it]Evaluating gsm8k :  70%|██████████████████████████████████████                | 88/125 [58:36<22:44, 36.87s/it]Evaluating gsm8k :  71%|██████████████████████████████████████▍               | 89/125 [59:07<21:05, 35.17s/it]Evaluating gsm8k :  72%|██████████████████████████████████████▉               | 90/125 [59:53<22:20, 38.30s/it]Evaluating gsm8k :  73%|█████████████████████████████████████▊              | 91/125 [1:00:18<19:27, 34.34s/it]Evaluating gsm8k :  74%|██████████████████████████████████████▎             | 92/125 [1:00:39<16:41, 30.34s/it]Evaluating gsm8k :  74%|██████████████████████████████████████▋             | 93/125 [1:00:58<14:21, 26.93s/it]Evaluating gsm8k :  75%|███████████████████████████████████████             | 94/125 [1:01:24<13:44, 26.59s/it]Evaluating gsm8k :  76%|███████████████████████████████████████▌            | 95/125 [1:01:33<10:45, 21.51s/it]Evaluating gsm8k :  77%|███████████████████████████████████████▉            | 96/125 [1:02:36<16:19, 33.77s/it]Evaluating gsm8k :  78%|████████████████████████████████████████▎           | 97/125 [1:03:39<19:56, 42.74s/it]Evaluating gsm8k :  78%|████████████████████████████████████████▊           | 98/125 [1:03:51<15:04, 33.49s/it]Evaluating gsm8k :  79%|█████████████████████████████████████████▏          | 99/125 [1:04:35<15:46, 36.42s/it]Evaluating gsm8k :  80%|████████████████████████████████████████▊          | 100/125 [1:04:46<12:01, 28.85s/it]Evaluating gsm8k :  81%|█████████████████████████████████████████▏         | 101/125 [1:05:31<13:32, 33.86s/it]Evaluating gsm8k :  82%|█████████████████████████████████████████▌         | 102/125 [1:06:34<16:14, 42.37s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████         | 103/125 [1:07:37<17:49, 48.62s/it]Evaluating gsm8k :  83%|██████████████████████████████████████████▍        | 104/125 [1:08:18<16:16, 46.51s/it]Evaluating gsm8k :  84%|██████████████████████████████████████████▊        | 105/125 [1:09:20<17:03, 51.17s/it]Evaluating gsm8k :  85%|███████████████████████████████████████████▏       | 106/125 [1:09:57<14:50, 46.88s/it]Evaluating gsm8k :  86%|███████████████████████████████████████████▋       | 107/125 [1:10:27<12:33, 41.85s/it]Evaluating gsm8k :  86%|████████████████████████████████████████████       | 108/125 [1:10:37<09:06, 32.16s/it]Evaluating gsm8k :  87%|████████████████████████████████████████████▍      | 109/125 [1:11:40<11:04, 41.53s/it]Evaluating gsm8k :  88%|████████████████████████████████████████████▉      | 110/125 [1:11:58<08:33, 34.25s/it]Evaluating gsm8k :  89%|█████████████████████████████████████████████▎     | 111/125 [1:12:18<07:00, 30.01s/it]Evaluating gsm8k :  90%|█████████████████████████████████████████████▋     | 112/125 [1:13:21<08:41, 40.13s/it]Evaluating gsm8k :  90%|██████████████████████████████████████████████     | 113/125 [1:14:03<08:07, 40.59s/it]Evaluating gsm8k :  91%|██████████████████████████████████████████████▌    | 114/125 [1:14:21<06:12, 33.86s/it]Evaluating gsm8k :  92%|██████████████████████████████████████████████▉    | 115/125 [1:14:42<04:58, 29.87s/it]Evaluating gsm8k :  93%|███████████████████████████████████████████████▎   | 116/125 [1:15:08<04:19, 28.79s/it]Evaluating gsm8k :  94%|███████████████████████████████████████████████▋   | 117/125 [1:15:37<03:49, 28.75s/it]Evaluating gsm8k :  94%|████████████████████████████████████████████████▏  | 118/125 [1:16:03<03:15, 27.96s/it]Evaluating gsm8k :  95%|████████████████████████████████████████████████▌  | 119/125 [1:17:06<03:50, 38.40s/it]Evaluating gsm8k :  96%|████████████████████████████████████████████████▉  | 120/125 [1:17:31<02:52, 34.53s/it]Evaluating gsm8k :  97%|█████████████████████████████████████████████████▎ | 121/125 [1:18:34<02:52, 43.00s/it]Evaluating gsm8k :  98%|█████████████████████████████████████████████████▊ | 122/125 [1:19:36<02:26, 48.82s/it]Evaluating gsm8k :  98%|██████████████████████████████████████████████████▏| 123/125 [1:20:01<01:22, 41.47s/it]Evaluating gsm8k :  99%|██████████████████████████████████████████████████▌| 124/125 [1:20:19<00:34, 34.55s/it]Evaluating gsm8k : 100%|███████████████████████████████████████████████████| 125/125 [1:21:22<00:00, 42.96s/it]Evaluating gsm8k : 100%|███████████████████████████████████████████████████| 125/125 [1:21:22<00:00, 39.06s/it]
name: gsm8k | {'exact_match': 0.0, 'rougeL': 0.2536} | lm_loss 9.6622 | avg. gen lenth: 200.184
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name gsm8k --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name commonsenseqa --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --max-prompt-length 4096 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 2 --data-dir /scratch/ylu130/processed_data/gsm8k/out-domain/o6-tcommonsenseqa-s1-rFalse --seed 1 --num-out-domain 6
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-16 08:56:38,984] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... gsm8k
  data_dir ..................... /scratch/ylu130/processed_data/gsm8k/out-domain/o6-tcommonsenseqa-s1-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 6
  out_domain_data_name ......... commonsenseqa
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 4096
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o6-tcommonsenseqa-s1-rFalse-m4096
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 2
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                 | 0/7473 [00:00<?, ?it/s]  1%|▉                                                                      | 93/7473 [00:00<00:07, 928.38it/s]  3%|█▊                                                                    | 187/7473 [00:00<00:07, 934.64it/s]  4%|██▋                                                                   | 281/7473 [00:00<00:07, 934.55it/s]  5%|███▌                                                                  | 376/7473 [00:00<00:07, 938.42it/s]  6%|████▍                                                                 | 470/7473 [00:00<00:07, 936.71it/s]  8%|█████▎                                                                | 565/7473 [00:00<00:07, 939.55it/s]  9%|██████▏                                                               | 659/7473 [00:00<00:07, 936.37it/s] 10%|███████                                                               | 755/7473 [00:00<00:07, 943.37it/s] 11%|███████▉                                                              | 850/7473 [00:00<00:07, 922.73it/s] 13%|████████▊                                                             | 944/7473 [00:01<00:07, 925.31it/s] 14%|█████████▌                                                           | 1039/7473 [00:01<00:06, 932.21it/s] 15%|██████████▍                                                          | 1134/7473 [00:01<00:06, 935.99it/s] 16%|███████████▎                                                         | 1228/7473 [00:01<00:06, 935.64it/s] 18%|████████████▏                                                        | 1323/7473 [00:01<00:06, 938.40it/s] 19%|█████████████                                                        | 1417/7473 [00:01<00:06, 933.72it/s] 20%|█████████████▉                                                       | 1513/7473 [00:01<00:06, 938.87it/s] 22%|██████████████▊                                                      | 1607/7473 [00:01<00:06, 937.45it/s] 23%|███████████████▋                                                     | 1702/7473 [00:01<00:06, 939.23it/s] 24%|████████████████▌                                                    | 1796/7473 [00:01<00:06, 934.18it/s] 25%|█████████████████▍                                                   | 1890/7473 [00:02<00:05, 931.51it/s] 27%|██████████████████▎                                                  | 1984/7473 [00:02<00:05, 932.42it/s] 28%|███████████████████▏                                                 | 2078/7473 [00:02<00:05, 933.91it/s] 29%|████████████████████                                                 | 2172/7473 [00:02<00:05, 934.85it/s] 31%|████████████████████▊                                               | 2294/7473 [00:02<00:05, 1019.92it/s] 33%|██████████████████████▏                                             | 2439/7473 [00:02<00:04, 1148.43it/s] 34%|███████████████████████▍                                            | 2569/7473 [00:02<00:04, 1192.07it/s] 36%|████████████████████████▋                                           | 2714/7473 [00:02<00:03, 1268.11it/s] 38%|█████████████████████████▉                                          | 2857/7473 [00:02<00:03, 1314.46it/s] 40%|███████████████████████████▎                                        | 3002/7473 [00:02<00:03, 1354.60it/s] 42%|████████████████████████████▌                                       | 3145/7473 [00:03<00:03, 1374.88it/s] 44%|█████████████████████████████▉                                      | 3288/7473 [00:03<00:03, 1389.81it/s] 46%|███████████████████████████████▏                                    | 3428/7473 [00:03<00:02, 1392.03it/s] 48%|████████████████████████████████▌                                   | 3572/7473 [00:03<00:02, 1403.58it/s] 50%|█████████████████████████████████▊                                  | 3714/7473 [00:03<00:02, 1406.72it/s] 52%|███████████████████████████████████                                 | 3857/7473 [00:03<00:02, 1411.95it/s] 54%|████████████████████████████████████▍                               | 3999/7473 [00:03<00:02, 1412.76it/s] 55%|█████████████████████████████████████▋                              | 4141/7473 [00:03<00:02, 1412.90it/s] 57%|██████████████████████████████████████▉                             | 4284/7473 [00:03<00:02, 1416.37it/s] 59%|████████████████████████████████████████▎                           | 4426/7473 [00:03<00:02, 1416.25it/s] 61%|█████████████████████████████████████████▌                          | 4568/7473 [00:04<00:02, 1415.66it/s] 63%|██████████████████████████████████████████▊                         | 4710/7473 [00:04<00:01, 1415.48it/s] 65%|████████████████████████████████████████████▏                       | 4853/7473 [00:04<00:01, 1417.30it/s] 67%|█████████████████████████████████████████████▍                      | 4997/7473 [00:04<00:01, 1421.43it/s] 69%|██████████████████████████████████████████████▊                     | 5140/7473 [00:04<00:01, 1414.67it/s] 71%|████████████████████████████████████████████████                    | 5282/7473 [00:04<00:01, 1371.83it/s] 73%|█████████████████████████████████████████████████▎                  | 5425/7473 [00:04<00:01, 1388.39it/s] 74%|██████████████████████████████████████████████████▋                 | 5565/7473 [00:04<00:01, 1067.13it/s] 76%|███████████████████████████████████████████████████▉                | 5707/7473 [00:04<00:01, 1152.38it/s] 78%|█████████████████████████████████████████████████████▏              | 5850/7473 [00:05<00:01, 1223.28it/s] 80%|██████████████████████████████████████████████████████▌             | 5991/7473 [00:05<00:01, 1272.56it/s] 82%|███████████████████████████████████████████████████████▊            | 6134/7473 [00:05<00:01, 1314.99it/s] 84%|█████████████████████████████████████████████████████████           | 6277/7473 [00:05<00:00, 1347.40it/s] 86%|██████████████████████████████████████████████████████████▍         | 6419/7473 [00:05<00:00, 1366.06it/s] 88%|███████████████████████████████████████████████████████████▋        | 6562/7473 [00:05<00:00, 1384.23it/s] 90%|█████████████████████████████████████████████████████████████       | 6704/7473 [00:05<00:00, 1392.55it/s] 92%|██████████████████████████████████████████████████████████████▎     | 6845/7473 [00:05<00:00, 1397.47it/s] 93%|███████████████████████████████████████████████████████████████▌    | 6986/7473 [00:05<00:00, 1391.93it/s] 95%|████████████████████████████████████████████████████████████████▊   | 7128/7473 [00:05<00:00, 1398.88it/s] 97%|██████████████████████████████████████████████████████████████████▏ | 7270/7473 [00:06<00:00, 1403.80it/s] 99%|███████████████████████████████████████████████████████████████████▍| 7413/7473 [00:06<00:00, 1410.61it/s]100%|████████████████████████████████████████████████████████████████████| 7473/7473 [00:06<00:00, 1206.21it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                         | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                         | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                         | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                         | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|████████████████▎                                | 1/3 [00:05<00:10,  5.07s/it]Loading checkpoint shards:  33%|████████████████▎                                | 1/3 [00:05<00:10,  5.47s/it]Loading checkpoint shards:  33%|████████████████▎                                | 1/3 [00:05<00:11,  5.83s/it]Loading checkpoint shards:  33%|████████████████▎                                | 1/3 [00:05<00:11,  5.62s/it]Loading checkpoint shards:  67%|████████████████████████████████▋                | 2/3 [00:09<00:04,  4.96s/it]Loading checkpoint shards:  67%|████████████████████████████████▋                | 2/3 [00:10<00:05,  5.42s/it]Loading checkpoint shards:  67%|████████████████████████████████▋                | 2/3 [00:11<00:05,  5.55s/it]Loading checkpoint shards:  67%|████████████████████████████████▋                | 2/3 [00:10<00:05,  5.40s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.41s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.57s/it]
[2023-08-16 08:57:36,054] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.74s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.93s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.82s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:14<00:00,  5.00s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.17s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.30s/it]
[2023-08-16 08:57:54,417] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-16 08:57:54,418] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-16 08:57:54,418] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-16 08:57:54,418] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-16 08:57:54,418] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-16 08:57:54,418] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-16 08:57:54,419] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-16 08:57:54,419] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-16 08:57:54,419] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-16 08:57:54,419] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-16 08:57:54,419] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-16 08:57:54,419] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f655b4b6fd0>
[2023-08-16 08:57:54,419] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-16 08:57:54,419] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-16 08:57:54,419] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-16 08:57:54,419] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-16 08:57:54,419] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-16 08:57:54,419] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-16 08:57:54,419] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-16 08:57:54,419] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-16 08:57:54,419] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-16 08:57:54,419] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-16 08:57:54,419] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-16 08:57:54,419] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-16 08:57:54,419] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-16 08:57:54,419] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-16 08:57:54,419] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-16 08:57:54,419] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-16 08:57:54,419] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-16 08:57:54,419] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-16 08:57:54,419] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-16 08:57:54,419] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-16 08:57:54,419] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-16 08:57:54,419] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-16 08:57:54,419] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-16 08:57:54,419] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-16 08:57:54,419] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-16 08:57:54,419] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-16 08:57:54,419] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-16 08:57:54,419] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-16 08:57:54,419] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-16 08:57:54,419] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-16 08:57:54,420] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-16 08:57:54,420] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-16 08:57:54,420] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f655b4b6be0>
[2023-08-16 08:57:54,420] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-16 08:57:54,420] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-16 08:57:54,420] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-16 08:57:54,420] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-16 08:57:54,420] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-16 08:57:54,420] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-16 08:57:54,420] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-16 08:57:54,420] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-16 08:57:54,420] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-16 08:57:54,420] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-16 08:57:54,420] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-16 08:57:54,420] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-16 08:57:54,420] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-16 08:57:54,420] [INFO] [config.py:1012:print]   train_batch_size ............. 8
[2023-08-16 08:57:54,420] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  2
[2023-08-16 08:57:54,420] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-16 08:57:54,420] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-16 08:57:54,420] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-16 08:57:54,420] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-16 08:57:54,420] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-16 08:57:54,420] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-16 08:57:54,420] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-16 08:57:54,420] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.4035496711730957 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating gsm8k :   0%|                                                               | 0/125 [00:00<?, ?it/s]############### Example ###############
Loading extension module utils...
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following grade math question.

### Demonstration:
Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Answer: A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Answer: D: accomplishing

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Answer: A: office

Input: Billy called out to John, and listened for what? Choices:  A: silence B: response C: communication D: hanging up E: whisper
Answer: B: response

Input: The lizard frightened the hiker, it's movements made what rustle? Choices:  A: garden B: trees C: books D: rocks E: bushes
Answer: E: bushes

Input: The man spent big money and time maintaining his lawn, it was part of keeping up with the Joneses where? Choices:  A: front yard B: suburbia C: neighborhood D: back yard E: golf course
Answer: B: suburbia

### Input:Natalia sold clips to 48 of her friends in April, and then she sold half as many clips in May. How many clips did Natalia sell altogether in April and May?

### Response:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o6-tcommonsenseqa-s1-rFalse-m4096
Time to load utils op: 0.40459465980529785 seconds
Loading extension module utils...
Time to load utils op: 0.30423879623413086 seconds
Loading extension module utils...
Time to load utils op: 0.3040199279785156 seconds
Evaluating gsm8k :   1%|▍                                                      | 1/125 [00:15<31:34, 15.28s/it]Evaluating gsm8k :   2%|▉                                                      | 2/125 [00:41<44:48, 21.85s/it]Evaluating gsm8k :   2%|█▎                                                   | 3/125 [01:42<1:20:27, 39.57s/it]Evaluating gsm8k :   3%|█▋                                                   | 4/125 [02:43<1:36:47, 48.00s/it]Evaluating gsm8k :   4%|██                                                   | 5/125 [02:57<1:11:54, 35.95s/it]Evaluating gsm8k :   5%|██▌                                                  | 6/125 [03:35<1:12:38, 36.63s/it]Evaluating gsm8k :   6%|███                                                    | 7/125 [03:47<56:08, 28.54s/it]Evaluating gsm8k :   6%|███▍                                                 | 8/125 [04:49<1:16:05, 39.02s/it]Evaluating gsm8k :   7%|███▊                                                 | 9/125 [05:50<1:28:45, 45.91s/it]Evaluating gsm8k :   8%|████▏                                               | 10/125 [06:39<1:29:56, 46.92s/it]Evaluating gsm8k :   9%|████▌                                               | 11/125 [06:59<1:13:44, 38.81s/it]Evaluating gsm8k :  10%|████▉                                               | 12/125 [07:29<1:07:40, 35.93s/it]Evaluating gsm8k :  10%|█████▍                                              | 13/125 [08:31<1:21:50, 43.84s/it]Evaluating gsm8k :  11%|█████▊                                              | 14/125 [09:12<1:19:44, 43.10s/it]Evaluating gsm8k :  12%|██████▏                                             | 15/125 [09:51<1:16:49, 41.91s/it]Evaluating gsm8k :  13%|██████▋                                             | 16/125 [10:46<1:22:52, 45.62s/it]Evaluating gsm8k :  14%|███████                                             | 17/125 [11:46<1:30:12, 50.11s/it]Evaluating gsm8k :  14%|███████▍                                            | 18/125 [11:59<1:09:12, 38.81s/it]Evaluating gsm8k :  15%|███████▉                                            | 19/125 [12:34<1:06:45, 37.79s/it]Evaluating gsm8k :  16%|████████▋                                             | 20/125 [12:40<49:38, 28.36s/it]Evaluating gsm8k :  17%|█████████                                             | 21/125 [13:12<50:54, 29.37s/it]Evaluating gsm8k :  18%|█████████▏                                          | 22/125 [14:13<1:06:32, 38.76s/it]Evaluating gsm8k :  18%|█████████▉                                            | 23/125 [14:35<57:41, 33.94s/it]Evaluating gsm8k :  19%|██████████▎                                           | 24/125 [14:47<45:43, 27.16s/it]Evaluating gsm8k :  20%|██████████▊                                           | 25/125 [15:05<40:52, 24.53s/it]Evaluating gsm8k :  21%|███████████▏                                          | 26/125 [16:07<59:01, 35.78s/it]Evaluating gsm8k :  22%|███████████▏                                        | 27/125 [16:52<1:02:43, 38.40s/it]Evaluating gsm8k :  22%|████████████                                          | 28/125 [17:12<53:23, 33.03s/it]Evaluating gsm8k :  23%|████████████                                        | 29/125 [18:15<1:07:00, 41.88s/it]Evaluating gsm8k :  24%|████████████▉                                         | 30/125 [18:37<57:01, 36.01s/it]Evaluating gsm8k :  25%|█████████████▍                                        | 31/125 [19:04<52:17, 33.38s/it]Evaluating gsm8k :  26%|█████████████▊                                        | 32/125 [19:27<46:40, 30.12s/it]Evaluating gsm8k :  26%|██████████████▎                                       | 33/125 [19:42<39:07, 25.52s/it]Evaluating gsm8k :  27%|██████████████▋                                       | 34/125 [20:19<44:10, 29.13s/it]Evaluating gsm8k :  28%|███████████████                                       | 35/125 [20:55<46:34, 31.05s/it]Evaluating gsm8k :  29%|███████████████▌                                      | 36/125 [21:56<59:38, 40.21s/it]Evaluating gsm8k :  30%|███████████████▍                                    | 37/125 [22:58<1:08:31, 46.72s/it]Evaluating gsm8k :  30%|███████████████▊                                    | 38/125 [23:38<1:04:56, 44.79s/it]Evaluating gsm8k :  31%|████████████████▊                                     | 39/125 [23:54<51:30, 35.94s/it]Evaluating gsm8k :  32%|████████████████▋                                   | 40/125 [24:55<1:01:37, 43.50s/it]Evaluating gsm8k :  33%|█████████████████▋                                    | 41/125 [25:32<58:07, 41.52s/it]Evaluating gsm8k :  34%|██████████████████▏                                   | 42/125 [26:11<56:27, 40.82s/it]Evaluating gsm8k :  34%|█████████████████▉                                  | 43/125 [27:05<1:01:23, 44.92s/it]Evaluating gsm8k :  35%|███████████████████                                   | 44/125 [27:29<52:01, 38.54s/it]Evaluating gsm8k :  36%|███████████████████▍                                  | 45/125 [27:37<38:58, 29.23s/it]Evaluating gsm8k :  37%|███████████████████▊                                  | 46/125 [27:48<31:27, 23.89s/it]Evaluating gsm8k :  38%|████████████████████▎                                 | 47/125 [28:23<35:30, 27.32s/it]Evaluating gsm8k :  38%|████████████████████▋                                 | 48/125 [29:24<47:49, 37.27s/it]Evaluating gsm8k :  39%|█████████████████████▏                                | 49/125 [30:08<49:55, 39.42s/it]Evaluating gsm8k :  40%|█████████████████████▌                                | 50/125 [30:29<42:13, 33.78s/it]Evaluating gsm8k :  41%|██████████████████████                                | 51/125 [30:37<31:59, 25.94s/it]Evaluating gsm8k :  42%|██████████████████████▍                               | 52/125 [31:37<44:06, 36.26s/it]Evaluating gsm8k :  42%|██████████████████████▉                               | 53/125 [31:55<36:50, 30.70s/it]Evaluating gsm8k :  43%|███████████████████████▎                              | 54/125 [32:35<39:42, 33.55s/it]Evaluating gsm8k :  44%|███████████████████████▊                              | 55/125 [33:14<41:15, 35.36s/it]Evaluating gsm8k :  45%|████████████████████████▏                             | 56/125 [34:16<49:43, 43.24s/it]Evaluating gsm8k :  46%|████████████████████████▌                             | 57/125 [34:53<46:44, 41.24s/it]Evaluating gsm8k :  46%|█████████████████████████                             | 58/125 [35:11<38:26, 34.42s/it]Evaluating gsm8k :  47%|█████████████████████████▍                            | 59/125 [36:11<46:21, 42.15s/it]Evaluating gsm8k :  48%|█████████████████████████▉                            | 60/125 [36:40<41:08, 37.97s/it]Evaluating gsm8k :  49%|██████████████████████████▎                           | 61/125 [37:40<47:40, 44.70s/it]Evaluating gsm8k :  50%|██████████████████████████▊                           | 62/125 [38:21<45:50, 43.66s/it]Evaluating gsm8k :  50%|███████████████████████████▏                          | 63/125 [39:15<48:07, 46.57s/it]Evaluating gsm8k :  51%|███████████████████████████▋                          | 64/125 [39:53<44:58, 44.24s/it]Evaluating gsm8k :  52%|████████████████████████████                          | 65/125 [40:51<48:19, 48.33s/it]Evaluating gsm8k :  53%|████████████████████████████▌                         | 66/125 [41:00<35:55, 36.54s/it]Evaluating gsm8k :  54%|████████████████████████████▉                         | 67/125 [41:13<28:33, 29.55s/it]Evaluating gsm8k :  54%|█████████████████████████████▍                        | 68/125 [41:39<26:54, 28.32s/it]Evaluating gsm8k :  55%|█████████████████████████████▊                        | 69/125 [42:41<35:56, 38.51s/it]Evaluating gsm8k :  56%|██████████████████████████████▏                       | 70/125 [43:32<38:33, 42.07s/it]Evaluating gsm8k :  57%|██████████████████████████████▋                       | 71/125 [44:14<37:50, 42.04s/it]Evaluating gsm8k :  58%|███████████████████████████████                       | 72/125 [44:49<35:28, 40.17s/it]Evaluating gsm8k :  58%|███████████████████████████████▌                      | 73/125 [45:11<29:56, 34.55s/it]Evaluating gsm8k :  59%|███████████████████████████████▉                      | 74/125 [45:36<26:56, 31.70s/it]Evaluating gsm8k :  60%|████████████████████████████████▍                     | 75/125 [45:47<21:18, 25.57s/it]Evaluating gsm8k :  61%|████████████████████████████████▊                     | 76/125 [46:30<25:00, 30.62s/it]Evaluating gsm8k :  62%|█████████████████████████████████▎                    | 77/125 [46:51<22:13, 27.79s/it]Evaluating gsm8k :  62%|█████████████████████████████████▋                    | 78/125 [47:42<27:16, 34.83s/it]Evaluating gsm8k :  63%|██████████████████████████████████▏                   | 79/125 [48:24<28:17, 36.91s/it]Evaluating gsm8k :  64%|██████████████████████████████████▌                   | 80/125 [48:51<25:29, 33.98s/it]Evaluating gsm8k :  65%|██████████████████████████████████▉                   | 81/125 [49:05<20:37, 28.13s/it]Evaluating gsm8k :  66%|███████████████████████████████████▍                  | 82/125 [50:06<27:04, 37.79s/it]Evaluating gsm8k :  66%|███████████████████████████████████▊                  | 83/125 [50:20<21:32, 30.77s/it]Evaluating gsm8k :  67%|████████████████████████████████████▎                 | 84/125 [51:07<24:17, 35.54s/it]Evaluating gsm8k :  68%|████████████████████████████████████▋                 | 85/125 [51:47<24:43, 37.09s/it]Evaluating gsm8k :  69%|█████████████████████████████████████▏                | 86/125 [52:22<23:35, 36.30s/it]Evaluating gsm8k :  70%|█████████████████████████████████████▌                | 87/125 [53:23<27:43, 43.77s/it]Evaluating gsm8k :  70%|██████████████████████████████████████                | 88/125 [53:44<22:48, 36.99s/it]Evaluating gsm8k :  71%|██████████████████████████████████████▍               | 89/125 [54:16<21:17, 35.48s/it]Evaluating gsm8k :  72%|██████████████████████████████████████▉               | 90/125 [55:19<25:25, 43.59s/it]Evaluating gsm8k :  73%|███████████████████████████████████████▎              | 91/125 [55:40<20:49, 36.76s/it]Evaluating gsm8k :  74%|███████████████████████████████████████▋              | 92/125 [56:40<24:05, 43.82s/it]Evaluating gsm8k :  74%|████████████████████████████████████████▏             | 93/125 [57:23<23:12, 43.52s/it]Evaluating gsm8k :  75%|████████████████████████████████████████▌             | 94/125 [58:23<25:07, 48.64s/it]Evaluating gsm8k :  76%|█████████████████████████████████████████             | 95/125 [58:53<21:33, 43.10s/it]Evaluating gsm8k :  77%|█████████████████████████████████████████▍            | 96/125 [59:19<18:14, 37.74s/it]Evaluating gsm8k :  78%|████████████████████████████████████████▎           | 97/125 [1:00:01<18:13, 39.06s/it]Evaluating gsm8k :  78%|████████████████████████████████████████▊           | 98/125 [1:00:17<14:30, 32.22s/it]Evaluating gsm8k :  79%|█████████████████████████████████████████▏          | 99/125 [1:00:34<12:00, 27.70s/it]Evaluating gsm8k :  80%|████████████████████████████████████████▊          | 100/125 [1:01:06<12:00, 28.81s/it]Evaluating gsm8k :  81%|█████████████████████████████████████████▏         | 101/125 [1:01:19<09:38, 24.10s/it]Evaluating gsm8k :  82%|█████████████████████████████████████████▌         | 102/125 [1:01:59<11:05, 28.96s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████         | 103/125 [1:02:38<11:42, 31.94s/it]Evaluating gsm8k :  83%|██████████████████████████████████████████▍        | 104/125 [1:03:40<14:21, 41.02s/it]Evaluating gsm8k :  84%|██████████████████████████████████████████▊        | 105/125 [1:03:52<10:46, 32.35s/it]Evaluating gsm8k :  85%|███████████████████████████████████████████▏       | 106/125 [1:04:14<09:11, 29.03s/it]Evaluating gsm8k :  86%|███████████████████████████████████████████▋       | 107/125 [1:04:27<07:16, 24.25s/it]Evaluating gsm8k :  86%|████████████████████████████████████████████       | 108/125 [1:05:27<09:56, 35.06s/it]Evaluating gsm8k :  87%|████████████████████████████████████████████▍      | 109/125 [1:05:48<08:13, 30.82s/it]Evaluating gsm8k :  88%|████████████████████████████████████████████▉      | 110/125 [1:06:24<08:08, 32.56s/it]Evaluating gsm8k :  89%|█████████████████████████████████████████████▎     | 111/125 [1:06:54<07:21, 31.53s/it]Evaluating gsm8k :  90%|█████████████████████████████████████████████▋     | 112/125 [1:07:36<07:33, 34.85s/it]Evaluating gsm8k :  90%|██████████████████████████████████████████████     | 113/125 [1:08:24<07:43, 38.62s/it]Evaluating gsm8k :  91%|██████████████████████████████████████████████▌    | 114/125 [1:08:50<06:25, 35.04s/it]Evaluating gsm8k :  92%|██████████████████████████████████████████████▉    | 115/125 [1:09:51<07:07, 42.72s/it]Evaluating gsm8k :  93%|███████████████████████████████████████████████▎   | 116/125 [1:10:07<05:12, 34.67s/it]Evaluating gsm8k :  94%|███████████████████████████████████████████████▋   | 117/125 [1:10:38<04:29, 33.66s/it]Evaluating gsm8k :  94%|████████████████████████████████████████████████▏  | 118/125 [1:11:20<04:12, 36.11s/it]Evaluating gsm8k :  95%|████████████████████████████████████████████████▌  | 119/125 [1:11:34<02:56, 29.42s/it]Evaluating gsm8k :  96%|████████████████████████████████████████████████▉  | 120/125 [1:11:46<02:01, 24.40s/it]Evaluating gsm8k :  97%|█████████████████████████████████████████████████▎ | 121/125 [1:12:03<01:28, 22.17s/it]Evaluating gsm8k :  98%|█████████████████████████████████████████████████▊ | 122/125 [1:12:42<01:21, 27.23s/it]Evaluating gsm8k :  98%|██████████████████████████████████████████████████▏| 123/125 [1:13:17<00:59, 29.55s/it]Evaluating gsm8k :  99%|██████████████████████████████████████████████████▌| 124/125 [1:13:42<00:28, 28.08s/it]Evaluating gsm8k : 100%|███████████████████████████████████████████████████| 125/125 [1:14:43<00:00, 37.90s/it]Evaluating gsm8k : 100%|███████████████████████████████████████████████████| 125/125 [1:14:43<00:00, 35.87s/it]
name: gsm8k | {'exact_match': 0.0, 'rougeL': 0.2272} | lm_loss 9.7109 | avg. gen lenth: 192.144
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name gsm8k --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name commonsenseqa --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --max-prompt-length 4096 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 2 --data-dir /scratch/ylu130/processed_data/gsm8k/out-domain/o7-tcommonsenseqa-s1-rFalse --seed 1 --num-out-domain 7
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-16 10:19:40,448] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... gsm8k
  data_dir ..................... /scratch/ylu130/processed_data/gsm8k/out-domain/o7-tcommonsenseqa-s1-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 7
  out_domain_data_name ......... commonsenseqa
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 4096
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o7-tcommonsenseqa-s1-rFalse-m4096
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 2
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                 | 0/7473 [00:00<?, ?it/s]  1%|▊                                                                      | 82/7473 [00:00<00:09, 817.96it/s]  2%|█▌                                                                    | 166/7473 [00:00<00:08, 826.13it/s]  3%|██▎                                                                   | 250/7473 [00:00<00:08, 825.72it/s]  4%|███▏                                                                  | 334/7473 [00:00<00:08, 830.60it/s]  6%|███▉                                                                  | 418/7473 [00:00<00:08, 827.42it/s]  7%|████▋                                                                 | 501/7473 [00:00<00:08, 824.19it/s]  8%|█████▍                                                                | 585/7473 [00:00<00:08, 829.10it/s]  9%|██████▎                                                               | 668/7473 [00:00<00:08, 828.22it/s] 10%|███████                                                               | 751/7473 [00:00<00:08, 817.18it/s] 11%|███████▊                                                              | 833/7473 [00:01<00:08, 816.78it/s] 12%|████████▌                                                             | 917/7473 [00:01<00:07, 820.92it/s] 13%|█████████▏                                                           | 1001/7473 [00:01<00:07, 825.08it/s] 15%|██████████                                                           | 1086/7473 [00:01<00:07, 829.94it/s] 16%|██████████▊                                                          | 1170/7473 [00:01<00:07, 827.00it/s] 17%|███████████▌                                                         | 1253/7473 [00:01<00:07, 826.29it/s] 18%|████████████▎                                                        | 1337/7473 [00:01<00:07, 828.67it/s] 19%|█████████████                                                        | 1420/7473 [00:01<00:07, 824.42it/s] 20%|█████████████▉                                                       | 1504/7473 [00:01<00:07, 827.96it/s] 21%|██████████████▋                                                      | 1587/7473 [00:01<00:07, 821.19it/s] 22%|███████████████▍                                                     | 1670/7473 [00:02<00:07, 820.57it/s] 23%|████████████████▏                                                    | 1754/7473 [00:02<00:06, 823.91it/s] 25%|████████████████▉                                                    | 1837/7473 [00:02<00:06, 822.75it/s] 26%|█████████████████▋                                                   | 1920/7473 [00:02<00:06, 821.64it/s] 27%|██████████████████▍                                                  | 2003/7473 [00:02<00:06, 822.74it/s] 28%|███████████████████▍                                                 | 2099/7473 [00:02<00:06, 861.43it/s] 30%|████████████████████▌                                                | 2225/7473 [00:02<00:05, 978.72it/s] 31%|█████████████████████▍                                              | 2351/7473 [00:02<00:04, 1060.35it/s] 33%|██████████████████████▌                                             | 2478/7473 [00:02<00:04, 1122.83it/s] 35%|███████████████████████▌                                            | 2591/7473 [00:02<00:04, 1120.93it/s] 36%|████████████████████████▋                                           | 2719/7473 [00:03<00:04, 1167.81it/s] 38%|█████████████████████████▉                                          | 2846/7473 [00:03<00:03, 1196.79it/s] 40%|███████████████████████████                                         | 2973/7473 [00:03<00:03, 1218.47it/s] 41%|████████████████████████████▏                                       | 3099/7473 [00:03<00:03, 1229.40it/s] 43%|█████████████████████████████▎                                      | 3223/7473 [00:03<00:03, 1231.22it/s] 45%|██████████████████████████████▍                                     | 3349/7473 [00:03<00:03, 1237.75it/s] 46%|███████████████████████████████▌                                    | 3473/7473 [00:03<00:03, 1235.19it/s] 48%|████████████████████████████████▊                                   | 3600/7473 [00:03<00:03, 1242.12it/s] 50%|█████████████████████████████████▉                                  | 3725/7473 [00:03<00:03, 1235.58it/s] 52%|███████████████████████████████████                                 | 3851/7473 [00:03<00:02, 1240.50it/s] 53%|████████████████████████████████████▏                               | 3977/7473 [00:04<00:02, 1243.36it/s] 55%|█████████████████████████████████████▎                              | 4104/7473 [00:04<00:02, 1251.27it/s] 57%|██████████████████████████████████████▍                             | 4230/7473 [00:04<00:02, 1248.02it/s] 58%|███████████████████████████████████████▋                            | 4355/7473 [00:04<00:02, 1246.66it/s] 60%|████████████████████████████████████████▊                           | 4480/7473 [00:04<00:02, 1245.80it/s] 62%|█████████████████████████████████████████▉                          | 4606/7473 [00:04<00:02, 1249.23it/s] 63%|███████████████████████████████████████████                         | 4732/7473 [00:04<00:02, 1250.78it/s] 65%|████████████████████████████████████████████▏                       | 4858/7473 [00:04<00:02, 1251.61it/s] 67%|█████████████████████████████████████████████▎                      | 4984/7473 [00:04<00:01, 1253.47it/s] 68%|██████████████████████████████████████████████▍                     | 5110/7473 [00:04<00:01, 1252.58it/s] 70%|███████████████████████████████████████████████▋                    | 5236/7473 [00:05<00:01, 1254.15it/s] 72%|████████████████████████████████████████████████▊                   | 5362/7473 [00:05<00:01, 1218.44it/s] 73%|██████████████████████████████████████████████████▋                  | 5485/7473 [00:05<00:02, 931.07it/s] 75%|███████████████████████████████████████████████████                 | 5610/7473 [00:05<00:01, 1008.10it/s] 77%|████████████████████████████████████████████████████▏               | 5736/7473 [00:05<00:01, 1070.76it/s] 78%|█████████████████████████████████████████████████████▎              | 5861/7473 [00:05<00:01, 1118.27it/s] 80%|██████████████████████████████████████████████████████▍             | 5985/7473 [00:05<00:01, 1149.76it/s] 82%|███████████████████████████████████████████████████████▌            | 6108/7473 [00:05<00:01, 1171.80it/s] 83%|████████████████████████████████████████████████████████▋           | 6233/7473 [00:05<00:01, 1191.62it/s] 85%|█████████████████████████████████████████████████████████▊          | 6359/7473 [00:06<00:00, 1210.30it/s] 87%|███████████████████████████████████████████████████████████         | 6484/7473 [00:06<00:00, 1221.15it/s] 88%|████████████████████████████████████████████████████████████▏       | 6610/7473 [00:06<00:00, 1230.62it/s] 90%|█████████████████████████████████████████████████████████████▎      | 6734/7473 [00:06<00:00, 1232.79it/s] 92%|██████████████████████████████████████████████████████████████▍     | 6858/7473 [00:06<00:00, 1233.31it/s] 93%|███████████████████████████████████████████████████████████████▌    | 6984/7473 [00:06<00:00, 1240.52it/s] 95%|████████████████████████████████████████████████████████████████▋   | 7109/7473 [00:06<00:00, 1238.56it/s] 97%|█████████████████████████████████████████████████████████████████▊  | 7234/7473 [00:06<00:00, 1241.07it/s] 98%|██████████████████████████████████████████████████████████████████▉ | 7359/7473 [00:06<00:00, 1243.56it/s]100%|████████████████████████████████████████████████████████████████████| 7473/7473 [00:06<00:00, 1073.57it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                         | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                         | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                         | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                         | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|████████████████▎                                | 1/3 [00:05<00:10,  5.29s/it]Loading checkpoint shards:  33%|████████████████▎                                | 1/3 [00:05<00:10,  5.20s/it]Loading checkpoint shards:  33%|████████████████▎                                | 1/3 [00:05<00:10,  5.50s/it]Loading checkpoint shards:  33%|████████████████▎                                | 1/3 [00:05<00:11,  5.93s/it]Loading checkpoint shards:  67%|████████████████████████████████▋                | 2/3 [00:10<00:05,  5.17s/it]Loading checkpoint shards:  67%|████████████████████████████████▋                | 2/3 [00:10<00:05,  5.02s/it]Loading checkpoint shards:  67%|████████████████████████████████▋                | 2/3 [00:10<00:05,  5.26s/it]Loading checkpoint shards:  67%|████████████████████████████████▋                | 2/3 [00:11<00:05,  5.55s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.38s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.57s/it]
[2023-08-16 10:20:38,404] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.63s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.78s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.74s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.91s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.15s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.30s/it]
[2023-08-16 10:20:54,559] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-16 10:20:54,561] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-16 10:20:54,561] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-16 10:20:54,561] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-16 10:20:54,561] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-16 10:20:54,561] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-16 10:20:54,562] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-16 10:20:54,562] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-16 10:20:54,562] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-16 10:20:54,562] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-16 10:20:54,562] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-16 10:20:54,562] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f8becccbfd0>
[2023-08-16 10:20:54,562] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-16 10:20:54,562] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-16 10:20:54,562] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-16 10:20:54,562] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-16 10:20:54,562] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-16 10:20:54,562] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-16 10:20:54,562] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-16 10:20:54,562] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-16 10:20:54,562] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-16 10:20:54,562] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-16 10:20:54,562] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-16 10:20:54,562] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-16 10:20:54,562] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-16 10:20:54,562] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-16 10:20:54,562] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-16 10:20:54,562] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-16 10:20:54,562] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-16 10:20:54,562] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-16 10:20:54,562] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-16 10:20:54,562] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-16 10:20:54,562] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-16 10:20:54,562] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-16 10:20:54,562] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-16 10:20:54,563] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-16 10:20:54,563] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-16 10:20:54,563] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-16 10:20:54,563] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-16 10:20:54,563] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-16 10:20:54,563] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-16 10:20:54,563] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-16 10:20:54,563] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-16 10:20:54,563] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-16 10:20:54,563] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f8becccbbe0>
[2023-08-16 10:20:54,563] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-16 10:20:54,563] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-16 10:20:54,563] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-16 10:20:54,563] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-16 10:20:54,563] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-16 10:20:54,563] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-16 10:20:54,563] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-16 10:20:54,563] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-16 10:20:54,563] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-16 10:20:54,563] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-16 10:20:54,563] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-16 10:20:54,563] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-16 10:20:54,563] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-16 10:20:54,563] [INFO] [config.py:1012:print]   train_batch_size ............. 8
[2023-08-16 10:20:54,563] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  2
[2023-08-16 10:20:54,563] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-16 10:20:54,563] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-16 10:20:54,563] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-16 10:20:54,563] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-16 10:20:54,563] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-16 10:20:54,563] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-16 10:20:54,563] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-16 10:20:54,564] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.4361903667449951 seconds
Loading extension module utils...
Time to load utils op: 0.3043038845062256 seconds
Loading extension module utils...
Time to load utils op: 0.40468907356262207 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Loading extension module utils...
Evaluating gsm8k :   0%|                                                               | 0/125 [00:00<?, ?it/s]############### Example ###############
Time to load utils op: 0.30464863777160645 seconds
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following grade math question.

### Demonstration:
Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Answer: A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Answer: D: accomplishing

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Answer: A: office

Input: Billy called out to John, and listened for what? Choices:  A: silence B: response C: communication D: hanging up E: whisper
Answer: B: response

Input: The lizard frightened the hiker, it's movements made what rustle? Choices:  A: garden B: trees C: books D: rocks E: bushes
Answer: E: bushes

Input: The man spent big money and time maintaining his lawn, it was part of keeping up with the Joneses where? Choices:  A: front yard B: suburbia C: neighborhood D: back yard E: golf course
Answer: B: suburbia

Input: What would a human do if they want to get to a store that he or she can see? Choices:  A: cross road B: see around C: drink coffee D: dream dreams E: think critically
Answer: A: cross road

### Input:Natalia sold clips to 48 of her friends in April, and then she sold half as many clips in May. How many clips did Natalia sell altogether in April and May?

### Response:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o7-tcommonsenseqa-s1-rFalse-m4096
Evaluating gsm8k :   1%|▍                                                    | 1/125 [01:01<2:08:02, 61.95s/it]Evaluating gsm8k :   2%|▊                                                    | 2/125 [01:28<1:24:14, 41.09s/it]Evaluating gsm8k :   2%|█▎                                                   | 3/125 [02:04<1:18:39, 38.68s/it]Evaluating gsm8k :   3%|█▋                                                   | 4/125 [03:03<1:34:34, 46.89s/it]Evaluating gsm8k :   4%|██                                                   | 5/125 [04:04<1:43:35, 51.79s/it]Evaluating gsm8k :   5%|██▌                                                  | 6/125 [04:21<1:19:46, 40.22s/it]Evaluating gsm8k :   6%|██▉                                                  | 7/125 [05:08<1:23:23, 42.40s/it]Evaluating gsm8k :   6%|███▍                                                 | 8/125 [05:25<1:06:44, 34.22s/it]Evaluating gsm8k :   7%|███▉                                                   | 9/125 [05:33<50:13, 25.98s/it]Evaluating gsm8k :   8%|████▏                                               | 10/125 [06:34<1:10:27, 36.76s/it]Evaluating gsm8k :   9%|████▌                                               | 11/125 [07:11<1:10:09, 36.92s/it]Evaluating gsm8k :  10%|█████▏                                                | 12/125 [07:30<59:07, 31.39s/it]Evaluating gsm8k :  10%|█████▌                                                | 13/125 [07:53<53:59, 28.93s/it]Evaluating gsm8k :  11%|██████                                                | 14/125 [08:17<50:28, 27.29s/it]Evaluating gsm8k :  12%|██████▍                                               | 15/125 [08:34<44:29, 24.27s/it]Evaluating gsm8k :  13%|██████▉                                               | 16/125 [09:04<47:09, 25.96s/it]Evaluating gsm8k :  14%|███████                                             | 17/125 [10:05<1:06:04, 36.71s/it]Evaluating gsm8k :  14%|███████▍                                            | 18/125 [10:43<1:06:01, 37.02s/it]Evaluating gsm8k :  15%|████████▏                                             | 19/125 [10:54<51:24, 29.10s/it]Evaluating gsm8k :  16%|████████▋                                             | 20/125 [11:13<45:45, 26.14s/it]Evaluating gsm8k :  17%|█████████                                             | 21/125 [11:54<53:03, 30.61s/it]Evaluating gsm8k :  18%|█████████▏                                          | 22/125 [12:55<1:07:53, 39.55s/it]Evaluating gsm8k :  18%|█████████▌                                          | 23/125 [13:26<1:03:11, 37.17s/it]Evaluating gsm8k :  19%|█████████▉                                          | 24/125 [14:03<1:02:09, 36.93s/it]Evaluating gsm8k :  20%|██████████▍                                         | 25/125 [15:00<1:11:58, 43.19s/it]Evaluating gsm8k :  21%|██████████▊                                         | 26/125 [15:27<1:03:02, 38.21s/it]Evaluating gsm8k :  22%|███████████▋                                          | 27/125 [15:42<50:57, 31.20s/it]Evaluating gsm8k :  22%|████████████                                          | 28/125 [16:15<51:39, 31.95s/it]Evaluating gsm8k :  23%|████████████                                        | 29/125 [17:15<1:04:31, 40.32s/it]Evaluating gsm8k :  24%|████████████▍                                       | 30/125 [17:57<1:04:29, 40.73s/it]Evaluating gsm8k :  25%|████████████▉                                       | 31/125 [18:40<1:04:46, 41.34s/it]Evaluating gsm8k :  26%|█████████████▊                                        | 32/125 [19:10<58:57, 38.03s/it]Evaluating gsm8k :  26%|██████████████▎                                       | 33/125 [19:40<54:40, 35.66s/it]Evaluating gsm8k :  27%|██████████████▋                                       | 34/125 [20:25<58:24, 38.51s/it]Evaluating gsm8k :  28%|███████████████                                       | 35/125 [21:06<58:51, 39.23s/it]Evaluating gsm8k :  29%|██████████████▉                                     | 36/125 [22:07<1:07:43, 45.66s/it]Evaluating gsm8k :  30%|███████████████▍                                    | 37/125 [22:49<1:05:13, 44.47s/it]Evaluating gsm8k :  30%|████████████████▍                                     | 38/125 [23:08<53:32, 36.92s/it]Evaluating gsm8k :  31%|████████████████▏                                   | 39/125 [24:08<1:02:46, 43.79s/it]Evaluating gsm8k :  32%|█████████████████▎                                    | 40/125 [24:47<59:53, 42.27s/it]Evaluating gsm8k :  33%|█████████████████                                   | 41/125 [25:47<1:06:56, 47.81s/it]Evaluating gsm8k :  34%|█████████████████▍                                  | 42/125 [26:49<1:11:44, 51.87s/it]Evaluating gsm8k :  34%|█████████████████▉                                  | 43/125 [27:50<1:14:36, 54.59s/it]Evaluating gsm8k :  35%|██████████████████▎                                 | 44/125 [28:51<1:16:20, 56.55s/it]Evaluating gsm8k :  36%|██████████████████▋                                 | 45/125 [29:50<1:16:39, 57.49s/it]Evaluating gsm8k :  37%|███████████████████▏                                | 46/125 [30:52<1:17:27, 58.82s/it]Evaluating gsm8k :  38%|███████████████████▌                                | 47/125 [31:54<1:17:29, 59.61s/it]Evaluating gsm8k :  38%|███████████████████▉                                | 48/125 [32:52<1:15:57, 59.19s/it]Evaluating gsm8k :  39%|████████████████████▍                               | 49/125 [33:53<1:15:45, 59.81s/it]Evaluating gsm8k :  40%|████████████████████▊                               | 50/125 [34:51<1:14:06, 59.28s/it]Evaluating gsm8k :  41%|██████████████████████                                | 51/125 [35:12<58:41, 47.59s/it]Evaluating gsm8k :  42%|██████████████████████▍                               | 52/125 [35:23<44:48, 36.82s/it]Evaluating gsm8k :  42%|██████████████████████▉                               | 53/125 [36:09<47:24, 39.51s/it]Evaluating gsm8k :  43%|███████████████████████▎                              | 54/125 [37:10<54:25, 45.99s/it]Evaluating gsm8k :  44%|███████████████████████▊                              | 55/125 [37:35<46:14, 39.63s/it]Evaluating gsm8k :  45%|████████████████████████▏                             | 56/125 [38:36<53:07, 46.19s/it]Evaluating gsm8k :  46%|████████████████████████▌                             | 57/125 [39:05<46:17, 40.85s/it]Evaluating gsm8k :  46%|█████████████████████████                             | 58/125 [39:52<47:46, 42.78s/it]Evaluating gsm8k :  47%|█████████████████████████▍                            | 59/125 [40:35<47:06, 42.83s/it]Evaluating gsm8k :  48%|█████████████████████████▉                            | 60/125 [41:17<46:13, 42.66s/it]Evaluating gsm8k :  49%|██████████████████████████▎                           | 61/125 [41:32<36:24, 34.14s/it]Evaluating gsm8k :  50%|██████████████████████████▊                           | 62/125 [42:04<35:13, 33.55s/it]Evaluating gsm8k :  50%|███████████████████████████▏                          | 63/125 [42:22<30:04, 29.11s/it]Evaluating gsm8k :  51%|███████████████████████████▋                          | 64/125 [42:53<30:00, 29.51s/it]