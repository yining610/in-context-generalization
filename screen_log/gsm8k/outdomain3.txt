PYTHONPATH=/home/ylu130/workspace/in-context-generalization
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name gsm8k --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name commonsenseqa --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 2 --data-dir /scratch/ylu130/processed_data/gsm8k/out-domain/o1-tcommonsenseqa-s1-rTrue --seed 1 --max-prompt-length 2048 --rationales --num-out-domain 1
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-17 17:34:28,069] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... gsm8k
  data_dir ..................... /scratch/ylu130/processed_data/gsm8k/out-domain/o1-tcommonsenseqa-s1-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 1
  out_domain_data_name ......... commonsenseqa
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o1-tcommonsenseqa-s1-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 2
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                                             | 0/7473 [00:00<?, ?it/s]  1%|▉                                                                                                  | 68/7473 [00:00<00:10, 676.01it/s]  2%|█▊                                                                                                | 140/7473 [00:00<00:10, 701.63it/s]  3%|██▊                                                                                               | 213/7473 [00:00<00:10, 712.91it/s]  4%|███▋                                                                                              | 285/7473 [00:00<00:10, 713.41it/s]  5%|████▋                                                                                             | 358/7473 [00:00<00:09, 716.24it/s]  6%|█████▋                                                                                            | 430/7473 [00:00<00:09, 715.60it/s]  7%|██████▌                                                                                           | 502/7473 [00:00<00:09, 714.39it/s]  8%|███████▌                                                                                          | 575/7473 [00:00<00:09, 717.89it/s]  9%|████████▍                                                                                         | 647/7473 [00:00<00:09, 704.21it/s] 10%|█████████▍                                                                                        | 720/7473 [00:01<00:09, 710.33it/s] 11%|██████████▍                                                                                       | 793/7473 [00:01<00:09, 713.81it/s] 12%|███████████▎                                                                                      | 866/7473 [00:01<00:09, 715.75it/s] 13%|████████████▎                                                                                     | 938/7473 [00:01<00:09, 715.43it/s] 14%|█████████████                                                                                    | 1011/7473 [00:01<00:08, 719.20it/s] 15%|██████████████                                                                                   | 1085/7473 [00:01<00:08, 722.96it/s] 15%|███████████████                                                                                  | 1158/7473 [00:01<00:08, 719.44it/s] 16%|███████████████▉                                                                                 | 1230/7473 [00:01<00:08, 719.55it/s] 17%|████████████████▉                                                                                | 1303/7473 [00:01<00:08, 720.22it/s] 18%|█████████████████▊                                                                               | 1376/7473 [00:01<00:08, 719.92it/s] 19%|██████████████████▊                                                                              | 1448/7473 [00:02<00:08, 715.22it/s] 20%|███████████████████▋                                                                             | 1521/7473 [00:02<00:08, 719.44it/s] 21%|████████████████████▋                                                                            | 1593/7473 [00:02<00:08, 717.15it/s] 22%|█████████████████████▌                                                                           | 1665/7473 [00:02<00:08, 716.94it/s] 23%|██████████████████████▌                                                                          | 1738/7473 [00:02<00:07, 719.07it/s] 25%|███████████████████████▉                                                                         | 1843/7473 [00:02<00:06, 816.88it/s] 26%|█████████████████████████▎                                                                       | 1952/7473 [00:02<00:06, 897.66it/s] 28%|██████████████████████████▊                                                                      | 2062/7473 [00:02<00:05, 957.27it/s] 29%|████████████████████████████▏                                                                    | 2171/7473 [00:02<00:05, 994.54it/s] 31%|█████████████████████████████▎                                                                  | 2281/7473 [00:02<00:05, 1024.08it/s] 32%|██████████████████████████████▋                                                                 | 2391/7473 [00:03<00:04, 1044.89it/s] 33%|████████████████████████████████▏                                                               | 2503/7473 [00:03<00:04, 1064.01it/s] 35%|█████████████████████████████████▌                                                              | 2610/7473 [00:03<00:04, 1035.79it/s] 36%|██████████████████████████████████▉                                                             | 2721/7473 [00:03<00:04, 1054.95it/s] 38%|████████████████████████████████████▎                                                           | 2831/7473 [00:03<00:04, 1066.65it/s] 39%|█████████████████████████████████████▊                                                          | 2942/7473 [00:03<00:04, 1077.08it/s] 41%|███████████████████████████████████████▏                                                        | 3051/7473 [00:03<00:04, 1080.17it/s] 42%|████████████████████████████████████████▌                                                       | 3160/7473 [00:03<00:04, 1075.84it/s] 44%|█████████████████████████████████████████▉                                                      | 3268/7473 [00:03<00:03, 1056.49it/s] 45%|███████████████████████████████████████████▎                                                    | 3374/7473 [00:03<00:03, 1025.68it/s] 47%|████████████████████████████████████████████▋                                                   | 3481/7473 [00:04<00:03, 1036.83it/s] 48%|██████████████████████████████████████████████                                                  | 3585/7473 [00:04<00:03, 1025.21it/s] 49%|███████████████████████████████████████████████▍                                                | 3693/7473 [00:04<00:03, 1040.70it/s] 51%|████████████████████████████████████████████████▊                                               | 3804/7473 [00:04<00:03, 1059.28it/s] 52%|██████████████████████████████████████████████████▎                                             | 3914/7473 [00:04<00:03, 1069.23it/s] 54%|███████████████████████████████████████████████████▋                                            | 4025/7473 [00:04<00:03, 1078.76it/s] 55%|█████████████████████████████████████████████████████                                           | 4133/7473 [00:04<00:03, 1077.84it/s] 57%|██████████████████████████████████████████████████████▌                                         | 4243/7473 [00:04<00:02, 1082.57it/s] 58%|███████████████████████████████████████████████████████▉                                        | 4352/7473 [00:04<00:02, 1084.18it/s] 60%|█████████████████████████████████████████████████████████▎                                      | 4461/7473 [00:04<00:02, 1085.19it/s] 61%|██████████████████████████████████████████████████████████▋                                     | 4570/7473 [00:05<00:02, 1084.21it/s] 63%|████████████████████████████████████████████████████████████                                    | 4679/7473 [00:05<00:02, 1085.60it/s] 64%|█████████████████████████████████████████████████████████████▌                                  | 4789/7473 [00:05<00:02, 1086.90it/s] 66%|██████████████████████████████████████████████████████████████▉                                 | 4898/7473 [00:05<00:02, 1085.56it/s] 67%|████████████████████████████████████████████████████████████████▎                               | 5008/7473 [00:05<00:02, 1088.05it/s] 68%|█████████████████████████████████████████████████████████████████▋                              | 5117/7473 [00:05<00:02, 1086.85it/s] 70%|███████████████████████████████████████████████████████████████████▏                            | 5226/7473 [00:05<00:02, 1081.23it/s] 71%|█████████████████████████████████████████████████████████████████████▏                           | 5335/7473 [00:05<00:02, 992.38it/s] 73%|█████████████████████████████████████████████████████████████████████▉                          | 5443/7473 [00:05<00:01, 1016.58it/s] 74%|███████████████████████████████████████████████████████████████████████▉                         | 5546/7473 [00:06<00:02, 779.29it/s] 76%|█████████████████████████████████████████████████████████████████████████▍                       | 5656/7473 [00:06<00:02, 855.19it/s] 77%|██████████████████████████████████████████████████████████████████████████▊                      | 5766/7473 [00:06<00:01, 915.07it/s] 79%|████████████████████████████████████████████████████████████████████████████▎                    | 5876/7473 [00:06<00:01, 963.27it/s] 80%|█████████████████████████████████████████████████████████████████████████████▋                   | 5984/7473 [00:06<00:01, 994.21it/s] 82%|██████████████████████████████████████████████████████████████████████████████▎                 | 6095/7473 [00:06<00:01, 1024.22it/s] 83%|███████████████████████████████████████████████████████████████████████████████▋                | 6204/7473 [00:06<00:01, 1042.71it/s] 84%|█████████████████████████████████████████████████████████████████████████████████               | 6314/7473 [00:06<00:01, 1057.27it/s] 86%|██████████████████████████████████████████████████████████████████████████████████▍             | 6422/7473 [00:06<00:00, 1060.91it/s] 87%|███████████████████████████████████████████████████████████████████████████████████▉            | 6532/7473 [00:07<00:00, 1070.94it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████▎          | 6640/7473 [00:07<00:00, 1063.21it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████▋         | 6749/7473 [00:07<00:00, 1068.15it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████        | 6857/7473 [00:07<00:00, 1070.72it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████▍      | 6967/7473 [00:07<00:00, 1079.28it/s] 95%|██████████████████████████████████████████████████████████████████████████████████████████▉     | 7076/7473 [00:07<00:00, 1081.17it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████▎   | 7185/7473 [00:07<00:00, 1081.34it/s] 98%|█████████████████████████████████████████████████████████████████████████████████████████████▋  | 7294/7473 [00:07<00:00, 1074.68it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████ | 7402/7473 [00:07<00:00, 1023.57it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 7473/7473 [00:07<00:00, 944.09it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.17s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.23s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.48s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.46s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.06s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.07s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.30s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:11<00:05,  5.71s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.46s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.64s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.45s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.63s/it]
[2023-08-17 17:35:27,511] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.66s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.85s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.17s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.29s/it]
[2023-08-17 17:35:42,274] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-17 17:35:42,275] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-17 17:35:42,276] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-17 17:35:42,276] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-17 17:35:42,276] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-17 17:35:42,276] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-17 17:35:42,276] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-17 17:35:42,276] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-17 17:35:42,276] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-17 17:35:42,276] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-17 17:35:42,276] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-17 17:35:42,276] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f3477f5c130>
[2023-08-17 17:35:42,276] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-17 17:35:42,276] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-17 17:35:42,276] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-17 17:35:42,276] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-17 17:35:42,276] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-17 17:35:42,277] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-17 17:35:42,277] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-17 17:35:42,277] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-17 17:35:42,277] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-17 17:35:42,277] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-17 17:35:42,277] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-17 17:35:42,277] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-17 17:35:42,277] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-17 17:35:42,277] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-17 17:35:42,277] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-17 17:35:42,277] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-17 17:35:42,277] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-17 17:35:42,277] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-17 17:35:42,277] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-17 17:35:42,277] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-17 17:35:42,277] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-17 17:35:42,277] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-17 17:35:42,277] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-17 17:35:42,277] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-17 17:35:42,277] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-17 17:35:42,277] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-17 17:35:42,277] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-17 17:35:42,277] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-17 17:35:42,277] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-17 17:35:42,277] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-17 17:35:42,277] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-17 17:35:42,277] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-17 17:35:42,277] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f3477f5c280>
[2023-08-17 17:35:42,277] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-17 17:35:42,277] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-17 17:35:42,277] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-17 17:35:42,277] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-17 17:35:42,277] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-17 17:35:42,277] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-17 17:35:42,277] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-17 17:35:42,277] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-17 17:35:42,278] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-17 17:35:42,278] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-17 17:35:42,278] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-17 17:35:42,278] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-17 17:35:42,278] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-17 17:35:42,278] [INFO] [config.py:1012:print]   train_batch_size ............. 8
[2023-08-17 17:35:42,278] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  2
[2023-08-17 17:35:42,278] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-17 17:35:42,278] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-17 17:35:42,278] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-17 17:35:42,278] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-17 17:35:42,278] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-17 17:35:42,278] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-17 17:35:42,278] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-17 17:35:42,278] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.44365453720092773 seconds
Loading extension module utils...
Time to load utils op: 0.4045438766479492 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Loading extension module utils...
Time to load utils op: 0.5046966075897217 seconds
Evaluating gsm8k :   0%|                                                                                           | 0/125 [00:00<?, ?it/s]############### Example ###############
Loading extension module utils...
### Instruction:Answer the following grade math question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: 1. The question is asking where one might find plumbing that wouldn't be useful to a thirsty person. This is equivalent to asking, "Where might you find plumbing that doesn't contain drinkable water?"
2. Answer choice A: oil refineries. Oil refineries have plumbing systems, but these are used to transport oil, not water. Thus, the plumbing in oil refineries would not be useful to someone who is thirsty since its primary function is to move around oil.
3. Answer choice B: wall. Plumbing can be found within the walls of structures, particularly for water supply and waste water evacuation, which hosts drinkable water.
4. Answer choice C: show. This choice is less clear, depends on what kind of show is it about. But usually shows, if they have some plumbing on stage, it will be functional as appearances, not for practical use.
5. Answer choice D: own home. Home plumbing serves functions such as providing water for cooking, cleaning, and most importantly, drinking. Therefore, the plumbing in one's own home would be useful to someone who is thirsty.
6. Answer choice E: water fountain. Public water fountains are also a source of drinkable water.
7. Thus, the plumbing system that would not be useful if one is thirsty is found at an oil refinery because its function is to transport oil, not drinkable water. Therefore, the answer is A: oil refineries.
So the final answer is A: oil refineries

Input:Natalia sold clips to 48 of her friends in April, and then she sold half as many clips in May. How many clips did Natalia sell altogether in April and May?
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o1-tcommonsenseqa-s1-rTrue
Time to load utils op: 0.40455055236816406 seconds
Evaluating gsm8k :   1%|▋                                                                                  | 1/125 [00:28<59:03, 28.57s/it]Evaluating gsm8k :   2%|█▎                                                                                 | 2/125 [00:37<35:20, 17.24s/it]Evaluating gsm8k :   2%|█▉                                                                                 | 3/125 [01:04<44:13, 21.75s/it]Evaluating gsm8k :   3%|██▋                                                                                | 4/125 [01:14<34:05, 16.91s/it]Evaluating gsm8k :   4%|███▎                                                                               | 5/125 [01:41<41:08, 20.57s/it]Evaluating gsm8k :   5%|███▉                                                                               | 6/125 [01:57<37:40, 19.00s/it]Evaluating gsm8k :   6%|████▋                                                                              | 7/125 [02:24<42:33, 21.64s/it]Evaluating gsm8k :   6%|█████▎                                                                             | 8/125 [02:35<35:50, 18.38s/it]Evaluating gsm8k :   7%|█████▉                                                                             | 9/125 [03:03<40:56, 21.18s/it]Evaluating gsm8k :   8%|██████▌                                                                           | 10/125 [03:22<39:07, 20.42s/it]Evaluating gsm8k :   9%|███████▏                                                                          | 11/125 [03:45<40:37, 21.38s/it]Evaluating gsm8k :  10%|███████▊                                                                          | 12/125 [03:53<32:24, 17.21s/it]Evaluating gsm8k :  10%|████████▌                                                                         | 13/125 [04:17<36:06, 19.35s/it]Evaluating gsm8k :  11%|█████████▏                                                                        | 14/125 [04:44<40:06, 21.68s/it]Evaluating gsm8k :  12%|█████████▊                                                                        | 15/125 [05:12<42:59, 23.45s/it]Evaluating gsm8k :  13%|██████████▍                                                                       | 16/125 [05:21<35:09, 19.35s/it]Evaluating gsm8k :  14%|███████████▏                                                                      | 17/125 [05:49<39:03, 21.70s/it]Evaluating gsm8k :  14%|███████████▊                                                                      | 18/125 [06:11<39:03, 21.90s/it]Evaluating gsm8k :  15%|████████████▍                                                                     | 19/125 [06:38<41:29, 23.49s/it]Evaluating gsm8k :  16%|█████████████                                                                     | 20/125 [07:06<43:21, 24.78s/it]Evaluating gsm8k :  17%|█████████████▊                                                                    | 21/125 [07:22<38:16, 22.09s/it]Evaluating gsm8k :  18%|██████████████▍                                                                   | 22/125 [07:45<38:33, 22.46s/it]Evaluating gsm8k :  18%|███████████████                                                                   | 23/125 [08:13<40:51, 24.03s/it]Evaluating gsm8k :  19%|███████████████▋                                                                  | 24/125 [08:40<42:00, 24.95s/it]Evaluating gsm8k :  20%|████████████████▍                                                                 | 25/125 [09:07<42:42, 25.62s/it]Evaluating gsm8k :  21%|█████████████████                                                                 | 26/125 [09:15<33:34, 20.35s/it]Evaluating gsm8k :  22%|█████████████████▋                                                                | 27/125 [09:38<34:13, 20.95s/it]Evaluating gsm8k :  22%|██████████████████▎                                                               | 28/125 [10:05<37:05, 22.94s/it]Evaluating gsm8k :  23%|███████████████████                                                               | 29/125 [10:32<38:43, 24.20s/it]Evaluating gsm8k :  24%|███████████████████▋                                                              | 30/125 [10:59<39:45, 25.11s/it]Evaluating gsm8k :  25%|████████████████████▎                                                             | 31/125 [11:20<37:00, 23.63s/it]Evaluating gsm8k :  26%|████████████████████▉                                                             | 32/125 [11:29<29:56, 19.32s/it]Evaluating gsm8k :  26%|█████████████████████▋                                                            | 33/125 [11:36<24:11, 15.77s/it]Evaluating gsm8k :  27%|██████████████████████▎                                                           | 34/125 [12:04<29:06, 19.20s/it]Evaluating gsm8k :  28%|██████████████████████▉                                                           | 35/125 [12:18<26:46, 17.85s/it]Evaluating gsm8k :  29%|███████████████████████▌                                                          | 36/125 [12:32<24:44, 16.67s/it]Evaluating gsm8k :  30%|████████████████████████▎                                                         | 37/125 [13:00<29:08, 19.87s/it]Evaluating gsm8k :  30%|████████████████████████▉                                                         | 38/125 [13:27<32:00, 22.08s/it]Evaluating gsm8k :  31%|█████████████████████████▌                                                        | 39/125 [13:54<33:46, 23.56s/it]Evaluating gsm8k :  32%|██████████████████████████▏                                                       | 40/125 [14:05<28:05, 19.83s/it]Evaluating gsm8k :  33%|██████████████████████████▉                                                       | 41/125 [14:33<31:04, 22.20s/it]Evaluating gsm8k :  34%|███████████████████████████▌                                                      | 42/125 [14:43<25:38, 18.54s/it]Evaluating gsm8k :  34%|████████████████████████████▏                                                     | 43/125 [15:10<28:59, 21.22s/it]Evaluating gsm8k :  35%|████████████████████████████▊                                                     | 44/125 [15:37<31:07, 23.05s/it]Evaluating gsm8k :  36%|█████████████████████████████▌                                                    | 45/125 [16:04<32:12, 24.15s/it]Evaluating gsm8k :  37%|██████████████████████████████▏                                                   | 46/125 [16:14<26:10, 19.88s/it]Evaluating gsm8k :  38%|██████████████████████████████▊                                                   | 47/125 [16:26<22:56, 17.64s/it]Evaluating gsm8k :  38%|███████████████████████████████▍                                                  | 48/125 [16:40<20:55, 16.30s/it]Evaluating gsm8k :  39%|████████████████████████████████▏                                                 | 49/125 [16:49<18:07, 14.31s/it]Evaluating gsm8k :  40%|████████████████████████████████▊                                                 | 50/125 [17:17<22:54, 18.33s/it]Evaluating gsm8k :  41%|█████████████████████████████████▍                                                | 51/125 [17:38<23:38, 19.16s/it]Evaluating gsm8k :  42%|██████████████████████████████████                                                | 52/125 [18:05<26:13, 21.55s/it]Evaluating gsm8k :  42%|██████████████████████████████████▊                                               | 53/125 [18:12<20:32, 17.11s/it]Evaluating gsm8k :  43%|███████████████████████████████████▍                                              | 54/125 [18:39<23:46, 20.09s/it]Evaluating gsm8k :  44%|████████████████████████████████████                                              | 55/125 [19:07<26:05, 22.36s/it]Evaluating gsm8k :  45%|████████████████████████████████████▋                                             | 56/125 [19:13<20:00, 17.40s/it]Evaluating gsm8k :  46%|█████████████████████████████████████▍                                            | 57/125 [19:40<23:10, 20.44s/it]Evaluating gsm8k :  46%|██████████████████████████████████████                                            | 58/125 [20:07<25:00, 22.39s/it]Evaluating gsm8k :  47%|██████████████████████████████████████▋                                           | 59/125 [20:35<26:25, 24.02s/it]Evaluating gsm8k :  48%|███████████████████████████████████████▎                                          | 60/125 [20:44<21:16, 19.64s/it]Evaluating gsm8k :  49%|████████████████████████████████████████                                          | 61/125 [21:12<23:31, 22.05s/it]Evaluating gsm8k :  50%|████████████████████████████████████████▋                                         | 62/125 [21:39<24:50, 23.67s/it]Evaluating gsm8k :  50%|█████████████████████████████████████████▎                                        | 63/125 [22:04<24:52, 24.08s/it]Evaluating gsm8k :  51%|█████████████████████████████████████████▉                                        | 64/125 [22:32<25:37, 25.20s/it]Evaluating gsm8k :  52%|██████████████████████████████████████████▋                                       | 65/125 [22:50<22:50, 22.84s/it]Evaluating gsm8k :  53%|███████████████████████████████████████████▎                                      | 66/125 [23:17<23:44, 24.15s/it]Evaluating gsm8k :  54%|███████████████████████████████████████████▉                                      | 67/125 [23:31<20:32, 21.26s/it]Evaluating gsm8k :  54%|████████████████████████████████████████████▌                                     | 68/125 [23:43<17:21, 18.28s/it]Evaluating gsm8k :  55%|█████████████████████████████████████████████▎                                    | 69/125 [24:10<19:42, 21.12s/it]Evaluating gsm8k :  56%|█████████████████████████████████████████████▉                                    | 70/125 [24:20<16:18, 17.79s/it]Evaluating gsm8k :  57%|██████████████████████████████████████████████▌                                   | 71/125 [24:48<18:37, 20.69s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▏                                  | 72/125 [24:53<14:08, 16.02s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▉                                  | 73/125 [25:16<15:37, 18.03s/it]Evaluating gsm8k :  59%|████████████████████████████████████████████████▌                                 | 74/125 [25:44<17:53, 21.05s/it]Evaluating gsm8k :  60%|█████████████████████████████████████████████████▏                                | 75/125 [25:50<13:43, 16.46s/it]Evaluating gsm8k :  61%|█████████████████████████████████████████████████▊                                | 76/125 [26:08<13:56, 17.06s/it]Evaluating gsm8k :  62%|██████████████████████████████████████████████████▌                               | 77/125 [26:19<12:12, 15.27s/it]Evaluating gsm8k :  62%|███████████████████████████████████████████████████▏                              | 78/125 [26:29<10:44, 13.72s/it]Evaluating gsm8k :  63%|███████████████████████████████████████████████████▊                              | 79/125 [26:57<13:51, 18.07s/it]Evaluating gsm8k :  64%|████████████████████████████████████████████████████▍                             | 80/125 [27:09<12:06, 16.14s/it]Evaluating gsm8k :  65%|█████████████████████████████████████████████████████▏                            | 81/125 [27:37<14:29, 19.75s/it]Evaluating gsm8k :  66%|█████████████████████████████████████████████████████▊                            | 82/125 [27:48<12:08, 16.94s/it]Evaluating gsm8k :  66%|██████████████████████████████████████████████████████▍                           | 83/125 [27:55<09:54, 14.17s/it]Evaluating gsm8k :  67%|███████████████████████████████████████████████████████                           | 84/125 [28:22<12:20, 18.05s/it]Evaluating gsm8k :  68%|███████████████████████████████████████████████████████▊                          | 85/125 [28:32<10:24, 15.61s/it]Evaluating gsm8k :  69%|████████████████████████████████████████████████████████▍                         | 86/125 [29:00<12:26, 19.14s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████                         | 87/125 [29:11<10:38, 16.81s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████▋                        | 88/125 [29:39<12:24, 20.11s/it]Evaluating gsm8k :  71%|██████████████████████████████████████████████████████████▍                       | 89/125 [30:06<13:22, 22.29s/it]Evaluating gsm8k :  72%|███████████████████████████████████████████████████████████                       | 90/125 [30:13<10:21, 17.76s/it]Evaluating gsm8k :  73%|███████████████████████████████████████████████████████████▋                      | 91/125 [30:41<11:43, 20.69s/it]Evaluating gsm8k :  74%|████████████████████████████████████████████████████████████▎                     | 92/125 [31:07<12:14, 22.26s/it]Evaluating gsm8k :  74%|█████████████████████████████████████████████████████████████                     | 93/125 [31:34<12:38, 23.70s/it]Evaluating gsm8k :  75%|█████████████████████████████████████████████████████████████▋                    | 94/125 [32:01<12:46, 24.73s/it]Evaluating gsm8k :  76%|██████████████████████████████████████████████████████████████▎                   | 95/125 [32:28<12:43, 25.44s/it]Evaluating gsm8k :  77%|██████████████████████████████████████████████████████████████▉                   | 96/125 [32:56<12:35, 26.04s/it]Evaluating gsm8k :  78%|███████████████████████████████████████████████████████████████▋                  | 97/125 [33:23<12:17, 26.33s/it]Evaluating gsm8k :  78%|████████████████████████████████████████████████████████████████▎                 | 98/125 [33:45<11:18, 25.13s/it]Evaluating gsm8k :  79%|████████████████████████████████████████████████████████████████▉                 | 99/125 [34:02<09:48, 22.65s/it]Evaluating gsm8k :  80%|████████████████████████████████████████████████████████████████▊                | 100/125 [34:20<08:48, 21.15s/it]Evaluating gsm8k :  81%|█████████████████████████████████████████████████████████████████▍               | 101/125 [34:31<07:15, 18.14s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████               | 102/125 [34:45<06:27, 16.87s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████▋              | 103/125 [35:09<06:58, 19.01s/it]Evaluating gsm8k :  83%|███████████████████████████████████████████████████████████████████▍             | 104/125 [35:34<07:19, 20.91s/it]Evaluating gsm8k :  84%|████████████████████████████████████████████████████████████████████             | 105/125 [36:02<07:39, 22.96s/it]Evaluating gsm8k :  85%|████████████████████████████████████████████████████████████████████▋            | 106/125 [36:21<06:57, 21.98s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▎           | 107/125 [36:48<07:03, 23.54s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▉           | 108/125 [36:56<05:20, 18.88s/it]Evaluating gsm8k :  87%|██████████████████████████████████████████████████████████████████████▋          | 109/125 [37:13<04:53, 18.32s/it]Evaluating gsm8k :  88%|███████████████████████████████████████████████████████████████████████▎         | 110/125 [37:29<04:21, 17.40s/it]Evaluating gsm8k :  89%|███████████████████████████████████████████████████████████████████████▉         | 111/125 [37:38<03:30, 15.01s/it]Evaluating gsm8k :  90%|████████████████████████████████████████████████████████████████████████▌        | 112/125 [37:44<02:37, 12.11s/it]Evaluating gsm8k :  90%|█████████████████████████████████████████████████████████████████████████▏       | 113/125 [38:11<03:20, 16.73s/it]Evaluating gsm8k :  91%|█████████████████████████████████████████████████████████████████████████▊       | 114/125 [38:18<02:32, 13.91s/it]Evaluating gsm8k :  92%|██████████████████████████████████████████████████████████████████████████▌      | 115/125 [38:46<02:58, 17.89s/it]Evaluating gsm8k :  93%|███████████████████████████████████████████████████████████████████████████▏     | 116/125 [39:01<02:35, 17.24s/it]Evaluating gsm8k :  94%|███████████████████████████████████████████████████████████████████████████▊     | 117/125 [39:29<02:43, 20.43s/it]Evaluating gsm8k :  94%|████████████████████████████████████████████████████████████████████████████▍    | 118/125 [39:56<02:37, 22.49s/it]Evaluating gsm8k :  95%|█████████████████████████████████████████████████████████████████████████████    | 119/125 [40:24<02:24, 24.07s/it]Evaluating gsm8k :  96%|█████████████████████████████████████████████████████████████████████████████▊   | 120/125 [40:52<02:05, 25.13s/it]Evaluating gsm8k :  97%|██████████████████████████████████████████████████████████████████████████████▍  | 121/125 [41:14<01:37, 24.28s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████  | 122/125 [41:42<01:15, 25.31s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████▋ | 123/125 [41:48<00:39, 19.61s/it]Evaluating gsm8k :  99%|████████████████████████████████████████████████████████████████████████████████▎| 124/125 [42:08<00:19, 19.72s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [42:14<00:00, 15.64s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [42:14<00:00, 20.28s/it]
name: gsm8k | {'exact_match': 0.0, 'rougeL': 0.4696} | lm_loss 10.5708 | avg. gen lenth: 274.632
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name gsm8k --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name commonsenseqa --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 2 --data-dir /scratch/ylu130/processed_data/gsm8k/out-domain/o2-tcommonsenseqa-s1-rTrue --seed 1 --max-prompt-length 2048 --rationales --num-out-domain 2
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-17 18:21:42,522] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... gsm8k
  data_dir ..................... /scratch/ylu130/processed_data/gsm8k/out-domain/o2-tcommonsenseqa-s1-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 2
  out_domain_data_name ......... commonsenseqa
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o2-tcommonsenseqa-s1-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 2
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                                             | 0/7473 [00:00<?, ?it/s]  1%|▌                                                                                                  | 41/7473 [00:00<00:18, 400.52it/s]  1%|█                                                                                                  | 82/7473 [00:00<00:18, 402.05it/s]  2%|█▌                                                                                                | 123/7473 [00:00<00:18, 402.73it/s]  2%|██▏                                                                                               | 164/7473 [00:00<00:18, 404.68it/s]  3%|██▋                                                                                               | 205/7473 [00:00<00:17, 405.61it/s]  3%|███▏                                                                                              | 246/7473 [00:00<00:17, 403.77it/s]  4%|███▊                                                                                              | 287/7473 [00:00<00:17, 404.72it/s]  4%|████▎                                                                                             | 328/7473 [00:00<00:17, 399.53it/s]  5%|████▊                                                                                             | 368/7473 [00:00<00:17, 399.41it/s]  5%|█████▎                                                                                            | 408/7473 [00:01<00:17, 399.45it/s]  6%|█████▉                                                                                            | 449/7473 [00:01<00:17, 400.49it/s]  7%|██████▍                                                                                           | 490/7473 [00:01<00:17, 399.46it/s]  7%|██████▉                                                                                           | 531/7473 [00:01<00:17, 401.04it/s]  8%|███████▌                                                                                          | 572/7473 [00:01<00:17, 401.81it/s]  8%|████████                                                                                          | 613/7473 [00:01<00:17, 401.73it/s]  9%|████████▌                                                                                         | 654/7473 [00:01<00:16, 401.12it/s]  9%|█████████                                                                                         | 695/7473 [00:01<00:16, 403.29it/s] 10%|█████████▋                                                                                        | 736/7473 [00:01<00:16, 399.41it/s] 10%|██████████▏                                                                                       | 776/7473 [00:01<00:16, 398.86it/s] 11%|██████████▋                                                                                       | 816/7473 [00:02<00:16, 399.10it/s] 11%|███████████▏                                                                                      | 857/7473 [00:02<00:16, 399.99it/s] 12%|███████████▊                                                                                      | 898/7473 [00:02<00:16, 400.52it/s] 13%|████████████▎                                                                                     | 939/7473 [00:02<00:16, 399.64it/s] 13%|████████████▉                                                                                     | 989/7473 [00:02<00:15, 429.16it/s] 14%|█████████████▋                                                                                   | 1050/7473 [00:02<00:13, 480.65it/s] 15%|██████████████▍                                                                                  | 1112/7473 [00:02<00:12, 519.91it/s] 16%|███████████████▏                                                                                 | 1173/7473 [00:02<00:11, 543.98it/s] 17%|████████████████                                                                                 | 1234/7473 [00:02<00:11, 561.65it/s] 17%|████████████████▊                                                                                | 1294/7473 [00:02<00:10, 572.72it/s] 18%|█████████████████▌                                                                               | 1355/7473 [00:03<00:10, 583.73it/s] 19%|██████████████████▎                                                                              | 1414/7473 [00:03<00:10, 583.36it/s] 20%|███████████████████▏                                                                             | 1475/7473 [00:03<00:10, 590.54it/s] 21%|███████████████████▉                                                                             | 1537/7473 [00:03<00:09, 596.70it/s] 21%|████████████████████▋                                                                            | 1598/7473 [00:03<00:09, 598.04it/s] 22%|█████████████████████▌                                                                           | 1659/7473 [00:03<00:09, 598.67it/s] 23%|██████████████████████▎                                                                          | 1721/7473 [00:03<00:09, 602.37it/s] 24%|███████████████████████▏                                                                         | 1782/7473 [00:03<00:09, 602.95it/s] 25%|███████████████████████▉                                                                         | 1843/7473 [00:03<00:09, 601.14it/s] 25%|████████████████████████▋                                                                        | 1904/7473 [00:03<00:09, 600.39it/s] 26%|█████████████████████████▌                                                                       | 1965/7473 [00:04<00:09, 600.01it/s] 27%|██████████████████████████▎                                                                      | 2026/7473 [00:04<00:09, 602.02it/s] 28%|███████████████████████████                                                                      | 2087/7473 [00:04<00:08, 601.04it/s] 29%|███████████████████████████▉                                                                     | 2148/7473 [00:04<00:08, 602.10it/s] 30%|████████████████████████████▋                                                                    | 2209/7473 [00:04<00:08, 598.37it/s] 30%|█████████████████████████████▍                                                                   | 2270/7473 [00:04<00:08, 598.68it/s] 31%|██████████████████████████████▎                                                                  | 2331/7473 [00:04<00:08, 599.18it/s] 32%|███████████████████████████████                                                                  | 2392/7473 [00:04<00:08, 600.85it/s] 33%|███████████████████████████████▊                                                                 | 2454/7473 [00:04<00:08, 604.34it/s] 34%|████████████████████████████████▋                                                                | 2515/7473 [00:04<00:08, 604.24it/s] 34%|█████████████████████████████████▍                                                               | 2576/7473 [00:05<00:08, 561.63it/s] 35%|██████████████████████████████████▏                                                              | 2637/7473 [00:05<00:08, 573.41it/s] 36%|███████████████████████████████████                                                              | 2699/7473 [00:05<00:08, 583.76it/s] 37%|███████████████████████████████████▊                                                             | 2760/7473 [00:05<00:08, 588.96it/s] 38%|████████████████████████████████████▌                                                            | 2821/7473 [00:05<00:07, 595.01it/s] 39%|█████████████████████████████████████▍                                                           | 2882/7473 [00:05<00:07, 598.14it/s] 39%|██████████████████████████████████████▏                                                          | 2944/7473 [00:05<00:07, 603.54it/s] 40%|███████████████████████████████████████                                                          | 3005/7473 [00:05<00:07, 600.56it/s] 41%|███████████████████████████████████████▊                                                         | 3066/7473 [00:05<00:07, 600.99it/s] 42%|████████████████████████████████████████▌                                                        | 3127/7473 [00:06<00:07, 600.22it/s] 43%|█████████████████████████████████████████▍                                                       | 3188/7473 [00:06<00:07, 601.05it/s] 43%|██████████████████████████████████████████▏                                                      | 3249/7473 [00:06<00:07, 600.92it/s] 44%|██████████████████████████████████████████▉                                                      | 3310/7473 [00:06<00:06, 603.29it/s] 45%|███████████████████████████████████████████▊                                                     | 3371/7473 [00:06<00:06, 601.77it/s] 46%|████████████████████████████████████████████▌                                                    | 3432/7473 [00:06<00:06, 597.95it/s] 47%|█████████████████████████████████████████████▎                                                   | 3493/7473 [00:06<00:06, 599.59it/s] 48%|██████████████████████████████████████████████▏                                                  | 3554/7473 [00:06<00:06, 601.45it/s] 48%|██████████████████████████████████████████████▉                                                  | 3615/7473 [00:06<00:06, 603.35it/s] 49%|███████████████████████████████████████████████▋                                                 | 3676/7473 [00:06<00:06, 600.41it/s] 50%|████████████████████████████████████████████████▌                                                | 3737/7473 [00:07<00:06, 601.25it/s] 51%|█████████████████████████████████████████████████▎                                               | 3798/7473 [00:07<00:06, 602.18it/s] 52%|██████████████████████████████████████████████████                                               | 3859/7473 [00:07<00:06, 601.01it/s] 52%|██████████████████████████████████████████████████▉                                              | 3920/7473 [00:07<00:05, 596.37it/s] 53%|███████████████████████████████████████████████████▋                                             | 3980/7473 [00:07<00:05, 596.10it/s] 54%|████████████████████████████████████████████████████▍                                            | 4041/7473 [00:07<00:05, 598.98it/s] 55%|█████████████████████████████████████████████████████▏                                           | 4102/7473 [00:07<00:05, 600.16it/s] 56%|██████████████████████████████████████████████████████                                           | 4163/7473 [00:07<00:05, 598.71it/s] 57%|██████████████████████████████████████████████████████▊                                          | 4223/7473 [00:07<00:05, 597.58it/s] 57%|███████████████████████████████████████████████████████▌                                         | 4283/7473 [00:07<00:05, 590.49it/s] 58%|████████████████████████████████████████████████████████▎                                        | 4343/7473 [00:08<00:05, 577.99it/s] 59%|█████████████████████████████████████████████████████████▏                                       | 4404/7473 [00:08<00:05, 584.31it/s] 60%|█████████████████████████████████████████████████████████▉                                       | 4465/7473 [00:08<00:05, 589.65it/s] 61%|██████████████████████████████████████████████████████████▋                                      | 4526/7473 [00:08<00:04, 593.70it/s] 61%|███████████████████████████████████████████████████████████▌                                     | 4587/7473 [00:08<00:04, 596.62it/s] 62%|████████████████████████████████████████████████████████████▎                                    | 4647/7473 [00:08<00:04, 596.84it/s] 63%|█████████████████████████████████████████████████████████████                                    | 4708/7473 [00:08<00:04, 598.36it/s] 64%|█████████████████████████████████████████████████████████████▉                                   | 4769/7473 [00:08<00:04, 600.57it/s] 65%|██████████████████████████████████████████████████████████████▋                                  | 4830/7473 [00:08<00:04, 599.52it/s] 65%|███████████████████████████████████████████████████████████████▍                                 | 4891/7473 [00:08<00:04, 600.54it/s] 66%|████████████████████████████████████████████████████████████████▎                                | 4952/7473 [00:09<00:04, 601.80it/s] 67%|█████████████████████████████████████████████████████████████████                                | 5013/7473 [00:09<00:04, 598.47it/s] 68%|█████████████████████████████████████████████████████████████████▊                               | 5074/7473 [00:09<00:03, 600.92it/s] 69%|██████████████████████████████████████████████████████████████████▋                              | 5135/7473 [00:09<00:03, 602.68it/s] 70%|███████████████████████████████████████████████████████████████████▍                             | 5196/7473 [00:09<00:03, 603.81it/s] 70%|████████████████████████████████████████████████████████████████████▏                            | 5257/7473 [00:09<00:03, 577.28it/s] 71%|█████████████████████████████████████████████████████████████████████                            | 5318/7473 [00:09<00:03, 585.18it/s] 72%|█████████████████████████████████████████████████████████████████████▊                           | 5379/7473 [00:09<00:03, 590.67it/s] 73%|██████████████████████████████████████████████████████████████████████▌                          | 5440/7473 [00:09<00:03, 595.31it/s] 74%|███████████████████████████████████████████████████████████████████████▍                         | 5500/7473 [00:10<00:04, 435.20it/s] 74%|████████████████████████████████████████████████████████████████████████▏                        | 5561/7473 [00:10<00:04, 475.59it/s] 75%|████████████████████████████████████████████████████████████████████████▉                        | 5621/7473 [00:10<00:03, 506.08it/s] 76%|█████████████████████████████████████████████████████████████████████████▋                       | 5681/7473 [00:10<00:03, 530.49it/s] 77%|██████████████████████████████████████████████████████████████████████████▌                      | 5741/7473 [00:10<00:03, 548.05it/s] 78%|███████████████████████████████████████████████████████████████████████████▎                     | 5802/7473 [00:10<00:02, 562.88it/s] 78%|████████████████████████████████████████████████████████████████████████████                     | 5863/7473 [00:10<00:02, 574.10it/s] 79%|████████████████████████████████████████████████████████████████████████████▉                    | 5923/7473 [00:10<00:02, 580.31it/s] 80%|█████████████████████████████████████████████████████████████████████████████▋                   | 5983/7473 [00:10<00:02, 585.65it/s] 81%|██████████████████████████████████████████████████████████████████████████████▍                  | 6044/7473 [00:11<00:02, 590.15it/s] 82%|███████████████████████████████████████████████████████████████████████████████▎                 | 6106/7473 [00:11<00:02, 596.12it/s] 83%|████████████████████████████████████████████████████████████████████████████████                 | 6167/7473 [00:11<00:02, 597.41it/s] 83%|████████████████████████████████████████████████████████████████████████████████▊                | 6228/7473 [00:11<00:02, 599.05it/s] 84%|█████████████████████████████████████████████████████████████████████████████████▋               | 6289/7473 [00:11<00:01, 600.87it/s] 85%|██████████████████████████████████████████████████████████████████████████████████▍              | 6350/7473 [00:11<00:01, 603.54it/s] 86%|███████████████████████████████████████████████████████████████████████████████████▏             | 6411/7473 [00:11<00:01, 599.49it/s] 87%|████████████████████████████████████████████████████████████████████████████████████             | 6472/7473 [00:11<00:01, 601.14it/s] 87%|████████████████████████████████████████████████████████████████████████████████████▊            | 6533/7473 [00:11<00:01, 602.04it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████▌           | 6594/7473 [00:11<00:01, 601.12it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████▍          | 6655/7473 [00:12<00:01, 600.77it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████▏         | 6716/7473 [00:12<00:01, 599.88it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████▉         | 6777/7473 [00:12<00:01, 600.46it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████▊        | 6838/7473 [00:12<00:01, 598.63it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████▌       | 6899/7473 [00:12<00:00, 601.35it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████▎      | 6960/7473 [00:12<00:00, 597.62it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████      | 7020/7473 [00:12<00:00, 595.42it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████▉     | 7080/7473 [00:12<00:00, 595.60it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████▋    | 7141/7473 [00:12<00:00, 597.35it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████▍   | 7202/7473 [00:12<00:00, 598.55it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████▎  | 7263/7473 [00:13<00:00, 599.09it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████  | 7324/7473 [00:13<00:00, 600.77it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████▊ | 7385/7473 [00:13<00:00, 600.70it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████▋| 7446/7473 [00:13<00:00, 602.64it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 7473/7473 [00:13<00:00, 557.56it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.14s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.08s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.34s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:06<00:12,  6.04s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.00s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.08s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.34s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:12<00:06,  6.48s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.40s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.58s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.48s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.64s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.70s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.87s/it]
[2023-08-17 18:22:48,155] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:17<00:00,  5.55s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:17<00:00,  5.76s/it]
[2023-08-17 18:23:03,521] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-17 18:23:03,523] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-17 18:23:03,523] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-17 18:23:03,523] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-17 18:23:03,523] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-17 18:23:03,525] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-17 18:23:03,526] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-17 18:23:03,526] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-17 18:23:03,526] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-17 18:23:03,526] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-17 18:23:03,526] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-17 18:23:03,526] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f05e849d370>
[2023-08-17 18:23:03,526] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-17 18:23:03,526] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-17 18:23:03,526] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-17 18:23:03,526] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-17 18:23:03,526] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-17 18:23:03,526] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-17 18:23:03,526] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-17 18:23:03,526] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-17 18:23:03,526] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-17 18:23:03,526] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-17 18:23:03,526] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-17 18:23:03,526] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-17 18:23:03,526] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-17 18:23:03,526] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-17 18:23:03,526] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-17 18:23:03,526] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-17 18:23:03,526] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-17 18:23:03,526] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-17 18:23:03,526] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-17 18:23:03,526] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-17 18:23:03,526] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-17 18:23:03,526] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-17 18:23:03,526] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-17 18:23:03,526] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-17 18:23:03,526] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-17 18:23:03,527] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-17 18:23:03,527] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-17 18:23:03,527] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-17 18:23:03,527] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-17 18:23:03,527] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-17 18:23:03,527] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-17 18:23:03,527] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-17 18:23:03,527] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f05e849d250>
[2023-08-17 18:23:03,527] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-17 18:23:03,527] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-17 18:23:03,527] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-17 18:23:03,527] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-17 18:23:03,527] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-17 18:23:03,527] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-17 18:23:03,527] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-17 18:23:03,527] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-17 18:23:03,527] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-17 18:23:03,527] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-17 18:23:03,527] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-17 18:23:03,527] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-17 18:23:03,527] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-17 18:23:03,527] [INFO] [config.py:1012:print]   train_batch_size ............. 8
[2023-08-17 18:23:03,527] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  2
[2023-08-17 18:23:03,527] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-17 18:23:03,527] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-17 18:23:03,527] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-17 18:23:03,527] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-17 18:23:03,527] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-17 18:23:03,527] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-17 18:23:03,527] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-17 18:23:03,527] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.4763307571411133 seconds
Loading extension module utils...
Time to load utils op: 0.5037336349487305 seconds
Loading extension module utils...
Time to load utils op: 0.5051732063293457 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating gsm8k :   0%|                                                                                           | 0/125 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following grade math question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: 1. The question asks for a type of plumbing that would not assist us if we are thirsty. 
2. To drink water, the plumbing involved must be connected to a source of potable water. 
3. Let's consider the options one by one:
   - A: Oil refineries. These are industrial facilities where crude oil is processed and refined into more useful products such as petroleum. Thus, their plumbing systems are designed to transport and manage oil, not water, and certainly not potable water.
   - B: Wall. Walls in most buildings normally contain some plumbing, but it is generally connected to a water supply, hence could be potentially useful when thirsty.
   - C: Show. This is unclear in context, but shows typically do not have any plumbing at all. In a metaphorical sense, a show's "plumbing" might refer to its organization and infrastructure, but that has nothing to do with satisfying thirst.
   - D: Own home. The plumbing system of homes is directly connected to potable water supply which can be used when thirsty.
   - E: Water fountain. Water fountains are specifically designed for people to drink water from, hence, the plumbing of water fountains can be used when thirsty. 
4. Therefore, out of all the options given, it is clear that 'A: oil refineries' is the location where you'd find plumbing that wouldn't be beneficial to you if you were thirsty because the plumbing there is designed to handle crude oil and other industrial products. Hence, making it the correct answer.
So the final answer is A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Output: 1. To answer this question, we need to understand each choice in the context of the question. Here the phrase ‘beginning work’ refers to starting to perform a job or task.
2. Choice A: 'working' can be ruled out because it contradicts the phrase in the question; if a person is beginning work, they are working.
3. Choice B:'resting' is not correct because if a person is beginning work, they wouldn't be resting. So, this option doesn't fit the question.
4. Choice C: 'tiredness' doesn't align with the phrase 'beginning work'. A person can be tired before, during, or after work, but being tired is not connected directly to the act of starting to work.
5. Choice E:'momentum' refers to the strength or force gained by motion or by a series of events. But it doesn't describe what a person isn't doing when they are starting to work.
6. Choice D: 'accomplishing' refers to achieving or completing a task. When a person is just beginning to work, they are not yet accomplishing, as tasks are not yet completed at the beginning stage. Therefore, choice D: 'accomplishing' is the correct answer.
So the final answer is D: accomplishing

Input:Natalia sold clips to 48 of her friends in April, and then she sold half as many clips in May. How many clips did Natalia sell altogether in April and May?
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o2-tcommonsenseqa-s1-rTrue
Loading extension module utils...
Time to load utils op: 0.5047364234924316 seconds
Evaluating gsm8k :   1%|▋                                                                                  | 1/125 [00:26<54:15, 26.25s/it]Evaluating gsm8k :   2%|█▎                                                                                 | 2/125 [00:51<52:08, 25.43s/it]Evaluating gsm8k :   2%|█▉                                                                                 | 3/125 [01:16<51:18, 25.23s/it]Evaluating gsm8k :   3%|██▋                                                                                | 4/125 [01:31<43:02, 21.34s/it]Evaluating gsm8k :   4%|███▎                                                                               | 5/125 [01:56<45:26, 22.72s/it]Evaluating gsm8k :   5%|███▉                                                                               | 6/125 [02:21<46:38, 23.52s/it]Evaluating gsm8k :   6%|████▋                                                                              | 7/125 [02:46<47:18, 24.06s/it]Evaluating gsm8k :   6%|█████▎                                                                             | 8/125 [03:12<47:49, 24.52s/it]Evaluating gsm8k :   7%|█████▉                                                                             | 9/125 [03:37<47:43, 24.68s/it]Evaluating gsm8k :   8%|██████▌                                                                           | 10/125 [03:54<42:47, 22.33s/it]Evaluating gsm8k :   9%|███████▏                                                                          | 11/125 [04:19<44:00, 23.16s/it]Evaluating gsm8k :  10%|███████▊                                                                          | 12/125 [04:38<41:27, 22.01s/it]Evaluating gsm8k :  10%|████████▌                                                                         | 13/125 [05:04<42:59, 23.03s/it]Evaluating gsm8k :  11%|█████████▏                                                                        | 14/125 [05:29<43:50, 23.70s/it]Evaluating gsm8k :  12%|█████████▊                                                                        | 15/125 [05:48<40:49, 22.27s/it]Evaluating gsm8k :  13%|██████████▍                                                                       | 16/125 [06:13<42:11, 23.23s/it]Evaluating gsm8k :  14%|███████████▏                                                                      | 17/125 [06:28<37:04, 20.59s/it]Evaluating gsm8k :  14%|███████████▊                                                                      | 18/125 [06:52<38:48, 21.76s/it]Evaluating gsm8k :  15%|████████████▍                                                                     | 19/125 [07:18<40:14, 22.78s/it]Evaluating gsm8k :  16%|█████████████                                                                     | 20/125 [07:43<41:18, 23.60s/it]Evaluating gsm8k :  17%|█████████████▊                                                                    | 21/125 [08:08<41:39, 24.04s/it]Evaluating gsm8k :  18%|██████████████▍                                                                   | 22/125 [08:33<41:47, 24.34s/it]Evaluating gsm8k :  18%|███████████████                                                                   | 23/125 [08:58<41:49, 24.60s/it]Evaluating gsm8k :  19%|███████████████▋                                                                  | 24/125 [09:24<41:50, 24.86s/it]Evaluating gsm8k :  20%|████████████████▍                                                                 | 25/125 [09:42<38:14, 22.94s/it]Evaluating gsm8k :  21%|█████████████████                                                                 | 26/125 [10:02<36:20, 22.03s/it]Evaluating gsm8k :  22%|█████████████████▋                                                                | 27/125 [10:27<37:23, 22.89s/it]Evaluating gsm8k :  22%|██████████████████▎                                                               | 28/125 [10:45<34:36, 21.41s/it]Evaluating gsm8k :  23%|███████████████████                                                               | 29/125 [11:10<36:02, 22.52s/it]Evaluating gsm8k :  24%|███████████████████▋                                                              | 30/125 [11:35<36:50, 23.26s/it]Evaluating gsm8k :  25%|████████████████████▎                                                             | 31/125 [12:01<37:30, 23.95s/it]Evaluating gsm8k :  26%|████████████████████▉                                                             | 32/125 [12:26<37:38, 24.28s/it]Evaluating gsm8k :  26%|█████████████████████▋                                                            | 33/125 [12:51<37:35, 24.52s/it]Evaluating gsm8k :  27%|██████████████████████▎                                                           | 34/125 [13:13<36:04, 23.78s/it]Evaluating gsm8k :  28%|██████████████████████▉                                                           | 35/125 [13:24<29:45, 19.84s/it]Evaluating gsm8k :  29%|███████████████████████▌                                                          | 36/125 [13:49<31:42, 21.38s/it]Evaluating gsm8k :  30%|████████████████████████▎                                                         | 37/125 [14:14<33:05, 22.56s/it]Evaluating gsm8k :  30%|████████████████████████▉                                                         | 38/125 [14:39<33:54, 23.39s/it]Evaluating gsm8k :  31%|█████████████████████████▌                                                        | 39/125 [15:04<34:08, 23.82s/it]Evaluating gsm8k :  32%|██████████████████████████▏                                                       | 40/125 [15:29<34:26, 24.32s/it]Evaluating gsm8k :  33%|██████████████████████████▉                                                       | 41/125 [15:54<34:19, 24.52s/it]Evaluating gsm8k :  34%|███████████████████████████▌                                                      | 42/125 [16:13<31:25, 22.72s/it]Evaluating gsm8k :  34%|████████████████████████████▏                                                     | 43/125 [16:38<32:00, 23.42s/it]Evaluating gsm8k :  35%|████████████████████████████▊                                                     | 44/125 [16:55<28:55, 21.42s/it]Evaluating gsm8k :  36%|█████████████████████████████▌                                                    | 45/125 [17:20<29:56, 22.46s/it]Evaluating gsm8k :  37%|██████████████████████████████▏                                                   | 46/125 [17:45<30:34, 23.22s/it]Evaluating gsm8k :  38%|██████████████████████████████▊                                                   | 47/125 [18:10<30:57, 23.81s/it]Evaluating gsm8k :  38%|███████████████████████████████▍                                                  | 48/125 [18:31<29:40, 23.12s/it]Evaluating gsm8k :  39%|████████████████████████████████▏                                                 | 49/125 [18:56<30:00, 23.69s/it]Evaluating gsm8k :  40%|████████████████████████████████▊                                                 | 50/125 [19:21<30:08, 24.11s/it]Evaluating gsm8k :  41%|█████████████████████████████████▍                                                | 51/125 [19:43<28:47, 23.34s/it]Evaluating gsm8k :  42%|██████████████████████████████████                                                | 52/125 [20:08<29:00, 23.85s/it]Evaluating gsm8k :  42%|██████████████████████████████████▊                                               | 53/125 [20:33<29:06, 24.26s/it]Evaluating gsm8k :  43%|███████████████████████████████████▍                                              | 54/125 [20:59<29:07, 24.61s/it]Evaluating gsm8k :  44%|████████████████████████████████████                                              | 55/125 [21:24<28:55, 24.79s/it]Evaluating gsm8k :  45%|████████████████████████████████████▋                                             | 56/125 [21:49<28:35, 24.86s/it]Evaluating gsm8k :  46%|█████████████████████████████████████▍                                            | 57/125 [22:04<24:45, 21.84s/it]Evaluating gsm8k :  46%|██████████████████████████████████████                                            | 58/125 [22:29<25:25, 22.76s/it]Evaluating gsm8k :  47%|██████████████████████████████████████▋                                           | 59/125 [22:54<25:57, 23.60s/it]Evaluating gsm8k :  48%|███████████████████████████████████████▎                                          | 60/125 [23:19<26:03, 24.05s/it]Evaluating gsm8k :  49%|████████████████████████████████████████                                          | 61/125 [23:44<26:00, 24.38s/it]Evaluating gsm8k :  50%|████████████████████████████████████████▋                                         | 62/125 [23:53<20:44, 19.75s/it]Evaluating gsm8k :  50%|█████████████████████████████████████████▎                                        | 63/125 [24:19<22:04, 21.37s/it]Evaluating gsm8k :  51%|█████████████████████████████████████████▉                                        | 64/125 [24:44<22:57, 22.58s/it]Evaluating gsm8k :  52%|██████████████████████████████████████████▋                                       | 65/125 [25:10<23:29, 23.49s/it]Evaluating gsm8k :  53%|███████████████████████████████████████████▎                                      | 66/125 [25:35<23:36, 24.01s/it]Evaluating gsm8k :  54%|███████████████████████████████████████████▉                                      | 67/125 [25:48<20:05, 20.78s/it]Evaluating gsm8k :  54%|████████████████████████████████████████████▌                                     | 68/125 [26:13<20:56, 22.05s/it]Evaluating gsm8k :  55%|█████████████████████████████████████████████▎                                    | 69/125 [26:38<21:26, 22.97s/it]Evaluating gsm8k :  56%|█████████████████████████████████████████████▉                                    | 70/125 [27:03<21:37, 23.60s/it]Evaluating gsm8k :  57%|██████████████████████████████████████████████▌                                   | 71/125 [27:28<21:39, 24.06s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▏                                  | 72/125 [27:53<21:29, 24.32s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▉                                  | 73/125 [28:18<21:18, 24.58s/it]Evaluating gsm8k :  59%|████████████████████████████████████████████████▌                                 | 74/125 [28:44<21:08, 24.86s/it]Evaluating gsm8k :  60%|█████████████████████████████████████████████████▏                                | 75/125 [29:09<20:46, 24.93s/it]Evaluating gsm8k :  61%|█████████████████████████████████████████████████▊                                | 76/125 [29:34<20:22, 24.94s/it]Evaluating gsm8k :  62%|██████████████████████████████████████████████████▌                               | 77/125 [29:59<19:59, 24.98s/it]Evaluating gsm8k :  62%|███████████████████████████████████████████████████▏                              | 78/125 [30:24<19:38, 25.08s/it]Evaluating gsm8k :  63%|███████████████████████████████████████████████████▊                              | 79/125 [30:50<19:16, 25.15s/it]Evaluating gsm8k :  64%|████████████████████████████████████████████████████▍                             | 80/125 [31:08<17:16, 23.04s/it]Evaluating gsm8k :  65%|█████████████████████████████████████████████████████▏                            | 81/125 [31:33<17:24, 23.73s/it]Evaluating gsm8k :  66%|█████████████████████████████████████████████████████▊                            | 82/125 [31:43<14:04, 19.65s/it]Evaluating gsm8k :  66%|██████████████████████████████████████████████████████▍                           | 83/125 [32:08<14:54, 21.30s/it]Evaluating gsm8k :  67%|███████████████████████████████████████████████████████                           | 84/125 [32:34<15:24, 22.54s/it]Evaluating gsm8k :  68%|███████████████████████████████████████████████████████▊                          | 85/125 [32:50<13:43, 20.59s/it]Evaluating gsm8k :  69%|████████████████████████████████████████████████████████▍                         | 86/125 [33:15<14:18, 22.01s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████                         | 87/125 [33:25<11:32, 18.22s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████▋                        | 88/125 [33:45<11:33, 18.73s/it]Evaluating gsm8k :  71%|██████████████████████████████████████████████████████████▍                       | 89/125 [34:05<11:28, 19.14s/it]Evaluating gsm8k :  72%|███████████████████████████████████████████████████████████                       | 90/125 [34:30<12:13, 20.96s/it]Evaluating gsm8k :  73%|███████████████████████████████████████████████████████████▋                      | 91/125 [34:51<11:56, 21.08s/it]Evaluating gsm8k :  74%|████████████████████████████████████████████████████████████▎                     | 92/125 [35:16<12:09, 22.11s/it]Evaluating gsm8k :  74%|█████████████████████████████████████████████████████████████                     | 93/125 [35:41<12:16, 23.01s/it]Evaluating gsm8k :  75%|█████████████████████████████████████████████████████████████▋                    | 94/125 [36:02<11:40, 22.59s/it]Evaluating gsm8k :  76%|██████████████████████████████████████████████████████████████▎                   | 95/125 [36:27<11:38, 23.30s/it]Evaluating gsm8k :  77%|██████████████████████████████████████████████████████████████▉                   | 96/125 [36:52<11:30, 23.80s/it]Evaluating gsm8k :  78%|███████████████████████████████████████████████████████████████▋                  | 97/125 [37:08<10:00, 21.44s/it]Evaluating gsm8k :  78%|████████████████████████████████████████████████████████████████▎                 | 98/125 [37:33<10:08, 22.55s/it]Evaluating gsm8k :  79%|████████████████████████████████████████████████████████████████▉                 | 99/125 [37:59<10:08, 23.39s/it]Evaluating gsm8k :  80%|████████████████████████████████████████████████████████████████▊                | 100/125 [38:24<09:57, 23.92s/it]Evaluating gsm8k :  81%|█████████████████████████████████████████████████████████████████▍               | 101/125 [38:49<09:42, 24.27s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████               | 102/125 [39:14<09:22, 24.47s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████▋              | 103/125 [39:39<09:03, 24.69s/it]Evaluating gsm8k :  83%|███████████████████████████████████████████████████████████████████▍             | 104/125 [40:01<08:20, 23.86s/it]Evaluating gsm8k :  84%|████████████████████████████████████████████████████████████████████             | 105/125 [40:26<08:04, 24.21s/it]Evaluating gsm8k :  85%|████████████████████████████████████████████████████████████████████▋            | 106/125 [40:52<07:47, 24.60s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▎           | 107/125 [41:17<07:25, 24.77s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▉           | 108/125 [41:42<07:04, 24.99s/it]Evaluating gsm8k :  87%|██████████████████████████████████████████████████████████████████████▋          | 109/125 [42:07<06:40, 25.02s/it]Evaluating gsm8k :  88%|███████████████████████████████████████████████████████████████████████▎         | 110/125 [42:33<06:17, 25.14s/it]Evaluating gsm8k :  89%|███████████████████████████████████████████████████████████████████████▉         | 111/125 [42:55<05:39, 24.25s/it]Evaluating gsm8k :  90%|████████████████████████████████████████████████████████████████████████▌        | 112/125 [43:21<05:20, 24.63s/it]Evaluating gsm8k :  90%|█████████████████████████████████████████████████████████████████████████▏       | 113/125 [43:45<04:56, 24.73s/it]Evaluating gsm8k :  91%|█████████████████████████████████████████████████████████████████████████▊       | 114/125 [43:59<03:56, 21.50s/it]Evaluating gsm8k :  92%|██████████████████████████████████████████████████████████████████████████▌      | 115/125 [44:25<03:45, 22.58s/it]Evaluating gsm8k :  93%|███████████████████████████████████████████████████████████████████████████▏     | 116/125 [44:35<02:51, 19.05s/it]Evaluating gsm8k :  94%|███████████████████████████████████████████████████████████████████████████▊     | 117/125 [44:54<02:31, 18.98s/it]Evaluating gsm8k :  94%|████████████████████████████████████████████████████████████████████████████▍    | 118/125 [45:19<02:25, 20.80s/it]Evaluating gsm8k :  95%|█████████████████████████████████████████████████████████████████████████████    | 119/125 [45:44<02:12, 22.14s/it]Evaluating gsm8k :  96%|█████████████████████████████████████████████████████████████████████████████▊   | 120/125 [46:10<01:56, 23.21s/it]Evaluating gsm8k :  97%|██████████████████████████████████████████████████████████████████████████████▍  | 121/125 [46:35<01:35, 23.77s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████  | 122/125 [47:00<01:12, 24.15s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████▋ | 123/125 [47:25<00:48, 24.43s/it]Evaluating gsm8k :  99%|████████████████████████████████████████████████████████████████████████████████▎| 124/125 [47:51<00:24, 24.68s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [48:16<00:00, 24.88s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [48:16<00:00, 23.17s/it]
name: gsm8k | {'exact_match': 0.0, 'rougeL': 0.2209} | lm_loss 11.7217 | avg. gen lenth: 380.456
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name gsm8k --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name commonsenseqa --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 2 --data-dir /scratch/ylu130/processed_data/gsm8k/out-domain/o3-tcommonsenseqa-s1-rTrue --seed 1 --max-prompt-length 2048 --rationales --num-out-domain 3
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-17 19:11:26,831] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... gsm8k
  data_dir ..................... /scratch/ylu130/processed_data/gsm8k/out-domain/o3-tcommonsenseqa-s1-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 3
  out_domain_data_name ......... commonsenseqa
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o3-tcommonsenseqa-s1-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 2
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                                             | 0/7473 [00:00<?, ?it/s]  1%|▌                                                                                                  | 46/7473 [00:00<00:16, 455.72it/s]  1%|█▏                                                                                                 | 92/7473 [00:00<00:16, 455.49it/s]  2%|█▊                                                                                                | 139/7473 [00:00<00:16, 457.65it/s]  2%|██▍                                                                                               | 185/7473 [00:00<00:15, 458.37it/s]  3%|███                                                                                               | 232/7473 [00:00<00:15, 459.89it/s]  4%|███▋                                                                                              | 278/7473 [00:00<00:15, 457.77it/s]  4%|████▎                                                                                             | 325/7473 [00:00<00:15, 459.49it/s]  5%|████▊                                                                                             | 371/7473 [00:00<00:15, 458.95it/s]  6%|█████▍                                                                                            | 417/7473 [00:00<00:15, 452.88it/s]  6%|██████                                                                                            | 463/7473 [00:01<00:15, 454.77it/s]  7%|██████▋                                                                                           | 509/7473 [00:01<00:15, 453.67it/s]  7%|███████▎                                                                                          | 556/7473 [00:01<00:15, 456.60it/s]  8%|███████▉                                                                                          | 602/7473 [00:01<00:15, 456.72it/s]  9%|████████▍                                                                                         | 648/7473 [00:01<00:14, 457.12it/s]  9%|█████████                                                                                         | 695/7473 [00:01<00:14, 459.47it/s] 10%|█████████▋                                                                                        | 741/7473 [00:01<00:14, 459.46it/s] 11%|██████████▎                                                                                       | 788/7473 [00:01<00:14, 459.57it/s] 11%|██████████▉                                                                                       | 834/7473 [00:01<00:14, 458.89it/s] 12%|███████████▌                                                                                      | 880/7473 [00:01<00:14, 452.30it/s] 12%|████████████▏                                                                                     | 926/7473 [00:02<00:14, 454.05it/s] 13%|████████████▋                                                                                     | 972/7473 [00:02<00:14, 454.12it/s] 14%|█████████████▏                                                                                   | 1019/7473 [00:02<00:14, 456.07it/s] 14%|█████████████▊                                                                                   | 1066/7473 [00:02<00:13, 457.94it/s] 15%|██████████████▍                                                                                  | 1113/7473 [00:02<00:13, 458.75it/s] 16%|███████████████                                                                                  | 1159/7473 [00:02<00:13, 456.63it/s] 16%|███████████████▋                                                                                 | 1205/7473 [00:02<00:13, 457.35it/s] 17%|████████████████▎                                                                                | 1252/7473 [00:02<00:13, 458.41it/s] 17%|████████████████▊                                                                                | 1299/7473 [00:02<00:13, 458.85it/s] 18%|█████████████████▍                                                                               | 1345/7473 [00:02<00:13, 458.15it/s] 19%|██████████████████                                                                               | 1391/7473 [00:03<00:13, 455.21it/s] 19%|██████████████████▋                                                                              | 1437/7473 [00:03<00:13, 456.15it/s] 20%|███████████████████▏                                                                             | 1483/7473 [00:03<00:13, 457.17it/s] 20%|███████████████████▊                                                                             | 1530/7473 [00:03<00:12, 459.26it/s] 21%|████████████████████▍                                                                            | 1576/7473 [00:03<00:12, 457.53it/s] 22%|█████████████████████                                                                            | 1622/7473 [00:03<00:12, 455.53it/s] 22%|█████████████████████▋                                                                           | 1668/7473 [00:03<00:12, 456.50it/s] 23%|██████████████████████▏                                                                          | 1714/7473 [00:03<00:12, 457.06it/s] 24%|██████████████████████▊                                                                          | 1760/7473 [00:03<00:12, 456.11it/s] 24%|███████████████████████▍                                                                         | 1806/7473 [00:03<00:12, 453.88it/s] 25%|████████████████████████                                                                         | 1852/7473 [00:04<00:12, 451.15it/s] 25%|████████████████████████▋                                                                        | 1898/7473 [00:04<00:12, 447.05it/s] 26%|█████████████████████████▏                                                                       | 1943/7473 [00:04<00:12, 445.39it/s] 27%|█████████████████████████▊                                                                       | 1989/7473 [00:04<00:12, 448.63it/s] 27%|██████████████████████████▍                                                                      | 2035/7473 [00:04<00:12, 451.08it/s] 28%|███████████████████████████                                                                      | 2081/7473 [00:04<00:11, 449.89it/s] 28%|███████████████████████████▌                                                                     | 2127/7473 [00:04<00:11, 451.45it/s] 29%|████████████████████████████▏                                                                    | 2173/7473 [00:04<00:11, 453.22it/s] 30%|████████████████████████████▊                                                                    | 2219/7473 [00:04<00:11, 453.79it/s] 30%|█████████████████████████████▍                                                                   | 2265/7473 [00:04<00:11, 453.77it/s] 31%|█████████████████████████████▉                                                                   | 2311/7473 [00:05<00:11, 452.04it/s] 32%|██████████████████████████████▌                                                                  | 2357/7473 [00:05<00:11, 452.19it/s] 32%|███████████████████████████████▏                                                                 | 2403/7473 [00:05<00:11, 451.80it/s] 33%|███████████████████████████████▊                                                                 | 2449/7473 [00:05<00:11, 452.75it/s] 33%|████████████████████████████████▍                                                                | 2495/7473 [00:05<00:10, 453.20it/s] 34%|████████████████████████████████▉                                                                | 2541/7473 [00:05<00:11, 426.68it/s] 35%|█████████████████████████████████▌                                                               | 2588/7473 [00:05<00:11, 437.52it/s] 35%|██████████████████████████████████▏                                                              | 2634/7473 [00:05<00:10, 442.84it/s] 36%|██████████████████████████████████▊                                                              | 2681/7473 [00:05<00:10, 449.45it/s] 36%|███████████████████████████████████▍                                                             | 2727/7473 [00:06<00:10, 451.95it/s] 37%|███████████████████████████████████▉                                                             | 2773/7473 [00:06<00:10, 451.13it/s] 38%|████████████████████████████████████▌                                                            | 2820/7473 [00:06<00:10, 454.19it/s] 38%|█████████████████████████████████████▏                                                           | 2866/7473 [00:06<00:10, 454.43it/s] 39%|█████████████████████████████████████▊                                                           | 2912/7473 [00:06<00:10, 455.08it/s] 40%|██████████████████████████████████████▍                                                          | 2959/7473 [00:06<00:09, 458.51it/s] 40%|███████████████████████████████████████                                                          | 3005/7473 [00:06<00:09, 457.51it/s] 41%|███████████████████████████████████████▌                                                         | 3052/7473 [00:06<00:09, 458.57it/s] 41%|████████████████████████████████████████▏                                                        | 3099/7473 [00:06<00:09, 459.76it/s] 42%|████████████████████████████████████████▊                                                        | 3145/7473 [00:06<00:09, 458.47it/s] 43%|█████████████████████████████████████████▍                                                       | 3192/7473 [00:07<00:09, 459.15it/s] 43%|██████████████████████████████████████████                                                       | 3238/7473 [00:07<00:09, 455.16it/s] 44%|██████████████████████████████████████████▋                                                      | 3285/7473 [00:07<00:09, 457.70it/s] 45%|███████████████████████████████████████████▏                                                     | 3331/7473 [00:07<00:09, 458.11it/s] 45%|███████████████████████████████████████████▊                                                     | 3377/7473 [00:07<00:08, 456.40it/s] 46%|████████████████████████████████████████████▍                                                    | 3423/7473 [00:07<00:08, 456.05it/s] 46%|█████████████████████████████████████████████                                                    | 3469/7473 [00:07<00:08, 454.67it/s] 47%|█████████████████████████████████████████████▋                                                   | 3516/7473 [00:07<00:08, 456.92it/s] 48%|██████████████████████████████████████████████▏                                                  | 3563/7473 [00:07<00:08, 458.01it/s] 48%|██████████████████████████████████████████████▊                                                  | 3610/7473 [00:07<00:08, 459.30it/s] 49%|███████████████████████████████████████████████▍                                                 | 3656/7473 [00:08<00:08, 454.51it/s] 50%|████████████████████████████████████████████████                                                 | 3702/7473 [00:08<00:08, 453.45it/s] 50%|████████████████████████████████████████████████▋                                                | 3748/7473 [00:08<00:08, 451.52it/s] 51%|█████████████████████████████████████████████████▏                                               | 3794/7473 [00:08<00:08, 450.51it/s] 51%|█████████████████████████████████████████████████▊                                               | 3840/7473 [00:08<00:08, 445.09it/s] 52%|██████████████████████████████████████████████████▍                                              | 3885/7473 [00:08<00:08, 441.40it/s] 53%|███████████████████████████████████████████████████                                              | 3931/7473 [00:08<00:07, 446.77it/s] 53%|███████████████████████████████████████████████████▋                                             | 3978/7473 [00:08<00:07, 450.84it/s] 54%|████████████████████████████████████████████████████▏                                            | 4025/7473 [00:08<00:07, 454.99it/s] 54%|████████████████████████████████████████████████████▊                                            | 4071/7473 [00:08<00:07, 456.41it/s] 55%|█████████████████████████████████████████████████████▍                                           | 4117/7473 [00:09<00:07, 454.53it/s] 56%|██████████████████████████████████████████████████████                                           | 4163/7473 [00:09<00:07, 454.08it/s] 56%|██████████████████████████████████████████████████████▋                                          | 4209/7473 [00:09<00:07, 454.97it/s] 57%|███████████████████████████████████████████████████████▏                                         | 4255/7473 [00:09<00:07, 455.80it/s] 58%|███████████████████████████████████████████████████████▊                                         | 4301/7473 [00:09<00:07, 453.13it/s] 58%|████████████████████████████████████████████████████████▍                                        | 4347/7473 [00:09<00:06, 452.21it/s] 59%|█████████████████████████████████████████████████████████                                        | 4393/7473 [00:09<00:06, 454.20it/s] 59%|█████████████████████████████████████████████████████████▌                                       | 4439/7473 [00:09<00:06, 451.93it/s] 60%|██████████████████████████████████████████████████████████▏                                      | 4485/7473 [00:09<00:06, 453.55it/s] 61%|██████████████████████████████████████████████████████████▊                                      | 4531/7473 [00:09<00:06, 453.75it/s] 61%|███████████████████████████████████████████████████████████▍                                     | 4577/7473 [00:10<00:06, 453.95it/s] 62%|████████████████████████████████████████████████████████████                                     | 4623/7473 [00:10<00:06, 455.71it/s] 62%|████████████████████████████████████████████████████████████▌                                    | 4669/7473 [00:10<00:06, 456.47it/s] 63%|█████████████████████████████████████████████████████████████▏                                   | 4715/7473 [00:10<00:06, 457.26it/s] 64%|█████████████████████████████████████████████████████████████▊                                   | 4762/7473 [00:10<00:05, 458.81it/s] 64%|██████████████████████████████████████████████████████████████▍                                  | 4808/7473 [00:10<00:05, 454.79it/s] 65%|███████████████████████████████████████████████████████████████                                  | 4854/7473 [00:10<00:05, 450.33it/s] 66%|███████████████████████████████████████████████████████████████▌                                 | 4900/7473 [00:10<00:05, 452.45it/s] 66%|████████████████████████████████████████████████████████████████▏                                | 4947/7473 [00:10<00:05, 454.82it/s] 67%|████████████████████████████████████████████████████████████████▊                                | 4993/7473 [00:10<00:05, 455.45it/s] 67%|█████████████████████████████████████████████████████████████████▍                               | 5039/7473 [00:11<00:05, 455.10it/s] 68%|██████████████████████████████████████████████████████████████████                               | 5085/7473 [00:11<00:05, 456.18it/s] 69%|██████████████████████████████████████████████████████████████████▌                              | 5132/7473 [00:11<00:05, 457.43it/s] 69%|███████████████████████████████████████████████████████████████████▏                             | 5179/7473 [00:11<00:05, 458.36it/s] 70%|███████████████████████████████████████████████████████████████████▊                             | 5225/7473 [00:11<00:04, 458.23it/s] 71%|████████████████████████████████████████████████████████████████████▍                            | 5271/7473 [00:11<00:05, 419.12it/s] 71%|████████████████████████████████████████████████████████████████████▉                            | 5315/7473 [00:11<00:05, 424.61it/s] 72%|█████████████████████████████████████████████████████████████████████▌                           | 5360/7473 [00:11<00:04, 430.04it/s] 72%|██████████████████████████████████████████████████████████████████████▏                          | 5406/7473 [00:11<00:04, 438.01it/s] 73%|██████████████████████████████████████████████████████████████████████▊                          | 5452/7473 [00:12<00:04, 442.15it/s] 74%|███████████████████████████████████████████████████████████████████████▎                         | 5497/7473 [00:12<00:06, 319.86it/s] 74%|███████████████████████████████████████████████████████████████████████▉                         | 5542/7473 [00:12<00:05, 349.09it/s] 75%|████████████████████████████████████████████████████████████████████████▌                        | 5588/7473 [00:12<00:05, 376.02it/s] 75%|█████████████████████████████████████████████████████████████████████████▏                       | 5634/7473 [00:12<00:04, 397.11it/s] 76%|█████████████████████████████████████████████████████████████████████████▋                       | 5680/7473 [00:12<00:04, 411.90it/s] 77%|██████████████████████████████████████████████████████████████████████████▎                      | 5724/7473 [00:12<00:04, 418.63it/s] 77%|██████████████████████████████████████████████████████████████████████████▉                      | 5769/7473 [00:12<00:04, 425.90it/s] 78%|███████████████████████████████████████████████████████████████████████████▍                     | 5815/7473 [00:12<00:03, 434.33it/s] 78%|████████████████████████████████████████████████████████████████████████████                     | 5861/7473 [00:13<00:03, 440.33it/s] 79%|████████████████████████████████████████████████████████████████████████████▋                    | 5906/7473 [00:13<00:03, 442.20it/s] 80%|█████████████████████████████████████████████████████████████████████████████▎                   | 5952/7473 [00:13<00:03, 444.80it/s] 80%|█████████████████████████████████████████████████████████████████████████████▊                   | 5998/7473 [00:13<00:03, 447.33it/s] 81%|██████████████████████████████████████████████████████████████████████████████▍                  | 6044/7473 [00:13<00:03, 449.70it/s] 82%|███████████████████████████████████████████████████████████████████████████████                  | 6091/7473 [00:13<00:03, 453.15it/s] 82%|███████████████████████████████████████████████████████████████████████████████▋                 | 6137/7473 [00:13<00:02, 452.75it/s] 83%|████████████████████████████████████████████████████████████████████████████████▎                | 6183/7473 [00:13<00:02, 453.59it/s] 83%|████████████████████████████████████████████████████████████████████████████████▊                | 6229/7473 [00:13<00:02, 447.46it/s] 84%|█████████████████████████████████████████████████████████████████████████████████▍               | 6274/7473 [00:13<00:02, 445.98it/s] 85%|██████████████████████████████████████████████████████████████████████████████████               | 6320/7473 [00:14<00:02, 448.26it/s] 85%|██████████████████████████████████████████████████████████████████████████████████▌              | 6365/7473 [00:14<00:02, 448.44it/s] 86%|███████████████████████████████████████████████████████████████████████████████████▏             | 6411/7473 [00:14<00:02, 450.15it/s] 86%|███████████████████████████████████████████████████████████████████████████████████▊             | 6457/7473 [00:14<00:02, 451.92it/s] 87%|████████████████████████████████████████████████████████████████████████████████████▍            | 6503/7473 [00:14<00:02, 453.86it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████            | 6549/7473 [00:14<00:02, 455.09it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████▌           | 6595/7473 [00:14<00:01, 455.12it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████▏          | 6641/7473 [00:14<00:01, 455.55it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████▊          | 6687/7473 [00:14<00:01, 453.51it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████▍         | 6733/7473 [00:15<00:01, 450.70it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████▉         | 6779/7473 [00:15<00:01, 452.16it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████▌        | 6825/7473 [00:15<00:01, 451.91it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████▏       | 6871/7473 [00:15<00:01, 454.29it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████▊       | 6918/7473 [00:15<00:01, 457.03it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████▍      | 6964/7473 [00:15<00:01, 457.84it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████▉      | 7010/7473 [00:15<00:01, 458.13it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████▌     | 7056/7473 [00:15<00:00, 455.62it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████▏    | 7103/7473 [00:15<00:00, 457.33it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████▊    | 7149/7473 [00:15<00:00, 457.62it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████▍   | 7195/7473 [00:16<00:00, 453.23it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████▉   | 7241/7473 [00:16<00:00, 451.76it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████▌  | 7287/7473 [00:16<00:00, 449.14it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████▏ | 7333/7473 [00:16<00:00, 450.26it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████▊ | 7379/7473 [00:16<00:00, 452.06it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████▍| 7426/7473 [00:16<00:00, 455.10it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████▉| 7472/7473 [00:16<00:00, 456.44it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 7473/7473 [00:16<00:00, 449.32it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:04<00:09,  4.79s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:11,  5.59s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.12s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.27s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:09<00:04,  4.90s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.42s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.38s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:11<00:05,  5.72s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.36s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.50s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  4.86s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.02s/it]
[2023-08-17 19:12:36,049] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.77s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.92s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  4.90s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.06s/it]
[2023-08-17 19:12:52,642] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-17 19:12:52,643] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-17 19:12:52,643] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-17 19:12:52,643] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-17 19:12:52,643] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-17 19:12:52,643] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-17 19:12:52,644] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-17 19:12:52,644] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-17 19:12:52,644] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-17 19:12:52,644] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-17 19:12:52,644] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-17 19:12:52,644] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fb1d97bc370>
[2023-08-17 19:12:52,644] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-17 19:12:52,644] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-17 19:12:52,644] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-17 19:12:52,644] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-17 19:12:52,644] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-17 19:12:52,644] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-17 19:12:52,644] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-17 19:12:52,644] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-17 19:12:52,644] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-17 19:12:52,644] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-17 19:12:52,644] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-17 19:12:52,644] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-17 19:12:52,644] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-17 19:12:52,644] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-17 19:12:52,644] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-17 19:12:52,644] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-17 19:12:52,644] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-17 19:12:52,645] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-17 19:12:52,645] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-17 19:12:52,645] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-17 19:12:52,645] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-17 19:12:52,645] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-17 19:12:52,645] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-17 19:12:52,645] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-17 19:12:52,645] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-17 19:12:52,645] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-17 19:12:52,645] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-17 19:12:52,645] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-17 19:12:52,645] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-17 19:12:52,645] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-17 19:12:52,645] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-17 19:12:52,645] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-17 19:12:52,645] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7fb1d97bc250>
[2023-08-17 19:12:52,645] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-17 19:12:52,645] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-17 19:12:52,645] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-17 19:12:52,645] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-17 19:12:52,645] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-17 19:12:52,645] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-17 19:12:52,645] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-17 19:12:52,645] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-17 19:12:52,645] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-17 19:12:52,645] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-17 19:12:52,645] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-17 19:12:52,645] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-17 19:12:52,645] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-17 19:12:52,645] [INFO] [config.py:1012:print]   train_batch_size ............. 8
[2023-08-17 19:12:52,645] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  2
[2023-08-17 19:12:52,645] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-17 19:12:52,645] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-17 19:12:52,645] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-17 19:12:52,645] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-17 19:12:52,646] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-17 19:12:52,646] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-17 19:12:52,646] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-17 19:12:52,646] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.5499942302703857 seconds
Loading extension module utils...
Time to load utils op: 0.5048689842224121 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Loading extension module utils...
Evaluating gsm8k :   0%|                                                                                           | 0/125 [00:00<?, ?it/s]Time to load utils op: 0.5046370029449463 seconds
############### Example ###############
### Instruction:Answer the following grade math question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: 1. The question asks where you could find plumbing that would not be beneficial if you were thirsty. 
2. This implies that we're looking for a place where there's plumbing, but the liquid flowing through it isn't drinkable.
3. We can eliminate options C: show and D: own home, as both places potentially have access to drinking water.
4. Similarly, option E: water fountain is specifically designed to provide drinking water, so it can also be eliminated.
5. Option B: wall is tricky, but it can be assumed that if it is a residential or commercial wall, they typically house water pipes. So, it can also be eliminated.
6. That leaves us with option A: oil refineries. Oil refinery is a place where crude oil is processed and refined into more useful products like petroleum. In this process, a lot of pipelines or plumbing are used but none of them have potable water.
7. Therefore, the answer is A: oil refineries.
So the final answer is A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Output: 1. The person is "beginning" to work, which means that they have just started working on their tasks.
2. They are indeed "working", so A cannot be the answer.
3. "Resting" is not something that you would normally do when you are beginning a task, but since it doesn't mean they aren't doing it yet, B isn't the correct answer.
4. "Tiredness" is a state of being, which isn't something you'd likely experience at the start of a task. However, it also does not express the ongoing action, so C isn't the correct answer.
5. "Momentum" refers to ongoing force or speed in a given direction. It's quite possible for a person to have momentum at the start of their work. Hence, E is not the answer.
6. Hence, we are left with "D: accomplishing". The act of accomplishing implies that one has completed or achieved something, this will not be the case at the beginning of work, they are starting their work and haven't accomplished it yet.
7. Therefore, the correct answer is D: accomplishing.
So the final answer is D: accomplishing

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Output: 1. The question asks for a location where one might find pens with a company logo.
2. Pen with a company logo usually means it is a promotional material or a corporate gift that companies use to represent their identity.
3. Let's consider all the available options one by one.
4. Option B, on a pencil, is not a location, rather, it seems like a physical site on another stationery item which logically does not relate to finding pens with a company logo.
5. Option C, write sentences on paper, is an activity, not a location either where one could find pens with a company logo.
6. Option D, school, could possibly have pens with a company logo, but it's less likely than an office, because schools typically do not have too many direct business relations that they would receive promotional items from companies.
7. Option E, backpack, is a personal item that could possibly house a pen with a company logo, but it is not a certain place where you'd automatically expect to find such items.
8. Option A, office, is the location most likely to have pens with a company logo. Companies tend to distribute promotional pens in the office environment, either to their employees or to visitors during corporate meetings.
9. Based on these analyzations, the most suitable answer is option A: office.
So the final answer is A: office

Input:Natalia sold clips to 48 of her friends in April, and then she sold half as many clips in May. How many clips did Natalia sell altogether in April and May?
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o3-tcommonsenseqa-s1-rTrue
Loading extension module utils...
Time to load utils op: 0.6046042442321777 seconds
Evaluating gsm8k :   1%|▋                                                                                  | 1/125 [00:25<53:03, 25.67s/it]Evaluating gsm8k :   2%|█▎                                                                                 | 2/125 [00:49<50:47, 24.78s/it]Evaluating gsm8k :   2%|█▉                                                                                 | 3/125 [01:14<49:59, 24.59s/it]Evaluating gsm8k :   3%|██▋                                                                                | 4/125 [01:38<49:18, 24.45s/it]Evaluating gsm8k :   4%|███▎                                                                               | 5/125 [01:46<37:11, 18.59s/it]Evaluating gsm8k :   5%|███▉                                                                               | 6/125 [02:00<33:44, 17.01s/it]Evaluating gsm8k :   6%|████▋                                                                              | 7/125 [02:25<38:14, 19.45s/it]Evaluating gsm8k :   6%|█████▎                                                                             | 8/125 [02:48<40:15, 20.65s/it]Evaluating gsm8k :   7%|█████▉                                                                             | 9/125 [03:12<42:17, 21.88s/it]Evaluating gsm8k :   8%|██████▌                                                                           | 10/125 [03:23<35:06, 18.32s/it]Evaluating gsm8k :   9%|███████▏                                                                          | 11/125 [03:37<32:42, 17.22s/it]Evaluating gsm8k :  10%|███████▊                                                                          | 12/125 [04:02<36:35, 19.43s/it]Evaluating gsm8k :  10%|████████▌                                                                         | 13/125 [04:26<38:59, 20.89s/it]Evaluating gsm8k :  11%|█████████▏                                                                        | 14/125 [04:35<31:39, 17.11s/it]Evaluating gsm8k :  12%|█████████▊                                                                        | 15/125 [04:47<28:40, 15.64s/it]Evaluating gsm8k :  13%|██████████▍                                                                       | 16/125 [04:58<26:13, 14.44s/it]Evaluating gsm8k :  14%|███████████▏                                                                      | 17/125 [05:18<28:53, 16.05s/it]Evaluating gsm8k :  14%|███████████▊                                                                      | 18/125 [05:43<33:09, 18.60s/it]Evaluating gsm8k :  15%|████████████▍                                                                     | 19/125 [06:07<35:58, 20.36s/it]Evaluating gsm8k :  16%|█████████████                                                                     | 20/125 [06:32<37:50, 21.62s/it]Evaluating gsm8k :  17%|█████████████▊                                                                    | 21/125 [06:56<38:54, 22.45s/it]Evaluating gsm8k :  18%|██████████████▍                                                                   | 22/125 [07:21<39:35, 23.07s/it]Evaluating gsm8k :  18%|███████████████                                                                   | 23/125 [07:45<40:04, 23.57s/it]Evaluating gsm8k :  19%|███████████████▋                                                                  | 24/125 [08:10<40:04, 23.81s/it]Evaluating gsm8k :  20%|████████████████▍                                                                 | 25/125 [08:25<35:29, 21.29s/it]Evaluating gsm8k :  21%|█████████████████                                                                 | 26/125 [08:50<36:46, 22.29s/it]Evaluating gsm8k :  22%|█████████████████▋                                                                | 27/125 [09:14<37:30, 22.97s/it]Evaluating gsm8k :  22%|██████████████████▎                                                               | 28/125 [09:34<35:37, 22.04s/it]Evaluating gsm8k :  23%|███████████████████                                                               | 29/125 [09:59<36:22, 22.74s/it]Evaluating gsm8k :  24%|███████████████████▋                                                              | 30/125 [10:23<36:47, 23.24s/it]Evaluating gsm8k :  25%|████████████████████▎                                                             | 31/125 [10:48<37:05, 23.68s/it]Evaluating gsm8k :  26%|████████████████████▉                                                             | 32/125 [11:12<36:59, 23.87s/it]Evaluating gsm8k :  26%|█████████████████████▋                                                            | 33/125 [11:27<32:29, 21.19s/it]Evaluating gsm8k :  27%|██████████████████████▎                                                           | 34/125 [11:51<33:35, 22.15s/it]Evaluating gsm8k :  28%|██████████████████████▉                                                           | 35/125 [12:15<34:07, 22.75s/it]Evaluating gsm8k :  29%|███████████████████████▌                                                          | 36/125 [12:40<34:33, 23.29s/it]Evaluating gsm8k :  30%|████████████████████████▎                                                         | 37/125 [13:04<34:35, 23.59s/it]Evaluating gsm8k :  30%|████████████████████████▉                                                         | 38/125 [13:29<34:32, 23.82s/it]Evaluating gsm8k :  31%|█████████████████████████▌                                                        | 39/125 [13:53<34:16, 23.91s/it]Evaluating gsm8k :  32%|██████████████████████████▏                                                       | 40/125 [14:17<34:07, 24.09s/it]Evaluating gsm8k :  33%|██████████████████████████▉                                                       | 41/125 [14:42<33:50, 24.17s/it]Evaluating gsm8k :  34%|███████████████████████████▌                                                      | 42/125 [14:51<27:13, 19.69s/it]Evaluating gsm8k :  34%|████████████████████████████▏                                                     | 43/125 [15:12<27:26, 20.08s/it]Evaluating gsm8k :  35%|████████████████████████████▊                                                     | 44/125 [15:21<22:32, 16.70s/it]Evaluating gsm8k :  36%|█████████████████████████████▌                                                    | 45/125 [15:33<20:36, 15.46s/it]Evaluating gsm8k :  37%|██████████████████████████████▏                                                   | 46/125 [15:58<23:49, 18.10s/it]Evaluating gsm8k :  38%|██████████████████████████████▊                                                   | 47/125 [16:22<25:57, 19.96s/it]Evaluating gsm8k :  38%|███████████████████████████████▍                                                  | 48/125 [16:46<27:24, 21.36s/it]Evaluating gsm8k :  39%|████████████████████████████████▏                                                 | 49/125 [17:11<28:10, 22.24s/it]Evaluating gsm8k :  40%|████████████████████████████████▊                                                 | 50/125 [17:28<25:54, 20.73s/it]Evaluating gsm8k :  41%|█████████████████████████████████▍                                                | 51/125 [17:37<21:22, 17.33s/it]Evaluating gsm8k :  42%|██████████████████████████████████                                                | 52/125 [18:02<23:42, 19.48s/it]Evaluating gsm8k :  42%|██████████████████████████████████▊                                               | 53/125 [18:16<21:27, 17.89s/it]Evaluating gsm8k :  43%|███████████████████████████████████▍                                              | 54/125 [18:41<23:35, 19.94s/it]Evaluating gsm8k :  44%|████████████████████████████████████                                              | 55/125 [18:50<19:27, 16.68s/it]Evaluating gsm8k :  45%|████████████████████████████████████▋                                             | 56/125 [19:14<21:48, 18.97s/it]Evaluating gsm8k :  46%|█████████████████████████████████████▍                                            | 57/125 [19:39<23:28, 20.71s/it]Evaluating gsm8k :  46%|██████████████████████████████████████                                            | 58/125 [19:57<22:13, 19.90s/it]Evaluating gsm8k :  47%|██████████████████████████████████████▋                                           | 59/125 [20:21<23:20, 21.23s/it]Evaluating gsm8k :  48%|███████████████████████████████████████▎                                          | 60/125 [20:33<19:54, 18.38s/it]Evaluating gsm8k :  49%|████████████████████████████████████████                                          | 61/125 [20:58<21:35, 20.24s/it]Evaluating gsm8k :  50%|████████████████████████████████████████▋                                         | 62/125 [21:22<22:30, 21.43s/it]Evaluating gsm8k :  50%|█████████████████████████████████████████▎                                        | 63/125 [21:42<21:50, 21.14s/it]Evaluating gsm8k :  51%|█████████████████████████████████████████▉                                        | 64/125 [22:06<22:26, 22.08s/it]Evaluating gsm8k :  52%|██████████████████████████████████████████▋                                       | 65/125 [22:31<22:51, 22.85s/it]Evaluating gsm8k :  53%|███████████████████████████████████████████▎                                      | 66/125 [22:56<22:59, 23.37s/it]Evaluating gsm8k :  54%|███████████████████████████████████████████▉                                      | 67/125 [23:20<22:51, 23.65s/it]Evaluating gsm8k :  54%|████████████████████████████████████████████▌                                     | 68/125 [23:44<22:38, 23.84s/it]Evaluating gsm8k :  55%|█████████████████████████████████████████████▎                                    | 69/125 [24:09<22:29, 24.09s/it]Evaluating gsm8k :  56%|█████████████████████████████████████████████▉                                    | 70/125 [24:33<22:07, 24.14s/it]Evaluating gsm8k :  57%|██████████████████████████████████████████████▌                                   | 71/125 [24:56<21:29, 23.87s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▏                                  | 72/125 [25:21<21:09, 23.96s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▉                                  | 73/125 [25:34<18:07, 20.92s/it]Evaluating gsm8k :  59%|████████████████████████████████████████████████▌                                 | 74/125 [25:59<18:40, 21.96s/it]Evaluating gsm8k :  60%|█████████████████████████████████████████████████▏                                | 75/125 [26:23<18:57, 22.75s/it]Evaluating gsm8k :  61%|█████████████████████████████████████████████████▊                                | 76/125 [26:37<16:16, 19.93s/it]Evaluating gsm8k :  62%|██████████████████████████████████████████████████▌                               | 77/125 [27:01<16:58, 21.22s/it]Evaluating gsm8k :  62%|███████████████████████████████████████████████████▏                              | 78/125 [27:18<15:33, 19.87s/it]Evaluating gsm8k :  63%|███████████████████████████████████████████████████▊                              | 79/125 [27:42<16:13, 21.17s/it]Evaluating gsm8k :  64%|████████████████████████████████████████████████████▍                             | 80/125 [28:00<15:08, 20.18s/it]Evaluating gsm8k :  65%|█████████████████████████████████████████████████████▏                            | 81/125 [28:15<13:46, 18.78s/it]Evaluating gsm8k :  66%|█████████████████████████████████████████████████████▊                            | 82/125 [28:40<14:45, 20.60s/it]Evaluating gsm8k :  66%|██████████████████████████████████████████████████████▍                           | 83/125 [29:00<14:21, 20.50s/it]Evaluating gsm8k :  67%|███████████████████████████████████████████████████████                           | 84/125 [29:25<14:46, 21.61s/it]Evaluating gsm8k :  68%|███████████████████████████████████████████████████████▊                          | 85/125 [29:46<14:18, 21.46s/it]Evaluating gsm8k :  69%|████████████████████████████████████████████████████████▍                         | 86/125 [30:10<14:30, 22.31s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████                         | 87/125 [30:21<12:02, 19.00s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████▋                        | 88/125 [30:38<11:20, 18.38s/it]Evaluating gsm8k :  71%|██████████████████████████████████████████████████████████▍                       | 89/125 [31:03<12:05, 20.17s/it]Evaluating gsm8k :  72%|███████████████████████████████████████████████████████████                       | 90/125 [31:27<12:31, 21.47s/it]Evaluating gsm8k :  73%|███████████████████████████████████████████████████████████▋                      | 91/125 [31:38<10:18, 18.18s/it]Evaluating gsm8k :  74%|████████████████████████████████████████████████████████████▎                     | 92/125 [32:02<11:00, 20.01s/it]Evaluating gsm8k :  74%|█████████████████████████████████████████████████████████████                     | 93/125 [32:13<09:17, 17.42s/it]Evaluating gsm8k :  75%|█████████████████████████████████████████████████████████████▋                    | 94/125 [32:37<10:03, 19.45s/it]Evaluating gsm8k :  76%|██████████████████████████████████████████████████████████████▎                   | 95/125 [33:02<10:28, 20.94s/it]Evaluating gsm8k :  77%|██████████████████████████████████████████████████████████████▉                   | 96/125 [33:16<09:11, 19.00s/it]Evaluating gsm8k :  78%|███████████████████████████████████████████████████████████████▋                  | 97/125 [33:41<09:38, 20.67s/it]Evaluating gsm8k :  78%|████████████████████████████████████████████████████████████████▎                 | 98/125 [33:57<08:39, 19.25s/it]Evaluating gsm8k :  79%|████████████████████████████████████████████████████████████████▉                 | 99/125 [34:21<08:58, 20.73s/it]Evaluating gsm8k :  80%|████████████████████████████████████████████████████████████████▊                | 100/125 [34:38<08:06, 19.47s/it]Evaluating gsm8k :  81%|█████████████████████████████████████████████████████████████████▍               | 101/125 [34:47<06:37, 16.54s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████               | 102/125 [35:11<07:13, 18.83s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████▋              | 103/125 [35:36<07:31, 20.53s/it]Evaluating gsm8k :  83%|███████████████████████████████████████████████████████████████████▍             | 104/125 [36:01<07:37, 21.78s/it]Evaluating gsm8k :  84%|████████████████████████████████████████████████████████████████████             | 105/125 [36:25<07:30, 22.54s/it]Evaluating gsm8k :  85%|████████████████████████████████████████████████████████████████████▋            | 106/125 [36:49<07:18, 23.06s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▎           | 107/125 [37:14<07:04, 23.57s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▉           | 108/125 [37:39<06:46, 23.89s/it]Evaluating gsm8k :  87%|██████████████████████████████████████████████████████████████████████▋          | 109/125 [37:49<05:16, 19.76s/it]Evaluating gsm8k :  88%|███████████████████████████████████████████████████████████████████████▎         | 110/125 [38:00<04:17, 17.18s/it]Evaluating gsm8k :  89%|███████████████████████████████████████████████████████████████████████▉         | 111/125 [38:25<04:31, 19.42s/it]Evaluating gsm8k :  90%|████████████████████████████████████████████████████████████████████████▌        | 112/125 [38:49<04:31, 20.91s/it]Evaluating gsm8k :  90%|█████████████████████████████████████████████████████████████████████████▏       | 113/125 [39:13<04:22, 21.85s/it]Evaluating gsm8k :  91%|█████████████████████████████████████████████████████████████████████████▊       | 114/125 [39:37<04:09, 22.65s/it]Evaluating gsm8k :  92%|██████████████████████████████████████████████████████████████████████████▌      | 115/125 [40:02<03:51, 23.18s/it]Evaluating gsm8k :  93%|███████████████████████████████████████████████████████████████████████████▏     | 116/125 [40:26<03:31, 23.52s/it]Evaluating gsm8k :  94%|███████████████████████████████████████████████████████████████████████████▊     | 117/125 [40:51<03:10, 23.83s/it]Evaluating gsm8k :  94%|████████████████████████████████████████████████████████████████████████████▍    | 118/125 [41:12<02:41, 23.13s/it]Evaluating gsm8k :  95%|█████████████████████████████████████████████████████████████████████████████    | 119/125 [41:18<01:47, 17.93s/it]Evaluating gsm8k :  96%|█████████████████████████████████████████████████████████████████████████████▊   | 120/125 [41:42<01:39, 19.86s/it]Evaluating gsm8k :  97%|██████████████████████████████████████████████████████████████████████████████▍  | 121/125 [42:05<01:22, 20.65s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████  | 122/125 [42:28<01:03, 21.27s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████▋ | 123/125 [42:52<00:44, 22.27s/it]Evaluating gsm8k :  99%|████████████████████████████████████████████████████████████████████████████████▎| 124/125 [43:17<00:22, 22.88s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [43:41<00:00, 23.29s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [43:41<00:00, 20.97s/it]
name: gsm8k | {'exact_match': 0.0, 'rougeL': 0.1931} | lm_loss 11.4885 | avg. gen lenth: 348.636
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name gsm8k --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name commonsenseqa --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 2 --data-dir /scratch/ylu130/processed_data/gsm8k/out-domain/o4-tcommonsenseqa-s1-rTrue --seed 1 --max-prompt-length 2048 --rationales --num-out-domain 4
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-17 19:57:56,009] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... gsm8k
  data_dir ..................... /scratch/ylu130/processed_data/gsm8k/out-domain/o4-tcommonsenseqa-s1-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 4
  out_domain_data_name ......... commonsenseqa
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o4-tcommonsenseqa-s1-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 2
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                                             | 0/7473 [00:00<?, ?it/s]  0%|▎                                                                                                  | 22/7473 [00:00<00:34, 213.11it/s]  1%|▌                                                                                                  | 44/7473 [00:00<00:34, 212.91it/s]  1%|▊                                                                                                  | 66/7473 [00:00<00:34, 213.37it/s]  1%|█▏                                                                                                 | 88/7473 [00:00<00:34, 213.98it/s]  1%|█▍                                                                                                | 110/7473 [00:00<00:34, 213.99it/s]  2%|█▋                                                                                                | 132/7473 [00:00<00:34, 213.90it/s]  2%|██                                                                                                | 154/7473 [00:00<00:34, 214.42it/s]  2%|██▎                                                                                               | 176/7473 [00:00<00:34, 211.49it/s]  3%|██▌                                                                                               | 198/7473 [00:00<00:34, 212.61it/s]  3%|██▉                                                                                               | 220/7473 [00:01<00:33, 213.36it/s]  3%|███▏                                                                                              | 242/7473 [00:01<00:33, 213.20it/s]  4%|███▍                                                                                              | 264/7473 [00:01<00:34, 212.02it/s]  4%|███▊                                                                                              | 286/7473 [00:01<00:33, 212.80it/s]  4%|████                                                                                              | 308/7473 [00:01<00:33, 213.18it/s]  4%|████▎                                                                                             | 330/7473 [00:01<00:33, 214.00it/s]  5%|████▌                                                                                             | 352/7473 [00:01<00:33, 213.80it/s]  5%|████▉                                                                                             | 374/7473 [00:01<00:33, 213.36it/s]  5%|█████▏                                                                                            | 396/7473 [00:01<00:33, 211.73it/s]  6%|█████▍                                                                                            | 418/7473 [00:01<00:33, 211.93it/s]  6%|█████▊                                                                                            | 440/7473 [00:02<00:33, 212.37it/s]  6%|██████                                                                                            | 467/7473 [00:02<00:30, 228.33it/s]  7%|██████▌                                                                                           | 499/7473 [00:02<00:27, 254.27it/s]  7%|██████▉                                                                                           | 532/7473 [00:02<00:25, 276.06it/s]  8%|███████▍                                                                                          | 565/7473 [00:02<00:23, 291.27it/s]  8%|███████▊                                                                                          | 598/7473 [00:02<00:22, 301.03it/s]  8%|████████▎                                                                                         | 631/7473 [00:02<00:22, 308.05it/s]  9%|████████▋                                                                                         | 664/7473 [00:02<00:21, 313.40it/s]  9%|█████████▏                                                                                        | 697/7473 [00:02<00:21, 317.70it/s] 10%|█████████▌                                                                                        | 730/7473 [00:02<00:21, 319.12it/s] 10%|██████████                                                                                        | 763/7473 [00:03<00:20, 321.44it/s] 11%|██████████▍                                                                                       | 796/7473 [00:03<00:20, 322.76it/s] 11%|██████████▊                                                                                       | 829/7473 [00:03<00:20, 323.50it/s] 12%|███████████▎                                                                                      | 862/7473 [00:03<00:20, 324.32it/s] 12%|███████████▋                                                                                      | 895/7473 [00:03<00:20, 324.71it/s] 12%|████████████▏                                                                                     | 928/7473 [00:03<00:20, 324.69it/s] 13%|████████████▌                                                                                     | 961/7473 [00:03<00:20, 323.84it/s] 13%|█████████████                                                                                     | 994/7473 [00:03<00:19, 324.57it/s] 14%|█████████████▎                                                                                   | 1027/7473 [00:03<00:19, 324.61it/s] 14%|█████████████▊                                                                                   | 1060/7473 [00:03<00:19, 324.93it/s] 15%|██████████████▏                                                                                  | 1093/7473 [00:04<00:19, 325.46it/s] 15%|██████████████▌                                                                                  | 1126/7473 [00:04<00:19, 325.01it/s] 16%|███████████████                                                                                  | 1159/7473 [00:04<00:19, 323.27it/s] 16%|███████████████▍                                                                                 | 1192/7473 [00:04<00:19, 323.71it/s] 16%|███████████████▉                                                                                 | 1225/7473 [00:04<00:19, 324.06it/s] 17%|████████████████▎                                                                                | 1258/7473 [00:04<00:19, 324.13it/s] 17%|████████████████▊                                                                                | 1291/7473 [00:04<00:19, 324.46it/s] 18%|█████████████████▏                                                                               | 1324/7473 [00:04<00:18, 324.68it/s] 18%|█████████████████▌                                                                               | 1357/7473 [00:04<00:18, 325.00it/s] 19%|██████████████████                                                                               | 1390/7473 [00:05<00:18, 322.29it/s] 19%|██████████████████▍                                                                              | 1423/7473 [00:05<00:18, 322.96it/s] 19%|██████████████████▉                                                                              | 1456/7473 [00:05<00:18, 323.25it/s] 20%|███████████████████▎                                                                             | 1489/7473 [00:05<00:18, 323.46it/s] 20%|███████████████████▊                                                                             | 1522/7473 [00:05<00:18, 324.26it/s] 21%|████████████████████▏                                                                            | 1555/7473 [00:05<00:18, 323.53it/s] 21%|████████████████████▌                                                                            | 1588/7473 [00:05<00:18, 322.91it/s] 22%|█████████████████████                                                                            | 1621/7473 [00:05<00:18, 320.19it/s] 22%|█████████████████████▍                                                                           | 1654/7473 [00:05<00:18, 321.50it/s] 23%|█████████████████████▉                                                                           | 1687/7473 [00:05<00:17, 322.80it/s] 23%|██████████████████████▎                                                                          | 1720/7473 [00:06<00:17, 322.92it/s] 23%|██████████████████████▊                                                                          | 1753/7473 [00:06<00:17, 323.00it/s] 24%|███████████████████████▏                                                                         | 1786/7473 [00:06<00:17, 322.81it/s] 24%|███████████████████████▌                                                                         | 1819/7473 [00:06<00:17, 322.87it/s] 25%|████████████████████████                                                                         | 1852/7473 [00:06<00:17, 320.30it/s] 25%|████████████████████████▍                                                                        | 1885/7473 [00:06<00:17, 321.01it/s] 26%|████████████████████████▉                                                                        | 1918/7473 [00:06<00:17, 320.54it/s] 26%|█████████████████████████▎                                                                       | 1951/7473 [00:06<00:17, 320.78it/s] 27%|█████████████████████████▊                                                                       | 1984/7473 [00:06<00:17, 321.31it/s] 27%|██████████████████████████▏                                                                      | 2017/7473 [00:06<00:16, 321.66it/s] 27%|██████████████████████████▌                                                                      | 2050/7473 [00:07<00:16, 319.39it/s] 28%|███████████████████████████                                                                      | 2082/7473 [00:07<00:16, 318.75it/s] 28%|███████████████████████████▍                                                                     | 2115/7473 [00:07<00:16, 319.98it/s] 29%|███████████████████████████▉                                                                     | 2148/7473 [00:07<00:16, 320.42it/s] 29%|████████████████████████████▎                                                                    | 2181/7473 [00:07<00:16, 321.05it/s] 30%|████████████████████████████▋                                                                    | 2214/7473 [00:07<00:16, 321.82it/s] 30%|█████████████████████████████▏                                                                   | 2247/7473 [00:07<00:16, 321.94it/s] 31%|█████████████████████████████▌                                                                   | 2280/7473 [00:07<00:16, 321.64it/s] 31%|██████████████████████████████                                                                   | 2313/7473 [00:07<00:16, 320.48it/s] 31%|██████████████████████████████▍                                                                  | 2346/7473 [00:07<00:15, 321.05it/s] 32%|██████████████████████████████▉                                                                  | 2379/7473 [00:08<00:15, 321.85it/s] 32%|███████████████████████████████▎                                                                 | 2412/7473 [00:08<00:15, 322.45it/s] 33%|███████████████████████████████▋                                                                 | 2445/7473 [00:08<00:15, 320.63it/s] 33%|████████████████████████████████▏                                                                | 2478/7473 [00:08<00:15, 321.01it/s] 34%|████████████████████████████████▌                                                                | 2511/7473 [00:08<00:15, 321.60it/s] 34%|█████████████████████████████████                                                                | 2544/7473 [00:08<00:16, 295.77it/s] 34%|█████████████████████████████████▍                                                               | 2577/7473 [00:08<00:16, 303.90it/s] 35%|█████████████████████████████████▉                                                               | 2610/7473 [00:08<00:15, 309.68it/s] 35%|██████████████████████████████████▎                                                              | 2643/7473 [00:08<00:15, 314.09it/s] 36%|██████████████████████████████████▋                                                              | 2676/7473 [00:09<00:15, 317.42it/s] 36%|███████████████████████████████████▏                                                             | 2709/7473 [00:09<00:14, 319.60it/s] 37%|███████████████████████████████████▌                                                             | 2742/7473 [00:09<00:14, 320.80it/s] 37%|████████████████████████████████████                                                             | 2775/7473 [00:09<00:14, 320.19it/s] 38%|████████████████████████████████████▍                                                            | 2808/7473 [00:09<00:14, 321.47it/s] 38%|████████████████████████████████████▉                                                            | 2841/7473 [00:09<00:14, 322.48it/s] 38%|█████████████████████████████████████▎                                                           | 2874/7473 [00:09<00:14, 319.67it/s] 39%|█████████████████████████████████████▋                                                           | 2907/7473 [00:09<00:14, 320.95it/s] 39%|██████████████████████████████████████▏                                                          | 2940/7473 [00:09<00:14, 322.52it/s] 40%|██████████████████████████████████████▌                                                          | 2973/7473 [00:09<00:13, 322.48it/s] 40%|███████████████████████████████████████                                                          | 3006/7473 [00:10<00:13, 320.18it/s] 41%|███████████████████████████████████████▍                                                         | 3039/7473 [00:10<00:13, 320.99it/s] 41%|███████████████████████████████████████▊                                                         | 3072/7473 [00:10<00:13, 321.46it/s] 42%|████████████████████████████████████████▎                                                        | 3105/7473 [00:10<00:13, 322.00it/s] 42%|████████████████████████████████████████▋                                                        | 3138/7473 [00:10<00:13, 321.30it/s] 42%|█████████████████████████████████████████▏                                                       | 3171/7473 [00:10<00:13, 321.48it/s] 43%|█████████████████████████████████████████▌                                                       | 3204/7473 [00:10<00:13, 319.87it/s] 43%|██████████████████████████████████████████                                                       | 3237/7473 [00:10<00:13, 320.73it/s] 44%|██████████████████████████████████████████▍                                                      | 3270/7473 [00:10<00:13, 321.68it/s] 44%|██████████████████████████████████████████▊                                                      | 3303/7473 [00:10<00:12, 322.47it/s] 45%|███████████████████████████████████████████▎                                                     | 3336/7473 [00:11<00:12, 321.49it/s] 45%|███████████████████████████████████████████▋                                                     | 3369/7473 [00:11<00:12, 321.80it/s] 46%|████████████████████████████████████████████▏                                                    | 3402/7473 [00:11<00:12, 321.88it/s] 46%|████████████████████████████████████████████▌                                                    | 3435/7473 [00:11<00:12, 320.07it/s] 46%|█████████████████████████████████████████████                                                    | 3468/7473 [00:11<00:12, 320.54it/s] 47%|█████████████████████████████████████████████▍                                                   | 3501/7473 [00:11<00:12, 321.73it/s] 47%|█████████████████████████████████████████████▊                                                   | 3534/7473 [00:11<00:12, 321.97it/s] 48%|██████████████████████████████████████████████▎                                                  | 3567/7473 [00:11<00:12, 322.49it/s] 48%|██████████████████████████████████████████████▋                                                  | 3600/7473 [00:11<00:11, 322.77it/s] 49%|███████████████████████████████████████████████▏                                                 | 3633/7473 [00:12<00:11, 322.38it/s] 49%|███████████████████████████████████████████████▌                                                 | 3666/7473 [00:12<00:11, 319.87it/s] 49%|████████████████████████████████████████████████                                                 | 3698/7473 [00:12<00:11, 319.28it/s] 50%|████████████████████████████████████████████████▍                                                | 3731/7473 [00:12<00:11, 320.03it/s] 50%|████████████████████████████████████████████████▊                                                | 3764/7473 [00:12<00:11, 320.55it/s] 51%|█████████████████████████████████████████████████▎                                               | 3797/7473 [00:12<00:11, 321.36it/s] 51%|█████████████████████████████████████████████████▋                                               | 3830/7473 [00:12<00:11, 322.13it/s] 52%|██████████████████████████████████████████████████▏                                              | 3863/7473 [00:12<00:11, 322.16it/s] 52%|██████████████████████████████████████████████████▌                                              | 3896/7473 [00:12<00:11, 320.14it/s] 53%|██████████████████████████████████████████████████▉                                              | 3929/7473 [00:12<00:11, 320.16it/s] 53%|███████████████████████████████████████████████████▍                                             | 3962/7473 [00:13<00:11, 318.18it/s] 53%|███████████████████████████████████████████████████▊                                             | 3995/7473 [00:13<00:10, 318.89it/s] 54%|████████████████████████████████████████████████████▎                                            | 4028/7473 [00:13<00:10, 320.36it/s] 54%|████████████████████████████████████████████████████▋                                            | 4061/7473 [00:13<00:10, 321.48it/s] 55%|█████████████████████████████████████████████████████▏                                           | 4094/7473 [00:13<00:10, 322.09it/s] 55%|█████████████████████████████████████████████████████▌                                           | 4127/7473 [00:13<00:10, 319.31it/s] 56%|█████████████████████████████████████████████████████▉                                           | 4160/7473 [00:13<00:10, 320.29it/s] 56%|██████████████████████████████████████████████████████▍                                          | 4193/7473 [00:13<00:10, 321.16it/s] 57%|██████████████████████████████████████████████████████▊                                          | 4226/7473 [00:13<00:10, 321.31it/s] 57%|███████████████████████████████████████████████████████▎                                         | 4259/7473 [00:13<00:10, 321.07it/s] 57%|███████████████████████████████████████████████████████▋                                         | 4292/7473 [00:14<00:09, 320.88it/s] 58%|████████████████████████████████████████████████████████▏                                        | 4325/7473 [00:14<00:09, 321.64it/s] 58%|████████████████████████████████████████████████████████▌                                        | 4358/7473 [00:14<00:09, 320.76it/s] 59%|████████████████████████████████████████████████████████▉                                        | 4391/7473 [00:14<00:09, 321.12it/s] 59%|█████████████████████████████████████████████████████████▍                                       | 4424/7473 [00:14<00:09, 321.20it/s] 60%|█████████████████████████████████████████████████████████▊                                       | 4457/7473 [00:14<00:09, 320.05it/s] 60%|██████████████████████████████████████████████████████████▎                                      | 4490/7473 [00:14<00:09, 319.59it/s] 61%|██████████████████████████████████████████████████████████▋                                      | 4522/7473 [00:14<00:09, 319.07it/s] 61%|███████████████████████████████████████████████████████████                                      | 4555/7473 [00:14<00:09, 319.99it/s] 61%|███████████████████████████████████████████████████████████▌                                     | 4587/7473 [00:14<00:09, 318.31it/s] 62%|███████████████████████████████████████████████████████████▉                                     | 4619/7473 [00:15<00:08, 318.00it/s] 62%|████████████████████████████████████████████████████████████▎                                    | 4651/7473 [00:15<00:08, 318.04it/s] 63%|████████████████████████████████████████████████████████████▊                                    | 4683/7473 [00:15<00:08, 318.15it/s] 63%|█████████████████████████████████████████████████████████████▏                                   | 4715/7473 [00:15<00:08, 318.24it/s] 64%|█████████████████████████████████████████████████████████████▌                                   | 4747/7473 [00:15<00:08, 318.39it/s] 64%|██████████████████████████████████████████████████████████████                                   | 4779/7473 [00:15<00:08, 318.35it/s] 64%|██████████████████████████████████████████████████████████████▍                                  | 4811/7473 [00:15<00:08, 316.85it/s] 65%|██████████████████████████████████████████████████████████████▉                                  | 4844/7473 [00:15<00:08, 317.91it/s] 65%|███████████████████████████████████████████████████████████████▎                                 | 4877/7473 [00:15<00:08, 318.57it/s] 66%|███████████████████████████████████████████████████████████████▋                                 | 4910/7473 [00:16<00:08, 320.09it/s] 66%|████████████████████████████████████████████████████████████████▏                                | 4943/7473 [00:16<00:07, 320.55it/s] 67%|████████████████████████████████████████████████████████████████▌                                | 4976/7473 [00:16<00:07, 321.13it/s] 67%|█████████████████████████████████████████████████████████████████                                | 5009/7473 [00:16<00:07, 321.97it/s] 67%|█████████████████████████████████████████████████████████████████▍                               | 5042/7473 [00:16<00:07, 320.43it/s] 68%|█████████████████████████████████████████████████████████████████▊                               | 5075/7473 [00:16<00:07, 321.12it/s] 68%|██████████████████████████████████████████████████████████████████▎                              | 5108/7473 [00:16<00:07, 321.64it/s] 69%|██████████████████████████████████████████████████████████████████▋                              | 5141/7473 [00:16<00:07, 322.24it/s] 69%|███████████████████████████████████████████████████████████████████▏                             | 5174/7473 [00:16<00:07, 322.51it/s] 70%|███████████████████████████████████████████████████████████████████▌                             | 5207/7473 [00:16<00:07, 322.50it/s] 70%|████████████████████████████████████████████████████████████████████                             | 5240/7473 [00:17<00:06, 322.69it/s] 71%|████████████████████████████████████████████████████████████████████▍                            | 5273/7473 [00:17<00:07, 300.11it/s] 71%|████████████████████████████████████████████████████████████████████▊                            | 5306/7473 [00:17<00:07, 306.59it/s] 71%|█████████████████████████████████████████████████████████████████████▎                           | 5338/7473 [00:17<00:06, 310.37it/s] 72%|█████████████████████████████████████████████████████████████████████▋                           | 5371/7473 [00:17<00:06, 313.92it/s] 72%|██████████████████████████████████████████████████████████████████████▏                          | 5404/7473 [00:17<00:06, 316.59it/s] 73%|██████████████████████████████████████████████████████████████████████▌                          | 5437/7473 [00:17<00:06, 318.94it/s] 73%|███████████████████████████████████████████████████████████████████████                          | 5470/7473 [00:17<00:08, 236.15it/s] 74%|███████████████████████████████████████████████████████████████████████▍                         | 5502/7473 [00:17<00:07, 255.08it/s] 74%|███████████████████████████████████████████████████████████████████████▊                         | 5535/7473 [00:18<00:07, 272.14it/s] 75%|████████████████████████████████████████████████████████████████████████▎                        | 5568/7473 [00:18<00:06, 285.28it/s] 75%|████████████████████████████████████████████████████████████████████████▋                        | 5600/7473 [00:18<00:06, 294.60it/s] 75%|█████████████████████████████████████████████████████████████████████████                        | 5633/7473 [00:18<00:06, 302.35it/s] 76%|█████████████████████████████████████████████████████████████████████████▌                       | 5666/7473 [00:18<00:05, 308.22it/s] 76%|█████████████████████████████████████████████████████████████████████████▉                       | 5698/7473 [00:18<00:05, 310.05it/s] 77%|██████████████████████████████████████████████████████████████████████████▍                      | 5730/7473 [00:18<00:05, 312.81it/s] 77%|██████████████████████████████████████████████████████████████████████████▊                      | 5763/7473 [00:18<00:05, 315.57it/s] 78%|███████████████████████████████████████████████████████████████████████████▏                     | 5796/7473 [00:18<00:05, 317.11it/s] 78%|███████████████████████████████████████████████████████████████████████████▋                     | 5828/7473 [00:19<00:05, 316.55it/s] 78%|████████████████████████████████████████████████████████████████████████████                     | 5861/7473 [00:19<00:05, 317.77it/s] 79%|████████████████████████████████████████████████████████████████████████████▌                    | 5894/7473 [00:19<00:04, 318.56it/s] 79%|████████████████████████████████████████████████████████████████████████████▉                    | 5926/7473 [00:19<00:04, 317.21it/s] 80%|█████████████████████████████████████████████████████████████████████████████▎                   | 5958/7473 [00:19<00:04, 317.49it/s] 80%|█████████████████████████████████████████████████████████████████████████████▊                   | 5990/7473 [00:19<00:04, 318.14it/s] 81%|██████████████████████████████████████████████████████████████████████████████▏                  | 6023/7473 [00:19<00:04, 318.74it/s] 81%|██████████████████████████████████████████████████████████████████████████████▌                  | 6056/7473 [00:19<00:04, 319.88it/s] 81%|███████████████████████████████████████████████████████████████████████████████                  | 6089/7473 [00:19<00:04, 320.81it/s] 82%|███████████████████████████████████████████████████████████████████████████████▍                 | 6122/7473 [00:19<00:04, 321.37it/s] 82%|███████████████████████████████████████████████████████████████████████████████▉                 | 6155/7473 [00:20<00:04, 319.99it/s] 83%|████████████████████████████████████████████████████████████████████████████████▎                | 6188/7473 [00:20<00:04, 320.74it/s] 83%|████████████████████████████████████████████████████████████████████████████████▋                | 6221/7473 [00:20<00:03, 321.38it/s] 84%|█████████████████████████████████████████████████████████████████████████████████▏               | 6254/7473 [00:20<00:03, 321.57it/s] 84%|█████████████████████████████████████████████████████████████████████████████████▌               | 6287/7473 [00:20<00:03, 321.64it/s] 85%|██████████████████████████████████████████████████████████████████████████████████               | 6320/7473 [00:20<00:03, 322.37it/s] 85%|██████████████████████████████████████████████████████████████████████████████████▍              | 6353/7473 [00:20<00:03, 322.27it/s] 85%|██████████████████████████████████████████████████████████████████████████████████▉              | 6386/7473 [00:20<00:03, 317.36it/s] 86%|███████████████████████████████████████████████████████████████████████████████████▎             | 6419/7473 [00:20<00:03, 318.50it/s] 86%|███████████████████████████████████████████████████████████████████████████████████▋             | 6452/7473 [00:20<00:03, 319.26it/s] 87%|████████████████████████████████████████████████████████████████████████████████████▏            | 6485/7473 [00:21<00:03, 320.04it/s] 87%|████████████████████████████████████████████████████████████████████████████████████▌            | 6518/7473 [00:21<00:02, 319.89it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████            | 6551/7473 [00:21<00:02, 320.56it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████▍           | 6584/7473 [00:21<00:02, 318.90it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████▉           | 6617/7473 [00:21<00:02, 319.61it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████▎          | 6649/7473 [00:21<00:02, 319.59it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████▋          | 6681/7473 [00:21<00:02, 319.27it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████▏         | 6714/7473 [00:21<00:02, 319.75it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████▌         | 6746/7473 [00:21<00:02, 319.74it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████▉         | 6778/7473 [00:21<00:02, 319.47it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████▍        | 6810/7473 [00:22<00:02, 318.28it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████▊        | 6842/7473 [00:22<00:01, 318.75it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████▏       | 6875/7473 [00:22<00:01, 319.51it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████▋       | 6908/7473 [00:22<00:01, 320.10it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████       | 6941/7473 [00:22<00:01, 317.98it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████▌      | 6973/7473 [00:22<00:01, 318.44it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████▉      | 7006/7473 [00:22<00:01, 319.03it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████▎     | 7038/7473 [00:22<00:01, 317.47it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████▊     | 7071/7473 [00:22<00:01, 318.32it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████▏    | 7104/7473 [00:23<00:01, 319.28it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████▋    | 7136/7473 [00:23<00:01, 318.66it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████    | 7168/7473 [00:23<00:00, 318.93it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████▍   | 7201/7473 [00:23<00:00, 319.48it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████▉   | 7234/7473 [00:23<00:00, 320.19it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████▎  | 7267/7473 [00:23<00:00, 318.77it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████▊  | 7300/7473 [00:23<00:00, 319.70it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████▏ | 7332/7473 [00:23<00:00, 319.61it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████▌ | 7364/7473 [00:23<00:00, 319.68it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████ | 7397/7473 [00:23<00:00, 320.01it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████▍| 7430/7473 [00:24<00:00, 320.17it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████▊| 7463/7473 [00:24<00:00, 317.19it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 7473/7473 [00:24<00:00, 309.31it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:04<00:09,  4.94s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.20s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.41s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.39s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:09<00:04,  4.95s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.18s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.45s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.44s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.34s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.51s/it]
[2023-08-17 19:59:11,216] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.64s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.79s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.83s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.99s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.78s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.96s/it]
[2023-08-17 19:59:21,462] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-17 19:59:21,463] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-17 19:59:21,464] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-17 19:59:21,464] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-17 19:59:21,464] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-17 19:59:21,464] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-17 19:59:21,465] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-17 19:59:21,465] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-17 19:59:21,465] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-17 19:59:21,465] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-17 19:59:21,465] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-17 19:59:21,465] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f6559d5e370>
[2023-08-17 19:59:21,465] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-17 19:59:21,465] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-17 19:59:21,465] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-17 19:59:21,465] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-17 19:59:21,465] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-17 19:59:21,465] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-17 19:59:21,465] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-17 19:59:21,465] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-17 19:59:21,465] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-17 19:59:21,465] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-17 19:59:21,465] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-17 19:59:21,465] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-17 19:59:21,465] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-17 19:59:21,465] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-17 19:59:21,465] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-17 19:59:21,465] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-17 19:59:21,465] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-17 19:59:21,466] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-17 19:59:21,466] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-17 19:59:21,466] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-17 19:59:21,466] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-17 19:59:21,466] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-17 19:59:21,466] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-17 19:59:21,466] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-17 19:59:21,466] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-17 19:59:21,466] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-17 19:59:21,466] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-17 19:59:21,466] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-17 19:59:21,466] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-17 19:59:21,466] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-17 19:59:21,466] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-17 19:59:21,466] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-17 19:59:21,466] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f6559d5e190>
[2023-08-17 19:59:21,466] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-17 19:59:21,466] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-17 19:59:21,466] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-17 19:59:21,466] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-17 19:59:21,466] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-17 19:59:21,466] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-17 19:59:21,466] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-17 19:59:21,466] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-17 19:59:21,466] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-17 19:59:21,466] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-17 19:59:21,466] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-17 19:59:21,467] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-17 19:59:21,467] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-17 19:59:21,467] [INFO] [config.py:1012:print]   train_batch_size ............. 8
[2023-08-17 19:59:21,467] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  2
[2023-08-17 19:59:21,467] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-17 19:59:21,467] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-17 19:59:21,467] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-17 19:59:21,467] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-17 19:59:21,467] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-17 19:59:21,467] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-17 19:59:21,467] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-17 19:59:21,467] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.5177512168884277 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Loading extension module utils...
Evaluating gsm8k :   0%|                                                                                           | 0/125 [00:00<?, ?it/s]############### Example ###############
Time to load utils op: 0.5049088001251221 seconds
### Instruction:Answer the following grade math question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: 1. The question asks for a place that contains plumbing but wouldn't be useful to someone who is thirsty. This implies that the plumbing does not carry potable or drinking water.
2. Let's consider each of the options. One by one we will evaluate them.
3. Option A is oil refineries. Oil refineries are large industrial complexes where crude oil is processed and refined into usable products, primarily fuel oils. The plumbing in oil refineries would be primarily used to transport oil and its derivatives, not water. Thus, it won’t be of any use if you are thirsty.
4. Option B is the wall. While walls in a home or any building often contain pipes that are part of the structure's plumbing system, these pipes typically transport clean, potable water for use in the building. This means it can be useful when you are thirsty.
5. Option C: Show does not fit into the context of the question as there is no reason given to connect a'show' to the concept of plumbing.
6. Option D: Your own home, will definitely have plumbing that is useful for drinking needs such as kitchen taps, bathroom taps etc. This is especially true if you are already thirsty.
7. Option E: A water fountain clearly serves drinking water, and can be a direct source of water. Therefore, this is not the answer to the question.
8. Therefore, among the given choices, the plumbing in oil refineries would be the least useful to someone who is thirsty because it doesn't transport potable water. Hence, the answer is A: oil refineries.
So the final answer is A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Output: 1. The question is asking what activity a person is not engaged in when they are just starting to work.
2. When a person is beginning work, they start undertaking tasks so option A: "working" cannot be the correct answer because they start working.
3. Option B: "resting" would not be necessarily correct since the person might not have been resting prior to begin working.
4. Though the person might feel some sort of tiredness when starting work, option C: "tiredness" is an emotion or physical state and not something one does, so it's not correct.
5. Option E: "momentum" refers to the force that an object or person has when moving, which can apply once a person begins working, so it is not correct.
6. Therefore, by elimination, option D: "accomplishing" is the correct answer. When a person is just beginning work, a period of time is required before accomplishments can be made. They aren't achieving or accomplishing anything yet because they have just started their tasks.
So the final answer is D: accomplishing

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Output: 1. The question is asking where you are most likely to find pens with a company logo. 
2. A company logo is usually used for promotional purposes and is often found on office supplies to increase brand recognition amongst employees and clients.
3. Therefore, such pens would not commonly be found on a pencil (B), since a pencil is not suitable for displaying company logos and pens cannot technically 'be on' a pencil.
4. Option C, "write sentences on paper", does not refer to a location but rather an action, so it cannot answer the question.
5. While pens might also be found at schools (D) or in a backpack (E), these locations are not commonly associated with company logo pens, as most schools or personal backpacks wouldn't typically stock pens bearing a company logo.
6. Hence, out of all given options, the most logical place you would find pens with a company logo would be in an office. Therefore, the answer is A: office.
So the final answer is A: office

Input: Billy called out to John, and listened for what? Choices:  A: silence B: response C: communication D: hanging up E: whisper
Output: 1. The question begins with Billy calling out to John. This act denotes that Billy was initiating a conversation or seeking attention from John.
2. The next part says "and listened for what?". This implies that Billy was expecting something to happen or come after his call out.
3. Considering the choices provided, we can eliminate some that do not make sense in this context. "Silence" would contradict the idea of Billy expecting something. "D: hanging up" would also be incorrect because the scenario does not involve a phone conversation.
4. Then we can consider "C: communication" and "E: whisper". While they might seem logical, they are not the most accurate. Communication is a broad term that encompasses any form of interaction and whisper is a specific way of responding that the context does not necessarily suggest.
5. The most fitting choice is thus "B: response". This term succinctly specifies what usually happens after someone initiates a conversation or calls out to another person - they expect a response.
So the final answer is B: response

Input:Natalia sold clips to 48 of her friends in April, and then she sold half as many clips in May. How many clips did Natalia sell altogether in April and May?
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o4-tcommonsenseqa-s1-rTrue
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.40453672409057617 seconds
Time to load utils op: 0.40435075759887695 seconds
Evaluating gsm8k :   1%|▋                                                                                  | 1/125 [00:22<46:01, 22.27s/it]Evaluating gsm8k :   2%|█▎                                                                                 | 2/125 [00:45<46:43, 22.80s/it]Evaluating gsm8k :   2%|█▉                                                                                 | 3/125 [01:08<47:03, 23.14s/it]Evaluating gsm8k :   3%|██▋                                                                                | 4/125 [01:28<43:41, 21.67s/it]Evaluating gsm8k :   4%|███▎                                                                               | 5/125 [01:51<44:38, 22.32s/it]Evaluating gsm8k :   5%|███▉                                                                               | 6/125 [02:15<45:04, 22.73s/it]Evaluating gsm8k :   6%|████▋                                                                              | 7/125 [02:38<45:03, 22.91s/it]Evaluating gsm8k :   6%|█████▎                                                                             | 8/125 [02:52<39:14, 20.13s/it]Evaluating gsm8k :   7%|█████▉                                                                             | 9/125 [03:09<36:58, 19.12s/it]Evaluating gsm8k :   8%|██████▌                                                                           | 10/125 [03:33<39:20, 20.53s/it]Evaluating gsm8k :   9%|███████▏                                                                          | 11/125 [03:56<40:42, 21.42s/it]Evaluating gsm8k :  10%|███████▊                                                                          | 12/125 [04:20<41:29, 22.03s/it]Evaluating gsm8k :  10%|████████▌                                                                         | 13/125 [04:43<42:03, 22.53s/it]Evaluating gsm8k :  11%|█████████▏                                                                        | 14/125 [05:06<41:29, 22.43s/it]Evaluating gsm8k :  12%|█████████▊                                                                        | 15/125 [05:29<41:33, 22.67s/it]Evaluating gsm8k :  13%|██████████▍                                                                       | 16/125 [05:47<38:36, 21.25s/it]Evaluating gsm8k :  14%|███████████▏                                                                      | 17/125 [05:56<31:29, 17.50s/it]Evaluating gsm8k :  14%|███████████▊                                                                      | 18/125 [06:19<34:28, 19.33s/it]Evaluating gsm8k :  15%|████████████▍                                                                     | 19/125 [06:27<28:03, 15.89s/it]Evaluating gsm8k :  16%|█████████████                                                                     | 20/125 [06:45<28:48, 16.46s/it]Evaluating gsm8k :  17%|█████████████▊                                                                    | 21/125 [07:08<32:10, 18.57s/it]Evaluating gsm8k :  18%|██████████████▍                                                                   | 22/125 [07:24<30:21, 17.69s/it]Evaluating gsm8k :  18%|███████████████                                                                   | 23/125 [07:48<33:09, 19.50s/it]Evaluating gsm8k :  19%|███████████████▋                                                                  | 24/125 [08:11<34:47, 20.66s/it]Evaluating gsm8k :  20%|████████████████▍                                                                 | 25/125 [08:35<35:54, 21.54s/it]Evaluating gsm8k :  21%|█████████████████                                                                 | 26/125 [08:58<36:36, 22.18s/it]Evaluating gsm8k :  22%|█████████████████▋                                                                | 27/125 [09:22<36:51, 22.57s/it]Evaluating gsm8k :  22%|██████████████████▎                                                               | 28/125 [09:45<36:46, 22.75s/it]Evaluating gsm8k :  23%|███████████████████                                                               | 29/125 [09:59<31:57, 19.98s/it]Evaluating gsm8k :  24%|███████████████████▋                                                              | 30/125 [10:09<27:04, 17.10s/it]Evaluating gsm8k :  25%|████████████████████▎                                                             | 31/125 [10:33<29:53, 19.08s/it]Evaluating gsm8k :  26%|████████████████████▉                                                             | 32/125 [10:45<26:30, 17.10s/it]Evaluating gsm8k :  26%|█████████████████████▋                                                            | 33/125 [10:50<20:40, 13.48s/it]Evaluating gsm8k :  27%|██████████████████████▎                                                           | 34/125 [11:02<19:54, 13.12s/it]Evaluating gsm8k :  28%|██████████████████████▉                                                           | 35/125 [11:26<24:20, 16.23s/it]Evaluating gsm8k :  29%|███████████████████████▌                                                          | 36/125 [11:40<22:59, 15.50s/it]Evaluating gsm8k :  30%|████████████████████████▎                                                         | 37/125 [11:53<21:56, 14.95s/it]Evaluating gsm8k :  30%|████████████████████████▉                                                         | 38/125 [12:17<25:23, 17.52s/it]Evaluating gsm8k :  31%|█████████████████████████▌                                                        | 39/125 [12:40<27:41, 19.32s/it]Evaluating gsm8k :  32%|██████████████████████████▏                                                       | 40/125 [13:04<29:14, 20.65s/it]Evaluating gsm8k :  33%|██████████████████████████▉                                                       | 41/125 [13:28<30:07, 21.52s/it]Evaluating gsm8k :  34%|███████████████████████████▌                                                      | 42/125 [13:51<30:39, 22.16s/it]Evaluating gsm8k :  34%|████████████████████████████▏                                                     | 43/125 [14:13<30:03, 21.99s/it]Evaluating gsm8k :  35%|████████████████████████████▊                                                     | 44/125 [14:22<24:30, 18.15s/it]Evaluating gsm8k :  36%|█████████████████████████████▌                                                    | 45/125 [14:46<26:20, 19.76s/it]Evaluating gsm8k :  37%|██████████████████████████████▏                                                   | 46/125 [14:53<21:04, 16.00s/it]Evaluating gsm8k :  38%|██████████████████████████████▊                                                   | 47/125 [15:16<23:38, 18.19s/it]Evaluating gsm8k :  38%|███████████████████████████████▍                                                  | 48/125 [15:40<25:26, 19.82s/it]Evaluating gsm8k :  39%|████████████████████████████████▏                                                 | 49/125 [16:03<26:33, 20.97s/it]Evaluating gsm8k :  40%|████████████████████████████████▊                                                 | 50/125 [16:27<27:08, 21.71s/it]Evaluating gsm8k :  41%|█████████████████████████████████▍                                                | 51/125 [16:50<27:25, 22.24s/it]Evaluating gsm8k :  42%|██████████████████████████████████                                                | 52/125 [17:03<23:23, 19.23s/it]Evaluating gsm8k :  42%|██████████████████████████████████▊                                               | 53/125 [17:13<19:55, 16.61s/it]Evaluating gsm8k :  43%|███████████████████████████████████▍                                              | 54/125 [17:37<22:04, 18.66s/it]Evaluating gsm8k :  44%|████████████████████████████████████                                              | 55/125 [18:01<23:37, 20.25s/it]Evaluating gsm8k :  45%|████████████████████████████████████▋                                             | 56/125 [18:24<24:30, 21.32s/it]Evaluating gsm8k :  46%|█████████████████████████████████████▍                                            | 57/125 [18:48<24:55, 22.00s/it]Evaluating gsm8k :  46%|██████████████████████████████████████                                            | 58/125 [19:04<22:27, 20.11s/it]Evaluating gsm8k :  47%|██████████████████████████████████████▋                                           | 59/125 [19:26<22:49, 20.75s/it]Evaluating gsm8k :  48%|███████████████████████████████████████▎                                          | 60/125 [19:49<23:20, 21.55s/it]Evaluating gsm8k :  49%|████████████████████████████████████████                                          | 61/125 [20:06<21:25, 20.08s/it]Evaluating gsm8k :  50%|████████████████████████████████████████▋                                         | 62/125 [20:29<22:09, 21.11s/it]Evaluating gsm8k :  50%|█████████████████████████████████████████▎                                        | 63/125 [20:37<17:33, 16.99s/it]Evaluating gsm8k :  51%|█████████████████████████████████████████▉                                        | 64/125 [21:00<19:16, 18.96s/it]Evaluating gsm8k :  52%|██████████████████████████████████████████▋                                       | 65/125 [21:10<16:01, 16.03s/it]Evaluating gsm8k :  53%|███████████████████████████████████████████▎                                      | 66/125 [21:30<17:06, 17.41s/it]Evaluating gsm8k :  54%|███████████████████████████████████████████▉                                      | 67/125 [21:54<18:38, 19.29s/it]Evaluating gsm8k :  54%|████████████████████████████████████████████▌                                     | 68/125 [22:13<18:13, 19.18s/it]Evaluating gsm8k :  55%|█████████████████████████████████████████████▎                                    | 69/125 [22:27<16:38, 17.82s/it]Evaluating gsm8k :  56%|█████████████████████████████████████████████▉                                    | 70/125 [22:51<17:53, 19.51s/it]Evaluating gsm8k :  57%|██████████████████████████████████████████████▌                                   | 71/125 [23:14<18:38, 20.72s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▏                                  | 72/125 [23:38<19:00, 21.51s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▉                                  | 73/125 [23:49<15:52, 18.31s/it]Evaluating gsm8k :  59%|████████████████████████████████████████████████▌                                 | 74/125 [24:12<16:53, 19.88s/it]Evaluating gsm8k :  60%|█████████████████████████████████████████████████▏                                | 75/125 [24:36<17:27, 20.95s/it]Evaluating gsm8k :  61%|█████████████████████████████████████████████████▊                                | 76/125 [24:59<17:44, 21.72s/it]Evaluating gsm8k :  62%|██████████████████████████████████████████████████▌                               | 77/125 [25:23<17:52, 22.34s/it]Evaluating gsm8k :  62%|███████████████████████████████████████████████████▏                              | 78/125 [25:47<17:47, 22.72s/it]Evaluating gsm8k :  63%|███████████████████████████████████████████████████▊                              | 79/125 [26:10<17:35, 22.95s/it]Evaluating gsm8k :  64%|████████████████████████████████████████████████████▍                             | 80/125 [26:21<14:32, 19.38s/it]Evaluating gsm8k :  65%|█████████████████████████████████████████████████████▏                            | 81/125 [26:45<15:08, 20.65s/it]Evaluating gsm8k :  66%|█████████████████████████████████████████████████████▊                            | 82/125 [26:52<11:50, 16.52s/it]Evaluating gsm8k :  66%|██████████████████████████████████████████████████████▍                           | 83/125 [26:59<09:38, 13.78s/it]Evaluating gsm8k :  67%|███████████████████████████████████████████████████████                           | 84/125 [27:23<11:26, 16.74s/it]Evaluating gsm8k :  68%|███████████████████████████████████████████████████████▊                          | 85/125 [27:36<10:32, 15.82s/it]Evaluating gsm8k :  69%|████████████████████████████████████████████████████████▍                         | 86/125 [27:48<09:30, 14.63s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████                         | 87/125 [28:06<09:52, 15.60s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████▋                        | 88/125 [28:30<11:05, 17.98s/it]Evaluating gsm8k :  71%|██████████████████████████████████████████████████████████▍                       | 89/125 [28:51<11:23, 18.98s/it]Evaluating gsm8k :  72%|███████████████████████████████████████████████████████████                       | 90/125 [29:15<11:54, 20.40s/it]Evaluating gsm8k :  73%|███████████████████████████████████████████████████████████▋                      | 91/125 [29:35<11:38, 20.53s/it]Evaluating gsm8k :  74%|████████████████████████████████████████████████████████████▎                     | 92/125 [29:59<11:45, 21.37s/it]Evaluating gsm8k :  74%|█████████████████████████████████████████████████████████████                     | 93/125 [30:22<11:45, 22.04s/it]Evaluating gsm8k :  75%|█████████████████████████████████████████████████████████████▋                    | 94/125 [30:46<11:36, 22.46s/it]Evaluating gsm8k :  76%|██████████████████████████████████████████████████████████████▎                   | 95/125 [31:09<11:22, 22.75s/it]Evaluating gsm8k :  77%|██████████████████████████████████████████████████████████████▉                   | 96/125 [31:29<10:31, 21.77s/it]Evaluating gsm8k :  78%|███████████████████████████████████████████████████████████████▋                  | 97/125 [31:52<10:25, 22.33s/it]Evaluating gsm8k :  78%|████████████████████████████████████████████████████████████████▎                 | 98/125 [32:16<10:14, 22.75s/it]Evaluating gsm8k :  79%|████████████████████████████████████████████████████████████████▉                 | 99/125 [32:33<09:04, 20.93s/it]Evaluating gsm8k :  80%|████████████████████████████████████████████████████████████████▊                | 100/125 [32:56<09:03, 21.73s/it]Evaluating gsm8k :  81%|█████████████████████████████████████████████████████████████████▍               | 101/125 [33:20<08:55, 22.30s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████               | 102/125 [33:43<08:41, 22.68s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████▋              | 103/125 [34:07<08:24, 22.92s/it]Evaluating gsm8k :  83%|███████████████████████████████████████████████████████████████████▍             | 104/125 [34:13<06:15, 17.89s/it]Evaluating gsm8k :  84%|████████████████████████████████████████████████████████████████████             | 105/125 [34:37<06:33, 19.67s/it]Evaluating gsm8k :  85%|████████████████████████████████████████████████████████████████████▋            | 106/125 [34:55<06:02, 19.10s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▎           | 107/125 [35:18<06:07, 20.44s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▉           | 108/125 [35:42<06:03, 21.41s/it]Evaluating gsm8k :  87%|██████████████████████████████████████████████████████████████████████▋          | 109/125 [36:03<05:40, 21.28s/it]Evaluating gsm8k :  88%|███████████████████████████████████████████████████████████████████████▎         | 110/125 [36:11<04:19, 17.31s/it]Evaluating gsm8k :  89%|███████████████████████████████████████████████████████████████████████▉         | 111/125 [36:35<04:28, 19.18s/it]Evaluating gsm8k :  90%|████████████████████████████████████████████████████████████████████████▌        | 112/125 [36:58<04:27, 20.55s/it]Evaluating gsm8k :  90%|█████████████████████████████████████████████████████████████████████████▏       | 113/125 [37:22<04:16, 21.40s/it]Evaluating gsm8k :  91%|█████████████████████████████████████████████████████████████████████████▊       | 114/125 [37:45<04:02, 22.05s/it]Evaluating gsm8k :  92%|██████████████████████████████████████████████████████████████████████████▌      | 115/125 [38:09<03:44, 22.47s/it]Evaluating gsm8k :  93%|███████████████████████████████████████████████████████████████████████████▏     | 116/125 [38:32<03:25, 22.81s/it]Evaluating gsm8k :  94%|███████████████████████████████████████████████████████████████████████████▊     | 117/125 [38:42<02:30, 18.80s/it]Evaluating gsm8k :  94%|████████████████████████████████████████████████████████████████████████████▍    | 118/125 [39:05<02:21, 20.15s/it]Evaluating gsm8k :  95%|█████████████████████████████████████████████████████████████████████████████    | 119/125 [39:17<01:45, 17.55s/it]Evaluating gsm8k :  96%|█████████████████████████████████████████████████████████████████████████████▊   | 120/125 [39:40<01:36, 19.35s/it]Evaluating gsm8k :  97%|██████████████████████████████████████████████████████████████████████████████▍  | 121/125 [40:03<01:22, 20.52s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████  | 122/125 [40:27<01:04, 21.43s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████▋ | 123/125 [40:37<00:36, 18.11s/it]Evaluating gsm8k :  99%|████████████████████████████████████████████████████████████████████████████████▎| 124/125 [40:52<00:17, 17.10s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [41:15<00:00, 19.02s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [41:15<00:00, 19.81s/it]
name: gsm8k | {'exact_match': 0.0, 'rougeL': 0.3018} | lm_loss 11.2569 | avg. gen lenth: 333.996
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name gsm8k --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name commonsenseqa --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 2 --data-dir /scratch/ylu130/processed_data/gsm8k/out-domain/o5-tcommonsenseqa-s1-rTrue --seed 1 --max-prompt-length 2048 --rationales --num-out-domain 5
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-17 20:44:00,367] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... gsm8k
  data_dir ..................... /scratch/ylu130/processed_data/gsm8k/out-domain/o5-tcommonsenseqa-s1-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 5
  out_domain_data_name ......... commonsenseqa
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o5-tcommonsenseqa-s1-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 2
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                                             | 0/7473 [00:00<?, ?it/s]  0%|▎                                                                                                  | 20/7473 [00:00<00:38, 193.27it/s]  1%|▌                                                                                                  | 40/7473 [00:00<00:38, 193.06it/s]  1%|▊                                                                                                  | 60/7473 [00:00<00:38, 192.89it/s]  1%|█                                                                                                  | 80/7473 [00:00<00:38, 192.78it/s]  1%|█▎                                                                                                | 100/7473 [00:00<00:38, 192.50it/s]  2%|█▌                                                                                                | 120/7473 [00:00<00:38, 192.44it/s]  2%|█▊                                                                                                | 140/7473 [00:00<00:38, 190.05it/s]  2%|██                                                                                                | 160/7473 [00:00<00:38, 191.68it/s]  2%|██▎                                                                                               | 180/7473 [00:00<00:37, 192.45it/s]  3%|██▌                                                                                               | 200/7473 [00:01<00:37, 193.56it/s]  3%|██▉                                                                                               | 220/7473 [00:01<00:37, 194.28it/s]  3%|███▏                                                                                              | 240/7473 [00:01<00:37, 194.22it/s]  3%|███▍                                                                                              | 260/7473 [00:01<00:37, 192.87it/s]  4%|███▋                                                                                              | 280/7473 [00:01<00:37, 193.58it/s]  4%|███▉                                                                                              | 300/7473 [00:01<00:36, 194.11it/s]  4%|████▏                                                                                             | 320/7473 [00:01<00:36, 194.66it/s]  5%|████▍                                                                                             | 340/7473 [00:01<00:37, 192.72it/s]  5%|████▋                                                                                             | 360/7473 [00:01<00:36, 193.10it/s]  5%|████▉                                                                                             | 380/7473 [00:01<00:36, 193.48it/s]  5%|█████▏                                                                                            | 400/7473 [00:02<00:36, 193.37it/s]  6%|█████▌                                                                                            | 420/7473 [00:02<00:36, 193.64it/s]  6%|█████▊                                                                                            | 440/7473 [00:02<00:36, 193.67it/s]  6%|██████                                                                                            | 460/7473 [00:02<00:36, 194.08it/s]  6%|██████▎                                                                                           | 480/7473 [00:02<00:36, 192.75it/s]  7%|██████▌                                                                                           | 504/7473 [00:02<00:33, 205.31it/s]  7%|███████                                                                                           | 534/7473 [00:02<00:29, 232.75it/s]  8%|███████▍                                                                                          | 564/7473 [00:02<00:27, 252.09it/s]  8%|███████▊                                                                                          | 594/7473 [00:02<00:25, 264.91it/s]  8%|████████▏                                                                                         | 623/7473 [00:02<00:25, 271.77it/s]  9%|████████▌                                                                                         | 653/7473 [00:03<00:24, 277.77it/s]  9%|████████▉                                                                                         | 683/7473 [00:03<00:23, 283.53it/s] 10%|█████████▎                                                                                        | 713/7473 [00:03<00:23, 286.35it/s] 10%|█████████▋                                                                                        | 743/7473 [00:03<00:23, 290.29it/s] 10%|██████████▏                                                                                       | 773/7473 [00:03<00:23, 291.17it/s] 11%|██████████▌                                                                                       | 803/7473 [00:03<00:22, 292.55it/s] 11%|██████████▉                                                                                       | 833/7473 [00:03<00:22, 293.67it/s] 12%|███████████▎                                                                                      | 863/7473 [00:03<00:22, 294.73it/s] 12%|███████████▋                                                                                      | 893/7473 [00:03<00:22, 295.40it/s] 12%|████████████                                                                                      | 923/7473 [00:04<00:22, 295.63it/s] 13%|████████████▍                                                                                     | 953/7473 [00:04<00:22, 294.62it/s] 13%|████████████▉                                                                                     | 983/7473 [00:04<00:21, 295.98it/s] 14%|█████████████▏                                                                                   | 1013/7473 [00:04<00:21, 296.25it/s] 14%|█████████████▌                                                                                   | 1043/7473 [00:04<00:21, 293.38it/s] 14%|█████████████▉                                                                                   | 1073/7473 [00:04<00:21, 294.35it/s] 15%|██████████████▎                                                                                  | 1103/7473 [00:04<00:21, 294.66it/s] 15%|██████████████▋                                                                                  | 1133/7473 [00:04<00:21, 295.13it/s] 16%|███████████████                                                                                  | 1163/7473 [00:04<00:21, 292.78it/s] 16%|███████████████▍                                                                                 | 1193/7473 [00:04<00:21, 293.79it/s] 16%|███████████████▊                                                                                 | 1223/7473 [00:05<00:21, 294.49it/s] 17%|████████████████▎                                                                                | 1253/7473 [00:05<00:21, 295.12it/s] 17%|████████████████▋                                                                                | 1283/7473 [00:05<00:20, 295.55it/s] 18%|█████████████████                                                                                | 1313/7473 [00:05<00:20, 296.10it/s] 18%|█████████████████▍                                                                               | 1343/7473 [00:05<00:20, 296.61it/s] 18%|█████████████████▊                                                                               | 1373/7473 [00:05<00:20, 296.70it/s] 19%|██████████████████▏                                                                              | 1403/7473 [00:05<00:20, 293.80it/s] 19%|██████████████████▌                                                                              | 1433/7473 [00:05<00:20, 294.17it/s] 20%|██████████████████▉                                                                              | 1463/7473 [00:05<00:20, 294.88it/s] 20%|███████████████████▍                                                                             | 1493/7473 [00:05<00:20, 295.90it/s] 20%|███████████████████▊                                                                             | 1523/7473 [00:06<00:20, 296.49it/s] 21%|████████████████████▏                                                                            | 1553/7473 [00:06<00:20, 295.69it/s] 21%|████████████████████▌                                                                            | 1583/7473 [00:06<00:20, 292.49it/s] 22%|████████████████████▉                                                                            | 1613/7473 [00:06<00:20, 289.88it/s] 22%|█████████████████████▎                                                                           | 1643/7473 [00:06<00:19, 292.15it/s] 22%|█████████████████████▋                                                                           | 1673/7473 [00:06<00:19, 293.38it/s] 23%|██████████████████████                                                                           | 1703/7473 [00:06<00:19, 294.42it/s] 23%|██████████████████████▍                                                                          | 1733/7473 [00:06<00:19, 295.42it/s] 24%|██████████████████████▉                                                                          | 1763/7473 [00:06<00:19, 295.53it/s] 24%|███████████████████████▎                                                                         | 1793/7473 [00:06<00:19, 295.41it/s] 24%|███████████████████████▋                                                                         | 1823/7473 [00:07<00:19, 295.85it/s] 25%|████████████████████████                                                                         | 1853/7473 [00:07<00:19, 292.81it/s] 25%|████████████████████████▍                                                                        | 1883/7473 [00:07<00:19, 292.55it/s] 26%|████████████████████████▊                                                                        | 1913/7473 [00:07<00:19, 292.00it/s] 26%|█████████████████████████▏                                                                       | 1943/7473 [00:07<00:18, 292.98it/s] 26%|█████████████████████████▌                                                                       | 1973/7473 [00:07<00:18, 294.02it/s] 27%|█████████████████████████▉                                                                       | 2003/7473 [00:07<00:18, 294.47it/s] 27%|██████████████████████████▍                                                                      | 2033/7473 [00:07<00:18, 295.54it/s] 28%|██████████████████████████▊                                                                      | 2063/7473 [00:07<00:18, 295.71it/s] 28%|███████████████████████████▏                                                                     | 2093/7473 [00:07<00:18, 293.84it/s] 28%|███████████████████████████▌                                                                     | 2123/7473 [00:08<00:18, 293.57it/s] 29%|███████████████████████████▉                                                                     | 2153/7473 [00:08<00:18, 294.56it/s] 29%|████████████████████████████▎                                                                    | 2183/7473 [00:08<00:17, 294.81it/s] 30%|████████████████████████████▋                                                                    | 2213/7473 [00:08<00:17, 294.64it/s] 30%|█████████████████████████████                                                                    | 2243/7473 [00:08<00:17, 293.23it/s] 30%|█████████████████████████████▌                                                                   | 2273/7473 [00:08<00:17, 290.44it/s] 31%|█████████████████████████████▉                                                                   | 2303/7473 [00:08<00:17, 290.69it/s] 31%|██████████████████████████████▎                                                                  | 2333/7473 [00:08<00:17, 292.48it/s] 32%|██████████████████████████████▋                                                                  | 2363/7473 [00:08<00:17, 293.44it/s] 32%|███████████████████████████████                                                                  | 2393/7473 [00:09<00:17, 293.98it/s] 32%|███████████████████████████████▍                                                                 | 2423/7473 [00:09<00:17, 293.93it/s] 33%|███████████████████████████████▊                                                                 | 2453/7473 [00:09<00:17, 295.08it/s] 33%|████████████████████████████████▏                                                                | 2483/7473 [00:09<00:16, 295.17it/s] 34%|████████████████████████████████▌                                                                | 2513/7473 [00:09<00:16, 295.26it/s] 34%|█████████████████████████████████                                                                | 2543/7473 [00:09<00:18, 266.23it/s] 34%|█████████████████████████████████▍                                                               | 2573/7473 [00:09<00:17, 274.57it/s] 35%|█████████████████████████████████▊                                                               | 2603/7473 [00:09<00:17, 280.46it/s] 35%|██████████████████████████████████▏                                                              | 2633/7473 [00:09<00:16, 285.21it/s] 36%|██████████████████████████████████▌                                                              | 2663/7473 [00:09<00:16, 288.89it/s] 36%|██████████████████████████████████▉                                                              | 2693/7473 [00:10<00:16, 291.12it/s] 36%|███████████████████████████████████▎                                                             | 2723/7473 [00:10<00:16, 292.46it/s] 37%|███████████████████████████████████▋                                                             | 2753/7473 [00:10<00:16, 291.81it/s] 37%|████████████████████████████████████                                                             | 2783/7473 [00:10<00:15, 293.36it/s] 38%|████████████████████████████████████▌                                                            | 2813/7473 [00:10<00:15, 293.99it/s] 38%|████████████████████████████████████▉                                                            | 2843/7473 [00:10<00:15, 294.87it/s] 38%|█████████████████████████████████████▎                                                           | 2873/7473 [00:10<00:15, 293.89it/s] 39%|█████████████████████████████████████▋                                                           | 2903/7473 [00:10<00:15, 294.14it/s] 39%|██████████████████████████████████████                                                           | 2933/7473 [00:10<00:15, 295.62it/s] 40%|██████████████████████████████████████▍                                                          | 2963/7473 [00:10<00:15, 296.17it/s] 40%|██████████████████████████████████████▊                                                          | 2993/7473 [00:11<00:15, 294.40it/s] 40%|███████████████████████████████████████▏                                                         | 3023/7473 [00:11<00:15, 294.64it/s] 41%|███████████████████████████████████████▋                                                         | 3053/7473 [00:11<00:14, 295.01it/s] 41%|████████████████████████████████████████                                                         | 3083/7473 [00:11<00:14, 295.34it/s] 42%|████████████████████████████████████████▍                                                        | 3113/7473 [00:11<00:14, 294.51it/s] 42%|████████████████████████████████████████▊                                                        | 3143/7473 [00:11<00:14, 294.08it/s] 42%|█████████████████████████████████████████▏                                                       | 3173/7473 [00:11<00:14, 294.53it/s] 43%|█████████████████████████████████████████▌                                                       | 3203/7473 [00:11<00:14, 292.96it/s] 43%|█████████████████████████████████████████▉                                                       | 3233/7473 [00:11<00:14, 294.08it/s] 44%|██████████████████████████████████████████▎                                                      | 3263/7473 [00:11<00:14, 294.81it/s] 44%|██████████████████████████████████████████▋                                                      | 3293/7473 [00:12<00:14, 295.37it/s] 44%|███████████████████████████████████████████▏                                                     | 3323/7473 [00:12<00:14, 295.61it/s] 45%|███████████████████████████████████████████▌                                                     | 3353/7473 [00:12<00:13, 294.76it/s] 45%|███████████████████████████████████████████▉                                                     | 3383/7473 [00:12<00:13, 294.53it/s] 46%|████████████████████████████████████████████▎                                                    | 3413/7473 [00:12<00:13, 291.78it/s] 46%|████████████████████████████████████████████▋                                                    | 3443/7473 [00:12<00:13, 291.24it/s] 46%|█████████████████████████████████████████████                                                    | 3473/7473 [00:12<00:13, 291.94it/s] 47%|█████████████████████████████████████████████▍                                                   | 3503/7473 [00:12<00:13, 292.21it/s] 47%|█████████████████████████████████████████████▊                                                   | 3533/7473 [00:12<00:13, 292.74it/s] 48%|██████████████████████████████████████████████▏                                                  | 3563/7473 [00:13<00:13, 293.56it/s] 48%|██████████████████████████████████████████████▋                                                  | 3593/7473 [00:13<00:13, 294.29it/s] 48%|███████████████████████████████████████████████                                                  | 3623/7473 [00:13<00:13, 294.86it/s] 49%|███████████████████████████████████████████████▍                                                 | 3653/7473 [00:13<00:12, 294.15it/s] 49%|███████████████████████████████████████████████▊                                                 | 3683/7473 [00:13<00:12, 292.69it/s] 50%|████████████████████████████████████████████████▏                                                | 3713/7473 [00:13<00:12, 293.01it/s] 50%|████████████████████████████████████████████████▌                                                | 3743/7473 [00:13<00:12, 293.58it/s] 50%|████████████████████████████████████████████████▉                                                | 3773/7473 [00:13<00:12, 294.04it/s] 51%|█████████████████████████████████████████████████▎                                               | 3803/7473 [00:13<00:12, 294.69it/s] 51%|█████████████████████████████████████████████████▊                                               | 3833/7473 [00:13<00:12, 294.56it/s] 52%|██████████████████████████████████████████████████▏                                              | 3863/7473 [00:14<00:12, 294.47it/s] 52%|██████████████████████████████████████████████████▌                                              | 3893/7473 [00:14<00:12, 292.67it/s] 52%|██████████████████████████████████████████████████▉                                              | 3923/7473 [00:14<00:12, 291.21it/s] 53%|███████████████████████████████████████████████████▎                                             | 3953/7473 [00:14<00:12, 292.81it/s] 53%|███████████████████████████████████████████████████▋                                             | 3983/7473 [00:14<00:11, 293.16it/s] 54%|████████████████████████████████████████████████████                                             | 4013/7473 [00:14<00:11, 294.31it/s] 54%|████████████████████████████████████████████████████▍                                            | 4043/7473 [00:14<00:11, 294.84it/s] 55%|████████████████████████████████████████████████████▊                                            | 4073/7473 [00:14<00:11, 294.85it/s] 55%|█████████████████████████████████████████████████████▎                                           | 4103/7473 [00:14<00:11, 294.86it/s] 55%|█████████████████████████████████████████████████████▋                                           | 4133/7473 [00:14<00:11, 292.31it/s] 56%|██████████████████████████████████████████████████████                                           | 4163/7473 [00:15<00:11, 292.46it/s] 56%|██████████████████████████████████████████████████████▍                                          | 4193/7473 [00:15<00:11, 292.71it/s] 57%|██████████████████████████████████████████████████████▊                                          | 4223/7473 [00:15<00:11, 293.12it/s] 57%|███████████████████████████████████████████████████████▏                                         | 4253/7473 [00:15<00:10, 293.43it/s] 57%|███████████████████████████████████████████████████████▌                                         | 4283/7473 [00:15<00:10, 293.15it/s] 58%|███████████████████████████████████████████████████████▉                                         | 4313/7473 [00:15<00:10, 293.41it/s] 58%|████████████████████████████████████████████████████████▎                                        | 4343/7473 [00:15<00:10, 292.38it/s] 59%|████████████████████████████████████████████████████████▊                                        | 4373/7473 [00:15<00:10, 292.97it/s] 59%|█████████████████████████████████████████████████████████▏                                       | 4403/7473 [00:15<00:10, 290.84it/s] 59%|█████████████████████████████████████████████████████████▌                                       | 4433/7473 [00:15<00:10, 291.25it/s] 60%|█████████████████████████████████████████████████████████▉                                       | 4463/7473 [00:16<00:10, 291.27it/s] 60%|██████████████████████████████████████████████████████████▎                                      | 4493/7473 [00:16<00:10, 292.01it/s] 61%|██████████████████████████████████████████████████████████▋                                      | 4523/7473 [00:16<00:10, 292.35it/s] 61%|███████████████████████████████████████████████████████████                                      | 4553/7473 [00:16<00:09, 293.64it/s] 61%|███████████████████████████████████████████████████████████▍                                     | 4583/7473 [00:16<00:09, 291.82it/s] 62%|███████████████████████████████████████████████████████████▉                                     | 4613/7473 [00:16<00:09, 292.51it/s] 62%|████████████████████████████████████████████████████████████▎                                    | 4643/7473 [00:16<00:09, 292.96it/s] 63%|████████████████████████████████████████████████████████████▋                                    | 4673/7473 [00:16<00:09, 293.17it/s] 63%|█████████████████████████████████████████████████████████████                                    | 4703/7473 [00:16<00:09, 293.68it/s] 63%|█████████████████████████████████████████████████████████████▍                                   | 4733/7473 [00:17<00:09, 294.10it/s] 64%|█████████████████████████████████████████████████████████████▊                                   | 4763/7473 [00:17<00:09, 294.47it/s] 64%|██████████████████████████████████████████████████████████████▏                                  | 4793/7473 [00:17<00:09, 292.42it/s] 65%|██████████████████████████████████████████████████████████████▌                                  | 4823/7473 [00:17<00:09, 293.13it/s] 65%|██████████████████████████████████████████████████████████████▉                                  | 4853/7473 [00:17<00:08, 293.45it/s] 65%|███████████████████████████████████████████████████████████████▍                                 | 4883/7473 [00:17<00:08, 293.56it/s] 66%|███████████████████████████████████████████████████████████████▊                                 | 4913/7473 [00:17<00:08, 292.26it/s] 66%|████████████████████████████████████████████████████████████████▏                                | 4943/7473 [00:17<00:08, 292.55it/s] 67%|████████████████████████████████████████████████████████████████▌                                | 4973/7473 [00:17<00:08, 292.94it/s] 67%|████████████████████████████████████████████████████████████████▉                                | 5003/7473 [00:17<00:08, 293.62it/s] 67%|█████████████████████████████████████████████████████████████████▎                               | 5033/7473 [00:18<00:08, 291.15it/s] 68%|█████████████████████████████████████████████████████████████████▋                               | 5063/7473 [00:18<00:08, 292.51it/s] 68%|██████████████████████████████████████████████████████████████████                               | 5093/7473 [00:18<00:08, 292.27it/s] 69%|██████████████████████████████████████████████████████████████████▍                              | 5123/7473 [00:18<00:08, 292.87it/s] 69%|██████████████████████████████████████████████████████████████████▉                              | 5153/7473 [00:18<00:07, 293.07it/s] 69%|███████████████████████████████████████████████████████████████████▎                             | 5183/7473 [00:18<00:07, 292.96it/s] 70%|███████████████████████████████████████████████████████████████████▋                             | 5213/7473 [00:18<00:07, 293.70it/s] 70%|████████████████████████████████████████████████████████████████████                             | 5243/7473 [00:18<00:08, 261.59it/s] 71%|████████████████████████████████████████████████████████████████████▍                            | 5273/7473 [00:18<00:08, 269.86it/s] 71%|████████████████████████████████████████████████████████████████████▊                            | 5303/7473 [00:18<00:07, 276.84it/s] 71%|█████████████████████████████████████████████████████████████████████▏                           | 5333/7473 [00:19<00:07, 281.50it/s] 72%|█████████████████████████████████████████████████████████████████████▌                           | 5363/7473 [00:19<00:07, 284.80it/s] 72%|█████████████████████████████████████████████████████████████████████▉                           | 5392/7473 [00:19<00:07, 281.98it/s] 73%|██████████████████████████████████████████████████████████████████████▎                          | 5421/7473 [00:19<00:07, 284.04it/s] 73%|██████████████████████████████████████████████████████████████████████▊                          | 5451/7473 [00:19<00:07, 287.27it/s] 73%|███████████████████████████████████████████████████████████████████████▏                         | 5480/7473 [00:19<00:10, 189.44it/s] 74%|███████████████████████████████████████████████████████████████████████▌                         | 5510/7473 [00:19<00:09, 212.43it/s] 74%|███████████████████████████████████████████████████████████████████████▉                         | 5540/7473 [00:19<00:08, 231.98it/s] 75%|████████████████████████████████████████████████████████████████████████▎                        | 5570/7473 [00:20<00:07, 247.97it/s] 75%|████████████████████████████████████████████████████████████████████████▋                        | 5600/7473 [00:20<00:07, 260.00it/s] 75%|█████████████████████████████████████████████████████████████████████████                        | 5630/7473 [00:20<00:06, 269.53it/s] 76%|█████████████████████████████████████████████████████████████████████████▍                       | 5660/7473 [00:20<00:06, 275.80it/s] 76%|█████████████████████████████████████████████████████████████████████████▊                       | 5689/7473 [00:20<00:06, 278.49it/s] 77%|██████████████████████████████████████████████████████████████████████████▏                      | 5719/7473 [00:20<00:06, 282.61it/s] 77%|██████████████████████████████████████████████████████████████████████████▌                      | 5749/7473 [00:20<00:06, 286.32it/s] 77%|███████████████████████████████████████████████████████████████████████████                      | 5779/7473 [00:20<00:05, 288.81it/s] 78%|███████████████████████████████████████████████████████████████████████████▍                     | 5809/7473 [00:20<00:05, 290.19it/s] 78%|███████████████████████████████████████████████████████████████████████████▊                     | 5839/7473 [00:21<00:05, 291.32it/s] 79%|████████████████████████████████████████████████████████████████████████████▏                    | 5869/7473 [00:21<00:05, 292.12it/s] 79%|████████████████████████████████████████████████████████████████████████████▌                    | 5899/7473 [00:21<00:05, 290.78it/s] 79%|████████████████████████████████████████████████████████████████████████████▉                    | 5929/7473 [00:21<00:05, 291.61it/s] 80%|█████████████████████████████████████████████████████████████████████████████▎                   | 5959/7473 [00:21<00:05, 291.01it/s] 80%|█████████████████████████████████████████████████████████████████████████████▋                   | 5989/7473 [00:21<00:05, 287.20it/s] 81%|██████████████████████████████████████████████████████████████████████████████                   | 6018/7473 [00:21<00:05, 287.41it/s] 81%|██████████████████████████████████████████████████████████████████████████████▌                  | 6048/7473 [00:21<00:04, 289.45it/s] 81%|██████████████████████████████████████████████████████████████████████████████▉                  | 6078/7473 [00:21<00:04, 291.52it/s] 82%|███████████████████████████████████████████████████████████████████████████████▎                 | 6108/7473 [00:21<00:04, 292.40it/s] 82%|███████████████████████████████████████████████████████████████████████████████▋                 | 6138/7473 [00:22<00:04, 291.20it/s] 83%|████████████████████████████████████████████████████████████████████████████████                 | 6168/7473 [00:22<00:04, 291.99it/s] 83%|████████████████████████████████████████████████████████████████████████████████▍                | 6198/7473 [00:22<00:04, 292.54it/s] 83%|████████████████████████████████████████████████████████████████████████████████▊                | 6228/7473 [00:22<00:04, 292.76it/s] 84%|█████████████████████████████████████████████████████████████████████████████████▏               | 6258/7473 [00:22<00:04, 293.32it/s] 84%|█████████████████████████████████████████████████████████████████████████████████▌               | 6288/7473 [00:22<00:04, 292.14it/s] 85%|██████████████████████████████████████████████████████████████████████████████████               | 6318/7473 [00:22<00:03, 292.26it/s] 85%|██████████████████████████████████████████████████████████████████████████████████▍              | 6348/7473 [00:22<00:03, 293.03it/s] 85%|██████████████████████████████████████████████████████████████████████████████████▊              | 6378/7473 [00:22<00:03, 290.77it/s] 86%|███████████████████████████████████████████████████████████████████████████████████▏             | 6408/7473 [00:22<00:03, 291.40it/s] 86%|███████████████████████████████████████████████████████████████████████████████████▌             | 6438/7473 [00:23<00:03, 291.88it/s] 87%|███████████████████████████████████████████████████████████████████████████████████▉             | 6468/7473 [00:23<00:03, 292.26it/s] 87%|████████████████████████████████████████████████████████████████████████████████████▎            | 6498/7473 [00:23<00:03, 293.00it/s] 87%|████████████████████████████████████████████████████████████████████████████████████▋            | 6528/7473 [00:23<00:03, 293.02it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████            | 6558/7473 [00:23<00:03, 293.23it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████▌           | 6588/7473 [00:23<00:03, 291.82it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████▉           | 6618/7473 [00:23<00:02, 291.96it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████▎          | 6648/7473 [00:23<00:02, 291.50it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████▋          | 6678/7473 [00:23<00:02, 291.56it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████          | 6708/7473 [00:23<00:02, 292.60it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████▍         | 6738/7473 [00:24<00:02, 293.01it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████▊         | 6768/7473 [00:24<00:02, 292.64it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████▏        | 6798/7473 [00:24<00:02, 293.11it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████▋        | 6828/7473 [00:24<00:02, 291.40it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████        | 6858/7473 [00:24<00:02, 291.27it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████▍       | 6888/7473 [00:24<00:02, 292.29it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████▊       | 6918/7473 [00:24<00:01, 292.84it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████▏      | 6948/7473 [00:24<00:01, 290.89it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████▌      | 6978/7473 [00:24<00:01, 291.38it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████▉      | 7008/7473 [00:25<00:01, 291.88it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████▎     | 7038/7473 [00:25<00:01, 290.06it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████▋     | 7068/7473 [00:25<00:01, 291.12it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████▏    | 7098/7473 [00:25<00:01, 292.29it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████▌    | 7128/7473 [00:25<00:01, 292.10it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████▉    | 7158/7473 [00:25<00:01, 292.08it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████▎   | 7188/7473 [00:25<00:00, 292.31it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████▋   | 7218/7473 [00:25<00:00, 292.76it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████   | 7248/7473 [00:25<00:00, 291.72it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████▍  | 7278/7473 [00:25<00:00, 290.19it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████▊  | 7308/7473 [00:26<00:00, 291.41it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████▏ | 7338/7473 [00:26<00:00, 291.59it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████▋ | 7368/7473 [00:26<00:00, 291.69it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████ | 7398/7473 [00:26<00:00, 292.43it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████▍| 7428/7473 [00:26<00:00, 292.77it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████▊| 7458/7473 [00:26<00:00, 292.19it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 7473/7473 [00:26<00:00, 280.89it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.25s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:11,  5.58s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:11,  5.58s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:11,  5.60s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.24s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:11<00:05,  5.49s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:11<00:05,  5.49s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:11<00:05,  5.52s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.66s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.82s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  4.90s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.07s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  4.88s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.05s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:16<00:00,  5.30s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:16<00:00,  5.37s/it]
[2023-08-17 20:45:21,695] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
[2023-08-17 20:45:33,133] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-17 20:45:33,134] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-17 20:45:33,135] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-17 20:45:33,135] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-17 20:45:33,135] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-17 20:45:33,135] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-17 20:45:33,137] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-17 20:45:33,137] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-17 20:45:33,137] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-17 20:45:33,137] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-17 20:45:33,137] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-17 20:45:33,137] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f9f9ef30370>
[2023-08-17 20:45:33,137] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-17 20:45:33,137] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-17 20:45:33,137] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-17 20:45:33,137] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-17 20:45:33,137] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-17 20:45:33,137] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f9f9ef30250>
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   train_batch_size ............. 8
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  2
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-17 20:45:33,138] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-17 20:45:33,139] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-17 20:45:33,139] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-17 20:45:33,139] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-17 20:45:33,139] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.6812582015991211 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating gsm8k :   0%|                                                                                           | 0/125 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following grade math question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: 1. The question is asking for a place where the plumbing would not be useful to a person if they were thirsty.
2. This means we need to figure out where the plumbing does not involve drinkable water.
3. When considering the option A: oil refineries, this place has an extensive system for transporting and managing fluids i.e., plumbing, but it is not designed to handle water for drinking.
4. Option B: wall does have plumbing but it generally contains pipes for water needed in a home, which is drinkable.
5. Option C: show does not seem to make sense in the context of this question.
6. Option D: own home consists of plumbing that definitely brings in potable water.
7. Option E: water fountain is designed to deliver drinking water.
8. Therefore, option A: oil refineries is the correct answer because although it has plumbing, it is the only choice where plumbing would not be useful if you are thirsty as it doesn't carry drinkable water.
So the final answer is A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Output: 1. The question asks for what a person isn't doing yet when they are beginning work.
2. This implies that the person has only just started to work and has not had time to progress or make any significant strides in their task.
3. The term "beginning" indicates that a person hasn't done much yet in their work; they're only just starting.
4. So, choice A, "working", could be eliminated as a person beginning work is surely in the act of working.
5. Choice B, "resting" can also be eliminated because a person who is starting work is not resting.
6. Choice C, "tiredness", can be eliminated as someone just beginning to work is unlikely to be tired from it yet.
7. Choice E, "momentum", can be eliminated because when a person is starting their work, they may already be building momentum.
8. So, by process of elimination, we choose choice D: "accomplishing" as the answer. This is because when a person is just starting their work, they have not yet had the time to accomplish anything significant.
So the final answer is D: accomplishing

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Output: 1. The question is asking where one might find pens that have a company logo on them. 
2. We can start eliminating choices that are less likely to be correct. The first option to eliminate is B: on a pencil, because this doesn't make sense. Pens are not found on pencils.
3. Next, let's remove option C: write sentences on paper, as this is not a location but an action one might do with a pen.
4. Option D: school is a place where pens could be found, but they are unlikely to have company logos on them as pens in schools are usually plain or have school related logos.
5. Option E: backpack could potentially have pens with company logos, but it is not a common place to find them unless someone intentionally puts them there.
6. This leaves us with option A: office. It is common for companies to have pens with their logos in offices for employees and clients to use. 
7. Therefore, the correct answer is A: office.
So the final answer is A: office

Input: Billy called out to John, and listened for what? Choices:  A: silence B: response C: communication D: hanging up E: whisper
Output: 1. The question is asking what Billy is expecting or waiting for after calling out to John.
2. Billy's action of calling out to John is an attempt to get John's attention or to initiate a conversation with him.
3. In a typical conversation, when a person calls out to another, they are usually anticipating a reaction or a reply from the person they called out to. 
4. So, Billy is not waiting for silence (A), because that would mean he is not getting any reaction. 
5. He is also not waiting for communication (C) as the initiation of conversation is already done by him, and now he is waiting for John's part.
6. He is not waiting for hanging up (D) as nobody is on the phone. 
7. He is not waiting for a whisper (E) specifically, as the mode of John's response is not specified. 
8. Hence, he is most likely waiting for a response (B) from John after he called out to him.
So the final answer is B: response

Input: The lizard frightened the hiker, it's movements made what rustle? Choices:  A: garden B: trees C: books D: rocks E: bushes
Output: 1. The question is asking where the sound of rustling came from as a result of the lizard's movements. 
2. To answer this question, we must think of where lizards are typically found and where their movements might cause a rustling sound.
3. Given the choices: Garden, Trees, Books, Rocks and Bushes, we can begin eliminating options. 
4. Lizards are usually not found in gardens, trees, or among rocks. They typically cannot move within them to make a rustling sound. Therefore, we eliminate options A: Garden, B: Trees, and D: Rocks.
5. Books do not seem relevant to a lizard's natural environment or the context of frightening a hiker. Hence we can rule out option C: Books.
6. We're left with option E: Bushes. Considering that lizards often live in forests or bushy areas, their movements can indeed cause bushes to rustle. This is in line with the context of the scenario - a hiker being startled by such noise. 
7. Therefore, the answer is E: Bushes.
So the final answer is E: bushes

Input:Natalia sold clips to 48 of her friends in April, and then she sold half as many clips in May. How many clips did Natalia sell altogether in April and May?
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o5-tcommonsenseqa-s1-rTrue
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.5048503875732422 seconds
Time to load utils op: 0.7049899101257324 seconds
Loading extension module utils...
Time to load utils op: 0.7048802375793457 seconds
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 1626046 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 1626047 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 1626048 closing signal SIGTERM
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 3 (pid: 1626049) of binary: /home/ylu130/.conda/envs/distllm/bin/python
Traceback (most recent call last):
  File "/home/ylu130/.conda/envs/distllm/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 345, in wrapper
    return f(*args, **kwargs)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 761, in main
    run(args)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 752, in run
    elastic_launch(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 131, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 245, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
/home/ylu130/workspace/in-context-generalization/inference.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2023-08-17_20:45:43
  host      : ia1.wse.jhu.edu
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 1626049)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name gsm8k --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name commonsenseqa --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 2 --data-dir /scratch/ylu130/processed_data/gsm8k/out-domain/o6-tcommonsenseqa-s1-rTrue --seed 1 --max-prompt-length 2048 --rationales --num-out-domain 6
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-17 20:45:47,614] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... gsm8k
  data_dir ..................... /scratch/ylu130/processed_data/gsm8k/out-domain/o6-tcommonsenseqa-s1-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 6
  out_domain_data_name ......... commonsenseqa
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o6-tcommonsenseqa-s1-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 2
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                                             | 0/7473 [00:00<?, ?it/s]  0%|▏                                                                                                  | 16/7473 [00:00<00:47, 155.87it/s]  0%|▍                                                                                                  | 32/7473 [00:00<00:47, 156.20it/s]  1%|▋                                                                                                  | 48/7473 [00:00<00:47, 156.54it/s]  1%|▊                                                                                                  | 64/7473 [00:00<00:47, 156.32it/s]  1%|█                                                                                                  | 80/7473 [00:00<00:47, 156.81it/s]  1%|█▎                                                                                                 | 96/7473 [00:00<00:46, 157.01it/s]  1%|█▍                                                                                                | 112/7473 [00:00<00:47, 154.36it/s]  2%|█▋                                                                                                | 128/7473 [00:00<00:47, 154.88it/s]  2%|█▉                                                                                                | 144/7473 [00:00<00:47, 155.37it/s]  2%|██                                                                                                | 160/7473 [00:01<00:46, 156.04it/s]  2%|██▎                                                                                               | 176/7473 [00:01<00:46, 155.90it/s]  3%|██▌                                                                                               | 192/7473 [00:01<00:46, 156.30it/s]  3%|██▋                                                                                               | 208/7473 [00:01<00:46, 156.66it/s]  3%|██▉                                                                                               | 224/7473 [00:01<00:46, 156.70it/s]  3%|███▏                                                                                              | 240/7473 [00:01<00:46, 155.94it/s]  3%|███▎                                                                                              | 256/7473 [00:01<00:46, 154.68it/s]  4%|███▌                                                                                              | 272/7473 [00:01<00:46, 153.55it/s]  4%|███▊                                                                                              | 288/7473 [00:01<00:46, 154.44it/s]  4%|███▉                                                                                              | 304/7473 [00:01<00:46, 154.93it/s]  4%|████▏                                                                                             | 320/7473 [00:02<00:45, 155.56it/s]  4%|████▍                                                                                             | 336/7473 [00:02<00:45, 155.61it/s]  5%|████▌                                                                                             | 352/7473 [00:02<00:45, 155.92it/s]  5%|████▊                                                                                             | 368/7473 [00:02<00:45, 155.59it/s]  5%|█████                                                                                             | 384/7473 [00:02<00:45, 155.97it/s]  5%|█████▏                                                                                            | 400/7473 [00:02<00:45, 155.18it/s]  6%|█████▍                                                                                            | 416/7473 [00:02<00:45, 155.19it/s]  6%|█████▋                                                                                            | 437/7473 [00:02<00:41, 171.09it/s]  6%|██████                                                                                            | 461/7473 [00:02<00:36, 190.71it/s]  6%|██████▎                                                                                           | 485/7473 [00:02<00:34, 203.20it/s]  7%|██████▋                                                                                           | 509/7473 [00:03<00:32, 213.05it/s]  7%|██████▉                                                                                           | 533/7473 [00:03<00:31, 220.64it/s]  7%|███████▎                                                                                          | 557/7473 [00:03<00:30, 226.15it/s]  8%|███████▌                                                                                          | 581/7473 [00:03<00:30, 229.44it/s]  8%|███████▉                                                                                          | 605/7473 [00:03<00:29, 232.38it/s]  8%|████████▎                                                                                         | 630/7473 [00:03<00:29, 235.01it/s]  9%|████████▌                                                                                         | 655/7473 [00:03<00:28, 236.94it/s]  9%|████████▉                                                                                         | 680/7473 [00:03<00:28, 238.84it/s]  9%|█████████▏                                                                                        | 704/7473 [00:03<00:28, 238.74it/s] 10%|█████████▌                                                                                        | 729/7473 [00:03<00:28, 240.20it/s] 10%|█████████▉                                                                                        | 754/7473 [00:04<00:27, 241.22it/s] 10%|██████████▏                                                                                       | 779/7473 [00:04<00:27, 240.80it/s] 11%|██████████▌                                                                                       | 804/7473 [00:04<00:27, 240.84it/s] 11%|██████████▊                                                                                       | 829/7473 [00:04<00:27, 241.17it/s] 11%|███████████▏                                                                                      | 854/7473 [00:04<00:27, 241.49it/s] 12%|███████████▌                                                                                      | 879/7473 [00:04<00:27, 241.53it/s] 12%|███████████▊                                                                                      | 904/7473 [00:04<00:27, 241.69it/s] 12%|████████████▏                                                                                     | 929/7473 [00:04<00:27, 241.74it/s] 13%|████████████▌                                                                                     | 954/7473 [00:04<00:27, 240.57it/s] 13%|████████████▊                                                                                     | 979/7473 [00:05<00:26, 241.54it/s] 13%|█████████████                                                                                    | 1004/7473 [00:05<00:26, 241.24it/s] 14%|█████████████▎                                                                                   | 1029/7473 [00:05<00:26, 242.10it/s] 14%|█████████████▋                                                                                   | 1054/7473 [00:05<00:26, 241.83it/s] 14%|██████████████                                                                                   | 1079/7473 [00:05<00:26, 242.08it/s] 15%|██████████████▎                                                                                  | 1104/7473 [00:05<00:26, 241.98it/s] 15%|██████████████▋                                                                                  | 1129/7473 [00:05<00:26, 240.43it/s] 15%|██████████████▉                                                                                  | 1154/7473 [00:05<00:26, 240.96it/s] 16%|███████████████▎                                                                                 | 1179/7473 [00:05<00:26, 239.27it/s] 16%|███████████████▌                                                                                 | 1203/7473 [00:05<00:26, 239.27it/s] 16%|███████████████▉                                                                                 | 1228/7473 [00:06<00:26, 240.14it/s] 17%|████████████████▎                                                                                | 1253/7473 [00:06<00:25, 240.33it/s] 17%|████████████████▌                                                                                | 1278/7473 [00:06<00:25, 240.40it/s] 17%|████████████████▉                                                                                | 1303/7473 [00:06<00:25, 240.39it/s] 18%|█████████████████▏                                                                               | 1328/7473 [00:06<00:25, 240.75it/s] 18%|█████████████████▌                                                                               | 1353/7473 [00:06<00:25, 241.10it/s] 18%|█████████████████▉                                                                               | 1378/7473 [00:06<00:25, 240.87it/s] 19%|██████████████████▏                                                                              | 1403/7473 [00:06<00:25, 238.30it/s] 19%|██████████████████▌                                                                              | 1427/7473 [00:06<00:25, 237.44it/s] 19%|██████████████████▊                                                                              | 1452/7473 [00:07<00:25, 238.57it/s] 20%|███████████████████▏                                                                             | 1477/7473 [00:07<00:25, 239.22it/s] 20%|███████████████████▍                                                                             | 1502/7473 [00:07<00:24, 239.95it/s] 20%|███████████████████▊                                                                             | 1527/7473 [00:07<00:24, 240.95it/s] 21%|████████████████████▏                                                                            | 1552/7473 [00:07<00:24, 240.31it/s] 21%|████████████████████▍                                                                            | 1577/7473 [00:07<00:24, 239.48it/s] 21%|████████████████████▊                                                                            | 1602/7473 [00:07<00:24, 240.09it/s] 22%|█████████████████████                                                                            | 1627/7473 [00:07<00:24, 238.54it/s] 22%|█████████████████████▍                                                                           | 1651/7473 [00:07<00:24, 238.41it/s] 22%|█████████████████████▊                                                                           | 1676/7473 [00:07<00:24, 239.70it/s] 23%|██████████████████████                                                                           | 1701/7473 [00:08<00:24, 239.97it/s] 23%|██████████████████████▍                                                                          | 1726/7473 [00:08<00:23, 240.66it/s] 23%|██████████████████████▋                                                                          | 1751/7473 [00:08<00:23, 239.01it/s] 24%|███████████████████████                                                                          | 1776/7473 [00:08<00:23, 239.38it/s] 24%|███████████████████████▍                                                                         | 1801/7473 [00:08<00:23, 239.82it/s] 24%|███████████████████████▋                                                                         | 1825/7473 [00:08<00:23, 239.56it/s] 25%|████████████████████████                                                                         | 1849/7473 [00:08<00:23, 237.27it/s] 25%|████████████████████████▎                                                                        | 1874/7473 [00:08<00:23, 238.34it/s] 25%|████████████████████████▋                                                                        | 1898/7473 [00:08<00:23, 238.81it/s] 26%|████████████████████████▉                                                                        | 1922/7473 [00:08<00:23, 239.03it/s] 26%|█████████████████████████▎                                                                       | 1946/7473 [00:09<00:23, 239.22it/s] 26%|█████████████████████████▌                                                                       | 1971/7473 [00:09<00:22, 239.94it/s] 27%|█████████████████████████▉                                                                       | 1996/7473 [00:09<00:22, 240.28it/s] 27%|██████████████████████████▏                                                                      | 2021/7473 [00:09<00:22, 240.64it/s] 27%|██████████████████████████▌                                                                      | 2046/7473 [00:09<00:22, 240.51it/s] 28%|██████████████████████████▉                                                                      | 2071/7473 [00:09<00:22, 236.40it/s] 28%|███████████████████████████▏                                                                     | 2095/7473 [00:09<00:22, 237.23it/s] 28%|███████████████████████████▌                                                                     | 2119/7473 [00:09<00:22, 236.94it/s] 29%|███████████████████████████▊                                                                     | 2143/7473 [00:09<00:22, 237.41it/s] 29%|████████████████████████████▏                                                                    | 2167/7473 [00:09<00:22, 237.60it/s] 29%|████████████████████████████▍                                                                    | 2191/7473 [00:10<00:22, 237.30it/s] 30%|████████████████████████████▊                                                                    | 2216/7473 [00:10<00:22, 238.16it/s] 30%|█████████████████████████████                                                                    | 2240/7473 [00:10<00:21, 238.02it/s] 30%|█████████████████████████████▍                                                                   | 2264/7473 [00:10<00:21, 238.06it/s] 31%|█████████████████████████████▋                                                                   | 2288/7473 [00:10<00:21, 237.27it/s] 31%|██████████████████████████████                                                                   | 2312/7473 [00:10<00:21, 236.21it/s] 31%|██████████████████████████████▎                                                                  | 2336/7473 [00:10<00:21, 236.84it/s] 32%|██████████████████████████████▋                                                                  | 2360/7473 [00:10<00:21, 236.81it/s] 32%|██████████████████████████████▉                                                                  | 2384/7473 [00:10<00:21, 237.04it/s] 32%|███████████████████████████████▎                                                                 | 2408/7473 [00:11<00:21, 237.39it/s] 33%|███████████████████████████████▌                                                                 | 2432/7473 [00:11<00:21, 238.12it/s] 33%|███████████████████████████████▉                                                                 | 2456/7473 [00:11<00:21, 238.32it/s] 33%|████████████████████████████████▏                                                                | 2480/7473 [00:11<00:20, 237.87it/s] 34%|████████████████████████████████▌                                                                | 2504/7473 [00:11<00:20, 237.99it/s] 34%|████████████████████████████████▊                                                                | 2528/7473 [00:11<00:23, 208.26it/s] 34%|█████████████████████████████████▏                                                               | 2552/7473 [00:11<00:22, 215.92it/s] 34%|█████████████████████████████████▍                                                               | 2577/7473 [00:11<00:21, 222.67it/s] 35%|█████████████████████████████████▊                                                               | 2601/7473 [00:11<00:21, 227.28it/s] 35%|██████████████████████████████████                                                               | 2626/7473 [00:11<00:20, 231.26it/s] 35%|██████████████████████████████████▍                                                              | 2651/7473 [00:12<00:20, 234.47it/s] 36%|██████████████████████████████████▋                                                              | 2676/7473 [00:12<00:20, 236.38it/s] 36%|███████████████████████████████████                                                              | 2701/7473 [00:12<00:20, 237.48it/s] 36%|███████████████████████████████████▍                                                             | 2726/7473 [00:12<00:19, 238.47it/s] 37%|███████████████████████████████████▋                                                             | 2750/7473 [00:12<00:19, 237.40it/s] 37%|████████████████████████████████████                                                             | 2775/7473 [00:12<00:19, 238.46it/s] 37%|████████████████████████████████████▎                                                            | 2800/7473 [00:12<00:19, 239.35it/s] 38%|████████████████████████████████████▋                                                            | 2824/7473 [00:12<00:19, 239.43it/s] 38%|████████████████████████████████████▉                                                            | 2848/7473 [00:12<00:19, 238.37it/s] 38%|█████████████████████████████████████▎                                                           | 2872/7473 [00:12<00:19, 237.74it/s] 39%|█████████████████████████████████████▌                                                           | 2896/7473 [00:13<00:19, 238.25it/s] 39%|█████████████████████████████████████▉                                                           | 2920/7473 [00:13<00:19, 238.23it/s] 39%|██████████████████████████████████████▏                                                          | 2944/7473 [00:13<00:18, 238.73it/s] 40%|██████████████████████████████████████▌                                                          | 2968/7473 [00:13<00:18, 238.91it/s] 40%|██████████████████████████████████████▊                                                          | 2992/7473 [00:13<00:18, 237.10it/s] 40%|███████████████████████████████████████▏                                                         | 3016/7473 [00:13<00:18, 237.43it/s] 41%|███████████████████████████████████████▍                                                         | 3040/7473 [00:13<00:18, 237.73it/s] 41%|███████████████████████████████████████▊                                                         | 3065/7473 [00:13<00:18, 238.59it/s] 41%|████████████████████████████████████████                                                         | 3090/7473 [00:13<00:18, 238.98it/s] 42%|████████████████████████████████████████▍                                                        | 3114/7473 [00:14<00:18, 238.48it/s] 42%|████████████████████████████████████████▋                                                        | 3138/7473 [00:14<00:18, 238.23it/s] 42%|█████████████████████████████████████████                                                        | 3162/7473 [00:14<00:18, 238.52it/s] 43%|█████████████████████████████████████████▎                                                       | 3186/7473 [00:14<00:17, 238.92it/s] 43%|█████████████████████████████████████████▋                                                       | 3210/7473 [00:14<00:17, 237.61it/s] 43%|█████████████████████████████████████████▉                                                       | 3234/7473 [00:14<00:17, 238.27it/s] 44%|██████████████████████████████████████████▎                                                      | 3258/7473 [00:14<00:17, 238.60it/s] 44%|██████████████████████████████████████████▌                                                      | 3283/7473 [00:14<00:17, 239.42it/s] 44%|██████████████████████████████████████████▉                                                      | 3308/7473 [00:14<00:17, 239.67it/s] 45%|███████████████████████████████████████████▏                                                     | 3332/7473 [00:14<00:17, 238.57it/s] 45%|███████████████████████████████████████████▌                                                     | 3356/7473 [00:15<00:17, 238.96it/s] 45%|███████████████████████████████████████████▊                                                     | 3380/7473 [00:15<00:17, 239.01it/s] 46%|████████████████████████████████████████████▏                                                    | 3404/7473 [00:15<00:17, 238.96it/s] 46%|████████████████████████████████████████████▍                                                    | 3428/7473 [00:15<00:17, 237.30it/s] 46%|████████████████████████████████████████████▊                                                    | 3452/7473 [00:15<00:16, 237.52it/s] 47%|█████████████████████████████████████████████                                                    | 3476/7473 [00:15<00:16, 238.14it/s] 47%|█████████████████████████████████████████████▍                                                   | 3501/7473 [00:15<00:16, 239.17it/s] 47%|█████████████████████████████████████████████▊                                                   | 3526/7473 [00:15<00:16, 239.60it/s] 48%|██████████████████████████████████████████████                                                   | 3550/7473 [00:15<00:16, 239.48it/s] 48%|██████████████████████████████████████████████▍                                                  | 3575/7473 [00:15<00:16, 240.12it/s] 48%|██████████████████████████████████████████████▋                                                  | 3600/7473 [00:16<00:16, 240.19it/s] 49%|███████████████████████████████████████████████                                                  | 3625/7473 [00:16<00:16, 239.93it/s] 49%|███████████████████████████████████████████████▎                                                 | 3649/7473 [00:16<00:16, 238.65it/s] 49%|███████████████████████████████████████████████▋                                                 | 3673/7473 [00:16<00:16, 236.47it/s] 49%|███████████████████████████████████████████████▉                                                 | 3697/7473 [00:16<00:15, 237.25it/s] 50%|████████████████████████████████████████████████▎                                                | 3721/7473 [00:16<00:15, 237.10it/s] 50%|████████████████████████████████████████████████▌                                                | 3745/7473 [00:16<00:15, 236.68it/s] 50%|████████████████████████████████████████████████▉                                                | 3769/7473 [00:16<00:15, 236.97it/s] 51%|█████████████████████████████████████████████████▏                                               | 3793/7473 [00:16<00:15, 237.10it/s] 51%|█████████████████████████████████████████████████▌                                               | 3817/7473 [00:16<00:15, 237.53it/s] 51%|█████████████████████████████████████████████████▊                                               | 3841/7473 [00:17<00:15, 237.02it/s] 52%|██████████████████████████████████████████████████▏                                              | 3865/7473 [00:17<00:15, 236.85it/s] 52%|██████████████████████████████████████████████████▍                                              | 3889/7473 [00:17<00:15, 234.92it/s] 52%|██████████████████████████████████████████████████▊                                              | 3913/7473 [00:17<00:15, 235.73it/s] 53%|███████████████████████████████████████████████████                                              | 3937/7473 [00:17<00:14, 236.14it/s] 53%|███████████████████████████████████████████████████▍                                             | 3961/7473 [00:17<00:14, 236.58it/s] 53%|███████████████████████████████████████████████████▋                                             | 3985/7473 [00:17<00:14, 236.67it/s] 54%|████████████████████████████████████████████████████                                             | 4009/7473 [00:17<00:14, 237.14it/s] 54%|████████████████████████████████████████████████████▎                                            | 4033/7473 [00:17<00:14, 237.19it/s] 54%|████████████████████████████████████████████████████▋                                            | 4057/7473 [00:17<00:14, 235.71it/s] 55%|████████████████████████████████████████████████████▉                                            | 4081/7473 [00:18<00:14, 235.76it/s] 55%|█████████████████████████████████████████████████████▎                                           | 4105/7473 [00:18<00:14, 235.63it/s] 55%|█████████████████████████████████████████████████████▌                                           | 4129/7473 [00:18<00:14, 233.53it/s] 56%|█████████████████████████████████████████████████████▉                                           | 4153/7473 [00:18<00:14, 234.13it/s] 56%|██████████████████████████████████████████████████████▏                                          | 4177/7473 [00:18<00:14, 235.21it/s] 56%|██████████████████████████████████████████████████████▌                                          | 4201/7473 [00:18<00:13, 235.79it/s] 57%|██████████████████████████████████████████████████████▊                                          | 4225/7473 [00:18<00:13, 235.61it/s] 57%|███████████████████████████████████████████████████████▏                                         | 4249/7473 [00:18<00:13, 235.86it/s] 57%|███████████████████████████████████████████████████████▍                                         | 4273/7473 [00:18<00:13, 235.47it/s] 58%|███████████████████████████████████████████████████████▊                                         | 4297/7473 [00:19<00:13, 235.54it/s] 58%|████████████████████████████████████████████████████████                                         | 4321/7473 [00:19<00:13, 236.19it/s] 58%|████████████████████████████████████████████████████████▍                                        | 4345/7473 [00:19<00:13, 235.60it/s] 58%|████████████████████████████████████████████████████████▋                                        | 4369/7473 [00:19<00:13, 235.80it/s] 59%|█████████████████████████████████████████████████████████                                        | 4393/7473 [00:19<00:13, 235.76it/s] 59%|█████████████████████████████████████████████████████████▎                                       | 4417/7473 [00:19<00:12, 236.15it/s] 59%|█████████████████████████████████████████████████████████▋                                       | 4441/7473 [00:19<00:12, 236.09it/s] 60%|█████████████████████████████████████████████████████████▉                                       | 4465/7473 [00:19<00:12, 234.20it/s] 60%|██████████████████████████████████████████████████████████▎                                      | 4489/7473 [00:19<00:12, 234.78it/s] 60%|██████████████████████████████████████████████████████████▌                                      | 4513/7473 [00:19<00:12, 235.22it/s] 61%|██████████████████████████████████████████████████████████▉                                      | 4537/7473 [00:20<00:12, 235.96it/s] 61%|███████████████████████████████████████████████████████████▏                                     | 4561/7473 [00:20<00:12, 236.96it/s] 61%|███████████████████████████████████████████████████████████▌                                     | 4585/7473 [00:20<00:12, 235.21it/s] 62%|███████████████████████████████████████████████████████████▊                                     | 4609/7473 [00:20<00:12, 235.57it/s] 62%|████████████████████████████████████████████████████████████▏                                    | 4633/7473 [00:20<00:12, 235.60it/s] 62%|████████████████████████████████████████████████████████████▍                                    | 4657/7473 [00:20<00:11, 236.06it/s] 63%|████████████████████████████████████████████████████████████▊                                    | 4681/7473 [00:20<00:11, 236.12it/s] 63%|█████████████████████████████████████████████████████████████                                    | 4705/7473 [00:20<00:11, 236.69it/s] 63%|█████████████████████████████████████████████████████████████▍                                   | 4730/7473 [00:20<00:11, 237.70it/s] 64%|█████████████████████████████████████████████████████████████▋                                   | 4755/7473 [00:20<00:11, 238.55it/s] 64%|██████████████████████████████████████████████████████████████                                   | 4779/7473 [00:21<00:11, 238.97it/s] 64%|██████████████████████████████████████████████████████████████▎                                  | 4803/7473 [00:21<00:11, 236.50it/s] 65%|██████████████████████████████████████████████████████████████▋                                  | 4828/7473 [00:21<00:11, 237.74it/s] 65%|██████████████████████████████████████████████████████████████▉                                  | 4852/7473 [00:21<00:11, 238.07it/s] 65%|███████████████████████████████████████████████████████████████▎                                 | 4876/7473 [00:21<00:10, 236.34it/s] 66%|███████████████████████████████████████████████████████████████▌                                 | 4901/7473 [00:21<00:10, 237.76it/s] 66%|███████████████████████████████████████████████████████████████▉                                 | 4925/7473 [00:21<00:10, 238.24it/s] 66%|████████████████████████████████████████████████████████████████▏                                | 4949/7473 [00:21<00:10, 238.50it/s] 67%|████████████████████████████████████████████████████████████████▌                                | 4973/7473 [00:21<00:10, 236.84it/s] 67%|████████████████████████████████████████████████████████████████▊                                | 4997/7473 [00:21<00:10, 237.42it/s] 67%|█████████████████████████████████████████████████████████████████▏                               | 5021/7473 [00:22<00:10, 236.81it/s] 68%|█████████████████████████████████████████████████████████████████▍                               | 5045/7473 [00:22<00:10, 237.74it/s] 68%|█████████████████████████████████████████████████████████████████▊                               | 5069/7473 [00:22<00:10, 238.01it/s] 68%|██████████████████████████████████████████████████████████████████                               | 5093/7473 [00:22<00:09, 238.45it/s] 68%|██████████████████████████████████████████████████████████████████▍                              | 5117/7473 [00:22<00:09, 238.33it/s] 69%|██████████████████████████████████████████████████████████████████▋                              | 5142/7473 [00:22<00:09, 238.89it/s] 69%|███████████████████████████████████████████████████████████████████                              | 5167/7473 [00:22<00:09, 239.39it/s] 69%|███████████████████████████████████████████████████████████████████▍                             | 5191/7473 [00:22<00:09, 239.23it/s] 70%|███████████████████████████████████████████████████████████████████▋                             | 5215/7473 [00:22<00:09, 239.20it/s] 70%|████████████████████████████████████████████████████████████████████                             | 5239/7473 [00:22<00:09, 238.95it/s] 70%|████████████████████████████████████████████████████████████████████▎                            | 5263/7473 [00:23<00:10, 213.93it/s] 71%|████████████████████████████████████████████████████████████████████▋                            | 5288/7473 [00:23<00:09, 221.45it/s] 71%|████████████████████████████████████████████████████████████████████▉                            | 5312/7473 [00:23<00:09, 226.47it/s] 71%|█████████████████████████████████████████████████████████████████████▎                           | 5336/7473 [00:23<00:09, 229.37it/s] 72%|█████████████████████████████████████████████████████████████████████▌                           | 5360/7473 [00:23<00:09, 231.89it/s] 72%|█████████████████████████████████████████████████████████████████████▉                           | 5384/7473 [00:23<00:08, 233.80it/s] 72%|██████████████████████████████████████████████████████████████████████▏                          | 5408/7473 [00:23<00:08, 235.59it/s] 73%|██████████████████████████████████████████████████████████████████████▌                          | 5433/7473 [00:23<00:08, 236.88it/s] 73%|██████████████████████████████████████████████████████████████████████▊                          | 5457/7473 [00:23<00:08, 237.37it/s] 73%|███████████████████████████████████████████████████████████████████████▏                         | 5481/7473 [00:24<00:12, 158.96it/s] 74%|███████████████████████████████████████████████████████████████████████▍                         | 5505/7473 [00:24<00:11, 176.67it/s] 74%|███████████████████████████████████████████████████████████████████████▊                         | 5530/7473 [00:24<00:10, 192.40it/s] 74%|████████████████████████████████████████████████████████████████████████                         | 5554/7473 [00:24<00:09, 204.21it/s] 75%|████████████████████████████████████████████████████████████████████████▍                        | 5578/7473 [00:24<00:08, 213.57it/s] 75%|████████████████████████████████████████████████████████████████████████▋                        | 5602/7473 [00:24<00:08, 220.27it/s] 75%|█████████████████████████████████████████████████████████████████████████                        | 5626/7473 [00:24<00:08, 224.11it/s] 76%|█████████████████████████████████████████████████████████████████████████▎                       | 5651/7473 [00:24<00:07, 228.85it/s] 76%|█████████████████████████████████████████████████████████████████████████▋                       | 5675/7473 [00:25<00:07, 229.06it/s] 76%|█████████████████████████████████████████████████████████████████████████▉                       | 5700/7473 [00:25<00:07, 232.36it/s] 77%|██████████████████████████████████████████████████████████████████████████▎                      | 5724/7473 [00:25<00:07, 234.00it/s] 77%|██████████████████████████████████████████████████████████████████████████▌                      | 5748/7473 [00:25<00:07, 235.61it/s] 77%|██████████████████████████████████████████████████████████████████████████▉                      | 5772/7473 [00:25<00:07, 236.82it/s] 78%|███████████████████████████████████████████████████████████████████████████▏                     | 5796/7473 [00:25<00:07, 237.34it/s] 78%|███████████████████████████████████████████████████████████████████████████▌                     | 5820/7473 [00:25<00:06, 236.94it/s] 78%|███████████████████████████████████████████████████████████████████████████▊                     | 5844/7473 [00:25<00:06, 237.30it/s] 79%|████████████████████████████████████████████████████████████████████████████▏                    | 5868/7473 [00:25<00:06, 237.73it/s] 79%|████████████████████████████████████████████████████████████████████████████▍                    | 5892/7473 [00:25<00:06, 238.33it/s] 79%|████████████████████████████████████████████████████████████████████████████▊                    | 5916/7473 [00:26<00:06, 236.36it/s] 79%|█████████████████████████████████████████████████████████████████████████████                    | 5940/7473 [00:26<00:06, 236.49it/s] 80%|█████████████████████████████████████████████████████████████████████████████▍                   | 5964/7473 [00:26<00:06, 236.39it/s] 80%|█████████████████████████████████████████████████████████████████████████████▋                   | 5988/7473 [00:26<00:06, 236.73it/s] 80%|██████████████████████████████████████████████████████████████████████████████                   | 6012/7473 [00:26<00:06, 237.45it/s] 81%|██████████████████████████████████████████████████████████████████████████████▎                  | 6036/7473 [00:26<00:06, 235.52it/s] 81%|██████████████████████████████████████████████████████████████████████████████▋                  | 6060/7473 [00:26<00:05, 236.71it/s] 81%|██████████████████████████████████████████████████████████████████████████████▉                  | 6085/7473 [00:26<00:05, 238.02it/s] 82%|███████████████████████████████████████████████████████████████████████████████▎                 | 6109/7473 [00:26<00:05, 238.39it/s] 82%|███████████████████████████████████████████████████████████████████████████████▌                 | 6133/7473 [00:26<00:05, 236.89it/s] 82%|███████████████████████████████████████████████████████████████████████████████▉                 | 6157/7473 [00:27<00:05, 237.79it/s] 83%|████████████████████████████████████████████████████████████████████████████████▏                | 6181/7473 [00:27<00:05, 238.02it/s] 83%|████████████████████████████████████████████████████████████████████████████████▌                | 6206/7473 [00:27<00:05, 238.62it/s] 83%|████████████████████████████████████████████████████████████████████████████████▊                | 6230/7473 [00:27<00:05, 237.75it/s] 84%|█████████████████████████████████████████████████████████████████████████████████▏               | 6255/7473 [00:27<00:05, 238.57it/s] 84%|█████████████████████████████████████████████████████████████████████████████████▌               | 6279/7473 [00:27<00:05, 238.65it/s] 84%|█████████████████████████████████████████████████████████████████████████████████▊               | 6303/7473 [00:27<00:04, 238.56it/s] 85%|██████████████████████████████████████████████████████████████████████████████████▏              | 6328/7473 [00:27<00:04, 239.19it/s] 85%|██████████████████████████████████████████████████████████████████████████████████▍              | 6352/7473 [00:27<00:04, 239.13it/s] 85%|██████████████████████████████████████████████████████████████████████████████████▊              | 6376/7473 [00:27<00:04, 236.72it/s] 86%|███████████████████████████████████████████████████████████████████████████████████              | 6400/7473 [00:28<00:04, 236.79it/s] 86%|███████████████████████████████████████████████████████████████████████████████████▍             | 6424/7473 [00:28<00:04, 237.23it/s] 86%|███████████████████████████████████████████████████████████████████████████████████▋             | 6448/7473 [00:28<00:04, 237.38it/s] 87%|████████████████████████████████████████████████████████████████████████████████████             | 6472/7473 [00:28<00:04, 237.69it/s] 87%|████████████████████████████████████████████████████████████████████████████████████▎            | 6496/7473 [00:28<00:04, 238.01it/s] 87%|████████████████████████████████████████████████████████████████████████████████████▋            | 6520/7473 [00:28<00:04, 237.83it/s] 88%|████████████████████████████████████████████████████████████████████████████████████▉            | 6544/7473 [00:28<00:03, 238.08it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████▎           | 6568/7473 [00:28<00:03, 238.25it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████▌           | 6592/7473 [00:28<00:03, 237.15it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████▉           | 6616/7473 [00:28<00:03, 237.89it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████▏          | 6640/7473 [00:29<00:03, 237.48it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████▍          | 6664/7473 [00:29<00:03, 237.25it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████▊          | 6688/7473 [00:29<00:03, 237.83it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████          | 6712/7473 [00:29<00:03, 238.34it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████▍         | 6736/7473 [00:29<00:03, 238.16it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████▋         | 6760/7473 [00:29<00:03, 237.63it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████         | 6784/7473 [00:29<00:02, 238.09it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████▎        | 6808/7473 [00:29<00:02, 238.16it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████▋        | 6832/7473 [00:29<00:02, 236.36it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████▉        | 6856/7473 [00:29<00:02, 236.98it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████▎       | 6880/7473 [00:30<00:02, 237.46it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████▋       | 6905/7473 [00:30<00:02, 238.33it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████▉       | 6929/7473 [00:30<00:02, 238.39it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████▎      | 6953/7473 [00:30<00:02, 237.34it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████▌      | 6977/7473 [00:30<00:02, 237.90it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████▊      | 7001/7473 [00:30<00:01, 237.89it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████▏     | 7025/7473 [00:30<00:01, 238.22it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████▍     | 7049/7473 [00:30<00:01, 236.11it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████▊     | 7073/7473 [00:30<00:01, 236.89it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████     | 7097/7473 [00:30<00:01, 237.73it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████▍    | 7121/7473 [00:31<00:01, 237.83it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████▋    | 7145/7473 [00:31<00:01, 237.74it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████    | 7169/7473 [00:31<00:01, 237.77it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████▎   | 7193/7473 [00:31<00:01, 238.31it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████▋   | 7217/7473 [00:31<00:01, 238.68it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████▉   | 7241/7473 [00:31<00:00, 238.62it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████▎  | 7265/7473 [00:31<00:00, 236.90it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████▌  | 7289/7473 [00:31<00:00, 237.63it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████▉  | 7313/7473 [00:31<00:00, 238.13it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████▏ | 7337/7473 [00:31<00:00, 238.18it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████▌ | 7361/7473 [00:32<00:00, 237.70it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████▊ | 7385/7473 [00:32<00:00, 238.22it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████▏| 7409/7473 [00:32<00:00, 238.41it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████▍| 7433/7473 [00:32<00:00, 238.60it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████▊| 7457/7473 [00:32<00:00, 238.38it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 7473/7473 [00:32<00:00, 229.45it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:04<00:09,  4.80s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:04<00:09,  4.95s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.44s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:11,  5.93s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:09<00:04,  4.88s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.28s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.50s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:12<00:06,  6.37s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.28s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.43s/it]
[2023-08-17 20:47:11,238] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.75s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.86s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.08s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.19s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:16<00:00,  5.44s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:16<00:00,  5.65s/it]
[2023-08-17 20:47:30,240] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-17 20:47:30,241] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-17 20:47:30,242] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-17 20:47:30,242] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-17 20:47:30,242] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-17 20:47:30,242] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-17 20:47:30,242] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-17 20:47:30,242] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-17 20:47:30,242] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-17 20:47:30,242] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-17 20:47:30,242] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-17 20:47:30,242] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fab9982e370>
[2023-08-17 20:47:30,242] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-17 20:47:30,243] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-17 20:47:30,243] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-17 20:47:30,243] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-17 20:47:30,243] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-17 20:47:30,243] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-17 20:47:30,243] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-17 20:47:30,243] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-17 20:47:30,243] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-17 20:47:30,243] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-17 20:47:30,243] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-17 20:47:30,243] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-17 20:47:30,243] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-17 20:47:30,243] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-17 20:47:30,243] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-17 20:47:30,243] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-17 20:47:30,243] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-17 20:47:30,243] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-17 20:47:30,243] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-17 20:47:30,243] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-17 20:47:30,243] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-17 20:47:30,243] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-17 20:47:30,243] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-17 20:47:30,243] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-17 20:47:30,243] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-17 20:47:30,243] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-17 20:47:30,243] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-17 20:47:30,243] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-17 20:47:30,243] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-17 20:47:30,243] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-17 20:47:30,243] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-17 20:47:30,243] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-17 20:47:30,243] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7fab9982e190>
[2023-08-17 20:47:30,243] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-17 20:47:30,243] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-17 20:47:30,243] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-17 20:47:30,244] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-17 20:47:30,244] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-17 20:47:30,244] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-17 20:47:30,244] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-17 20:47:30,244] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-17 20:47:30,244] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-17 20:47:30,244] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-17 20:47:30,244] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-17 20:47:30,244] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-17 20:47:30,244] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-17 20:47:30,244] [INFO] [config.py:1012:print]   train_batch_size ............. 8
[2023-08-17 20:47:30,244] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  2
[2023-08-17 20:47:30,244] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-17 20:47:30,244] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-17 20:47:30,244] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-17 20:47:30,244] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-17 20:47:30,244] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-17 20:47:30,244] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-17 20:47:30,244] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-17 20:47:30,244] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.6536478996276855 seconds
Loading extension module utils...
Time to load utils op: 0.6084325313568115 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating gsm8k :   0%|                                                                                           | 0/125 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following grade math question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: 1. The question is asking about a place where you would find plumbing that you couldn't use for water if you were thirsty.
2. Therefore, you can remove any choices that would potentially provide drinkable water using plumbing.
3. "Own home" and "water fountain" are definitely places where the plumbing could give drinkable water, so you can eliminate choices D and E.
4. A "wall" can potentially contain plumbing with drinkable water, such as pipes that lead to faucets or water fountains, so you can eliminate choice B.
5. A "show" could refer to several things, but without a specific context it's not likely to have plumbing, so let's keep choice C for now.
6. "Oil refineries" are places where crude oil is processed and refined. The plumbing in such places are used for the transportation of oil and various petroleum products, not water. So, they wouldn't be helpful if you were thirsty.
7. Comparing the two remaining choices, it's a lot more likely to find plumbing that you couldn't use for water in an oil refinery than at a show. Thus, the answer should be A: oil refineries.
So the final answer is A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Output: 1. The question states about a period when a person is just beginning work.
2. During the initial stages of work, a person is usually in the process of starting their tasks or activities and trying to build rhythm or momentum.
3. Hence, options A: working and E: momentum can be ruled out as the person is indeed working and starting to gain momentum.
4. Option B: resting, can also be ruled out as the person just started to work and not in resting period.
5. Similarly, option C: tiredness, can be ruled out as tiredness usually comes after some time of continuous work and not in the beginning.
6. That leaves us with option D: accomplishing. While a person can be in a stage of working and gaining momentum, they haven't accomplished or completed their tasks or goals at the beginning.
7. Therefore, the answer is D: accomplishing.
So the final answer is D: accomplishing

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Output: 1. The question is asking where one might find pens with a company logo.
2. This implies we are searching for a location where it's common to find promotional items or tools, such as pens, that are often marked with a company's branding or logo. 
3. Now we consider our options: office, on a pencil, writing sentences on paper, school, or a backpack. 
4. "On a pencil" and "writing sentences on paper" are not physical places and can be eliminated from the options.
5. "School" and "backpack" could potentially have pens but they are not specifically associated with company branded items, such as a company logo on the pens. 
6. However, offices are often places where companies distribute these types of branded items for their employees to use. 
7. So, considering all the provided options, the most probable place or location to find pens with a company logo would be in an "office" - making option A the correct answer.
So the final answer is A: office

Input: Billy called out to John, and listened for what? Choices:  A: silence B: response C: communication D: hanging up E: whisper
Output: 1. The question asks what Billy is listening for after he called out to John. 
2. When someone makes a call or calls out to someone else, typically they expect a response; otherwise, there would be no point in making the call.  
3. Therefore, amongst the options provided, Billy would be listening for a "response" from John. 
4. The other options - silence, communication, hanging up, whisper - do not specifically and directly allude to Billy's expectation following his call.
5. Thus, the correct answer is B: response.
So the final answer is B: response

Input: The lizard frightened the hiker, it's movements made what rustle? Choices:  A: garden B: trees C: books D: rocks E: bushes
Output: 1. The question asks about what or who caused a rustling noise. 
2. We know from the question that the "it" refers to the lizard and that its movements caused rustling.
3. Now, we need to consider each choice and determine if a lizard could rustle it.
4. Choice A is "garden". While lizards can be found in gardens, the entire garden wouldn't rustle from a lizard's movements. So, this answer is not correct.
5. Choice B is "trees". While lizards can climb trees, it's not very common for their actions to cause the entire tree to rustle. This answer is also not correct.
6. Choice C is "books". This makes no sense in the context as lizards aren't typically found in places with books, and wouldn't cause them to rustle.
7. Choice D is "rocks". Rocks don't rustle when something moves across them. So this cannot be the answer.
8. The final choice E is "bushes". Lizards are frequently found in bushes, and their movements could easily cause the bushes to rustle. 
9. Therefore, by the process of elimination and choosing the only answer that makes sense in context, we reach the correct conclusion that the answer is E: bushes.
So the final answer is E: bushes

Input: The man spent big money and time maintaining his lawn, it was part of keeping up with the Joneses where? Choices:  A: front yard B: suburbia C: neighborhood D: back yard E: golf course
Output: 1. "Keeping up with the Joneses" is a common phrase that refers to the comparison or competition between neighbors over lifestyle, wealth, or social status.
2. As the phrase was used in reference to the maintenance of the lawn, it may indicate that this sort of comparison or visible competition is occurring within a neighborhood or a living community.
3. The lawn, in this context, is likely part of a residential area where such comparisons are prevalent.
4. While A: front yard and D: back yard are specific parts of the residential property and not necessarily the wider context, and E: golf course is not a residential area but a recreational one.
5. It leaves us with B: suburbia and C: neighborhood, which are wider, residential areas where keeping up with the Joneses could potentially apply.
6. Suburbia is often stereotypically associated with homeowners taking pride in their properties and trying to outdo their neighbors, fitting the context of the question more.
7. Therefore, the man was keeping up with the Joneses in B: suburbia.
So the final answer is B: suburbia

Input:Natalia sold clips to 48 of her friends in April, and then she sold half as many clips in May. How many clips did Natalia sell altogether in April and May?
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o6-tcommonsenseqa-s1-rTrue
Loading extension module utils...
Time to load utils op: 0.6049728393554688 seconds
Loading extension module utils...
Time to load utils op: 0.6051263809204102 seconds
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Evaluating gsm8k :   0%|                                                                                           | 0/125 [00:03<?, ?it/s]
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 1628592 closing signal SIGTERM
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 1628589) of binary: /home/ylu130/.conda/envs/distllm/bin/python
Traceback (most recent call last):
  File "/home/ylu130/.conda/envs/distllm/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 345, in wrapper
    return f(*args, **kwargs)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 761, in main
    run(args)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 752, in run
    elastic_launch(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 131, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 245, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
/home/ylu130/workspace/in-context-generalization/inference.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2023-08-17_20:47:35
  host      : ia1.wse.jhu.edu
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 1628590)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2023-08-17_20:47:35
  host      : ia1.wse.jhu.edu
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 1628591)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2023-08-17_20:47:35
  host      : ia1.wse.jhu.edu
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 1628589)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name gsm8k --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name commonsenseqa --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 2 --data-dir /scratch/ylu130/processed_data/gsm8k/out-domain/o7-tcommonsenseqa-s1-rTrue --seed 1 --max-prompt-length 2048 --rationales --num-out-domain 7
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-17 20:47:39,295] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... gsm8k
  data_dir ..................... /scratch/ylu130/processed_data/gsm8k/out-domain/o7-tcommonsenseqa-s1-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 7
  out_domain_data_name ......... commonsenseqa
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o7-tcommonsenseqa-s1-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 2
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                                             | 0/7473 [00:00<?, ?it/s]  0%|▎                                                                                                  | 21/7473 [00:00<00:36, 204.04it/s]  1%|▌                                                                                                  | 42/7473 [00:00<00:36, 204.91it/s]  1%|▊                                                                                                  | 63/7473 [00:00<00:36, 205.35it/s]  1%|█                                                                                                  | 84/7473 [00:00<00:35, 205.84it/s]  1%|█▍                                                                                                | 105/7473 [00:00<00:35, 206.10it/s]  2%|█▋                                                                                                | 126/7473 [00:00<00:35, 206.43it/s]  2%|█▉                                                                                                | 147/7473 [00:00<00:35, 206.60it/s]  2%|██▏                                                                                               | 168/7473 [00:00<00:35, 204.18it/s]  3%|██▍                                                                                               | 189/7473 [00:00<00:35, 205.39it/s]  3%|██▊                                                                                               | 210/7473 [00:01<00:35, 206.59it/s]  3%|███                                                                                               | 231/7473 [00:01<00:34, 207.12it/s]  3%|███▎                                                                                              | 252/7473 [00:01<00:35, 204.91it/s]  4%|███▌                                                                                              | 273/7473 [00:01<00:34, 205.92it/s]  4%|███▊                                                                                              | 294/7473 [00:01<00:34, 206.51it/s]  4%|████▏                                                                                             | 315/7473 [00:01<00:34, 207.04it/s]  4%|████▍                                                                                             | 336/7473 [00:01<00:34, 207.39it/s]  5%|████▋                                                                                             | 357/7473 [00:01<00:34, 207.61it/s]  5%|████▉                                                                                             | 378/7473 [00:01<00:34, 205.13it/s]  5%|█████▏                                                                                            | 399/7473 [00:01<00:34, 205.41it/s]  6%|█████▌                                                                                            | 420/7473 [00:02<00:34, 205.83it/s]  6%|█████▊                                                                                            | 441/7473 [00:02<00:34, 206.20it/s]  6%|██████                                                                                            | 462/7473 [00:02<00:33, 206.37it/s]  6%|██████▎                                                                                           | 483/7473 [00:02<00:34, 204.90it/s]  7%|██████▌                                                                                           | 504/7473 [00:02<00:33, 205.37it/s]  7%|██████▉                                                                                           | 525/7473 [00:02<00:33, 206.47it/s]  7%|███████▏                                                                                          | 546/7473 [00:02<00:33, 206.89it/s]  8%|███████▍                                                                                          | 567/7473 [00:02<00:33, 207.34it/s]  8%|███████▋                                                                                          | 588/7473 [00:02<00:33, 207.13it/s]  8%|███████▉                                                                                          | 609/7473 [00:02<00:33, 206.84it/s]  8%|████████▎                                                                                         | 630/7473 [00:03<00:33, 206.48it/s]  9%|████████▌                                                                                         | 651/7473 [00:03<00:33, 206.40it/s]  9%|████████▊                                                                                         | 672/7473 [00:03<00:32, 206.68it/s]  9%|█████████                                                                                         | 693/7473 [00:03<00:32, 207.07it/s] 10%|█████████▎                                                                                        | 714/7473 [00:03<00:32, 205.92it/s] 10%|█████████▋                                                                                        | 735/7473 [00:03<00:32, 206.91it/s] 10%|█████████▉                                                                                        | 756/7473 [00:03<00:32, 207.38it/s] 10%|██████████▏                                                                                       | 777/7473 [00:03<00:32, 207.11it/s] 11%|██████████▍                                                                                       | 798/7473 [00:03<00:32, 207.39it/s] 11%|██████████▋                                                                                       | 819/7473 [00:03<00:32, 207.17it/s] 11%|███████████                                                                                       | 840/7473 [00:04<00:31, 207.44it/s] 12%|███████████▎                                                                                      | 861/7473 [00:04<00:31, 207.68it/s] 12%|███████████▌                                                                                      | 882/7473 [00:04<00:31, 207.75it/s] 12%|███████████▊                                                                                      | 903/7473 [00:04<00:31, 206.61it/s] 12%|████████████                                                                                      | 924/7473 [00:04<00:31, 206.84it/s] 13%|████████████▍                                                                                     | 945/7473 [00:04<00:31, 205.68it/s] 13%|████████████▋                                                                                     | 966/7473 [00:04<00:31, 206.56it/s] 13%|████████████▉                                                                                     | 987/7473 [00:04<00:31, 207.32it/s] 13%|█████████████                                                                                    | 1008/7473 [00:04<00:31, 207.17it/s] 14%|█████████████▎                                                                                   | 1029/7473 [00:04<00:31, 207.62it/s] 14%|█████████████▋                                                                                   | 1050/7473 [00:05<00:30, 207.50it/s] 14%|█████████████▉                                                                                   | 1071/7473 [00:05<00:30, 207.87it/s] 15%|██████████████▏                                                                                  | 1092/7473 [00:05<00:30, 207.07it/s] 15%|██████████████▍                                                                                  | 1113/7473 [00:05<00:30, 206.95it/s] 15%|██████████████▋                                                                                  | 1134/7473 [00:05<00:30, 206.96it/s] 15%|██████████████▉                                                                                  | 1155/7473 [00:05<00:30, 207.44it/s] 16%|███████████████▎                                                                                 | 1176/7473 [00:05<00:30, 203.76it/s] 16%|███████████████▌                                                                                 | 1197/7473 [00:05<00:30, 204.85it/s] 16%|███████████████▊                                                                                 | 1218/7473 [00:05<00:30, 205.35it/s] 17%|████████████████                                                                                 | 1239/7473 [00:06<00:30, 205.87it/s] 17%|████████████████▎                                                                                | 1260/7473 [00:06<00:30, 206.15it/s] 17%|████████████████▋                                                                                | 1281/7473 [00:06<00:29, 206.44it/s] 17%|████████████████▉                                                                                | 1302/7473 [00:06<00:29, 206.64it/s] 18%|█████████████████▏                                                                               | 1323/7473 [00:06<00:29, 206.75it/s] 18%|█████████████████▍                                                                               | 1344/7473 [00:06<00:29, 207.19it/s] 18%|█████████████████▋                                                                               | 1365/7473 [00:06<00:29, 207.34it/s] 19%|█████████████████▉                                                                               | 1386/7473 [00:06<00:29, 205.09it/s] 19%|██████████████████▎                                                                              | 1407/7473 [00:06<00:29, 205.68it/s] 19%|██████████████████▌                                                                              | 1428/7473 [00:06<00:29, 206.11it/s] 19%|██████████████████▊                                                                              | 1449/7473 [00:07<00:29, 204.62it/s] 20%|███████████████████                                                                              | 1470/7473 [00:07<00:29, 205.29it/s] 20%|███████████████████▎                                                                             | 1491/7473 [00:07<00:29, 205.65it/s] 20%|███████████████████▋                                                                             | 1512/7473 [00:07<00:28, 206.29it/s] 21%|███████████████████▉                                                                             | 1533/7473 [00:07<00:28, 206.69it/s] 21%|████████████████████▏                                                                            | 1554/7473 [00:07<00:28, 206.38it/s] 21%|████████████████████▍                                                                            | 1575/7473 [00:07<00:28, 204.23it/s] 21%|████████████████████▋                                                                            | 1596/7473 [00:07<00:28, 204.72it/s] 22%|████████████████████▉                                                                            | 1617/7473 [00:07<00:28, 203.53it/s] 22%|█████████████████████▎                                                                           | 1638/7473 [00:07<00:28, 204.81it/s] 22%|█████████████████████▌                                                                           | 1659/7473 [00:08<00:28, 205.34it/s] 22%|█████████████████████▊                                                                           | 1680/7473 [00:08<00:28, 206.33it/s] 23%|██████████████████████                                                                           | 1701/7473 [00:08<00:27, 206.61it/s] 23%|██████████████████████▎                                                                          | 1722/7473 [00:08<00:27, 206.65it/s] 23%|██████████████████████▌                                                                          | 1743/7473 [00:08<00:27, 206.73it/s] 24%|██████████████████████▉                                                                          | 1764/7473 [00:08<00:27, 207.20it/s] 24%|███████████████████████▏                                                                         | 1785/7473 [00:08<00:27, 207.22it/s] 24%|███████████████████████▍                                                                         | 1806/7473 [00:08<00:27, 207.29it/s] 24%|███████████████████████▋                                                                         | 1827/7473 [00:08<00:27, 206.65it/s] 25%|███████████████████████▉                                                                         | 1848/7473 [00:08<00:27, 204.41it/s] 25%|████████████████████████▎                                                                        | 1869/7473 [00:09<00:27, 205.42it/s] 25%|████████████████████████▌                                                                        | 1890/7473 [00:09<00:27, 206.07it/s] 26%|████████████████████████▊                                                                        | 1911/7473 [00:09<00:27, 205.53it/s] 26%|█████████████████████████                                                                        | 1932/7473 [00:09<00:26, 206.02it/s] 26%|█████████████████████████▎                                                                       | 1953/7473 [00:09<00:26, 206.54it/s] 26%|█████████████████████████▌                                                                       | 1974/7473 [00:09<00:26, 206.88it/s] 27%|█████████████████████████▉                                                                       | 1995/7473 [00:09<00:26, 206.97it/s] 27%|██████████████████████████▏                                                                      | 2016/7473 [00:09<00:26, 206.97it/s] 27%|██████████████████████████▍                                                                      | 2037/7473 [00:09<00:26, 207.18it/s] 28%|██████████████████████████▋                                                                      | 2058/7473 [00:09<00:26, 207.02it/s] 28%|██████████████████████████▉                                                                      | 2079/7473 [00:10<00:26, 204.61it/s] 28%|███████████████████████████▎                                                                     | 2100/7473 [00:10<00:26, 205.40it/s] 28%|███████████████████████████▌                                                                     | 2121/7473 [00:10<00:26, 205.56it/s] 29%|███████████████████████████▊                                                                     | 2142/7473 [00:10<00:25, 206.13it/s] 29%|████████████████████████████                                                                     | 2163/7473 [00:10<00:25, 206.50it/s] 29%|████████████████████████████▎                                                                    | 2184/7473 [00:10<00:25, 206.65it/s] 30%|████████████████████████████▌                                                                    | 2205/7473 [00:10<00:25, 207.03it/s] 30%|████████████████████████████▉                                                                    | 2226/7473 [00:10<00:25, 207.28it/s] 30%|█████████████████████████████▏                                                                   | 2247/7473 [00:10<00:25, 207.19it/s] 30%|█████████████████████████████▍                                                                   | 2268/7473 [00:10<00:25, 207.16it/s] 31%|█████████████████████████████▋                                                                   | 2289/7473 [00:11<00:25, 206.67it/s] 31%|█████████████████████████████▉                                                                   | 2310/7473 [00:11<00:25, 204.90it/s] 31%|██████████████████████████████▎                                                                  | 2331/7473 [00:11<00:25, 204.73it/s] 31%|██████████████████████████████▌                                                                  | 2352/7473 [00:11<00:24, 205.32it/s] 32%|██████████████████████████████▊                                                                  | 2373/7473 [00:11<00:24, 205.75it/s] 32%|███████████████████████████████                                                                  | 2394/7473 [00:11<00:24, 206.35it/s] 32%|███████████████████████████████▎                                                                 | 2415/7473 [00:11<00:24, 206.89it/s] 33%|███████████████████████████████▌                                                                 | 2436/7473 [00:11<00:24, 207.21it/s] 33%|███████████████████████████████▉                                                                 | 2457/7473 [00:11<00:24, 207.42it/s] 33%|████████████████████████████████▏                                                                | 2478/7473 [00:12<00:24, 207.29it/s] 33%|████████████████████████████████▍                                                                | 2499/7473 [00:12<00:24, 207.21it/s] 34%|████████████████████████████████▋                                                                | 2520/7473 [00:12<00:27, 180.13it/s] 34%|████████████████████████████████▉                                                                | 2541/7473 [00:12<00:26, 186.95it/s] 34%|█████████████████████████████████▎                                                               | 2562/7473 [00:12<00:25, 192.43it/s] 35%|█████████████████████████████████▌                                                               | 2583/7473 [00:12<00:24, 196.62it/s] 35%|█████████████████████████████████▊                                                               | 2604/7473 [00:12<00:24, 199.21it/s] 35%|██████████████████████████████████                                                               | 2625/7473 [00:12<00:24, 201.11it/s] 35%|██████████████████████████████████▎                                                              | 2646/7473 [00:12<00:23, 202.79it/s] 36%|██████████████████████████████████▌                                                              | 2667/7473 [00:12<00:23, 204.11it/s] 36%|██████████████████████████████████▉                                                              | 2688/7473 [00:13<00:23, 204.65it/s] 36%|███████████████████████████████████▏                                                             | 2709/7473 [00:13<00:23, 205.12it/s] 37%|███████████████████████████████████▍                                                             | 2730/7473 [00:13<00:23, 204.30it/s] 37%|███████████████████████████████████▋                                                             | 2751/7473 [00:13<00:23, 202.51it/s] 37%|███████████████████████████████████▉                                                             | 2772/7473 [00:13<00:23, 203.42it/s] 37%|████████████████████████████████████▎                                                            | 2793/7473 [00:13<00:22, 203.85it/s] 38%|████████████████████████████████████▌                                                            | 2814/7473 [00:13<00:22, 203.87it/s] 38%|████████████████████████████████████▊                                                            | 2835/7473 [00:13<00:22, 204.44it/s] 38%|█████████████████████████████████████                                                            | 2856/7473 [00:13<00:22, 204.71it/s] 38%|█████████████████████████████████████▎                                                           | 2877/7473 [00:14<00:22, 204.78it/s] 39%|█████████████████████████████████████▌                                                           | 2898/7473 [00:14<00:22, 205.31it/s] 39%|█████████████████████████████████████▉                                                           | 2919/7473 [00:14<00:22, 205.53it/s] 39%|██████████████████████████████████████▏                                                          | 2940/7473 [00:14<00:21, 206.14it/s] 40%|██████████████████████████████████████▍                                                          | 2961/7473 [00:14<00:21, 206.36it/s] 40%|██████████████████████████████████████▋                                                          | 2982/7473 [00:14<00:21, 204.62it/s] 40%|██████████████████████████████████████▉                                                          | 3003/7473 [00:14<00:21, 204.76it/s] 40%|███████████████████████████████████████▎                                                         | 3024/7473 [00:14<00:21, 204.81it/s] 41%|███████████████████████████████████████▌                                                         | 3045/7473 [00:14<00:21, 205.19it/s] 41%|███████████████████████████████████████▊                                                         | 3066/7473 [00:14<00:21, 205.66it/s] 41%|████████████████████████████████████████                                                         | 3087/7473 [00:15<00:21, 205.88it/s] 42%|████████████████████████████████████████▎                                                        | 3108/7473 [00:15<00:21, 205.83it/s] 42%|████████████████████████████████████████▌                                                        | 3129/7473 [00:15<00:21, 205.47it/s] 42%|████████████████████████████████████████▉                                                        | 3150/7473 [00:15<00:21, 205.08it/s] 42%|█████████████████████████████████████████▏                                                       | 3171/7473 [00:15<00:20, 205.27it/s] 43%|█████████████████████████████████████████▍                                                       | 3192/7473 [00:15<00:20, 205.25it/s] 43%|█████████████████████████████████████████▋                                                       | 3213/7473 [00:15<00:20, 204.09it/s] 43%|█████████████████████████████████████████▉                                                       | 3234/7473 [00:15<00:20, 204.73it/s] 44%|██████████████████████████████████████████▎                                                      | 3255/7473 [00:15<00:20, 205.24it/s] 44%|██████████████████████████████████████████▌                                                      | 3276/7473 [00:15<00:20, 205.53it/s] 44%|██████████████████████████████████████████▊                                                      | 3297/7473 [00:16<00:20, 205.78it/s] 44%|███████████████████████████████████████████                                                      | 3318/7473 [00:16<00:20, 206.00it/s] 45%|███████████████████████████████████████████▎                                                     | 3339/7473 [00:16<00:20, 205.34it/s] 45%|███████████████████████████████████████████▌                                                     | 3360/7473 [00:16<00:20, 205.65it/s] 45%|███████████████████████████████████████████▉                                                     | 3381/7473 [00:16<00:19, 205.64it/s] 46%|████████████████████████████████████████████▏                                                    | 3402/7473 [00:16<00:19, 205.78it/s] 46%|████████████████████████████████████████████▍                                                    | 3423/7473 [00:16<00:19, 205.80it/s] 46%|████████████████████████████████████████████▋                                                    | 3444/7473 [00:16<00:19, 204.41it/s] 46%|████████████████████████████████████████████▉                                                    | 3465/7473 [00:16<00:19, 204.63it/s] 47%|█████████████████████████████████████████████▏                                                   | 3486/7473 [00:16<00:19, 205.39it/s] 47%|█████████████████████████████████████████████▌                                                   | 3507/7473 [00:17<00:19, 205.69it/s] 47%|█████████████████████████████████████████████▊                                                   | 3528/7473 [00:17<00:19, 205.52it/s] 47%|██████████████████████████████████████████████                                                   | 3549/7473 [00:17<00:19, 205.72it/s] 48%|██████████████████████████████████████████████▎                                                  | 3570/7473 [00:17<00:18, 205.62it/s] 48%|██████████████████████████████████████████████▌                                                  | 3591/7473 [00:17<00:18, 206.08it/s] 48%|██████████████████████████████████████████████▉                                                  | 3612/7473 [00:17<00:18, 206.31it/s] 49%|███████████████████████████████████████████████▏                                                 | 3633/7473 [00:17<00:18, 206.46it/s] 49%|███████████████████████████████████████████████▍                                                 | 3654/7473 [00:17<00:18, 204.21it/s] 49%|███████████████████████████████████████████████▋                                                 | 3675/7473 [00:17<00:18, 204.50it/s] 49%|███████████████████████████████████████████████▉                                                 | 3696/7473 [00:17<00:18, 204.94it/s] 50%|████████████████████████████████████████████████▏                                                | 3717/7473 [00:18<00:18, 204.96it/s] 50%|████████████████████████████████████████████████▌                                                | 3738/7473 [00:18<00:18, 205.15it/s] 50%|████████████████████████████████████████████████▊                                                | 3759/7473 [00:18<00:18, 205.36it/s] 51%|█████████████████████████████████████████████████                                                | 3780/7473 [00:18<00:17, 205.71it/s] 51%|█████████████████████████████████████████████████▎                                               | 3801/7473 [00:18<00:17, 205.88it/s] 51%|█████████████████████████████████████████████████▌                                               | 3822/7473 [00:18<00:17, 206.22it/s] 51%|█████████████████████████████████████████████████▉                                               | 3843/7473 [00:18<00:17, 205.85it/s] 52%|██████████████████████████████████████████████████▏                                              | 3864/7473 [00:18<00:17, 203.63it/s] 52%|██████████████████████████████████████████████████▍                                              | 3885/7473 [00:18<00:17, 202.00it/s] 52%|██████████████████████████████████████████████████▋                                              | 3906/7473 [00:19<00:17, 203.32it/s] 53%|██████████████████████████████████████████████████▉                                              | 3927/7473 [00:19<00:17, 204.22it/s] 53%|███████████████████████████████████████████████████▏                                             | 3948/7473 [00:19<00:17, 204.89it/s] 53%|███████████████████████████████████████████████████▌                                             | 3969/7473 [00:19<00:17, 204.68it/s] 53%|███████████████████████████████████████████████████▊                                             | 3990/7473 [00:19<00:16, 205.26it/s] 54%|████████████████████████████████████████████████████                                             | 4011/7473 [00:19<00:16, 205.90it/s] 54%|████████████████████████████████████████████████████▎                                            | 4032/7473 [00:19<00:16, 205.86it/s] 54%|████████████████████████████████████████████████████▌                                            | 4053/7473 [00:19<00:16, 206.05it/s] 55%|████████████████████████████████████████████████████▉                                            | 4074/7473 [00:19<00:16, 205.95it/s] 55%|█████████████████████████████████████████████████████▏                                           | 4095/7473 [00:19<00:16, 206.31it/s] 55%|█████████████████████████████████████████████████████▍                                           | 4116/7473 [00:20<00:16, 203.98it/s] 55%|█████████████████████████████████████████████████████▋                                           | 4137/7473 [00:20<00:16, 202.63it/s] 56%|█████████████████████████████████████████████████████▉                                           | 4158/7473 [00:20<00:16, 202.47it/s] 56%|██████████████████████████████████████████████████████▏                                          | 4179/7473 [00:20<00:16, 203.54it/s] 56%|██████████████████████████████████████████████████████▌                                          | 4200/7473 [00:20<00:16, 204.52it/s] 56%|██████████████████████████████████████████████████████▊                                          | 4221/7473 [00:20<00:15, 204.46it/s] 57%|███████████████████████████████████████████████████████                                          | 4242/7473 [00:20<00:15, 205.13it/s] 57%|███████████████████████████████████████████████████████▎                                         | 4263/7473 [00:20<00:15, 205.24it/s] 57%|███████████████████████████████████████████████████████▌                                         | 4284/7473 [00:20<00:15, 204.94it/s] 58%|███████████████████████████████████████████████████████▉                                         | 4305/7473 [00:20<00:15, 205.22it/s] 58%|████████████████████████████████████████████████████████▏                                        | 4326/7473 [00:21<00:15, 205.70it/s] 58%|████████████████████████████████████████████████████████▍                                        | 4347/7473 [00:21<00:15, 204.54it/s] 58%|████████████████████████████████████████████████████████▋                                        | 4368/7473 [00:21<00:15, 204.68it/s] 59%|████████████████████████████████████████████████████████▉                                        | 4389/7473 [00:21<00:15, 204.06it/s] 59%|█████████████████████████████████████████████████████████▏                                       | 4410/7473 [00:21<00:14, 204.53it/s] 59%|█████████████████████████████████████████████████████████▌                                       | 4431/7473 [00:21<00:14, 204.72it/s] 60%|█████████████████████████████████████████████████████████▊                                       | 4452/7473 [00:21<00:14, 204.04it/s] 60%|██████████████████████████████████████████████████████████                                       | 4473/7473 [00:21<00:14, 204.62it/s] 60%|██████████████████████████████████████████████████████████▎                                      | 4494/7473 [00:21<00:14, 203.78it/s] 60%|██████████████████████████████████████████████████████████▌                                      | 4515/7473 [00:21<00:14, 204.13it/s] 61%|██████████████████████████████████████████████████████████▉                                      | 4536/7473 [00:22<00:14, 204.84it/s] 61%|███████████████████████████████████████████████████████████▏                                     | 4557/7473 [00:22<00:14, 205.11it/s] 61%|███████████████████████████████████████████████████████████▍                                     | 4578/7473 [00:22<00:14, 203.93it/s] 62%|███████████████████████████████████████████████████████████▋                                     | 4599/7473 [00:22<00:14, 204.26it/s] 62%|███████████████████████████████████████████████████████████▉                                     | 4620/7473 [00:22<00:13, 204.87it/s] 62%|████████████████████████████████████████████████████████████▏                                    | 4641/7473 [00:22<00:13, 204.94it/s] 62%|████████████████████████████████████████████████████████████▌                                    | 4662/7473 [00:22<00:13, 205.33it/s] 63%|████████████████████████████████████████████████████████████▊                                    | 4683/7473 [00:22<00:13, 205.34it/s] 63%|█████████████████████████████████████████████████████████████                                    | 4704/7473 [00:22<00:13, 205.41it/s] 63%|█████████████████████████████████████████████████████████████▎                                   | 4725/7473 [00:23<00:13, 205.51it/s] 64%|█████████████████████████████████████████████████████████████▌                                   | 4746/7473 [00:23<00:13, 205.59it/s] 64%|█████████████████████████████████████████████████████████████▉                                   | 4767/7473 [00:23<00:13, 205.92it/s] 64%|██████████████████████████████████████████████████████████████▏                                  | 4788/7473 [00:23<00:13, 203.87it/s] 64%|██████████████████████████████████████████████████████████████▍                                  | 4809/7473 [00:23<00:13, 202.52it/s] 65%|██████████████████████████████████████████████████████████████▋                                  | 4830/7473 [00:23<00:13, 201.84it/s] 65%|██████████████████████████████████████████████████████████████▉                                  | 4851/7473 [00:23<00:12, 203.01it/s] 65%|███████████████████████████████████████████████████████████████▏                                 | 4872/7473 [00:23<00:12, 203.15it/s] 65%|███████████████████████████████████████████████████████████████▌                                 | 4893/7473 [00:23<00:12, 204.20it/s] 66%|███████████████████████████████████████████████████████████████▊                                 | 4914/7473 [00:23<00:12, 204.92it/s] 66%|████████████████████████████████████████████████████████████████                                 | 4935/7473 [00:24<00:12, 205.04it/s] 66%|████████████████████████████████████████████████████████████████▎                                | 4956/7473 [00:24<00:12, 205.42it/s] 67%|████████████████████████████████████████████████████████████████▌                                | 4977/7473 [00:24<00:12, 205.20it/s] 67%|████████████████████████████████████████████████████████████████▊                                | 4998/7473 [00:24<00:12, 205.42it/s] 67%|█████████████████████████████████████████████████████████████████▏                               | 5019/7473 [00:24<00:12, 204.03it/s] 67%|█████████████████████████████████████████████████████████████████▍                               | 5040/7473 [00:24<00:11, 203.69it/s] 68%|█████████████████████████████████████████████████████████████████▋                               | 5061/7473 [00:24<00:11, 203.28it/s] 68%|█████████████████████████████████████████████████████████████████▉                               | 5082/7473 [00:24<00:11, 203.79it/s] 68%|██████████████████████████████████████████████████████████████████▏                              | 5103/7473 [00:24<00:11, 204.40it/s] 69%|██████████████████████████████████████████████████████████████████▌                              | 5124/7473 [00:24<00:11, 204.95it/s] 69%|██████████████████████████████████████████████████████████████████▊                              | 5145/7473 [00:25<00:11, 205.16it/s] 69%|███████████████████████████████████████████████████████████████████                              | 5166/7473 [00:25<00:11, 205.58it/s] 69%|███████████████████████████████████████████████████████████████████▎                             | 5187/7473 [00:25<00:11, 204.46it/s] 70%|███████████████████████████████████████████████████████████████████▌                             | 5208/7473 [00:25<00:11, 204.41it/s] 70%|███████████████████████████████████████████████████████████████████▊                             | 5229/7473 [00:25<00:10, 204.92it/s] 70%|████████████████████████████████████████████████████████████████████▏                            | 5250/7473 [00:25<00:12, 184.55it/s] 71%|████████████████████████████████████████████████████████████████████▍                            | 5271/7473 [00:25<00:11, 189.98it/s] 71%|████████████████████████████████████████████████████████████████████▋                            | 5292/7473 [00:25<00:11, 194.27it/s] 71%|████████████████████████████████████████████████████████████████████▉                            | 5313/7473 [00:25<00:10, 197.01it/s] 71%|█████████████████████████████████████████████████████████████████████▏                           | 5334/7473 [00:26<00:10, 199.10it/s] 72%|█████████████████████████████████████████████████████████████████████▌                           | 5355/7473 [00:26<00:10, 200.90it/s] 72%|█████████████████████████████████████████████████████████████████████▊                           | 5376/7473 [00:26<00:10, 202.36it/s] 72%|██████████████████████████████████████████████████████████████████████                           | 5397/7473 [00:26<00:10, 203.12it/s] 73%|██████████████████████████████████████████████████████████████████████▎                          | 5418/7473 [00:26<00:10, 203.84it/s] 73%|██████████████████████████████████████████████████████████████████████▌                          | 5439/7473 [00:26<00:09, 204.72it/s] 73%|██████████████████████████████████████████████████████████████████████▊                          | 5460/7473 [00:26<00:09, 204.88it/s] 73%|███████████████████████████████████████████████████████████████████████▏                         | 5481/7473 [00:26<00:14, 137.52it/s] 74%|███████████████████████████████████████████████████████████████████████▍                         | 5502/7473 [00:27<00:12, 151.80it/s] 74%|███████████████████████████████████████████████████████████████████████▋                         | 5523/7473 [00:27<00:11, 164.77it/s] 74%|███████████████████████████████████████████████████████████████████████▉                         | 5544/7473 [00:27<00:11, 175.03it/s] 74%|████████████████████████████████████████████████████████████████████████▏                        | 5565/7473 [00:27<00:10, 183.31it/s] 75%|████████████████████████████████████████████████████████████████████████▌                        | 5586/7473 [00:27<00:09, 189.06it/s] 75%|████████████████████████████████████████████████████████████████████████▊                        | 5607/7473 [00:27<00:09, 193.65it/s] 75%|█████████████████████████████████████████████████████████████████████████                        | 5628/7473 [00:27<00:09, 197.01it/s] 76%|█████████████████████████████████████████████████████████████████████████▎                       | 5649/7473 [00:27<00:09, 199.79it/s] 76%|█████████████████████████████████████████████████████████████████████████▌                       | 5670/7473 [00:27<00:08, 201.48it/s] 76%|█████████████████████████████████████████████████████████████████████████▊                       | 5691/7473 [00:27<00:08, 200.67it/s] 76%|██████████████████████████████████████████████████████████████████████████▏                      | 5712/7473 [00:28<00:08, 201.01it/s] 77%|██████████████████████████████████████████████████████████████████████████▍                      | 5733/7473 [00:28<00:08, 202.25it/s] 77%|██████████████████████████████████████████████████████████████████████████▋                      | 5754/7473 [00:28<00:08, 202.74it/s] 77%|██████████████████████████████████████████████████████████████████████████▉                      | 5775/7473 [00:28<00:08, 202.17it/s] 78%|███████████████████████████████████████████████████████████████████████████▏                     | 5796/7473 [00:28<00:08, 202.85it/s] 78%|███████████████████████████████████████████████████████████████████████████▌                     | 5817/7473 [00:28<00:08, 203.29it/s] 78%|███████████████████████████████████████████████████████████████████████████▊                     | 5838/7473 [00:28<00:08, 202.22it/s] 78%|████████████████████████████████████████████████████████████████████████████                     | 5859/7473 [00:28<00:07, 203.06it/s] 79%|████████████████████████████████████████████████████████████████████████████▎                    | 5880/7473 [00:28<00:07, 203.38it/s] 79%|████████████████████████████████████████████████████████████████████████████▌                    | 5901/7473 [00:28<00:07, 202.12it/s] 79%|████████████████████████████████████████████████████████████████████████████▊                    | 5922/7473 [00:29<00:07, 202.32it/s] 80%|█████████████████████████████████████████████████████████████████████████████▏                   | 5943/7473 [00:29<00:07, 203.11it/s] 80%|█████████████████████████████████████████████████████████████████████████████▍                   | 5964/7473 [00:29<00:07, 203.11it/s] 80%|█████████████████████████████████████████████████████████████████████████████▋                   | 5985/7473 [00:29<00:07, 203.04it/s] 80%|█████████████████████████████████████████████████████████████████████████████▉                   | 6006/7473 [00:29<00:07, 203.14it/s] 81%|██████████████████████████████████████████████████████████████████████████████▏                  | 6027/7473 [00:29<00:07, 203.56it/s] 81%|██████████████████████████████████████████████████████████████████████████████▌                  | 6048/7473 [00:29<00:06, 204.11it/s] 81%|██████████████████████████████████████████████████████████████████████████████▊                  | 6069/7473 [00:29<00:06, 204.81it/s] 81%|███████████████████████████████████████████████████████████████████████████████                  | 6090/7473 [00:29<00:06, 205.08it/s] 82%|███████████████████████████████████████████████████████████████████████████████▎                 | 6111/7473 [00:30<00:06, 205.28it/s] 82%|███████████████████████████████████████████████████████████████████████████████▌                 | 6132/7473 [00:30<00:06, 203.68it/s] 82%|███████████████████████████████████████████████████████████████████████████████▊                 | 6153/7473 [00:30<00:06, 203.95it/s] 83%|████████████████████████████████████████████████████████████████████████████████▏                | 6174/7473 [00:30<00:06, 202.91it/s] 83%|████████████████████████████████████████████████████████████████████████████████▍                | 6195/7473 [00:30<00:06, 203.62it/s] 83%|████████████████████████████████████████████████████████████████████████████████▋                | 6216/7473 [00:30<00:06, 202.22it/s] 83%|████████████████████████████████████████████████████████████████████████████████▉                | 6237/7473 [00:30<00:06, 202.36it/s] 84%|█████████████████████████████████████████████████████████████████████████████████▏               | 6258/7473 [00:30<00:05, 203.15it/s] 84%|█████████████████████████████████████████████████████████████████████████████████▌               | 6279/7473 [00:30<00:05, 203.97it/s] 84%|█████████████████████████████████████████████████████████████████████████████████▊               | 6300/7473 [00:30<00:05, 204.18it/s] 85%|██████████████████████████████████████████████████████████████████████████████████               | 6321/7473 [00:31<00:05, 204.63it/s] 85%|██████████████████████████████████████████████████████████████████████████████████▎              | 6342/7473 [00:31<00:05, 204.58it/s] 85%|██████████████████████████████████████████████████████████████████████████████████▌              | 6363/7473 [00:31<00:05, 203.41it/s] 85%|██████████████████████████████████████████████████████████████████████████████████▊              | 6384/7473 [00:31<00:05, 203.15it/s] 86%|███████████████████████████████████████████████████████████████████████████████████▏             | 6405/7473 [00:31<00:05, 203.09it/s] 86%|███████████████████████████████████████████████████████████████████████████████████▍             | 6426/7473 [00:31<00:05, 203.58it/s] 86%|███████████████████████████████████████████████████████████████████████████████████▋             | 6447/7473 [00:31<00:05, 204.09it/s] 87%|███████████████████████████████████████████████████████████████████████████████████▉             | 6468/7473 [00:31<00:04, 204.14it/s] 87%|████████████████████████████████████████████████████████████████████████████████████▏            | 6489/7473 [00:31<00:04, 204.27it/s] 87%|████████████████████████████████████████████████████████████████████████████████████▌            | 6510/7473 [00:31<00:04, 204.25it/s] 87%|████████████████████████████████████████████████████████████████████████████████████▊            | 6531/7473 [00:32<00:04, 203.12it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████            | 6552/7473 [00:32<00:04, 203.68it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████▎           | 6573/7473 [00:32<00:04, 203.98it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████▌           | 6594/7473 [00:32<00:04, 201.71it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████▊           | 6615/7473 [00:32<00:04, 202.59it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████▏          | 6636/7473 [00:32<00:04, 202.59it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████▍          | 6657/7473 [00:32<00:04, 203.07it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████▋          | 6678/7473 [00:32<00:03, 203.13it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████▉          | 6699/7473 [00:32<00:03, 203.77it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████▏         | 6720/7473 [00:33<00:03, 203.76it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████▍         | 6741/7473 [00:33<00:03, 204.27it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████▊         | 6762/7473 [00:33<00:03, 204.03it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████         | 6783/7473 [00:33<00:03, 204.10it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████▎        | 6804/7473 [00:33<00:03, 204.03it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████▌        | 6825/7473 [00:33<00:03, 201.73it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████▊        | 6846/7473 [00:33<00:03, 202.55it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████▏       | 6867/7473 [00:33<00:03, 201.50it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████▍       | 6888/7473 [00:33<00:02, 202.72it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████▋       | 6909/7473 [00:33<00:02, 203.30it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████▉       | 6930/7473 [00:34<00:02, 203.64it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████▏      | 6951/7473 [00:34<00:02, 203.95it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████▍      | 6972/7473 [00:34<00:02, 203.44it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████▊      | 6993/7473 [00:34<00:02, 203.34it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████      | 7014/7473 [00:34<00:02, 203.64it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████▎     | 7035/7473 [00:34<00:02, 202.21it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████▌     | 7056/7473 [00:34<00:02, 202.72it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████▊     | 7077/7473 [00:34<00:01, 203.14it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████▏    | 7098/7473 [00:34<00:01, 203.44it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████▍    | 7119/7473 [00:34<00:01, 202.84it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████▋    | 7140/7473 [00:35<00:01, 202.48it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████▉    | 7161/7473 [00:35<00:01, 202.95it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████▏   | 7182/7473 [00:35<00:01, 203.16it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████▍   | 7203/7473 [00:35<00:01, 203.64it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████▊   | 7224/7473 [00:35<00:01, 201.89it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████   | 7245/7473 [00:35<00:01, 202.76it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████▎  | 7266/7473 [00:35<00:01, 201.88it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████▌  | 7287/7473 [00:35<00:00, 202.43it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████▊  | 7308/7473 [00:35<00:00, 202.98it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████▏ | 7329/7473 [00:36<00:00, 203.35it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████▍ | 7350/7473 [00:36<00:00, 203.49it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████▋ | 7371/7473 [00:36<00:00, 203.60it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████▉ | 7392/7473 [00:36<00:00, 204.02it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████▏| 7413/7473 [00:36<00:00, 204.22it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████▍| 7434/7473 [00:36<00:00, 204.52it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████▊| 7455/7473 [00:36<00:00, 204.41it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 7473/7473 [00:36<00:00, 203.58it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.18s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:04<00:09,  4.88s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.49s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:11,  5.59s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:09<00:04,  4.86s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.33s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.34s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.36s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.27s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.43s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.75s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.89s/it]
[2023-08-17 20:49:08,487] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.72s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.92s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.80s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.97s/it]
[2023-08-17 20:49:17,245] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-17 20:49:17,246] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-17 20:49:17,246] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-17 20:49:17,246] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-17 20:49:17,246] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-17 20:49:17,246] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f77bf668370>
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f77bf668190>
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-17 20:49:17,247] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-17 20:49:17,248] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-17 20:49:17,248] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-17 20:49:17,248] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-17 20:49:17,248] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-17 20:49:17,248] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-17 20:49:17,248] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-17 20:49:17,248] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-17 20:49:17,248] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-17 20:49:17,248] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-17 20:49:17,248] [INFO] [config.py:1012:print]   train_batch_size ............. 8
[2023-08-17 20:49:17,248] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  2
[2023-08-17 20:49:17,248] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-17 20:49:17,248] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-17 20:49:17,248] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-17 20:49:17,248] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-17 20:49:17,248] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-17 20:49:17,248] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-17 20:49:17,248] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-17 20:49:17,248] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.6094563007354736 seconds
Loading extension module utils...
Time to load utils op: 0.5046486854553223 seconds
Loading extension module utils...
Time to load utils op: 0.6049699783325195 seconds
Loading extension module utils...
Time to load utils op: 0.7052130699157715 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating gsm8k :   0%|                                                                                           | 0/125 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following grade math question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: 1. The question asks where you could find plumbing that would not be of use if you are thirsty. 
2. This implies that we need to look for an option where water is not easily accessible or drinkable.
3. We know that oil refineries, while they do have plumbing systems, do not carry drinkable water as they are primarily used to refine and process oil.
4. The choices involve places where one might expect to find water: 
   -A wall in your home may have pipes running behind it, but you cannot just access it to drink.
   -A show may not have any kind of plumbing, it's more of a place to watch performance.
   -In your own home, you can access water through your faucets or taps.
   -A water fountain clearly has drinkable water.
5. Comparing all these choices, the plumbing in oil refineries would be of no use to us if we are thirsty.
6. Therefore, the answer is A: oil refineries.
So the final answer is A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Output: 1. The question asks what someone is not yet doing when they are beginning work.
2. The options are: A: working, B: resting, C: tiredness, D: accomplishing, E: momentum.
3. "Beginning work" means the person has started their tasks, so option A "working" cannot be correct.
4. As they are starting work, they are not "resting", option B, but this isn't something they should be doing at the beginning of their job anyway.
5. Option C "tiredness" is not an action a person can do. It's a state or feeling, so it also cannot be the answer.
6. Option E, "momentum", is not something one does, but rather a state or process one is in during work, therefore, it can't be the correct answer either.
7. This leaves us with option D: "accomplishing". When a person is just beginning their work, it means they are at the start of their tasks and hence, they haven't accomplished them yet.
8. Therefore, the answer is D: accomplishing.
So the final answer is D: accomplishing

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Output: 1. The question asks where one might find pens with a company logo.
2. This means we have to look for a location where a company's customized items, such as pens, may be found.
3. Choice A is 'office', which is a usual place where companies operate and they may use pens with their logo for branding or office use.
4. Choice B is 'on a pencil', which is not a place but rather another stationery item. Therefore, it is not a correct answer.
5. Choice C is 'write sentences on paper', which is not a location but an action you can perform with a pen. Hence, it cannot be the answer.
6. Choice D is'school', while possible, it is less likely that you would find a pen with a specific company's logo in a school environment.
7. Choice E is 'backpack', while pens are often carried in backpacks, it doesn't necessarily mean that they would have a company's logo.
8. Therefore, given the options, the most likely place to find pens with a company logo would be in an 'office'. Hence, the answer is A: office.
So the final answer is A: office

Input: Billy called out to John, and listened for what? Choices:  A: silence B: response C: communication D: hanging up E: whisper
Output: 1. The question specifies that Billy called out to John. 
2. The verb "called out" indicates that Billy is initiating a form of verbal communication, likely expecting something in return.
3. Listening implies Billy is waiting for something to respond to what he initially said or asked. 
4. Among the given choices,'silence' and 'hanging up' cannot be the answer because they do not match the implication of expected interaction.
5. 'Communication' and 'whisper' can be excluded too because they are not specific to the immediate return of interaction which is'response'. 
6. Therefore, the answer is B: response, as that is what someone would be expecting to hear after calling out to another person.
So the final answer is B: response

Input: The lizard frightened the hiker, it's movements made what rustle? Choices:  A: garden B: trees C: books D: rocks E: bushes
Output: 1. The question implies that the lizard's movements made some sort of noise. 
2. We need to identify which among the given options is possible to produce rustling sounds. 
3. Going through all the choices: garden, trees, books, rocks, and bushes. 
4. A garden, in general, can't make any specific noise, so option A: garden can't be the answer. 
5. Considering option B: trees, they might rustle, but a lizard is too small to make a tree rustle.
6. Option C: books can rustle when you flip pages, but a lizard can't flip book pages.
7. Option D: rocks, simply can't rustle. Lizards may climb and crawl over rocks, but rocks don't produce a rustling sound.
8. This leaves us with option E: bushes. Lizards can easily scamper through and around bushes, making them rustle. 
9. Hence, the answer is E: bushes.
So the final answer is E: bushes

Input: The man spent big money and time maintaining his lawn, it was part of keeping up with the Joneses where? Choices:  A: front yard B: suburbia C: neighborhood D: back yard E: golf course
Output: 1. The idiom "keeping up with the Joneses" refers to the pressure to own material goods or property comparable to those owned by your neighbors or peers in order to maintain a similar social status.
2. Therefore, the question is referring to a location where this kind of socio-economic comparison or rivalry is most likely to happen on a significant scale. 
3. A front yard or a backyard, being part of a single property, would not reflect the broader community or social group that the person is trying to keep up with.
4. A golf course, though a social setting, is not a residential area where people live and maintain their homes.
5. A neighborhood could potentially be the answer, but it doesn't specify the type of neighborhood. Not all neighborhoods have this kind of competitive social dynamic.
6. Hence, suburbia, which typically refers to middle to upper-middle-class residential areas where real estate and property maintenance hold significant social status, is the most appropriate choice. The man is trying to maintain his lawn to keep up with his suburban peers.
So the final answer is B: suburbia

Input: What would a human do if they want to get to a store that he or she can see? Choices:  A: cross road B: see around C: drink coffee D: dream dreams E: think critically
Output: 1. The question mentions that the person wants to get to the store and they can already see the store.
2. Assuming that the store is across the road as often is the case in urban areas, they need to cross the road to reach there.
3. Looking at the given options, only one among them directly helps to reach the store.
4. Options like drinking coffee or dreaming do not take the person closer to the store.
5. Based on visualizing our surroundings, humans most often have to cross roads to reach nearby locations.
6. Therefore, the option that makes the most sense in this context is option A: cross road.
So the final answer is A: cross road

Input:Natalia sold clips to 48 of her friends in April, and then she sold half as many clips in May. How many clips did Natalia sell altogether in April and May?
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o7-tcommonsenseqa-s1-rTrue
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Evaluating gsm8k :   0%|                                                                                           | 0/125 [00:02<?, ?it/s]
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 1630155 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 1630157 closing signal SIGTERM
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 1 (pid: 1630156) of binary: /home/ylu130/.conda/envs/distllm/bin/python
Traceback (most recent call last):
  File "/home/ylu130/.conda/envs/distllm/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 345, in wrapper
    return f(*args, **kwargs)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 761, in main
    run(args)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 752, in run
    elastic_launch(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 131, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 245, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
/home/ylu130/workspace/in-context-generalization/inference.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2023-08-17_20:49:22
  host      : ia1.wse.jhu.edu
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 1630158)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2023-08-17_20:49:22
  host      : ia1.wse.jhu.edu
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 1630156)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name gsm8k --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name commonsenseqa --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 2 --data-dir /scratch/ylu130/processed_data/gsm8k/out-domain/o8-tcommonsenseqa-s1-rTrue --seed 1 --max-prompt-length 2048 --rationales --num-out-domain 8
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-17 20:49:25,465] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... gsm8k
  data_dir ..................... /scratch/ylu130/processed_data/gsm8k/out-domain/o8-tcommonsenseqa-s1-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 8
  out_domain_data_name ......... commonsenseqa
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o8-tcommonsenseqa-s1-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 2
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                                             | 0/7473 [00:00<?, ?it/s]  0%|▏                                                                                                  | 11/7473 [00:00<01:13, 102.15it/s]  0%|▎                                                                                                  | 22/7473 [00:00<01:11, 104.82it/s]  0%|▍                                                                                                  | 33/7473 [00:00<01:10, 105.54it/s]  1%|▌                                                                                                  | 44/7473 [00:00<01:10, 106.05it/s]  1%|▋                                                                                                  | 55/7473 [00:00<01:09, 106.43it/s]  1%|▊                                                                                                  | 66/7473 [00:00<01:09, 106.65it/s]  1%|█                                                                                                  | 77/7473 [00:00<01:09, 106.84it/s]  1%|█▏                                                                                                 | 88/7473 [00:00<01:08, 107.08it/s]  1%|█▎                                                                                                 | 99/7473 [00:00<01:08, 107.16it/s]  1%|█▍                                                                                                | 110/7473 [00:01<01:08, 107.13it/s]  2%|█▌                                                                                                | 121/7473 [00:01<01:09, 105.97it/s]  2%|█▋                                                                                                | 132/7473 [00:01<01:09, 105.94it/s]  2%|█▉                                                                                                | 143/7473 [00:01<01:08, 106.27it/s]  2%|██                                                                                                | 154/7473 [00:01<01:08, 106.65it/s]  2%|██▏                                                                                               | 165/7473 [00:01<01:08, 106.82it/s]  2%|██▎                                                                                               | 176/7473 [00:01<01:08, 106.77it/s]  3%|██▍                                                                                               | 187/7473 [00:01<01:08, 106.99it/s]  3%|██▌                                                                                               | 198/7473 [00:01<01:07, 107.37it/s]  3%|██▋                                                                                               | 209/7473 [00:01<01:07, 107.58it/s]  3%|██▉                                                                                               | 220/7473 [00:02<01:07, 107.60it/s]  3%|███                                                                                               | 231/7473 [00:02<01:07, 107.69it/s]  3%|███▏                                                                                              | 242/7473 [00:02<01:07, 107.36it/s]  3%|███▎                                                                                              | 253/7473 [00:02<01:07, 106.40it/s]  4%|███▌                                                                                              | 270/7473 [00:02<00:58, 123.84it/s]  4%|███▊                                                                                              | 287/7473 [00:02<00:52, 136.19it/s]  4%|███▉                                                                                              | 304/7473 [00:02<00:49, 144.69it/s]  4%|████▏                                                                                             | 321/7473 [00:02<00:47, 150.87it/s]  5%|████▍                                                                                             | 338/7473 [00:02<00:46, 154.87it/s]  5%|████▋                                                                                             | 355/7473 [00:02<00:45, 157.90it/s]  5%|████▉                                                                                             | 372/7473 [00:03<00:44, 159.53it/s]  5%|█████                                                                                             | 389/7473 [00:03<00:43, 161.12it/s]  5%|█████▎                                                                                            | 406/7473 [00:03<00:43, 161.72it/s]  6%|█████▌                                                                                            | 423/7473 [00:03<00:43, 162.61it/s]  6%|█████▊                                                                                            | 440/7473 [00:03<00:43, 163.09it/s]  6%|█████▉                                                                                            | 457/7473 [00:03<00:42, 163.59it/s]  6%|██████▏                                                                                           | 474/7473 [00:03<00:42, 163.15it/s]  7%|██████▍                                                                                           | 491/7473 [00:03<00:43, 161.99it/s]  7%|██████▋                                                                                           | 508/7473 [00:03<00:42, 162.56it/s]  7%|██████▉                                                                                           | 525/7473 [00:04<00:42, 163.32it/s]  7%|███████                                                                                           | 542/7473 [00:04<00:42, 163.70it/s]  7%|███████▎                                                                                          | 559/7473 [00:04<00:42, 164.03it/s]  8%|███████▌                                                                                          | 576/7473 [00:04<00:42, 164.01it/s]  8%|███████▊                                                                                          | 593/7473 [00:04<00:41, 164.01it/s]  8%|███████▉                                                                                          | 610/7473 [00:04<00:41, 163.81it/s]  8%|████████▏                                                                                         | 627/7473 [00:04<00:41, 163.26it/s]  9%|████████▍                                                                                         | 644/7473 [00:04<00:41, 163.57it/s]  9%|████████▋                                                                                         | 661/7473 [00:04<00:41, 163.99it/s]  9%|████████▉                                                                                         | 678/7473 [00:04<00:41, 163.29it/s]  9%|█████████                                                                                         | 695/7473 [00:05<00:41, 163.74it/s] 10%|█████████▎                                                                                        | 712/7473 [00:05<00:41, 161.26it/s] 10%|█████████▌                                                                                        | 729/7473 [00:05<00:41, 161.61it/s] 10%|█████████▊                                                                                        | 746/7473 [00:05<00:41, 162.50it/s] 10%|██████████                                                                                        | 763/7473 [00:05<00:41, 163.02it/s] 10%|██████████▏                                                                                       | 780/7473 [00:05<00:40, 163.30it/s] 11%|██████████▍                                                                                       | 797/7473 [00:05<00:40, 163.53it/s] 11%|██████████▋                                                                                       | 814/7473 [00:05<00:40, 163.52it/s] 11%|██████████▉                                                                                       | 831/7473 [00:05<00:40, 163.59it/s] 11%|███████████                                                                                       | 848/7473 [00:06<00:41, 158.49it/s] 12%|███████████▎                                                                                      | 864/7473 [00:06<00:42, 157.25it/s] 12%|███████████▌                                                                                      | 880/7473 [00:06<00:43, 152.59it/s] 12%|███████████▊                                                                                      | 897/7473 [00:06<00:42, 155.27it/s] 12%|███████████▉                                                                                      | 913/7473 [00:06<00:42, 154.53it/s] 12%|████████████▏                                                                                     | 929/7473 [00:06<00:42, 153.69it/s] 13%|████████████▍                                                                                     | 945/7473 [00:06<00:42, 155.25it/s] 13%|████████████▌                                                                                     | 962/7473 [00:06<00:41, 158.10it/s] 13%|████████████▊                                                                                     | 979/7473 [00:06<00:40, 160.13it/s] 13%|█████████████                                                                                     | 996/7473 [00:06<00:40, 161.00it/s] 14%|█████████████▏                                                                                   | 1013/7473 [00:07<00:39, 161.90it/s] 14%|█████████████▎                                                                                   | 1030/7473 [00:07<00:39, 162.72it/s] 14%|█████████████▌                                                                                   | 1047/7473 [00:07<00:39, 163.24it/s] 14%|█████████████▊                                                                                   | 1064/7473 [00:07<00:39, 163.65it/s] 14%|██████████████                                                                                   | 1081/7473 [00:07<00:38, 164.01it/s] 15%|██████████████▎                                                                                  | 1098/7473 [00:07<00:38, 164.02it/s] 15%|██████████████▍                                                                                  | 1115/7473 [00:07<00:38, 163.50it/s] 15%|██████████████▋                                                                                  | 1132/7473 [00:07<00:38, 163.54it/s] 15%|██████████████▉                                                                                  | 1149/7473 [00:07<00:38, 164.12it/s] 16%|███████████████▏                                                                                 | 1166/7473 [00:08<00:38, 162.12it/s] 16%|███████████████▎                                                                                 | 1183/7473 [00:08<00:38, 162.75it/s] 16%|███████████████▌                                                                                 | 1200/7473 [00:08<00:38, 162.54it/s] 16%|███████████████▊                                                                                 | 1217/7473 [00:08<00:38, 162.09it/s] 17%|████████████████                                                                                 | 1234/7473 [00:08<00:40, 153.86it/s] 17%|████████████████▏                                                                                | 1251/7473 [00:08<00:39, 157.02it/s] 17%|████████████████▍                                                                                | 1267/7473 [00:08<00:39, 157.41it/s] 17%|████████████████▋                                                                                | 1283/7473 [00:08<00:40, 153.96it/s] 17%|████████████████▊                                                                                | 1300/7473 [00:08<00:39, 157.04it/s] 18%|█████████████████                                                                                | 1317/7473 [00:08<00:38, 159.45it/s] 18%|█████████████████▎                                                                               | 1334/7473 [00:09<00:38, 160.95it/s] 18%|█████████████████▌                                                                               | 1351/7473 [00:09<00:37, 162.04it/s] 18%|█████████████████▊                                                                               | 1368/7473 [00:09<00:37, 162.85it/s] 19%|█████████████████▉                                                                               | 1385/7473 [00:09<00:37, 161.62it/s] 19%|██████████████████▏                                                                              | 1402/7473 [00:09<00:37, 162.38it/s] 19%|██████████████████▍                                                                              | 1419/7473 [00:09<00:37, 163.03it/s] 19%|██████████████████▋                                                                              | 1436/7473 [00:09<00:36, 163.39it/s] 19%|██████████████████▊                                                                              | 1453/7473 [00:09<00:36, 163.52it/s] 20%|███████████████████                                                                              | 1470/7473 [00:09<00:36, 163.88it/s] 20%|███████████████████▎                                                                             | 1487/7473 [00:09<00:36, 164.16it/s] 20%|███████████████████▌                                                                             | 1504/7473 [00:10<00:36, 164.42it/s] 20%|███████████████████▋                                                                             | 1521/7473 [00:10<00:36, 164.72it/s] 21%|███████████████████▉                                                                             | 1538/7473 [00:10<00:36, 164.84it/s] 21%|████████████████████▏                                                                            | 1555/7473 [00:10<00:36, 164.18it/s] 21%|████████████████████▍                                                                            | 1572/7473 [00:10<00:35, 164.01it/s] 21%|████████████████████▋                                                                            | 1589/7473 [00:10<00:35, 163.96it/s] 21%|████████████████████▊                                                                            | 1606/7473 [00:10<00:35, 164.09it/s] 22%|█████████████████████                                                                            | 1623/7473 [00:10<00:35, 162.57it/s] 22%|█████████████████████▎                                                                           | 1640/7473 [00:10<00:35, 163.38it/s] 22%|█████████████████████▌                                                                           | 1657/7473 [00:11<00:35, 163.45it/s] 22%|█████████████████████▋                                                                           | 1674/7473 [00:11<00:35, 164.10it/s] 23%|█████████████████████▉                                                                           | 1691/7473 [00:11<00:35, 164.35it/s] 23%|██████████████████████▏                                                                          | 1708/7473 [00:11<00:35, 164.35it/s] 23%|██████████████████████▍                                                                          | 1725/7473 [00:11<00:34, 164.43it/s] 23%|██████████████████████▌                                                                          | 1742/7473 [00:11<00:34, 164.26it/s] 24%|██████████████████████▊                                                                          | 1759/7473 [00:11<00:34, 164.42it/s] 24%|███████████████████████                                                                          | 1776/7473 [00:11<00:34, 164.33it/s] 24%|███████████████████████▎                                                                         | 1793/7473 [00:11<00:34, 164.34it/s] 24%|███████████████████████▍                                                                         | 1810/7473 [00:11<00:34, 164.54it/s] 24%|███████████████████████▋                                                                         | 1827/7473 [00:12<00:34, 164.08it/s] 25%|███████████████████████▉                                                                         | 1844/7473 [00:12<00:34, 162.36it/s] 25%|████████████████████████▏                                                                        | 1861/7473 [00:12<00:34, 162.71it/s] 25%|████████████████████████▍                                                                        | 1878/7473 [00:12<00:34, 163.34it/s] 25%|████████████████████████▌                                                                        | 1895/7473 [00:12<00:34, 163.48it/s] 26%|████████████████████████▊                                                                        | 1912/7473 [00:12<00:34, 163.46it/s] 26%|█████████████████████████                                                                        | 1929/7473 [00:12<00:33, 163.42it/s] 26%|█████████████████████████▎                                                                       | 1946/7473 [00:12<00:33, 163.53it/s] 26%|█████████████████████████▍                                                                       | 1963/7473 [00:12<00:33, 163.87it/s] 26%|█████████████████████████▋                                                                       | 1980/7473 [00:13<00:33, 163.62it/s] 27%|█████████████████████████▉                                                                       | 1997/7473 [00:13<00:33, 163.23it/s] 27%|██████████████████████████▏                                                                      | 2014/7473 [00:13<00:33, 163.47it/s] 27%|██████████████████████████▎                                                                      | 2031/7473 [00:13<00:33, 163.76it/s] 27%|██████████████████████████▌                                                                      | 2048/7473 [00:13<00:33, 163.67it/s] 28%|██████████████████████████▊                                                                      | 2065/7473 [00:13<00:33, 162.27it/s] 28%|███████████████████████████                                                                      | 2082/7473 [00:13<00:33, 162.50it/s] 28%|███████████████████████████▏                                                                     | 2099/7473 [00:13<00:32, 162.97it/s] 28%|███████████████████████████▍                                                                     | 2116/7473 [00:13<00:32, 162.62it/s] 29%|███████████████████████████▋                                                                     | 2133/7473 [00:13<00:32, 162.62it/s] 29%|███████████████████████████▉                                                                     | 2150/7473 [00:14<00:32, 163.05it/s] 29%|████████████████████████████▏                                                                    | 2167/7473 [00:14<00:32, 163.19it/s] 29%|████████████████████████████▎                                                                    | 2184/7473 [00:14<00:32, 163.02it/s] 29%|████████████████████████████▌                                                                    | 2201/7473 [00:14<00:32, 163.37it/s] 30%|████████████████████████████▊                                                                    | 2218/7473 [00:14<00:32, 163.71it/s] 30%|█████████████████████████████                                                                    | 2235/7473 [00:14<00:32, 163.61it/s] 30%|█████████████████████████████▏                                                                   | 2252/7473 [00:14<00:31, 163.31it/s] 30%|█████████████████████████████▍                                                                   | 2269/7473 [00:14<00:32, 162.47it/s] 31%|█████████████████████████████▋                                                                   | 2286/7473 [00:14<00:31, 162.44it/s] 31%|█████████████████████████████▉                                                                   | 2303/7473 [00:14<00:32, 161.55it/s] 31%|██████████████████████████████                                                                   | 2320/7473 [00:15<00:31, 162.14it/s] 31%|██████████████████████████████▎                                                                  | 2337/7473 [00:15<00:31, 162.79it/s] 32%|██████████████████████████████▌                                                                  | 2354/7473 [00:15<00:31, 162.82it/s] 32%|██████████████████████████████▊                                                                  | 2371/7473 [00:15<00:31, 162.62it/s] 32%|██████████████████████████████▉                                                                  | 2388/7473 [00:15<00:31, 162.95it/s] 32%|███████████████████████████████▏                                                                 | 2405/7473 [00:15<00:31, 163.24it/s] 32%|███████████████████████████████▍                                                                 | 2422/7473 [00:15<00:30, 163.45it/s] 33%|███████████████████████████████▋                                                                 | 2439/7473 [00:15<00:30, 163.75it/s] 33%|███████████████████████████████▉                                                                 | 2456/7473 [00:15<00:30, 163.80it/s] 33%|████████████████████████████████                                                                 | 2473/7473 [00:16<00:30, 163.60it/s] 33%|████████████████████████████████▎                                                                | 2490/7473 [00:16<00:30, 163.08it/s] 34%|████████████████████████████████▌                                                                | 2507/7473 [00:16<00:30, 162.74it/s] 34%|████████████████████████████████▊                                                                | 2524/7473 [00:16<00:34, 143.04it/s] 34%|████████████████████████████████▉                                                                | 2540/7473 [00:16<00:33, 147.22it/s] 34%|█████████████████████████████████▏                                                               | 2557/7473 [00:16<00:32, 151.42it/s] 34%|█████████████████████████████████▍                                                               | 2574/7473 [00:16<00:31, 154.60it/s] 35%|█████████████████████████████████▋                                                               | 2591/7473 [00:16<00:31, 156.57it/s] 35%|█████████████████████████████████▊                                                               | 2608/7473 [00:16<00:30, 158.24it/s] 35%|██████████████████████████████████                                                               | 2625/7473 [00:17<00:30, 159.29it/s] 35%|██████████████████████████████████▎                                                              | 2642/7473 [00:17<00:30, 160.30it/s] 36%|██████████████████████████████████▌                                                              | 2659/7473 [00:17<00:29, 160.88it/s] 36%|██████████████████████████████████▋                                                              | 2676/7473 [00:17<00:29, 161.41it/s] 36%|██████████████████████████████████▉                                                              | 2693/7473 [00:17<00:29, 161.79it/s] 36%|███████████████████████████████████▏                                                             | 2710/7473 [00:17<00:29, 161.82it/s] 36%|███████████████████████████████████▍                                                             | 2727/7473 [00:17<00:29, 161.57it/s] 37%|███████████████████████████████████▌                                                             | 2744/7473 [00:17<00:29, 161.47it/s] 37%|███████████████████████████████████▊                                                             | 2761/7473 [00:17<00:29, 160.25it/s] 37%|████████████████████████████████████                                                             | 2778/7473 [00:17<00:29, 160.85it/s] 37%|████████████████████████████████████▎                                                            | 2795/7473 [00:18<00:28, 161.36it/s] 38%|████████████████████████████████████▍                                                            | 2812/7473 [00:18<00:29, 160.45it/s] 38%|████████████████████████████████████▋                                                            | 2829/7473 [00:18<00:28, 160.93it/s] 38%|████████████████████████████████████▉                                                            | 2846/7473 [00:18<00:28, 161.32it/s] 38%|█████████████████████████████████████▏                                                           | 2863/7473 [00:18<00:28, 161.04it/s] 39%|█████████████████████████████████████▍                                                           | 2880/7473 [00:18<00:28, 160.98it/s] 39%|█████████████████████████████████████▌                                                           | 2897/7473 [00:18<00:28, 161.57it/s] 39%|█████████████████████████████████████▊                                                           | 2914/7473 [00:18<00:28, 161.67it/s] 39%|██████████████████████████████████████                                                           | 2931/7473 [00:18<00:28, 162.16it/s] 39%|██████████████████████████████████████▎                                                          | 2948/7473 [00:19<00:27, 162.26it/s] 40%|██████████████████████████████████████▍                                                          | 2965/7473 [00:19<00:27, 162.29it/s] 40%|██████████████████████████████████████▋                                                          | 2982/7473 [00:19<00:27, 160.83it/s] 40%|██████████████████████████████████████▉                                                          | 2999/7473 [00:19<00:27, 160.74it/s] 40%|███████████████████████████████████████▏                                                         | 3016/7473 [00:19<00:27, 161.04it/s] 41%|███████████████████████████████████████▎                                                         | 3033/7473 [00:19<00:27, 161.24it/s] 41%|███████████████████████████████████████▌                                                         | 3050/7473 [00:19<00:27, 161.29it/s] 41%|███████████████████████████████████████▊                                                         | 3067/7473 [00:19<00:27, 161.73it/s] 41%|████████████████████████████████████████                                                         | 3084/7473 [00:19<00:27, 160.69it/s] 41%|████████████████████████████████████████▎                                                        | 3101/7473 [00:19<00:27, 160.95it/s] 42%|████████████████████████████████████████▍                                                        | 3118/7473 [00:20<00:27, 160.55it/s] 42%|████████████████████████████████████████▋                                                        | 3135/7473 [00:20<00:26, 160.73it/s] 42%|████████████████████████████████████████▉                                                        | 3152/7473 [00:20<00:26, 161.01it/s] 42%|█████████████████████████████████████████▏                                                       | 3169/7473 [00:20<00:26, 161.09it/s] 43%|█████████████████████████████████████████▎                                                       | 3186/7473 [00:20<00:26, 161.32it/s] 43%|█████████████████████████████████████████▌                                                       | 3203/7473 [00:20<00:26, 159.16it/s] 43%|█████████████████████████████████████████▊                                                       | 3220/7473 [00:20<00:26, 160.00it/s] 43%|██████████████████████████████████████████                                                       | 3237/7473 [00:20<00:26, 160.26it/s] 44%|██████████████████████████████████████████▏                                                      | 3254/7473 [00:20<00:26, 160.55it/s] 44%|██████████████████████████████████████████▍                                                      | 3271/7473 [00:21<00:26, 160.80it/s] 44%|██████████████████████████████████████████▋                                                      | 3288/7473 [00:21<00:25, 161.18it/s] 44%|██████████████████████████████████████████▉                                                      | 3305/7473 [00:21<00:25, 161.42it/s] 44%|███████████████████████████████████████████                                                      | 3322/7473 [00:21<00:25, 161.61it/s] 45%|███████████████████████████████████████████▎                                                     | 3339/7473 [00:21<00:25, 160.94it/s] 45%|███████████████████████████████████████████▌                                                     | 3356/7473 [00:21<00:25, 159.65it/s] 45%|███████████████████████████████████████████▊                                                     | 3373/7473 [00:21<00:25, 159.90it/s] 45%|████████████████████████████████████████████                                                     | 3390/7473 [00:21<00:25, 160.09it/s] 46%|████████████████████████████████████████████▏                                                    | 3407/7473 [00:21<00:25, 160.57it/s] 46%|████████████████████████████████████████████▍                                                    | 3424/7473 [00:21<00:25, 160.79it/s] 46%|████████████████████████████████████████████▋                                                    | 3441/7473 [00:22<00:25, 159.50it/s] 46%|████████████████████████████████████████████▉                                                    | 3458/7473 [00:22<00:25, 159.67it/s] 47%|█████████████████████████████████████████████                                                    | 3475/7473 [00:22<00:24, 160.24it/s] 47%|█████████████████████████████████████████████▎                                                   | 3492/7473 [00:22<00:24, 160.76it/s] 47%|█████████████████████████████████████████████▌                                                   | 3509/7473 [00:22<00:24, 160.94it/s] 47%|█████████████████████████████████████████████▊                                                   | 3526/7473 [00:22<00:24, 161.14it/s] 47%|█████████████████████████████████████████████▉                                                   | 3543/7473 [00:22<00:24, 161.23it/s] 48%|██████████████████████████████████████████████▏                                                  | 3560/7473 [00:22<00:24, 161.38it/s] 48%|██████████████████████████████████████████████▍                                                  | 3577/7473 [00:22<00:24, 161.58it/s] 48%|██████████████████████████████████████████████▋                                                  | 3594/7473 [00:23<00:24, 161.46it/s] 48%|██████████████████████████████████████████████▊                                                  | 3611/7473 [00:23<00:23, 161.32it/s] 49%|███████████████████████████████████████████████                                                  | 3628/7473 [00:23<00:23, 161.54it/s] 49%|███████████████████████████████████████████████▎                                                 | 3645/7473 [00:23<00:23, 161.29it/s] 49%|███████████████████████████████████████████████▌                                                 | 3662/7473 [00:23<00:23, 159.79it/s] 49%|███████████████████████████████████████████████▊                                                 | 3679/7473 [00:23<00:23, 160.21it/s] 49%|███████████████████████████████████████████████▉                                                 | 3696/7473 [00:23<00:23, 160.59it/s] 50%|████████████████████████████████████████████████▏                                                | 3713/7473 [00:23<00:23, 160.31it/s] 50%|████████████████████████████████████████████████▍                                                | 3730/7473 [00:23<00:23, 160.66it/s] 50%|████████████████████████████████████████████████▋                                                | 3747/7473 [00:23<00:23, 160.75it/s] 50%|████████████████████████████████████████████████▊                                                | 3764/7473 [00:24<00:23, 160.81it/s] 51%|█████████████████████████████████████████████████                                                | 3781/7473 [00:24<00:22, 161.05it/s] 51%|█████████████████████████████████████████████████▎                                               | 3798/7473 [00:24<00:22, 161.32it/s] 51%|█████████████████████████████████████████████████▌                                               | 3815/7473 [00:24<00:22, 161.35it/s] 51%|█████████████████████████████████████████████████▋                                               | 3832/7473 [00:24<00:22, 161.28it/s] 52%|█████████████████████████████████████████████████▉                                               | 3849/7473 [00:24<00:22, 161.17it/s] 52%|██████████████████████████████████████████████████▏                                              | 3866/7473 [00:24<00:22, 161.35it/s] 52%|██████████████████████████████████████████████████▍                                              | 3883/7473 [00:24<00:22, 159.48it/s] 52%|██████████████████████████████████████████████████▌                                              | 3900/7473 [00:24<00:22, 160.22it/s] 52%|██████████████████████████████████████████████████▊                                              | 3917/7473 [00:25<00:22, 160.64it/s] 53%|███████████████████████████████████████████████████                                              | 3934/7473 [00:25<00:21, 160.99it/s] 53%|███████████████████████████████████████████████████▎                                             | 3951/7473 [00:25<00:21, 161.17it/s] 53%|███████████████████████████████████████████████████▌                                             | 3968/7473 [00:25<00:21, 161.17it/s] 53%|███████████████████████████████████████████████████▋                                             | 3985/7473 [00:25<00:21, 161.23it/s] 54%|███████████████████████████████████████████████████▉                                             | 4002/7473 [00:25<00:21, 161.25it/s] 54%|████████████████████████████████████████████████████▏                                            | 4019/7473 [00:25<00:21, 161.31it/s] 54%|████████████████████████████████████████████████████▍                                            | 4036/7473 [00:25<00:21, 161.65it/s] 54%|████████████████████████████████████████████████████▌                                            | 4053/7473 [00:25<00:21, 161.89it/s] 54%|████████████████████████████████████████████████████▊                                            | 4070/7473 [00:25<00:21, 161.53it/s] 55%|█████████████████████████████████████████████████████                                            | 4087/7473 [00:26<00:20, 161.56it/s] 55%|█████████████████████████████████████████████████████▎                                           | 4104/7473 [00:26<00:20, 161.38it/s] 55%|█████████████████████████████████████████████████████▍                                           | 4121/7473 [00:26<00:20, 159.77it/s] 55%|█████████████████████████████████████████████████████▋                                           | 4138/7473 [00:26<00:20, 160.04it/s] 56%|█████████████████████████████████████████████████████▉                                           | 4155/7473 [00:26<00:20, 160.85it/s] 56%|██████████████████████████████████████████████████████▏                                          | 4172/7473 [00:26<00:20, 161.65it/s] 56%|██████████████████████████████████████████████████████▎                                          | 4189/7473 [00:26<00:20, 162.00it/s] 56%|██████████████████████████████████████████████████████▌                                          | 4206/7473 [00:26<00:20, 162.21it/s] 57%|██████████████████████████████████████████████████████▊                                          | 4223/7473 [00:26<00:20, 162.42it/s] 57%|███████████████████████████████████████████████████████                                          | 4240/7473 [00:27<00:19, 162.75it/s] 57%|███████████████████████████████████████████████████████▎                                         | 4257/7473 [00:27<00:19, 162.86it/s] 57%|███████████████████████████████████████████████████████▍                                         | 4274/7473 [00:27<00:19, 162.53it/s] 57%|███████████████████████████████████████████████████████▋                                         | 4291/7473 [00:27<00:19, 162.64it/s] 58%|███████████████████████████████████████████████████████▉                                         | 4308/7473 [00:27<00:19, 162.82it/s] 58%|████████████████████████████████████████████████████████▏                                        | 4325/7473 [00:27<00:19, 163.06it/s] 58%|████████████████████████████████████████████████████████▎                                        | 4342/7473 [00:27<00:19, 161.61it/s] 58%|████████████████████████████████████████████████████████▌                                        | 4359/7473 [00:27<00:19, 161.91it/s] 59%|████████████████████████████████████████████████████████▊                                        | 4376/7473 [00:27<00:19, 162.21it/s] 59%|█████████████████████████████████████████████████████████                                        | 4393/7473 [00:27<00:18, 162.32it/s] 59%|█████████████████████████████████████████████████████████▏                                       | 4410/7473 [00:28<00:18, 162.45it/s] 59%|█████████████████████████████████████████████████████████▍                                       | 4427/7473 [00:28<00:18, 162.33it/s] 59%|█████████████████████████████████████████████████████████▋                                       | 4444/7473 [00:28<00:18, 162.24it/s] 60%|█████████████████████████████████████████████████████████▉                                       | 4461/7473 [00:28<00:18, 162.24it/s] 60%|██████████████████████████████████████████████████████████                                       | 4478/7473 [00:28<00:18, 162.37it/s] 60%|██████████████████████████████████████████████████████████▎                                      | 4495/7473 [00:28<00:18, 162.33it/s] 60%|██████████████████████████████████████████████████████████▌                                      | 4512/7473 [00:28<00:18, 162.39it/s] 61%|██████████████████████████████████████████████████████████▊                                      | 4529/7473 [00:28<00:18, 162.51it/s] 61%|███████████████████████████████████████████████████████████                                      | 4546/7473 [00:28<00:17, 163.04it/s] 61%|███████████████████████████████████████████████████████████▏                                     | 4563/7473 [00:29<00:17, 161.84it/s] 61%|███████████████████████████████████████████████████████████▍                                     | 4580/7473 [00:29<00:17, 162.24it/s] 62%|███████████████████████████████████████████████████████████▋                                     | 4597/7473 [00:29<00:17, 162.25it/s] 62%|███████████████████████████████████████████████████████████▉                                     | 4614/7473 [00:29<00:17, 162.42it/s] 62%|████████████████████████████████████████████████████████████                                     | 4631/7473 [00:29<00:17, 162.40it/s] 62%|████████████████████████████████████████████████████████████▎                                    | 4648/7473 [00:29<00:17, 162.56it/s] 62%|████████████████████████████████████████████████████████████▌                                    | 4665/7473 [00:29<00:17, 162.58it/s] 63%|████████████████████████████████████████████████████████████▊                                    | 4682/7473 [00:29<00:17, 162.47it/s] 63%|████████████████████████████████████████████████████████████▉                                    | 4699/7473 [00:29<00:17, 162.61it/s] 63%|█████████████████████████████████████████████████████████████▏                                   | 4716/7473 [00:29<00:16, 162.40it/s] 63%|█████████████████████████████████████████████████████████████▍                                   | 4733/7473 [00:30<00:16, 162.77it/s] 64%|█████████████████████████████████████████████████████████████▋                                   | 4750/7473 [00:30<00:16, 162.83it/s] 64%|█████████████████████████████████████████████████████████████▉                                   | 4767/7473 [00:30<00:16, 163.08it/s] 64%|██████████████████████████████████████████████████████████████                                   | 4784/7473 [00:30<00:16, 163.16it/s] 64%|██████████████████████████████████████████████████████████████▎                                  | 4801/7473 [00:30<00:16, 161.34it/s] 64%|██████████████████████████████████████████████████████████████▌                                  | 4818/7473 [00:30<00:16, 161.81it/s] 65%|██████████████████████████████████████████████████████████████▊                                  | 4835/7473 [00:30<00:16, 162.31it/s] 65%|██████████████████████████████████████████████████████████████▉                                  | 4852/7473 [00:30<00:16, 162.27it/s] 65%|███████████████████████████████████████████████████████████████▏                                 | 4869/7473 [00:30<00:16, 162.28it/s] 65%|███████████████████████████████████████████████████████████████▍                                 | 4886/7473 [00:31<00:15, 162.60it/s] 66%|███████████████████████████████████████████████████████████████▋                                 | 4903/7473 [00:31<00:15, 163.05it/s] 66%|███████████████████████████████████████████████████████████████▊                                 | 4920/7473 [00:31<00:15, 162.98it/s] 66%|████████████████████████████████████████████████████████████████                                 | 4937/7473 [00:31<00:15, 162.83it/s] 66%|████████████████████████████████████████████████████████████████▎                                | 4954/7473 [00:31<00:15, 163.08it/s] 67%|████████████████████████████████████████████████████████████████▌                                | 4971/7473 [00:31<00:15, 162.76it/s] 67%|████████████████████████████████████████████████████████████████▋                                | 4988/7473 [00:31<00:15, 162.75it/s] 67%|████████████████████████████████████████████████████████████████▉                                | 5005/7473 [00:31<00:15, 162.83it/s] 67%|█████████████████████████████████████████████████████████████████▏                               | 5022/7473 [00:31<00:15, 161.52it/s] 67%|█████████████████████████████████████████████████████████████████▍                               | 5039/7473 [00:31<00:15, 162.00it/s] 68%|█████████████████████████████████████████████████████████████████▋                               | 5056/7473 [00:32<00:14, 162.12it/s] 68%|█████████████████████████████████████████████████████████████████▊                               | 5073/7473 [00:32<00:14, 162.56it/s] 68%|██████████████████████████████████████████████████████████████████                               | 5090/7473 [00:32<00:14, 162.71it/s] 68%|██████████████████████████████████████████████████████████████████▎                              | 5107/7473 [00:32<00:14, 162.52it/s] 69%|██████████████████████████████████████████████████████████████████▌                              | 5124/7473 [00:32<00:14, 162.79it/s] 69%|██████████████████████████████████████████████████████████████████▋                              | 5141/7473 [00:32<00:14, 162.77it/s] 69%|██████████████████████████████████████████████████████████████████▉                              | 5158/7473 [00:32<00:14, 163.00it/s] 69%|███████████████████████████████████████████████████████████████████▏                             | 5175/7473 [00:32<00:14, 163.38it/s] 69%|███████████████████████████████████████████████████████████████████▍                             | 5192/7473 [00:32<00:13, 163.28it/s] 70%|███████████████████████████████████████████████████████████████████▌                             | 5209/7473 [00:33<00:13, 163.32it/s] 70%|███████████████████████████████████████████████████████████████████▊                             | 5226/7473 [00:33<00:13, 163.33it/s] 70%|████████████████████████████████████████████████████████████████████                             | 5243/7473 [00:33<00:15, 144.24it/s] 70%|████████████████████████████████████████████████████████████████████▎                            | 5260/7473 [00:33<00:14, 149.04it/s] 71%|████████████████████████████████████████████████████████████████████▍                            | 5277/7473 [00:33<00:14, 153.22it/s] 71%|████████████████████████████████████████████████████████████████████▋                            | 5294/7473 [00:33<00:13, 156.07it/s] 71%|████████████████████████████████████████████████████████████████████▉                            | 5311/7473 [00:33<00:13, 158.16it/s] 71%|█████████████████████████████████████████████████████████████████████▏                           | 5328/7473 [00:33<00:13, 159.48it/s] 72%|█████████████████████████████████████████████████████████████████████▍                           | 5345/7473 [00:33<00:13, 160.63it/s] 72%|█████████████████████████████████████████████████████████████████████▌                           | 5362/7473 [00:33<00:13, 160.89it/s] 72%|█████████████████████████████████████████████████████████████████████▊                           | 5379/7473 [00:34<00:12, 161.61it/s] 72%|██████████████████████████████████████████████████████████████████████                           | 5396/7473 [00:34<00:12, 162.06it/s] 72%|██████████████████████████████████████████████████████████████████████▎                          | 5413/7473 [00:34<00:12, 162.37it/s] 73%|██████████████████████████████████████████████████████████████████████▍                          | 5430/7473 [00:34<00:12, 162.84it/s] 73%|██████████████████████████████████████████████████████████████████████▋                          | 5447/7473 [00:34<00:12, 163.00it/s] 73%|██████████████████████████████████████████████████████████████████████▉                          | 5464/7473 [00:34<00:12, 162.91it/s] 73%|███████████████████████████████████████████████████████████████████████▏                         | 5481/7473 [00:34<00:19, 102.43it/s] 74%|███████████████████████████████████████████████████████████████████████▎                         | 5498/7473 [00:35<00:17, 115.08it/s] 74%|███████████████████████████████████████████████████████████████████████▌                         | 5515/7473 [00:35<00:15, 126.10it/s] 74%|███████████████████████████████████████████████████████████████████████▊                         | 5532/7473 [00:35<00:14, 135.19it/s] 74%|████████████████████████████████████████████████████████████████████████                         | 5549/7473 [00:35<00:13, 142.50it/s] 74%|████████████████████████████████████████████████████████████████████████▏                        | 5566/7473 [00:35<00:12, 148.27it/s] 75%|████████████████████████████████████████████████████████████████████████▍                        | 5583/7473 [00:35<00:12, 152.22it/s] 75%|████████████████████████████████████████████████████████████████████████▋                        | 5600/7473 [00:35<00:12, 154.89it/s] 75%|████████████████████████████████████████████████████████████████████████▉                        | 5617/7473 [00:35<00:11, 157.36it/s] 75%|█████████████████████████████████████████████████████████████████████████▏                       | 5634/7473 [00:35<00:11, 158.93it/s] 76%|█████████████████████████████████████████████████████████████████████████▎                       | 5651/7473 [00:35<00:11, 160.18it/s] 76%|█████████████████████████████████████████████████████████████████████████▌                       | 5668/7473 [00:36<00:11, 161.08it/s] 76%|█████████████████████████████████████████████████████████████████████████▊                       | 5685/7473 [00:36<00:11, 160.25it/s] 76%|██████████████████████████████████████████████████████████████████████████                       | 5702/7473 [00:36<00:10, 161.06it/s] 77%|██████████████████████████████████████████████████████████████████████████▏                      | 5719/7473 [00:36<00:10, 161.28it/s] 77%|██████████████████████████████████████████████████████████████████████████▍                      | 5736/7473 [00:36<00:10, 161.79it/s] 77%|██████████████████████████████████████████████████████████████████████████▋                      | 5753/7473 [00:36<00:10, 162.11it/s] 77%|██████████████████████████████████████████████████████████████████████████▉                      | 5770/7473 [00:36<00:10, 162.33it/s] 77%|███████████████████████████████████████████████████████████████████████████                      | 5787/7473 [00:36<00:10, 162.53it/s] 78%|███████████████████████████████████████████████████████████████████████████▎                     | 5804/7473 [00:36<00:10, 162.80it/s] 78%|███████████████████████████████████████████████████████████████████████████▌                     | 5821/7473 [00:37<00:10, 161.39it/s] 78%|███████████████████████████████████████████████████████████████████████████▊                     | 5838/7473 [00:37<00:10, 161.70it/s] 78%|███████████████████████████████████████████████████████████████████████████▉                     | 5855/7473 [00:37<00:09, 162.18it/s] 79%|████████████████████████████████████████████████████████████████████████████▏                    | 5872/7473 [00:37<00:09, 162.11it/s] 79%|████████████████████████████████████████████████████████████████████████████▍                    | 5889/7473 [00:37<00:09, 162.38it/s] 79%|████████████████████████████████████████████████████████████████████████████▋                    | 5906/7473 [00:37<00:09, 160.96it/s] 79%|████████████████████████████████████████████████████████████████████████████▉                    | 5923/7473 [00:37<00:09, 161.19it/s] 79%|█████████████████████████████████████████████████████████████████████████████                    | 5940/7473 [00:37<00:09, 161.60it/s] 80%|█████████████████████████████████████████████████████████████████████████████▎                   | 5957/7473 [00:37<00:09, 161.76it/s] 80%|█████████████████████████████████████████████████████████████████████████████▌                   | 5974/7473 [00:37<00:09, 161.97it/s] 80%|█████████████████████████████████████████████████████████████████████████████▊                   | 5991/7473 [00:38<00:09, 162.35it/s] 80%|█████████████████████████████████████████████████████████████████████████████▉                   | 6008/7473 [00:38<00:09, 162.43it/s] 81%|██████████████████████████████████████████████████████████████████████████████▏                  | 6025/7473 [00:38<00:08, 162.43it/s] 81%|██████████████████████████████████████████████████████████████████████████████▍                  | 6042/7473 [00:38<00:08, 162.71it/s] 81%|██████████████████████████████████████████████████████████████████████████████▋                  | 6059/7473 [00:38<00:08, 162.97it/s] 81%|██████████████████████████████████████████████████████████████████████████████▊                  | 6076/7473 [00:38<00:08, 163.04it/s] 82%|███████████████████████████████████████████████████████████████████████████████                  | 6093/7473 [00:38<00:08, 162.70it/s] 82%|███████████████████████████████████████████████████████████████████████████████▎                 | 6110/7473 [00:38<00:08, 162.91it/s] 82%|███████████████████████████████████████████████████████████████████████████████▌                 | 6127/7473 [00:38<00:08, 162.98it/s] 82%|███████████████████████████████████████████████████████████████████████████████▋                 | 6144/7473 [00:39<00:08, 161.49it/s] 82%|███████████████████████████████████████████████████████████████████████████████▉                 | 6161/7473 [00:39<00:08, 161.99it/s] 83%|████████████████████████████████████████████████████████████████████████████████▏                | 6178/7473 [00:39<00:08, 161.41it/s] 83%|████████████████████████████████████████████████████████████████████████████████▍                | 6195/7473 [00:39<00:07, 162.00it/s] 83%|████████████████████████████████████████████████████████████████████████████████▋                | 6212/7473 [00:39<00:07, 162.29it/s] 83%|████████████████████████████████████████████████████████████████████████████████▊                | 6229/7473 [00:39<00:07, 162.09it/s] 84%|█████████████████████████████████████████████████████████████████████████████████                | 6246/7473 [00:39<00:07, 162.46it/s] 84%|█████████████████████████████████████████████████████████████████████████████████▎               | 6263/7473 [00:39<00:07, 162.60it/s] 84%|█████████████████████████████████████████████████████████████████████████████████▌               | 6280/7473 [00:39<00:07, 162.91it/s] 84%|█████████████████████████████████████████████████████████████████████████████████▋               | 6297/7473 [00:39<00:07, 162.69it/s] 84%|█████████████████████████████████████████████████████████████████████████████████▉               | 6314/7473 [00:40<00:07, 163.08it/s] 85%|██████████████████████████████████████████████████████████████████████████████████▏              | 6331/7473 [00:40<00:07, 163.08it/s] 85%|██████████████████████████████████████████████████████████████████████████████████▍              | 6348/7473 [00:40<00:06, 163.13it/s] 85%|██████████████████████████████████████████████████████████████████████████████████▌              | 6365/7473 [00:40<00:06, 161.12it/s] 85%|██████████████████████████████████████████████████████████████████████████████████▊              | 6382/7473 [00:40<00:06, 161.15it/s] 86%|███████████████████████████████████████████████████████████████████████████████████              | 6399/7473 [00:40<00:06, 161.55it/s] 86%|███████████████████████████████████████████████████████████████████████████████████▎             | 6416/7473 [00:40<00:06, 161.93it/s] 86%|███████████████████████████████████████████████████████████████████████████████████▌             | 6433/7473 [00:40<00:06, 162.04it/s] 86%|███████████████████████████████████████████████████████████████████████████████████▋             | 6450/7473 [00:40<00:06, 162.21it/s] 87%|███████████████████████████████████████████████████████████████████████████████████▉             | 6467/7473 [00:40<00:06, 162.31it/s] 87%|████████████████████████████████████████████████████████████████████████████████████▏            | 6484/7473 [00:41<00:06, 162.38it/s] 87%|████████████████████████████████████████████████████████████████████████████████████▍            | 6501/7473 [00:41<00:05, 162.41it/s] 87%|████████████████████████████████████████████████████████████████████████████████████▌            | 6518/7473 [00:41<00:05, 162.38it/s] 87%|████████████████████████████████████████████████████████████████████████████████████▊            | 6535/7473 [00:41<00:05, 161.71it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████            | 6552/7473 [00:41<00:05, 162.07it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████▎           | 6569/7473 [00:41<00:05, 162.17it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████▍           | 6586/7473 [00:41<00:05, 160.98it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████▋           | 6603/7473 [00:41<00:05, 161.72it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████▉           | 6620/7473 [00:41<00:05, 162.01it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████▏          | 6637/7473 [00:42<00:05, 161.89it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████▎          | 6654/7473 [00:42<00:05, 162.27it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████▌          | 6671/7473 [00:42<00:04, 162.15it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████▊          | 6688/7473 [00:42<00:04, 162.33it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████          | 6705/7473 [00:42<00:04, 162.42it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████▎         | 6722/7473 [00:42<00:04, 162.37it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████▍         | 6739/7473 [00:42<00:04, 162.58it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████▋         | 6756/7473 [00:42<00:04, 162.51it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████▉         | 6773/7473 [00:42<00:04, 162.23it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████▏        | 6790/7473 [00:42<00:04, 162.54it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████▎        | 6807/7473 [00:43<00:04, 162.41it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████▌        | 6824/7473 [00:43<00:04, 160.57it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████▊        | 6841/7473 [00:43<00:03, 161.12it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████        | 6858/7473 [00:43<00:03, 161.51it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████▏       | 6875/7473 [00:43<00:03, 161.93it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████▍       | 6892/7473 [00:43<00:03, 161.17it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████▋       | 6909/7473 [00:43<00:03, 161.69it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████▉       | 6926/7473 [00:43<00:03, 161.17it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████       | 6943/7473 [00:43<00:03, 161.63it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████▎      | 6960/7473 [00:44<00:03, 161.80it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████▌      | 6977/7473 [00:44<00:03, 162.01it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████▊      | 6994/7473 [00:44<00:02, 161.99it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████      | 7011/7473 [00:44<00:02, 162.08it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████▏     | 7028/7473 [00:44<00:02, 162.14it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████▍     | 7045/7473 [00:44<00:02, 160.79it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████▋     | 7062/7473 [00:44<00:02, 161.34it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████▉     | 7079/7473 [00:44<00:02, 161.76it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████     | 7096/7473 [00:44<00:02, 161.95it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████▎    | 7113/7473 [00:44<00:02, 162.00it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████▌    | 7130/7473 [00:45<00:02, 161.79it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████▊    | 7147/7473 [00:45<00:02, 161.89it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████▉    | 7164/7473 [00:45<00:01, 161.82it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████▏   | 7181/7473 [00:45<00:01, 161.99it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████▍   | 7198/7473 [00:45<00:01, 162.16it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████▋   | 7215/7473 [00:45<00:01, 162.38it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████▊   | 7232/7473 [00:45<00:01, 162.59it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████   | 7249/7473 [00:45<00:01, 161.68it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████▎  | 7266/7473 [00:45<00:01, 160.68it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████▌  | 7283/7473 [00:46<00:01, 161.45it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████▊  | 7300/7473 [00:46<00:01, 161.90it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████▉  | 7317/7473 [00:46<00:00, 162.03it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████▏ | 7334/7473 [00:46<00:00, 162.15it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████▍ | 7351/7473 [00:46<00:00, 162.43it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████▋ | 7368/7473 [00:46<00:00, 162.10it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████▊ | 7385/7473 [00:46<00:00, 162.27it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████ | 7402/7473 [00:46<00:00, 162.41it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████▎| 7419/7473 [00:46<00:00, 162.46it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████▌| 7436/7473 [00:46<00:00, 162.61it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████▋| 7453/7473 [00:47<00:00, 162.40it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████▉| 7470/7473 [00:47<00:00, 162.23it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 7473/7473 [00:47<00:00, 158.29it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:04<00:09,  4.97s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:11,  5.53s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:11,  5.60s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:11,  5.52s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:09<00:04,  4.86s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:11<00:05,  5.50s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.45s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:11<00:05,  5.55s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.28s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.45s/it]
[2023-08-17 20:51:03,995] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.74s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.94s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  4.82s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.02s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.04s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.17s/it]
[2023-08-17 20:51:15,702] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-17 20:51:15,703] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-17 20:51:15,703] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-17 20:51:15,704] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-17 20:51:15,704] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-17 20:51:15,704] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-17 20:51:15,704] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-17 20:51:15,704] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-17 20:51:15,704] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-17 20:51:15,704] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-17 20:51:15,704] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-17 20:51:15,704] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f836597f370>
[2023-08-17 20:51:15,704] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-17 20:51:15,704] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-17 20:51:15,704] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-17 20:51:15,704] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-17 20:51:15,704] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-17 20:51:15,704] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-17 20:51:15,704] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-17 20:51:15,704] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-17 20:51:15,704] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-17 20:51:15,704] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-17 20:51:15,704] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-17 20:51:15,704] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-17 20:51:15,704] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-17 20:51:15,704] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-17 20:51:15,704] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-17 20:51:15,704] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-17 20:51:15,704] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-17 20:51:15,704] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-17 20:51:15,704] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-17 20:51:15,704] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-17 20:51:15,704] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-17 20:51:15,704] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-17 20:51:15,704] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-17 20:51:15,704] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-17 20:51:15,704] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-17 20:51:15,704] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-17 20:51:15,704] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-17 20:51:15,704] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-17 20:51:15,704] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-17 20:51:15,705] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-17 20:51:15,705] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-17 20:51:15,705] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-17 20:51:15,705] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f836597f190>
[2023-08-17 20:51:15,705] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-17 20:51:15,705] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-17 20:51:15,705] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-17 20:51:15,705] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-17 20:51:15,705] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-17 20:51:15,705] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-17 20:51:15,705] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-17 20:51:15,705] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-17 20:51:15,705] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-17 20:51:15,705] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-17 20:51:15,705] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-17 20:51:15,705] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-17 20:51:15,705] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-17 20:51:15,705] [INFO] [config.py:1012:print]   train_batch_size ............. 8
[2023-08-17 20:51:15,705] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  2
[2023-08-17 20:51:15,705] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-17 20:51:15,705] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-17 20:51:15,705] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-17 20:51:15,705] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-17 20:51:15,705] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-17 20:51:15,705] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-17 20:51:15,705] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-17 20:51:15,705] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.6494565010070801 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating gsm8k :   0%|                                                                                           | 0/125 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following grade math question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: 1. The question is asking to identify a place where there is plumbing but it won't be useful for someone who is thirsty.
2. This implies that the plumbing system must be carrying a liquid that is not drinkable or appropriate for human consumption when thirsty.
3. Therefore, we can eliminate choices that are known for providing drinking water or having access to it. 
4. By this reasoning, we can rule out the options "own home", "water fountain", and "wall" (assuming it's part of a house), as these are all places where one could potentially access drinkable water.
5. Among the remaining choices, that is "oil refineries" and "show", it would make more sense to choose oil refineries.
6. Show is a vague term and it's unclear what it's referring to.
7. Whereas in an oil refinery, even though there would be extensive plumbing, it would be used to transport crude oil and other chemical products, not drinking water. Thus it would not be useful to a thirsty person.
8. So, we can conclude that the answer is A: oil refineries.
So the final answer is A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Output: 1. The question is asking what a person is not doing when they are just starting to work. 
2. At the beginning of a work, a person is obviously working which eliminates option A.
3. They might not be resting (option B) and they might not be tired yet(option C), but these activities are outside the scope of actual work.
4. Momentum (option E) is just a physical concept and it is irrelevant to the question.
5. The only thing that they are not doing yet when they start to work is accomplishing (option D) because accomplishment implies that a task or an objective has been completed, which can't happen at the start.
6. Therefore, the answer is D: accomplishing.
So the final answer is D: accomplishing

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Output: 1. The question is asking about a location where one could expect to find pens with a company logo. 
2. We need to find a place from the choices given, where it is common to have pens having a company's logo.
3. Let's consider all the options: 

   A: Office - Yes, in offices, it's common to have pens with the company's logo as a form of branding.
   
   B: On a pencil - This is not a location; besides, pencils do not usually carry logos.
   
   C: Write sentences on paper - Again, this is not a place. It's an action one could do with a pen.
   
   D: School - Schools might have pens, but they usually don't have a specific company's logo on them.
   
   E: Backpack - While a backpack could contain a pen, it's not specifically known for containing pens with a company's logo.

4. So, the most appropriate answer would be A: office, since it is a common sight in offices to have pens with a company's logo.
So the final answer is A: office

Input: Billy called out to John, and listened for what? Choices:  A: silence B: response C: communication D: hanging up E: whisper
Output: Step 1: Read and analyze the question. The question suggests that Billy is calling out to John.

Step 2: Understand the context. Billy 'calls out' probably indicating that he is attempting to communicate or get attention from John. 

Step 3: From the given choices, we need to figure out what Billy would logically listen for after calling out to John.

Step 4: Consider each option. Would Billy be listening for silence? Not likely since Billy's goal is probably to communicate. Would Billy be listening for hanging up or a whisper? There seems no mention of phone or low voice. Would Billy be listening for communication? It makes sense, but it's too broad without specifying what kind of communication he's expecting.

Step 5: Consider option B - would Billy be listening for a response? Yes, that makes the most sense. Calling out is usually done to get a response.

Step 6: Identify B: response as the correct answer due to its focus on Billy's expected behavior in the context of calling out. Hence, the answer is B: response.
So the final answer is B: response

Input: The lizard frightened the hiker, it's movements made what rustle? Choices:  A: garden B: trees C: books D: rocks E: bushes
Output: 1. The question is asking what the lizard's movements made a rustling sound in. 
2. We need to find a choice that contains objects that a lizard could rustle and that would be present in a scenario with a hiker. 
3. Typically hikers are outside, mostly on trails or through woods.
4. We can eliminate A and C because gardens are usually for aesthetics and books are not found in outdoor hiking scenarios.
5. We can also eliminate D because rocks do not rustle.
6. Therefore, we can conclude that E: "bushes" would be the most likely option since they can make a rustling sound when a lizard moves through them.
So the final answer is E: bushes

Input: The man spent big money and time maintaining his lawn, it was part of keeping up with the Joneses where? Choices:  A: front yard B: suburbia C: neighborhood D: back yard E: golf course
Output: 1. The question asks where the man was trying to keep up with the Joneses, an idiom referring to comparing oneself to one's neighbors.
2. The activities mentioned involve spending money and time on maintaining a lawn, which are typical activities undertaken in suburban areas where houses have front yards and backyards.
3. Options A and D denote specific parts of a property (front yard and back yard) while E refers to a specialized type of property - a golf course, which is not commonly associated with this phrase. The term 'keeping up with the Joneses' generally refers to a broader residential area, not just an individual's own property.
4. The term 'neighborhood' in choice C might be associated with this competition as well, but neighborhoods can include a wider range of areas including urban and suburban.
5. Choice B:'suburbia' refers to suburban districts, which often consist of residential houses with gardens. Residents of suburban often invest time and resources into the beautification of their lawns, making it a more specific and appropriate answer.
6. Thus, the best answer is B:'suburbia'.
So the final answer is B: suburbia

Input: What would a human do if they want to get to a store that he or she can see? Choices:  A: cross road B: see around C: drink coffee D: dream dreams E: think critically
Output: 1. The question is asking what a person would do if they want to get to a store that they can see.
2. It provides us with a selection of possible actions: crossing the road, seeing around, drinking coffee, dreaming dreams, and thinking critically.
3. If the person can already see the store, it implies that they are not currently in the store and there is some physical distance between them and the store. 
4. Considering these factors, we can quickly rule out the options of 'thinking critically' and 'dreaming dreams' as they do not involve any physical movement towards the store.
5. Although'seeing around' and 'drinking coffee' are actions a person might take, they do not directly contribute to the goal of reaching the visible store. Therefore, these options can also be eliminated. 
6. This leaves us with 'cross road', which is the only remaining action that directly leads to the person reaching their goal i.e. the store.
7. Hence, the answer is A: cross road.
So the final answer is A: cross road

Input: Where would you grab an object contained by a doorway? Choices:  A: television B: control panel C: opening doors D: doorknob E: doorway
Output: 1. The question asks where you would grab an object contained by a doorway
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o8-tcommonsenseqa-s1-rTrue
Loading extension module utils...
Time to load utils op: 0.6048369407653809 seconds
Loading extension module utils...
Time to load utils op: 0.5046472549438477 seconds
Loading extension module utils...
Time to load utils op: 0.5045492649078369 seconds
Evaluating gsm8k :   1%|▋                                                                                  | 1/125 [00:24<49:41, 24.05s/it]Evaluating gsm8k :   2%|█▎                                                                                 | 2/125 [00:41<41:11, 20.09s/it]Evaluating gsm8k :   2%|█▉                                                                                 | 3/125 [01:04<43:32, 21.42s/it]Evaluating gsm8k :   3%|██▋                                                                                | 4/125 [01:27<44:21, 21.99s/it]Evaluating gsm8k :   4%|███▎                                                                               | 5/125 [01:50<44:39, 22.33s/it]Evaluating gsm8k :   5%|███▉                                                                               | 6/125 [02:13<44:41, 22.53s/it]Evaluating gsm8k :   6%|████▋                                                                              | 7/125 [02:35<44:32, 22.65s/it]Evaluating gsm8k :   6%|█████▎                                                                             | 8/125 [02:58<44:21, 22.75s/it]Evaluating gsm8k :   7%|█████▉                                                                             | 9/125 [03:22<44:18, 22.92s/it]Evaluating gsm8k :   8%|██████▌                                                                           | 10/125 [03:45<43:59, 22.96s/it]Evaluating gsm8k :   9%|███████▏                                                                          | 11/125 [04:08<43:37, 22.96s/it]Evaluating gsm8k :  10%|███████▊                                                                          | 12/125 [04:31<43:16, 22.98s/it]Evaluating gsm8k :  10%|████████▌                                                                         | 13/125 [04:54<42:56, 23.01s/it]Evaluating gsm8k :  11%|█████████▏                                                                        | 14/125 [05:17<42:33, 23.00s/it]Evaluating gsm8k :  12%|█████████▊                                                                        | 15/125 [05:40<42:11, 23.01s/it]Evaluating gsm8k :  13%|██████████▍                                                                       | 16/125 [06:03<41:49, 23.02s/it]Evaluating gsm8k :  14%|███████████▏                                                                      | 17/125 [06:26<41:27, 23.04s/it]Evaluating gsm8k :  14%|███████████▊                                                                      | 18/125 [06:49<41:05, 23.04s/it]Evaluating gsm8k :  15%|████████████▍                                                                     | 19/125 [07:12<40:41, 23.03s/it]Evaluating gsm8k :  16%|█████████████                                                                     | 20/125 [07:35<40:14, 23.00s/it]Evaluating gsm8k :  17%|█████████████▊                                                                    | 21/125 [07:58<39:54, 23.03s/it]Evaluating gsm8k :  18%|██████████████▍                                                                   | 22/125 [08:21<39:27, 22.99s/it]Evaluating gsm8k :  18%|███████████████                                                                   | 23/125 [08:44<39:08, 23.03s/it]Evaluating gsm8k :  19%|███████████████▋                                                                  | 24/125 [09:07<38:43, 23.00s/it]Evaluating gsm8k :  20%|████████████████▍                                                                 | 25/125 [09:30<38:22, 23.03s/it]Evaluating gsm8k :  21%|█████████████████                                                                 | 26/125 [09:53<37:56, 22.99s/it]Evaluating gsm8k :  22%|█████████████████▋                                                                | 27/125 [10:08<33:27, 20.49s/it]Evaluating gsm8k :  22%|██████████████████▎                                                               | 28/125 [10:24<31:01, 19.19s/it]Evaluating gsm8k :  23%|███████████████████                                                               | 29/125 [10:47<32:32, 20.34s/it]Evaluating gsm8k :  24%|███████████████████▋                                                              | 30/125 [11:10<33:28, 21.14s/it]Evaluating gsm8k :  25%|████████████████████▎                                                             | 31/125 [11:33<33:59, 21.70s/it]Evaluating gsm8k :  26%|████████████████████▉                                                             | 32/125 [11:56<34:12, 22.07s/it]Evaluating gsm8k :  26%|█████████████████████▋                                                            | 33/125 [12:19<34:16, 22.35s/it]Evaluating gsm8k :  27%|██████████████████████▎                                                           | 34/125 [12:42<34:10, 22.53s/it]Evaluating gsm8k :  28%|██████████████████████▉                                                           | 35/125 [13:05<33:59, 22.67s/it]Evaluating gsm8k :  29%|███████████████████████▌                                                          | 36/125 [13:28<33:44, 22.75s/it]Evaluating gsm8k :  30%|████████████████████████▎                                                         | 37/125 [13:51<33:28, 22.83s/it]Evaluating gsm8k :  30%|████████████████████████▉                                                         | 38/125 [14:03<28:32, 19.68s/it]Evaluating gsm8k :  31%|█████████████████████████▌                                                        | 39/125 [14:26<29:37, 20.67s/it]Evaluating gsm8k :  32%|██████████████████████████▏                                                       | 40/125 [14:49<30:15, 21.36s/it]Evaluating gsm8k :  33%|██████████████████████████▉                                                       | 41/125 [15:12<30:33, 21.83s/it]Evaluating gsm8k :  34%|███████████████████████████▌                                                      | 42/125 [15:35<30:42, 22.20s/it]Evaluating gsm8k :  34%|████████████████████████████▏                                                     | 43/125 [15:58<30:38, 22.42s/it]Evaluating gsm8k :  35%|████████████████████████████▊                                                     | 44/125 [16:21<30:30, 22.60s/it]Evaluating gsm8k :  36%|█████████████████████████████▌                                                    | 45/125 [16:44<30:17, 22.72s/it]Evaluating gsm8k :  37%|██████████████████████████████▏                                                   | 46/125 [17:07<29:58, 22.77s/it]Evaluating gsm8k :  38%|██████████████████████████████▊                                                   | 47/125 [17:30<29:38, 22.80s/it]Evaluating gsm8k :  38%|███████████████████████████████▍                                                  | 48/125 [17:45<26:18, 20.50s/it]Evaluating gsm8k :  39%|████████████████████████████████▏                                                 | 49/125 [18:08<26:53, 21.23s/it]Evaluating gsm8k :  40%|████████████████████████████████▊                                                 | 50/125 [18:31<27:11, 21.75s/it]Evaluating gsm8k :  41%|█████████████████████████████████▍                                                | 51/125 [18:54<27:17, 22.13s/it]Evaluating gsm8k :  42%|██████████████████████████████████                                                | 52/125 [19:17<27:15, 22.40s/it]Evaluating gsm8k :  42%|██████████████████████████████████▊                                               | 53/125 [19:40<27:03, 22.55s/it]Evaluating gsm8k :  43%|███████████████████████████████████▍                                              | 54/125 [20:03<26:51, 22.69s/it]Evaluating gsm8k :  44%|████████████████████████████████████                                              | 55/125 [20:26<26:34, 22.77s/it]Evaluating gsm8k :  45%|████████████████████████████████████▋                                             | 56/125 [20:49<26:16, 22.84s/it]Evaluating gsm8k :  46%|█████████████████████████████████████▍                                            | 57/125 [21:12<25:56, 22.89s/it]Evaluating gsm8k :  46%|██████████████████████████████████████                                            | 58/125 [21:27<23:03, 20.65s/it]Evaluating gsm8k :  47%|██████████████████████████████████████▋                                           | 59/125 [21:50<23:29, 21.36s/it]Evaluating gsm8k :  48%|███████████████████████████████████████▎                                          | 60/125 [22:13<23:39, 21.84s/it]Evaluating gsm8k :  49%|████████████████████████████████████████                                          | 61/125 [22:36<23:40, 22.19s/it]Evaluating gsm8k :  50%|████████████████████████████████████████▋                                         | 62/125 [22:59<23:31, 22.41s/it]Evaluating gsm8k :  50%|█████████████████████████████████████████▎                                        | 63/125 [23:22<23:19, 22.58s/it]Evaluating gsm8k :  51%|█████████████████████████████████████████▉                                        | 64/125 [23:45<23:04, 22.69s/it]Evaluating gsm8k :  52%|██████████████████████████████████████████▋                                       | 65/125 [24:08<22:46, 22.78s/it]Evaluating gsm8k :  53%|███████████████████████████████████████████▎                                      | 66/125 [24:31<22:27, 22.84s/it]Evaluating gsm8k :  54%|███████████████████████████████████████████▉                                      | 67/125 [24:54<22:06, 22.87s/it]Evaluating gsm8k :  54%|████████████████████████████████████████████▌                                     | 68/125 [25:17<21:44, 22.88s/it]Evaluating gsm8k :  55%|█████████████████████████████████████████████▎                                    | 69/125 [25:40<21:22, 22.90s/it]Evaluating gsm8k :  56%|█████████████████████████████████████████████▉                                    | 70/125 [26:03<20:59, 22.91s/it]Evaluating gsm8k :  57%|██████████████████████████████████████████████▌                                   | 71/125 [26:26<20:39, 22.95s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▏                                  | 72/125 [26:49<20:15, 22.94s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▉                                  | 73/125 [27:12<19:55, 22.99s/it]Evaluating gsm8k :  59%|████████████████████████████████████████████████▌                                 | 74/125 [27:30<18:27, 21.72s/it]Evaluating gsm8k :  60%|█████████████████████████████████████████████████▏                                | 75/125 [27:53<18:24, 22.09s/it]Evaluating gsm8k :  61%|█████████████████████████████████████████████████▊                                | 76/125 [28:16<18:14, 22.34s/it]Evaluating gsm8k :  62%|██████████████████████████████████████████████████▌                               | 77/125 [28:39<18:01, 22.53s/it]Evaluating gsm8k :  62%|███████████████████████████████████████████████████▏                              | 78/125 [29:02<17:45, 22.66s/it]Evaluating gsm8k :  63%|███████████████████████████████████████████████████▊                              | 79/125 [29:25<17:25, 22.73s/it]Evaluating gsm8k :  64%|████████████████████████████████████████████████████▍                             | 80/125 [29:48<17:05, 22.79s/it]Evaluating gsm8k :  65%|█████████████████████████████████████████████████████▏                            | 81/125 [30:11<16:46, 22.87s/it]Evaluating gsm8k :  66%|█████████████████████████████████████████████████████▊                            | 82/125 [30:34<16:24, 22.88s/it]Evaluating gsm8k :  66%|██████████████████████████████████████████████████████▍                           | 83/125 [30:57<16:02, 22.91s/it]Evaluating gsm8k :  67%|███████████████████████████████████████████████████████                           | 84/125 [31:20<15:39, 22.90s/it]Evaluating gsm8k :  68%|███████████████████████████████████████████████████████▊                          | 85/125 [31:43<15:17, 22.94s/it]Evaluating gsm8k :  69%|████████████████████████████████████████████████████████▍                         | 86/125 [32:06<14:54, 22.93s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████                         | 87/125 [32:29<14:31, 22.94s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████▋                        | 88/125 [32:52<14:08, 22.93s/it]Evaluating gsm8k :  71%|██████████████████████████████████████████████████████████▍                       | 89/125 [33:15<13:44, 22.91s/it]Evaluating gsm8k :  72%|███████████████████████████████████████████████████████████                       | 90/125 [33:38<13:22, 22.93s/it]Evaluating gsm8k :  73%|███████████████████████████████████████████████████████████▋                      | 91/125 [34:00<12:59, 22.93s/it]Evaluating gsm8k :  74%|████████████████████████████████████████████████████████████▎                     | 92/125 [34:23<12:37, 22.96s/it]Evaluating gsm8k :  74%|█████████████████████████████████████████████████████████████                     | 93/125 [34:46<12:14, 22.96s/it]Evaluating gsm8k :  75%|█████████████████████████████████████████████████████████████▋                    | 94/125 [35:09<11:52, 22.97s/it]Evaluating gsm8k :  76%|██████████████████████████████████████████████████████████████▎                   | 95/125 [35:32<11:28, 22.95s/it]Evaluating gsm8k :  77%|██████████████████████████████████████████████████████████████▉                   | 96/125 [35:55<11:04, 22.92s/it]Evaluating gsm8k :  78%|███████████████████████████████████████████████████████████████▋                  | 97/125 [36:18<10:42, 22.94s/it]Evaluating gsm8k :  78%|████████████████████████████████████████████████████████████████▎                 | 98/125 [36:41<10:19, 22.93s/it]Evaluating gsm8k :  79%|████████████████████████████████████████████████████████████████▉                 | 99/125 [37:04<09:56, 22.94s/it]Evaluating gsm8k :  80%|████████████████████████████████████████████████████████████████▊                | 100/125 [37:27<09:33, 22.94s/it]Evaluating gsm8k :  81%|█████████████████████████████████████████████████████████████████▍               | 101/125 [37:50<09:11, 22.96s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████               | 102/125 [38:13<08:47, 22.96s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████▋              | 103/125 [38:36<08:25, 22.97s/it]Evaluating gsm8k :  83%|███████████████████████████████████████████████████████████████████▍             | 104/125 [38:59<08:02, 22.99s/it]Evaluating gsm8k :  84%|████████████████████████████████████████████████████████████████████             | 105/125 [39:22<07:40, 23.01s/it]Evaluating gsm8k :  85%|████████████████████████████████████████████████████████████████████▋            | 106/125 [39:46<07:20, 23.19s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▎           | 107/125 [40:09<06:56, 23.15s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▉           | 108/125 [40:32<06:32, 23.11s/it]Evaluating gsm8k :  87%|██████████████████████████████████████████████████████████████████████▋          | 109/125 [40:55<06:09, 23.09s/it]Evaluating gsm8k :  88%|███████████████████████████████████████████████████████████████████████▎         | 110/125 [41:18<05:46, 23.09s/it]Evaluating gsm8k :  89%|███████████████████████████████████████████████████████████████████████▉         | 111/125 [41:41<05:24, 23.14s/it]Evaluating gsm8k :  90%|████████████████████████████████████████████████████████████████████████▌        | 112/125 [42:04<05:00, 23.10s/it]Evaluating gsm8k :  90%|█████████████████████████████████████████████████████████████████████████▏       | 113/125 [42:27<04:36, 23.05s/it]Evaluating gsm8k :  91%|█████████████████████████████████████████████████████████████████████████▊       | 114/125 [42:50<04:13, 23.03s/it]Evaluating gsm8k :  92%|██████████████████████████████████████████████████████████████████████████▌      | 115/125 [43:13<03:50, 23.08s/it]Evaluating gsm8k :  93%|███████████████████████████████████████████████████████████████████████████▏     | 116/125 [43:36<03:27, 23.10s/it]Evaluating gsm8k :  94%|███████████████████████████████████████████████████████████████████████████▊     | 117/125 [43:59<03:04, 23.06s/it]Evaluating gsm8k :  94%|████████████████████████████████████████████████████████████████████████████▍    | 118/125 [44:20<02:36, 22.42s/it]Evaluating gsm8k :  95%|█████████████████████████████████████████████████████████████████████████████    | 119/125 [44:43<02:15, 22.59s/it]Evaluating gsm8k :  96%|█████████████████████████████████████████████████████████████████████████████▊   | 120/125 [45:06<01:53, 22.73s/it]Evaluating gsm8k :  97%|██████████████████████████████████████████████████████████████████████████████▍  | 121/125 [45:29<01:31, 22.81s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████  | 122/125 [45:52<01:08, 22.85s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████▋ | 123/125 [46:15<00:45, 22.90s/it]Evaluating gsm8k :  99%|████████████████████████████████████████████████████████████████████████████████▎| 124/125 [46:27<00:19, 19.66s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [46:50<00:00, 20.68s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [46:50<00:00, 22.49s/it]
name: gsm8k | {'exact_match': 0.0, 'rougeL': 0.0975} | lm_loss 12.909 | avg. gen lenth: 455.952
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name gsm8k --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name commonsenseqa --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 2 --data-dir /scratch/ylu130/processed_data/gsm8k/out-domain/o9-tcommonsenseqa-s1-rTrue --seed 1 --max-prompt-length 2048 --rationales --num-out-domain 9
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-17 21:39:25,346] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... gsm8k
  data_dir ..................... /scratch/ylu130/processed_data/gsm8k/out-domain/o9-tcommonsenseqa-s1-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 9
  out_domain_data_name ......... commonsenseqa
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o9-tcommonsenseqa-s1-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 2
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                                             | 0/7473 [00:00<?, ?it/s]  0%|                                                                                                     | 9/7473 [00:00<01:32, 80.79it/s]  0%|▏                                                                                                   | 18/7473 [00:00<01:31, 81.61it/s]  0%|▎                                                                                                   | 27/7473 [00:00<01:31, 81.50it/s]  0%|▍                                                                                                   | 36/7473 [00:00<01:31, 81.55it/s]  1%|▌                                                                                                   | 45/7473 [00:00<01:32, 80.18it/s]  1%|▋                                                                                                   | 54/7473 [00:00<01:31, 80.69it/s]  1%|▊                                                                                                   | 63/7473 [00:00<01:31, 80.91it/s]  1%|▉                                                                                                   | 72/7473 [00:00<01:31, 81.17it/s]  1%|█                                                                                                   | 81/7473 [00:00<01:30, 81.42it/s]  1%|█▏                                                                                                  | 90/7473 [00:01<01:30, 81.62it/s]  1%|█▎                                                                                                  | 99/7473 [00:01<01:30, 81.64it/s]  1%|█▍                                                                                                 | 108/7473 [00:01<01:30, 81.53it/s]  2%|█▌                                                                                                 | 120/7473 [00:01<01:20, 91.44it/s]  2%|█▋                                                                                                | 133/7473 [00:01<01:13, 100.29it/s]  2%|█▉                                                                                                | 146/7473 [00:01<01:08, 107.12it/s]  2%|██                                                                                                | 159/7473 [00:01<01:04, 112.73it/s]  2%|██▎                                                                                               | 172/7473 [00:01<01:02, 116.14it/s]  2%|██▍                                                                                               | 185/7473 [00:01<01:01, 118.25it/s]  3%|██▌                                                                                               | 198/7473 [00:02<01:00, 120.54it/s]  3%|██▊                                                                                               | 211/7473 [00:02<00:59, 122.24it/s]  3%|██▉                                                                                               | 224/7473 [00:02<00:58, 123.22it/s]  3%|███                                                                                               | 237/7473 [00:02<00:58, 123.77it/s]  3%|███▎                                                                                              | 250/7473 [00:02<00:59, 121.78it/s]  4%|███▍                                                                                              | 263/7473 [00:02<00:58, 122.76it/s]  4%|███▌                                                                                              | 276/7473 [00:02<00:58, 123.70it/s]  4%|███▊                                                                                              | 289/7473 [00:02<00:57, 124.16it/s]  4%|███▉                                                                                              | 302/7473 [00:02<00:57, 124.45it/s]  4%|████▏                                                                                             | 315/7473 [00:03<00:57, 124.83it/s]  4%|████▎                                                                                             | 328/7473 [00:03<00:57, 125.19it/s]  5%|████▍                                                                                             | 341/7473 [00:03<00:57, 124.56it/s]  5%|████▋                                                                                             | 354/7473 [00:03<00:57, 124.48it/s]  5%|████▊                                                                                             | 367/7473 [00:03<00:57, 124.00it/s]  5%|████▉                                                                                             | 380/7473 [00:03<00:57, 124.07it/s]  5%|█████▏                                                                                            | 393/7473 [00:03<00:57, 124.15it/s]  5%|█████▎                                                                                            | 406/7473 [00:03<00:56, 124.26it/s]  6%|█████▍                                                                                            | 419/7473 [00:03<00:56, 124.56it/s]  6%|█████▋                                                                                            | 432/7473 [00:03<00:56, 124.79it/s]  6%|█████▊                                                                                            | 445/7473 [00:04<00:56, 124.55it/s]  6%|██████                                                                                            | 458/7473 [00:04<00:56, 124.52it/s]  6%|██████▏                                                                                           | 471/7473 [00:04<00:56, 124.66it/s]  6%|██████▎                                                                                           | 484/7473 [00:04<00:56, 123.39it/s]  7%|██████▌                                                                                           | 497/7473 [00:04<00:56, 123.45it/s]  7%|██████▋                                                                                           | 510/7473 [00:04<00:56, 122.99it/s]  7%|██████▊                                                                                           | 523/7473 [00:04<00:56, 123.77it/s]  7%|███████                                                                                           | 536/7473 [00:04<00:55, 124.35it/s]  7%|███████▏                                                                                          | 549/7473 [00:04<00:55, 124.71it/s]  8%|███████▎                                                                                          | 562/7473 [00:04<00:55, 125.02it/s]  8%|███████▌                                                                                          | 575/7473 [00:05<00:55, 124.89it/s]  8%|███████▋                                                                                          | 588/7473 [00:05<00:55, 125.13it/s]  8%|███████▉                                                                                          | 601/7473 [00:05<00:54, 125.07it/s]  8%|████████                                                                                          | 614/7473 [00:05<00:54, 124.99it/s]  8%|████████▏                                                                                         | 627/7473 [00:05<00:55, 123.79it/s]  9%|████████▍                                                                                         | 640/7473 [00:05<00:55, 124.04it/s]  9%|████████▌                                                                                         | 653/7473 [00:05<00:54, 124.16it/s]  9%|████████▋                                                                                         | 666/7473 [00:05<00:54, 124.63it/s]  9%|████████▉                                                                                         | 679/7473 [00:05<00:54, 124.86it/s]  9%|█████████                                                                                         | 692/7473 [00:06<00:54, 125.21it/s]  9%|█████████▏                                                                                        | 705/7473 [00:06<00:54, 123.83it/s] 10%|█████████▍                                                                                        | 718/7473 [00:06<00:54, 124.40it/s] 10%|█████████▌                                                                                        | 731/7473 [00:06<00:54, 124.75it/s] 10%|█████████▊                                                                                        | 744/7473 [00:06<00:53, 125.15it/s] 10%|█████████▉                                                                                        | 757/7473 [00:06<00:53, 125.21it/s] 10%|██████████                                                                                        | 770/7473 [00:06<00:53, 124.76it/s] 10%|██████████▎                                                                                       | 783/7473 [00:06<00:54, 123.72it/s] 11%|██████████▍                                                                                       | 796/7473 [00:06<00:53, 124.19it/s] 11%|██████████▌                                                                                       | 809/7473 [00:06<00:53, 124.41it/s] 11%|██████████▊                                                                                       | 822/7473 [00:07<00:53, 124.26it/s] 11%|██████████▉                                                                                       | 835/7473 [00:07<00:53, 124.90it/s] 11%|███████████                                                                                       | 848/7473 [00:07<00:52, 125.07it/s] 12%|███████████▎                                                                                      | 861/7473 [00:07<00:52, 125.12it/s] 12%|███████████▍                                                                                      | 874/7473 [00:07<00:52, 125.21it/s] 12%|███████████▋                                                                                      | 887/7473 [00:07<00:52, 125.33it/s] 12%|███████████▊                                                                                      | 900/7473 [00:07<00:52, 125.00it/s] 12%|███████████▉                                                                                      | 913/7473 [00:07<00:52, 124.88it/s] 12%|████████████▏                                                                                     | 926/7473 [00:07<00:52, 124.42it/s] 13%|████████████▎                                                                                     | 939/7473 [00:08<00:53, 122.78it/s] 13%|████████████▍                                                                                     | 952/7473 [00:08<00:52, 123.80it/s] 13%|████████████▋                                                                                     | 965/7473 [00:08<00:52, 124.52it/s] 13%|████████████▊                                                                                     | 978/7473 [00:08<00:51, 124.98it/s] 13%|████████████▉                                                                                     | 991/7473 [00:08<00:51, 125.28it/s] 13%|█████████████                                                                                    | 1004/7473 [00:08<00:51, 124.85it/s] 14%|█████████████▏                                                                                   | 1017/7473 [00:08<00:51, 125.36it/s] 14%|█████████████▎                                                                                   | 1030/7473 [00:08<00:51, 125.41it/s] 14%|█████████████▌                                                                                   | 1043/7473 [00:08<00:51, 125.38it/s] 14%|█████████████▋                                                                                   | 1056/7473 [00:08<00:51, 125.62it/s] 14%|█████████████▉                                                                                   | 1069/7473 [00:09<00:50, 125.73it/s] 14%|██████████████                                                                                   | 1082/7473 [00:09<00:50, 125.74it/s] 15%|██████████████▏                                                                                  | 1095/7473 [00:09<00:50, 125.61it/s] 15%|██████████████▍                                                                                  | 1108/7473 [00:09<00:50, 125.58it/s] 15%|██████████████▌                                                                                  | 1121/7473 [00:09<00:50, 125.14it/s] 15%|██████████████▋                                                                                  | 1134/7473 [00:09<00:50, 124.95it/s] 15%|██████████████▉                                                                                  | 1147/7473 [00:09<00:50, 124.85it/s] 16%|███████████████                                                                                  | 1160/7473 [00:09<00:51, 123.61it/s] 16%|███████████████▏                                                                                 | 1173/7473 [00:09<00:50, 124.18it/s] 16%|███████████████▍                                                                                 | 1186/7473 [00:09<00:50, 124.22it/s] 16%|███████████████▌                                                                                 | 1199/7473 [00:10<00:50, 124.54it/s] 16%|███████████████▋                                                                                 | 1212/7473 [00:10<00:50, 124.64it/s] 16%|███████████████▉                                                                                 | 1225/7473 [00:10<00:49, 125.00it/s] 17%|████████████████                                                                                 | 1238/7473 [00:10<00:49, 125.17it/s] 17%|████████████████▏                                                                                | 1251/7473 [00:10<00:49, 125.21it/s] 17%|████████████████▍                                                                                | 1264/7473 [00:10<00:49, 125.28it/s] 17%|████████████████▌                                                                                | 1277/7473 [00:10<00:49, 125.46it/s] 17%|████████████████▋                                                                                | 1290/7473 [00:10<00:49, 125.61it/s] 17%|████████████████▉                                                                                | 1303/7473 [00:10<00:49, 125.44it/s] 18%|█████████████████                                                                                | 1316/7473 [00:11<00:49, 124.96it/s] 18%|█████████████████▎                                                                               | 1329/7473 [00:11<00:49, 124.99it/s] 18%|█████████████████▍                                                                               | 1342/7473 [00:11<00:48, 125.36it/s] 18%|█████████████████▌                                                                               | 1355/7473 [00:11<00:48, 125.46it/s] 18%|█████████████████▊                                                                               | 1368/7473 [00:11<00:48, 125.45it/s] 18%|█████████████████▉                                                                               | 1381/7473 [00:11<00:48, 125.29it/s] 19%|██████████████████                                                                               | 1394/7473 [00:11<00:49, 123.53it/s] 19%|██████████████████▎                                                                              | 1407/7473 [00:11<00:48, 124.05it/s] 19%|██████████████████▍                                                                              | 1420/7473 [00:11<00:48, 124.25it/s] 19%|██████████████████▌                                                                              | 1433/7473 [00:11<00:48, 124.43it/s] 19%|██████████████████▊                                                                              | 1446/7473 [00:12<00:48, 124.87it/s] 20%|██████████████████▉                                                                              | 1459/7473 [00:12<00:48, 124.88it/s] 20%|███████████████████                                                                              | 1472/7473 [00:12<00:47, 125.17it/s] 20%|███████████████████▎                                                                             | 1485/7473 [00:12<00:47, 125.22it/s] 20%|███████████████████▍                                                                             | 1498/7473 [00:12<00:47, 125.46it/s] 20%|███████████████████▌                                                                             | 1511/7473 [00:12<00:47, 125.08it/s] 20%|███████████████████▊                                                                             | 1524/7473 [00:12<00:47, 125.07it/s] 21%|███████████████████▉                                                                             | 1537/7473 [00:12<00:47, 125.18it/s] 21%|████████████████████                                                                             | 1550/7473 [00:12<00:47, 124.92it/s] 21%|████████████████████▎                                                                            | 1563/7473 [00:13<00:47, 124.81it/s] 21%|████████████████████▍                                                                            | 1576/7473 [00:13<00:47, 124.73it/s] 21%|████████████████████▋                                                                            | 1589/7473 [00:13<00:47, 124.35it/s] 21%|████████████████████▊                                                                            | 1602/7473 [00:13<00:47, 124.51it/s] 22%|████████████████████▉                                                                            | 1615/7473 [00:13<00:47, 122.78it/s] 22%|█████████████████████▏                                                                           | 1628/7473 [00:13<00:47, 122.92it/s] 22%|█████████████████████▎                                                                           | 1641/7473 [00:13<00:47, 123.67it/s] 22%|█████████████████████▍                                                                           | 1654/7473 [00:13<00:47, 123.50it/s] 22%|█████████████████████▋                                                                           | 1667/7473 [00:13<00:46, 123.81it/s] 22%|█████████████████████▊                                                                           | 1680/7473 [00:13<00:46, 124.31it/s] 23%|█████████████████████▉                                                                           | 1693/7473 [00:14<00:46, 124.48it/s] 23%|██████████████████████▏                                                                          | 1706/7473 [00:14<00:46, 124.58it/s] 23%|██████████████████████▎                                                                          | 1719/7473 [00:14<00:46, 124.72it/s] 23%|██████████████████████▍                                                                          | 1732/7473 [00:14<00:45, 124.94it/s] 23%|██████████████████████▋                                                                          | 1745/7473 [00:14<00:46, 124.50it/s] 24%|██████████████████████▊                                                                          | 1758/7473 [00:14<00:45, 124.58it/s] 24%|██████████████████████▉                                                                          | 1771/7473 [00:14<00:45, 124.38it/s] 24%|███████████████████████▏                                                                         | 1784/7473 [00:14<00:45, 124.53it/s] 24%|███████████████████████▎                                                                         | 1797/7473 [00:14<00:45, 124.26it/s] 24%|███████████████████████▍                                                                         | 1810/7473 [00:14<00:45, 124.45it/s] 24%|███████████████████████▋                                                                         | 1823/7473 [00:15<00:45, 124.33it/s] 25%|███████████████████████▊                                                                         | 1836/7473 [00:15<00:45, 124.28it/s] 25%|████████████████████████                                                                         | 1849/7473 [00:15<00:45, 122.83it/s] 25%|████████████████████████▏                                                                        | 1862/7473 [00:15<00:45, 122.98it/s] 25%|████████████████████████▎                                                                        | 1875/7473 [00:15<00:45, 123.10it/s] 25%|████████████████████████▌                                                                        | 1888/7473 [00:15<00:45, 123.49it/s] 25%|████████████████████████▋                                                                        | 1901/7473 [00:15<00:45, 123.27it/s] 26%|████████████████████████▊                                                                        | 1914/7473 [00:15<00:45, 123.31it/s] 26%|█████████████████████████                                                                        | 1927/7473 [00:15<00:44, 123.61it/s] 26%|█████████████████████████▏                                                                       | 1940/7473 [00:16<00:44, 123.78it/s] 26%|█████████████████████████▎                                                                       | 1953/7473 [00:16<00:44, 124.07it/s] 26%|█████████████████████████▌                                                                       | 1966/7473 [00:16<00:44, 124.20it/s] 26%|█████████████████████████▋                                                                       | 1979/7473 [00:16<00:44, 124.46it/s] 27%|█████████████████████████▊                                                                       | 1992/7473 [00:16<00:44, 124.47it/s] 27%|██████████████████████████                                                                       | 2005/7473 [00:16<00:44, 123.76it/s] 27%|██████████████████████████▏                                                                      | 2018/7473 [00:16<00:43, 124.15it/s] 27%|██████████████████████████▎                                                                      | 2031/7473 [00:16<00:43, 124.47it/s] 27%|██████████████████████████▌                                                                      | 2044/7473 [00:16<00:43, 124.34it/s] 28%|██████████████████████████▋                                                                      | 2057/7473 [00:16<00:43, 123.54it/s] 28%|██████████████████████████▊                                                                      | 2070/7473 [00:17<00:44, 122.24it/s] 28%|███████████████████████████                                                                      | 2083/7473 [00:17<00:43, 123.18it/s] 28%|███████████████████████████▏                                                                     | 2096/7473 [00:17<00:43, 123.66it/s] 28%|███████████████████████████▎                                                                     | 2109/7473 [00:17<00:45, 118.58it/s] 28%|███████████████████████████▌                                                                     | 2122/7473 [00:17<00:44, 120.11it/s] 29%|███████████████████████████▋                                                                     | 2135/7473 [00:17<00:43, 121.43it/s] 29%|███████████████████████████▉                                                                     | 2148/7473 [00:17<00:43, 121.77it/s] 29%|████████████████████████████                                                                     | 2161/7473 [00:17<00:43, 122.57it/s] 29%|████████████████████████████▏                                                                    | 2174/7473 [00:17<00:42, 123.24it/s] 29%|████████████████████████████▍                                                                    | 2187/7473 [00:18<00:42, 123.41it/s] 29%|████████████████████████████▌                                                                    | 2200/7473 [00:18<00:42, 123.73it/s] 30%|████████████████████████████▋                                                                    | 2213/7473 [00:18<00:42, 123.07it/s] 30%|████████████████████████████▉                                                                    | 2226/7473 [00:18<00:42, 123.45it/s] 30%|█████████████████████████████                                                                    | 2239/7473 [00:18<00:42, 123.74it/s] 30%|█████████████████████████████▏                                                                   | 2252/7473 [00:18<00:42, 123.63it/s] 30%|█████████████████████████████▍                                                                   | 2265/7473 [00:18<00:42, 123.98it/s] 30%|█████████████████████████████▌                                                                   | 2278/7473 [00:18<00:41, 124.04it/s] 31%|█████████████████████████████▋                                                                   | 2291/7473 [00:18<00:41, 123.94it/s] 31%|█████████████████████████████▉                                                                   | 2304/7473 [00:19<00:42, 122.78it/s] 31%|██████████████████████████████                                                                   | 2317/7473 [00:19<00:41, 123.56it/s] 31%|██████████████████████████████▏                                                                  | 2330/7473 [00:19<00:41, 123.96it/s] 31%|██████████████████████████████▍                                                                  | 2343/7473 [00:19<00:41, 123.93it/s] 32%|██████████████████████████████▌                                                                  | 2356/7473 [00:19<00:41, 123.74it/s] 32%|██████████████████████████████▋                                                                  | 2369/7473 [00:19<00:41, 123.99it/s] 32%|██████████████████████████████▉                                                                  | 2382/7473 [00:19<00:41, 124.15it/s] 32%|███████████████████████████████                                                                  | 2395/7473 [00:19<00:40, 123.86it/s] 32%|███████████████████████████████▎                                                                 | 2408/7473 [00:19<00:40, 124.19it/s] 32%|███████████████████████████████▍                                                                 | 2421/7473 [00:19<00:40, 123.30it/s] 33%|███████████████████████████████▌                                                                 | 2434/7473 [00:20<00:40, 123.74it/s] 33%|███████████████████████████████▊                                                                 | 2447/7473 [00:20<00:40, 124.04it/s] 33%|███████████████████████████████▉                                                                 | 2460/7473 [00:20<00:40, 123.71it/s] 33%|████████████████████████████████                                                                 | 2473/7473 [00:20<00:40, 123.69it/s] 33%|████████████████████████████████▎                                                                | 2486/7473 [00:20<00:40, 124.02it/s] 33%|████████████████████████████████▍                                                                | 2499/7473 [00:20<00:40, 124.24it/s] 34%|████████████████████████████████▌                                                                | 2512/7473 [00:20<00:39, 124.25it/s] 34%|████████████████████████████████▊                                                                | 2525/7473 [00:20<00:47, 103.98it/s] 34%|████████████████████████████████▉                                                                | 2538/7473 [00:20<00:45, 109.37it/s] 34%|█████████████████████████████████                                                                | 2551/7473 [00:21<00:43, 113.43it/s] 34%|█████████████████████████████████▎                                                               | 2564/7473 [00:21<00:42, 116.58it/s] 34%|█████████████████████████████████▍                                                               | 2577/7473 [00:21<00:41, 118.92it/s] 35%|█████████████████████████████████▌                                                               | 2590/7473 [00:21<00:40, 120.21it/s] 35%|█████████████████████████████████▊                                                               | 2603/7473 [00:21<00:40, 121.30it/s] 35%|█████████████████████████████████▉                                                               | 2616/7473 [00:21<00:39, 122.19it/s] 35%|██████████████████████████████████                                                               | 2629/7473 [00:21<00:39, 121.73it/s] 35%|██████████████████████████████████▎                                                              | 2642/7473 [00:21<00:39, 122.39it/s] 36%|██████████████████████████████████▍                                                              | 2655/7473 [00:21<00:39, 122.87it/s] 36%|██████████████████████████████████▋                                                              | 2668/7473 [00:22<00:38, 123.49it/s] 36%|██████████████████████████████████▊                                                              | 2681/7473 [00:22<00:38, 123.78it/s] 36%|██████████████████████████████████▉                                                              | 2694/7473 [00:22<00:38, 124.15it/s] 36%|███████████████████████████████████▏                                                             | 2707/7473 [00:22<00:38, 124.02it/s] 36%|███████████████████████████████████▎                                                             | 2720/7473 [00:22<00:38, 124.17it/s] 37%|███████████████████████████████████▍                                                             | 2733/7473 [00:22<00:38, 123.70it/s] 37%|███████████████████████████████████▋                                                             | 2746/7473 [00:22<00:38, 122.52it/s] 37%|███████████████████████████████████▊                                                             | 2759/7473 [00:22<00:38, 123.02it/s] 37%|███████████████████████████████████▉                                                             | 2772/7473 [00:22<00:38, 123.38it/s] 37%|████████████████████████████████████▏                                                            | 2785/7473 [00:22<00:37, 123.77it/s] 37%|████████████████████████████████████▎                                                            | 2798/7473 [00:23<00:37, 123.87it/s] 38%|████████████████████████████████████▍                                                            | 2811/7473 [00:23<00:37, 124.15it/s] 38%|████████████████████████████████████▋                                                            | 2824/7473 [00:23<00:37, 124.29it/s] 38%|████████████████████████████████████▊                                                            | 2837/7473 [00:23<00:37, 123.29it/s] 38%|████████████████████████████████████▉                                                            | 2850/7473 [00:23<00:37, 123.32it/s] 38%|█████████████████████████████████████▏                                                           | 2863/7473 [00:23<00:38, 120.10it/s] 38%|█████████████████████████████████████▎                                                           | 2876/7473 [00:23<00:37, 121.17it/s] 39%|█████████████████████████████████████▍                                                           | 2889/7473 [00:23<00:37, 121.80it/s] 39%|█████████████████████████████████████▋                                                           | 2902/7473 [00:23<00:37, 122.53it/s] 39%|█████████████████████████████████████▊                                                           | 2915/7473 [00:24<00:36, 123.33it/s] 39%|██████████████████████████████████████                                                           | 2928/7473 [00:24<00:36, 123.97it/s] 39%|██████████████████████████████████████▏                                                          | 2941/7473 [00:24<00:36, 124.28it/s] 40%|██████████████████████████████████████▎                                                          | 2954/7473 [00:24<00:36, 124.47it/s] 40%|██████████████████████████████████████▌                                                          | 2967/7473 [00:24<00:36, 124.85it/s] 40%|██████████████████████████████████████▋                                                          | 2980/7473 [00:24<00:36, 122.69it/s] 40%|██████████████████████████████████████▊                                                          | 2993/7473 [00:24<00:36, 123.38it/s] 40%|███████████████████████████████████████                                                          | 3006/7473 [00:24<00:36, 122.88it/s] 40%|███████████████████████████████████████▏                                                         | 3019/7473 [00:24<00:36, 123.40it/s] 41%|███████████████████████████████████████▎                                                         | 3032/7473 [00:24<00:35, 123.65it/s] 41%|███████████████████████████████████████▌                                                         | 3045/7473 [00:25<00:36, 122.87it/s] 41%|███████████████████████████████████████▋                                                         | 3058/7473 [00:25<00:35, 123.28it/s] 41%|███████████████████████████████████████▊                                                         | 3071/7473 [00:25<00:35, 123.70it/s] 41%|████████████████████████████████████████                                                         | 3084/7473 [00:25<00:35, 123.90it/s] 41%|████████████████████████████████████████▏                                                        | 3097/7473 [00:25<00:35, 124.15it/s] 42%|████████████████████████████████████████▎                                                        | 3110/7473 [00:25<00:35, 123.96it/s] 42%|████████████████████████████████████████▌                                                        | 3123/7473 [00:25<00:35, 123.96it/s] 42%|████████████████████████████████████████▋                                                        | 3136/7473 [00:25<00:35, 123.50it/s] 42%|████████████████████████████████████████▊                                                        | 3149/7473 [00:25<00:34, 123.78it/s] 42%|█████████████████████████████████████████                                                        | 3162/7473 [00:26<00:34, 123.80it/s] 42%|█████████████████████████████████████████▏                                                       | 3175/7473 [00:26<00:34, 123.96it/s] 43%|█████████████████████████████████████████▍                                                       | 3188/7473 [00:26<00:34, 124.02it/s] 43%|█████████████████████████████████████████▌                                                       | 3201/7473 [00:26<00:34, 122.86it/s] 43%|█████████████████████████████████████████▋                                                       | 3214/7473 [00:26<00:34, 123.17it/s] 43%|█████████████████████████████████████████▉                                                       | 3227/7473 [00:26<00:34, 123.17it/s] 43%|██████████████████████████████████████████                                                       | 3240/7473 [00:26<00:34, 123.62it/s] 44%|██████████████████████████████████████████▏                                                      | 3253/7473 [00:26<00:34, 124.08it/s] 44%|██████████████████████████████████████████▍                                                      | 3266/7473 [00:26<00:33, 124.32it/s] 44%|██████████████████████████████████████████▌                                                      | 3279/7473 [00:26<00:33, 124.12it/s] 44%|██████████████████████████████████████████▋                                                      | 3292/7473 [00:27<00:33, 124.24it/s] 44%|██████████████████████████████████████████▉                                                      | 3305/7473 [00:27<00:33, 124.51it/s] 44%|███████████████████████████████████████████                                                      | 3318/7473 [00:27<00:33, 124.23it/s] 45%|███████████████████████████████████████████▏                                                     | 3331/7473 [00:27<00:33, 123.41it/s] 45%|███████████████████████████████████████████▍                                                     | 3344/7473 [00:27<00:33, 123.55it/s] 45%|███████████████████████████████████████████▌                                                     | 3357/7473 [00:27<00:33, 123.87it/s] 45%|███████████████████████████████████████████▋                                                     | 3370/7473 [00:27<00:33, 124.22it/s] 45%|███████████████████████████████████████████▉                                                     | 3383/7473 [00:27<00:33, 123.75it/s] 45%|████████████████████████████████████████████                                                     | 3396/7473 [00:27<00:32, 123.79it/s] 46%|████████████████████████████████████████████▏                                                    | 3409/7473 [00:28<00:32, 124.25it/s] 46%|████████████████████████████████████████████▍                                                    | 3422/7473 [00:28<00:32, 124.30it/s] 46%|████████████████████████████████████████████▌                                                    | 3435/7473 [00:28<00:32, 122.49it/s] 46%|████████████████████████████████████████████▊                                                    | 3448/7473 [00:28<00:32, 122.72it/s] 46%|████████████████████████████████████████████▉                                                    | 3461/7473 [00:28<00:32, 123.30it/s] 46%|█████████████████████████████████████████████                                                    | 3474/7473 [00:28<00:32, 123.75it/s] 47%|█████████████████████████████████████████████▎                                                   | 3487/7473 [00:28<00:32, 124.26it/s] 47%|█████████████████████████████████████████████▍                                                   | 3500/7473 [00:28<00:32, 123.78it/s] 47%|█████████████████████████████████████████████▌                                                   | 3513/7473 [00:28<00:31, 124.12it/s] 47%|█████████████████████████████████████████████▊                                                   | 3526/7473 [00:28<00:31, 124.26it/s] 47%|█████████████████████████████████████████████▉                                                   | 3539/7473 [00:29<00:31, 124.21it/s] 48%|██████████████████████████████████████████████                                                   | 3552/7473 [00:29<00:31, 123.67it/s] 48%|██████████████████████████████████████████████▎                                                  | 3565/7473 [00:29<00:31, 124.12it/s] 48%|██████████████████████████████████████████████▍                                                  | 3578/7473 [00:29<00:31, 124.41it/s] 48%|██████████████████████████████████████████████▌                                                  | 3591/7473 [00:29<00:31, 124.43it/s] 48%|██████████████████████████████████████████████▊                                                  | 3604/7473 [00:29<00:31, 123.96it/s] 48%|██████████████████████████████████████████████▉                                                  | 3617/7473 [00:29<00:31, 124.11it/s] 49%|███████████████████████████████████████████████                                                  | 3630/7473 [00:29<00:30, 124.28it/s] 49%|███████████████████████████████████████████████▎                                                 | 3643/7473 [00:29<00:30, 123.86it/s] 49%|███████████████████████████████████████████████▍                                                 | 3656/7473 [00:30<00:31, 121.91it/s] 49%|███████████████████████████████████████████████▌                                                 | 3669/7473 [00:30<00:31, 121.95it/s] 49%|███████████████████████████████████████████████▊                                                 | 3682/7473 [00:30<00:30, 122.76it/s] 49%|███████████████████████████████████████████████▉                                                 | 3695/7473 [00:30<00:30, 123.35it/s] 50%|████████████████████████████████████████████████▏                                                | 3708/7473 [00:30<00:30, 123.33it/s] 50%|████████████████████████████████████████████████▎                                                | 3721/7473 [00:30<00:30, 123.73it/s] 50%|████████████████████████████████████████████████▍                                                | 3734/7473 [00:30<00:30, 123.93it/s] 50%|████████████████████████████████████████████████▋                                                | 3747/7473 [00:30<00:30, 124.12it/s] 50%|████████████████████████████████████████████████▊                                                | 3760/7473 [00:30<00:29, 123.78it/s] 50%|████████████████████████████████████████████████▉                                                | 3773/7473 [00:30<00:29, 123.99it/s] 51%|█████████████████████████████████████████████████▏                                               | 3786/7473 [00:31<00:29, 124.28it/s] 51%|█████████████████████████████████████████████████▎                                               | 3799/7473 [00:31<00:29, 123.81it/s] 51%|█████████████████████████████████████████████████▍                                               | 3812/7473 [00:31<00:29, 123.71it/s] 51%|█████████████████████████████████████████████████▋                                               | 3825/7473 [00:31<00:29, 123.61it/s] 51%|█████████████████████████████████████████████████▊                                               | 3838/7473 [00:31<00:29, 123.82it/s] 52%|█████████████████████████████████████████████████▉                                               | 3851/7473 [00:31<00:29, 124.21it/s] 52%|██████████████████████████████████████████████████▏                                              | 3864/7473 [00:31<00:29, 124.03it/s] 52%|██████████████████████████████████████████████████▎                                              | 3877/7473 [00:31<00:29, 123.99it/s] 52%|██████████████████████████████████████████████████▍                                              | 3890/7473 [00:31<00:29, 122.30it/s] 52%|██████████████████████████████████████████████████▋                                              | 3903/7473 [00:32<00:28, 123.12it/s] 52%|██████████████████████████████████████████████████▊                                              | 3916/7473 [00:32<00:28, 123.54it/s] 53%|██████████████████████████████████████████████████▉                                              | 3929/7473 [00:32<00:28, 123.72it/s] 53%|███████████████████████████████████████████████████▏                                             | 3942/7473 [00:32<00:28, 123.92it/s] 53%|███████████████████████████████████████████████████▎                                             | 3955/7473 [00:32<00:28, 124.06it/s] 53%|███████████████████████████████████████████████████▌                                             | 3968/7473 [00:32<00:28, 124.14it/s] 53%|███████████████████████████████████████████████████▋                                             | 3981/7473 [00:32<00:28, 124.22it/s] 53%|███████████████████████████████████████████████████▊                                             | 3994/7473 [00:32<00:27, 124.29it/s] 54%|████████████████████████████████████████████████████                                             | 4007/7473 [00:32<00:27, 124.67it/s] 54%|████████████████████████████████████████████████████▏                                            | 4020/7473 [00:32<00:27, 124.62it/s] 54%|████████████████████████████████████████████████████▎                                            | 4033/7473 [00:33<00:27, 124.73it/s] 54%|████████████████████████████████████████████████████▌                                            | 4046/7473 [00:33<00:27, 124.79it/s] 54%|████████████████████████████████████████████████████▋                                            | 4059/7473 [00:33<00:27, 124.38it/s] 54%|████████████████████████████████████████████████████▊                                            | 4072/7473 [00:33<00:27, 121.98it/s] 55%|█████████████████████████████████████████████████████                                            | 4085/7473 [00:33<00:27, 121.80it/s] 55%|█████████████████████████████████████████████████████▏                                           | 4098/7473 [00:33<00:27, 122.66it/s] 55%|█████████████████████████████████████████████████████▎                                           | 4111/7473 [00:33<00:27, 121.39it/s] 55%|█████████████████████████████████████████████████████▌                                           | 4124/7473 [00:33<00:27, 122.05it/s] 55%|█████████████████████████████████████████████████████▋                                           | 4137/7473 [00:33<00:27, 122.22it/s] 56%|█████████████████████████████████████████████████████▊                                           | 4150/7473 [00:34<00:27, 122.80it/s] 56%|██████████████████████████████████████████████████████                                           | 4163/7473 [00:34<00:26, 123.56it/s] 56%|██████████████████████████████████████████████████████▏                                          | 4176/7473 [00:34<00:26, 123.37it/s] 56%|██████████████████████████████████████████████████████▎                                          | 4189/7473 [00:34<00:26, 123.61it/s] 56%|██████████████████████████████████████████████████████▌                                          | 4202/7473 [00:34<00:26, 124.15it/s] 56%|██████████████████████████████████████████████████████▋                                          | 4215/7473 [00:34<00:26, 123.47it/s] 57%|██████████████████████████████████████████████████████▉                                          | 4228/7473 [00:34<00:26, 122.26it/s] 57%|███████████████████████████████████████████████████████                                          | 4241/7473 [00:34<00:26, 123.01it/s] 57%|███████████████████████████████████████████████████████▏                                         | 4254/7473 [00:34<00:26, 123.30it/s] 57%|███████████████████████████████████████████████████████▍                                         | 4267/7473 [00:34<00:25, 123.74it/s] 57%|███████████████████████████████████████████████████████▌                                         | 4280/7473 [00:35<00:25, 123.33it/s] 57%|███████████████████████████████████████████████████████▋                                         | 4293/7473 [00:35<00:25, 123.69it/s] 58%|███████████████████████████████████████████████████████▉                                         | 4306/7473 [00:35<00:25, 123.97it/s] 58%|████████████████████████████████████████████████████████                                         | 4319/7473 [00:35<00:25, 124.18it/s] 58%|████████████████████████████████████████████████████████▏                                        | 4332/7473 [00:35<00:25, 124.39it/s] 58%|████████████████████████████████████████████████████████▍                                        | 4345/7473 [00:35<00:25, 122.80it/s] 58%|████████████████████████████████████████████████████████▌                                        | 4358/7473 [00:35<00:25, 122.98it/s] 58%|████████████████████████████████████████████████████████▋                                        | 4371/7473 [00:35<00:25, 123.38it/s] 59%|████████████████████████████████████████████████████████▉                                        | 4384/7473 [00:35<00:25, 123.21it/s] 59%|█████████████████████████████████████████████████████████                                        | 4397/7473 [00:35<00:24, 123.78it/s] 59%|█████████████████████████████████████████████████████████▏                                       | 4410/7473 [00:36<00:24, 123.71it/s] 59%|█████████████████████████████████████████████████████████▍                                       | 4423/7473 [00:36<00:24, 123.96it/s] 59%|█████████████████████████████████████████████████████████▌                                       | 4436/7473 [00:36<00:24, 123.82it/s] 60%|█████████████████████████████████████████████████████████▋                                       | 4449/7473 [00:36<00:24, 123.91it/s] 60%|█████████████████████████████████████████████████████████▉                                       | 4462/7473 [00:36<00:24, 124.05it/s] 60%|██████████████████████████████████████████████████████████                                       | 4475/7473 [00:36<00:24, 124.34it/s] 60%|██████████████████████████████████████████████████████████▎                                      | 4488/7473 [00:36<00:24, 124.09it/s] 60%|██████████████████████████████████████████████████████████▍                                      | 4501/7473 [00:36<00:23, 124.13it/s] 60%|██████████████████████████████████████████████████████████▌                                      | 4514/7473 [00:36<00:24, 122.25it/s] 61%|██████████████████████████████████████████████████████████▊                                      | 4527/7473 [00:37<00:24, 122.14it/s] 61%|██████████████████████████████████████████████████████████▉                                      | 4540/7473 [00:37<00:23, 122.96it/s] 61%|███████████████████████████████████████████████████████████                                      | 4553/7473 [00:37<00:23, 123.53it/s] 61%|███████████████████████████████████████████████████████████▎                                     | 4566/7473 [00:37<00:23, 122.38it/s] 61%|███████████████████████████████████████████████████████████▍                                     | 4579/7473 [00:37<00:23, 122.51it/s] 61%|███████████████████████████████████████████████████████████▌                                     | 4592/7473 [00:37<00:23, 122.72it/s] 62%|███████████████████████████████████████████████████████████▊                                     | 4605/7473 [00:37<00:23, 123.14it/s] 62%|███████████████████████████████████████████████████████████▉                                     | 4618/7473 [00:37<00:23, 123.67it/s] 62%|████████████████████████████████████████████████████████████                                     | 4631/7473 [00:37<00:23, 123.36it/s] 62%|████████████████████████████████████████████████████████████▎                                    | 4644/7473 [00:38<00:22, 123.62it/s] 62%|████████████████████████████████████████████████████████████▍                                    | 4657/7473 [00:38<00:22, 123.80it/s] 62%|████████████████████████████████████████████████████████████▌                                    | 4670/7473 [00:38<00:22, 124.04it/s] 63%|████████████████████████████████████████████████████████████▊                                    | 4683/7473 [00:38<00:22, 123.85it/s] 63%|████████████████████████████████████████████████████████████▉                                    | 4696/7473 [00:38<00:22, 124.03it/s] 63%|█████████████████████████████████████████████████████████████                                    | 4709/7473 [00:38<00:22, 124.12it/s] 63%|█████████████████████████████████████████████████████████████▎                                   | 4722/7473 [00:38<00:22, 124.37it/s] 63%|█████████████████████████████████████████████████████████████▍                                   | 4735/7473 [00:38<00:22, 123.90it/s] 64%|█████████████████████████████████████████████████████████████▋                                   | 4748/7473 [00:38<00:21, 124.20it/s] 64%|█████████████████████████████████████████████████████████████▊                                   | 4761/7473 [00:38<00:21, 124.36it/s] 64%|█████████████████████████████████████████████████████████████▉                                   | 4774/7473 [00:39<00:21, 124.49it/s] 64%|██████████████████████████████████████████████████████████████▏                                  | 4787/7473 [00:39<00:21, 123.60it/s] 64%|██████████████████████████████████████████████████████████████▎                                  | 4800/7473 [00:39<00:21, 121.82it/s] 64%|██████████████████████████████████████████████████████████████▍                                  | 4813/7473 [00:39<00:21, 122.75it/s] 65%|██████████████████████████████████████████████████████████████▋                                  | 4826/7473 [00:39<00:21, 123.30it/s] 65%|██████████████████████████████████████████████████████████████▊                                  | 4839/7473 [00:39<00:21, 123.52it/s] 65%|██████████████████████████████████████████████████████████████▉                                  | 4852/7473 [00:39<00:21, 123.67it/s] 65%|███████████████████████████████████████████████████████████████▏                                 | 4865/7473 [00:39<00:21, 123.96it/s] 65%|███████████████████████████████████████████████████████████████▎                                 | 4878/7473 [00:39<00:20, 123.66it/s] 65%|███████████████████████████████████████████████████████████████▍                                 | 4891/7473 [00:39<00:20, 124.01it/s] 66%|███████████████████████████████████████████████████████████████▋                                 | 4904/7473 [00:40<00:20, 124.30it/s] 66%|███████████████████████████████████████████████████████████████▊                                 | 4917/7473 [00:40<00:20, 124.26it/s] 66%|███████████████████████████████████████████████████████████████▉                                 | 4930/7473 [00:40<00:20, 122.77it/s] 66%|████████████████████████████████████████████████████████████████▏                                | 4943/7473 [00:40<00:21, 120.21it/s] 66%|████████████████████████████████████████████████████████████████▎                                | 4956/7473 [00:40<00:20, 120.62it/s] 66%|████████████████████████████████████████████████████████████████▍                                | 4969/7473 [00:40<00:20, 121.59it/s] 67%|████████████████████████████████████████████████████████████████▋                                | 4982/7473 [00:40<00:20, 122.53it/s] 67%|████████████████████████████████████████████████████████████████▊                                | 4995/7473 [00:40<00:20, 122.68it/s] 67%|█████████████████████████████████████████████████████████████████                                | 5008/7473 [00:40<00:19, 123.57it/s] 67%|█████████████████████████████████████████████████████████████████▏                               | 5021/7473 [00:41<00:20, 122.49it/s] 67%|█████████████████████████████████████████████████████████████████▎                               | 5034/7473 [00:41<00:19, 122.86it/s] 68%|█████████████████████████████████████████████████████████████████▌                               | 5047/7473 [00:41<00:19, 123.44it/s] 68%|█████████████████████████████████████████████████████████████████▋                               | 5060/7473 [00:41<00:19, 123.68it/s] 68%|█████████████████████████████████████████████████████████████████▊                               | 5073/7473 [00:41<00:19, 123.20it/s] 68%|██████████████████████████████████████████████████████████████████                               | 5086/7473 [00:41<00:19, 123.16it/s] 68%|██████████████████████████████████████████████████████████████████▏                              | 5099/7473 [00:41<00:19, 123.62it/s] 68%|██████████████████████████████████████████████████████████████████▎                              | 5112/7473 [00:41<00:19, 124.03it/s] 69%|██████████████████████████████████████████████████████████████████▌                              | 5125/7473 [00:41<00:18, 124.23it/s] 69%|██████████████████████████████████████████████████████████████████▋                              | 5138/7473 [00:42<00:18, 124.40it/s] 69%|██████████████████████████████████████████████████████████████████▊                              | 5151/7473 [00:42<00:18, 124.64it/s] 69%|███████████████████████████████████████████████████████████████████                              | 5164/7473 [00:42<00:18, 124.77it/s] 69%|███████████████████████████████████████████████████████████████████▏                             | 5177/7473 [00:42<00:18, 125.01it/s] 69%|███████████████████████████████████████████████████████████████████▎                             | 5190/7473 [00:42<00:18, 124.98it/s] 70%|███████████████████████████████████████████████████████████████████▌                             | 5203/7473 [00:42<00:18, 124.90it/s] 70%|███████████████████████████████████████████████████████████████████▋                             | 5216/7473 [00:42<00:18, 124.24it/s] 70%|███████████████████████████████████████████████████████████████████▊                             | 5229/7473 [00:42<00:18, 123.58it/s] 70%|████████████████████████████████████████████████████████████████████                             | 5242/7473 [00:42<00:18, 123.85it/s] 70%|████████████████████████████████████████████████████████████████████▏                            | 5255/7473 [00:43<00:20, 106.55it/s] 70%|████████████████████████████████████████████████████████████████████▍                            | 5268/7473 [00:43<00:19, 111.32it/s] 71%|████████████████████████████████████████████████████████████████████▌                            | 5281/7473 [00:43<00:19, 115.10it/s] 71%|████████████████████████████████████████████████████████████████████▋                            | 5294/7473 [00:43<00:18, 117.88it/s] 71%|████████████████████████████████████████████████████████████████████▉                            | 5307/7473 [00:43<00:18, 119.73it/s] 71%|█████████████████████████████████████████████████████████████████████                            | 5320/7473 [00:43<00:17, 120.81it/s] 71%|█████████████████████████████████████████████████████████████████████▏                           | 5333/7473 [00:43<00:17, 120.49it/s] 72%|█████████████████████████████████████████████████████████████████████▍                           | 5346/7473 [00:43<00:17, 121.38it/s] 72%|█████████████████████████████████████████████████████████████████████▌                           | 5359/7473 [00:43<00:17, 122.40it/s] 72%|█████████████████████████████████████████████████████████████████████▋                           | 5372/7473 [00:43<00:17, 122.77it/s] 72%|█████████████████████████████████████████████████████████████████████▉                           | 5385/7473 [00:44<00:16, 123.35it/s] 72%|██████████████████████████████████████████████████████████████████████                           | 5398/7473 [00:44<00:16, 123.83it/s] 72%|██████████████████████████████████████████████████████████████████████▏                          | 5411/7473 [00:44<00:16, 124.25it/s] 73%|██████████████████████████████████████████████████████████████████████▍                          | 5424/7473 [00:44<00:16, 124.27it/s] 73%|██████████████████████████████████████████████████████████████████████▌                          | 5437/7473 [00:44<00:16, 124.37it/s] 73%|██████████████████████████████████████████████████████████████████████▋                          | 5450/7473 [00:44<00:16, 124.64it/s] 73%|██████████████████████████████████████████████████████████████████████▉                          | 5463/7473 [00:44<00:16, 124.56it/s] 73%|███████████████████████████████████████████████████████████████████████▊                          | 5476/7473 [00:45<00:27, 72.76it/s] 73%|███████████████████████████████████████████████████████████████████████▉                          | 5489/7473 [00:45<00:23, 83.22it/s] 74%|████████████████████████████████████████████████████████████████████████▏                         | 5502/7473 [00:45<00:21, 92.50it/s] 74%|████████████████████████████████████████████████████████████████████████▎                         | 5515/7473 [00:45<00:19, 99.90it/s] 74%|███████████████████████████████████████████████████████████████████████▊                         | 5528/7473 [00:45<00:18, 106.02it/s] 74%|███████████████████████████████████████████████████████████████████████▉                         | 5541/7473 [00:45<00:17, 111.06it/s] 74%|████████████████████████████████████████████████████████████████████████                         | 5554/7473 [00:45<00:16, 115.01it/s] 74%|████████████████████████████████████████████████████████████████████████▎                        | 5567/7473 [00:45<00:16, 117.61it/s] 75%|████████████████████████████████████████████████████████████████████████▍                        | 5580/7473 [00:45<00:15, 119.43it/s] 75%|████████████████████████████████████████████████████████████████████████▌                        | 5593/7473 [00:45<00:15, 120.63it/s] 75%|████████████████████████████████████████████████████████████████████████▊                        | 5606/7473 [00:46<00:15, 121.98it/s] 75%|████████████████████████████████████████████████████████████████████████▉                        | 5619/7473 [00:46<00:15, 122.62it/s] 75%|█████████████████████████████████████████████████████████████████████████                        | 5632/7473 [00:46<00:14, 122.91it/s] 76%|█████████████████████████████████████████████████████████████████████████▎                       | 5645/7473 [00:46<00:14, 123.43it/s] 76%|█████████████████████████████████████████████████████████████████████████▍                       | 5658/7473 [00:46<00:14, 124.21it/s] 76%|█████████████████████████████████████████████████████████████████████████▌                       | 5671/7473 [00:46<00:14, 124.01it/s] 76%|█████████████████████████████████████████████████████████████████████████▊                       | 5684/7473 [00:46<00:14, 122.62it/s] 76%|█████████████████████████████████████████████████████████████████████████▉                       | 5697/7473 [00:46<00:14, 123.39it/s] 76%|██████████████████████████████████████████████████████████████████████████                       | 5710/7473 [00:46<00:14, 123.64it/s] 77%|██████████████████████████████████████████████████████████████████████████▎                      | 5723/7473 [00:47<00:14, 123.54it/s] 77%|██████████████████████████████████████████████████████████████████████████▍                      | 5736/7473 [00:47<00:14, 122.63it/s] 77%|██████████████████████████████████████████████████████████████████████████▌                      | 5749/7473 [00:47<00:13, 123.53it/s] 77%|██████████████████████████████████████████████████████████████████████████▊                      | 5762/7473 [00:47<00:13, 124.01it/s] 77%|██████████████████████████████████████████████████████████████████████████▉                      | 5775/7473 [00:47<00:13, 123.97it/s] 77%|███████████████████████████████████████████████████████████████████████████▏                     | 5788/7473 [00:47<00:13, 124.00it/s] 78%|███████████████████████████████████████████████████████████████████████████▎                     | 5801/7473 [00:47<00:13, 124.36it/s] 78%|███████████████████████████████████████████████████████████████████████████▍                     | 5814/7473 [00:47<00:13, 124.41it/s] 78%|███████████████████████████████████████████████████████████████████████████▋                     | 5827/7473 [00:47<00:13, 124.37it/s] 78%|███████████████████████████████████████████████████████████████████████████▊                     | 5840/7473 [00:47<00:13, 123.71it/s] 78%|███████████████████████████████████████████████████████████████████████████▉                     | 5853/7473 [00:48<00:13, 124.06it/s] 78%|████████████████████████████████████████████████████████████████████████████▏                    | 5866/7473 [00:48<00:12, 124.24it/s] 79%|████████████████████████████████████████████████████████████████████████████▎                    | 5879/7473 [00:48<00:12, 124.42it/s] 79%|████████████████████████████████████████████████████████████████████████████▍                    | 5892/7473 [00:48<00:12, 124.39it/s] 79%|████████████████████████████████████████████████████████████████████████████▋                    | 5905/7473 [00:48<00:12, 123.04it/s] 79%|████████████████████████████████████████████████████████████████████████████▊                    | 5918/7473 [00:48<00:12, 123.56it/s] 79%|████████████████████████████████████████████████████████████████████████████▉                    | 5931/7473 [00:48<00:12, 123.86it/s] 80%|█████████████████████████████████████████████████████████████████████████████▏                   | 5944/7473 [00:48<00:12, 124.02it/s] 80%|█████████████████████████████████████████████████████████████████████████████▎                   | 5957/7473 [00:48<00:12, 123.85it/s] 80%|█████████████████████████████████████████████████████████████████████████████▍                   | 5970/7473 [00:49<00:12, 123.77it/s] 80%|█████████████████████████████████████████████████████████████████████████████▋                   | 5983/7473 [00:49<00:11, 124.32it/s] 80%|█████████████████████████████████████████████████████████████████████████████▊                   | 5996/7473 [00:49<00:11, 124.51it/s] 80%|█████████████████████████████████████████████████████████████████████████████▉                   | 6009/7473 [00:49<00:11, 123.61it/s] 81%|██████████████████████████████████████████████████████████████████████████████▏                  | 6022/7473 [00:49<00:11, 123.91it/s] 81%|██████████████████████████████████████████████████████████████████████████████▎                  | 6035/7473 [00:49<00:11, 124.27it/s] 81%|██████████████████████████████████████████████████████████████████████████████▌                  | 6048/7473 [00:49<00:11, 124.56it/s] 81%|██████████████████████████████████████████████████████████████████████████████▋                  | 6061/7473 [00:49<00:11, 124.77it/s] 81%|██████████████████████████████████████████████████████████████████████████████▊                  | 6074/7473 [00:49<00:11, 125.03it/s] 81%|███████████████████████████████████████████████████████████████████████████████                  | 6087/7473 [00:49<00:11, 125.09it/s] 82%|███████████████████████████████████████████████████████████████████████████████▏                 | 6100/7473 [00:50<00:11, 124.41it/s] 82%|███████████████████████████████████████████████████████████████████████████████▎                 | 6113/7473 [00:50<00:10, 124.20it/s] 82%|███████████████████████████████████████████████████████████████████████████████▌                 | 6126/7473 [00:50<00:10, 124.32it/s] 82%|███████████████████████████████████████████████████████████████████████████████▋                 | 6139/7473 [00:50<00:10, 123.19it/s] 82%|███████████████████████████████████████████████████████████████████████████████▊                 | 6152/7473 [00:50<00:10, 123.86it/s] 82%|████████████████████████████████████████████████████████████████████████████████                 | 6165/7473 [00:50<00:10, 124.18it/s] 83%|████████████████████████████████████████████████████████████████████████████████▏                | 6178/7473 [00:50<00:10, 124.23it/s] 83%|████████████████████████████████████████████████████████████████████████████████▎                | 6191/7473 [00:50<00:10, 124.49it/s] 83%|████████████████████████████████████████████████████████████████████████████████▌                | 6204/7473 [00:50<00:10, 124.79it/s] 83%|████████████████████████████████████████████████████████████████████████████████▋                | 6217/7473 [00:50<00:10, 124.88it/s] 83%|████████████████████████████████████████████████████████████████████████████████▊                | 6230/7473 [00:51<00:09, 124.67it/s] 84%|█████████████████████████████████████████████████████████████████████████████████                | 6243/7473 [00:51<00:09, 124.89it/s] 84%|█████████████████████████████████████████████████████████████████████████████████▏               | 6256/7473 [00:51<00:09, 124.89it/s] 84%|█████████████████████████████████████████████████████████████████████████████████▎               | 6269/7473 [00:51<00:09, 124.92it/s] 84%|█████████████████████████████████████████████████████████████████████████████████▌               | 6282/7473 [00:51<00:09, 124.24it/s] 84%|█████████████████████████████████████████████████████████████████████████████████▋               | 6295/7473 [00:51<00:09, 124.25it/s] 84%|█████████████████████████████████████████████████████████████████████████████████▉               | 6308/7473 [00:51<00:09, 124.34it/s] 85%|██████████████████████████████████████████████████████████████████████████████████               | 6321/7473 [00:51<00:09, 124.54it/s] 85%|██████████████████████████████████████████████████████████████████████████████████▏              | 6334/7473 [00:51<00:09, 124.76it/s] 85%|██████████████████████████████████████████████████████████████████████████████████▍              | 6347/7473 [00:52<00:09, 124.51it/s] 85%|██████████████████████████████████████████████████████████████████████████████████▌              | 6360/7473 [00:52<00:09, 123.24it/s] 85%|██████████████████████████████████████████████████████████████████████████████████▋              | 6373/7473 [00:52<00:08, 123.52it/s] 85%|██████████████████████████████████████████████████████████████████████████████████▉              | 6386/7473 [00:52<00:08, 123.83it/s] 86%|███████████████████████████████████████████████████████████████████████████████████              | 6399/7473 [00:52<00:08, 124.12it/s] 86%|███████████████████████████████████████████████████████████████████████████████████▏             | 6412/7473 [00:52<00:08, 124.21it/s] 86%|███████████████████████████████████████████████████████████████████████████████████▍             | 6425/7473 [00:52<00:08, 124.42it/s] 86%|███████████████████████████████████████████████████████████████████████████████████▌             | 6438/7473 [00:52<00:08, 124.62it/s] 86%|███████████████████████████████████████████████████████████████████████████████████▋             | 6451/7473 [00:52<00:08, 124.71it/s] 86%|███████████████████████████████████████████████████████████████████████████████████▉             | 6464/7473 [00:52<00:08, 124.93it/s] 87%|████████████████████████████████████████████████████████████████████████████████████             | 6477/7473 [00:53<00:07, 125.06it/s] 87%|████████████████████████████████████████████████████████████████████████████████████▏            | 6490/7473 [00:53<00:07, 124.99it/s] 87%|████████████████████████████████████████████████████████████████████████████████████▍            | 6503/7473 [00:53<00:07, 125.16it/s] 87%|████████████████████████████████████████████████████████████████████████████████████▌            | 6516/7473 [00:53<00:07, 124.93it/s] 87%|████████████████████████████████████████████████████████████████████████████████████▋            | 6529/7473 [00:53<00:07, 125.04it/s] 88%|████████████████████████████████████████████████████████████████████████████████████▉            | 6542/7473 [00:53<00:07, 125.13it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████            | 6555/7473 [00:53<00:07, 124.08it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████▎           | 6568/7473 [00:53<00:07, 124.35it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████▍           | 6581/7473 [00:53<00:07, 123.12it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████▌           | 6594/7473 [00:54<00:07, 123.16it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████▊           | 6607/7473 [00:54<00:07, 123.57it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████▉           | 6620/7473 [00:54<00:06, 123.46it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████           | 6633/7473 [00:54<00:06, 122.96it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████▎          | 6646/7473 [00:54<00:06, 122.92it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████▍          | 6659/7473 [00:54<00:06, 123.11it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████▌          | 6672/7473 [00:54<00:06, 123.23it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████▊          | 6685/7473 [00:54<00:06, 123.66it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████▉          | 6698/7473 [00:54<00:06, 124.17it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████          | 6711/7473 [00:54<00:06, 124.38it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████▎         | 6724/7473 [00:55<00:06, 124.46it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████▍         | 6737/7473 [00:55<00:05, 124.11it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████▌         | 6750/7473 [00:55<00:05, 124.29it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████▊         | 6763/7473 [00:55<00:05, 124.12it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████▉         | 6776/7473 [00:55<00:05, 124.14it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████         | 6789/7473 [00:55<00:05, 124.24it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████▎        | 6802/7473 [00:55<00:05, 124.23it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████▍        | 6815/7473 [00:55<00:05, 122.88it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████▋        | 6828/7473 [00:55<00:05, 122.40it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████▊        | 6841/7473 [00:56<00:05, 122.76it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████▉        | 6854/7473 [00:56<00:05, 123.42it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████▏       | 6867/7473 [00:56<00:04, 123.65it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████▎       | 6880/7473 [00:56<00:04, 124.06it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████▍       | 6893/7473 [00:56<00:04, 124.21it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████▋       | 6906/7473 [00:56<00:04, 124.59it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████▊       | 6919/7473 [00:56<00:04, 124.50it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████▉       | 6932/7473 [00:56<00:04, 124.40it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████▏      | 6945/7473 [00:56<00:04, 124.45it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████▎      | 6958/7473 [00:56<00:04, 123.38it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████▍      | 6971/7473 [00:57<00:04, 123.51it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████▋      | 6984/7473 [00:57<00:03, 123.70it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████▊      | 6997/7473 [00:57<00:03, 123.96it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████▉      | 7010/7473 [00:57<00:03, 124.02it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████▏     | 7023/7473 [00:57<00:03, 124.06it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████▎     | 7036/7473 [00:57<00:03, 122.61it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████▍     | 7049/7473 [00:57<00:03, 123.19it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████▋     | 7062/7473 [00:57<00:03, 123.47it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████▊     | 7075/7473 [00:57<00:03, 123.73it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████     | 7088/7473 [00:58<00:03, 123.68it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████▏    | 7101/7473 [00:58<00:03, 123.04it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████▎    | 7114/7473 [00:58<00:02, 122.93it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████▌    | 7127/7473 [00:58<00:02, 123.36it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████▋    | 7140/7473 [00:58<00:02, 123.55it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████▊    | 7153/7473 [00:58<00:02, 123.88it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████    | 7166/7473 [00:58<00:02, 123.66it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████▏   | 7179/7473 [00:58<00:02, 124.04it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████▎   | 7192/7473 [00:58<00:02, 123.88it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████▌   | 7205/7473 [00:58<00:02, 123.92it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████▋   | 7218/7473 [00:59<00:02, 124.12it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████▊   | 7231/7473 [00:59<00:01, 124.44it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████   | 7244/7473 [00:59<00:01, 124.38it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████▏  | 7257/7473 [00:59<00:01, 122.99it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████▎  | 7270/7473 [00:59<00:01, 121.70it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████▌  | 7283/7473 [00:59<00:01, 122.63it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████▋  | 7296/7473 [00:59<00:01, 123.15it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████▊  | 7309/7473 [00:59<00:01, 123.42it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████  | 7322/7473 [00:59<00:01, 123.91it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████▏ | 7335/7473 [01:00<00:01, 123.85it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████▍ | 7348/7473 [01:00<00:01, 123.36it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████▌ | 7361/7473 [01:00<00:00, 123.63it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████▋ | 7374/7473 [01:00<00:00, 123.14it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████▉ | 7387/7473 [01:00<00:00, 123.21it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████ | 7400/7473 [01:00<00:00, 122.89it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████▏| 7413/7473 [01:00<00:00, 123.43it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████▍| 7426/7473 [01:00<00:00, 123.83it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████▌| 7439/7473 [01:00<00:00, 123.50it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████▋| 7452/7473 [01:00<00:00, 123.80it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████▉| 7465/7473 [01:01<00:00, 124.07it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 7473/7473 [01:01<00:00, 122.23it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:04<00:09,  4.92s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:04<00:09,  4.92s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.28s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.33s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:09<00:04,  4.92s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:09<00:04,  4.92s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.27s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.31s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.34s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.49s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.34s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.50s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.68s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.84s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.71s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.87s/it]
[2023-08-17 21:41:19,151] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
[2023-08-17 21:41:26,322] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-17 21:41:26,323] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-17 21:41:26,323] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-17 21:41:26,323] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-17 21:41:26,323] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-17 21:41:26,323] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-17 21:41:26,324] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-17 21:41:26,324] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-17 21:41:26,324] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-17 21:41:26,324] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-17 21:41:26,324] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-17 21:41:26,324] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f9d6431c760>
[2023-08-17 21:41:26,324] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-17 21:41:26,324] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-17 21:41:26,324] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-17 21:41:26,324] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-17 21:41:26,324] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-17 21:41:26,324] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-17 21:41:26,324] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-17 21:41:26,324] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-17 21:41:26,324] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-17 21:41:26,324] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-17 21:41:26,324] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-17 21:41:26,324] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-17 21:41:26,324] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-17 21:41:26,324] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-17 21:41:26,324] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-17 21:41:26,324] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-17 21:41:26,325] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-17 21:41:26,325] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-17 21:41:26,325] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-17 21:41:26,325] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-17 21:41:26,325] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-17 21:41:26,325] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-17 21:41:26,325] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-17 21:41:26,325] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-17 21:41:26,325] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-17 21:41:26,325] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-17 21:41:26,325] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-17 21:41:26,325] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-17 21:41:26,325] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-17 21:41:26,325] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-17 21:41:26,325] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-17 21:41:26,325] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-17 21:41:26,325] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f9d6431c1c0>
[2023-08-17 21:41:26,325] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-17 21:41:26,325] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-17 21:41:26,325] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-17 21:41:26,325] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-17 21:41:26,325] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-17 21:41:26,325] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-17 21:41:26,325] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-17 21:41:26,325] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-17 21:41:26,325] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-17 21:41:26,325] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-17 21:41:26,325] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-17 21:41:26,325] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-17 21:41:26,325] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-17 21:41:26,325] [INFO] [config.py:1012:print]   train_batch_size ............. 8
[2023-08-17 21:41:26,325] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  2
[2023-08-17 21:41:26,325] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-17 21:41:26,325] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-17 21:41:26,325] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-17 21:41:26,325] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-17 21:41:26,326] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-17 21:41:26,326] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-17 21:41:26,326] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-17 21:41:26,326] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.7888598442077637 seconds
Loading extension module utils...
Time to load utils op: 0.7051732540130615 seconds
Loading extension module utils...
Time to load utils op: 0.704972505569458 seconds
Loading extension module utils...
Time to load utils op: 0.7049343585968018 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating gsm8k :   0%|                                                                                           | 0/125 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following grade math question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: 1. The question is asking for a location where you would find plumbing that would be useless to you if you were thirsty.
2. This suggests that the location would either have no potable water supply or cannot provide drinkable water.
3. Let's examine each of the options:
   A: oil refineries - This is typically a place where crude oil is processed and refined, not a source of clean, drinkable water.
   B: wall - It's true a wall might contain plumbing, but it could include water pipes that supply potable water.
   C: show - This choice is unclear, but a show usually involves elements to entertain, not to hydrate. However, it's not directly related to plumbing, making it hard to ascertain.
   D: own home - Obviously in our own home, most of the time we have access to potable water.
   E: water fountain - This is clearly a source of drinkable water.
4. From the above analysis, the one option where the plumbing wouldn't be useful for attending to thirst is the oil refinery. So the answer is A: oil refineries.
So the final answer is A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Output: 1. The question is asking about the action that is not happening yet when a person is beginning a job/task.
2. Let's evaluate each choice individually.
3. Choice A: A person can't be working before they start work, but the question states they are beginning work. Therefore, the process of working is happening, so this option is incorrect.
4. Choice B: Resting could take place before, during, or after work. Hence, there isn't a specific correlation between beginning to work and resting, so this option is potentially valid.
5. Choice C: Tiredness is typically a result after work is done, but it could also happen during the work depending upon the nature of work. Similar to choice B, tiredness isn't distinctly connected to the process of beginning to work. Hence, this is also a potentially valid answer.
6. Choice D: Accomplishing is the state of achieving or completing the task. Since the person is just beginning their work, they can't have accomplished it yet. Therefore, this is a potentially valid option.
7. Choice E: Momentum refers to progress or development. Like accomplishing the task, momentum usually builds as the person actually starts working and is not instant the moment they begin work. This option is also a potentially valid answer.
8. Upon going through all options, the action that definitely doesn't take place when someone is beginning work is "accomplishing". This is because accomplishing signifies completion which logically cannot happen at the start of a task.
9. Therefore, the answer is D: accomplishing.
So the final answer is D: accomplishing

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Output: 1. All the options listed are places or things where one might find a pen.
2. However, the question specifically asks where one might find pens with a company logo.
3. Company logos are typically found on items used for brand promotion or corporate use.
4. An office is a place where business is conducted and where promotional items or company-branded objects are likely to be found.
5. Therefore, the answer is A: office.
So the final answer is A: office

Input: Billy called out to John, and listened for what? Choices:  A: silence B: response C: communication D: hanging up E: whisper
Output: 1. The problem describes a situation where Billy is calling out to John.
2. In scenarios like this, a common reaction is typically for the person called to reply back.
3. This interaction, which involves one person 'calling out' and the other'replying back', is categorized as communication.
4. Hence, we can infer that Billy expects some sort of reaction from John after the call out.
5. Looking at the options, let's evaluate which one matches our understanding of the situation.
6. 'Silence' would mean no reaction from John, which does not align with our scenario.
7. 'Hanging up' is related to a phone call process, which isn't the situation in this case.
8. 'Whisper' is a manner of response, but it's not explicitly mentioned in the question that John needs to respond in a low tone.
9. 'Communication' would be a possible answer, but it is a bit broad and not specific to the context of the question.
10. 'Response' aligns perfectly with our understanding of the situation, where after Billy calls out, he is expecting a reply or reaction from John.
11. Therefore, the answer is B: response.
So the final answer is B: response

Input: The lizard frightened the hiker, it's movements made what rustle? Choices:  A: garden B: trees C: books D: rocks E: bushes
Output: Step 1: This question is asking for what made a rustling sound due to the movements of the lizard.
Step 2: Going through each choice, we need to find the object which will make a rustling sound when moved.
Step 3: Starting with option A, gardens do not rustle, they are still and quiet spaces. So this is not correct. 
Step 4: Considering option B, trees. Trees do rustle in the wind but it is less likely that a small creature like a lizard could rustle a tree. So, trees is not the correct answer. 
Step 5: Option C, books, would not be found in the same environment as a lizard and hiker and wouldn't make a rustling sound due to the lizard's movements. Thus, it is incorrect.
Step 6: Option D, rocks, do not rustle. They are solid and generally unmoving objects. So they cannot be the answer either. 
Step 7: Finally, option E, bushes, would rustle if an animal, like a lizard, was moving through them.
Step 8: Thus, the answer is E: bushes. The lizard frightened the hiker as its movement made the bushes rustle.
So the final answer is E: bushes

Input: The man spent big money and time maintaining his lawn, it was part of keeping up with the Joneses where? Choices:  A: front yard B: suburbia C: neighborhood D: back yard E: golf course
Output: 1. The phrase "keeping up with the Joneses" is commonly used to describe the societal pressure one might feel to maintain the same level of wealth or lifestyle as their neighbors.
2. This phrase often applies to people living in the suburbs, where there can be implicit pressure to have a perfectly manicured lawn, a beautiful home, and so on.
3. Options A: front yard, D: back yard, and E: golf course are specific locations, while option C: neighborhood is less specific and can include urban or rural settings.
4. Thus, by understanding the contextual implications of the phrase "keeping up with the Joneses," we can confidently say the answer is B: suburbia.
So the final answer is B: suburbia

Input: What would a human do if they want to get to a store that he or she can see? Choices:  A: cross road B: see around C: drink coffee D: dream dreams E: think critically
Output: 1. The question is asking what action a person would typically take if they are trying to get to a visible store.
2. This suggests the need for some kind of movement or action directed towards the store.
3. We then review the response options to see which one best corresponds with this idea.
4. Choice A, "cross the road", implies movement towards a specific direction which could likely be towards the store. 
5. Choice B, "see around", doesn't necessarily imply movement towards the store, but rather observing the surroundings.
6. Choice C, "drink coffee," and Choice D, "dream dreams", are irrelevant as they do not suggest any action towards reaching the store.
7. Choice E, "think critically", implies mental action but doesn't suggest physical movement toward the store. 
8. Therefore, the most reasonable answer is A: cross the road, as it implies direct action towards reaching the store.
So the final answer is A: cross road
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o9-tcommonsenseqa-s1-rTrue
Evaluating gsm8k :   1%|▋                                                                                  | 1/125 [00:24<49:43, 24.06s/it]Evaluating gsm8k :   2%|█▎                                                                                 | 2/125 [00:47<48:30, 23.66s/it]Evaluating gsm8k :   2%|█▉                                                                                 | 3/125 [01:10<47:46, 23.49s/it]Evaluating gsm8k :   3%|██▋                                                                                | 4/125 [01:34<47:11, 23.40s/it]Evaluating gsm8k :   4%|███▎                                                                               | 5/125 [01:57<46:39, 23.33s/it]Evaluating gsm8k :   5%|███▉                                                                               | 6/125 [02:20<46:13, 23.31s/it]Evaluating gsm8k :   6%|████▋                                                                              | 7/125 [02:43<45:50, 23.31s/it]Evaluating gsm8k :   6%|█████▎                                                                             | 8/125 [02:45<32:16, 16.55s/it]Evaluating gsm8k :   7%|█████▉                                                                             | 9/125 [03:09<36:03, 18.65s/it]Evaluating gsm8k :   8%|██████▌                                                                           | 10/125 [03:32<38:34, 20.13s/it]Evaluating gsm8k :   9%|███████▏                                                                          | 11/125 [03:43<32:55, 17.33s/it]Evaluating gsm8k :  10%|███████▊                                                                          | 12/125 [04:06<36:02, 19.13s/it]Evaluating gsm8k :  10%|████████▌                                                                         | 13/125 [04:25<35:34, 19.06s/it]Evaluating gsm8k :  11%|█████████▏                                                                        | 14/125 [04:48<37:36, 20.33s/it]Evaluating gsm8k :  12%|█████████▊                                                                        | 15/125 [05:12<38:52, 21.20s/it]Evaluating gsm8k :  13%|██████████▍                                                                       | 16/125 [05:14<28:04, 15.46s/it]Evaluating gsm8k :  14%|███████████▏                                                                      | 17/125 [05:37<32:05, 17.83s/it]Evaluating gsm8k :  14%|███████████▊                                                                      | 18/125 [06:00<34:42, 19.46s/it]Evaluating gsm8k :  15%|████████████▍                                                                     | 19/125 [06:24<36:23, 20.59s/it]Evaluating gsm8k :  16%|█████████████                                                                     | 20/125 [06:47<37:26, 21.40s/it]Evaluating gsm8k :  17%|█████████████▊                                                                    | 21/125 [07:10<38:03, 21.95s/it]Evaluating gsm8k :  18%|██████████████▍                                                                   | 22/125 [07:33<38:24, 22.37s/it]Evaluating gsm8k :  18%|███████████████                                                                   | 23/125 [07:57<38:28, 22.63s/it]Evaluating gsm8k :  19%|███████████████▋                                                                  | 24/125 [08:13<34:59, 20.79s/it]Evaluating gsm8k :  20%|████████████████▍                                                                 | 25/125 [08:37<35:55, 21.56s/it]Evaluating gsm8k :  21%|█████████████████                                                                 | 26/125 [09:00<36:26, 22.09s/it]Evaluating gsm8k :  22%|█████████████████▋                                                                | 27/125 [09:22<36:04, 22.09s/it]Evaluating gsm8k :  22%|██████████████████▎                                                               | 28/125 [09:45<36:14, 22.42s/it]Evaluating gsm8k :  23%|███████████████████                                                               | 29/125 [10:08<36:15, 22.66s/it]Evaluating gsm8k :  24%|███████████████████▋                                                              | 30/125 [10:32<36:11, 22.86s/it]Evaluating gsm8k :  25%|████████████████████▎                                                             | 31/125 [10:55<36:01, 23.00s/it]Evaluating gsm8k :  26%|████████████████████▉                                                             | 32/125 [11:18<35:45, 23.06s/it]Evaluating gsm8k :  26%|█████████████████████▋                                                            | 33/125 [11:42<35:27, 23.12s/it]Evaluating gsm8k :  27%|██████████████████████▎                                                           | 34/125 [12:05<35:10, 23.19s/it]Evaluating gsm8k :  28%|██████████████████████▉                                                           | 35/125 [12:28<34:48, 23.20s/it]Evaluating gsm8k :  29%|███████████████████████▌                                                          | 36/125 [12:51<34:26, 23.22s/it]Evaluating gsm8k :  30%|████████████████████████▎                                                         | 37/125 [13:15<34:05, 23.24s/it]Evaluating gsm8k :  30%|████████████████████████▉                                                         | 38/125 [13:38<33:42, 23.25s/it]Evaluating gsm8k :  31%|█████████████████████████▌                                                        | 39/125 [14:01<33:17, 23.23s/it]Evaluating gsm8k :  32%|██████████████████████████▏                                                       | 40/125 [14:24<32:55, 23.24s/it]Evaluating gsm8k :  33%|██████████████████████████▉                                                       | 41/125 [14:48<32:29, 23.20s/it]Evaluating gsm8k :  34%|███████████████████████████▌                                                      | 42/125 [15:11<32:06, 23.22s/it]Evaluating gsm8k :  34%|████████████████████████████▏                                                     | 43/125 [15:34<31:44, 23.23s/it]Evaluating gsm8k :  35%|████████████████████████████▊                                                     | 44/125 [15:57<31:22, 23.24s/it]Evaluating gsm8k :  36%|█████████████████████████████▌                                                    | 45/125 [16:20<30:57, 23.22s/it]Evaluating gsm8k :  37%|██████████████████████████████▏                                                   | 46/125 [16:44<30:32, 23.20s/it]Evaluating gsm8k :  38%|██████████████████████████████▊                                                   | 47/125 [17:07<30:09, 23.19s/it]Evaluating gsm8k :  38%|███████████████████████████████▍                                                  | 48/125 [17:30<29:46, 23.20s/it]Evaluating gsm8k :  39%|████████████████████████████████▏                                                 | 49/125 [17:53<29:23, 23.20s/it]Evaluating gsm8k :  40%|████████████████████████████████▊                                                 | 50/125 [18:16<29:00, 23.21s/it]Evaluating gsm8k :  41%|█████████████████████████████████▍                                                | 51/125 [18:40<28:38, 23.22s/it]Evaluating gsm8k :  42%|██████████████████████████████████                                                | 52/125 [19:03<28:17, 23.25s/it]Evaluating gsm8k :  42%|██████████████████████████████████▊                                               | 53/125 [19:26<27:52, 23.22s/it]Evaluating gsm8k :  43%|███████████████████████████████████▍                                              | 54/125 [19:49<27:31, 23.26s/it]Evaluating gsm8k :  44%|████████████████████████████████████                                              | 55/125 [20:13<27:06, 23.23s/it]Evaluating gsm8k :  45%|████████████████████████████████████▋                                             | 56/125 [20:36<26:44, 23.25s/it]Evaluating gsm8k :  46%|█████████████████████████████████████▍                                            | 57/125 [20:59<26:20, 23.24s/it]Evaluating gsm8k :  46%|██████████████████████████████████████                                            | 58/125 [21:22<25:55, 23.22s/it]Evaluating gsm8k :  47%|██████████████████████████████████████▋                                           | 59/125 [21:46<25:31, 23.21s/it]Evaluating gsm8k :  48%|███████████████████████████████████████▎                                          | 60/125 [22:09<25:09, 23.23s/it]Evaluating gsm8k :  49%|████████████████████████████████████████                                          | 61/125 [22:32<24:44, 23.20s/it]Evaluating gsm8k :  50%|████████████████████████████████████████▋                                         | 62/125 [22:55<24:21, 23.20s/it]Evaluating gsm8k :  50%|█████████████████████████████████████████▎                                        | 63/125 [23:18<24:00, 23.23s/it]Evaluating gsm8k :  51%|█████████████████████████████████████████▉                                        | 64/125 [23:42<23:38, 23.25s/it]Evaluating gsm8k :  52%|██████████████████████████████████████████▋                                       | 65/125 [24:05<23:18, 23.30s/it]Evaluating gsm8k :  53%|███████████████████████████████████████████▎                                      | 66/125 [24:08<16:49, 17.11s/it]Evaluating gsm8k :  54%|███████████████████████████████████████████▉                                      | 67/125 [24:31<18:18, 18.94s/it]Evaluating gsm8k :  54%|████████████████████████████████████████████▌                                     | 68/125 [24:54<19:13, 20.24s/it]Evaluating gsm8k :  55%|█████████████████████████████████████████████▎                                    | 69/125 [25:12<18:04, 19.36s/it]Evaluating gsm8k :  56%|█████████████████████████████████████████████▉                                    | 70/125 [25:35<18:47, 20.50s/it]Evaluating gsm8k :  57%|██████████████████████████████████████████████▌                                   | 71/125 [25:58<19:12, 21.34s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▏                                  | 72/125 [26:18<18:34, 21.02s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▉                                  | 73/125 [26:42<18:49, 21.72s/it]Evaluating gsm8k :  59%|████████████████████████████████████████████████▌                                 | 74/125 [27:05<18:51, 22.18s/it]Evaluating gsm8k :  60%|█████████████████████████████████████████████████▏                                | 75/125 [27:28<18:45, 22.50s/it]Evaluating gsm8k :  61%|█████████████████████████████████████████████████▊                                | 76/125 [27:40<15:51, 19.43s/it]Evaluating gsm8k :  62%|██████████████████████████████████████████████████▌                               | 77/125 [28:04<16:25, 20.53s/it]Evaluating gsm8k :  62%|███████████████████████████████████████████████████▏                              | 78/125 [28:27<16:50, 21.50s/it]Evaluating gsm8k :  63%|███████████████████████████████████████████████████▊                              | 79/125 [28:50<16:50, 21.98s/it]Evaluating gsm8k :  64%|████████████████████████████████████████████████████▍                             | 80/125 [29:14<16:45, 22.34s/it]Evaluating gsm8k :  65%|█████████████████████████████████████████████████████▏                            | 81/125 [29:37<16:32, 22.57s/it]Evaluating gsm8k :  66%|█████████████████████████████████████████████████████▊                            | 82/125 [30:00<16:18, 22.76s/it]Evaluating gsm8k :  66%|██████████████████████████████████████████████████████▍                           | 83/125 [30:23<15:59, 22.85s/it]Evaluating gsm8k :  67%|███████████████████████████████████████████████████████                           | 84/125 [30:46<15:39, 22.91s/it]Evaluating gsm8k :  68%|███████████████████████████████████████████████████████▊                          | 85/125 [31:09<15:18, 22.97s/it]Evaluating gsm8k :  69%|████████████████████████████████████████████████████████▍                         | 86/125 [31:32<14:57, 23.01s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████                         | 87/125 [31:55<14:34, 23.01s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████▋                        | 88/125 [32:11<12:51, 20.85s/it]Evaluating gsm8k :  71%|██████████████████████████████████████████████████████████▍                       | 89/125 [32:34<12:54, 21.50s/it]Evaluating gsm8k :  72%|███████████████████████████████████████████████████████████                       | 90/125 [32:57<12:49, 21.99s/it]Evaluating gsm8k :  73%|███████████████████████████████████████████████████████████▋                      | 91/125 [33:20<12:39, 22.33s/it]Evaluating gsm8k :  74%|████████████████████████████████████████████████████████████▎                     | 92/125 [33:43<12:23, 22.52s/it]Evaluating gsm8k :  74%|█████████████████████████████████████████████████████████████                     | 93/125 [34:06<12:06, 22.71s/it]Evaluating gsm8k :  75%|█████████████████████████████████████████████████████████████▋                    | 94/125 [34:30<11:47, 22.83s/it]Evaluating gsm8k :  76%|██████████████████████████████████████████████████████████████▎                   | 95/125 [34:32<08:21, 16.71s/it]Evaluating gsm8k :  77%|██████████████████████████████████████████████████████████████▉                   | 96/125 [34:55<08:56, 18.50s/it]Evaluating gsm8k :  78%|███████████████████████████████████████████████████████████████▋                  | 97/125 [35:18<09:17, 19.90s/it]Evaluating gsm8k :  78%|████████████████████████████████████████████████████████████████▎                 | 98/125 [35:41<09:22, 20.84s/it]Evaluating gsm8k :  79%|████████████████████████████████████████████████████████████████▉                 | 99/125 [36:04<09:19, 21.53s/it]Evaluating gsm8k :  80%|████████████████████████████████████████████████████████████████▊                | 100/125 [36:27<09:10, 22.01s/it]Evaluating gsm8k :  81%|█████████████████████████████████████████████████████████████████▍               | 101/125 [36:50<08:56, 22.35s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████               | 102/125 [37:13<08:38, 22.56s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████▋              | 103/125 [37:36<08:20, 22.73s/it]Evaluating gsm8k :  83%|███████████████████████████████████████████████████████████████████▍             | 104/125 [38:00<07:59, 22.85s/it]Evaluating gsm8k :  84%|████████████████████████████████████████████████████████████████████             | 105/125 [38:21<07:30, 22.53s/it]Evaluating gsm8k :  85%|████████████████████████████████████████████████████████████████████▋            | 106/125 [38:45<07:11, 22.73s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▎           | 107/125 [39:08<06:51, 22.84s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▉           | 108/125 [39:31<06:30, 22.95s/it]Evaluating gsm8k :  87%|██████████████████████████████████████████████████████████████████████▋          | 109/125 [39:54<06:08, 23.03s/it]Evaluating gsm8k :  88%|███████████████████████████████████████████████████████████████████████▎         | 110/125 [40:17<05:45, 23.05s/it]Evaluating gsm8k :  89%|███████████████████████████████████████████████████████████████████████▉         | 111/125 [40:40<05:23, 23.09s/it]Evaluating gsm8k :  90%|████████████████████████████████████████████████████████████████████████▌        | 112/125 [41:04<05:00, 23.12s/it]Evaluating gsm8k :  90%|█████████████████████████████████████████████████████████████████████████▏       | 113/125 [41:27<04:37, 23.11s/it]Evaluating gsm8k :  91%|█████████████████████████████████████████████████████████████████████████▊       | 114/125 [41:50<04:14, 23.11s/it]Evaluating gsm8k :  92%|██████████████████████████████████████████████████████████████████████████▌      | 115/125 [42:00<03:13, 19.32s/it]Evaluating gsm8k :  93%|███████████████████████████████████████████████████████████████████████████▏     | 116/125 [42:23<03:04, 20.48s/it]Evaluating gsm8k :  94%|███████████████████████████████████████████████████████████████████████████▊     | 117/125 [42:46<02:50, 21.27s/it]Evaluating gsm8k :  94%|████████████████████████████████████████████████████████████████████████████▍    | 118/125 [43:10<02:32, 21.82s/it]Evaluating gsm8k :  95%|█████████████████████████████████████████████████████████████████████████████    | 119/125 [43:33<02:13, 22.20s/it]Evaluating gsm8k :  96%|█████████████████████████████████████████████████████████████████████████████▊   | 120/125 [43:56<01:52, 22.50s/it]Evaluating gsm8k :  97%|██████████████████████████████████████████████████████████████████████████████▍  | 121/125 [44:19<01:30, 22.69s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████  | 122/125 [44:42<01:08, 22.84s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████▋ | 123/125 [45:06<00:45, 22.98s/it]Evaluating gsm8k :  99%|████████████████████████████████████████████████████████████████████████████████▎| 124/125 [45:29<00:23, 23.06s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [45:52<00:00, 23.09s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [45:52<00:00, 22.02s/it]
name: gsm8k | {'exact_match': 0.0, 'rougeL': 0.0935} | lm_loss 10.3793 | avg. gen lenth: 395.564
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name gsm8k --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name commonsenseqa --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 2 --data-dir /scratch/ylu130/processed_data/gsm8k/out-domain/o1-tcommonsenseqa-s1-rFalse --seed 1 --max-prompt-length 2048 --num-out-domain 1
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-17 22:28:24,667] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... gsm8k
  data_dir ..................... /scratch/ylu130/processed_data/gsm8k/out-domain/o1-tcommonsenseqa-s1-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 1
  out_domain_data_name ......... commonsenseqa
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o1-tcommonsenseqa-s1-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 2
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                                             | 0/7473 [00:00<?, ?it/s]  3%|███▏                                                                                             | 248/7473 [00:00<00:02, 2467.54it/s]  7%|██████▍                                                                                          | 496/7473 [00:00<00:02, 2472.75it/s] 10%|█████████▊                                                                                       | 754/7473 [00:00<00:02, 2518.00it/s] 13%|████████████▉                                                                                   | 1007/7473 [00:00<00:02, 2521.97it/s] 17%|████████████████▏                                                                               | 1262/7473 [00:00<00:02, 2527.28it/s] 20%|███████████████████▍                                                                            | 1516/7473 [00:00<00:02, 2530.75it/s] 24%|██████████████████████▋                                                                         | 1770/7473 [00:00<00:02, 2518.57it/s] 27%|█████████████████████████▉                                                                      | 2022/7473 [00:00<00:02, 2509.36it/s] 30%|█████████████████████████████▏                                                                  | 2274/7473 [00:00<00:02, 2509.69it/s] 34%|████████████████████████████████▍                                                               | 2525/7473 [00:01<00:02, 2422.61it/s] 37%|███████████████████████████████████▋                                                            | 2781/7473 [00:01<00:01, 2463.33it/s] 41%|███████████████████████████████████████                                                         | 3038/7473 [00:01<00:01, 2494.45it/s] 44%|██████████████████████████████████████████▏                                                     | 3288/7473 [00:01<00:01, 2495.88it/s] 47%|█████████████████████████████████████████████▍                                                  | 3538/7473 [00:01<00:01, 2488.21it/s] 51%|████████████████████████████████████████████████▋                                               | 3788/7473 [00:01<00:01, 2485.02it/s] 54%|███████████████████████████████████████████████████▉                                            | 4042/7473 [00:01<00:01, 2499.50it/s] 57%|███████████████████████████████████████████████████████▏                                        | 4293/7473 [00:01<00:01, 2486.62it/s] 61%|██████████████████████████████████████████████████████████▎                                     | 4544/7473 [00:01<00:01, 2492.50it/s] 64%|█████████████████████████████████████████████████████████████▌                                  | 4795/7473 [00:01<00:01, 2495.70it/s] 68%|████████████████████████████████████████████████████████████████▊                               | 5045/7473 [00:02<00:00, 2495.36it/s] 72%|████████████████████████████████████████████████████████████████████▊                           | 5352/7473 [00:02<00:00, 2667.10it/s] 75%|████████████████████████████████████████████████████████████████████████▏                       | 5619/7473 [00:02<00:00, 2493.56it/s] 80%|████████████████████████████████████████████████████████████████████████████▉                   | 5990/7473 [00:02<00:00, 2840.52it/s] 85%|█████████████████████████████████████████████████████████████████████████████████▉              | 6375/7473 [00:02<00:00, 3131.47it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████▊         | 6754/7473 [00:02<00:00, 3322.72it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████▋    | 7133/7473 [00:02<00:00, 3459.49it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████| 7473/7473 [00:02<00:00, 2732.51it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.29s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.27s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.29s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.17s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.06s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.06s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.41s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.05s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.42s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.61s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.42s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.61s/it]
[2023-08-17 22:29:18,490] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.72s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.89s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.42s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.60s/it]
[2023-08-17 22:29:26,682] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-17 22:29:26,683] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-17 22:29:26,683] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-17 22:29:26,683] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-17 22:29:26,684] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-17 22:29:26,684] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-17 22:29:26,684] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-17 22:29:26,684] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-17 22:29:26,684] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-17 22:29:26,684] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-17 22:29:26,684] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-17 22:29:26,684] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f5f6fa3b370>
[2023-08-17 22:29:26,684] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-17 22:29:26,684] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-17 22:29:26,684] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-17 22:29:26,684] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-17 22:29:26,684] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-17 22:29:26,684] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-17 22:29:26,684] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-17 22:29:26,684] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-17 22:29:26,684] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-17 22:29:26,684] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-17 22:29:26,684] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-17 22:29:26,684] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-17 22:29:26,684] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-17 22:29:26,684] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-17 22:29:26,684] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-17 22:29:26,684] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-17 22:29:26,684] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-17 22:29:26,684] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-17 22:29:26,684] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-17 22:29:26,684] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-17 22:29:26,684] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-17 22:29:26,684] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-17 22:29:26,684] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-17 22:29:26,684] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-17 22:29:26,684] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-17 22:29:26,684] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-17 22:29:26,684] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-17 22:29:26,684] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-17 22:29:26,684] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-17 22:29:26,684] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-17 22:29:26,684] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-17 22:29:26,684] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-17 22:29:26,685] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f5f6fa3b190>
[2023-08-17 22:29:26,685] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-17 22:29:26,685] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-17 22:29:26,685] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-17 22:29:26,685] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-17 22:29:26,685] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-17 22:29:26,685] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-17 22:29:26,685] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-17 22:29:26,685] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-17 22:29:26,685] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-17 22:29:26,685] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-17 22:29:26,685] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-17 22:29:26,685] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-17 22:29:26,685] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-17 22:29:26,685] [INFO] [config.py:1012:print]   train_batch_size ............. 8
[2023-08-17 22:29:26,685] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  2
[2023-08-17 22:29:26,685] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-17 22:29:26,685] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-17 22:29:26,685] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-17 22:29:26,685] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-17 22:29:26,685] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-17 22:29:26,685] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-17 22:29:26,685] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-17 22:29:26,685] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.33446383476257324 seconds
Loading extension module utils...
Time to load utils op: 0.3042161464691162 seconds
Loading extension module utils...
Time to load utils op: 0.30451488494873047 seconds
Loading extension module utils...
Time to load utils op: 0.4044497013092041 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating gsm8k :   0%|                                                                                           | 0/125 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following grade math question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: A: oil refineries

Input:Natalia sold clips to 48 of her friends in April, and then she sold half as many clips in May. How many clips did Natalia sell altogether in April and May?
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o1-tcommonsenseqa-s1-rFalse
Evaluating gsm8k :   1%|▋                                                                                | 1/125 [00:31<1:04:08, 31.03s/it]Evaluating gsm8k :   2%|█▎                                                                               | 2/125 [01:00<1:02:15, 30.37s/it]Evaluating gsm8k :   2%|█▉                                                                               | 3/125 [01:30<1:00:47, 29.90s/it]Evaluating gsm8k :   3%|██▋                                                                                | 4/125 [01:52<54:00, 26.78s/it]Evaluating gsm8k :   4%|███▎                                                                               | 5/125 [02:13<49:17, 24.65s/it]Evaluating gsm8k :   5%|███▉                                                                               | 6/125 [02:23<39:33, 19.95s/it]Evaluating gsm8k :   6%|████▋                                                                              | 7/125 [02:34<33:26, 17.00s/it]Evaluating gsm8k :   6%|█████▎                                                                             | 8/125 [02:51<32:57, 16.90s/it]Evaluating gsm8k :   7%|█████▉                                                                             | 9/125 [03:21<40:47, 21.09s/it]Evaluating gsm8k :   8%|██████▌                                                                           | 10/125 [03:44<41:01, 21.41s/it]Evaluating gsm8k :   9%|███████▏                                                                          | 11/125 [04:06<41:11, 21.68s/it]Evaluating gsm8k :  10%|███████▊                                                                          | 12/125 [04:28<40:55, 21.73s/it]Evaluating gsm8k :  10%|████████▌                                                                         | 13/125 [04:57<44:57, 24.08s/it]Evaluating gsm8k :  11%|█████████▏                                                                        | 14/125 [05:18<42:51, 23.17s/it]Evaluating gsm8k :  12%|█████████▊                                                                        | 15/125 [05:47<45:48, 24.99s/it]Evaluating gsm8k :  13%|██████████▍                                                                       | 16/125 [06:18<48:15, 26.56s/it]Evaluating gsm8k :  14%|███████████▏                                                                      | 17/125 [06:47<49:23, 27.44s/it]Evaluating gsm8k :  14%|███████████▊                                                                      | 18/125 [07:17<50:13, 28.17s/it]Evaluating gsm8k :  15%|████████████▍                                                                     | 19/125 [07:47<50:40, 28.69s/it]Evaluating gsm8k :  16%|█████████████                                                                     | 20/125 [08:04<44:10, 25.24s/it]Evaluating gsm8k :  17%|█████████████▊                                                                    | 21/125 [08:34<45:59, 26.53s/it]Evaluating gsm8k :  18%|██████████████▍                                                                   | 22/125 [09:00<45:14, 26.35s/it]Evaluating gsm8k :  18%|███████████████                                                                   | 23/125 [09:30<46:51, 27.56s/it]Evaluating gsm8k :  19%|███████████████▋                                                                  | 24/125 [09:36<35:44, 21.24s/it]Evaluating gsm8k :  20%|████████████████▍                                                                 | 25/125 [09:41<27:18, 16.38s/it]Evaluating gsm8k :  21%|█████████████████                                                                 | 26/125 [09:44<20:22, 12.35s/it]Evaluating gsm8k :  22%|█████████████████▋                                                                | 27/125 [09:48<15:44,  9.64s/it]Evaluating gsm8k :  22%|██████████████████▎                                                               | 28/125 [10:11<22:10, 13.72s/it]Evaluating gsm8k :  23%|███████████████████                                                               | 29/125 [10:37<27:59, 17.49s/it]Evaluating gsm8k :  24%|███████████████████▋                                                              | 30/125 [11:07<33:19, 21.05s/it]Evaluating gsm8k :  25%|████████████████████▎                                                             | 31/125 [11:30<33:57, 21.68s/it]Evaluating gsm8k :  26%|████████████████████▉                                                             | 32/125 [11:56<35:29, 22.90s/it]Evaluating gsm8k :  26%|█████████████████████▋                                                            | 33/125 [12:19<35:24, 23.09s/it]Evaluating gsm8k :  27%|██████████████████████▎                                                           | 34/125 [12:44<35:49, 23.62s/it]Evaluating gsm8k :  28%|██████████████████████▉                                                           | 35/125 [13:13<38:01, 25.35s/it]Evaluating gsm8k :  29%|███████████████████████▌                                                          | 36/125 [13:27<32:31, 21.93s/it]Evaluating gsm8k :  30%|████████████████████████▎                                                         | 37/125 [13:39<27:47, 18.95s/it]Evaluating gsm8k :  30%|████████████████████████▉                                                         | 38/125 [14:01<28:31, 19.67s/it]Evaluating gsm8k :  31%|█████████████████████████▌                                                        | 39/125 [14:13<24:53, 17.37s/it]Evaluating gsm8k :  32%|██████████████████████████▏                                                       | 40/125 [14:22<21:12, 14.97s/it]Evaluating gsm8k :  33%|██████████████████████████▉                                                       | 41/125 [14:40<22:20, 15.96s/it]Evaluating gsm8k :  34%|███████████████████████████▌                                                      | 42/125 [15:11<28:01, 20.26s/it]Evaluating gsm8k :  34%|████████████████████████████▏                                                     | 43/125 [15:31<27:51, 20.38s/it]Evaluating gsm8k :  35%|████████████████████████████▊                                                     | 44/125 [15:36<21:07, 15.65s/it]Evaluating gsm8k :  36%|█████████████████████████████▌                                                    | 45/125 [16:06<26:30, 19.88s/it]Evaluating gsm8k :  37%|██████████████████████████████▏                                                   | 46/125 [16:36<30:18, 23.02s/it]Evaluating gsm8k :  38%|██████████████████████████████▊                                                   | 47/125 [16:53<27:42, 21.31s/it]Evaluating gsm8k :  38%|███████████████████████████████▍                                                  | 48/125 [17:00<21:44, 16.95s/it]Evaluating gsm8k :  39%|████████████████████████████████▏                                                 | 49/125 [17:08<18:05, 14.28s/it]Evaluating gsm8k :  40%|████████████████████████████████▊                                                 | 50/125 [17:38<23:53, 19.11s/it]Evaluating gsm8k :  41%|█████████████████████████████████▍                                                | 51/125 [18:08<27:27, 22.26s/it]Evaluating gsm8k :  42%|██████████████████████████████████                                                | 52/125 [18:38<29:46, 24.47s/it]Evaluating gsm8k :  42%|██████████████████████████████████▊                                               | 53/125 [18:47<23:50, 19.87s/it]Evaluating gsm8k :  43%|███████████████████████████████████▍                                              | 54/125 [18:59<20:40, 17.47s/it]Evaluating gsm8k :  44%|████████████████████████████████████                                              | 55/125 [19:15<20:01, 17.17s/it]Evaluating gsm8k :  45%|████████████████████████████████████▋                                             | 56/125 [19:45<24:13, 21.07s/it]Evaluating gsm8k :  46%|█████████████████████████████████████▍                                            | 57/125 [20:01<22:08, 19.54s/it]Evaluating gsm8k :  46%|██████████████████████████████████████                                            | 58/125 [20:26<23:30, 21.05s/it]Evaluating gsm8k :  47%|██████████████████████████████████████▋                                           | 59/125 [20:35<19:20, 17.59s/it]Evaluating gsm8k :  48%|███████████████████████████████████████▎                                          | 60/125 [20:46<16:40, 15.39s/it]Evaluating gsm8k :  49%|████████████████████████████████████████                                          | 61/125 [20:53<13:44, 12.88s/it]Evaluating gsm8k :  50%|████████████████████████████████████████▋                                         | 62/125 [21:06<13:49, 13.16s/it]Evaluating gsm8k :  50%|█████████████████████████████████████████▎                                        | 63/125 [21:36<18:49, 18.22s/it]Evaluating gsm8k :  51%|█████████████████████████████████████████▉                                        | 64/125 [22:07<22:08, 21.77s/it]Evaluating gsm8k :  52%|██████████████████████████████████████████▋                                       | 65/125 [22:26<21:07, 21.13s/it]Evaluating gsm8k :  53%|███████████████████████████████████████████▎                                      | 66/125 [22:47<20:48, 21.16s/it]Evaluating gsm8k :  54%|███████████████████████████████████████████▉                                      | 67/125 [22:56<16:49, 17.41s/it]Evaluating gsm8k :  54%|████████████████████████████████████████████▌                                     | 68/125 [22:58<12:15, 12.91s/it]Evaluating gsm8k :  55%|█████████████████████████████████████████████▎                                    | 69/125 [23:28<16:42, 17.90s/it]Evaluating gsm8k :  56%|█████████████████████████████████████████████▉                                    | 70/125 [23:42<15:13, 16.60s/it]Evaluating gsm8k :  57%|██████████████████████████████████████████████▌                                   | 71/125 [24:11<18:26, 20.50s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▏                                  | 72/125 [24:41<20:42, 23.44s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▉                                  | 73/125 [24:51<16:40, 19.25s/it]Evaluating gsm8k :  59%|████████████████████████████████████████████████▌                                 | 74/125 [25:10<16:23, 19.28s/it]Evaluating gsm8k :  60%|█████████████████████████████████████████████████▏                                | 75/125 [25:41<18:49, 22.60s/it]Evaluating gsm8k :  61%|█████████████████████████████████████████████████▊                                | 76/125 [25:54<16:12, 19.85s/it]Evaluating gsm8k :  62%|██████████████████████████████████████████████████▌                               | 77/125 [26:05<13:40, 17.09s/it]Evaluating gsm8k :  62%|███████████████████████████████████████████████████▏                              | 78/125 [26:22<13:19, 17.02s/it]Evaluating gsm8k :  63%|███████████████████████████████████████████████████▊                              | 79/125 [26:46<14:42, 19.18s/it]Evaluating gsm8k :  64%|████████████████████████████████████████████████████▍                             | 80/125 [27:11<15:43, 20.97s/it]Evaluating gsm8k :  65%|█████████████████████████████████████████████████████▏                            | 81/125 [27:41<17:19, 23.62s/it]Evaluating gsm8k :  66%|█████████████████████████████████████████████████████▊                            | 82/125 [27:54<14:42, 20.53s/it]Evaluating gsm8k :  66%|██████████████████████████████████████████████████████▍                           | 83/125 [28:24<16:15, 23.22s/it]Evaluating gsm8k :  67%|███████████████████████████████████████████████████████                           | 84/125 [28:54<17:20, 25.38s/it]Evaluating gsm8k :  68%|███████████████████████████████████████████████████████▊                          | 85/125 [28:57<12:21, 18.54s/it]Evaluating gsm8k :  69%|████████████████████████████████████████████████████████▍                         | 86/125 [29:02<09:31, 14.64s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████                         | 87/125 [29:20<09:58, 15.76s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████▋                        | 88/125 [29:39<10:11, 16.52s/it]Evaluating gsm8k :  71%|██████████████████████████████████████████████████████████▍                       | 89/125 [29:58<10:20, 17.23s/it]Evaluating gsm8k :  72%|███████████████████████████████████████████████████████████                       | 90/125 [30:20<10:59, 18.85s/it]Evaluating gsm8k :  73%|███████████████████████████████████████████████████████████▋                      | 91/125 [30:28<08:51, 15.63s/it]Evaluating gsm8k :  74%|████████████████████████████████████████████████████████████▎                     | 92/125 [30:58<10:57, 19.91s/it]Evaluating gsm8k :  74%|█████████████████████████████████████████████████████████████                     | 93/125 [31:29<12:17, 23.03s/it]Evaluating gsm8k :  75%|█████████████████████████████████████████████████████████████▋                    | 94/125 [31:51<11:51, 22.97s/it]Evaluating gsm8k :  76%|██████████████████████████████████████████████████████████████▎                   | 95/125 [32:07<10:21, 20.73s/it]Evaluating gsm8k :  77%|██████████████████████████████████████████████████████████████▉                   | 96/125 [32:09<07:21, 15.22s/it]Evaluating gsm8k :  78%|███████████████████████████████████████████████████████████████▋                  | 97/125 [32:21<06:38, 14.23s/it]Evaluating gsm8k :  78%|████████████████████████████████████████████████████████████████▎                 | 98/125 [32:51<08:31, 18.94s/it]Evaluating gsm8k :  79%|████████████████████████████████████████████████████████████████▉                 | 99/125 [33:21<09:37, 22.21s/it]Evaluating gsm8k :  80%|████████████████████████████████████████████████████████████████▊                | 100/125 [33:37<08:26, 20.27s/it]Evaluating gsm8k :  81%|█████████████████████████████████████████████████████████████████▍               | 101/125 [33:44<06:30, 16.25s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████               | 102/125 [34:00<06:17, 16.40s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████▋              | 103/125 [34:16<05:56, 16.19s/it]Evaluating gsm8k :  83%|███████████████████████████████████████████████████████████████████▍             | 104/125 [34:28<05:14, 14.97s/it]Evaluating gsm8k :  84%|████████████████████████████████████████████████████████████████████             | 105/125 [34:50<05:37, 16.89s/it]Evaluating gsm8k :  85%|████████████████████████████████████████████████████████████████████▋            | 106/125 [35:20<06:36, 20.89s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▎           | 107/125 [35:47<06:50, 22.83s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▉           | 108/125 [35:58<05:28, 19.29s/it]Evaluating gsm8k :  87%|██████████████████████████████████████████████████████████████████████▋          | 109/125 [36:07<04:18, 16.14s/it]Evaluating gsm8k :  88%|███████████████████████████████████████████████████████████████████████▎         | 110/125 [36:37<05:03, 20.24s/it]Evaluating gsm8k :  89%|███████████████████████████████████████████████████████████████████████▉         | 111/125 [37:07<05:25, 23.22s/it]Evaluating gsm8k :  90%|████████████████████████████████████████████████████████████████████████▌        | 112/125 [37:37<05:28, 25.24s/it]Evaluating gsm8k :  90%|█████████████████████████████████████████████████████████████████████████▏       | 113/125 [37:51<04:22, 21.86s/it]Evaluating gsm8k :  91%|█████████████████████████████████████████████████████████████████████████▊       | 114/125 [38:01<03:22, 18.42s/it]Evaluating gsm8k :  92%|██████████████████████████████████████████████████████████████████████████▌      | 115/125 [38:31<03:37, 21.71s/it]Evaluating gsm8k :  93%|███████████████████████████████████████████████████████████████████████████▏     | 116/125 [38:47<02:59, 19.96s/it]Evaluating gsm8k :  94%|███████████████████████████████████████████████████████████████████████████▊     | 117/125 [39:02<02:29, 18.68s/it]Evaluating gsm8k :  94%|████████████████████████████████████████████████████████████████████████████▍    | 118/125 [39:13<01:54, 16.42s/it]Evaluating gsm8k :  95%|█████████████████████████████████████████████████████████████████████████████    | 119/125 [39:35<01:47, 17.97s/it]Evaluating gsm8k :  96%|█████████████████████████████████████████████████████████████████████████████▊   | 120/125 [40:05<01:47, 21.54s/it]Evaluating gsm8k :  97%|██████████████████████████████████████████████████████████████████████████████▍  | 121/125 [40:13<01:10, 17.56s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████  | 122/125 [40:41<01:02, 20.75s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████▋ | 123/125 [41:11<00:46, 23.44s/it]Evaluating gsm8k :  99%|████████████████████████████████████████████████████████████████████████████████▎| 124/125 [41:39<00:24, 24.83s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [42:03<00:00, 24.50s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [42:03<00:00, 20.19s/it]
name: gsm8k | {'exact_match': 0.0, 'rougeL': 0.5016} | lm_loss 9.8002 | avg. gen lenth: 232.08
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name gsm8k --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name commonsenseqa --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 2 --data-dir /scratch/ylu130/processed_data/gsm8k/out-domain/o2-tcommonsenseqa-s1-rFalse --seed 1 --max-prompt-length 2048 --num-out-domain 2
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-17 23:14:54,039] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... gsm8k
  data_dir ..................... /scratch/ylu130/processed_data/gsm8k/out-domain/o2-tcommonsenseqa-s1-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 2
  out_domain_data_name ......... commonsenseqa
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o2-tcommonsenseqa-s1-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 2
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                                             | 0/7473 [00:00<?, ?it/s]  3%|██▌                                                                                              | 195/7473 [00:00<00:03, 1945.46it/s]  5%|█████                                                                                            | 393/7473 [00:00<00:03, 1960.70it/s]  8%|███████▋                                                                                         | 590/7473 [00:00<00:03, 1963.72it/s] 11%|██████████▎                                                                                      | 790/7473 [00:00<00:03, 1977.44it/s] 13%|████████████▊                                                                                    | 991/7473 [00:00<00:03, 1989.04it/s] 16%|███████████████▎                                                                                | 1190/7473 [00:00<00:03, 1988.69it/s] 19%|█████████████████▊                                                                              | 1389/7473 [00:00<00:03, 1984.16it/s] 21%|████████████████████▍                                                                           | 1588/7473 [00:00<00:02, 1983.47it/s] 24%|██████████████████████▉                                                                         | 1788/7473 [00:00<00:02, 1961.95it/s] 27%|█████████████████████████▍                                                                      | 1985/7473 [00:01<00:02, 1935.07it/s] 29%|████████████████████████████                                                                    | 2183/7473 [00:01<00:02, 1945.94it/s] 32%|██████████████████████████████▌                                                                 | 2382/7473 [00:01<00:02, 1957.03it/s] 34%|█████████████████████████████████                                                               | 2578/7473 [00:01<00:02, 1926.54it/s] 37%|███████████████████████████████████▋                                                            | 2779/7473 [00:01<00:02, 1948.74it/s] 40%|██████████████████████████████████████▎                                                         | 2981/7473 [00:01<00:02, 1969.78it/s] 43%|████████████████████████████████████████▊                                                       | 3179/7473 [00:01<00:02, 1967.52it/s] 45%|███████████████████████████████████████████▎                                                    | 3376/7473 [00:01<00:02, 1968.03it/s] 48%|█████████████████████████████████████████████▉                                                  | 3574/7473 [00:01<00:01, 1970.83it/s] 50%|████████████████████████████████████████████████▍                                               | 3772/7473 [00:01<00:01, 1957.42it/s] 53%|██████████████████████████████████████████████████▉                                             | 3970/7473 [00:02<00:01, 1961.91it/s] 56%|█████████████████████████████████████████████████████▌                                          | 4168/7473 [00:02<00:01, 1963.33it/s] 58%|████████████████████████████████████████████████████████                                        | 4365/7473 [00:02<00:01, 1964.67it/s] 61%|██████████████████████████████████████████████████████████▌                                     | 4563/7473 [00:02<00:01, 1965.82it/s] 64%|█████████████████████████████████████████████████████████████▏                                  | 4761/7473 [00:02<00:01, 1967.73it/s] 66%|███████████████████████████████████████████████████████████████▋                                | 4959/7473 [00:02<00:01, 1970.86it/s] 69%|██████████████████████████████████████████████████████████████████▎                             | 5158/7473 [00:02<00:01, 1975.51it/s] 72%|█████████████████████████████████████████████████████████████████████▏                          | 5387/7473 [00:02<00:01, 2068.15it/s] 75%|███████████████████████████████████████████████████████████████████████▊                        | 5594/7473 [00:02<00:01, 1730.34it/s] 79%|███████████████████████████████████████████████████████████████████████████▋                    | 5894/7473 [00:02<00:00, 2064.51it/s] 83%|███████████████████████████████████████████████████████████████████████████████▌                | 6193/7473 [00:03<00:00, 2316.87it/s] 87%|███████████████████████████████████████████████████████████████████████████████████▍            | 6494/7473 [00:03<00:00, 2510.69it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████▎        | 6794/7473 [00:03<00:00, 2648.50it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████     | 7092/7473 [00:03<00:00, 2744.27it/s] 99%|██████████████████████████████████████████████████████████████████████████████████████████████▉ | 7392/7473 [00:03<00:00, 2816.66it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████| 7473/7473 [00:03<00:00, 2124.02it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.25s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.15s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.08s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.44s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.40s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.09s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.21s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.34s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.75s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.91s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.48s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.65s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.51s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.69s/it]
[2023-08-17 23:15:48,887] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.74s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.91s/it]
[2023-08-17 23:15:57,045] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-17 23:15:57,046] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-17 23:15:57,046] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-17 23:15:57,046] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-17 23:15:57,046] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-17 23:15:57,046] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-17 23:15:57,046] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-17 23:15:57,046] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-17 23:15:57,046] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-17 23:15:57,046] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-17 23:15:57,046] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fcbef9fb370>
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7fcbef9fb250>
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   train_batch_size ............. 8
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  2
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-17 23:15:57,047] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-17 23:15:57,048] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-17 23:15:57,048] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-17 23:15:57,048] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-17 23:15:57,048] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.3538992404937744 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating gsm8k :   0%|                                                                                           | 0/125 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following grade math question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Output: D: accomplishing

Input:Natalia sold clips to 48 of her friends in April, and then she sold half as many clips in May. How many clips did Natalia sell altogether in April and May?
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o2-tcommonsenseqa-s1-rFalse
Loading extension module utils...
Time to load utils op: 0.2041776180267334 seconds
Loading extension module utils...
Time to load utils op: 0.40447998046875 seconds
Loading extension module utils...
Time to load utils op: 0.30455660820007324 seconds
Evaluating gsm8k :   1%|▋                                                                                  | 1/125 [00:11<22:55, 11.09s/it]Evaluating gsm8k :   2%|█▎                                                                                 | 2/125 [00:32<35:33, 17.35s/it]Evaluating gsm8k :   2%|█▉                                                                                 | 3/125 [01:01<46:08, 22.69s/it]Evaluating gsm8k :   3%|██▋                                                                                | 4/125 [01:30<50:51, 25.22s/it]Evaluating gsm8k :   4%|███▎                                                                               | 5/125 [01:59<53:03, 26.53s/it]Evaluating gsm8k :   5%|███▉                                                                               | 6/125 [02:16<46:02, 23.21s/it]Evaluating gsm8k :   6%|████▋                                                                              | 7/125 [02:46<49:38, 25.24s/it]Evaluating gsm8k :   6%|█████▎                                                                             | 8/125 [03:11<49:38, 25.46s/it]Evaluating gsm8k :   7%|█████▉                                                                             | 9/125 [03:15<36:07, 18.69s/it]Evaluating gsm8k :   8%|██████▌                                                                           | 10/125 [03:45<42:35, 22.23s/it]Evaluating gsm8k :   9%|███████▏                                                                          | 11/125 [04:06<41:01, 21.60s/it]Evaluating gsm8k :  10%|███████▊                                                                          | 12/125 [04:26<39:55, 21.20s/it]Evaluating gsm8k :  10%|████████▌                                                                         | 13/125 [04:45<38:17, 20.52s/it]Evaluating gsm8k :  11%|█████████▏                                                                        | 14/125 [05:14<43:03, 23.28s/it]Evaluating gsm8k :  12%|█████████▊                                                                        | 15/125 [05:23<34:34, 18.86s/it]Evaluating gsm8k :  13%|██████████▍                                                                       | 16/125 [05:31<28:08, 15.49s/it]Evaluating gsm8k :  14%|███████████▏                                                                      | 17/125 [05:40<24:28, 13.59s/it]Evaluating gsm8k :  14%|███████████▊                                                                      | 18/125 [05:50<22:16, 12.49s/it]Evaluating gsm8k :  15%|████████████▍                                                                     | 19/125 [06:20<31:20, 17.74s/it]Evaluating gsm8k :  16%|█████████████                                                                     | 20/125 [06:28<25:50, 14.77s/it]Evaluating gsm8k :  17%|█████████████▊                                                                    | 21/125 [06:58<33:35, 19.38s/it]Evaluating gsm8k :  18%|██████████████▍                                                                   | 22/125 [07:28<38:46, 22.59s/it]Evaluating gsm8k :  18%|███████████████                                                                   | 23/125 [07:57<41:49, 24.60s/it]Evaluating gsm8k :  19%|███████████████▋                                                                  | 24/125 [08:23<42:06, 25.02s/it]Evaluating gsm8k :  20%|████████████████▍                                                                 | 25/125 [08:50<42:30, 25.50s/it]Evaluating gsm8k :  21%|█████████████████                                                                 | 26/125 [09:00<34:30, 20.92s/it]Evaluating gsm8k :  22%|█████████████████▋                                                                | 27/125 [09:27<37:02, 22.67s/it]Evaluating gsm8k :  22%|██████████████████▎                                                               | 28/125 [09:56<40:04, 24.79s/it]Evaluating gsm8k :  23%|███████████████████                                                               | 29/125 [10:06<32:30, 20.32s/it]Evaluating gsm8k :  24%|███████████████████▋                                                              | 30/125 [10:16<27:07, 17.13s/it]Evaluating gsm8k :  25%|████████████████████▎                                                             | 31/125 [10:46<32:49, 20.95s/it]Evaluating gsm8k :  26%|████████████████████▉                                                             | 32/125 [11:16<36:35, 23.61s/it]Evaluating gsm8k :  26%|█████████████████████▋                                                            | 33/125 [11:18<26:29, 17.28s/it]Evaluating gsm8k :  27%|██████████████████████▎                                                           | 34/125 [11:41<28:44, 18.95s/it]Evaluating gsm8k :  28%|██████████████████████▉                                                           | 35/125 [11:44<21:01, 14.02s/it]Evaluating gsm8k :  29%|███████████████████████▌                                                          | 36/125 [12:13<27:33, 18.58s/it]Evaluating gsm8k :  30%|████████████████████████▎                                                         | 37/125 [12:40<30:50, 21.03s/it]Evaluating gsm8k :  30%|████████████████████████▉                                                         | 38/125 [12:42<22:22, 15.43s/it]Evaluating gsm8k :  31%|█████████████████████████▌                                                        | 39/125 [12:49<18:18, 12.78s/it]Evaluating gsm8k :  32%|██████████████████████████▏                                                       | 40/125 [13:18<25:08, 17.75s/it]Evaluating gsm8k :  33%|██████████████████████████▉                                                       | 41/125 [13:31<23:00, 16.44s/it]Evaluating gsm8k :  34%|███████████████████████████▌                                                      | 42/125 [14:01<28:12, 20.39s/it]Evaluating gsm8k :  34%|████████████████████████████▏                                                     | 43/125 [14:30<31:36, 23.13s/it]Evaluating gsm8k :  35%|████████████████████████████▊                                                     | 44/125 [14:57<32:37, 24.16s/it]Evaluating gsm8k :  36%|█████████████████████████████▌                                                    | 45/125 [15:12<28:27, 21.35s/it]Evaluating gsm8k :  37%|██████████████████████████████▏                                                   | 46/125 [15:14<20:34, 15.63s/it]Evaluating gsm8k :  38%|██████████████████████████████▊                                                   | 47/125 [15:43<25:38, 19.72s/it]Evaluating gsm8k :  38%|███████████████████████████████▍                                                  | 48/125 [15:58<23:28, 18.29s/it]Evaluating gsm8k :  39%|████████████████████████████████▏                                                 | 49/125 [16:03<18:06, 14.30s/it]Evaluating gsm8k :  40%|████████████████████████████████▊                                                 | 50/125 [16:14<16:22, 13.10s/it]Evaluating gsm8k :  41%|█████████████████████████████████▍                                                | 51/125 [16:18<12:47, 10.38s/it]Evaluating gsm8k :  42%|██████████████████████████████████                                                | 52/125 [16:29<12:51, 10.57s/it]Evaluating gsm8k :  42%|██████████████████████████████████▊                                               | 53/125 [16:40<12:55, 10.77s/it]Evaluating gsm8k :  43%|███████████████████████████████████▍                                              | 54/125 [17:09<19:12, 16.23s/it]Evaluating gsm8k :  44%|████████████████████████████████████                                              | 55/125 [17:34<22:08, 18.97s/it]Evaluating gsm8k :  45%|████████████████████████████████████▋                                             | 56/125 [17:37<16:17, 14.17s/it]Evaluating gsm8k :  46%|█████████████████████████████████████▍                                            | 57/125 [18:04<20:21, 17.96s/it]Evaluating gsm8k :  46%|██████████████████████████████████████                                            | 58/125 [18:33<23:52, 21.38s/it]Evaluating gsm8k :  47%|██████████████████████████████████████▋                                           | 59/125 [18:39<18:15, 16.61s/it]Evaluating gsm8k :  48%|███████████████████████████████████████▎                                          | 60/125 [19:08<22:07, 20.42s/it]Evaluating gsm8k :  49%|████████████████████████████████████████                                          | 61/125 [19:38<24:55, 23.37s/it]Evaluating gsm8k :  50%|████████████████████████████████████████▋                                         | 62/125 [20:08<26:37, 25.35s/it]Evaluating gsm8k :  50%|█████████████████████████████████████████▎                                        | 63/125 [20:11<19:07, 18.50s/it]Evaluating gsm8k :  51%|█████████████████████████████████████████▉                                        | 64/125 [20:40<22:10, 21.80s/it]Evaluating gsm8k :  52%|██████████████████████████████████████████▋                                       | 65/125 [20:55<19:41, 19.69s/it]Evaluating gsm8k :  53%|███████████████████████████████████████████▎                                      | 66/125 [21:24<22:08, 22.52s/it]Evaluating gsm8k :  54%|███████████████████████████████████████████▉                                      | 67/125 [21:39<19:27, 20.13s/it]Evaluating gsm8k :  54%|████████████████████████████████████████████▌                                     | 68/125 [22:09<21:57, 23.12s/it]Evaluating gsm8k :  55%|█████████████████████████████████████████████▎                                    | 69/125 [22:14<16:29, 17.67s/it]Evaluating gsm8k :  56%|█████████████████████████████████████████████▉                                    | 70/125 [22:26<14:46, 16.13s/it]Evaluating gsm8k :  57%|██████████████████████████████████████████████▌                                   | 71/125 [22:55<18:01, 20.03s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▏                                  | 72/125 [23:20<19:01, 21.53s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▉                                  | 73/125 [23:50<20:47, 23.99s/it]Evaluating gsm8k :  59%|████████████████████████████████████████████████▌                                 | 74/125 [24:13<20:07, 23.67s/it]Evaluating gsm8k :  60%|█████████████████████████████████████████████████▏                                | 75/125 [24:42<21:07, 25.35s/it]Evaluating gsm8k :  61%|█████████████████████████████████████████████████▊                                | 76/125 [24:51<16:35, 20.33s/it]Evaluating gsm8k :  62%|██████████████████████████████████████████████████▌                               | 77/125 [25:21<18:38, 23.30s/it]Evaluating gsm8k :  62%|███████████████████████████████████████████████████▏                              | 78/125 [25:32<15:21, 19.60s/it]Evaluating gsm8k :  63%|███████████████████████████████████████████████████▊                              | 79/125 [26:02<17:15, 22.51s/it]Evaluating gsm8k :  64%|████████████████████████████████████████████████████▍                             | 80/125 [26:31<18:29, 24.65s/it]Evaluating gsm8k :  65%|█████████████████████████████████████████████████████▏                            | 81/125 [27:00<19:05, 26.04s/it]Evaluating gsm8k :  66%|█████████████████████████████████████████████████████▊                            | 82/125 [27:08<14:43, 20.54s/it]Evaluating gsm8k :  66%|██████████████████████████████████████████████████████▍                           | 83/125 [27:31<14:54, 21.31s/it]Evaluating gsm8k :  67%|███████████████████████████████████████████████████████                           | 84/125 [27:36<11:14, 16.45s/it]Evaluating gsm8k :  68%|███████████████████████████████████████████████████████▊                          | 85/125 [28:06<13:31, 20.28s/it]Evaluating gsm8k :  69%|████████████████████████████████████████████████████████▍                         | 86/125 [28:36<15:04, 23.20s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████                         | 87/125 [29:05<15:52, 25.06s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████▋                        | 88/125 [29:28<15:08, 24.56s/it]Evaluating gsm8k :  71%|██████████████████████████████████████████████████████████▍                       | 89/125 [29:58<15:37, 26.03s/it]Evaluating gsm8k :  72%|███████████████████████████████████████████████████████████                       | 90/125 [30:08<12:20, 21.14s/it]Evaluating gsm8k :  73%|███████████████████████████████████████████████████████████▋                      | 91/125 [30:37<13:21, 23.57s/it]Evaluating gsm8k :  74%|████████████████████████████████████████████████████████████▎                     | 92/125 [31:07<14:03, 25.56s/it]Evaluating gsm8k :  74%|█████████████████████████████████████████████████████████████                     | 93/125 [31:36<14:13, 26.66s/it]Evaluating gsm8k :  75%|█████████████████████████████████████████████████████████████▋                    | 94/125 [31:51<11:58, 23.17s/it]Evaluating gsm8k :  76%|██████████████████████████████████████████████████████████████▎                   | 95/125 [32:20<12:27, 24.93s/it]Evaluating gsm8k :  77%|██████████████████████████████████████████████████████████████▉                   | 96/125 [32:31<09:59, 20.69s/it]Evaluating gsm8k :  78%|███████████████████████████████████████████████████████████████▋                  | 97/125 [32:53<09:50, 21.08s/it]Evaluating gsm8k :  78%|████████████████████████████████████████████████████████████████▎                 | 98/125 [32:58<07:20, 16.30s/it]Evaluating gsm8k :  79%|████████████████████████████████████████████████████████████████▉                 | 99/125 [33:13<06:49, 15.73s/it]Evaluating gsm8k :  80%|████████████████████████████████████████████████████████████████▊                | 100/125 [33:42<08:14, 19.77s/it]Evaluating gsm8k :  81%|█████████████████████████████████████████████████████████████████▍               | 101/125 [33:51<06:36, 16.54s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████               | 102/125 [34:06<06:13, 16.22s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████▋              | 103/125 [34:17<05:18, 14.46s/it]Evaluating gsm8k :  83%|███████████████████████████████████████████████████████████████████▍             | 104/125 [34:34<05:23, 15.39s/it]Evaluating gsm8k :  84%|████████████████████████████████████████████████████████████████████             | 105/125 [34:57<05:52, 17.65s/it]Evaluating gsm8k :  85%|████████████████████████████████████████████████████████████████████▋            | 106/125 [35:17<05:47, 18.31s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▎           | 107/125 [35:26<04:39, 15.53s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▉           | 108/125 [35:40<04:17, 15.12s/it]Evaluating gsm8k :  87%|██████████████████████████████████████████████████████████████████████▋          | 109/125 [36:10<05:10, 19.39s/it]Evaluating gsm8k :  88%|███████████████████████████████████████████████████████████████████████▎         | 110/125 [36:26<04:36, 18.41s/it]Evaluating gsm8k :  89%|███████████████████████████████████████████████████████████████████████▉         | 111/125 [36:43<04:14, 18.17s/it]Evaluating gsm8k :  90%|████████████████████████████████████████████████████████████████████████▌        | 112/125 [37:13<04:41, 21.67s/it]Evaluating gsm8k :  90%|█████████████████████████████████████████████████████████████████████████▏       | 113/125 [37:24<03:40, 18.41s/it]Evaluating gsm8k :  91%|█████████████████████████████████████████████████████████████████████████▊       | 114/125 [37:54<03:59, 21.77s/it]Evaluating gsm8k :  92%|██████████████████████████████████████████████████████████████████████████▌      | 115/125 [38:14<03:33, 21.34s/it]Evaluating gsm8k :  93%|███████████████████████████████████████████████████████████████████████████▏     | 116/125 [38:24<02:41, 17.96s/it]Evaluating gsm8k :  94%|███████████████████████████████████████████████████████████████████████████▊     | 117/125 [38:26<01:46, 13.26s/it]Evaluating gsm8k :  94%|████████████████████████████████████████████████████████████████████████████▍    | 118/125 [38:38<01:30, 12.88s/it]Evaluating gsm8k :  95%|█████████████████████████████████████████████████████████████████████████████    | 119/125 [38:48<01:12, 12.03s/it]Evaluating gsm8k :  96%|█████████████████████████████████████████████████████████████████████████████▊   | 120/125 [39:18<01:26, 17.31s/it]Evaluating gsm8k :  97%|██████████████████████████████████████████████████████████████████████████████▍  | 121/125 [39:34<01:08, 17.03s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████  | 122/125 [40:05<01:03, 21.03s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████▋ | 123/125 [40:26<00:42, 21.25s/it]Evaluating gsm8k :  99%|████████████████████████████████████████████████████████████████████████████████▎| 124/125 [40:38<00:18, 18.36s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [41:07<00:00, 21.49s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [41:07<00:00, 19.74s/it]
name: gsm8k | {'exact_match': 0.0, 'rougeL': 0.3885} | lm_loss 9.7846 | avg. gen lenth: 243.348
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name gsm8k --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name commonsenseqa --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 2 --data-dir /scratch/ylu130/processed_data/gsm8k/out-domain/o3-tcommonsenseqa-s1-rFalse --seed 1 --max-prompt-length 2048 --num-out-domain 3
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-18 00:03:33,422] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... gsm8k
  data_dir ..................... /scratch/ylu130/processed_data/gsm8k/out-domain/o3-tcommonsenseqa-s1-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 3
  out_domain_data_name ......... commonsenseqa
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o3-tcommonsenseqa-s1-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 2
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                                             | 0/7473 [00:00<?, ?it/s]  2%|██                                                                                               | 162/7473 [00:00<00:04, 1611.69it/s]  4%|████▏                                                                                            | 327/7473 [00:00<00:04, 1632.87it/s]  7%|██████▎                                                                                          | 491/7473 [00:00<00:04, 1623.61it/s]  9%|████████▌                                                                                        | 655/7473 [00:00<00:04, 1629.25it/s] 11%|██████████▋                                                                                      | 822/7473 [00:00<00:04, 1640.68it/s] 13%|████████████▊                                                                                    | 990/7473 [00:00<00:03, 1651.74it/s] 15%|██████████████▊                                                                                 | 1156/7473 [00:00<00:03, 1654.34it/s] 18%|████████████████▉                                                                               | 1322/7473 [00:00<00:03, 1648.47it/s] 20%|███████████████████                                                                             | 1487/7473 [00:00<00:03, 1620.07it/s] 22%|█████████████████████▏                                                                          | 1650/7473 [00:01<00:03, 1611.33it/s] 24%|███████████████████████▎                                                                        | 1813/7473 [00:01<00:03, 1616.48it/s] 26%|█████████████████████████▎                                                                      | 1975/7473 [00:01<00:03, 1608.93it/s] 29%|███████████████████████████▍                                                                    | 2137/7473 [00:01<00:03, 1611.82it/s] 31%|█████████████████████████████▌                                                                  | 2301/7473 [00:01<00:03, 1619.15it/s] 33%|███████████████████████████████▋                                                                | 2466/7473 [00:01<00:03, 1627.79it/s] 35%|█████████████████████████████████▊                                                              | 2629/7473 [00:01<00:03, 1590.27it/s] 37%|███████████████████████████████████▉                                                            | 2795/7473 [00:01<00:02, 1608.75it/s] 40%|██████████████████████████████████████                                                          | 2963/7473 [00:01<00:02, 1626.64it/s] 42%|████████████████████████████████████████▏                                                       | 3126/7473 [00:01<00:02, 1619.37it/s] 44%|██████████████████████████████████████████▎                                                     | 3289/7473 [00:02<00:02, 1621.38it/s] 46%|████████████████████████████████████████████▎                                                   | 3452/7473 [00:02<00:02, 1611.46it/s] 48%|██████████████████████████████████████████████▍                                                 | 3616/7473 [00:02<00:02, 1619.31it/s] 51%|████████████████████████████████████████████████▌                                               | 3778/7473 [00:02<00:02, 1612.55it/s] 53%|██████████████████████████████████████████████████▋                                             | 3941/7473 [00:02<00:02, 1615.97it/s] 56%|█████████████████████████████████████████████████████▌                                          | 4171/7473 [00:02<00:01, 1818.79it/s] 59%|████████████████████████████████████████████████████████▋                                       | 4417/7473 [00:02<00:01, 2010.01it/s] 62%|███████████████████████████████████████████████████████████▉                                    | 4662/7473 [00:02<00:01, 2140.22it/s] 66%|███████████████████████████████████████████████████████████████                                 | 4910/7473 [00:02<00:01, 2239.54it/s] 69%|██████████████████████████████████████████████████████████████████▏                             | 5157/7473 [00:02<00:01, 2308.33it/s] 72%|█████████████████████████████████████████████████████████████████████▎                          | 5393/7473 [00:03<00:00, 2321.55it/s] 75%|████████████████████████████████████████████████████████████████████████▎                       | 5626/7473 [00:03<00:00, 2015.37it/s] 79%|███████████████████████████████████████████████████████████████████████████▍                    | 5873/7473 [00:03<00:00, 2137.93it/s] 82%|██████████████████████████████████████████████████████████████████████████████▌                 | 6119/7473 [00:03<00:00, 2226.06it/s] 85%|█████████████████████████████████████████████████████████████████████████████████▊              | 6365/7473 [00:03<00:00, 2289.17it/s] 88%|████████████████████████████████████████████████████████████████████████████████████▉           | 6610/7473 [00:03<00:00, 2335.24it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████        | 6854/7473 [00:03<00:00, 2363.35it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████▏    | 7101/7473 [00:03<00:00, 2394.35it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████▍ | 7348/7473 [00:03<00:00, 2414.37it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████| 7473/7473 [00:03<00:00, 1898.71it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.11s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.05s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.47s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.33s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:04,  5.00s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.16s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.37s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.41s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.41s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.58s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.53s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.69s/it]
[2023-08-18 00:04:28,645] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.75s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.93s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.78s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.94s/it]
[2023-08-18 00:04:37,492] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-18 00:04:37,494] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-18 00:04:37,494] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-18 00:04:37,494] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-18 00:04:37,494] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-18 00:04:37,494] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-18 00:04:37,495] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-18 00:04:37,495] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-18 00:04:37,495] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-18 00:04:37,495] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-18 00:04:37,495] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-18 00:04:37,495] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f936733d370>
[2023-08-18 00:04:37,495] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-18 00:04:37,495] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-18 00:04:37,495] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-18 00:04:37,495] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-18 00:04:37,495] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-18 00:04:37,495] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-18 00:04:37,495] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-18 00:04:37,495] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-18 00:04:37,495] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-18 00:04:37,495] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-18 00:04:37,495] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-18 00:04:37,495] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-18 00:04:37,495] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-18 00:04:37,495] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-18 00:04:37,495] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-18 00:04:37,495] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-18 00:04:37,495] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-18 00:04:37,495] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-18 00:04:37,495] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-18 00:04:37,495] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-18 00:04:37,496] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-18 00:04:37,496] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-18 00:04:37,496] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-18 00:04:37,496] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-18 00:04:37,496] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-18 00:04:37,496] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-18 00:04:37,496] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-18 00:04:37,496] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-18 00:04:37,496] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-18 00:04:37,496] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-18 00:04:37,496] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-18 00:04:37,496] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-18 00:04:37,496] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f936733d190>
[2023-08-18 00:04:37,496] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-18 00:04:37,496] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-18 00:04:37,496] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-18 00:04:37,496] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-18 00:04:37,496] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-18 00:04:37,496] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-18 00:04:37,496] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-18 00:04:37,496] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-18 00:04:37,496] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-18 00:04:37,496] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-18 00:04:37,496] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-18 00:04:37,496] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-18 00:04:37,496] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-18 00:04:37,496] [INFO] [config.py:1012:print]   train_batch_size ............. 8
[2023-08-18 00:04:37,496] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  2
[2023-08-18 00:04:37,496] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-18 00:04:37,496] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-18 00:04:37,496] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-18 00:04:37,496] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-18 00:04:37,497] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-18 00:04:37,497] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-18 00:04:37,497] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-18 00:04:37,497] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.3230135440826416 seconds
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.20392084121704102 seconds
Time to load utils op: 0.20400571823120117 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating gsm8k :   0%|                                                                                           | 0/125 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following grade math question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Output: D: accomplishing

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Output: A: office

Input:Natalia sold clips to 48 of her friends in April, and then she sold half as many clips in May. How many clips did Natalia sell altogether in April and May?
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o3-tcommonsenseqa-s1-rFalse
Loading extension module utils...
Time to load utils op: 0.2041168212890625 seconds
Evaluating gsm8k :   1%|▋                                                                                  | 1/125 [00:10<21:59, 10.64s/it]Evaluating gsm8k :   2%|█▎                                                                                 | 2/125 [00:39<44:09, 21.54s/it]Evaluating gsm8k :   2%|█▉                                                                                 | 3/125 [01:09<51:22, 25.26s/it]Evaluating gsm8k :   3%|██▋                                                                                | 4/125 [01:37<53:30, 26.54s/it]Evaluating gsm8k :   4%|███▎                                                                               | 5/125 [02:07<55:14, 27.62s/it]Evaluating gsm8k :   5%|███▉                                                                               | 6/125 [02:11<38:54, 19.62s/it]Evaluating gsm8k :   6%|████▋                                                                              | 7/125 [02:40<44:46, 22.77s/it]Evaluating gsm8k :   6%|█████▎                                                                             | 8/125 [03:09<48:07, 24.68s/it]Evaluating gsm8k :   7%|█████▉                                                                             | 9/125 [03:22<40:20, 20.87s/it]Evaluating gsm8k :   8%|██████▌                                                                           | 10/125 [03:51<45:03, 23.51s/it]Evaluating gsm8k :   9%|███████▏                                                                          | 11/125 [04:14<44:37, 23.49s/it]Evaluating gsm8k :  10%|███████▊                                                                          | 12/125 [04:44<47:34, 25.26s/it]Evaluating gsm8k :  10%|████████▌                                                                         | 13/125 [04:59<41:43, 22.36s/it]Evaluating gsm8k :  11%|█████████▏                                                                        | 14/125 [05:14<37:15, 20.14s/it]Evaluating gsm8k :  12%|█████████▊                                                                        | 15/125 [05:25<31:25, 17.14s/it]Evaluating gsm8k :  13%|██████████▍                                                                       | 16/125 [05:33<26:32, 14.61s/it]Evaluating gsm8k :  14%|███████████▏                                                                      | 17/125 [05:44<24:05, 13.39s/it]Evaluating gsm8k :  14%|███████████▊                                                                      | 18/125 [06:06<28:21, 15.90s/it]Evaluating gsm8k :  15%|████████████▍                                                                     | 19/125 [06:18<26:10, 14.81s/it]Evaluating gsm8k :  16%|█████████████                                                                     | 20/125 [06:45<32:10, 18.39s/it]Evaluating gsm8k :  17%|█████████████▊                                                                    | 21/125 [07:13<37:01, 21.36s/it]Evaluating gsm8k :  18%|██████████████▍                                                                   | 22/125 [07:42<40:28, 23.58s/it]Evaluating gsm8k :  18%|███████████████                                                                   | 23/125 [08:11<43:00, 25.30s/it]Evaluating gsm8k :  19%|███████████████▋                                                                  | 24/125 [08:24<36:22, 21.61s/it]Evaluating gsm8k :  20%|████████████████▍                                                                 | 25/125 [08:45<35:44, 21.44s/it]Evaluating gsm8k :  21%|█████████████████                                                                 | 26/125 [09:00<32:12, 19.52s/it]Evaluating gsm8k :  22%|█████████████████▋                                                                | 27/125 [09:06<25:07, 15.38s/it]Evaluating gsm8k :  22%|██████████████████▎                                                               | 28/125 [09:11<19:49, 12.26s/it]Evaluating gsm8k :  23%|███████████████████                                                               | 29/125 [09:25<20:32, 12.84s/it]Evaluating gsm8k :  24%|███████████████████▋                                                              | 30/125 [09:34<18:30, 11.69s/it]Evaluating gsm8k :  25%|████████████████████▎                                                             | 31/125 [10:03<26:26, 16.88s/it]Evaluating gsm8k :  26%|████████████████████▉                                                             | 32/125 [10:32<31:43, 20.47s/it]Evaluating gsm8k :  26%|█████████████████████▋                                                            | 33/125 [11:02<35:44, 23.31s/it]Evaluating gsm8k :  27%|██████████████████████▎                                                           | 34/125 [11:15<30:30, 20.11s/it]Evaluating gsm8k :  28%|██████████████████████▉                                                           | 35/125 [11:44<34:17, 22.86s/it]Evaluating gsm8k :  29%|███████████████████████▌                                                          | 36/125 [12:13<36:31, 24.63s/it]Evaluating gsm8k :  30%|████████████████████████▎                                                         | 37/125 [12:18<27:34, 18.80s/it]Evaluating gsm8k :  30%|████████████████████████▉                                                         | 38/125 [12:40<28:45, 19.83s/it]Evaluating gsm8k :  31%|█████████████████████████▌                                                        | 39/125 [12:51<24:34, 17.15s/it]Evaluating gsm8k :  32%|██████████████████████████▏                                                       | 40/125 [13:21<29:44, 20.99s/it]Evaluating gsm8k :  33%|██████████████████████████▉                                                       | 41/125 [13:35<26:24, 18.86s/it]Evaluating gsm8k :  34%|███████████████████████████▌                                                      | 42/125 [14:02<29:35, 21.40s/it]Evaluating gsm8k :  34%|████████████████████████████▏                                                     | 43/125 [14:14<25:13, 18.45s/it]Evaluating gsm8k :  35%|████████████████████████████▊                                                     | 44/125 [14:19<19:37, 14.54s/it]Evaluating gsm8k :  36%|█████████████████████████████▌                                                    | 45/125 [14:48<25:09, 18.87s/it]Evaluating gsm8k :  37%|██████████████████████████████▏                                                   | 46/125 [15:01<22:21, 16.99s/it]Evaluating gsm8k :  38%|██████████████████████████████▊                                                   | 47/125 [15:06<17:42, 13.62s/it]Evaluating gsm8k :  38%|███████████████████████████████▍                                                  | 48/125 [15:35<23:19, 18.17s/it]Evaluating gsm8k :  39%|████████████████████████████████▏                                                 | 49/125 [16:05<27:17, 21.55s/it]Evaluating gsm8k :  40%|████████████████████████████████▊                                                 | 50/125 [16:17<23:30, 18.81s/it]Evaluating gsm8k :  41%|█████████████████████████████████▍                                                | 51/125 [16:46<26:54, 21.81s/it]Evaluating gsm8k :  42%|██████████████████████████████████                                                | 52/125 [17:15<29:05, 23.91s/it]Evaluating gsm8k :  42%|██████████████████████████████████▊                                               | 53/125 [17:19<21:34, 17.97s/it]Evaluating gsm8k :  43%|███████████████████████████████████▍                                              | 54/125 [17:35<20:30, 17.33s/it]Evaluating gsm8k :  44%|████████████████████████████████████                                              | 55/125 [17:50<19:26, 16.66s/it]Evaluating gsm8k :  45%|████████████████████████████████████▋                                             | 56/125 [18:06<19:10, 16.67s/it]Evaluating gsm8k :  46%|█████████████████████████████████████▍                                            | 57/125 [18:35<23:06, 20.39s/it]Evaluating gsm8k :  46%|██████████████████████████████████████                                            | 58/125 [19:04<25:35, 22.92s/it]Evaluating gsm8k :  47%|██████████████████████████████████████▋                                           | 59/125 [19:21<23:09, 21.05s/it]Evaluating gsm8k :  48%|███████████████████████████████████████▎                                          | 60/125 [19:27<17:50, 16.48s/it]Evaluating gsm8k :  49%|████████████████████████████████████████                                          | 61/125 [19:40<16:31, 15.49s/it]Evaluating gsm8k :  50%|████████████████████████████████████████▋                                         | 62/125 [19:48<13:58, 13.32s/it]Evaluating gsm8k :  50%|█████████████████████████████████████████▎                                        | 63/125 [19:56<12:12, 11.82s/it]Evaluating gsm8k :  51%|█████████████████████████████████████████▉                                        | 64/125 [20:25<17:12, 16.93s/it]Evaluating gsm8k :  52%|██████████████████████████████████████████▋                                       | 65/125 [20:55<20:44, 20.75s/it]Evaluating gsm8k :  53%|███████████████████████████████████████████▎                                      | 66/125 [21:14<19:55, 20.27s/it]Evaluating gsm8k :  54%|███████████████████████████████████████████▉                                      | 67/125 [21:25<16:51, 17.45s/it]Evaluating gsm8k :  54%|████████████████████████████████████████████▌                                     | 68/125 [21:55<20:08, 21.20s/it]Evaluating gsm8k :  55%|█████████████████████████████████████████████▎                                    | 69/125 [22:07<17:06, 18.34s/it]Evaluating gsm8k :  56%|█████████████████████████████████████████████▉                                    | 70/125 [22:15<14:07, 15.40s/it]Evaluating gsm8k :  57%|██████████████████████████████████████████████▌                                   | 71/125 [22:37<15:42, 17.45s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▏                                  | 72/125 [23:06<18:27, 20.90s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▉                                  | 73/125 [23:35<20:12, 23.33s/it]Evaluating gsm8k :  59%|████████████████████████████████████████████████▌                                 | 74/125 [24:04<21:18, 25.06s/it]Evaluating gsm8k :  60%|█████████████████████████████████████████████████▏                                | 75/125 [24:34<21:53, 26.28s/it]Evaluating gsm8k :  61%|█████████████████████████████████████████████████▊                                | 76/125 [24:50<19:02, 23.32s/it]Evaluating gsm8k :  62%|██████████████████████████████████████████████████▌                               | 77/125 [24:56<14:29, 18.11s/it]Evaluating gsm8k :  62%|███████████████████████████████████████████████████▏                              | 78/125 [25:05<11:57, 15.26s/it]Evaluating gsm8k :  63%|███████████████████████████████████████████████████▊                              | 79/125 [25:21<11:51, 15.47s/it]Evaluating gsm8k :  64%|████████████████████████████████████████████████████▍                             | 80/125 [25:47<14:01, 18.69s/it]Evaluating gsm8k :  65%|█████████████████████████████████████████████████████▏                            | 81/125 [26:01<12:41, 17.31s/it]Evaluating gsm8k :  66%|█████████████████████████████████████████████████████▊                            | 82/125 [26:06<09:53, 13.79s/it]Evaluating gsm8k :  66%|██████████████████████████████████████████████████████▍                           | 83/125 [26:13<08:06, 11.59s/it]Evaluating gsm8k :  67%|███████████████████████████████████████████████████████                           | 84/125 [26:22<07:25, 10.87s/it]Evaluating gsm8k :  68%|███████████████████████████████████████████████████████▊                          | 85/125 [26:51<10:54, 16.36s/it]Evaluating gsm8k :  69%|████████████████████████████████████████████████████████▍                         | 86/125 [27:21<13:14, 20.37s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████                         | 87/125 [27:50<14:28, 22.86s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████▋                        | 88/125 [28:06<12:53, 20.92s/it]Evaluating gsm8k :  71%|██████████████████████████████████████████████████████████▍                       | 89/125 [28:09<09:15, 15.43s/it]Evaluating gsm8k :  72%|███████████████████████████████████████████████████████████                       | 90/125 [28:38<11:22, 19.51s/it]Evaluating gsm8k :  73%|███████████████████████████████████████████████████████████▋                      | 91/125 [28:40<08:07, 14.34s/it]Evaluating gsm8k :  74%|████████████████████████████████████████████████████████████▎                     | 92/125 [29:10<10:24, 18.93s/it]Evaluating gsm8k :  74%|█████████████████████████████████████████████████████████████                     | 93/125 [29:27<09:54, 18.58s/it]Evaluating gsm8k :  75%|█████████████████████████████████████████████████████████████▋                    | 94/125 [29:38<08:18, 16.07s/it]Evaluating gsm8k :  76%|██████████████████████████████████████████████████████████████▎                   | 95/125 [30:07<10:06, 20.21s/it]Evaluating gsm8k :  77%|██████████████████████████████████████████████████████████████▉                   | 96/125 [30:33<10:29, 21.72s/it]Evaluating gsm8k :  78%|███████████████████████████████████████████████████████████████▋                  | 97/125 [30:51<09:41, 20.75s/it]Evaluating gsm8k :  78%|████████████████████████████████████████████████████████████████▎                 | 98/125 [31:21<10:29, 23.33s/it]Evaluating gsm8k :  79%|████████████████████████████████████████████████████████████████▉                 | 99/125 [31:30<08:18, 19.18s/it]Evaluating gsm8k :  80%|████████████████████████████████████████████████████████████████▊                | 100/125 [31:46<07:33, 18.13s/it]Evaluating gsm8k :  81%|█████████████████████████████████████████████████████████████████▍               | 101/125 [32:06<07:29, 18.74s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████               | 102/125 [32:23<07:01, 18.31s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████▋              | 103/125 [32:28<05:11, 14.18s/it]Evaluating gsm8k :  83%|███████████████████████████████████████████████████████████████████▍             | 104/125 [32:57<06:35, 18.84s/it]Evaluating gsm8k :  84%|████████████████████████████████████████████████████████████████████             | 105/125 [33:13<05:56, 17.84s/it]Evaluating gsm8k :  85%|████████████████████████████████████████████████████████████████████▋            | 106/125 [33:27<05:19, 16.82s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▎           | 107/125 [33:40<04:38, 15.46s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▉           | 108/125 [34:09<05:34, 19.70s/it]Evaluating gsm8k :  87%|██████████████████████████████████████████████████████████████████████▋          | 109/125 [34:38<05:59, 22.45s/it]Evaluating gsm8k :  88%|███████████████████████████████████████████████████████████████████████▎         | 110/125 [35:07<06:06, 24.45s/it]Evaluating gsm8k :  89%|███████████████████████████████████████████████████████████████████████▉         | 111/125 [35:36<06:01, 25.83s/it]Evaluating gsm8k :  90%|████████████████████████████████████████████████████████████████████████▌        | 112/125 [36:05<05:48, 26.85s/it]Evaluating gsm8k :  90%|█████████████████████████████████████████████████████████████████████████▏       | 113/125 [36:34<05:28, 27.40s/it]Evaluating gsm8k :  91%|█████████████████████████████████████████████████████████████████████████▊       | 114/125 [37:03<05:06, 27.86s/it]Evaluating gsm8k :  92%|██████████████████████████████████████████████████████████████████████████▌      | 115/125 [37:25<04:19, 25.97s/it]Evaluating gsm8k :  93%|███████████████████████████████████████████████████████████████████████████▏     | 116/125 [37:53<04:01, 26.82s/it]Evaluating gsm8k :  94%|███████████████████████████████████████████████████████████████████████████▊     | 117/125 [38:23<03:40, 27.62s/it]Evaluating gsm8k :  94%|████████████████████████████████████████████████████████████████████████████▍    | 118/125 [38:52<03:15, 27.94s/it]Evaluating gsm8k :  95%|█████████████████████████████████████████████████████████████████████████████    | 119/125 [38:54<02:01, 20.22s/it]Evaluating gsm8k :  96%|█████████████████████████████████████████████████████████████████████████████▊   | 120/125 [39:23<01:54, 22.84s/it]Evaluating gsm8k :  97%|██████████████████████████████████████████████████████████████████████████████▍  | 121/125 [39:45<01:30, 22.75s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████  | 122/125 [40:14<01:13, 24.55s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████▋ | 123/125 [40:44<00:52, 26.17s/it]Evaluating gsm8k :  99%|████████████████████████████████████████████████████████████████████████████████▎| 124/125 [40:51<00:20, 20.43s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [41:20<00:00, 22.95s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [41:20<00:00, 19.84s/it]
name: gsm8k | {'exact_match': 0.0, 'rougeL': 0.2879} | lm_loss 9.7954 | avg. gen lenth: 240.456
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name gsm8k --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name commonsenseqa --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 2 --data-dir /scratch/ylu130/processed_data/gsm8k/out-domain/o4-tcommonsenseqa-s1-rFalse --seed 1 --max-prompt-length 2048 --num-out-domain 4
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-18 00:49:37,568] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... gsm8k
  data_dir ..................... /scratch/ylu130/processed_data/gsm8k/out-domain/o4-tcommonsenseqa-s1-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 4
  out_domain_data_name ......... commonsenseqa
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o4-tcommonsenseqa-s1-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 2
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                                             | 0/7473 [00:00<?, ?it/s]  2%|█▊                                                                                               | 135/7473 [00:00<00:05, 1349.21it/s]  4%|███▌                                                                                             | 273/7473 [00:00<00:05, 1364.84it/s]  5%|█████▎                                                                                           | 410/7473 [00:00<00:05, 1366.56it/s]  7%|███████                                                                                          | 548/7473 [00:00<00:05, 1369.20it/s]  9%|████████▉                                                                                        | 687/7473 [00:00<00:04, 1373.79it/s] 11%|██████████▋                                                                                      | 826/7473 [00:00<00:04, 1377.51it/s] 13%|████████████▌                                                                                    | 965/7473 [00:00<00:04, 1379.88it/s] 15%|██████████████▏                                                                                 | 1105/7473 [00:00<00:04, 1385.66it/s] 17%|███████████████▉                                                                                | 1244/7473 [00:00<00:04, 1353.86it/s] 18%|█████████████████▊                                                                              | 1382/7473 [00:01<00:04, 1359.80it/s] 20%|███████████████████▌                                                                            | 1520/7473 [00:01<00:04, 1364.58it/s] 22%|█████████████████████▎                                                                          | 1657/7473 [00:01<00:04, 1360.33it/s] 24%|███████████████████████                                                                         | 1795/7473 [00:01<00:04, 1366.18it/s] 26%|████████████████████████▊                                                                       | 1932/7473 [00:01<00:04, 1360.06it/s] 28%|██████████████████████████▌                                                                     | 2070/7473 [00:01<00:03, 1363.35it/s] 30%|████████████████████████████▍                                                                   | 2209/7473 [00:01<00:03, 1368.73it/s] 31%|██████████████████████████████▏                                                                 | 2346/7473 [00:01<00:03, 1364.52it/s] 33%|███████████████████████████████▉                                                                | 2486/7473 [00:01<00:03, 1373.16it/s] 35%|█████████████████████████████████▋                                                              | 2624/7473 [00:01<00:03, 1328.31it/s] 37%|███████████████████████████████████▍                                                            | 2762/7473 [00:02<00:03, 1342.52it/s] 39%|█████████████████████████████████████▎                                                          | 2901/7473 [00:02<00:03, 1354.88it/s] 41%|███████████████████████████████████████                                                         | 3041/7473 [00:02<00:03, 1365.52it/s] 43%|████████████████████████████████████████▊                                                       | 3178/7473 [00:02<00:03, 1364.52it/s] 44%|██████████████████████████████████████████▌                                                     | 3317/7473 [00:02<00:03, 1369.90it/s] 46%|████████████████████████████████████████████▍                                                   | 3455/7473 [00:02<00:02, 1361.18it/s] 48%|██████████████████████████████████████████████▏                                                 | 3594/7473 [00:02<00:02, 1367.86it/s] 50%|███████████████████████████████████████████████▉                                                | 3731/7473 [00:02<00:02, 1362.86it/s] 52%|█████████████████████████████████████████████████▋                                              | 3869/7473 [00:02<00:02, 1365.99it/s] 54%|███████████████████████████████████████████████████▍                                            | 4006/7473 [00:02<00:02, 1366.38it/s] 55%|█████████████████████████████████████████████████████▏                                          | 4143/7473 [00:03<00:02, 1362.34it/s] 57%|██████████████████████████████████████████████████████▉                                         | 4280/7473 [00:03<00:02, 1362.51it/s] 59%|████████████████████████████████████████████████████████▋                                       | 4417/7473 [00:03<00:02, 1350.52it/s] 61%|██████████████████████████████████████████████████████████▌                                     | 4554/7473 [00:03<00:02, 1354.57it/s] 63%|████████████████████████████████████████████████████████████▊                                   | 4733/7473 [00:03<00:01, 1482.16it/s] 66%|███████████████████████████████████████████████████████████████▍                                | 4940/7473 [00:03<00:01, 1655.25it/s] 69%|██████████████████████████████████████████████████████████████████▏                             | 5149/7473 [00:03<00:01, 1784.15it/s] 71%|████████████████████████████████████████████████████████████████████▋                           | 5343/7473 [00:03<00:01, 1830.20it/s] 74%|███████████████████████████████████████████████████████████████████████                         | 5527/7473 [00:03<00:01, 1448.54it/s] 77%|█████████████████████████████████████████████████████████████████████████▋                      | 5735/7473 [00:04<00:01, 1607.20it/s] 80%|████████████████████████████████████████████████████████████████████████████▎                   | 5942/7473 [00:04<00:00, 1727.91it/s] 82%|███████████████████████████████████████████████████████████████████████████████                 | 6151/7473 [00:04<00:00, 1826.50it/s] 85%|█████████████████████████████████████████████████████████████████████████████████▋              | 6361/7473 [00:04<00:00, 1902.45it/s] 88%|████████████████████████████████████████████████████████████████████████████████████▍           | 6569/7473 [00:04<00:00, 1953.33it/s] 91%|██████████████████████████████████████████████████████████████████████████████████████▉         | 6769/7473 [00:04<00:00, 1958.69it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████▌      | 6974/7473 [00:04<00:00, 1984.69it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████▏   | 7181/7473 [00:04<00:00, 2009.47it/s] 99%|██████████████████████████████████████████████████████████████████████████████████████████████▉ | 7392/7473 [00:04<00:00, 2036.39it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████| 7473/7473 [00:04<00:00, 1533.12it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.25s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.24s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.22s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.43s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.07s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.10s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.19s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.37s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.41s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.61s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.60s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.75s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.55s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.73s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.76s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.93s/it]
[2023-08-18 00:50:34,642] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
[2023-08-18 00:50:41,961] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-18 00:50:41,963] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-18 00:50:41,964] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-18 00:50:41,964] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-18 00:50:41,964] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-18 00:50:41,964] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-18 00:50:41,965] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-18 00:50:41,965] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-18 00:50:41,965] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-18 00:50:41,965] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-18 00:50:41,965] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-18 00:50:41,965] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f75bd38f370>
[2023-08-18 00:50:41,965] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-18 00:50:41,965] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-18 00:50:41,965] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-18 00:50:41,965] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-18 00:50:41,965] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-18 00:50:41,965] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-18 00:50:41,965] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-18 00:50:41,965] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-18 00:50:41,965] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-18 00:50:41,965] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-18 00:50:41,965] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-18 00:50:41,965] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-18 00:50:41,966] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-18 00:50:41,966] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-18 00:50:41,966] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-18 00:50:41,966] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-18 00:50:41,966] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-18 00:50:41,966] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-18 00:50:41,966] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-18 00:50:41,966] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-18 00:50:41,966] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-18 00:50:41,966] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-18 00:50:41,966] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-18 00:50:41,966] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-18 00:50:41,966] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-18 00:50:41,966] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-18 00:50:41,966] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-18 00:50:41,966] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-18 00:50:41,966] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-18 00:50:41,966] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-18 00:50:41,966] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-18 00:50:41,966] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-18 00:50:41,966] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f75bd38f190>
[2023-08-18 00:50:41,967] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-18 00:50:41,967] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-18 00:50:41,967] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-18 00:50:41,967] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-18 00:50:41,967] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-18 00:50:41,967] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-18 00:50:41,967] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-18 00:50:41,967] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-18 00:50:41,967] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-18 00:50:41,967] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-18 00:50:41,967] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-18 00:50:41,967] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-18 00:50:41,967] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-18 00:50:41,967] [INFO] [config.py:1012:print]   train_batch_size ............. 8
[2023-08-18 00:50:41,967] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  2
[2023-08-18 00:50:41,967] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-18 00:50:41,967] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-18 00:50:41,967] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-18 00:50:41,967] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-18 00:50:41,967] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-18 00:50:41,968] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-18 00:50:41,968] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-18 00:50:41,968] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.3734583854675293 seconds
Loading extension module utils...
Time to load utils op: 0.4044339656829834 seconds
Loading extension module utils...
Time to load utils op: 0.4049568176269531 seconds
Loading extension module utils...
Time to load utils op: 0.4043114185333252 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating gsm8k :   0%|                                                                                           | 0/125 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following grade math question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Output: D: accomplishing

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Output: A: office

Input: Billy called out to John, and listened for what? Choices:  A: silence B: response C: communication D: hanging up E: whisper
Output: B: response

Input:Natalia sold clips to 48 of her friends in April, and then she sold half as many clips in May. How many clips did Natalia sell altogether in April and May?
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o4-tcommonsenseqa-s1-rFalse
Evaluating gsm8k :   1%|▋                                                                                  | 1/125 [00:24<50:21, 24.37s/it]Evaluating gsm8k :   2%|█▎                                                                                 | 2/125 [00:39<38:52, 18.96s/it]Evaluating gsm8k :   2%|█▉                                                                                 | 3/125 [01:09<48:23, 23.80s/it]Evaluating gsm8k :   3%|██▋                                                                                | 4/125 [01:14<33:43, 16.72s/it]Evaluating gsm8k :   4%|███▎                                                                               | 5/125 [01:31<33:18, 16.65s/it]Evaluating gsm8k :   5%|███▉                                                                               | 6/125 [02:00<41:41, 21.02s/it]Evaluating gsm8k :   6%|████▋                                                                              | 7/125 [02:30<46:31, 23.65s/it]Evaluating gsm8k :   6%|█████▎                                                                             | 8/125 [02:50<43:51, 22.50s/it]Evaluating gsm8k :   7%|█████▉                                                                             | 9/125 [03:19<47:26, 24.54s/it]Evaluating gsm8k :   8%|██████▌                                                                           | 10/125 [03:47<49:34, 25.87s/it]Evaluating gsm8k :   9%|███████▏                                                                          | 11/125 [04:04<43:29, 22.89s/it]Evaluating gsm8k :  10%|███████▊                                                                          | 12/125 [04:23<40:58, 21.76s/it]Evaluating gsm8k :  10%|████████▌                                                                         | 13/125 [04:52<44:40, 23.93s/it]Evaluating gsm8k :  11%|█████████▏                                                                        | 14/125 [05:09<40:21, 21.81s/it]Evaluating gsm8k :  12%|█████████▊                                                                        | 15/125 [05:24<36:39, 19.99s/it]Evaluating gsm8k :  13%|██████████▍                                                                       | 16/125 [05:53<41:15, 22.71s/it]Evaluating gsm8k :  14%|███████████▏                                                                      | 17/125 [06:22<44:17, 24.60s/it]Evaluating gsm8k :  14%|███████████▊                                                                      | 18/125 [06:35<37:33, 21.06s/it]Evaluating gsm8k :  15%|████████████▍                                                                     | 19/125 [06:51<34:36, 19.59s/it]Evaluating gsm8k :  16%|█████████████                                                                     | 20/125 [07:09<33:22, 19.08s/it]Evaluating gsm8k :  17%|█████████████▊                                                                    | 21/125 [07:38<38:15, 22.07s/it]Evaluating gsm8k :  18%|██████████████▍                                                                   | 22/125 [07:51<32:56, 19.19s/it]Evaluating gsm8k :  18%|███████████████                                                                   | 23/125 [08:12<33:48, 19.89s/it]Evaluating gsm8k :  19%|███████████████▋                                                                  | 24/125 [08:28<31:19, 18.61s/it]Evaluating gsm8k :  20%|████████████████▍                                                                 | 25/125 [08:36<25:35, 15.35s/it]Evaluating gsm8k :  21%|█████████████████                                                                 | 26/125 [09:05<32:16, 19.56s/it]Evaluating gsm8k :  22%|█████████████████▋                                                                | 27/125 [09:34<36:44, 22.50s/it]Evaluating gsm8k :  22%|██████████████████▎                                                               | 28/125 [10:04<39:35, 24.49s/it]Evaluating gsm8k :  23%|███████████████████                                                               | 29/125 [10:31<40:34, 25.36s/it]Evaluating gsm8k :  24%|███████████████████▋                                                              | 30/125 [11:00<42:00, 26.53s/it]Evaluating gsm8k :  25%|████████████████████▎                                                             | 31/125 [11:17<36:56, 23.58s/it]Evaluating gsm8k :  26%|████████████████████▉                                                             | 32/125 [11:19<26:41, 17.22s/it]Evaluating gsm8k :  26%|█████████████████████▋                                                            | 33/125 [11:29<22:49, 14.89s/it]Evaluating gsm8k :  27%|██████████████████████▎                                                           | 34/125 [11:39<20:19, 13.40s/it]Evaluating gsm8k :  28%|██████████████████████▉                                                           | 35/125 [11:46<17:15, 11.50s/it]Evaluating gsm8k :  29%|███████████████████████▌                                                          | 36/125 [12:13<24:11, 16.31s/it]Evaluating gsm8k :  30%|████████████████████████▎                                                         | 37/125 [12:35<26:04, 17.78s/it]Evaluating gsm8k :  30%|████████████████████████▉                                                         | 38/125 [13:03<30:30, 21.04s/it]Evaluating gsm8k :  31%|█████████████████████████▌                                                        | 39/125 [13:31<33:15, 23.21s/it]Evaluating gsm8k :  32%|██████████████████████████▏                                                       | 40/125 [14:00<35:16, 24.90s/it]Evaluating gsm8k :  33%|██████████████████████████▉                                                       | 41/125 [14:21<33:07, 23.66s/it]Evaluating gsm8k :  34%|███████████████████████████▌                                                      | 42/125 [14:27<25:11, 18.21s/it]Evaluating gsm8k :  34%|████████████████████████████▏                                                     | 43/125 [14:41<23:28, 17.18s/it]Evaluating gsm8k :  35%|████████████████████████████▊                                                     | 44/125 [15:06<26:13, 19.42s/it]Evaluating gsm8k :  36%|█████████████████████████████▌                                                    | 45/125 [15:08<19:01, 14.27s/it]Evaluating gsm8k :  37%|██████████████████████████████▏                                                   | 46/125 [15:37<24:35, 18.68s/it]Evaluating gsm8k :  38%|██████████████████████████████▊                                                   | 47/125 [16:07<28:28, 21.90s/it]Evaluating gsm8k :  38%|███████████████████████████████▍                                                  | 48/125 [16:26<27:11, 21.19s/it]Evaluating gsm8k :  39%|████████████████████████████████▏                                                 | 49/125 [16:53<29:10, 23.03s/it]Evaluating gsm8k :  40%|████████████████████████████████▊                                                 | 50/125 [17:23<31:17, 25.03s/it]Evaluating gsm8k :  41%|█████████████████████████████████▍                                                | 51/125 [17:52<32:12, 26.11s/it]Evaluating gsm8k :  42%|██████████████████████████████████                                                | 52/125 [18:14<30:10, 24.80s/it]Evaluating gsm8k :  42%|██████████████████████████████████▊                                               | 53/125 [18:42<31:11, 25.99s/it]Evaluating gsm8k :  43%|███████████████████████████████████▍                                              | 54/125 [18:53<25:23, 21.45s/it]Evaluating gsm8k :  44%|████████████████████████████████████                                              | 55/125 [19:23<27:54, 23.92s/it]Evaluating gsm8k :  45%|████████████████████████████████████▋                                             | 56/125 [19:52<29:29, 25.65s/it]Evaluating gsm8k :  46%|█████████████████████████████████████▍                                            | 57/125 [20:03<23:53, 21.08s/it]Evaluating gsm8k :  46%|██████████████████████████████████████                                            | 58/125 [20:06<17:29, 15.67s/it]Evaluating gsm8k :  47%|██████████████████████████████████████▋                                           | 59/125 [20:35<21:29, 19.53s/it]Evaluating gsm8k :  48%|███████████████████████████████████████▎                                          | 60/125 [20:52<20:23, 18.82s/it]Evaluating gsm8k :  49%|████████████████████████████████████████                                          | 61/125 [21:12<20:42, 19.42s/it]Evaluating gsm8k :  50%|████████████████████████████████████████▋                                         | 62/125 [21:37<21:51, 20.82s/it]Evaluating gsm8k :  50%|█████████████████████████████████████████▎                                        | 63/125 [21:47<18:19, 17.73s/it]Evaluating gsm8k :  51%|█████████████████████████████████████████▉                                        | 64/125 [22:17<21:38, 21.29s/it]Evaluating gsm8k :  52%|██████████████████████████████████████████▋                                       | 65/125 [22:45<23:30, 23.51s/it]Evaluating gsm8k :  53%|███████████████████████████████████████████▎                                      | 66/125 [22:58<19:53, 20.22s/it]Evaluating gsm8k :  54%|███████████████████████████████████████████▉                                      | 67/125 [23:27<22:00, 22.77s/it]Evaluating gsm8k :  54%|████████████████████████████████████████████▌                                     | 68/125 [23:31<16:23, 17.26s/it]Evaluating gsm8k :  55%|█████████████████████████████████████████████▎                                    | 69/125 [23:45<15:13, 16.31s/it]Evaluating gsm8k :  56%|█████████████████████████████████████████████▉                                    | 70/125 [24:14<18:29, 20.18s/it]Evaluating gsm8k :  57%|██████████████████████████████████████████████▌                                   | 71/125 [24:43<20:26, 22.72s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▏                                  | 72/125 [24:47<15:07, 17.13s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▉                                  | 73/125 [25:15<17:42, 20.44s/it]Evaluating gsm8k :  59%|████████████████████████████████████████████████▌                                 | 74/125 [25:21<13:33, 15.95s/it]Evaluating gsm8k :  60%|█████████████████████████████████████████████████▏                                | 75/125 [25:26<10:39, 12.79s/it]Evaluating gsm8k :  61%|█████████████████████████████████████████████████▊                                | 76/125 [25:41<10:53, 13.34s/it]Evaluating gsm8k :  62%|██████████████████████████████████████████████████▌                               | 77/125 [26:10<14:30, 18.14s/it]Evaluating gsm8k :  62%|███████████████████████████████████████████████████▏                              | 78/125 [26:20<12:13, 15.61s/it]Evaluating gsm8k :  63%|███████████████████████████████████████████████████▊                              | 79/125 [26:25<09:30, 12.41s/it]Evaluating gsm8k :  64%|████████████████████████████████████████████████████▍                             | 80/125 [26:48<11:49, 15.77s/it]Evaluating gsm8k :  65%|█████████████████████████████████████████████████████▏                            | 81/125 [27:18<14:37, 19.95s/it]Evaluating gsm8k :  66%|█████████████████████████████████████████████████████▊                            | 82/125 [27:47<16:08, 22.52s/it]Evaluating gsm8k :  66%|██████████████████████████████████████████████████████▍                           | 83/125 [28:02<14:10, 20.24s/it]Evaluating gsm8k :  67%|███████████████████████████████████████████████████████                           | 84/125 [28:23<14:10, 20.74s/it]Evaluating gsm8k :  68%|███████████████████████████████████████████████████████▊                          | 85/125 [28:53<15:34, 23.37s/it]Evaluating gsm8k :  69%|████████████████████████████████████████████████████████▍                         | 86/125 [29:01<12:08, 18.69s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████                         | 87/125 [29:30<13:54, 21.96s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████▋                        | 88/125 [29:47<12:34, 20.40s/it]Evaluating gsm8k :  71%|██████████████████████████████████████████████████████████▍                       | 89/125 [30:15<13:32, 22.57s/it]Evaluating gsm8k :  72%|███████████████████████████████████████████████████████████                       | 90/125 [30:44<14:22, 24.65s/it]Evaluating gsm8k :  73%|███████████████████████████████████████████████████████████▋                      | 91/125 [31:13<14:37, 25.82s/it]Evaluating gsm8k :  74%|████████████████████████████████████████████████████████████▎                     | 92/125 [31:22<11:26, 20.80s/it]Evaluating gsm8k :  74%|█████████████████████████████████████████████████████████████                     | 93/125 [31:46<11:40, 21.89s/it]Evaluating gsm8k :  75%|█████████████████████████████████████████████████████████████▋                    | 94/125 [31:49<08:16, 16.01s/it]Evaluating gsm8k :  76%|██████████████████████████████████████████████████████████████▎                   | 95/125 [32:18<09:59, 20.00s/it]Evaluating gsm8k :  77%|██████████████████████████████████████████████████████████████▉                   | 96/125 [32:30<08:29, 17.58s/it]Evaluating gsm8k :  78%|███████████████████████████████████████████████████████████████▋                  | 97/125 [32:59<09:52, 21.15s/it]Evaluating gsm8k :  78%|████████████████████████████████████████████████████████████████▎                 | 98/125 [33:28<10:32, 23.44s/it]Evaluating gsm8k :  79%|████████████████████████████████████████████████████████████████▉                 | 99/125 [33:38<08:27, 19.53s/it]Evaluating gsm8k :  80%|████████████████████████████████████████████████████████████████▊                | 100/125 [33:46<06:38, 15.95s/it]Evaluating gsm8k :  81%|█████████████████████████████████████████████████████████████████▍               | 101/125 [34:08<07:04, 17.70s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████               | 102/125 [34:21<06:15, 16.33s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████▋              | 103/125 [34:49<07:18, 19.95s/it]Evaluating gsm8k :  83%|███████████████████████████████████████████████████████████████████▍             | 104/125 [35:19<08:00, 22.88s/it]Evaluating gsm8k :  84%|████████████████████████████████████████████████████████████████████             | 105/125 [35:49<08:18, 24.91s/it]Evaluating gsm8k :  85%|████████████████████████████████████████████████████████████████████▋            | 106/125 [35:51<05:45, 18.18s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▎           | 107/125 [36:20<06:24, 21.34s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▉           | 108/125 [36:49<06:41, 23.63s/it]Evaluating gsm8k :  87%|██████████████████████████████████████████████████████████████████████▋          | 109/125 [37:18<06:45, 25.35s/it]Evaluating gsm8k :  88%|███████████████████████████████████████████████████████████████████████▎         | 110/125 [37:41<06:09, 24.60s/it]Evaluating gsm8k :  89%|███████████████████████████████████████████████████████████████████████▉         | 111/125 [38:11<06:05, 26.14s/it]Evaluating gsm8k :  90%|████████████████████████████████████████████████████████████████████████▌        | 112/125 [38:40<05:49, 26.92s/it]Evaluating gsm8k :  90%|█████████████████████████████████████████████████████████████████████████▏       | 113/125 [38:42<03:54, 19.56s/it]Evaluating gsm8k :  91%|█████████████████████████████████████████████████████████████████████████▊       | 114/125 [39:00<03:31, 19.20s/it]Evaluating gsm8k :  92%|██████████████████████████████████████████████████████████████████████████▌      | 115/125 [39:30<03:42, 22.30s/it]Evaluating gsm8k :  93%|███████████████████████████████████████████████████████████████████████████▏     | 116/125 [39:50<03:13, 21.53s/it]Evaluating gsm8k :  94%|███████████████████████████████████████████████████████████████████████████▊     | 117/125 [40:19<03:11, 23.91s/it]Evaluating gsm8k :  94%|████████████████████████████████████████████████████████████████████████████▍    | 118/125 [40:48<02:57, 25.42s/it]Evaluating gsm8k :  95%|█████████████████████████████████████████████████████████████████████████████    | 119/125 [40:54<01:57, 19.57s/it]Evaluating gsm8k :  96%|█████████████████████████████████████████████████████████████████████████████▊   | 120/125 [41:22<01:50, 22.12s/it]Evaluating gsm8k :  97%|██████████████████████████████████████████████████████████████████████████████▍  | 121/125 [41:50<01:36, 24.03s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████  | 122/125 [42:17<01:14, 24.81s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████▋ | 123/125 [42:33<00:44, 22.07s/it]Evaluating gsm8k :  99%|████████████████████████████████████████████████████████████████████████████████▎| 124/125 [43:03<00:24, 24.42s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [43:23<00:00, 23.34s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [43:23<00:00, 20.83s/it]
name: gsm8k | {'exact_match': 0.4, 'rougeL': 0.8331} | lm_loss 9.7864 | avg. gen lenth: 236.984
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name gsm8k --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name commonsenseqa --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 2 --data-dir /scratch/ylu130/processed_data/gsm8k/out-domain/o5-tcommonsenseqa-s1-rFalse --seed 1 --max-prompt-length 2048 --num-out-domain 5
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-18 01:34:36,760] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... gsm8k
  data_dir ..................... /scratch/ylu130/processed_data/gsm8k/out-domain/o5-tcommonsenseqa-s1-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 5
  out_domain_data_name ......... commonsenseqa
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o5-tcommonsenseqa-s1-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 2
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                                             | 0/7473 [00:00<?, ?it/s]  2%|█▌                                                                                               | 119/7473 [00:00<00:06, 1189.16it/s]  3%|███▏                                                                                             | 241/7473 [00:00<00:06, 1204.11it/s]  5%|████▋                                                                                            | 362/7473 [00:00<00:05, 1206.60it/s]  6%|██████▎                                                                                          | 483/7473 [00:00<00:05, 1201.44it/s]  8%|███████▊                                                                                         | 605/7473 [00:00<00:05, 1205.07it/s] 10%|█████████▍                                                                                       | 728/7473 [00:00<00:05, 1212.27it/s] 11%|███████████                                                                                      | 850/7473 [00:00<00:05, 1211.72it/s] 13%|████████████▋                                                                                    | 973/7473 [00:00<00:05, 1214.96it/s] 15%|██████████████                                                                                  | 1095/7473 [00:00<00:05, 1197.32it/s] 16%|███████████████▌                                                                                | 1215/7473 [00:01<00:05, 1195.09it/s] 18%|█████████████████▏                                                                              | 1337/7473 [00:01<00:05, 1200.84it/s] 20%|██████████████████▋                                                                             | 1458/7473 [00:01<00:05, 1199.29it/s] 21%|████████████████████▎                                                                           | 1579/7473 [00:01<00:04, 1200.78it/s] 23%|█████████████████████▊                                                                          | 1700/7473 [00:01<00:04, 1202.44it/s] 24%|███████████████████████▍                                                                        | 1822/7473 [00:01<00:04, 1204.82it/s] 26%|████████████████████████▉                                                                       | 1943/7473 [00:01<00:04, 1198.75it/s] 28%|██████████████████████████▌                                                                     | 2065/7473 [00:01<00:04, 1204.45it/s] 29%|████████████████████████████                                                                    | 2186/7473 [00:01<00:04, 1203.05it/s] 31%|█████████████████████████████▋                                                                  | 2307/7473 [00:01<00:04, 1201.79it/s] 33%|███████████████████████████████▏                                                                | 2429/7473 [00:02<00:04, 1206.77it/s] 34%|████████████████████████████████▊                                                               | 2550/7473 [00:02<00:04, 1170.30it/s] 37%|███████████████████████████████████▏                                                            | 2737/7473 [00:02<00:03, 1373.02it/s] 39%|█████████████████████████████████████▌                                                          | 2924/7473 [00:02<00:02, 1517.48it/s] 42%|███████████████████████████████████████▉                                                        | 3110/7473 [00:02<00:02, 1615.50it/s] 44%|██████████████████████████████████████████▎                                                     | 3295/7473 [00:02<00:02, 1682.98it/s] 47%|████████████████████████████████████████████▋                                                   | 3477/7473 [00:02<00:02, 1722.94it/s] 49%|███████████████████████████████████████████████                                                 | 3661/7473 [00:02<00:02, 1756.45it/s] 51%|█████████████████████████████████████████████████▍                                              | 3846/7473 [00:02<00:02, 1784.10it/s] 54%|███████████████████████████████████████████████████▊                                            | 4031/7473 [00:02<00:01, 1802.41it/s] 56%|██████████████████████████████████████████████████████▏                                         | 4214/7473 [00:03<00:01, 1807.76it/s] 59%|████████████████████████████████████████████████████████▌                                       | 4399/7473 [00:03<00:01, 1817.87it/s] 61%|██████████████████████████████████████████████████████████▊                                     | 4583/7473 [00:03<00:01, 1822.01it/s] 64%|█████████████████████████████████████████████████████████████▏                                  | 4767/7473 [00:03<00:01, 1826.95it/s] 66%|███████████████████████████████████████████████████████████████▌                                | 4951/7473 [00:03<00:01, 1830.43it/s] 69%|█████████████████████████████████████████████████████████████████▉                              | 5136/7473 [00:03<00:01, 1835.65it/s] 71%|████████████████████████████████████████████████████████████████████▎                           | 5320/7473 [00:03<00:01, 1802.07it/s] 74%|██████████████████████████████████████████████████████████████████████▋                         | 5501/7473 [00:03<00:01, 1514.90it/s] 76%|█████████████████████████████████████████████████████████████████████████                       | 5683/7473 [00:03<00:01, 1592.92it/s] 78%|███████████████████████████████████████████████████████████████████████████▎                    | 5866/7473 [00:04<00:00, 1656.44it/s] 81%|█████████████████████████████████████████████████████████████████████████████▋                  | 6047/7473 [00:04<00:00, 1698.60it/s] 83%|████████████████████████████████████████████████████████████████████████████████                | 6232/7473 [00:04<00:00, 1740.60it/s] 86%|██████████████████████████████████████████████████████████████████████████████████▍             | 6416/7473 [00:04<00:00, 1767.59it/s] 88%|████████████████████████████████████████████████████████████████████████████████████▊           | 6600/7473 [00:04<00:00, 1788.53it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████▏        | 6783/7473 [00:04<00:00, 1800.54it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████▍      | 6967/7473 [00:04<00:00, 1810.65it/s] 96%|███████████████████████████████████████████████████████████████████████████████████████████▊    | 7150/7473 [00:04<00:00, 1813.78it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████▏ | 7334/7473 [00:04<00:00, 1821.39it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████| 7473/7473 [00:04<00:00, 1530.64it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.22s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.26s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.42s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.18s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.01s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.12s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.14s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:11<00:05,  5.70s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.39s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.58s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.55s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.72s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.57s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.73s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.08s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.22s/it]
[2023-08-18 01:35:34,521] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
[2023-08-18 01:35:53,968] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-18 01:35:53,969] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-18 01:35:53,969] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-18 01:35:53,969] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-18 01:35:53,969] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-18 01:35:53,969] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-18 01:35:53,970] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-18 01:35:53,970] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-18 01:35:53,970] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-18 01:35:53,970] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-18 01:35:53,970] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-18 01:35:53,970] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7ff61ef10370>
[2023-08-18 01:35:53,970] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-18 01:35:53,970] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-18 01:35:53,970] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-18 01:35:53,970] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-18 01:35:53,970] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-18 01:35:53,970] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-18 01:35:53,970] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-18 01:35:53,970] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-18 01:35:53,970] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-18 01:35:53,970] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-18 01:35:53,970] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-18 01:35:53,970] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-18 01:35:53,970] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-18 01:35:53,970] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-18 01:35:53,970] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-18 01:35:53,970] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-18 01:35:53,970] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-18 01:35:53,970] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-18 01:35:53,970] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-18 01:35:53,970] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-18 01:35:53,970] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-18 01:35:53,970] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-18 01:35:53,970] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-18 01:35:53,970] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-18 01:35:53,970] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-18 01:35:53,970] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-18 01:35:53,970] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-18 01:35:53,971] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-18 01:35:53,971] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-18 01:35:53,971] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-18 01:35:53,971] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-18 01:35:53,971] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-18 01:35:53,971] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7ff61ef10190>
[2023-08-18 01:35:53,971] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-18 01:35:53,971] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-18 01:35:53,971] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-18 01:35:53,971] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-18 01:35:53,971] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-18 01:35:53,971] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-18 01:35:53,971] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-18 01:35:53,971] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-18 01:35:53,971] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-18 01:35:53,971] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-18 01:35:53,971] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-18 01:35:53,971] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-18 01:35:53,971] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-18 01:35:53,971] [INFO] [config.py:1012:print]   train_batch_size ............. 8
[2023-08-18 01:35:53,971] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  2
[2023-08-18 01:35:53,971] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-18 01:35:53,971] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-18 01:35:53,971] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-18 01:35:53,971] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-18 01:35:53,971] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-18 01:35:53,971] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-18 01:35:53,971] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-18 01:35:53,971] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.441631555557251 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating gsm8k :   0%|                                                                                           | 0/125 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following grade math question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Output: D: accomplishing

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Output: A: office

Input: Billy called out to John, and listened for what? Choices:  A: silence B: response C: communication D: hanging up E: whisper
Output: B: response

Input: The lizard frightened the hiker, it's movements made what rustle? Choices:  A: garden B: trees C: books D: rocks E: bushes
Output: E: bushes

Input:Natalia sold clips to 48 of her friends in April, and then she sold half as many clips in May. How many clips did Natalia sell altogether in April and May?
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o5-tcommonsenseqa-s1-rFalse
Loading extension module utils...
Time to load utils op: 0.40450620651245117 seconds
Loading extension module utils...
Time to load utils op: 0.40413522720336914 seconds
Loading extension module utils...
Time to load utils op: 0.4042532444000244 seconds
Evaluating gsm8k :   1%|▋                                                                                  | 1/125 [00:21<44:21, 21.46s/it]Evaluating gsm8k :   2%|█▎                                                                                 | 2/125 [00:24<21:51, 10.66s/it]Evaluating gsm8k :   2%|█▉                                                                                 | 3/125 [00:40<26:38, 13.10s/it]Evaluating gsm8k :   3%|██▋                                                                                | 4/125 [00:54<26:58, 13.38s/it]Evaluating gsm8k :   4%|███▎                                                                               | 5/125 [01:23<38:01, 19.01s/it]Evaluating gsm8k :   5%|███▉                                                                               | 6/125 [01:52<44:13, 22.30s/it]Evaluating gsm8k :   6%|████▋                                                                              | 7/125 [02:20<47:42, 24.26s/it]Evaluating gsm8k :   6%|█████▎                                                                             | 8/125 [02:48<49:46, 25.53s/it]Evaluating gsm8k :   7%|█████▉                                                                             | 9/125 [03:14<49:21, 25.53s/it]Evaluating gsm8k :   8%|██████▌                                                                           | 10/125 [03:23<39:20, 20.52s/it]Evaluating gsm8k :   9%|███████▏                                                                          | 11/125 [03:45<39:54, 21.01s/it]Evaluating gsm8k :  10%|███████▊                                                                          | 12/125 [03:48<29:24, 15.62s/it]Evaluating gsm8k :  10%|████████▌                                                                         | 13/125 [03:56<24:40, 13.22s/it]Evaluating gsm8k :  11%|█████████▏                                                                        | 14/125 [04:12<26:09, 14.14s/it]Evaluating gsm8k :  12%|█████████▊                                                                        | 15/125 [04:32<28:50, 15.73s/it]Evaluating gsm8k :  13%|██████████▍                                                                       | 16/125 [04:51<30:21, 16.71s/it]Evaluating gsm8k :  14%|███████████▏                                                                      | 17/125 [05:20<36:41, 20.38s/it]Evaluating gsm8k :  14%|███████████▊                                                                      | 18/125 [05:42<37:37, 21.10s/it]Evaluating gsm8k :  15%|████████████▍                                                                     | 19/125 [06:11<41:30, 23.50s/it]Evaluating gsm8k :  16%|█████████████                                                                     | 20/125 [06:40<43:52, 25.07s/it]Evaluating gsm8k :  17%|█████████████▊                                                                    | 21/125 [07:09<45:10, 26.06s/it]Evaluating gsm8k :  18%|██████████████▍                                                                   | 22/125 [07:37<46:06, 26.86s/it]Evaluating gsm8k :  18%|███████████████                                                                   | 23/125 [07:51<38:42, 22.77s/it]Evaluating gsm8k :  19%|███████████████▋                                                                  | 24/125 [08:19<41:10, 24.46s/it]Evaluating gsm8k :  20%|████████████████▍                                                                 | 25/125 [08:31<34:46, 20.87s/it]Evaluating gsm8k :  21%|█████████████████                                                                 | 26/125 [08:38<27:31, 16.68s/it]Evaluating gsm8k :  22%|█████████████████▋                                                                | 27/125 [08:55<27:22, 16.76s/it]Evaluating gsm8k :  22%|██████████████████▎                                                               | 28/125 [08:58<20:05, 12.43s/it]Evaluating gsm8k :  23%|███████████████████                                                               | 29/125 [09:10<19:57, 12.48s/it]Evaluating gsm8k :  24%|███████████████████▋                                                              | 30/125 [09:19<17:53, 11.30s/it]Evaluating gsm8k :  25%|████████████████████▎                                                             | 31/125 [09:31<18:11, 11.61s/it]Evaluating gsm8k :  26%|████████████████████▉                                                             | 32/125 [09:59<25:44, 16.61s/it]Evaluating gsm8k :  26%|█████████████████████▋                                                            | 33/125 [10:16<25:30, 16.64s/it]Evaluating gsm8k :  27%|██████████████████████▎                                                           | 34/125 [10:27<22:35, 14.90s/it]Evaluating gsm8k :  28%|██████████████████████▉                                                           | 35/125 [10:56<28:45, 19.17s/it]Evaluating gsm8k :  29%|███████████████████████▌                                                          | 36/125 [11:24<32:24, 21.85s/it]Evaluating gsm8k :  30%|████████████████████████▎                                                         | 37/125 [11:34<26:48, 18.27s/it]Evaluating gsm8k :  30%|████████████████████████▉                                                         | 38/125 [12:02<30:49, 21.25s/it]Evaluating gsm8k :  31%|█████████████████████████▌                                                        | 39/125 [12:19<28:22, 19.80s/it]Evaluating gsm8k :  32%|██████████████████████████▏                                                       | 40/125 [12:47<31:47, 22.44s/it]Evaluating gsm8k :  33%|██████████████████████████▉                                                       | 41/125 [13:16<34:15, 24.47s/it]Evaluating gsm8k :  34%|███████████████████████████▌                                                      | 42/125 [13:41<33:39, 24.34s/it]Evaluating gsm8k :  34%|████████████████████████████▏                                                     | 43/125 [14:09<35:05, 25.67s/it]Evaluating gsm8k :  35%|████████████████████████████▊                                                     | 44/125 [14:38<35:44, 26.47s/it]Evaluating gsm8k :  36%|█████████████████████████████▌                                                    | 45/125 [15:06<36:05, 27.07s/it]Evaluating gsm8k :  37%|██████████████████████████████▏                                                   | 46/125 [15:08<25:53, 19.66s/it]Evaluating gsm8k :  38%|██████████████████████████████▊                                                   | 47/125 [15:38<29:14, 22.49s/it]Evaluating gsm8k :  38%|███████████████████████████████▍                                                  | 48/125 [16:07<31:30, 24.55s/it]Evaluating gsm8k :  39%|████████████████████████████████▏                                                 | 49/125 [16:24<28:24, 22.43s/it]Evaluating gsm8k :  40%|████████████████████████████████▊                                                 | 50/125 [16:35<23:37, 18.90s/it]Evaluating gsm8k :  41%|█████████████████████████████████▍                                                | 51/125 [17:01<25:45, 20.88s/it]Evaluating gsm8k :  42%|██████████████████████████████████                                                | 52/125 [17:30<28:25, 23.37s/it]Evaluating gsm8k :  42%|██████████████████████████████████▊                                               | 53/125 [17:59<29:59, 25.00s/it]Evaluating gsm8k :  43%|███████████████████████████████████▍                                              | 54/125 [18:27<30:45, 25.99s/it]Evaluating gsm8k :  44%|████████████████████████████████████                                              | 55/125 [18:43<26:43, 22.90s/it]Evaluating gsm8k :  45%|████████████████████████████████████▋                                             | 56/125 [19:05<26:17, 22.86s/it]Evaluating gsm8k :  46%|█████████████████████████████████████▍                                            | 57/125 [19:30<26:31, 23.40s/it]Evaluating gsm8k :  46%|██████████████████████████████████████                                            | 58/125 [19:58<27:38, 24.75s/it]Evaluating gsm8k :  47%|██████████████████████████████████████▋                                           | 59/125 [20:17<25:15, 22.96s/it]Evaluating gsm8k :  48%|███████████████████████████████████████▎                                          | 60/125 [20:45<26:32, 24.51s/it]Evaluating gsm8k :  49%|████████████████████████████████████████                                          | 61/125 [20:52<20:28, 19.20s/it]Evaluating gsm8k :  50%|████████████████████████████████████████▋                                         | 62/125 [21:16<21:39, 20.62s/it]Evaluating gsm8k :  50%|█████████████████████████████████████████▎                                        | 63/125 [21:44<23:41, 22.92s/it]Evaluating gsm8k :  51%|█████████████████████████████████████████▉                                        | 64/125 [21:52<18:48, 18.50s/it]Evaluating gsm8k :  52%|██████████████████████████████████████████▋                                       | 65/125 [22:07<17:26, 17.43s/it]Evaluating gsm8k :  53%|███████████████████████████████████████████▎                                      | 66/125 [22:23<16:35, 16.87s/it]Evaluating gsm8k :  54%|███████████████████████████████████████████▉                                      | 67/125 [22:35<15:08, 15.66s/it]Evaluating gsm8k :  54%|████████████████████████████████████████████▌                                     | 68/125 [22:49<14:22, 15.13s/it]Evaluating gsm8k :  55%|█████████████████████████████████████████████▎                                    | 69/125 [23:13<16:36, 17.80s/it]Evaluating gsm8k :  56%|█████████████████████████████████████████████▉                                    | 70/125 [23:19<13:05, 14.28s/it]Evaluating gsm8k :  57%|██████████████████████████████████████████████▌                                   | 71/125 [23:48<16:45, 18.63s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▏                                  | 72/125 [24:17<19:13, 21.76s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▉                                  | 73/125 [24:46<20:47, 24.00s/it]Evaluating gsm8k :  59%|████████████████████████████████████████████████▌                                 | 74/125 [25:06<19:13, 22.62s/it]Evaluating gsm8k :  60%|█████████████████████████████████████████████████▏                                | 75/125 [25:35<20:30, 24.61s/it]Evaluating gsm8k :  61%|█████████████████████████████████████████████████▊                                | 76/125 [25:40<15:17, 18.73s/it]Evaluating gsm8k :  62%|██████████████████████████████████████████████████▌                               | 77/125 [26:09<17:25, 21.79s/it]Evaluating gsm8k :  62%|███████████████████████████████████████████████████▏                              | 78/125 [26:15<13:21, 17.06s/it]Evaluating gsm8k :  63%|███████████████████████████████████████████████████▊                              | 79/125 [26:35<13:48, 18.01s/it]Evaluating gsm8k :  64%|████████████████████████████████████████████████████▍                             | 80/125 [26:58<14:35, 19.46s/it]Evaluating gsm8k :  65%|█████████████████████████████████████████████████████▏                            | 81/125 [27:25<15:56, 21.73s/it]Evaluating gsm8k :  66%|█████████████████████████████████████████████████████▊                            | 82/125 [27:53<16:58, 23.68s/it]Evaluating gsm8k :  66%|██████████████████████████████████████████████████████▍                           | 83/125 [28:18<16:44, 23.93s/it]Evaluating gsm8k :  67%|███████████████████████████████████████████████████████                           | 84/125 [28:40<16:04, 23.53s/it]Evaluating gsm8k :  68%|███████████████████████████████████████████████████████▊                          | 85/125 [28:57<14:15, 21.39s/it]Evaluating gsm8k :  69%|████████████████████████████████████████████████████████▍                         | 86/125 [29:25<15:16, 23.50s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████                         | 87/125 [29:34<12:08, 19.17s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████▋                        | 88/125 [30:03<13:33, 22.00s/it]Evaluating gsm8k :  71%|██████████████████████████████████████████████████████████▍                       | 89/125 [30:14<11:16, 18.80s/it]Evaluating gsm8k :  72%|███████████████████████████████████████████████████████████                       | 90/125 [30:21<08:52, 15.22s/it]Evaluating gsm8k :  73%|███████████████████████████████████████████████████████████▋                      | 91/125 [30:50<10:54, 19.25s/it]Evaluating gsm8k :  74%|████████████████████████████████████████████████████████████▎                     | 92/125 [30:58<08:49, 16.04s/it]Evaluating gsm8k :  74%|█████████████████████████████████████████████████████████████                     | 93/125 [31:12<08:06, 15.22s/it]Evaluating gsm8k :  75%|█████████████████████████████████████████████████████████████▋                    | 94/125 [31:41<10:00, 19.36s/it]Evaluating gsm8k :  76%|██████████████████████████████████████████████████████████████▎                   | 95/125 [32:10<11:09, 22.32s/it]Evaluating gsm8k :  77%|██████████████████████████████████████████████████████████████▉                   | 96/125 [32:31<10:33, 21.86s/it]Evaluating gsm8k :  78%|███████████████████████████████████████████████████████████████▋                  | 97/125 [32:59<11:06, 23.81s/it]Evaluating gsm8k :  78%|████████████████████████████████████████████████████████████████▎                 | 98/125 [33:01<07:47, 17.32s/it]Evaluating gsm8k :  79%|████████████████████████████████████████████████████████████████▉                 | 99/125 [33:30<08:55, 20.61s/it]Evaluating gsm8k :  80%|████████████████████████████████████████████████████████████████▊                | 100/125 [33:59<09:39, 23.16s/it]Evaluating gsm8k :  81%|█████████████████████████████████████████████████████████████████▍               | 101/125 [34:27<09:52, 24.68s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████               | 102/125 [34:56<09:57, 25.99s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████▋              | 103/125 [35:25<09:51, 26.89s/it]Evaluating gsm8k :  83%|███████████████████████████████████████████████████████████████████▍             | 104/125 [35:31<07:15, 20.76s/it]Evaluating gsm8k :  84%|████████████████████████████████████████████████████████████████████             | 105/125 [35:51<06:46, 20.32s/it]Evaluating gsm8k :  85%|████████████████████████████████████████████████████████████████████▋            | 106/125 [36:06<06:00, 18.97s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▎           | 107/125 [36:36<06:37, 22.09s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▉           | 108/125 [37:05<06:51, 24.20s/it]Evaluating gsm8k :  87%|██████████████████████████████████████████████████████████████████████▋          | 109/125 [37:20<05:41, 21.37s/it]Evaluating gsm8k :  88%|███████████████████████████████████████████████████████████████████████▎         | 110/125 [37:28<04:21, 17.41s/it]Evaluating gsm8k :  89%|███████████████████████████████████████████████████████████████████████▉         | 111/125 [37:57<04:50, 20.78s/it]Evaluating gsm8k :  90%|████████████████████████████████████████████████████████████████████████▌        | 112/125 [37:59<03:18, 15.24s/it]Evaluating gsm8k :  90%|█████████████████████████████████████████████████████████████████████████▏       | 113/125 [38:27<03:49, 19.11s/it]Evaluating gsm8k :  91%|█████████████████████████████████████████████████████████████████████████▊       | 114/125 [38:50<03:41, 20.15s/it]Evaluating gsm8k :  92%|██████████████████████████████████████████████████████████████████████████▌      | 115/125 [39:06<03:09, 18.94s/it]Evaluating gsm8k :  93%|███████████████████████████████████████████████████████████████████████████▏     | 116/125 [39:26<02:54, 19.36s/it]Evaluating gsm8k :  94%|███████████████████████████████████████████████████████████████████████████▊     | 117/125 [39:54<02:56, 22.05s/it]Evaluating gsm8k :  94%|████████████████████████████████████████████████████████████████████████████▍    | 118/125 [39:59<01:58, 16.90s/it]Evaluating gsm8k :  95%|█████████████████████████████████████████████████████████████████████████████    | 119/125 [40:20<01:48, 18.08s/it]Evaluating gsm8k :  96%|█████████████████████████████████████████████████████████████████████████████▊   | 120/125 [40:48<01:45, 21.06s/it]Evaluating gsm8k :  97%|██████████████████████████████████████████████████████████████████████████████▍  | 121/125 [41:17<01:33, 23.45s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████  | 122/125 [41:46<01:15, 25.08s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████▋ | 123/125 [42:14<00:52, 26.07s/it]Evaluating gsm8k :  99%|████████████████████████████████████████████████████████████████████████████████▎| 124/125 [42:30<00:23, 23.03s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [42:59<00:00, 24.81s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [42:59<00:00, 20.64s/it]
name: gsm8k | {'exact_match': 0.0, 'rougeL': 0.6399} | lm_loss 9.7412 | avg. gen lenth: 248.808
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name gsm8k --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name commonsenseqa --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 2 --data-dir /scratch/ylu130/processed_data/gsm8k/out-domain/o6-tcommonsenseqa-s1-rFalse --seed 1 --max-prompt-length 2048 --num-out-domain 6
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date![nltk_data]   Package punkt is already up-to-date!

[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-18 02:19:00,833] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... gsm8k
  data_dir ..................... /scratch/ylu130/processed_data/gsm8k/out-domain/o6-tcommonsenseqa-s1-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 6
  out_domain_data_name ......... commonsenseqa
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o6-tcommonsenseqa-s1-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 2
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                                             | 0/7473 [00:00<?, ?it/s]  1%|█▎                                                                                               | 102/7473 [00:00<00:07, 1012.08it/s]  3%|██▋                                                                                              | 206/7473 [00:00<00:07, 1026.81it/s]  4%|████                                                                                             | 309/7473 [00:00<00:06, 1028.05it/s]  6%|█████▎                                                                                           | 412/7473 [00:00<00:06, 1027.55it/s]  7%|██████▋                                                                                          | 515/7473 [00:00<00:06, 1026.85it/s]  8%|████████                                                                                         | 619/7473 [00:00<00:06, 1028.59it/s] 10%|█████████▍                                                                                       | 724/7473 [00:00<00:06, 1035.19it/s] 11%|██████████▋                                                                                      | 828/7473 [00:00<00:06, 1035.19it/s] 12%|████████████                                                                                     | 932/7473 [00:00<00:06, 1009.10it/s] 14%|█████████████▎                                                                                  | 1037/7473 [00:01<00:06, 1019.02it/s] 15%|██████████████▋                                                                                 | 1142/7473 [00:01<00:06, 1025.41it/s] 17%|███████████████▉                                                                                | 1245/7473 [00:01<00:06, 1023.91it/s] 18%|█████████████████▎                                                                              | 1349/7473 [00:01<00:05, 1028.40it/s] 19%|██████████████████▋                                                                             | 1452/7473 [00:01<00:05, 1026.06it/s] 21%|███████████████████▉                                                                            | 1556/7473 [00:01<00:05, 1030.16it/s] 22%|█████████████████████▎                                                                          | 1660/7473 [00:01<00:05, 1026.39it/s] 24%|██████████████████████▋                                                                         | 1765/7473 [00:01<00:05, 1030.08it/s] 25%|████████████████████████                                                                        | 1869/7473 [00:01<00:05, 1027.46it/s] 26%|█████████████████████████▎                                                                      | 1972/7473 [00:01<00:05, 1022.00it/s] 28%|██████████████████████████▋                                                                     | 2075/7473 [00:02<00:05, 1022.92it/s] 29%|███████████████████████████▉                                                                    | 2179/7473 [00:02<00:05, 1025.79it/s] 31%|█████████████████████████████▎                                                                  | 2283/7473 [00:02<00:05, 1027.09it/s] 32%|██████████████████████████████▋                                                                 | 2387/7473 [00:02<00:04, 1029.77it/s] 34%|████████████████████████████████▌                                                               | 2530/7473 [00:02<00:04, 1148.91it/s] 36%|██████████████████████████████████▌                                                             | 2689/7473 [00:02<00:03, 1279.48it/s] 38%|████████████████████████████████████▌                                                           | 2846/7473 [00:02<00:03, 1365.20it/s] 40%|██████████████████████████████████████▌                                                         | 3005/7473 [00:02<00:03, 1429.61it/s] 42%|████████████████████████████████████████▌                                                       | 3161/7473 [00:02<00:02, 1466.80it/s] 44%|██████████████████████████████████████████▌                                                     | 3318/7473 [00:02<00:02, 1496.96it/s] 46%|████████████████████████████████████████████▌                                                   | 3469/7473 [00:03<00:02, 1499.85it/s] 49%|██████████████████████████████████████████████▌                                                 | 3626/7473 [00:03<00:02, 1519.43it/s] 51%|████████████████████████████████████████████████▌                                               | 3778/7473 [00:03<00:02, 1511.35it/s] 53%|██████████████████████████████████████████████████▌                                             | 3933/7473 [00:03<00:02, 1521.04it/s] 55%|████████████████████████████████████████████████████▌                                           | 4091/7473 [00:03<00:02, 1538.20it/s] 57%|██████████████████████████████████████████████████████▌                                         | 4245/7473 [00:03<00:02, 1538.62it/s] 59%|████████████████████████████████████████████████████████▌                                       | 4400/7473 [00:03<00:01, 1541.13it/s] 61%|██████████████████████████████████████████████████████████▌                                     | 4556/7473 [00:03<00:01, 1546.20it/s] 63%|████████████████████████████████████████████████████████████▌                                   | 4711/7473 [00:03<00:01, 1546.86it/s] 65%|██████████████████████████████████████████████████████████████▌                                 | 4867/7473 [00:03<00:01, 1550.37it/s] 67%|████████████████████████████████████████████████████████████████▌                               | 5024/7473 [00:04<00:01, 1554.30it/s] 69%|██████████████████████████████████████████████████████████████████▌                             | 5182/7473 [00:04<00:01, 1560.57it/s] 71%|████████████████████████████████████████████████████████████████████▌                           | 5339/7473 [00:04<00:01, 1521.05it/s] 73%|██████████████████████████████████████████████████████████████████████▌                         | 5492/7473 [00:04<00:01, 1158.36it/s] 75%|████████████████████████████████████████████████████████████████████████▍                       | 5641/7473 [00:04<00:01, 1237.75it/s] 78%|██████████████████████████████████████████████████████████████████████████▍                     | 5797/7473 [00:04<00:01, 1319.67it/s] 80%|████████████████████████████████████████████████████████████████████████████▍                   | 5951/7473 [00:04<00:01, 1378.15it/s] 82%|██████████████████████████████████████████████████████████████████████████████▍                 | 6108/7473 [00:04<00:00, 1430.74it/s] 84%|████████████████████████████████████████████████████████████████████████████████▍               | 6265/7473 [00:04<00:00, 1468.03it/s] 86%|██████████████████████████████████████████████████████████████████████████████████▍             | 6421/7473 [00:05<00:00, 1492.40it/s] 88%|████████████████████████████████████████████████████████████████████████████████████▌           | 6578/7473 [00:05<00:00, 1513.08it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████▌         | 6734/7473 [00:05<00:00, 1524.81it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████▍       | 6888/7473 [00:05<00:00, 1528.59it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████▍     | 7044/7473 [00:05<00:00, 1535.81it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████▍   | 7199/7473 [00:05<00:00, 1539.92it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████▍ | 7355/7473 [00:05<00:00, 1544.64it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████| 7473/7473 [00:05<00:00, 1304.73it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.20s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.24s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.11s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.35s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.06s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.05s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.15s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.30s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.47s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.64s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.40s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.58s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.54s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.72s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.76s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.91s/it]
[2023-08-18 02:19:58,704] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
[2023-08-18 02:20:05,802] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-18 02:20:05,803] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-18 02:20:05,803] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-18 02:20:05,804] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-18 02:20:05,804] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-18 02:20:05,804] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-18 02:20:05,804] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-18 02:20:05,804] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-18 02:20:05,804] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-18 02:20:05,804] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-18 02:20:05,804] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-18 02:20:05,804] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f7521083370>
[2023-08-18 02:20:05,804] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-18 02:20:05,804] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-18 02:20:05,804] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-18 02:20:05,804] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-18 02:20:05,804] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-18 02:20:05,804] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-18 02:20:05,804] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-18 02:20:05,804] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-18 02:20:05,804] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-18 02:20:05,804] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-18 02:20:05,804] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-18 02:20:05,804] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-18 02:20:05,804] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-18 02:20:05,804] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-18 02:20:05,804] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-18 02:20:05,804] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-18 02:20:05,804] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-18 02:20:05,804] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-18 02:20:05,804] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-18 02:20:05,804] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-18 02:20:05,804] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-18 02:20:05,804] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-18 02:20:05,804] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-18 02:20:05,804] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-18 02:20:05,804] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-18 02:20:05,804] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-18 02:20:05,804] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-18 02:20:05,805] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-18 02:20:05,805] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-18 02:20:05,805] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-18 02:20:05,805] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-18 02:20:05,805] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-18 02:20:05,805] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f7521083250>
[2023-08-18 02:20:05,805] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-18 02:20:05,805] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-18 02:20:05,805] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-18 02:20:05,805] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-18 02:20:05,805] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-18 02:20:05,805] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-18 02:20:05,805] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-18 02:20:05,805] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-18 02:20:05,805] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-18 02:20:05,805] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-18 02:20:05,805] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-18 02:20:05,805] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-18 02:20:05,805] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-18 02:20:05,805] [INFO] [config.py:1012:print]   train_batch_size ............. 8
[2023-08-18 02:20:05,805] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  2
[2023-08-18 02:20:05,805] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-18 02:20:05,805] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-18 02:20:05,805] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-18 02:20:05,805] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-18 02:20:05,805] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-18 02:20:05,805] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-18 02:20:05,805] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-18 02:20:05,805] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.39185643196105957 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Time to load utils op: 0.3065316677093506 seconds
Evaluating gsm8k :   0%|                                                                                           | 0/125 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following grade math question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Output: D: accomplishing

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Output: A: office

Input: Billy called out to John, and listened for what? Choices:  A: silence B: response C: communication D: hanging up E: whisper
Output: B: response

Input: The lizard frightened the hiker, it's movements made what rustle? Choices:  A: garden B: trees C: books D: rocks E: bushes
Output: E: bushes

Input: The man spent big money and time maintaining his lawn, it was part of keeping up with the Joneses where? Choices:  A: front yard B: suburbia C: neighborhood D: back yard E: golf course
Output: B: suburbia

Input:Natalia sold clips to 48 of her friends in April, and then she sold half as many clips in May. How many clips did Natalia sell altogether in April and May?
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o6-tcommonsenseqa-s1-rFalse
Loading extension module utils...
Time to load utils op: 0.3043067455291748 seconds
Loading extension module utils...
Time to load utils op: 0.40435194969177246 seconds
Evaluating gsm8k :   1%|▋                                                                                  | 1/125 [00:16<35:05, 16.98s/it]Evaluating gsm8k :   2%|█▎                                                                                 | 2/125 [00:28<27:40, 13.50s/it]Evaluating gsm8k :   2%|█▉                                                                                 | 3/125 [00:56<41:31, 20.42s/it]Evaluating gsm8k :   3%|██▋                                                                                | 4/125 [01:24<47:15, 23.43s/it]Evaluating gsm8k :   4%|███▎                                                                               | 5/125 [01:37<39:21, 19.68s/it]Evaluating gsm8k :   5%|███▉                                                                               | 6/125 [01:55<37:35, 18.96s/it]Evaluating gsm8k :   6%|████▋                                                                              | 7/125 [02:05<31:53, 16.22s/it]Evaluating gsm8k :   6%|█████▎                                                                             | 8/125 [02:33<38:48, 19.90s/it]Evaluating gsm8k :   7%|█████▉                                                                             | 9/125 [03:01<43:16, 22.39s/it]Evaluating gsm8k :   8%|██████▌                                                                           | 10/125 [03:11<35:29, 18.52s/it]Evaluating gsm8k :   9%|███████▏                                                                          | 11/125 [03:22<30:36, 16.11s/it]Evaluating gsm8k :  10%|███████▊                                                                          | 12/125 [03:39<30:51, 16.38s/it]Evaluating gsm8k :  10%|████████▌                                                                         | 13/125 [03:47<26:10, 14.02s/it]Evaluating gsm8k :  11%|█████████▏                                                                        | 14/125 [03:54<21:56, 11.86s/it]Evaluating gsm8k :  12%|█████████▊                                                                        | 15/125 [04:22<30:40, 16.73s/it]Evaluating gsm8k :  13%|██████████▍                                                                       | 16/125 [04:28<24:42, 13.60s/it]Evaluating gsm8k :  14%|███████████▏                                                                      | 17/125 [04:56<32:13, 17.90s/it]Evaluating gsm8k :  14%|███████████▊                                                                      | 18/125 [05:25<37:37, 21.10s/it]Evaluating gsm8k :  15%|████████████▍                                                                     | 19/125 [05:53<41:15, 23.35s/it]Evaluating gsm8k :  16%|█████████████                                                                     | 20/125 [06:02<33:03, 18.89s/it]Evaluating gsm8k :  17%|█████████████▊                                                                    | 21/125 [06:22<33:12, 19.16s/it]Evaluating gsm8k :  18%|██████████████▍                                                                   | 22/125 [06:29<26:57, 15.70s/it]Evaluating gsm8k :  18%|███████████████                                                                   | 23/125 [06:32<19:55, 11.72s/it]Evaluating gsm8k :  19%|███████████████▋                                                                  | 24/125 [07:00<27:50, 16.54s/it]Evaluating gsm8k :  20%|████████████████▍                                                                 | 25/125 [07:23<31:11, 18.71s/it]Evaluating gsm8k :  21%|█████████████████                                                                 | 26/125 [07:38<28:49, 17.47s/it]Evaluating gsm8k :  22%|█████████████████▋                                                                | 27/125 [07:54<27:47, 17.01s/it]Evaluating gsm8k :  22%|██████████████████▎                                                               | 28/125 [07:58<21:25, 13.25s/it]Evaluating gsm8k :  23%|███████████████████                                                               | 29/125 [08:27<28:22, 17.74s/it]Evaluating gsm8k :  24%|███████████████████▋                                                              | 30/125 [08:54<32:45, 20.69s/it]Evaluating gsm8k :  25%|████████████████████▎                                                             | 31/125 [09:12<31:16, 19.96s/it]Evaluating gsm8k :  26%|████████████████████▉                                                             | 32/125 [09:40<34:34, 22.30s/it]Evaluating gsm8k :  26%|█████████████████████▋                                                            | 33/125 [10:09<37:04, 24.17s/it]Evaluating gsm8k :  27%|██████████████████████▎                                                           | 34/125 [10:37<38:34, 25.43s/it]Evaluating gsm8k :  28%|██████████████████████▉                                                           | 35/125 [11:05<39:18, 26.20s/it]Evaluating gsm8k :  29%|███████████████████████▌                                                          | 36/125 [11:33<39:43, 26.78s/it]Evaluating gsm8k :  30%|████████████████████████▎                                                         | 37/125 [12:01<39:40, 27.05s/it]Evaluating gsm8k :  30%|████████████████████████▉                                                         | 38/125 [12:15<33:43, 23.25s/it]Evaluating gsm8k :  31%|█████████████████████████▌                                                        | 39/125 [12:37<32:30, 22.68s/it]Evaluating gsm8k :  32%|██████████████████████████▏                                                       | 40/125 [12:47<27:08, 19.15s/it]Evaluating gsm8k :  33%|██████████████████████████▉                                                       | 41/125 [13:15<30:26, 21.75s/it]Evaluating gsm8k :  34%|███████████████████████████▌                                                      | 42/125 [13:34<28:58, 20.95s/it]Evaluating gsm8k :  34%|████████████████████████████▏                                                     | 43/125 [14:03<31:39, 23.16s/it]Evaluating gsm8k :  35%|████████████████████████████▊                                                     | 44/125 [14:31<33:28, 24.80s/it]Evaluating gsm8k :  36%|█████████████████████████████▌                                                    | 45/125 [14:34<24:04, 18.06s/it]Evaluating gsm8k :  37%|██████████████████████████████▏                                                   | 46/125 [14:55<25:02, 19.02s/it]Evaluating gsm8k :  38%|██████████████████████████████▊                                                   | 47/125 [15:12<23:53, 18.38s/it]Evaluating gsm8k :  38%|███████████████████████████████▍                                                  | 48/125 [15:40<27:28, 21.41s/it]Evaluating gsm8k :  39%|████████████████████████████████▏                                                 | 49/125 [16:08<29:32, 23.32s/it]Evaluating gsm8k :  40%|████████████████████████████████▊                                                 | 50/125 [16:37<31:10, 24.94s/it]Evaluating gsm8k :  41%|█████████████████████████████████▍                                                | 51/125 [17:05<31:59, 25.93s/it]Evaluating gsm8k :  42%|██████████████████████████████████                                                | 52/125 [17:19<27:11, 22.35s/it]Evaluating gsm8k :  42%|██████████████████████████████████▊                                               | 53/125 [17:34<24:11, 20.15s/it]Evaluating gsm8k :  43%|███████████████████████████████████▍                                              | 54/125 [17:56<24:33, 20.75s/it]Evaluating gsm8k :  44%|████████████████████████████████████                                              | 55/125 [18:02<19:05, 16.36s/it]Evaluating gsm8k :  45%|████████████████████████████████████▋                                             | 56/125 [18:24<20:29, 17.82s/it]Evaluating gsm8k :  46%|█████████████████████████████████████▍                                            | 57/125 [18:43<20:40, 18.25s/it]Evaluating gsm8k :  46%|██████████████████████████████████████                                            | 58/125 [18:45<15:03, 13.49s/it]Evaluating gsm8k :  47%|██████████████████████████████████████▋                                           | 59/125 [18:51<12:26, 11.31s/it]Evaluating gsm8k :  48%|███████████████████████████████████████▎                                          | 60/125 [19:17<16:51, 15.55s/it]Evaluating gsm8k :  49%|████████████████████████████████████████                                          | 61/125 [19:28<15:20, 14.38s/it]Evaluating gsm8k :  50%|████████████████████████████████████████▋                                         | 62/125 [19:33<12:08, 11.56s/it]Evaluating gsm8k :  50%|█████████████████████████████████████████▎                                        | 63/125 [20:01<17:02, 16.49s/it]Evaluating gsm8k :  51%|█████████████████████████████████████████▉                                        | 64/125 [20:07<13:20, 13.13s/it]Evaluating gsm8k :  52%|██████████████████████████████████████████▋                                       | 65/125 [20:32<16:48, 16.80s/it]Evaluating gsm8k :  53%|███████████████████████████████████████████▎                                      | 66/125 [20:38<13:22, 13.60s/it]Evaluating gsm8k :  54%|███████████████████████████████████████████▉                                      | 67/125 [21:06<17:10, 17.77s/it]Evaluating gsm8k :  54%|████████████████████████████████████████████▌                                     | 68/125 [21:14<14:14, 14.99s/it]Evaluating gsm8k :  55%|█████████████████████████████████████████████▎                                    | 69/125 [21:42<17:35, 18.84s/it]Evaluating gsm8k :  56%|█████████████████████████████████████████████▉                                    | 70/125 [22:10<19:46, 21.58s/it]Evaluating gsm8k :  57%|██████████████████████████████████████████████▌                                   | 71/125 [22:27<18:13, 20.26s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▏                                  | 72/125 [22:32<13:41, 15.49s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▉                                  | 73/125 [23:00<16:46, 19.36s/it]Evaluating gsm8k :  59%|████████████████████████████████████████████████▌                                 | 74/125 [23:28<18:37, 21.91s/it]Evaluating gsm8k :  60%|█████████████████████████████████████████████████▏                                | 75/125 [23:49<18:01, 21.63s/it]Evaluating gsm8k :  61%|█████████████████████████████████████████████████▊                                | 76/125 [24:17<19:18, 23.65s/it]Evaluating gsm8k :  62%|██████████████████████████████████████████████████▌                               | 77/125 [24:37<17:53, 22.36s/it]Evaluating gsm8k :  62%|███████████████████████████████████████████████████▏                              | 78/125 [25:04<18:46, 23.98s/it]Evaluating gsm8k :  63%|███████████████████████████████████████████████████▊                              | 79/125 [25:26<17:56, 23.41s/it]Evaluating gsm8k :  64%|████████████████████████████████████████████████████▍                             | 80/125 [25:54<18:26, 24.59s/it]Evaluating gsm8k :  65%|█████████████████████████████████████████████████████▏                            | 81/125 [26:08<15:42, 21.42s/it]Evaluating gsm8k :  66%|█████████████████████████████████████████████████████▊                            | 82/125 [26:29<15:22, 21.46s/it]Evaluating gsm8k :  66%|██████████████████████████████████████████████████████▍                           | 83/125 [26:48<14:23, 20.57s/it]Evaluating gsm8k :  67%|███████████████████████████████████████████████████████                           | 84/125 [27:16<15:31, 22.73s/it]Evaluating gsm8k :  68%|███████████████████████████████████████████████████████▊                          | 85/125 [27:34<14:12, 21.31s/it]Evaluating gsm8k :  69%|████████████████████████████████████████████████████████▍                         | 86/125 [28:02<15:15, 23.48s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████                         | 87/125 [28:31<15:50, 25.02s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████▋                        | 88/125 [28:59<16:04, 26.06s/it]Evaluating gsm8k :  71%|██████████████████████████████████████████████████████████▍                       | 89/125 [29:18<14:23, 23.97s/it]Evaluating gsm8k :  72%|███████████████████████████████████████████████████████████                       | 90/125 [29:29<11:41, 20.05s/it]Evaluating gsm8k :  73%|███████████████████████████████████████████████████████████▋                      | 91/125 [29:52<11:46, 20.78s/it]Evaluating gsm8k :  74%|████████████████████████████████████████████████████████████▎                     | 92/125 [30:20<12:39, 23.02s/it]Evaluating gsm8k :  74%|█████████████████████████████████████████████████████████████                     | 93/125 [30:48<13:07, 24.61s/it]Evaluating gsm8k :  75%|█████████████████████████████████████████████████████████████▋                    | 94/125 [31:01<10:52, 21.03s/it]Evaluating gsm8k :  76%|██████████████████████████████████████████████████████████████▎                   | 95/125 [31:05<08:00, 16.01s/it]Evaluating gsm8k :  77%|██████████████████████████████████████████████████████████████▉                   | 96/125 [31:31<09:06, 18.85s/it]Evaluating gsm8k :  78%|███████████████████████████████████████████████████████████████▋                  | 97/125 [31:33<06:29, 13.91s/it]Evaluating gsm8k :  78%|████████████████████████████████████████████████████████████████▎                 | 98/125 [31:57<07:35, 16.88s/it]Evaluating gsm8k :  79%|████████████████████████████████████████████████████████████████▉                 | 99/125 [32:25<08:43, 20.14s/it]Evaluating gsm8k :  80%|████████████████████████████████████████████████████████████████▊                | 100/125 [32:33<06:55, 16.62s/it]Evaluating gsm8k :  81%|█████████████████████████████████████████████████████████████████▍               | 101/125 [32:51<06:49, 17.05s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████               | 102/125 [33:02<05:51, 15.29s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████▋              | 103/125 [33:29<06:49, 18.64s/it]Evaluating gsm8k :  83%|███████████████████████████████████████████████████████████████████▍             | 104/125 [33:45<06:16, 17.91s/it]Evaluating gsm8k :  84%|████████████████████████████████████████████████████████████████████             | 105/125 [34:13<06:59, 20.96s/it]Evaluating gsm8k :  85%|████████████████████████████████████████████████████████████████████▋            | 106/125 [34:35<06:44, 21.29s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▎           | 107/125 [35:04<07:04, 23.57s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▉           | 108/125 [35:33<07:07, 25.13s/it]Evaluating gsm8k :  87%|██████████████████████████████████████████████████████████████████████▋          | 109/125 [36:01<06:58, 26.15s/it]Evaluating gsm8k :  88%|███████████████████████████████████████████████████████████████████████▎         | 110/125 [36:23<06:12, 24.86s/it]Evaluating gsm8k :  89%|███████████████████████████████████████████████████████████████████████▉         | 111/125 [36:37<05:00, 21.44s/it]Evaluating gsm8k :  90%|████████████████████████████████████████████████████████████████████████▌        | 112/125 [36:51<04:11, 19.34s/it]Evaluating gsm8k :  90%|█████████████████████████████████████████████████████████████████████████▏       | 113/125 [36:59<03:10, 15.87s/it]Evaluating gsm8k :  91%|█████████████████████████████████████████████████████████████████████████▊       | 114/125 [37:27<03:36, 19.67s/it]Evaluating gsm8k :  92%|██████████████████████████████████████████████████████████████████████████▌      | 115/125 [37:55<03:41, 22.19s/it]Evaluating gsm8k :  93%|███████████████████████████████████████████████████████████████████████████▏     | 116/125 [38:10<02:58, 19.85s/it]Evaluating gsm8k :  94%|███████████████████████████████████████████████████████████████████████████▊     | 117/125 [38:16<02:06, 15.76s/it]Evaluating gsm8k :  94%|████████████████████████████████████████████████████████████████████████████▍    | 118/125 [38:36<01:59, 17.06s/it]Evaluating gsm8k :  95%|█████████████████████████████████████████████████████████████████████████████    | 119/125 [38:54<01:44, 17.39s/it]Evaluating gsm8k :  96%|█████████████████████████████████████████████████████████████████████████████▊   | 120/125 [39:23<01:44, 20.80s/it]Evaluating gsm8k :  97%|██████████████████████████████████████████████████████████████████████████████▍  | 121/125 [39:31<01:07, 16.88s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████  | 122/125 [39:59<01:00, 20.27s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████▋ | 123/125 [40:06<00:32, 16.19s/it]Evaluating gsm8k :  99%|████████████████████████████████████████████████████████████████████████████████▎| 124/125 [40:30<00:18, 18.54s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [40:42<00:00, 16.56s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [40:42<00:00, 19.54s/it]
name: gsm8k | {'exact_match': 0.8, 'rougeL': 1.1034} | lm_loss 9.7837 | avg. gen lenth: 241.716
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name gsm8k --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name commonsenseqa --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 2 --data-dir /scratch/ylu130/processed_data/gsm8k/out-domain/o7-tcommonsenseqa-s1-rFalse --seed 1 --max-prompt-length 2048 --num-out-domain 7
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-18 03:03:34,966] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... gsm8k
  data_dir ..................... /scratch/ylu130/processed_data/gsm8k/out-domain/o7-tcommonsenseqa-s1-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 7
  out_domain_data_name ......... commonsenseqa
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o7-tcommonsenseqa-s1-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 2
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                                             | 0/7473 [00:00<?, ?it/s]  1%|█▏                                                                                                 | 90/7473 [00:00<00:08, 890.47it/s]  2%|██▎                                                                                               | 180/7473 [00:00<00:08, 895.74it/s]  4%|███▌                                                                                              | 271/7473 [00:00<00:08, 897.34it/s]  5%|████▋                                                                                             | 362/7473 [00:00<00:07, 900.43it/s]  6%|█████▉                                                                                            | 453/7473 [00:00<00:07, 899.69it/s]  7%|███████▏                                                                                          | 544/7473 [00:00<00:07, 899.78it/s]  8%|████████▎                                                                                         | 634/7473 [00:00<00:07, 899.31it/s] 10%|█████████▌                                                                                        | 726/7473 [00:00<00:07, 903.18it/s] 11%|██████████▋                                                                                       | 817/7473 [00:00<00:07, 887.80it/s] 12%|███████████▉                                                                                      | 908/7473 [00:01<00:07, 892.47it/s] 13%|█████████████                                                                                     | 999/7473 [00:01<00:07, 895.32it/s] 15%|██████████████▏                                                                                  | 1091/7473 [00:01<00:07, 901.54it/s] 16%|███████████████▎                                                                                 | 1182/7473 [00:01<00:06, 899.75it/s] 17%|████████████████▌                                                                                | 1272/7473 [00:01<00:06, 899.21it/s] 18%|█████████████████▋                                                                               | 1364/7473 [00:01<00:06, 902.79it/s] 19%|██████████████████▉                                                                              | 1455/7473 [00:01<00:06, 897.13it/s] 21%|████████████████████                                                                             | 1547/7473 [00:01<00:06, 900.84it/s] 22%|█████████████████████▎                                                                           | 1638/7473 [00:01<00:06, 899.66it/s] 23%|██████████████████████▍                                                                          | 1728/7473 [00:01<00:06, 898.80it/s] 24%|███████████████████████▌                                                                         | 1818/7473 [00:02<00:06, 898.76it/s] 26%|████████████████████████▊                                                                        | 1908/7473 [00:02<00:06, 893.53it/s] 27%|█████████████████████████▉                                                                       | 1999/7473 [00:02<00:06, 896.34it/s] 28%|███████████████████████████                                                                      | 2089/7473 [00:02<00:06, 896.00it/s] 29%|████████████████████████████▍                                                                    | 2187/7473 [00:02<00:05, 918.83it/s] 31%|█████████████████████████████▊                                                                  | 2324/7473 [00:02<00:04, 1053.14it/s] 33%|███████████████████████████████▋                                                                | 2463/7473 [00:02<00:04, 1151.53it/s] 35%|█████████████████████████████████▏                                                              | 2586/7473 [00:02<00:04, 1174.48it/s] 36%|███████████████████████████████████                                                             | 2725/7473 [00:02<00:03, 1237.50it/s] 38%|████████████████████████████████████▊                                                           | 2863/7473 [00:02<00:03, 1277.78it/s] 40%|██████████████████████████████████████▌                                                         | 3002/7473 [00:03<00:03, 1310.13it/s] 42%|████████████████████████████████████████▎                                                       | 3138/7473 [00:03<00:03, 1324.92it/s] 44%|██████████████████████████████████████████                                                      | 3271/7473 [00:03<00:03, 1325.66it/s] 46%|███████████████████████████████████████████▊                                                    | 3407/7473 [00:03<00:03, 1334.38it/s] 47%|█████████████████████████████████████████████▌                                                  | 3543/7473 [00:03<00:02, 1341.70it/s] 49%|███████████████████████████████████████████████▎                                                | 3679/7473 [00:03<00:02, 1346.55it/s] 51%|█████████████████████████████████████████████████                                               | 3817/7473 [00:03<00:02, 1354.43it/s] 53%|██████████████████████████████████████████████████▊                                             | 3953/7473 [00:03<00:02, 1356.00it/s] 55%|████████████████████████████████████████████████████▌                                           | 4091/7473 [00:03<00:02, 1362.61it/s] 57%|██████████████████████████████████████████████████████▎                                         | 4228/7473 [00:03<00:02, 1355.38it/s] 58%|████████████████████████████████████████████████████████                                        | 4365/7473 [00:04<00:02, 1357.75it/s] 60%|█████████████████████████████████████████████████████████▊                                      | 4501/7473 [00:04<00:02, 1357.93it/s] 62%|███████████████████████████████████████████████████████████▌                                    | 4638/7473 [00:04<00:02, 1361.24it/s] 64%|█████████████████████████████████████████████████████████████▎                                  | 4776/7473 [00:04<00:01, 1365.59it/s] 66%|███████████████████████████████████████████████████████████████                                 | 4913/7473 [00:04<00:01, 1364.44it/s] 68%|████████████████████████████████████████████████████████████████▊                               | 5050/7473 [00:04<00:01, 1346.74it/s] 69%|██████████████████████████████████████████████████████████████████▋                             | 5188/7473 [00:04<00:01, 1354.99it/s] 71%|████████████████████████████████████████████████████████████████████▍                           | 5324/7473 [00:04<00:01, 1291.07it/s] 73%|██████████████████████████████████████████████████████████████████████▏                         | 5461/7473 [00:04<00:01, 1311.76it/s] 75%|███████████████████████████████████████████████████████████████████████▊                        | 5593/7473 [00:05<00:01, 1078.44it/s] 77%|█████████████████████████████████████████████████████████████████████████▌                      | 5730/7473 [00:05<00:01, 1150.82it/s] 79%|███████████████████████████████████████████████████████████████████████████▎                    | 5867/7473 [00:05<00:01, 1207.26it/s] 80%|█████████████████████████████████████████████████████████████████████████████                   | 6001/7473 [00:05<00:01, 1243.11it/s] 82%|██████████████████████████████████████████████████████████████████████████████▊                 | 6138/7473 [00:05<00:01, 1278.25it/s] 84%|████████████████████████████████████████████████████████████████████████████████▌               | 6276/7473 [00:05<00:00, 1304.91it/s] 86%|██████████████████████████████████████████████████████████████████████████████████▎             | 6411/7473 [00:05<00:00, 1317.56it/s] 88%|████████████████████████████████████████████████████████████████████████████████████            | 6548/7473 [00:05<00:00, 1330.79it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████▊          | 6683/7473 [00:05<00:00, 1329.42it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████▌        | 6817/7473 [00:05<00:00, 1331.46it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████▎      | 6954/7473 [00:06<00:00, 1342.41it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████     | 7089/7473 [00:06<00:00, 1344.34it/s] 97%|████████████████████████████████████████████████████████████████████████████████████████████▊   | 7226/7473 [00:06<00:00, 1349.92it/s] 99%|██████████████████████████████████████████████████████████████████████████████████████████████▌ | 7362/7473 [00:06<00:00, 1352.59it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████| 7473/7473 [00:06<00:00, 1163.88it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:04<00:09,  4.96s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.40s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.19s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:11,  5.52s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.03s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.04s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.25s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:11<00:05,  5.51s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.39s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.56s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.46s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.63s/it]
[2023-08-18 03:04:32,578] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.68s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.85s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  4.89s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.06s/it]
[2023-08-18 03:04:43,214] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-18 03:04:43,215] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-18 03:04:43,215] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-18 03:04:43,216] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-18 03:04:43,216] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-18 03:04:43,216] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-18 03:04:43,216] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-18 03:04:43,216] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-18 03:04:43,216] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-18 03:04:43,216] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-18 03:04:43,216] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-18 03:04:43,216] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f199da1f370>
[2023-08-18 03:04:43,216] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-18 03:04:43,216] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-18 03:04:43,216] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-18 03:04:43,216] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-18 03:04:43,216] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-18 03:04:43,216] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-18 03:04:43,216] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-18 03:04:43,216] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-18 03:04:43,216] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-18 03:04:43,216] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-18 03:04:43,216] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-18 03:04:43,216] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-18 03:04:43,216] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-18 03:04:43,216] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-18 03:04:43,216] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-18 03:04:43,216] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-18 03:04:43,216] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-18 03:04:43,216] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-18 03:04:43,216] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-18 03:04:43,216] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-18 03:04:43,216] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-18 03:04:43,216] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-18 03:04:43,216] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-18 03:04:43,216] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-18 03:04:43,216] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-18 03:04:43,216] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-18 03:04:43,216] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-18 03:04:43,217] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-18 03:04:43,217] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-18 03:04:43,217] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-18 03:04:43,217] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-18 03:04:43,217] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-18 03:04:43,217] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f199da1f190>
[2023-08-18 03:04:43,217] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-18 03:04:43,217] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-18 03:04:43,217] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-18 03:04:43,217] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-18 03:04:43,217] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-18 03:04:43,217] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-18 03:04:43,217] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-18 03:04:43,217] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-18 03:04:43,217] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-18 03:04:43,217] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-18 03:04:43,217] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-18 03:04:43,217] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-18 03:04:43,217] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-18 03:04:43,217] [INFO] [config.py:1012:print]   train_batch_size ............. 8
[2023-08-18 03:04:43,217] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  2
[2023-08-18 03:04:43,217] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-18 03:04:43,217] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-18 03:04:43,217] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-18 03:04:43,217] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-18 03:04:43,217] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-18 03:04:43,217] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-18 03:04:43,217] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-18 03:04:43,217] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.36657166481018066 seconds
Time to load utils op: 0.10425806045532227 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating gsm8k :   0%|                                                                                           | 0/125 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following grade math question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Output: D: accomplishing

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Output: A: office

Input: Billy called out to John, and listened for what? Choices:  A: silence B: response C: communication D: hanging up E: whisper
Output: B: response

Input: The lizard frightened the hiker, it's movements made what rustle? Choices:  A: garden B: trees C: books D: rocks E: bushes
Output: E: bushes

Input: The man spent big money and time maintaining his lawn, it was part of keeping up with the Joneses where? Choices:  A: front yard B: suburbia C: neighborhood D: back yard E: golf course
Output: B: suburbia

Input: What would a human do if they want to get to a store that he or she can see? Choices:  A: cross road B: see around C: drink coffee D: dream dreams E: think critically
Output: A: cross road

Input:Natalia sold clips to 48 of her friends in April, and then she sold half as many clips in May. How many clips did Natalia sell altogether in April and May?
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o7-tcommonsenseqa-s1-rFalse
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.40309834480285645 seconds
Time to load utils op: 0.30423712730407715 seconds
Evaluating gsm8k :   1%|▋                                                                                  | 1/125 [00:23<48:02, 23.25s/it]Evaluating gsm8k :   2%|█▎                                                                                 | 2/125 [00:27<24:48, 12.11s/it]Evaluating gsm8k :   2%|█▉                                                                                 | 3/125 [00:55<39:29, 19.42s/it]Evaluating gsm8k :   3%|██▋                                                                                | 4/125 [01:23<45:27, 22.54s/it]Evaluating gsm8k :   4%|███▎                                                                               | 5/125 [01:50<48:26, 24.22s/it]Evaluating gsm8k :   5%|███▉                                                                               | 6/125 [02:03<40:42, 20.52s/it]Evaluating gsm8k :   6%|████▋                                                                              | 7/125 [02:31<45:09, 22.96s/it]Evaluating gsm8k :   6%|█████▎                                                                             | 8/125 [02:58<47:28, 24.34s/it]Evaluating gsm8k :   7%|█████▉                                                                             | 9/125 [03:26<49:13, 25.46s/it]Evaluating gsm8k :   8%|██████▌                                                                           | 10/125 [03:32<37:03, 19.34s/it]Evaluating gsm8k :   9%|███████▏                                                                          | 11/125 [03:47<34:18, 18.05s/it]Evaluating gsm8k :  10%|███████▊                                                                          | 12/125 [04:15<39:52, 21.18s/it]Evaluating gsm8k :  10%|████████▌                                                                         | 13/125 [04:32<37:02, 19.84s/it]Evaluating gsm8k :  11%|█████████▏                                                                        | 14/125 [05:00<41:25, 22.39s/it]Evaluating gsm8k :  12%|█████████▊                                                                        | 15/125 [05:14<36:24, 19.86s/it]Evaluating gsm8k :  13%|██████████▍                                                                       | 16/125 [05:29<33:16, 18.32s/it]Evaluating gsm8k :  14%|███████████▏                                                                      | 17/125 [05:57<38:22, 21.32s/it]Evaluating gsm8k :  14%|███████████▊                                                                      | 18/125 [06:03<29:39, 16.63s/it]Evaluating gsm8k :  15%|████████████▍                                                                     | 19/125 [06:31<35:28, 20.08s/it]Evaluating gsm8k :  16%|█████████████                                                                     | 20/125 [06:36<26:52, 15.36s/it]Evaluating gsm8k :  17%|█████████████▊                                                                    | 21/125 [06:47<24:40, 14.24s/it]Evaluating gsm8k :  18%|██████████████▍                                                                   | 22/125 [07:02<24:28, 14.26s/it]Evaluating gsm8k :  18%|███████████████                                                                   | 23/125 [07:09<20:40, 12.16s/it]Evaluating gsm8k :  19%|███████████████▋                                                                  | 24/125 [07:36<28:07, 16.71s/it]Evaluating gsm8k :  20%|████████████████▍                                                                 | 25/125 [08:00<31:35, 18.95s/it]Evaluating gsm8k :  21%|█████████████████                                                                 | 26/125 [08:28<35:24, 21.46s/it]Evaluating gsm8k :  22%|█████████████████▋                                                                | 27/125 [08:54<37:33, 23.00s/it]Evaluating gsm8k :  22%|██████████████████▎                                                               | 28/125 [09:03<30:03, 18.60s/it]Evaluating gsm8k :  23%|███████████████████                                                               | 29/125 [09:05<21:58, 13.73s/it]Evaluating gsm8k :  24%|███████████████████▋                                                              | 30/125 [09:33<28:34, 18.05s/it]Evaluating gsm8k :  25%|████████████████████▎                                                             | 31/125 [10:01<32:50, 20.96s/it]Evaluating gsm8k :  26%|████████████████████▉                                                             | 32/125 [10:29<35:42, 23.03s/it]Evaluating gsm8k :  26%|█████████████████████▋                                                            | 33/125 [10:57<37:36, 24.53s/it]Evaluating gsm8k :  27%|██████████████████████▎                                                           | 34/125 [11:03<29:00, 19.12s/it]Evaluating gsm8k :  28%|██████████████████████▉                                                           | 35/125 [11:31<32:22, 21.58s/it]Evaluating gsm8k :  29%|███████████████████████▌                                                          | 36/125 [11:59<34:55, 23.54s/it]Evaluating gsm8k :  30%|████████████████████████▎                                                         | 37/125 [12:26<36:10, 24.67s/it]Evaluating gsm8k :  30%|████████████████████████▉                                                         | 38/125 [12:53<36:59, 25.51s/it]Evaluating gsm8k :  31%|█████████████████████████▌                                                        | 39/125 [13:11<33:01, 23.04s/it]Evaluating gsm8k :  32%|██████████████████████████▏                                                       | 40/125 [13:39<34:44, 24.52s/it]Evaluating gsm8k :  33%|██████████████████████████▉                                                       | 41/125 [14:06<35:30, 25.36s/it]Evaluating gsm8k :  34%|███████████████████████████▌                                                      | 42/125 [14:11<26:35, 19.22s/it]Evaluating gsm8k :  34%|████████████████████████████▏                                                     | 43/125 [14:39<29:50, 21.84s/it]Evaluating gsm8k :  35%|████████████████████████████▊                                                     | 44/125 [14:45<23:08, 17.14s/it]Evaluating gsm8k :  36%|█████████████████████████████▌                                                    | 45/125 [15:13<27:16, 20.46s/it]Evaluating gsm8k :  37%|██████████████████████████████▏                                                   | 46/125 [15:40<29:20, 22.29s/it]Evaluating gsm8k :  38%|██████████████████████████████▊                                                   | 47/125 [15:55<26:01, 20.02s/it]Evaluating gsm8k :  38%|███████████████████████████████▍                                                  | 48/125 [16:01<20:24, 15.90s/it]Evaluating gsm8k :  39%|████████████████████████████████▏                                                 | 49/125 [16:28<24:17, 19.18s/it]Evaluating gsm8k :  40%|████████████████████████████████▊                                                 | 50/125 [16:47<23:57, 19.17s/it]Evaluating gsm8k :  41%|█████████████████████████████████▍                                                | 51/125 [17:14<26:34, 21.55s/it]Evaluating gsm8k :  42%|██████████████████████████████████                                                | 52/125 [17:40<27:46, 22.84s/it]Evaluating gsm8k :  42%|██████████████████████████████████▊                                               | 53/125 [17:47<21:48, 18.18s/it]Evaluating gsm8k :  43%|███████████████████████████████████▍                                              | 54/125 [18:14<24:47, 20.96s/it]Evaluating gsm8k :  44%|████████████████████████████████████                                              | 55/125 [18:31<22:47, 19.54s/it]Evaluating gsm8k :  45%|████████████████████████████████████▋                                             | 56/125 [18:59<25:27, 22.14s/it]Evaluating gsm8k :  46%|█████████████████████████████████████▍                                            | 57/125 [19:18<24:01, 21.20s/it]Evaluating gsm8k :  46%|██████████████████████████████████████                                            | 58/125 [19:34<21:59, 19.69s/it]Evaluating gsm8k :  47%|██████████████████████████████████████▋                                           | 59/125 [19:37<16:16, 14.79s/it]Evaluating gsm8k :  48%|███████████████████████████████████████▎                                          | 60/125 [19:46<13:59, 12.91s/it]Evaluating gsm8k :  49%|████████████████████████████████████████                                          | 61/125 [19:49<10:27,  9.81s/it]Evaluating gsm8k :  50%|████████████████████████████████████████▋                                         | 62/125 [19:58<10:20,  9.86s/it]Evaluating gsm8k :  50%|█████████████████████████████████████████▎                                        | 63/125 [20:13<11:36, 11.23s/it]Evaluating gsm8k :  51%|█████████████████████████████████████████▉                                        | 64/125 [20:27<12:11, 11.98s/it]Evaluating gsm8k :  52%|██████████████████████████████████████████▋                                       | 65/125 [20:54<16:42, 16.70s/it]Evaluating gsm8k :  53%|███████████████████████████████████████████▎                                      | 66/125 [21:01<13:20, 13.58s/it]Evaluating gsm8k :  54%|███████████████████████████████████████████▉                                      | 67/125 [21:13<12:40, 13.10s/it]Evaluating gsm8k :  54%|████████████████████████████████████████████▌                                     | 68/125 [21:40<16:38, 17.52s/it]Evaluating gsm8k :  55%|█████████████████████████████████████████████▎                                    | 69/125 [22:08<19:06, 20.47s/it]Evaluating gsm8k :  56%|█████████████████████████████████████████████▉                                    | 70/125 [22:22<17:05, 18.64s/it]Evaluating gsm8k :  57%|██████████████████████████████████████████████▌                                   | 71/125 [22:35<15:08, 16.82s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▏                                  | 72/125 [22:43<12:38, 14.31s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▉                                  | 73/125 [23:11<15:58, 18.43s/it]Evaluating gsm8k :  59%|████████████████████████████████████████████████▌                                 | 74/125 [23:39<17:55, 21.09s/it]Evaluating gsm8k :  60%|█████████████████████████████████████████████████▏                                | 75/125 [24:07<19:18, 23.18s/it]Evaluating gsm8k :  61%|█████████████████████████████████████████████████▊                                | 76/125 [24:35<20:07, 24.65s/it]Evaluating gsm8k :  62%|██████████████████████████████████████████████████▌                               | 77/125 [25:03<20:32, 25.67s/it]Evaluating gsm8k :  62%|███████████████████████████████████████████████████▏                              | 78/125 [25:31<20:38, 26.36s/it]Evaluating gsm8k :  63%|███████████████████████████████████████████████████▊                              | 79/125 [25:45<17:27, 22.78s/it]Evaluating gsm8k :  64%|████████████████████████████████████████████████████▍                             | 80/125 [25:47<12:28, 16.64s/it]Evaluating gsm8k :  65%|█████████████████████████████████████████████████████▏                            | 81/125 [25:50<09:08, 12.47s/it]Evaluating gsm8k :  66%|█████████████████████████████████████████████████████▊                            | 82/125 [26:14<11:20, 15.83s/it]Evaluating gsm8k :  66%|██████████████████████████████████████████████████████▍                           | 83/125 [26:42<13:37, 19.47s/it]Evaluating gsm8k :  67%|███████████████████████████████████████████████████████                           | 84/125 [27:04<13:49, 20.24s/it]Evaluating gsm8k :  68%|███████████████████████████████████████████████████████▊                          | 85/125 [27:23<13:15, 19.88s/it]Evaluating gsm8k :  69%|████████████████████████████████████████████████████████▍                         | 86/125 [27:32<10:47, 16.61s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████                         | 87/125 [27:59<12:35, 19.87s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████▋                        | 88/125 [28:24<13:04, 21.19s/it]Evaluating gsm8k :  71%|██████████████████████████████████████████████████████████▍                       | 89/125 [28:46<12:56, 21.58s/it]Evaluating gsm8k :  72%|███████████████████████████████████████████████████████████                       | 90/125 [29:14<13:44, 23.57s/it]Evaluating gsm8k :  73%|███████████████████████████████████████████████████████████▋                      | 91/125 [29:42<14:08, 24.95s/it]Evaluating gsm8k :  74%|████████████████████████████████████████████████████████████▎                     | 92/125 [30:10<14:09, 25.75s/it]Evaluating gsm8k :  74%|█████████████████████████████████████████████████████████████                     | 93/125 [30:37<13:57, 26.17s/it]Evaluating gsm8k :  75%|█████████████████████████████████████████████████████████████▋                    | 94/125 [30:47<10:57, 21.22s/it]Evaluating gsm8k :  76%|██████████████████████████████████████████████████████████████▎                   | 95/125 [31:08<10:37, 21.24s/it]Evaluating gsm8k :  77%|██████████████████████████████████████████████████████████████▉                   | 96/125 [31:24<09:24, 19.46s/it]Evaluating gsm8k :  78%|███████████████████████████████████████████████████████████████▋                  | 97/125 [31:51<10:14, 21.96s/it]Evaluating gsm8k :  78%|████████████████████████████████████████████████████████████████▎                 | 98/125 [32:11<09:31, 21.17s/it]Evaluating gsm8k :  79%|████████████████████████████████████████████████████████████████▉                 | 99/125 [32:23<08:03, 18.59s/it]Evaluating gsm8k :  80%|████████████████████████████████████████████████████████████████▊                | 100/125 [32:48<08:32, 20.49s/it]Evaluating gsm8k :  81%|█████████████████████████████████████████████████████████████████▍               | 101/125 [33:05<07:47, 19.49s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████               | 102/125 [33:24<07:24, 19.33s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████▋              | 103/125 [33:52<08:03, 21.96s/it]Evaluating gsm8k :  83%|███████████████████████████████████████████████████████████████████▍             | 104/125 [34:14<07:38, 21.82s/it]Evaluating gsm8k :  84%|████████████████████████████████████████████████████████████████████             | 105/125 [34:42<07:54, 23.74s/it]Evaluating gsm8k :  85%|████████████████████████████████████████████████████████████████████▋            | 106/125 [34:56<06:37, 20.93s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▎           | 107/125 [35:24<06:53, 22.97s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▉           | 108/125 [35:52<06:56, 24.49s/it]Evaluating gsm8k :  87%|██████████████████████████████████████████████████████████████████████▋          | 109/125 [36:20<06:48, 25.55s/it]Evaluating gsm8k :  88%|███████████████████████████████████████████████████████████████████████▎         | 110/125 [36:48<06:34, 26.29s/it]Evaluating gsm8k :  89%|███████████████████████████████████████████████████████████████████████▉         | 111/125 [36:53<04:37, 19.83s/it]Evaluating gsm8k :  90%|████████████████████████████████████████████████████████████████████████▌        | 112/125 [37:16<04:30, 20.79s/it]Evaluating gsm8k :  90%|█████████████████████████████████████████████████████████████████████████▏       | 113/125 [37:22<03:15, 16.28s/it]Evaluating gsm8k :  91%|█████████████████████████████████████████████████████████████████████████▊       | 114/125 [37:26<02:19, 12.70s/it]Evaluating gsm8k :  92%|██████████████████████████████████████████████████████████████████████████▌      | 115/125 [37:47<02:31, 15.15s/it]Evaluating gsm8k :  93%|███████████████████████████████████████████████████████████████████████████▏     | 116/125 [38:14<02:49, 18.83s/it]Evaluating gsm8k :  94%|███████████████████████████████████████████████████████████████████████████▊     | 117/125 [38:40<02:47, 20.89s/it]Evaluating gsm8k :  94%|████████████████████████████████████████████████████████████████████████████▍    | 118/125 [38:51<02:04, 17.76s/it]Evaluating gsm8k :  95%|█████████████████████████████████████████████████████████████████████████████    | 119/125 [39:04<01:38, 16.39s/it]Evaluating gsm8k :  96%|█████████████████████████████████████████████████████████████████████████████▊   | 120/125 [39:32<01:39, 19.94s/it]Evaluating gsm8k :  97%|██████████████████████████████████████████████████████████████████████████████▍  | 121/125 [39:58<01:27, 21.84s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████  | 122/125 [40:09<00:55, 18.43s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████▋ | 123/125 [40:36<00:42, 21.12s/it]Evaluating gsm8k :  99%|████████████████████████████████████████████████████████████████████████████████▎| 124/125 [40:51<00:19, 19.37s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [41:20<00:00, 21.99s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [41:20<00:00, 19.84s/it]
name: gsm8k | {'exact_match': 0.0, 'rougeL': 0.5351} | lm_loss 9.7948 | avg. gen lenth: 242.9
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name gsm8k --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name commonsenseqa --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 2 --data-dir /scratch/ylu130/processed_data/gsm8k/out-domain/o8-tcommonsenseqa-s1-rFalse --seed 1 --max-prompt-length 2048 --num-out-domain 8
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-18 03:46:08,465] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... gsm8k
  data_dir ..................... /scratch/ylu130/processed_data/gsm8k/out-domain/o8-tcommonsenseqa-s1-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 8
  out_domain_data_name ......... commonsenseqa
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o8-tcommonsenseqa-s1-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 2
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                                             | 0/7473 [00:00<?, ?it/s]  1%|█                                                                                                  | 81/7473 [00:00<00:09, 806.79it/s]  2%|██▏                                                                                               | 164/7473 [00:00<00:08, 814.79it/s]  3%|███▏                                                                                              | 247/7473 [00:00<00:08, 819.58it/s]  4%|████▎                                                                                             | 330/7473 [00:00<00:08, 820.70it/s]  6%|█████▍                                                                                            | 413/7473 [00:00<00:08, 817.80it/s]  7%|██████▍                                                                                           | 495/7473 [00:00<00:08, 815.23it/s]  8%|███████▌                                                                                          | 578/7473 [00:00<00:08, 819.13it/s]  9%|████████▋                                                                                         | 660/7473 [00:00<00:08, 818.21it/s] 10%|█████████▊                                                                                        | 744/7473 [00:00<00:08, 823.53it/s] 11%|██████████▊                                                                                       | 827/7473 [00:01<00:08, 821.91it/s] 12%|███████████▉                                                                                      | 910/7473 [00:01<00:07, 824.01it/s] 13%|█████████████                                                                                     | 994/7473 [00:01<00:07, 826.76it/s] 14%|█████████████▉                                                                                   | 1077/7473 [00:01<00:07, 814.80it/s] 16%|███████████████                                                                                  | 1159/7473 [00:01<00:07, 813.66it/s] 17%|████████████████                                                                                 | 1241/7473 [00:01<00:07, 815.09it/s] 18%|█████████████████▏                                                                               | 1324/7473 [00:01<00:07, 818.46it/s] 19%|██████████████████▏                                                                              | 1406/7473 [00:01<00:07, 814.79it/s] 20%|███████████████████▎                                                                             | 1489/7473 [00:01<00:07, 818.68it/s] 21%|████████████████████▍                                                                            | 1571/7473 [00:01<00:07, 818.01it/s] 22%|█████████████████████▍                                                                           | 1653/7473 [00:02<00:07, 817.53it/s] 23%|██████████████████████▌                                                                          | 1742/7473 [00:02<00:06, 837.40it/s] 25%|████████████████████████▏                                                                        | 1866/7473 [00:02<00:05, 957.08it/s] 27%|█████████████████████████▌                                                                      | 1988/7473 [00:02<00:05, 1035.18it/s] 28%|███████████████████████████▏                                                                    | 2113/7473 [00:02<00:04, 1096.87it/s] 30%|████████████████████████████▋                                                                   | 2237/7473 [00:02<00:04, 1139.17it/s] 32%|██████████████████████████████▎                                                                 | 2360/7473 [00:02<00:04, 1165.91it/s] 33%|███████████████████████████████▉                                                                | 2486/7473 [00:02<00:04, 1192.24it/s] 35%|█████████████████████████████████▍                                                              | 2606/7473 [00:02<00:04, 1163.68it/s] 37%|███████████████████████████████████                                                             | 2732/7473 [00:02<00:03, 1191.28it/s] 38%|████████████████████████████████████▋                                                           | 2857/7473 [00:03<00:03, 1205.76it/s] 40%|██████████████████████████████████████▎                                                         | 2983/7473 [00:03<00:03, 1220.20it/s] 42%|███████████████████████████████████████▉                                                        | 3108/7473 [00:03<00:03, 1227.12it/s] 43%|█████████████████████████████████████████▌                                                      | 3231/7473 [00:03<00:03, 1227.01it/s] 45%|███████████████████████████████████████████                                                     | 3356/7473 [00:03<00:03, 1233.37it/s] 47%|████████████████████████████████████████████▋                                                   | 3480/7473 [00:03<00:03, 1231.56it/s] 48%|██████████████████████████████████████████████▎                                                 | 3606/7473 [00:03<00:03, 1238.35it/s] 50%|███████████████████████████████████████████████▉                                                | 3730/7473 [00:03<00:03, 1233.48it/s] 52%|█████████████████████████████████████████████████▌                                              | 3855/7473 [00:03<00:02, 1235.89it/s] 53%|███████████████████████████████████████████████████                                             | 3979/7473 [00:03<00:02, 1234.37it/s] 55%|████████████████████████████████████████████████████▋                                           | 4105/7473 [00:04<00:02, 1239.27it/s] 57%|██████████████████████████████████████████████████████▎                                         | 4229/7473 [00:04<00:02, 1234.52it/s] 58%|███████████████████████████████████████████████████████▉                                        | 4353/7473 [00:04<00:02, 1235.97it/s] 60%|█████████████████████████████████████████████████████████▌                                      | 4477/7473 [00:04<00:02, 1236.20it/s] 62%|███████████████████████████████████████████████████████████                                     | 4601/7473 [00:04<00:02, 1237.29it/s] 63%|████████████████████████████████████████████████████████████▋                                   | 4726/7473 [00:04<00:02, 1239.65it/s] 65%|██████████████████████████████████████████████████████████████▎                                 | 4851/7473 [00:04<00:02, 1240.03it/s] 67%|███████████████████████████████████████████████████████████████▉                                | 4976/7473 [00:04<00:02, 1241.61it/s] 68%|█████████████████████████████████████████████████████████████████▌                              | 5101/7473 [00:04<00:01, 1242.85it/s] 70%|███████████████████████████████████████████████████████████████████▏                            | 5226/7473 [00:04<00:01, 1236.74it/s] 72%|████████████████████████████████████████████████████████████████████▋                           | 5350/7473 [00:05<00:01, 1199.14it/s] 73%|███████████████████████████████████████████████████████████████████████                          | 5471/7473 [00:05<00:02, 992.98it/s] 75%|███████████████████████████████████████████████████████████████████████▊                        | 5594/7473 [00:05<00:01, 1051.82it/s] 77%|█████████████████████████████████████████████████████████████████████████▍                      | 5717/7473 [00:05<00:01, 1098.39it/s] 78%|███████████████████████████████████████████████████████████████████████████                     | 5841/7473 [00:05<00:01, 1136.42it/s] 80%|████████████████████████████████████████████████████████████████████████████▌                   | 5963/7473 [00:05<00:01, 1157.95it/s] 81%|██████████████████████████████████████████████████████████████████████████████▏                 | 6087/7473 [00:05<00:01, 1181.43it/s] 83%|███████████████████████████████████████████████████████████████████████████████▊                | 6211/7473 [00:05<00:01, 1197.18it/s] 85%|█████████████████████████████████████████████████████████████████████████████████▍              | 6336/7473 [00:05<00:00, 1211.69it/s] 86%|██████████████████████████████████████████████████████████████████████████████████▉             | 6459/7473 [00:06<00:00, 1212.74it/s] 88%|████████████████████████████████████████████████████████████████████████████████████▌           | 6583/7473 [00:06<00:00, 1219.02it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████▏         | 6706/7473 [00:06<00:00, 1211.84it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████▋        | 6828/7473 [00:06<00:00, 1213.85it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████▎      | 6953/7473 [00:06<00:00, 1223.33it/s] 95%|██████████████████████████████████████████████████████████████████████████████████████████▉     | 7076/7473 [00:06<00:00, 1223.53it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████▍   | 7200/7473 [00:06<00:00, 1225.99it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████  | 7325/7473 [00:06<00:00, 1230.26it/s]100%|███████████████████████████████████████████████████████████████████████████████████████████████▋| 7449/7473 [00:06<00:00, 1230.20it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████| 7473/7473 [00:06<00:00, 1089.57it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.03s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.11s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.17s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.22s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.04s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.14s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.08s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.12s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.41s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.58s/it]
[2023-08-18 03:47:06,633] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.51s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.67s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.50s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.68s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.59s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.73s/it]
[2023-08-18 03:47:20,158] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-18 03:47:20,159] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-18 03:47:20,159] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-18 03:47:20,159] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-18 03:47:20,159] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-18 03:47:20,159] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-18 03:47:20,160] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-18 03:47:20,160] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-18 03:47:20,160] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-18 03:47:20,160] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-18 03:47:20,160] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-18 03:47:20,160] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f2c67ea8370>
[2023-08-18 03:47:20,160] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-18 03:47:20,160] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-18 03:47:20,160] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-18 03:47:20,160] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-18 03:47:20,160] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-18 03:47:20,160] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-18 03:47:20,160] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-18 03:47:20,160] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-18 03:47:20,160] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-18 03:47:20,160] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-18 03:47:20,160] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-18 03:47:20,160] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-18 03:47:20,160] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-18 03:47:20,160] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-18 03:47:20,161] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-18 03:47:20,161] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-18 03:47:20,161] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-18 03:47:20,161] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-18 03:47:20,161] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-18 03:47:20,161] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-18 03:47:20,161] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-18 03:47:20,161] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-18 03:47:20,161] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-18 03:47:20,161] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-18 03:47:20,161] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-18 03:47:20,161] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-18 03:47:20,161] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-18 03:47:20,161] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-18 03:47:20,161] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-18 03:47:20,161] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-18 03:47:20,161] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-18 03:47:20,161] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-18 03:47:20,161] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f2c67ea8250>
[2023-08-18 03:47:20,161] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-18 03:47:20,161] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-18 03:47:20,161] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-18 03:47:20,161] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-18 03:47:20,161] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-18 03:47:20,161] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-18 03:47:20,161] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-18 03:47:20,161] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-18 03:47:20,161] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-18 03:47:20,161] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-18 03:47:20,161] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-18 03:47:20,161] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-18 03:47:20,161] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-18 03:47:20,161] [INFO] [config.py:1012:print]   train_batch_size ............. 8
[2023-08-18 03:47:20,161] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  2
[2023-08-18 03:47:20,161] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-18 03:47:20,161] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-18 03:47:20,162] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-18 03:47:20,162] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-18 03:47:20,162] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-18 03:47:20,162] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-18 03:47:20,162] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-18 03:47:20,162] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.44883012771606445 seconds
Loading extension module utils...
Time to load utils op: 0.40446996688842773 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating gsm8k :   0%|                                                                                           | 0/125 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following grade math question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Output: D: accomplishing

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Output: A: office

Input: Billy called out to John, and listened for what? Choices:  A: silence B: response C: communication D: hanging up E: whisper
Output: B: response

Input: The lizard frightened the hiker, it's movements made what rustle? Choices:  A: garden B: trees C: books D: rocks E: bushes
Output: E: bushes

Input: The man spent big money and time maintaining his lawn, it was part of keeping up with the Joneses where? Choices:  A: front yard B: suburbia C: neighborhood D: back yard E: golf course
Output: B: suburbia

Input: What would a human do if they want to get to a store that he or she can see? Choices:  A: cross road B: see around C: drink coffee D: dream dreams E: think critically
Output: A: cross road

Input: Where would you grab an object contained by a doorway? Choices:  A: television B: control panel C: opening doors D: doorknob E: doorway
Output: E: doorway

Input:Natalia sold clips to 48 of her friends in April, and then she sold half as many clips in May. How many clips did Natalia sell altogether in April and May?
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o8-tcommonsenseqa-s1-rFalse
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.40436601638793945 seconds
Time to load utils op: 0.4044787883758545 seconds
Evaluating gsm8k :   1%|▋                                                                                  | 1/125 [00:09<18:46,  9.08s/it]Evaluating gsm8k :   2%|█▎                                                                                 | 2/125 [00:16<16:08,  7.87s/it]Evaluating gsm8k :   2%|█▉                                                                                 | 3/125 [00:37<28:37, 14.08s/it]Evaluating gsm8k :   3%|██▋                                                                                | 4/125 [01:02<37:04, 18.39s/it]Evaluating gsm8k :   4%|███▎                                                                               | 5/125 [01:17<33:58, 16.99s/it]Evaluating gsm8k :   5%|███▉                                                                               | 6/125 [01:27<29:12, 14.73s/it]Evaluating gsm8k :   6%|████▋                                                                              | 7/125 [01:55<37:23, 19.02s/it]Evaluating gsm8k :   6%|█████▎                                                                             | 8/125 [02:11<35:12, 18.05s/it]Evaluating gsm8k :   7%|█████▉                                                                             | 9/125 [02:38<40:19, 20.86s/it]Evaluating gsm8k :   8%|██████▌                                                                           | 10/125 [02:54<37:11, 19.40s/it]Evaluating gsm8k :   9%|███████▏                                                                          | 11/125 [03:00<28:58, 15.25s/it]Evaluating gsm8k :  10%|███████▊                                                                          | 12/125 [03:19<31:13, 16.58s/it]Evaluating gsm8k :  10%|████████▌                                                                         | 13/125 [03:31<28:11, 15.10s/it]Evaluating gsm8k :  11%|█████████▏                                                                        | 14/125 [03:47<28:30, 15.41s/it]Evaluating gsm8k :  12%|█████████▊                                                                        | 15/125 [04:12<33:26, 18.24s/it]Evaluating gsm8k :  13%|██████████▍                                                                       | 16/125 [04:29<32:27, 17.86s/it]Evaluating gsm8k :  14%|███████████▏                                                                      | 17/125 [04:36<26:21, 14.64s/it]Evaluating gsm8k :  14%|███████████▊                                                                      | 18/125 [04:59<30:22, 17.03s/it]Evaluating gsm8k :  15%|████████████▍                                                                     | 19/125 [05:27<35:48, 20.27s/it]Evaluating gsm8k :  16%|█████████████                                                                     | 20/125 [05:34<28:31, 16.30s/it]Evaluating gsm8k :  17%|█████████████▊                                                                    | 21/125 [06:01<33:51, 19.53s/it]Evaluating gsm8k :  18%|██████████████▍                                                                   | 22/125 [06:11<28:49, 16.79s/it]Evaluating gsm8k :  18%|███████████████                                                                   | 23/125 [06:20<24:35, 14.47s/it]Evaluating gsm8k :  19%|███████████████▋                                                                  | 24/125 [06:35<24:25, 14.51s/it]Evaluating gsm8k :  20%|████████████████▍                                                                 | 25/125 [06:54<26:22, 15.83s/it]Evaluating gsm8k :  21%|█████████████████                                                                 | 26/125 [07:07<25:09, 15.24s/it]Evaluating gsm8k :  22%|█████████████████▋                                                                | 27/125 [07:35<30:47, 18.85s/it]Evaluating gsm8k :  22%|██████████████████▎                                                               | 28/125 [07:43<25:20, 15.68s/it]Evaluating gsm8k :  23%|███████████████████                                                               | 29/125 [07:55<23:29, 14.68s/it]Evaluating gsm8k :  24%|███████████████████▋                                                              | 30/125 [08:17<26:26, 16.70s/it]Evaluating gsm8k :  25%|████████████████████▎                                                             | 31/125 [08:40<29:18, 18.71s/it]Evaluating gsm8k :  26%|████████████████████▉                                                             | 32/125 [09:08<33:17, 21.48s/it]Evaluating gsm8k :  26%|█████████████████████▋                                                            | 33/125 [09:36<35:55, 23.42s/it]Evaluating gsm8k :  27%|██████████████████████▎                                                           | 34/125 [10:03<37:14, 24.56s/it]Evaluating gsm8k :  28%|██████████████████████▉                                                           | 35/125 [10:15<30:56, 20.63s/it]Evaluating gsm8k :  29%|███████████████████████▌                                                          | 36/125 [10:42<33:25, 22.54s/it]Evaluating gsm8k :  30%|████████████████████████▎                                                         | 37/125 [11:07<34:02, 23.21s/it]Evaluating gsm8k :  30%|████████████████████████▉                                                         | 38/125 [11:34<35:34, 24.54s/it]Evaluating gsm8k :  31%|█████████████████████████▌                                                        | 39/125 [12:02<36:29, 25.46s/it]Evaluating gsm8k :  32%|██████████████████████████▏                                                       | 40/125 [12:18<32:00, 22.59s/it]Evaluating gsm8k :  33%|██████████████████████████▉                                                       | 41/125 [12:20<23:10, 16.55s/it]Evaluating gsm8k :  34%|███████████████████████████▌                                                      | 42/125 [12:42<25:18, 18.29s/it]Evaluating gsm8k :  34%|████████████████████████████▏                                                     | 43/125 [13:10<28:49, 21.09s/it]Evaluating gsm8k :  35%|████████████████████████████▊                                                     | 44/125 [13:38<31:06, 23.05s/it]Evaluating gsm8k :  36%|█████████████████████████████▌                                                    | 45/125 [14:03<31:33, 23.67s/it]Evaluating gsm8k :  37%|██████████████████████████████▏                                                   | 46/125 [14:22<29:26, 22.36s/it]Evaluating gsm8k :  38%|██████████████████████████████▊                                                   | 47/125 [14:24<21:15, 16.35s/it]Evaluating gsm8k :  38%|███████████████████████████████▍                                                  | 48/125 [14:36<19:12, 14.97s/it]Evaluating gsm8k :  39%|████████████████████████████████▏                                                 | 49/125 [15:04<23:49, 18.81s/it]Evaluating gsm8k :  40%|████████████████████████████████▊                                                 | 50/125 [15:21<22:59, 18.39s/it]Evaluating gsm8k :  41%|█████████████████████████████████▍                                                | 51/125 [15:49<26:06, 21.17s/it]Evaluating gsm8k :  42%|██████████████████████████████████                                                | 52/125 [16:17<28:10, 23.16s/it]Evaluating gsm8k :  42%|██████████████████████████████████▊                                               | 53/125 [16:27<23:13, 19.35s/it]Evaluating gsm8k :  43%|███████████████████████████████████▍                                              | 54/125 [16:47<23:06, 19.53s/it]Evaluating gsm8k :  44%|████████████████████████████████████                                              | 55/125 [17:03<21:21, 18.31s/it]Evaluating gsm8k :  45%|████████████████████████████████████▋                                             | 56/125 [17:30<24:09, 21.01s/it]Evaluating gsm8k :  46%|█████████████████████████████████████▍                                            | 57/125 [17:47<22:32, 19.89s/it]Evaluating gsm8k :  46%|██████████████████████████████████████                                            | 58/125 [17:57<18:54, 16.93s/it]Evaluating gsm8k :  47%|██████████████████████████████████████▋                                           | 59/125 [18:25<22:08, 20.14s/it]Evaluating gsm8k :  48%|███████████████████████████████████████▎                                          | 60/125 [18:53<24:17, 22.43s/it]Evaluating gsm8k :  49%|████████████████████████████████████████                                          | 61/125 [19:06<21:05, 19.77s/it]Evaluating gsm8k :  50%|████████████████████████████████████████▋                                         | 62/125 [19:13<16:40, 15.88s/it]Evaluating gsm8k :  50%|█████████████████████████████████████████▎                                        | 63/125 [19:40<19:50, 19.20s/it]Evaluating gsm8k :  51%|█████████████████████████████████████████▉                                        | 64/125 [19:48<16:04, 15.81s/it]Evaluating gsm8k :  52%|██████████████████████████████████████████▋                                       | 65/125 [20:05<16:17, 16.29s/it]Evaluating gsm8k :  53%|███████████████████████████████████████████▎                                      | 66/125 [20:33<19:27, 19.79s/it]Evaluating gsm8k :  54%|███████████████████████████████████████████▉                                      | 67/125 [21:01<21:24, 22.15s/it]Evaluating gsm8k :  54%|████████████████████████████████████████████▌                                     | 68/125 [21:28<22:31, 23.70s/it]Evaluating gsm8k :  55%|█████████████████████████████████████████████▎                                    | 69/125 [21:56<23:17, 24.96s/it]Evaluating gsm8k :  56%|█████████████████████████████████████████████▉                                    | 70/125 [22:19<22:16, 24.31s/it]Evaluating gsm8k :  57%|██████████████████████████████████████████████▌                                   | 71/125 [22:23<16:19, 18.14s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▏                                  | 72/125 [22:50<18:31, 20.96s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▉                                  | 73/125 [22:56<14:06, 16.28s/it]Evaluating gsm8k :  59%|████████████████████████████████████████████████▌                                 | 74/125 [23:13<14:10, 16.68s/it]Evaluating gsm8k :  60%|█████████████████████████████████████████████████▏                                | 75/125 [23:31<14:08, 16.96s/it]Evaluating gsm8k :  61%|█████████████████████████████████████████████████▊                                | 76/125 [23:56<15:53, 19.45s/it]Evaluating gsm8k :  62%|██████████████████████████████████████████████████▌                               | 77/125 [24:12<14:43, 18.41s/it]Evaluating gsm8k :  62%|███████████████████████████████████████████████████▏                              | 78/125 [24:40<16:37, 21.22s/it]Evaluating gsm8k :  63%|███████████████████████████████████████████████████▊                              | 79/125 [25:07<17:30, 22.85s/it]Evaluating gsm8k :  64%|████████████████████████████████████████████████████▍                             | 80/125 [25:34<18:09, 24.22s/it]Evaluating gsm8k :  65%|█████████████████████████████████████████████████████▏                            | 81/125 [26:01<18:24, 25.11s/it]Evaluating gsm8k :  66%|█████████████████████████████████████████████████████▊                            | 82/125 [26:29<18:29, 25.80s/it]Evaluating gsm8k :  66%|██████████████████████████████████████████████████████▍                           | 83/125 [26:31<13:07, 18.76s/it]Evaluating gsm8k :  67%|███████████████████████████████████████████████████████                           | 84/125 [26:58<14:32, 21.28s/it]Evaluating gsm8k :  68%|███████████████████████████████████████████████████████▊                          | 85/125 [27:04<11:05, 16.65s/it]Evaluating gsm8k :  69%|████████████████████████████████████████████████████████▍                         | 86/125 [27:31<12:51, 19.79s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████                         | 87/125 [27:39<10:16, 16.23s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████▋                        | 88/125 [27:49<08:48, 14.29s/it]Evaluating gsm8k :  71%|██████████████████████████████████████████████████████████▍                       | 89/125 [28:16<10:53, 18.15s/it]Evaluating gsm8k :  72%|███████████████████████████████████████████████████████████                       | 90/125 [28:44<12:17, 21.06s/it]Evaluating gsm8k :  73%|███████████████████████████████████████████████████████████▋                      | 91/125 [29:11<13:00, 22.96s/it]Evaluating gsm8k :  74%|████████████████████████████████████████████████████████████▎                     | 92/125 [29:39<13:26, 24.44s/it]Evaluating gsm8k :  74%|█████████████████████████████████████████████████████████████                     | 93/125 [30:04<13:03, 24.48s/it]Evaluating gsm8k :  75%|█████████████████████████████████████████████████████████████▋                    | 94/125 [30:31<13:06, 25.38s/it]Evaluating gsm8k :  76%|██████████████████████████████████████████████████████████████▎                   | 95/125 [30:58<12:56, 25.88s/it]Evaluating gsm8k :  77%|██████████████████████████████████████████████████████████████▉                   | 96/125 [31:26<12:44, 26.37s/it]Evaluating gsm8k :  78%|███████████████████████████████████████████████████████████████▋                  | 97/125 [31:53<12:30, 26.82s/it]Evaluating gsm8k :  78%|████████████████████████████████████████████████████████████████▎                 | 98/125 [32:10<10:41, 23.76s/it]Evaluating gsm8k :  79%|████████████████████████████████████████████████████████████████▉                 | 99/125 [32:33<10:08, 23.42s/it]Evaluating gsm8k :  80%|████████████████████████████████████████████████████████████████▊                | 100/125 [33:00<10:17, 24.72s/it]Evaluating gsm8k :  81%|█████████████████████████████████████████████████████████████████▍               | 101/125 [33:06<07:37, 19.05s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████               | 102/125 [33:22<06:52, 17.91s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████▋              | 103/125 [33:49<07:39, 20.87s/it]Evaluating gsm8k :  83%|███████████████████████████████████████████████████████████████████▍             | 104/125 [34:06<06:51, 19.57s/it]Evaluating gsm8k :  84%|████████████████████████████████████████████████████████████████████             | 105/125 [34:34<07:21, 22.05s/it]Evaluating gsm8k :  85%|████████████████████████████████████████████████████████████████████▋            | 106/125 [34:51<06:32, 20.68s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▎           | 107/125 [35:00<05:08, 17.16s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▉           | 108/125 [35:27<05:42, 20.14s/it]Evaluating gsm8k :  87%|██████████████████████████████████████████████████████████████████████▋          | 109/125 [35:41<04:50, 18.14s/it]Evaluating gsm8k :  88%|███████████████████████████████████████████████████████████████████████▎         | 110/125 [35:47<03:38, 14.55s/it]Evaluating gsm8k :  89%|███████████████████████████████████████████████████████████████████████▉         | 111/125 [36:11<04:03, 17.38s/it]Evaluating gsm8k :  90%|████████████████████████████████████████████████████████████████████████▌        | 112/125 [36:38<04:24, 20.34s/it]Evaluating gsm8k :  90%|█████████████████████████████████████████████████████████████████████████▏       | 113/125 [37:05<04:27, 22.26s/it]Evaluating gsm8k :  91%|█████████████████████████████████████████████████████████████████████████▊       | 114/125 [37:32<04:21, 23.79s/it]Evaluating gsm8k :  92%|██████████████████████████████████████████████████████████████████████████▌      | 115/125 [37:50<03:38, 21.86s/it]Evaluating gsm8k :  93%|███████████████████████████████████████████████████████████████████████████▏     | 116/125 [37:58<02:39, 17.77s/it]Evaluating gsm8k :  94%|███████████████████████████████████████████████████████████████████████████▊     | 117/125 [38:25<02:45, 20.72s/it]Evaluating gsm8k :  94%|████████████████████████████████████████████████████████████████████████████▍    | 118/125 [38:53<02:40, 22.88s/it]Evaluating gsm8k :  95%|█████████████████████████████████████████████████████████████████████████████    | 119/125 [39:00<01:47, 17.94s/it]Evaluating gsm8k :  96%|█████████████████████████████████████████████████████████████████████████████▊   | 120/125 [39:07<01:13, 14.67s/it]Evaluating gsm8k :  97%|██████████████████████████████████████████████████████████████████████████████▍  | 121/125 [39:22<00:59, 14.85s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████  | 122/125 [39:31<00:39, 13.21s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████▋ | 123/125 [39:38<00:22, 11.21s/it]Evaluating gsm8k :  99%|████████████████████████████████████████████████████████████████████████████████▎| 124/125 [39:55<00:12, 12.85s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [40:22<00:00, 17.24s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [40:22<00:00, 19.38s/it]
name: gsm8k | {'exact_match': 0.0, 'rougeL': 0.3926} | lm_loss 9.7787 | avg. gen lenth: 236.472
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name gsm8k --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name commonsenseqa --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 2 --data-dir /scratch/ylu130/processed_data/gsm8k/out-domain/o9-tcommonsenseqa-s1-rFalse --seed 1 --max-prompt-length 2048 --num-out-domain 9
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-18 04:30:42,602] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... gsm8k
  data_dir ..................... /scratch/ylu130/processed_data/gsm8k/out-domain/o9-tcommonsenseqa-s1-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 9
  out_domain_data_name ......... commonsenseqa
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o9-tcommonsenseqa-s1-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 2
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                                             | 0/7473 [00:00<?, ?it/s]  1%|▉                                                                                                  | 71/7473 [00:00<00:10, 704.83it/s]  2%|█▊                                                                                                | 142/7473 [00:00<00:10, 707.59it/s]  3%|██▊                                                                                               | 213/7473 [00:00<00:10, 690.50it/s]  4%|███▋                                                                                              | 283/7473 [00:00<00:10, 691.72it/s]  5%|████▋                                                                                             | 355/7473 [00:00<00:10, 699.67it/s]  6%|█████▌                                                                                            | 426/7473 [00:00<00:10, 701.40it/s]  7%|██████▌                                                                                           | 497/7473 [00:00<00:09, 700.82it/s]  8%|███████▍                                                                                          | 569/7473 [00:00<00:09, 705.24it/s]  9%|████████▍                                                                                         | 640/7473 [00:00<00:09, 705.27it/s] 10%|█████████▎                                                                                        | 712/7473 [00:01<00:09, 708.36it/s] 10%|██████████▎                                                                                       | 784/7473 [00:01<00:09, 710.52it/s] 11%|███████████▏                                                                                      | 856/7473 [00:01<00:09, 711.76it/s] 12%|████████████▏                                                                                     | 928/7473 [00:01<00:09, 710.12it/s] 13%|████████████▉                                                                                    | 1000/7473 [00:01<00:09, 709.04it/s] 14%|█████████████▉                                                                                   | 1072/7473 [00:01<00:09, 709.93it/s] 15%|██████████████▊                                                                                  | 1143/7473 [00:01<00:08, 709.31it/s] 16%|███████████████▊                                                                                 | 1214/7473 [00:01<00:08, 706.56it/s] 17%|████████████████▋                                                                                | 1285/7473 [00:01<00:08, 706.91it/s] 18%|█████████████████▌                                                                               | 1356/7473 [00:01<00:08, 707.23it/s] 19%|██████████████████▌                                                                              | 1427/7473 [00:02<00:08, 703.16it/s] 20%|███████████████████▍                                                                             | 1499/7473 [00:02<00:08, 706.74it/s] 21%|████████████████████▍                                                                            | 1570/7473 [00:02<00:08, 705.43it/s] 22%|█████████████████████▎                                                                           | 1641/7473 [00:02<00:08, 704.61it/s] 23%|██████████████████████▏                                                                          | 1713/7473 [00:02<00:08, 706.31it/s] 24%|███████████████████████▏                                                                         | 1784/7473 [00:02<00:08, 706.26it/s] 25%|████████████████████████▏                                                                        | 1862/7473 [00:02<00:07, 728.00it/s] 26%|█████████████████████████▌                                                                       | 1969/7473 [00:02<00:06, 829.01it/s] 28%|██████████████████████████▉                                                                      | 2077/7473 [00:02<00:05, 901.58it/s] 29%|████████████████████████████▎                                                                    | 2185/7473 [00:02<00:05, 952.60it/s] 31%|█████████████████████████████▊                                                                   | 2293/7473 [00:03<00:05, 986.25it/s] 32%|██████████████████████████████▊                                                                 | 2402/7473 [00:03<00:04, 1014.48it/s] 34%|████████████████████████████████▏                                                               | 2510/7473 [00:03<00:04, 1033.28it/s] 35%|█████████████████████████████████▌                                                              | 2614/7473 [00:03<00:04, 1008.24it/s] 36%|██████████████████████████████████▉                                                             | 2722/7473 [00:03<00:04, 1027.75it/s] 38%|████████████████████████████████████▎                                                           | 2828/7473 [00:03<00:04, 1035.24it/s] 39%|█████████████████████████████████████▋                                                          | 2937/7473 [00:03<00:04, 1049.18it/s] 41%|███████████████████████████████████████                                                         | 3045/7473 [00:03<00:04, 1055.69it/s] 42%|████████████████████████████████████████▍                                                       | 3152/7473 [00:03<00:04, 1057.38it/s] 44%|█████████████████████████████████████████▊                                                      | 3258/7473 [00:03<00:04, 1049.78it/s] 45%|███████████████████████████████████████████▏                                                    | 3364/7473 [00:04<00:03, 1052.20it/s] 46%|████████████████████████████████████████████▌                                                   | 3470/7473 [00:04<00:03, 1053.36it/s] 48%|█████████████████████████████████████████████▉                                                  | 3579/7473 [00:04<00:03, 1061.99it/s] 49%|███████████████████████████████████████████████▎                                                | 3686/7473 [00:04<00:03, 1061.85it/s] 51%|████████████████████████████████████████████████▋                                               | 3793/7473 [00:04<00:03, 1063.38it/s] 52%|██████████████████████████████████████████████████                                              | 3900/7473 [00:04<00:03, 1062.16it/s] 54%|███████████████████████████████████████████████████▍                                            | 4008/7473 [00:04<00:03, 1065.02it/s] 55%|████████████████████████████████████████████████████▊                                           | 4115/7473 [00:04<00:03, 1063.81it/s] 56%|██████████████████████████████████████████████████████▏                                         | 4222/7473 [00:04<00:03, 1063.39it/s] 58%|███████████████████████████████████████████████████████▌                                        | 4329/7473 [00:04<00:02, 1065.33it/s] 59%|████████████████████████████████████████████████████████▉                                       | 4436/7473 [00:05<00:02, 1062.46it/s] 61%|██████████████████████████████████████████████████████████▎                                     | 4543/7473 [00:05<00:02, 1060.65it/s] 62%|███████████████████████████████████████████████████████████▋                                    | 4650/7473 [00:05<00:02, 1061.62it/s] 64%|█████████████████████████████████████████████████████████████                                   | 4757/7473 [00:05<00:02, 1062.94it/s] 65%|██████████████████████████████████████████████████████████████▍                                 | 4864/7473 [00:05<00:02, 1060.67it/s] 67%|███████████████████████████████████████████████████████████████▊                                | 4971/7473 [00:05<00:02, 1061.10it/s] 68%|█████████████████████████████████████████████████████████████████▏                              | 5078/7473 [00:05<00:02, 1057.42it/s] 69%|██████████████████████████████████████████████████████████████████▌                             | 5185/7473 [00:05<00:02, 1060.67it/s] 71%|███████████████████████████████████████████████████████████████████▉                            | 5292/7473 [00:05<00:02, 1030.63it/s] 72%|█████████████████████████████████████████████████████████████████████▎                          | 5399/7473 [00:05<00:01, 1041.79it/s] 74%|███████████████████████████████████████████████████████████████████████▍                         | 5504/7473 [00:06<00:02, 775.91it/s] 75%|████████████████████████████████████████████████████████████████████████▊                        | 5611/7473 [00:06<00:02, 844.81it/s] 77%|██████████████████████████████████████████████████████████████████████████▏                      | 5717/7473 [00:06<00:01, 897.48it/s] 78%|███████████████████████████████████████████████████████████████████████████▌                     | 5824/7473 [00:06<00:01, 942.51it/s] 79%|████████████████████████████████████████████████████████████████████████████▉                    | 5930/7473 [00:06<00:01, 974.73it/s] 81%|██████████████████████████████████████████████████████████████████████████████▎                  | 6037/7473 [00:06<00:01, 999.23it/s] 82%|██████████████████████████████████████████████████████████████████████████████▉                 | 6144/7473 [00:06<00:01, 1018.73it/s] 84%|████████████████████████████████████████████████████████████████████████████████▎               | 6251/7473 [00:06<00:01, 1033.47it/s] 85%|█████████████████████████████████████████████████████████████████████████████████▋              | 6357/7473 [00:06<00:01, 1040.78it/s] 86%|███████████████████████████████████████████████████████████████████████████████████             | 6463/7473 [00:07<00:00, 1044.68it/s] 88%|████████████████████████████████████████████████████████████████████████████████████▍           | 6570/7473 [00:07<00:00, 1049.59it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████▊          | 6676/7473 [00:07<00:00, 1043.59it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████▏        | 6783/7473 [00:07<00:00, 1050.19it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████▍       | 6889/7473 [00:07<00:00, 1052.44it/s] 94%|█████████████████████████████████████████████████████████████████████████████████████████▊      | 6995/7473 [00:07<00:00, 1054.65it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████▏    | 7102/7473 [00:07<00:00, 1056.14it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████▌   | 7208/7473 [00:07<00:00, 1055.61it/s] 98%|█████████████████████████████████████████████████████████████████████████████████████████████▉  | 7315/7473 [00:07<00:00, 1057.85it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████▎| 7422/7473 [00:08<00:00, 1059.97it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 7473/7473 [00:08<00:00, 928.38it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:04<00:09,  4.98s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.06s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.31s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:11,  5.85s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:09<00:04,  4.93s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.31s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.34s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.32s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.49s/it]
Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:12<00:06,  6.40s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.74s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.87s/it]
[2023-08-18 04:31:42,952] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.81s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.95s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:18<00:00,  6.17s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:18<00:00,  6.18s/it]
[2023-08-18 04:31:57,420] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-18 04:31:57,421] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-18 04:31:57,422] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-18 04:31:57,422] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-18 04:31:57,422] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-18 04:31:57,422] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-18 04:31:57,422] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-18 04:31:57,422] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-18 04:31:57,422] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-18 04:31:57,423] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-18 04:31:57,423] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-18 04:31:57,423] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f40edf6f370>
[2023-08-18 04:31:57,423] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-18 04:31:57,423] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-18 04:31:57,423] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-18 04:31:57,423] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-18 04:31:57,423] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-18 04:31:57,423] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-18 04:31:57,423] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-18 04:31:57,423] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-18 04:31:57,423] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-18 04:31:57,423] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-18 04:31:57,423] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-18 04:31:57,423] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-18 04:31:57,423] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-18 04:31:57,423] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-18 04:31:57,423] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-18 04:31:57,423] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-18 04:31:57,423] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-18 04:31:57,423] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-18 04:31:57,423] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-18 04:31:57,423] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-18 04:31:57,423] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-18 04:31:57,423] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-18 04:31:57,423] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-18 04:31:57,423] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-18 04:31:57,423] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-18 04:31:57,423] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-18 04:31:57,423] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-18 04:31:57,423] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-18 04:31:57,423] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-18 04:31:57,423] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-18 04:31:57,423] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-18 04:31:57,423] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-18 04:31:57,423] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f40edf6f250>
[2023-08-18 04:31:57,424] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-18 04:31:57,424] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-18 04:31:57,424] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-18 04:31:57,424] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-18 04:31:57,424] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-18 04:31:57,424] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-18 04:31:57,424] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-18 04:31:57,424] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-18 04:31:57,424] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-18 04:31:57,424] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-18 04:31:57,424] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-18 04:31:57,424] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-18 04:31:57,424] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-18 04:31:57,424] [INFO] [config.py:1012:print]   train_batch_size ............. 8
[2023-08-18 04:31:57,424] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  2
[2023-08-18 04:31:57,424] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-18 04:31:57,424] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-18 04:31:57,424] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-18 04:31:57,424] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-18 04:31:57,424] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-18 04:31:57,424] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-18 04:31:57,424] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-18 04:31:57,424] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.4106121063232422 seconds
Loading extension module utils...
Time to load utils op: 0.4045076370239258 seconds
Loading extension module utils...
Time to load utils op: 0.30761098861694336 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating gsm8k :   0%|                                                                                           | 0/125 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following grade math question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Output: D: accomplishing

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Output: A: office

Input: Billy called out to John, and listened for what? Choices:  A: silence B: response C: communication D: hanging up E: whisper
Output: B: response

Input: The lizard frightened the hiker, it's movements made what rustle? Choices:  A: garden B: trees C: books D: rocks E: bushes
Output: E: bushes

Input: The man spent big money and time maintaining his lawn, it was part of keeping up with the Joneses where? Choices:  A: front yard B: suburbia C: neighborhood D: back yard E: golf course
Output: B: suburbia

Input: What would a human do if they want to get to a store that he or she can see? Choices:  A: cross road B: see around C: drink coffee D: dream dreams E: think critically
Output: A: cross road

Input: Where would you grab an object contained by a doorway? Choices:  A: television B: control panel C: opening doors D: doorknob E: doorway
Output: E: doorway

Input: Sarah knew she was committing perjury, so there was a lot of what feeling between her and the prosecutor? Choices:  A: arrest B: tension C: shame D: attraction E: embarrassment
Output: B: tension

Input:Natalia sold clips to 48 of her friends in April, and then she sold half as many clips in May. How many clips did Natalia sell altogether in April and May?
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o9-tcommonsenseqa-s1-rFalse
Loading extension module utils...
Time to load utils op: 0.40458178520202637 seconds
Evaluating gsm8k :   1%|▋                                                                                  | 1/125 [00:08<18:06,  8.76s/it]Evaluating gsm8k :   2%|█▎                                                                                 | 2/125 [00:11<10:05,  4.93s/it]Evaluating gsm8k :   2%|█▉                                                                                 | 3/125 [00:35<28:33, 14.05s/it]Evaluating gsm8k :   3%|██▋                                                                                | 4/125 [00:42<22:21, 11.09s/it]Evaluating gsm8k :   4%|███▎                                                                               | 5/125 [01:09<33:50, 16.92s/it]Evaluating gsm8k :   5%|███▉                                                                               | 6/125 [01:36<40:22, 20.35s/it]Evaluating gsm8k :   6%|████▋                                                                              | 7/125 [02:03<44:18, 22.53s/it]Evaluating gsm8k :   6%|█████▎                                                                             | 8/125 [02:29<46:02, 23.61s/it]Evaluating gsm8k :   7%|█████▉                                                                             | 9/125 [02:56<47:31, 24.58s/it]Evaluating gsm8k :   8%|██████▌                                                                           | 10/125 [03:16<44:14, 23.08s/it]Evaluating gsm8k :   9%|███████▏                                                                          | 11/125 [03:29<38:03, 20.03s/it]Evaluating gsm8k :  10%|███████▊                                                                          | 12/125 [03:56<42:06, 22.36s/it]Evaluating gsm8k :  10%|████████▌                                                                         | 13/125 [04:24<44:42, 23.95s/it]Evaluating gsm8k :  11%|█████████▏                                                                        | 14/125 [04:40<39:56, 21.59s/it]Evaluating gsm8k :  12%|█████████▊                                                                        | 15/125 [05:07<42:39, 23.27s/it]Evaluating gsm8k :  13%|██████████▍                                                                       | 16/125 [05:16<34:32, 19.02s/it]Evaluating gsm8k :  14%|███████████▏                                                                      | 17/125 [05:28<29:58, 16.65s/it]Evaluating gsm8k :  14%|███████████▊                                                                      | 18/125 [05:44<29:49, 16.72s/it]Evaluating gsm8k :  15%|████████████▍                                                                     | 19/125 [06:05<31:30, 17.83s/it]Evaluating gsm8k :  16%|█████████████                                                                     | 20/125 [06:32<35:51, 20.49s/it]Evaluating gsm8k :  17%|█████████████▊                                                                    | 21/125 [06:38<28:17, 16.32s/it]Evaluating gsm8k :  18%|██████████████▍                                                                   | 22/125 [07:05<33:20, 19.42s/it]Evaluating gsm8k :  18%|███████████████                                                                   | 23/125 [07:32<36:59, 21.76s/it]Evaluating gsm8k :  19%|███████████████▋                                                                  | 24/125 [08:00<39:30, 23.47s/it]Evaluating gsm8k :  20%|████████████████▍                                                                 | 25/125 [08:02<28:33, 17.13s/it]Evaluating gsm8k :  21%|█████████████████                                                                 | 26/125 [08:29<33:19, 20.19s/it]Evaluating gsm8k :  22%|█████████████████▋                                                                | 27/125 [08:56<36:13, 22.18s/it]Evaluating gsm8k :  22%|██████████████████▎                                                               | 28/125 [09:23<38:14, 23.65s/it]Evaluating gsm8k :  23%|███████████████████                                                               | 29/125 [09:47<38:01, 23.77s/it]Evaluating gsm8k :  24%|███████████████████▋                                                              | 30/125 [10:06<35:28, 22.41s/it]Evaluating gsm8k :  25%|████████████████████▎                                                             | 31/125 [10:34<37:33, 23.97s/it]Evaluating gsm8k :  26%|████████████████████▉                                                             | 32/125 [10:45<30:54, 19.94s/it]Evaluating gsm8k :  26%|█████████████████████▋                                                            | 33/125 [11:12<34:05, 22.24s/it]Evaluating gsm8k :  27%|██████████████████████▎                                                           | 34/125 [11:39<35:47, 23.60s/it]Evaluating gsm8k :  28%|██████████████████████▉                                                           | 35/125 [11:50<29:39, 19.78s/it]Evaluating gsm8k :  29%|███████████████████████▌                                                          | 36/125 [12:16<32:22, 21.83s/it]Evaluating gsm8k :  30%|████████████████████████▎                                                         | 37/125 [12:23<25:15, 17.22s/it]Evaluating gsm8k :  30%|████████████████████████▉                                                         | 38/125 [12:50<29:07, 20.08s/it]Evaluating gsm8k :  31%|█████████████████████████▌                                                        | 39/125 [13:17<31:48, 22.19s/it]Evaluating gsm8k :  32%|██████████████████████████▏                                                       | 40/125 [13:41<32:16, 22.78s/it]Evaluating gsm8k :  33%|██████████████████████████▉                                                       | 41/125 [13:52<26:48, 19.14s/it]Evaluating gsm8k :  34%|███████████████████████████▌                                                      | 42/125 [14:10<26:05, 18.86s/it]Evaluating gsm8k :  34%|████████████████████████████▏                                                     | 43/125 [14:33<27:32, 20.16s/it]Evaluating gsm8k :  35%|████████████████████████████▊                                                     | 44/125 [15:00<30:11, 22.36s/it]Evaluating gsm8k :  36%|█████████████████████████████▌                                                    | 45/125 [15:08<23:56, 17.95s/it]Evaluating gsm8k :  37%|██████████████████████████████▏                                                   | 46/125 [15:24<22:51, 17.36s/it]Evaluating gsm8k :  38%|██████████████████████████████▊                                                   | 47/125 [15:51<26:16, 20.21s/it]Evaluating gsm8k :  38%|███████████████████████████████▍                                                  | 48/125 [16:09<25:04, 19.53s/it]Evaluating gsm8k :  39%|████████████████████████████████▏                                                 | 49/125 [16:25<23:17, 18.39s/it]Evaluating gsm8k :  40%|████████████████████████████████▊                                                 | 50/125 [16:34<19:28, 15.58s/it]Evaluating gsm8k :  41%|█████████████████████████████████▍                                                | 51/125 [17:00<23:15, 18.86s/it]Evaluating gsm8k :  42%|██████████████████████████████████                                                | 52/125 [17:04<17:27, 14.36s/it]Evaluating gsm8k :  42%|██████████████████████████████████▊                                               | 53/125 [17:14<15:34, 12.99s/it]Evaluating gsm8k :  43%|███████████████████████████████████▍                                              | 54/125 [17:33<17:32, 14.83s/it]Evaluating gsm8k :  44%|████████████████████████████████████                                              | 55/125 [18:01<21:45, 18.66s/it]Evaluating gsm8k :  45%|████████████████████████████████████▋                                             | 56/125 [18:12<19:00, 16.52s/it]Evaluating gsm8k :  46%|█████████████████████████████████████▍                                            | 57/125 [18:23<16:51, 14.87s/it]Evaluating gsm8k :  46%|██████████████████████████████████████                                            | 58/125 [18:26<12:37, 11.30s/it]Evaluating gsm8k :  47%|██████████████████████████████████████▋                                           | 59/125 [18:53<17:42, 16.10s/it]Evaluating gsm8k :  48%|███████████████████████████████████████▎                                          | 60/125 [19:20<20:57, 19.35s/it]Evaluating gsm8k :  49%|████████████████████████████████████████                                          | 61/125 [19:48<23:16, 21.81s/it]Evaluating gsm8k :  50%|████████████████████████████████████████▋                                         | 62/125 [20:14<24:23, 23.24s/it]Evaluating gsm8k :  50%|█████████████████████████████████████████▎                                        | 63/125 [20:38<24:16, 23.49s/it]Evaluating gsm8k :  51%|█████████████████████████████████████████▉                                        | 64/125 [20:44<18:30, 18.21s/it]Evaluating gsm8k :  52%|██████████████████████████████████████████▋                                       | 65/125 [21:11<20:48, 20.80s/it]Evaluating gsm8k :  53%|███████████████████████████████████████████▎                                      | 66/125 [21:38<22:07, 22.49s/it]Evaluating gsm8k :  54%|███████████████████████████████████████████▉                                      | 67/125 [21:50<18:55, 19.59s/it]Evaluating gsm8k :  54%|████████████████████████████████████████████▌                                     | 68/125 [21:57<14:58, 15.76s/it]Evaluating gsm8k :  55%|█████████████████████████████████████████████▎                                    | 69/125 [22:24<17:51, 19.14s/it]Evaluating gsm8k :  56%|█████████████████████████████████████████████▉                                    | 70/125 [22:51<19:44, 21.54s/it]Evaluating gsm8k :  57%|██████████████████████████████████████████████▌                                   | 71/125 [23:09<18:16, 20.30s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▏                                  | 72/125 [23:35<19:34, 22.15s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▉                                  | 73/125 [24:03<20:36, 23.78s/it]Evaluating gsm8k :  59%|████████████████████████████████████████████████▌                                 | 74/125 [24:30<20:57, 24.66s/it]Evaluating gsm8k :  60%|█████████████████████████████████████████████████▏                                | 75/125 [24:57<21:16, 25.53s/it]Evaluating gsm8k :  61%|█████████████████████████████████████████████████▊                                | 76/125 [25:24<21:16, 26.06s/it]Evaluating gsm8k :  62%|██████████████████████████████████████████████████▌                               | 77/125 [25:30<15:48, 19.77s/it]Evaluating gsm8k :  62%|███████████████████████████████████████████████████▏                              | 78/125 [25:41<13:29, 17.21s/it]Evaluating gsm8k :  63%|███████████████████████████████████████████████████▊                              | 79/125 [26:06<14:56, 19.49s/it]Evaluating gsm8k :  64%|████████████████████████████████████████████████████▍                             | 80/125 [26:12<11:43, 15.64s/it]Evaluating gsm8k :  65%|█████████████████████████████████████████████████████▏                            | 81/125 [26:39<13:55, 19.00s/it]Evaluating gsm8k :  66%|█████████████████████████████████████████████████████▊                            | 82/125 [27:06<15:15, 21.30s/it]Evaluating gsm8k :  66%|██████████████████████████████████████████████████████▍                           | 83/125 [27:18<12:56, 18.48s/it]Evaluating gsm8k :  67%|███████████████████████████████████████████████████████                           | 84/125 [27:45<14:28, 21.17s/it]Evaluating gsm8k :  68%|███████████████████████████████████████████████████████▊                          | 85/125 [27:51<11:06, 16.66s/it]Evaluating gsm8k :  69%|████████████████████████████████████████████████████████▍                         | 86/125 [28:00<09:19, 14.34s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████                         | 87/125 [28:28<11:36, 18.34s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████▋                        | 88/125 [28:30<08:20, 13.52s/it]Evaluating gsm8k :  71%|██████████████████████████████████████████████████████████▍                       | 89/125 [28:57<10:30, 17.53s/it]Evaluating gsm8k :  72%|███████████████████████████████████████████████████████████                       | 90/125 [29:24<11:52, 20.37s/it]Evaluating gsm8k :  73%|███████████████████████████████████████████████████████████▋                      | 91/125 [29:52<12:46, 22.55s/it]Evaluating gsm8k :  74%|████████████████████████████████████████████████████████████▎                     | 92/125 [29:59<09:49, 17.85s/it]Evaluating gsm8k :  74%|█████████████████████████████████████████████████████████████                     | 93/125 [30:07<07:58, 14.94s/it]Evaluating gsm8k :  75%|█████████████████████████████████████████████████████████████▋                    | 94/125 [30:16<06:47, 13.16s/it]Evaluating gsm8k :  76%|██████████████████████████████████████████████████████████████▎                   | 95/125 [30:18<04:55,  9.86s/it]Evaluating gsm8k :  77%|██████████████████████████████████████████████████████████████▉                   | 96/125 [30:45<07:20, 15.19s/it]Evaluating gsm8k :  78%|███████████████████████████████████████████████████████████████▋                  | 97/125 [30:53<05:59, 12.85s/it]Evaluating gsm8k :  78%|████████████████████████████████████████████████████████████████▎                 | 98/125 [31:05<05:37, 12.50s/it]Evaluating gsm8k :  79%|████████████████████████████████████████████████████████████████▉                 | 99/125 [31:31<07:17, 16.83s/it]Evaluating gsm8k :  80%|████████████████████████████████████████████████████████████████▊                | 100/125 [31:46<06:45, 16.23s/it]Evaluating gsm8k :  81%|█████████████████████████████████████████████████████████████████▍               | 101/125 [32:14<07:48, 19.53s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████               | 102/125 [32:16<05:33, 14.50s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████▋              | 103/125 [32:43<06:40, 18.21s/it]Evaluating gsm8k :  83%|███████████████████████████████████████████████████████████████████▍             | 104/125 [33:10<07:16, 20.78s/it]Evaluating gsm8k :  84%|████████████████████████████████████████████████████████████████████             | 105/125 [33:37<07:31, 22.56s/it]Evaluating gsm8k :  85%|████████████████████████████████████████████████████████████████████▋            | 106/125 [33:39<05:13, 16.52s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▎           | 107/125 [34:07<05:56, 19.83s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▉           | 108/125 [34:15<04:36, 16.27s/it]Evaluating gsm8k :  87%|██████████████████████████████████████████████████████████████████████▋          | 109/125 [34:26<03:57, 14.85s/it]Evaluating gsm8k :  88%|███████████████████████████████████████████████████████████████████████▎         | 110/125 [34:46<04:03, 16.24s/it]Evaluating gsm8k :  89%|███████████████████████████████████████████████████████████████████████▉         | 111/125 [35:03<03:52, 16.58s/it]Evaluating gsm8k :  90%|████████████████████████████████████████████████████████████████████████▌        | 112/125 [35:05<02:40, 12.34s/it]Evaluating gsm8k :  90%|█████████████████████████████████████████████████████████████████████████▏       | 113/125 [35:32<03:19, 16.66s/it]Evaluating gsm8k :  91%|█████████████████████████████████████████████████████████████████████████▊       | 114/125 [35:37<02:25, 13.25s/it]Evaluating gsm8k :  92%|██████████████████████████████████████████████████████████████████████████▌      | 115/125 [35:59<02:37, 15.72s/it]Evaluating gsm8k :  93%|███████████████████████████████████████████████████████████████████████████▏     | 116/125 [36:12<02:14, 14.95s/it]Evaluating gsm8k :  94%|███████████████████████████████████████████████████████████████████████████▊     | 117/125 [36:14<01:29, 11.16s/it]Evaluating gsm8k :  94%|████████████████████████████████████████████████████████████████████████████▍    | 118/125 [36:19<01:03,  9.11s/it]Evaluating gsm8k :  95%|█████████████████████████████████████████████████████████████████████████████    | 119/125 [36:46<01:27, 14.57s/it]Evaluating gsm8k :  96%|█████████████████████████████████████████████████████████████████████████████▊   | 120/125 [37:08<01:23, 16.73s/it]Evaluating gsm8k :  97%|██████████████████████████████████████████████████████████████████████████████▍  | 121/125 [37:35<01:19, 19.95s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████  | 122/125 [37:48<00:53, 17.70s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████▋ | 123/125 [38:15<00:41, 20.63s/it]Evaluating gsm8k :  99%|████████████████████████████████████████████████████████████████████████████████▎| 124/125 [38:24<00:16, 16.97s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [38:51<00:00, 20.12s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [38:51<00:00, 18.65s/it]
name: gsm8k | {'exact_match': 0.0, 'rougeL': 0.2109} | lm_loss 9.7694 | avg. gen lenth: 234.78
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name gsm8k --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name commonsenseqa --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 2 --data-dir /scratch/ylu130/processed_data/gsm8k/out-domain/o1-tcommonsenseqa-s10-rTrue --seed 10 --max-prompt-length 2048 --rationales --num-out-domain 1
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date![nltk_data]   Package punkt is already up-to-date!

[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-18 05:12:07,029] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... gsm8k
  data_dir ..................... /scratch/ylu130/processed_data/gsm8k/out-domain/o1-tcommonsenseqa-s10-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 1
  out_domain_data_name ......... commonsenseqa
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o1-tcommonsenseqa-s10-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 2
  clip_grad .................... 1.0
  seed ......................... 10
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                                             | 0/7473 [00:00<?, ?it/s]  1%|█                                                                                                  | 81/7473 [00:00<00:09, 804.27it/s]  2%|██▏                                                                                               | 163/7473 [00:00<00:09, 811.72it/s]  3%|███▏                                                                                              | 246/7473 [00:00<00:08, 816.55it/s]  4%|████▎                                                                                             | 328/7473 [00:00<00:08, 817.66it/s]  5%|█████▍                                                                                            | 410/7473 [00:00<00:08, 814.38it/s]  7%|██████▍                                                                                           | 492/7473 [00:00<00:08, 812.97it/s]  8%|███████▌                                                                                          | 575/7473 [00:00<00:08, 817.09it/s]  9%|████████▌                                                                                         | 657/7473 [00:00<00:08, 817.07it/s] 10%|█████████▋                                                                                        | 739/7473 [00:00<00:08, 802.38it/s] 11%|██████████▊                                                                                       | 820/7473 [00:01<00:08, 804.55it/s] 12%|███████████▊                                                                                      | 902/7473 [00:01<00:08, 809.20it/s] 13%|████████████▉                                                                                     | 985/7473 [00:01<00:07, 815.10it/s] 14%|█████████████▊                                                                                   | 1068/7473 [00:01<00:07, 818.23it/s] 15%|██████████████▉                                                                                  | 1151/7473 [00:01<00:07, 819.48it/s] 16%|████████████████                                                                                 | 1233/7473 [00:01<00:07, 815.85it/s] 18%|█████████████████                                                                                | 1316/7473 [00:01<00:07, 818.33it/s] 19%|██████████████████▏                                                                              | 1398/7473 [00:01<00:07, 814.46it/s] 20%|███████████████████▏                                                                             | 1481/7473 [00:01<00:07, 817.10it/s] 21%|████████████████████▎                                                                            | 1563/7473 [00:01<00:07, 813.77it/s] 22%|█████████████████████▎                                                                           | 1645/7473 [00:02<00:07, 811.40it/s] 23%|██████████████████████▍                                                                          | 1727/7473 [00:02<00:07, 810.21it/s] 24%|███████████████████████▍                                                                         | 1809/7473 [00:02<00:07, 808.41it/s] 25%|████████████████████████▌                                                                        | 1890/7473 [00:02<00:06, 806.38it/s] 26%|█████████████████████████▌                                                                       | 1971/7473 [00:02<00:06, 807.40it/s] 27%|██████████████████████████▋                                                                      | 2054/7473 [00:02<00:06, 813.47it/s] 29%|███████████████████████████▋                                                                     | 2136/7473 [00:02<00:06, 813.65it/s] 30%|████████████████████████████▊                                                                    | 2220/7473 [00:02<00:06, 818.83it/s] 31%|█████████████████████████████▉                                                                   | 2302/7473 [00:02<00:06, 819.12it/s] 32%|██████████████████████████████▉                                                                  | 2385/7473 [00:02<00:06, 821.44it/s] 33%|████████████████████████████████                                                                 | 2469/7473 [00:03<00:06, 824.09it/s] 34%|█████████████████████████████████▏                                                               | 2552/7473 [00:03<00:06, 793.46it/s] 35%|██████████████████████████████████▏                                                              | 2633/7473 [00:03<00:06, 797.03it/s] 36%|███████████████████████████████████▎                                                             | 2717/7473 [00:03<00:05, 807.26it/s] 37%|████████████████████████████████████▎                                                            | 2800/7473 [00:03<00:05, 811.19it/s] 39%|█████████████████████████████████████▍                                                           | 2883/7473 [00:03<00:05, 814.96it/s] 40%|██████████████████████████████████████▌                                                          | 2967/7473 [00:03<00:05, 822.36it/s] 41%|███████████████████████████████████████▌                                                         | 3050/7473 [00:03<00:05, 819.35it/s] 42%|████████████████████████████████████████▋                                                        | 3132/7473 [00:03<00:05, 818.51it/s] 43%|█████████████████████████████████████████▋                                                       | 3216/7473 [00:03<00:05, 824.27it/s] 45%|███████████████████████████████████████████▎                                                     | 3341/7473 [00:04<00:04, 950.72it/s] 46%|████████████████████████████████████████████▍                                                   | 3464/7473 [00:04<00:03, 1031.97it/s] 48%|██████████████████████████████████████████████                                                  | 3589/7473 [00:04<00:03, 1096.74it/s] 50%|███████████████████████████████████████████████▌                                                | 3707/7473 [00:04<00:03, 1121.56it/s] 51%|█████████████████████████████████████████████████▏                                              | 3831/7473 [00:04<00:03, 1154.72it/s] 53%|██████████████████████████████████████████████████▋                                             | 3948/7473 [00:04<00:03, 1158.84it/s] 55%|████████████████████████████████████████████████████▎                                           | 4074/7473 [00:04<00:02, 1188.72it/s] 56%|█████████████████████████████████████████████████████▉                                          | 4198/7473 [00:04<00:02, 1201.40it/s] 58%|███████████████████████████████████████████████████████▌                                        | 4323/7473 [00:04<00:02, 1213.94it/s] 60%|█████████████████████████████████████████████████████████▏                                      | 4447/7473 [00:04<00:02, 1221.08it/s] 61%|██████████████████████████████████████████████████████████▋                                     | 4572/7473 [00:05<00:02, 1227.12it/s] 63%|████████████████████████████████████████████████████████████▎                                   | 4696/7473 [00:05<00:02, 1228.26it/s] 65%|█████████████████████████████████████████████████████████████▉                                  | 4821/7473 [00:05<00:02, 1232.12it/s] 66%|███████████████████████████████████████████████████████████████▌                                | 4945/7473 [00:05<00:02, 1224.50it/s] 68%|█████████████████████████████████████████████████████████████████                               | 5068/7473 [00:05<00:01, 1225.77it/s] 70%|██████████████████████████████████████████████████████████████████▋                             | 5194/7473 [00:05<00:01, 1235.20it/s] 71%|████████████████████████████████████████████████████████████████████▎                           | 5318/7473 [00:05<00:01, 1193.24it/s] 73%|█████████████████████████████████████████████████████████████████████▉                          | 5444/7473 [00:05<00:01, 1210.94it/s] 74%|████████████████████████████████████████████████████████████████████████▏                        | 5566/7473 [00:05<00:02, 911.40it/s] 76%|█████████████████████████████████████████████████████████████████████████▊                       | 5691/7473 [00:06<00:01, 991.09it/s] 78%|██████████████████████████████████████████████████████████████████████████▋                     | 5813/7473 [00:06<00:01, 1047.79it/s] 79%|████████████████████████████████████████████████████████████████████████████▏                   | 5933/7473 [00:06<00:01, 1086.29it/s] 81%|█████████████████████████████████████████████████████████████████████████████▊                  | 6057/7473 [00:06<00:01, 1126.41it/s] 83%|███████████████████████████████████████████████████████████████████████████████▍                | 6182/7473 [00:06<00:01, 1160.77it/s] 84%|█████████████████████████████████████████████████████████████████████████████████               | 6308/7473 [00:06<00:00, 1187.45it/s] 86%|██████████████████████████████████████████████████████████████████████████████████▋             | 6432/7473 [00:06<00:00, 1200.18it/s] 88%|████████████████████████████████████████████████████████████████████████████████████▏           | 6557/7473 [00:06<00:00, 1214.49it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████▊          | 6681/7473 [00:06<00:00, 1220.16it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████▍        | 6806/7473 [00:06<00:00, 1226.76it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████       | 6930/7473 [00:07<00:00, 1229.51it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████▌     | 7054/7473 [00:07<00:00, 1214.77it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████▏   | 7178/7473 [00:07<00:00, 1222.19it/s] 98%|█████████████████████████████████████████████████████████████████████████████████████████████▊  | 7303/7473 [00:07<00:00, 1228.49it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████▍| 7428/7473 [00:07<00:00, 1232.82it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 7473/7473 [00:07<00:00, 992.10it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.31s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.13s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.29s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.12s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.18s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.08s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.02s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.38s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.48s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.65s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.67s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.82s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.41s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.59s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.72s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.89s/it]
[2023-08-18 05:13:06,665] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
[2023-08-18 05:13:13,771] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-18 05:13:13,772] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-18 05:13:13,772] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-18 05:13:13,772] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-18 05:13:13,772] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-18 05:13:13,772] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f68714b8370>
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f68714b8190>
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-18 05:13:13,773] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-18 05:13:13,774] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-18 05:13:13,774] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-18 05:13:13,774] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-18 05:13:13,774] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-18 05:13:13,774] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-18 05:13:13,774] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-18 05:13:13,774] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-18 05:13:13,774] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-18 05:13:13,774] [INFO] [config.py:1012:print]   train_batch_size ............. 8
[2023-08-18 05:13:13,774] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  2
[2023-08-18 05:13:13,774] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-18 05:13:13,774] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-18 05:13:13,774] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-18 05:13:13,774] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-18 05:13:13,774] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-18 05:13:13,774] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-18 05:13:13,774] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-18 05:13:13,774] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.38289713859558105 seconds
Loading extension module utils...
Time to load utils op: 0.4028310775756836 seconds
Loading extension module utils...
Time to load utils op: 0.4044992923736572 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Loading extension module utils...
Evaluating gsm8k :   0%|                                                                                           | 0/125 [00:00<?, ?it/s]Time to load utils op: 0.304248571395874 seconds
############### Example ###############
### Instruction:Answer the following grade math question.

Input: Fabric is cut to order at what type of seller? Choices:  A: curtains B: tailor shop C: clothing store D: sewing room E: hardware store
Output: 1. The question is asking where fabric is cut to order. This means we're looking for a place where fabric is customized or modified based on specific customer needs.
2. Let's go through the options:
   A: curtains - While fabric is used to make curtains, a place selling curtains typically does not cut fabric to order. So, this isn't the right answer.
   B: tailor shop - This could be the right answer. Tailor shops typically offer services where they cut and sew fabric based on specific customer measurements and requests.
   C: clothing store - Clothing stores typically sell pre-made clothing. They usually do not offer services to cut fabric to order. So, this isn't the right answer.
   D: sewing room - This is a location, not a type of seller. While fabric is often cut in sewing rooms, it does not specify a specific type of seller. So, it's not the right answer.
   E: hardware store - Hardware stores generally sell tools and materials for home repair and improvement, not fabric. So, this isn't the right answer.
3. Therefore, based on the analysis of each option, the answer is B: tailor shop, as this is the type of seller that offers services to cut fabric to order.
So the final answer is B: tailor shop

Input:Natalia sold clips to 48 of her friends in April, and then she sold half as many clips in May. How many clips did Natalia sell altogether in April and May?
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o1-tcommonsenseqa-s10-rTrue
Evaluating gsm8k :   1%|▋                                                                                  | 1/125 [00:28<58:37, 28.36s/it]Evaluating gsm8k :   2%|█▎                                                                                 | 2/125 [00:43<41:42, 20.35s/it]Evaluating gsm8k :   2%|█▉                                                                                 | 3/125 [01:11<48:36, 23.90s/it]Evaluating gsm8k :   3%|██▋                                                                                | 4/125 [01:24<39:59, 19.83s/it]Evaluating gsm8k :   4%|███▎                                                                               | 5/125 [01:52<45:30, 22.75s/it]Evaluating gsm8k :   5%|███▉                                                                               | 6/125 [02:04<37:35, 18.95s/it]Evaluating gsm8k :   6%|████▋                                                                              | 7/125 [02:15<31:57, 16.25s/it]Evaluating gsm8k :   6%|█████▎                                                                             | 8/125 [02:42<38:50, 19.92s/it]Evaluating gsm8k :   7%|█████▉                                                                             | 9/125 [02:52<32:36, 16.86s/it]Evaluating gsm8k :   8%|██████▌                                                                           | 10/125 [03:14<35:16, 18.41s/it]Evaluating gsm8k :   9%|███████▏                                                                          | 11/125 [03:24<29:59, 15.78s/it]Evaluating gsm8k :  10%|███████▊                                                                          | 12/125 [03:52<36:25, 19.34s/it]Evaluating gsm8k :  10%|████████▌                                                                         | 13/125 [04:19<40:40, 21.79s/it]Evaluating gsm8k :  11%|█████████▏                                                                        | 14/125 [04:44<41:59, 22.70s/it]Evaluating gsm8k :  12%|█████████▊                                                                        | 15/125 [04:53<34:05, 18.60s/it]Evaluating gsm8k :  13%|██████████▍                                                                       | 16/125 [05:04<29:56, 16.48s/it]Evaluating gsm8k :  14%|███████████▏                                                                      | 17/125 [05:32<35:47, 19.89s/it]Evaluating gsm8k :  14%|███████████▊                                                                      | 18/125 [06:00<39:45, 22.29s/it]Evaluating gsm8k :  15%|████████████▍                                                                     | 19/125 [06:28<42:03, 23.81s/it]Evaluating gsm8k :  16%|█████████████                                                                     | 20/125 [06:55<43:33, 24.89s/it]Evaluating gsm8k :  17%|█████████████▊                                                                    | 21/125 [07:23<44:35, 25.73s/it]Evaluating gsm8k :  18%|██████████████▍                                                                   | 22/125 [07:50<45:10, 26.31s/it]Evaluating gsm8k :  18%|███████████████                                                                   | 23/125 [08:18<45:26, 26.73s/it]Evaluating gsm8k :  19%|███████████████▋                                                                  | 24/125 [08:46<45:27, 27.00s/it]Evaluating gsm8k :  20%|████████████████▍                                                                 | 25/125 [08:57<37:14, 22.35s/it]Evaluating gsm8k :  21%|█████████████████                                                                 | 26/125 [09:15<34:36, 20.98s/it]Evaluating gsm8k :  22%|█████████████████▋                                                                | 27/125 [09:43<37:35, 23.02s/it]Evaluating gsm8k :  22%|██████████████████▎                                                               | 28/125 [10:10<39:21, 24.35s/it]Evaluating gsm8k :  23%|███████████████████                                                               | 29/125 [10:38<40:25, 25.26s/it]Evaluating gsm8k :  24%|███████████████████▋                                                              | 30/125 [11:05<41:10, 26.00s/it]Evaluating gsm8k :  25%|████████████████████▎                                                             | 31/125 [11:33<41:27, 26.46s/it]Evaluating gsm8k :  26%|████████████████████▉                                                             | 32/125 [12:01<41:44, 26.93s/it]Evaluating gsm8k :  26%|█████████████████████▋                                                            | 33/125 [12:18<36:46, 23.99s/it]Evaluating gsm8k :  27%|██████████████████████▎                                                           | 34/125 [12:27<29:36, 19.52s/it]Evaluating gsm8k :  28%|██████████████████████▉                                                           | 35/125 [12:40<26:23, 17.59s/it]Evaluating gsm8k :  29%|███████████████████████▌                                                          | 36/125 [13:08<30:46, 20.75s/it]Evaluating gsm8k :  30%|████████████████████████▎                                                         | 37/125 [13:36<33:23, 22.77s/it]Evaluating gsm8k :  30%|████████████████████████▉                                                         | 38/125 [14:03<35:07, 24.23s/it]Evaluating gsm8k :  31%|█████████████████████████▌                                                        | 39/125 [14:24<33:15, 23.20s/it]Evaluating gsm8k :  32%|██████████████████████████▏                                                       | 40/125 [14:52<34:44, 24.52s/it]Evaluating gsm8k :  33%|██████████████████████████▉                                                       | 41/125 [15:02<28:22, 20.26s/it]Evaluating gsm8k :  34%|███████████████████████████▌                                                      | 42/125 [15:30<31:22, 22.68s/it]Evaluating gsm8k :  34%|████████████████████████████▏                                                     | 43/125 [15:44<27:24, 20.05s/it]Evaluating gsm8k :  35%|████████████████████████████▊                                                     | 44/125 [15:54<22:58, 17.02s/it]Evaluating gsm8k :  36%|█████████████████████████████▌                                                    | 45/125 [16:18<25:26, 19.08s/it]Evaluating gsm8k :  37%|██████████████████████████████▏                                                   | 46/125 [16:42<27:08, 20.62s/it]Evaluating gsm8k :  38%|██████████████████████████████▊                                                   | 47/125 [16:50<21:50, 16.80s/it]Evaluating gsm8k :  38%|███████████████████████████████▍                                                  | 48/125 [17:18<25:43, 20.04s/it]Evaluating gsm8k :  39%|████████████████████████████████▏                                                 | 49/125 [17:39<25:46, 20.35s/it]Evaluating gsm8k :  40%|████████████████████████████████▊                                                 | 50/125 [18:06<28:06, 22.49s/it]Evaluating gsm8k :  41%|█████████████████████████████████▍                                                | 51/125 [18:33<29:10, 23.66s/it]Evaluating gsm8k :  42%|██████████████████████████████████                                                | 52/125 [19:00<30:08, 24.78s/it]Evaluating gsm8k :  42%|██████████████████████████████████▊                                               | 53/125 [19:28<30:53, 25.74s/it]Evaluating gsm8k :  43%|███████████████████████████████████▍                                              | 54/125 [19:56<31:22, 26.51s/it]Evaluating gsm8k :  44%|████████████████████████████████████                                              | 55/125 [20:24<31:19, 26.85s/it]Evaluating gsm8k :  45%|████████████████████████████████████▋                                             | 56/125 [20:48<29:48, 25.92s/it]Evaluating gsm8k :  46%|█████████████████████████████████████▍                                            | 57/125 [21:16<30:09, 26.61s/it]Evaluating gsm8k :  46%|██████████████████████████████████████                                            | 58/125 [21:43<29:56, 26.81s/it]Evaluating gsm8k :  47%|██████████████████████████████████████▋                                           | 59/125 [22:03<27:02, 24.58s/it]Evaluating gsm8k :  48%|███████████████████████████████████████▎                                          | 60/125 [22:16<22:58, 21.21s/it]Evaluating gsm8k :  49%|████████████████████████████████████████                                          | 61/125 [22:44<24:45, 23.22s/it]Evaluating gsm8k :  50%|████████████████████████████████████████▋                                         | 62/125 [23:12<25:45, 24.53s/it]Evaluating gsm8k :  50%|█████████████████████████████████████████▎                                        | 63/125 [23:27<22:24, 21.68s/it]Evaluating gsm8k :  51%|█████████████████████████████████████████▉                                        | 64/125 [23:54<23:49, 23.43s/it]Evaluating gsm8k :  52%|██████████████████████████████████████████▋                                       | 65/125 [24:21<24:34, 24.57s/it]Evaluating gsm8k :  53%|███████████████████████████████████████████▎                                      | 66/125 [24:35<21:00, 21.37s/it]Evaluating gsm8k :  54%|███████████████████████████████████████████▉                                      | 67/125 [24:56<20:30, 21.21s/it]Evaluating gsm8k :  54%|████████████████████████████████████████████▌                                     | 68/125 [25:24<22:00, 23.16s/it]Evaluating gsm8k :  55%|█████████████████████████████████████████████▎                                    | 69/125 [25:45<21:11, 22.70s/it]Evaluating gsm8k :  56%|█████████████████████████████████████████████▉                                    | 70/125 [25:59<18:22, 20.04s/it]Evaluating gsm8k :  57%|██████████████████████████████████████████████▌                                   | 71/125 [26:09<15:20, 17.04s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▏                                  | 72/125 [26:29<15:46, 17.87s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▉                                  | 73/125 [26:57<18:05, 20.88s/it]Evaluating gsm8k :  59%|████████████████████████████████████████████████▌                                 | 74/125 [27:16<17:12, 20.24s/it]Evaluating gsm8k :  60%|█████████████████████████████████████████████████▏                                | 75/125 [27:39<17:32, 21.06s/it]Evaluating gsm8k :  61%|█████████████████████████████████████████████████▊                                | 76/125 [27:53<15:27, 18.93s/it]Evaluating gsm8k :  62%|██████████████████████████████████████████████████▌                               | 77/125 [28:20<17:15, 21.57s/it]Evaluating gsm8k :  62%|███████████████████████████████████████████████████▏                              | 78/125 [28:43<17:11, 21.94s/it]Evaluating gsm8k :  63%|███████████████████████████████████████████████████▊                              | 79/125 [29:05<16:44, 21.84s/it]Evaluating gsm8k :  64%|████████████████████████████████████████████████████▍                             | 80/125 [29:33<17:43, 23.63s/it]Evaluating gsm8k :  65%|█████████████████████████████████████████████████████▏                            | 81/125 [29:45<14:53, 20.30s/it]Evaluating gsm8k :  66%|█████████████████████████████████████████████████████▊                            | 82/125 [30:13<16:07, 22.50s/it]Evaluating gsm8k :  66%|██████████████████████████████████████████████████████▍                           | 83/125 [30:28<14:10, 20.25s/it]Evaluating gsm8k :  67%|███████████████████████████████████████████████████████                           | 84/125 [30:55<15:19, 22.44s/it]Evaluating gsm8k :  68%|███████████████████████████████████████████████████████▊                          | 85/125 [31:24<16:08, 24.22s/it]Evaluating gsm8k :  69%|████████████████████████████████████████████████████████▍                         | 86/125 [31:37<13:38, 20.99s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████                         | 87/125 [32:05<14:32, 22.96s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████▋                        | 88/125 [32:10<10:52, 17.63s/it]Evaluating gsm8k :  71%|██████████████████████████████████████████████████████████▍                       | 89/125 [32:38<12:26, 20.75s/it]Evaluating gsm8k :  72%|███████████████████████████████████████████████████████████                       | 90/125 [32:58<11:58, 20.52s/it]Evaluating gsm8k :  73%|███████████████████████████████████████████████████████████▋                      | 91/125 [33:15<10:59, 19.40s/it]Evaluating gsm8k :  74%|████████████████████████████████████████████████████████████▎                     | 92/125 [33:42<12:00, 21.82s/it]Evaluating gsm8k :  74%|█████████████████████████████████████████████████████████████                     | 93/125 [34:10<12:32, 23.50s/it]Evaluating gsm8k :  75%|█████████████████████████████████████████████████████████████▋                    | 94/125 [34:37<12:44, 24.67s/it]Evaluating gsm8k :  76%|██████████████████████████████████████████████████████████████▎                   | 95/125 [34:55<11:18, 22.63s/it]Evaluating gsm8k :  77%|██████████████████████████████████████████████████████████████▉                   | 96/125 [35:22<11:36, 24.01s/it]Evaluating gsm8k :  78%|███████████████████████████████████████████████████████████████▋                  | 97/125 [35:50<11:41, 25.07s/it]Evaluating gsm8k :  78%|████████████████████████████████████████████████████████████████▎                 | 98/125 [36:07<10:16, 22.85s/it]Evaluating gsm8k :  79%|████████████████████████████████████████████████████████████████▉                 | 99/125 [36:36<10:36, 24.49s/it]Evaluating gsm8k :  80%|████████████████████████████████████████████████████████████████▊                | 100/125 [36:47<08:31, 20.48s/it]Evaluating gsm8k :  81%|█████████████████████████████████████████████████████████████████▍               | 101/125 [36:56<06:48, 17.02s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████               | 102/125 [37:23<07:42, 20.12s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████▋              | 103/125 [37:50<08:10, 22.29s/it]Evaluating gsm8k :  83%|███████████████████████████████████████████████████████████████████▍             | 104/125 [37:55<05:54, 16.87s/it]Evaluating gsm8k :  84%|████████████████████████████████████████████████████████████████████             | 105/125 [38:15<05:56, 17.82s/it]Evaluating gsm8k :  85%|████████████████████████████████████████████████████████████████████▋            | 106/125 [38:27<05:06, 16.13s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▎           | 107/125 [38:47<05:10, 17.26s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▉           | 108/125 [38:56<04:13, 14.93s/it]Evaluating gsm8k :  87%|██████████████████████████████████████████████████████████████████████▋          | 109/125 [39:24<04:59, 18.69s/it]Evaluating gsm8k :  88%|███████████████████████████████████████████████████████████████████████▎         | 110/125 [39:52<05:24, 21.60s/it]Evaluating gsm8k :  89%|███████████████████████████████████████████████████████████████████████▉         | 111/125 [40:17<05:17, 22.65s/it]Evaluating gsm8k :  90%|████████████████████████████████████████████████████████████████████████▌        | 112/125 [40:45<05:14, 24.18s/it]Evaluating gsm8k :  90%|█████████████████████████████████████████████████████████████████████████▏       | 113/125 [40:47<03:31, 17.62s/it]Evaluating gsm8k :  91%|█████████████████████████████████████████████████████████████████████████▊       | 114/125 [40:55<02:40, 14.60s/it]Evaluating gsm8k :  92%|██████████████████████████████████████████████████████████████████████████▌      | 115/125 [41:22<03:04, 18.49s/it]Evaluating gsm8k :  93%|███████████████████████████████████████████████████████████████████████████▏     | 116/125 [41:50<03:11, 21.30s/it]Evaluating gsm8k :  94%|███████████████████████████████████████████████████████████████████████████▊     | 117/125 [42:07<02:39, 19.88s/it]Evaluating gsm8k :  94%|████████████████████████████████████████████████████████████████████████████▍    | 118/125 [42:31<02:27, 21.07s/it]Evaluating gsm8k :  95%|█████████████████████████████████████████████████████████████████████████████    | 119/125 [42:58<02:18, 23.06s/it]Evaluating gsm8k :  96%|█████████████████████████████████████████████████████████████████████████████▊   | 120/125 [43:27<02:03, 24.64s/it]Evaluating gsm8k :  97%|██████████████████████████████████████████████████████████████████████████████▍  | 121/125 [43:48<01:34, 23.59s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████  | 122/125 [44:01<01:01, 20.50s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████▋ | 123/125 [44:29<00:45, 22.64s/it]Evaluating gsm8k :  99%|████████████████████████████████████████████████████████████████████████████████▎| 124/125 [44:57<00:24, 24.40s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [45:15<00:00, 22.44s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [45:15<00:00, 21.73s/it]
name: gsm8k | {'exact_match': 0.0, 'rougeL': 0.3683} | lm_loss 10.9626 | avg. gen lenth: 300.216
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name gsm8k --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name commonsenseqa --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 2 --data-dir /scratch/ylu130/processed_data/gsm8k/out-domain/o2-tcommonsenseqa-s10-rTrue --seed 10 --max-prompt-length 2048 --rationales --num-out-domain 2
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-18 06:00:36,067] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... gsm8k
  data_dir ..................... /scratch/ylu130/processed_data/gsm8k/out-domain/o2-tcommonsenseqa-s10-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 2
  out_domain_data_name ......... commonsenseqa
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o2-tcommonsenseqa-s10-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 2
  clip_grad .................... 1.0
  seed ......................... 10
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                                             | 0/7473 [00:00<?, ?it/s]  1%|▊                                                                                                  | 64/7473 [00:00<00:11, 633.64it/s]  2%|█▋                                                                                                | 129/7473 [00:00<00:11, 639.65it/s]  3%|██▌                                                                                               | 195/7473 [00:00<00:11, 644.07it/s]  3%|███▍                                                                                              | 260/7473 [00:00<00:11, 643.59it/s]  4%|████▎                                                                                             | 326/7473 [00:00<00:11, 647.19it/s]  5%|█████▏                                                                                            | 391/7473 [00:00<00:10, 646.79it/s]  6%|█████▉                                                                                            | 456/7473 [00:00<00:10, 645.15it/s]  7%|██████▊                                                                                           | 521/7473 [00:00<00:10, 642.94it/s]  8%|███████▋                                                                                          | 586/7473 [00:00<00:10, 632.73it/s]  9%|████████▌                                                                                         | 650/7473 [00:01<00:10, 634.80it/s] 10%|█████████▍                                                                                        | 716/7473 [00:01<00:10, 640.11it/s] 10%|██████████▎                                                                                       | 782/7473 [00:01<00:10, 643.09it/s] 11%|███████████                                                                                       | 847/7473 [00:01<00:10, 643.24it/s] 12%|███████████▉                                                                                      | 912/7473 [00:01<00:10, 645.18it/s] 13%|████████████▊                                                                                     | 977/7473 [00:01<00:10, 646.54it/s] 14%|█████████████▌                                                                                   | 1042/7473 [00:01<00:09, 646.53it/s] 15%|██████████████▍                                                                                  | 1108/7473 [00:01<00:09, 648.03it/s] 16%|███████████████▏                                                                                 | 1173/7473 [00:01<00:09, 645.39it/s] 17%|████████████████                                                                                 | 1238/7473 [00:01<00:09, 641.96it/s] 17%|████████████████▉                                                                                | 1303/7473 [00:02<00:09, 642.60it/s] 18%|█████████████████▊                                                                               | 1368/7473 [00:02<00:09, 644.77it/s] 19%|██████████████████▌                                                                              | 1433/7473 [00:02<00:09, 641.52it/s] 20%|███████████████████▍                                                                             | 1499/7473 [00:02<00:09, 645.12it/s] 21%|████████████████████▎                                                                            | 1564/7473 [00:02<00:09, 644.64it/s] 22%|█████████████████████▏                                                                           | 1629/7473 [00:02<00:09, 642.52it/s] 23%|██████████████████████                                                                           | 1695/7473 [00:02<00:08, 645.28it/s] 24%|██████████████████████▊                                                                          | 1760/7473 [00:02<00:08, 646.60it/s] 25%|███████████████████████▉                                                                         | 1842/7473 [00:02<00:08, 696.25it/s] 26%|█████████████████████████▏                                                                       | 1940/7473 [00:02<00:07, 779.08it/s] 27%|██████████████████████████▍                                                                      | 2039/7473 [00:03<00:06, 841.16it/s] 29%|███████████████████████████▋                                                                     | 2137/7473 [00:03<00:06, 880.41it/s] 30%|█████████████████████████████                                                                    | 2237/7473 [00:03<00:05, 915.24it/s] 31%|██████████████████████████████▎                                                                  | 2336/7473 [00:03<00:05, 935.85it/s] 33%|███████████████████████████████▌                                                                 | 2436/7473 [00:03<00:05, 953.22it/s] 34%|████████████████████████████████▊                                                                | 2532/7473 [00:03<00:05, 929.20it/s] 35%|██████████████████████████████████▏                                                              | 2631/7473 [00:03<00:05, 946.43it/s] 37%|███████████████████████████████████▍                                                             | 2730/7473 [00:03<00:04, 957.86it/s] 38%|████████████████████████████████████▋                                                            | 2829/7473 [00:03<00:04, 967.20it/s] 39%|██████████████████████████████████████                                                           | 2929/7473 [00:03<00:04, 976.08it/s] 41%|███████████████████████████████████████▎                                                         | 3028/7473 [00:04<00:04, 979.62it/s] 42%|████████████████████████████████████████▌                                                        | 3127/7473 [00:04<00:04, 981.44it/s] 43%|█████████████████████████████████████████▊                                                       | 3226/7473 [00:04<00:04, 980.66it/s] 44%|███████████████████████████████████████████▏                                                     | 3325/7473 [00:04<00:04, 982.71it/s] 46%|████████████████████████████████████████████▍                                                    | 3424/7473 [00:04<00:04, 981.84it/s] 47%|█████████████████████████████████████████████▋                                                   | 3523/7473 [00:04<00:04, 981.11it/s] 48%|███████████████████████████████████████████████                                                  | 3623/7473 [00:04<00:03, 984.78it/s] 50%|████████████████████████████████████████████████▎                                                | 3722/7473 [00:04<00:03, 980.81it/s] 51%|█████████████████████████████████████████████████▌                                               | 3821/7473 [00:04<00:03, 983.49it/s] 52%|██████████████████████████████████████████████████▉                                              | 3920/7473 [00:04<00:03, 979.69it/s] 54%|████████████████████████████████████████████████████▏                                            | 4020/7473 [00:05<00:03, 983.17it/s] 55%|█████████████████████████████████████████████████████▍                                           | 4119/7473 [00:05<00:03, 981.68it/s] 56%|██████████████████████████████████████████████████████▋                                          | 4218/7473 [00:05<00:03, 982.14it/s] 58%|████████████████████████████████████████████████████████                                         | 4317/7473 [00:05<00:03, 983.87it/s] 59%|█████████████████████████████████████████████████████████▎                                       | 4416/7473 [00:05<00:03, 984.38it/s] 60%|██████████████████████████████████████████████████████████▌                                      | 4515/7473 [00:05<00:03, 984.13it/s] 62%|███████████████████████████████████████████████████████████▉                                     | 4614/7473 [00:05<00:02, 984.38it/s] 63%|█████████████████████████████████████████████████████████████▏                                   | 4713/7473 [00:05<00:02, 981.44it/s] 64%|██████████████████████████████████████████████████████████████▍                                  | 4812/7473 [00:05<00:02, 974.94it/s] 66%|███████████████████████████████████████████████████████████████▋                                 | 4911/7473 [00:05<00:02, 979.20it/s] 67%|█████████████████████████████████████████████████████████████████                                | 5010/7473 [00:06<00:02, 980.88it/s] 68%|██████████████████████████████████████████████████████████████████▎                              | 5109/7473 [00:06<00:02, 980.38it/s] 70%|███████████████████████████████████████████████████████████████████▌                             | 5208/7473 [00:06<00:02, 981.96it/s] 71%|████████████████████████████████████████████████████████████████████▉                            | 5307/7473 [00:06<00:02, 953.04it/s] 72%|██████████████████████████████████████████████████████████████████████▏                          | 5406/7473 [00:06<00:02, 962.73it/s] 74%|███████████████████████████████████████████████████████████████████████▍                         | 5503/7473 [00:06<00:02, 726.12it/s] 75%|████████████████████████████████████████████████████████████████████████▋                        | 5602/7473 [00:06<00:02, 788.41it/s] 76%|█████████████████████████████████████████████████████████████████████████▉                       | 5701/7473 [00:06<00:02, 838.41it/s] 78%|███████████████████████████████████████████████████████████████████████████▎                     | 5800/7473 [00:06<00:01, 878.71it/s] 79%|████████████████████████████████████████████████████████████████████████████▌                    | 5899/7473 [00:07<00:01, 907.89it/s] 80%|█████████████████████████████████████████████████████████████████████████████▊                   | 5994/7473 [00:07<00:01, 916.77it/s] 82%|███████████████████████████████████████████████████████████████████████████████                  | 6094/7473 [00:07<00:01, 938.11it/s] 83%|████████████████████████████████████████████████████████████████████████████████▎                | 6192/7473 [00:07<00:01, 950.17it/s] 84%|█████████████████████████████████████████████████████████████████████████████████▋               | 6290/7473 [00:07<00:01, 958.41it/s] 85%|██████████████████████████████████████████████████████████████████████████████████▉              | 6389/7473 [00:07<00:01, 966.29it/s] 87%|████████████████████████████████████████████████████████████████████████████████████▏            | 6488/7473 [00:07<00:01, 972.41it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████▍           | 6586/7473 [00:07<00:00, 972.84it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████▊          | 6685/7473 [00:07<00:00, 976.01it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████         | 6784/7473 [00:07<00:00, 978.91it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████▎       | 6883/7473 [00:08<00:00, 978.50it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████▋      | 6982/7473 [00:08<00:00, 980.88it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████▉     | 7081/7473 [00:08<00:00, 977.61it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████▏   | 7179/7473 [00:08<00:00, 977.25it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████▍  | 7277/7473 [00:08<00:00, 968.25it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████▋ | 7376/7473 [00:08<00:00, 972.26it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 7473/7473 [00:08<00:00, 858.32it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.16s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.06s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.37s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.49s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.00s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.13s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.34s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.35s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.48s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.63s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.47s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.64s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.70s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.88s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.73s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.91s/it]
[2023-08-18 06:01:37,010] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
[2023-08-18 06:01:44,742] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-18 06:01:44,743] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-18 06:01:44,743] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-18 06:01:44,743] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-18 06:01:44,743] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-18 06:01:44,743] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-18 06:01:44,744] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-18 06:01:44,744] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-18 06:01:44,744] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-18 06:01:44,744] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-18 06:01:44,744] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-18 06:01:44,744] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f0f69db3370>
[2023-08-18 06:01:44,744] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-18 06:01:44,744] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-18 06:01:44,744] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-18 06:01:44,744] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-18 06:01:44,744] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-18 06:01:44,744] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-18 06:01:44,744] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-18 06:01:44,744] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-18 06:01:44,744] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-18 06:01:44,744] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-18 06:01:44,744] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-18 06:01:44,744] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-18 06:01:44,744] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-18 06:01:44,744] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-18 06:01:44,744] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-18 06:01:44,744] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-18 06:01:44,744] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-18 06:01:44,744] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-18 06:01:44,744] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-18 06:01:44,744] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-18 06:01:44,744] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-18 06:01:44,744] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-18 06:01:44,744] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-18 06:01:44,744] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-18 06:01:44,744] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-18 06:01:44,744] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-18 06:01:44,744] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-18 06:01:44,744] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-18 06:01:44,744] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-18 06:01:44,744] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-18 06:01:44,744] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-18 06:01:44,744] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-18 06:01:44,745] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f0f69db3190>
[2023-08-18 06:01:44,745] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-18 06:01:44,745] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-18 06:01:44,745] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-18 06:01:44,745] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-18 06:01:44,745] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-18 06:01:44,745] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-18 06:01:44,745] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-18 06:01:44,745] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-18 06:01:44,745] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-18 06:01:44,745] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-18 06:01:44,745] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-18 06:01:44,745] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-18 06:01:44,745] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-18 06:01:44,745] [INFO] [config.py:1012:print]   train_batch_size ............. 8
[2023-08-18 06:01:44,745] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  2
[2023-08-18 06:01:44,745] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-18 06:01:44,745] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-18 06:01:44,745] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-18 06:01:44,745] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-18 06:01:44,745] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-18 06:01:44,745] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-18 06:01:44,745] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-18 06:01:44,745] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.3844144344329834 seconds
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.3043966293334961 seconds
Time to load utils op: 0.4045674800872803 seconds
Loading extension module utils...
Time to load utils op: 0.4044809341430664 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating gsm8k :   0%|                                                                                           | 0/125 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following grade math question.

Input: Fabric is cut to order at what type of seller? Choices:  A: curtains B: tailor shop C: clothing store D: sewing room E: hardware store
Output: 1. Firstly, we need to understand what each choice means. 
2. A curtain is an item, not a place where you can order a fabric cut. 
3. A clothing store is a place that mostly sells already manufactured clothing, rather than creating custom clothing according to fabric cuts. 
4. A sewing room can be a place where fabric is cut, but it is more of a space for private or personal use, not typically a place where customers go to order fabric cuts.
5. A hardware store primarily sells hardware materials for home improvements and construction, not dealing with fabric.
6. A tailor shop is a place where clothing is made or altered, requiring fabrics to be measured and cut according to the customer's requirements and preferences. 
7. Therefore, the answer is B: tailor shop because this is the most likely place where fabric is cut to order.
So the final answer is B: tailor shop

Input: Where are you if your reading magazines while waiting for a vehicle on rails? Choices:  A: vegetables B: market C: doctor D: train station E: bookstore
Output: 1. The question asks about a location where one might wait for a vehicle on rails. 
2. Vehicles on rails are typically forms of public transportation, such as trains or trams. 
3. Among the options presented, the place where one typically waits for a train is a train station. 
4. Although one might potentially wait for a tram at a market, the mention of reading magazines suggests an extended wait, more typical of waiting for a train at a station than for a tram at a stop.
5. Therefore, the answer is D: train station.
So the final answer is D: train station

Input:Natalia sold clips to 48 of her friends in April, and then she sold half as many clips in May. How many clips did Natalia sell altogether in April and May?
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o2-tcommonsenseqa-s10-rTrue
Evaluating gsm8k :   1%|▋                                                                                  | 1/125 [00:28<58:39, 28.38s/it]Evaluating gsm8k :   2%|█▎                                                                                 | 2/125 [00:55<56:22, 27.50s/it]Evaluating gsm8k :   2%|█▉                                                                                 | 3/125 [01:22<55:40, 27.38s/it]Evaluating gsm8k :   3%|██▋                                                                                | 4/125 [01:49<55:08, 27.34s/it]Evaluating gsm8k :   4%|███▎                                                                               | 5/125 [01:57<40:16, 20.14s/it]Evaluating gsm8k :   5%|███▉                                                                               | 6/125 [02:24<44:52, 22.63s/it]Evaluating gsm8k :   6%|████▋                                                                              | 7/125 [02:51<47:13, 24.01s/it]Evaluating gsm8k :   6%|█████▎                                                                             | 8/125 [03:18<48:47, 25.02s/it]Evaluating gsm8k :   7%|█████▉                                                                             | 9/125 [03:38<45:26, 23.50s/it]Evaluating gsm8k :   8%|██████▌                                                                           | 10/125 [04:05<47:02, 24.55s/it]Evaluating gsm8k :   9%|███████▏                                                                          | 11/125 [04:28<45:43, 24.07s/it]Evaluating gsm8k :  10%|███████▊                                                                          | 12/125 [04:45<41:02, 21.79s/it]Evaluating gsm8k :  10%|████████▌                                                                         | 13/125 [05:04<39:03, 20.93s/it]Evaluating gsm8k :  11%|█████████▏                                                                        | 14/125 [05:31<42:14, 22.84s/it]Evaluating gsm8k :  12%|█████████▊                                                                        | 15/125 [05:58<44:06, 24.06s/it]Evaluating gsm8k :  13%|██████████▍                                                                       | 16/125 [06:08<35:54, 19.77s/it]Evaluating gsm8k :  14%|███████████▏                                                                      | 17/125 [06:35<39:28, 21.93s/it]Evaluating gsm8k :  14%|███████████▊                                                                      | 18/125 [07:01<41:45, 23.42s/it]Evaluating gsm8k :  15%|████████████▍                                                                     | 19/125 [07:22<39:54, 22.59s/it]Evaluating gsm8k :  16%|█████████████                                                                     | 20/125 [07:37<35:14, 20.14s/it]Evaluating gsm8k :  17%|█████████████▊                                                                    | 21/125 [07:49<31:07, 17.96s/it]Evaluating gsm8k :  18%|██████████████▍                                                                   | 22/125 [08:00<27:11, 15.84s/it]Evaluating gsm8k :  18%|███████████████                                                                   | 23/125 [08:05<21:26, 12.62s/it]Evaluating gsm8k :  19%|███████████████▋                                                                  | 24/125 [08:28<26:08, 15.53s/it]Evaluating gsm8k :  20%|████████████████▍                                                                 | 25/125 [08:55<31:45, 19.05s/it]Evaluating gsm8k :  21%|█████████████████                                                                 | 26/125 [09:06<27:23, 16.60s/it]Evaluating gsm8k :  22%|█████████████████▋                                                                | 27/125 [09:11<21:16, 13.02s/it]Evaluating gsm8k :  22%|██████████████████▎                                                               | 28/125 [09:27<22:27, 13.89s/it]Evaluating gsm8k :  23%|███████████████████                                                               | 29/125 [09:54<28:41, 17.93s/it]Evaluating gsm8k :  24%|███████████████████▋                                                              | 30/125 [10:07<26:19, 16.63s/it]Evaluating gsm8k :  25%|████████████████████▎                                                             | 31/125 [10:35<31:04, 19.83s/it]Evaluating gsm8k :  26%|████████████████████▉                                                             | 32/125 [10:43<25:26, 16.41s/it]Evaluating gsm8k :  26%|█████████████████████▋                                                            | 33/125 [10:50<20:57, 13.67s/it]Evaluating gsm8k :  27%|██████████████████████▎                                                           | 34/125 [11:17<26:47, 17.67s/it]Evaluating gsm8k :  28%|██████████████████████▉                                                           | 35/125 [11:25<22:02, 14.69s/it]Evaluating gsm8k :  29%|███████████████████████▌                                                          | 36/125 [11:35<19:48, 13.35s/it]Evaluating gsm8k :  30%|████████████████████████▎                                                         | 37/125 [11:47<18:34, 12.67s/it]Evaluating gsm8k :  30%|████████████████████████▉                                                         | 38/125 [11:58<17:51, 12.31s/it]Evaluating gsm8k :  31%|█████████████████████████▌                                                        | 39/125 [12:25<23:55, 16.69s/it]Evaluating gsm8k :  32%|██████████████████████████▏                                                       | 40/125 [12:41<23:20, 16.48s/it]Evaluating gsm8k :  33%|██████████████████████████▉                                                       | 41/125 [13:08<27:24, 19.58s/it]Evaluating gsm8k :  34%|███████████████████████████▌                                                      | 42/125 [13:26<26:38, 19.26s/it]Evaluating gsm8k :  34%|████████████████████████████▏                                                     | 43/125 [13:34<21:42, 15.89s/it]Evaluating gsm8k :  35%|████████████████████████████▊                                                     | 44/125 [13:40<17:16, 12.80s/it]Evaluating gsm8k :  36%|█████████████████████████████▌                                                    | 45/125 [13:56<18:24, 13.81s/it]Evaluating gsm8k :  37%|██████████████████████████████▏                                                   | 46/125 [14:23<23:22, 17.75s/it]Evaluating gsm8k :  38%|██████████████████████████████▊                                                   | 47/125 [14:46<25:02, 19.26s/it]Evaluating gsm8k :  38%|███████████████████████████████▍                                                  | 48/125 [15:13<27:41, 21.57s/it]Evaluating gsm8k :  39%|████████████████████████████████▏                                                 | 49/125 [15:39<29:18, 23.14s/it]Evaluating gsm8k :  40%|████████████████████████████████▊                                                 | 50/125 [16:07<30:30, 24.41s/it]Evaluating gsm8k :  41%|█████████████████████████████████▍                                                | 51/125 [16:23<27:00, 21.90s/it]Evaluating gsm8k :  42%|██████████████████████████████████                                                | 52/125 [16:43<25:54, 21.29s/it]Evaluating gsm8k :  42%|██████████████████████████████████▊                                               | 53/125 [16:57<22:56, 19.12s/it]Evaluating gsm8k :  43%|███████████████████████████████████▍                                              | 54/125 [17:24<25:34, 21.61s/it]Evaluating gsm8k :  44%|████████████████████████████████████                                              | 55/125 [17:51<27:02, 23.17s/it]Evaluating gsm8k :  45%|████████████████████████████████████▋                                             | 56/125 [18:12<25:56, 22.55s/it]Evaluating gsm8k :  46%|█████████████████████████████████████▍                                            | 57/125 [18:39<27:10, 23.98s/it]Evaluating gsm8k :  46%|██████████████████████████████████████                                            | 58/125 [19:06<27:39, 24.77s/it]Evaluating gsm8k :  47%|██████████████████████████████████████▋                                           | 59/125 [19:23<24:42, 22.47s/it]Evaluating gsm8k :  48%|███████████████████████████████████████▎                                          | 60/125 [19:50<25:43, 23.74s/it]Evaluating gsm8k :  49%|████████████████████████████████████████                                          | 61/125 [20:08<23:25, 21.96s/it]Evaluating gsm8k :  50%|████████████████████████████████████████▋                                         | 62/125 [20:35<24:48, 23.63s/it]Evaluating gsm8k :  50%|█████████████████████████████████████████▎                                        | 63/125 [20:53<22:26, 21.72s/it]Evaluating gsm8k :  51%|█████████████████████████████████████████▉                                        | 64/125 [21:20<23:44, 23.35s/it]Evaluating gsm8k :  52%|██████████████████████████████████████████▋                                       | 65/125 [21:38<21:55, 21.93s/it]Evaluating gsm8k :  53%|███████████████████████████████████████████▎                                      | 66/125 [22:03<22:25, 22.81s/it]Evaluating gsm8k :  54%|███████████████████████████████████████████▉                                      | 67/125 [22:15<18:46, 19.43s/it]Evaluating gsm8k :  54%|████████████████████████████████████████████▌                                     | 68/125 [22:25<15:59, 16.84s/it]Evaluating gsm8k :  55%|█████████████████████████████████████████████▎                                    | 69/125 [22:51<18:00, 19.30s/it]Evaluating gsm8k :  56%|█████████████████████████████████████████████▉                                    | 70/125 [22:58<14:18, 15.61s/it]Evaluating gsm8k :  57%|██████████████████████████████████████████████▌                                   | 71/125 [23:07<12:21, 13.74s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▏                                  | 72/125 [23:28<14:02, 15.89s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▉                                  | 73/125 [23:55<16:42, 19.28s/it]Evaluating gsm8k :  59%|████████████████████████████████████████████████▌                                 | 74/125 [24:22<18:28, 21.74s/it]Evaluating gsm8k :  60%|█████████████████████████████████████████████████▏                                | 75/125 [24:48<18:57, 22.76s/it]Evaluating gsm8k :  61%|█████████████████████████████████████████████████▊                                | 76/125 [25:09<18:18, 22.42s/it]Evaluating gsm8k :  62%|██████████████████████████████████████████████████▌                               | 77/125 [25:18<14:44, 18.42s/it]Evaluating gsm8k :  62%|███████████████████████████████████████████████████▏                              | 78/125 [25:44<16:07, 20.58s/it]Evaluating gsm8k :  63%|███████████████████████████████████████████████████▊                              | 79/125 [26:11<17:14, 22.49s/it]Evaluating gsm8k :  64%|████████████████████████████████████████████████████▍                             | 80/125 [26:38<17:51, 23.82s/it]Evaluating gsm8k :  65%|█████████████████████████████████████████████████████▏                            | 81/125 [26:43<13:18, 18.15s/it]Evaluating gsm8k :  66%|█████████████████████████████████████████████████████▊                            | 82/125 [26:52<11:03, 15.42s/it]Evaluating gsm8k :  66%|██████████████████████████████████████████████████████▍                           | 83/125 [27:19<13:16, 18.97s/it]Evaluating gsm8k :  67%|███████████████████████████████████████████████████████                           | 84/125 [27:46<14:38, 21.43s/it]Evaluating gsm8k :  68%|███████████████████████████████████████████████████████▊                          | 85/125 [28:13<15:25, 23.14s/it]Evaluating gsm8k :  69%|████████████████████████████████████████████████████████▍                         | 86/125 [28:41<15:51, 24.41s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████                         | 87/125 [29:08<15:56, 25.18s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████▋                        | 88/125 [29:35<15:49, 25.68s/it]Evaluating gsm8k :  71%|██████████████████████████████████████████████████████████▍                       | 89/125 [30:02<15:46, 26.30s/it]Evaluating gsm8k :  72%|███████████████████████████████████████████████████████████                       | 90/125 [30:14<12:45, 21.87s/it]Evaluating gsm8k :  73%|███████████████████████████████████████████████████████████▋                      | 91/125 [30:37<12:40, 22.37s/it]Evaluating gsm8k :  74%|████████████████████████████████████████████████████████████▎                     | 92/125 [30:48<10:24, 18.94s/it]Evaluating gsm8k :  74%|█████████████████████████████████████████████████████████████                     | 93/125 [31:15<11:25, 21.42s/it]Evaluating gsm8k :  75%|█████████████████████████████████████████████████████████████▋                    | 94/125 [31:38<11:12, 21.69s/it]Evaluating gsm8k :  76%|██████████████████████████████████████████████████████████████▎                   | 95/125 [32:05<11:36, 23.23s/it]Evaluating gsm8k :  77%|██████████████████████████████████████████████████████████████▉                   | 96/125 [32:31<11:42, 24.22s/it]Evaluating gsm8k :  78%|███████████████████████████████████████████████████████████████▋                  | 97/125 [32:56<11:20, 24.29s/it]Evaluating gsm8k :  78%|████████████████████████████████████████████████████████████████▎                 | 98/125 [33:23<11:18, 25.14s/it]Evaluating gsm8k :  79%|████████████████████████████████████████████████████████████████▉                 | 99/125 [33:50<11:09, 25.73s/it]Evaluating gsm8k :  80%|████████████████████████████████████████████████████████████████▊                | 100/125 [34:05<09:21, 22.48s/it]Evaluating gsm8k :  81%|█████████████████████████████████████████████████████████████████▍               | 101/125 [34:27<09:00, 22.54s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████               | 102/125 [34:42<07:43, 20.16s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████▋              | 103/125 [35:03<07:30, 20.47s/it]Evaluating gsm8k :  83%|███████████████████████████████████████████████████████████████████▍             | 104/125 [35:30<07:51, 22.45s/it]Evaluating gsm8k :  84%|████████████████████████████████████████████████████████████████████             | 105/125 [35:58<08:00, 24.01s/it]Evaluating gsm8k :  85%|████████████████████████████████████████████████████████████████████▋            | 106/125 [36:25<07:52, 24.89s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▎           | 107/125 [36:52<07:39, 25.51s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▉           | 108/125 [37:19<07:20, 25.90s/it]Evaluating gsm8k :  87%|██████████████████████████████████████████████████████████████████████▋          | 109/125 [37:46<07:00, 26.29s/it]Evaluating gsm8k :  88%|███████████████████████████████████████████████████████████████████████▎         | 110/125 [38:13<06:38, 26.59s/it]Evaluating gsm8k :  89%|███████████████████████████████████████████████████████████████████████▉         | 111/125 [38:32<05:39, 24.28s/it]Evaluating gsm8k :  90%|████████████████████████████████████████████████████████████████████████▌        | 112/125 [38:52<04:57, 22.88s/it]Evaluating gsm8k :  90%|█████████████████████████████████████████████████████████████████████████▏       | 113/125 [39:19<04:49, 24.16s/it]Evaluating gsm8k :  91%|█████████████████████████████████████████████████████████████████████████▊       | 114/125 [39:46<04:36, 25.11s/it]Evaluating gsm8k :  92%|██████████████████████████████████████████████████████████████████████████▌      | 115/125 [40:13<04:17, 25.79s/it]Evaluating gsm8k :  93%|███████████████████████████████████████████████████████████████████████████▏     | 116/125 [40:41<03:56, 26.28s/it]Evaluating gsm8k :  94%|███████████████████████████████████████████████████████████████████████████▊     | 117/125 [40:57<03:06, 23.36s/it]Evaluating gsm8k :  94%|████████████████████████████████████████████████████████████████████████████▍    | 118/125 [41:18<02:38, 22.66s/it]Evaluating gsm8k :  95%|█████████████████████████████████████████████████████████████████████████████    | 119/125 [41:46<02:25, 24.18s/it]Evaluating gsm8k :  96%|█████████████████████████████████████████████████████████████████████████████▊   | 120/125 [42:13<02:05, 25.02s/it]Evaluating gsm8k :  97%|██████████████████████████████████████████████████████████████████████████████▍  | 121/125 [42:27<01:26, 21.58s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████  | 122/125 [42:48<01:04, 21.38s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████▋ | 123/125 [43:15<00:46, 23.11s/it]Evaluating gsm8k :  99%|████████████████████████████████████████████████████████████████████████████████▎| 124/125 [43:25<00:19, 19.37s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [43:53<00:00, 21.84s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [43:53<00:00, 21.07s/it]
name: gsm8k | {'exact_match': 0.0, 'rougeL': 0.2569} | lm_loss 11.3798 | avg. gen lenth: 299.74
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name gsm8k --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name commonsenseqa --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 2 --data-dir /scratch/ylu130/processed_data/gsm8k/out-domain/o3-tcommonsenseqa-s10-rTrue --seed 10 --max-prompt-length 2048 --rationales --num-out-domain 3
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date![nltk_data]   Package punkt is already up-to-date!

[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-18 06:48:10,546] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... gsm8k
  data_dir ..................... /scratch/ylu130/processed_data/gsm8k/out-domain/o3-tcommonsenseqa-s10-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 3
  out_domain_data_name ......... commonsenseqa
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o3-tcommonsenseqa-s10-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 2
  clip_grad .................... 1.0
  seed ......................... 10
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                                             | 0/7473 [00:00<?, ?it/s]  0%|▍                                                                                                  | 34/7473 [00:00<00:22, 335.95it/s]  1%|▉                                                                                                  | 68/7473 [00:00<00:21, 338.11it/s]  1%|█▎                                                                                                | 103/7473 [00:00<00:21, 339.36it/s]  2%|█▊                                                                                                | 138/7473 [00:00<00:21, 340.27it/s]  2%|██▎                                                                                               | 173/7473 [00:00<00:21, 341.57it/s]  3%|██▋                                                                                               | 208/7473 [00:00<00:21, 342.68it/s]  3%|███▏                                                                                              | 243/7473 [00:00<00:21, 342.10it/s]  4%|███▋                                                                                              | 278/7473 [00:00<00:21, 335.27it/s]  4%|████                                                                                              | 312/7473 [00:00<00:21, 336.48it/s]  5%|████▌                                                                                             | 347/7473 [00:01<00:21, 337.64it/s]  5%|█████                                                                                             | 382/7473 [00:01<00:20, 338.48it/s]  6%|█████▍                                                                                            | 416/7473 [00:01<00:20, 338.44it/s]  6%|█████▉                                                                                            | 451/7473 [00:01<00:20, 339.21it/s]  6%|██████▎                                                                                           | 485/7473 [00:01<00:21, 331.34it/s]  7%|██████▊                                                                                           | 520/7473 [00:01<00:20, 334.03it/s]  7%|███████▎                                                                                          | 555/7473 [00:01<00:20, 337.38it/s]  8%|███████▋                                                                                          | 590/7473 [00:01<00:20, 338.25it/s]  8%|████████▏                                                                                         | 624/7473 [00:01<00:20, 336.04it/s]  9%|████████▋                                                                                         | 659/7473 [00:01<00:20, 337.42it/s]  9%|█████████                                                                                         | 694/7473 [00:02<00:19, 340.12it/s] 10%|█████████▌                                                                                        | 729/7473 [00:02<00:19, 340.58it/s] 10%|██████████                                                                                        | 764/7473 [00:02<00:19, 341.21it/s] 11%|██████████▍                                                                                       | 799/7473 [00:02<00:19, 341.24it/s] 11%|███████████                                                                                       | 847/7473 [00:02<00:17, 380.25it/s] 12%|███████████▊                                                                                      | 899/7473 [00:02<00:15, 421.15it/s] 13%|████████████▍                                                                                     | 951/7473 [00:02<00:14, 448.55it/s] 13%|█████████████                                                                                    | 1003/7473 [00:02<00:13, 469.10it/s] 14%|█████████████▋                                                                                   | 1055/7473 [00:02<00:13, 483.67it/s] 15%|██████████████▎                                                                                  | 1107/7473 [00:02<00:12, 494.06it/s] 15%|███████████████                                                                                  | 1158/7473 [00:03<00:12, 497.86it/s] 16%|███████████████▋                                                                                 | 1210/7473 [00:03<00:12, 502.49it/s] 17%|████████████████▍                                                                                | 1262/7473 [00:03<00:12, 505.82it/s] 18%|█████████████████                                                                                | 1314/7473 [00:03<00:12, 508.16it/s] 18%|█████████████████▋                                                                               | 1366/7473 [00:03<00:11, 509.69it/s] 19%|██████████████████▍                                                                              | 1417/7473 [00:03<00:11, 506.89it/s] 20%|███████████████████                                                                              | 1469/7473 [00:03<00:11, 508.83it/s] 20%|███████████████████▋                                                                             | 1521/7473 [00:03<00:11, 511.20it/s] 21%|████████████████████▍                                                                            | 1573/7473 [00:03<00:11, 511.10it/s] 22%|█████████████████████                                                                            | 1625/7473 [00:03<00:11, 509.87it/s] 22%|█████████████████████▊                                                                           | 1677/7473 [00:04<00:11, 512.23it/s] 23%|██████████████████████▍                                                                          | 1729/7473 [00:04<00:11, 513.24it/s] 24%|███████████████████████                                                                          | 1781/7473 [00:04<00:11, 513.17it/s] 25%|███████████████████████▊                                                                         | 1833/7473 [00:04<00:10, 513.78it/s] 25%|████████████████████████▍                                                                        | 1885/7473 [00:04<00:10, 512.92it/s] 26%|█████████████████████████▏                                                                       | 1937/7473 [00:04<00:10, 512.40it/s] 27%|█████████████████████████▊                                                                       | 1989/7473 [00:04<00:10, 513.88it/s] 27%|██████████████████████████▍                                                                      | 2041/7473 [00:04<00:10, 514.97it/s] 28%|███████████████████████████▏                                                                     | 2093/7473 [00:04<00:10, 513.70it/s] 29%|███████████████████████████▊                                                                     | 2145/7473 [00:04<00:10, 513.45it/s] 29%|████████████████████████████▌                                                                    | 2197/7473 [00:05<00:10, 515.10it/s] 30%|█████████████████████████████▏                                                                   | 2249/7473 [00:05<00:10, 515.77it/s] 31%|█████████████████████████████▊                                                                   | 2301/7473 [00:05<00:10, 514.10it/s] 31%|██████████████████████████████▌                                                                  | 2353/7473 [00:05<00:09, 514.79it/s] 32%|███████████████████████████████▏                                                                 | 2405/7473 [00:05<00:09, 515.60it/s] 33%|███████████████████████████████▉                                                                 | 2457/7473 [00:05<00:09, 516.62it/s] 34%|████████████████████████████████▌                                                                | 2509/7473 [00:05<00:09, 516.97it/s] 34%|█████████████████████████████████▏                                                               | 2561/7473 [00:05<00:10, 485.98it/s] 35%|█████████████████████████████████▉                                                               | 2613/7473 [00:05<00:09, 495.35it/s] 36%|██████████████████████████████████▌                                                              | 2666/7473 [00:06<00:09, 502.91it/s] 36%|███████████████████████████████████▎                                                             | 2718/7473 [00:06<00:09, 507.56it/s] 37%|███████████████████████████████████▉                                                             | 2769/7473 [00:06<00:09, 508.12it/s] 38%|████████████████████████████████████▌                                                            | 2821/7473 [00:06<00:09, 511.06it/s] 38%|█████████████████████████████████████▎                                                           | 2873/7473 [00:06<00:08, 512.75it/s] 39%|█████████████████████████████████████▉                                                           | 2925/7473 [00:06<00:08, 514.78it/s] 40%|██████████████████████████████████████▋                                                          | 2977/7473 [00:06<00:08, 514.31it/s] 41%|███████████████████████████████████████▎                                                         | 3029/7473 [00:06<00:08, 514.92it/s] 41%|███████████████████████████████████████▉                                                         | 3081/7473 [00:06<00:08, 515.80it/s] 42%|████████████████████████████████████████▋                                                        | 3133/7473 [00:06<00:08, 514.84it/s] 43%|█████████████████████████████████████████▎                                                       | 3185/7473 [00:07<00:08, 514.47it/s] 43%|██████████████████████████████████████████                                                       | 3237/7473 [00:07<00:08, 508.51it/s] 44%|██████████████████████████████████████████▋                                                      | 3289/7473 [00:07<00:08, 511.34it/s] 45%|███████████████████████████████████████████▎                                                     | 3341/7473 [00:07<00:08, 511.08it/s] 45%|████████████████████████████████████████████                                                     | 3393/7473 [00:07<00:07, 511.82it/s] 46%|████████████████████████████████████████████▋                                                    | 3445/7473 [00:07<00:07, 510.98it/s] 47%|█████████████████████████████████████████████▍                                                   | 3497/7473 [00:07<00:07, 512.64it/s] 47%|██████████████████████████████████████████████                                                   | 3549/7473 [00:07<00:07, 513.99it/s] 48%|██████████████████████████████████████████████▋                                                  | 3601/7473 [00:07<00:07, 515.51it/s] 49%|███████████████████████████████████████████████▍                                                 | 3653/7473 [00:07<00:07, 514.68it/s] 50%|████████████████████████████████████████████████                                                 | 3705/7473 [00:08<00:07, 512.55it/s] 50%|████████████████████████████████████████████████▊                                                | 3757/7473 [00:08<00:07, 513.09it/s] 51%|█████████████████████████████████████████████████▍                                               | 3809/7473 [00:08<00:07, 514.72it/s] 52%|██████████████████████████████████████████████████                                               | 3861/7473 [00:08<00:07, 514.83it/s] 52%|██████████████████████████████████████████████████▊                                              | 3913/7473 [00:08<00:07, 507.95it/s] 53%|███████████████████████████████████████████████████▍                                             | 3964/7473 [00:08<00:06, 506.41it/s] 54%|████████████████████████████████████████████████████                                             | 4015/7473 [00:08<00:07, 492.79it/s] 54%|████████████████████████████████████████████████████▊                                            | 4067/7473 [00:08<00:06, 499.89it/s] 55%|█████████████████████████████████████████████████████▍                                           | 4118/7473 [00:08<00:06, 501.37it/s] 56%|██████████████████████████████████████████████████████▏                                          | 4170/7473 [00:08<00:06, 504.77it/s] 56%|██████████████████████████████████████████████████████▊                                          | 4222/7473 [00:09<00:06, 507.88it/s] 57%|███████████████████████████████████████████████████████▍                                         | 4274/7473 [00:09<00:06, 509.86it/s] 58%|████████████████████████████████████████████████████████▏                                        | 4326/7473 [00:09<00:06, 511.95it/s] 59%|████████████████████████████████████████████████████████▊                                        | 4378/7473 [00:09<00:06, 511.52it/s] 59%|█████████████████████████████████████████████████████████▌                                       | 4430/7473 [00:09<00:05, 512.39it/s] 60%|██████████████████████████████████████████████████████████▏                                      | 4482/7473 [00:09<00:05, 513.00it/s] 61%|██████████████████████████████████████████████████████████▊                                      | 4534/7473 [00:09<00:05, 509.53it/s] 61%|███████████████████████████████████████████████████████████▌                                     | 4586/7473 [00:09<00:05, 510.01it/s] 62%|████████████████████████████████████████████████████████████▏                                    | 4638/7473 [00:09<00:05, 511.12it/s] 63%|████████████████████████████████████████████████████████████▉                                    | 4690/7473 [00:09<00:05, 512.73it/s] 63%|█████████████████████████████████████████████████████████████▌                                   | 4742/7473 [00:10<00:05, 512.06it/s] 64%|██████████████████████████████████████████████████████████████▏                                  | 4794/7473 [00:10<00:05, 511.57it/s] 65%|██████████████████████████████████████████████████████████████▉                                  | 4846/7473 [00:10<00:05, 513.16it/s] 66%|███████████████████████████████████████████████████████████████▌                                 | 4898/7473 [00:10<00:05, 512.98it/s] 66%|████████████████████████████████████████████████████████████████▎                                | 4950/7473 [00:10<00:04, 513.13it/s] 67%|████████████████████████████████████████████████████████████████▉                                | 5002/7473 [00:10<00:04, 513.27it/s] 68%|█████████████████████████████████████████████████████████████████▌                               | 5054/7473 [00:10<00:04, 512.01it/s] 68%|██████████████████████████████████████████████████████████████████▎                              | 5106/7473 [00:10<00:04, 512.23it/s] 69%|██████████████████████████████████████████████████████████████████▉                              | 5158/7473 [00:10<00:04, 512.94it/s] 70%|███████████████████████████████████████████████████████████████████▋                             | 5210/7473 [00:10<00:04, 513.00it/s] 70%|████████████████████████████████████████████████████████████████████▎                            | 5262/7473 [00:11<00:04, 475.74it/s] 71%|████████████████████████████████████████████████████████████████████▉                            | 5314/7473 [00:11<00:04, 486.17it/s] 72%|█████████████████████████████████████████████████████████████████████▋                           | 5365/7473 [00:11<00:04, 492.50it/s] 72%|██████████████████████████████████████████████████████████████████████▎                          | 5417/7473 [00:11<00:04, 498.59it/s] 73%|██████████████████████████████████████████████████████████████████████▉                          | 5468/7473 [00:11<00:03, 501.81it/s] 74%|███████████████████████████████████████████████████████████████████████▋                         | 5519/7473 [00:11<00:05, 354.05it/s] 75%|████████████████████████████████████████████████████████████████████████▎                        | 5571/7473 [00:11<00:04, 390.18it/s] 75%|████████████████████████████████████████████████████████████████████████▉                        | 5622/7473 [00:11<00:04, 418.95it/s] 76%|█████████████████████████████████████████████████████████████████████████▋                       | 5674/7473 [00:12<00:04, 441.86it/s] 77%|██████████████████████████████████████████████████████████████████████████▎                      | 5726/7473 [00:12<00:03, 460.81it/s] 77%|██████████████████████████████████████████████████████████████████████████▉                      | 5778/7473 [00:12<00:03, 474.74it/s] 78%|███████████████████████████████████████████████████████████████████████████▋                     | 5829/7473 [00:12<00:03, 483.42it/s] 79%|████████████████████████████████████████████████████████████████████████████▎                    | 5880/7473 [00:12<00:03, 491.01it/s] 79%|████████████████████████████████████████████████████████████████████████████▉                    | 5931/7473 [00:12<00:03, 494.94it/s] 80%|█████████████████████████████████████████████████████████████████████████████▋                   | 5982/7473 [00:12<00:02, 498.96it/s] 81%|██████████████████████████████████████████████████████████████████████████████▎                  | 6034/7473 [00:12<00:02, 502.76it/s] 81%|██████████████████████████████████████████████████████████████████████████████▉                  | 6086/7473 [00:12<00:02, 506.75it/s] 82%|███████████████████████████████████████████████████████████████████████████████▋                 | 6137/7473 [00:12<00:02, 507.40it/s] 83%|████████████████████████████████████████████████████████████████████████████████▎                | 6188/7473 [00:13<00:02, 507.27it/s] 84%|████████████████████████████████████████████████████████████████████████████████▉                | 6240/7473 [00:13<00:02, 508.97it/s] 84%|█████████████████████████████████████████████████████████████████████████████████▋               | 6292/7473 [00:13<00:02, 510.64it/s] 85%|██████████████████████████████████████████████████████████████████████████████████▎              | 6344/7473 [00:13<00:02, 512.55it/s] 86%|███████████████████████████████████████████████████████████████████████████████████              | 6396/7473 [00:13<00:02, 509.64it/s] 86%|███████████████████████████████████████████████████████████████████████████████████▋             | 6448/7473 [00:13<00:02, 510.82it/s] 87%|████████████████████████████████████████████████████████████████████████████████████▎            | 6500/7473 [00:13<00:01, 512.22it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████            | 6552/7473 [00:13<00:01, 512.88it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████▋           | 6604/7473 [00:13<00:01, 512.30it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████▍          | 6656/7473 [00:13<00:01, 512.47it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████          | 6708/7473 [00:14<00:01, 513.22it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████▋         | 6760/7473 [00:14<00:01, 512.84it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████▍        | 6812/7473 [00:14<00:01, 511.47it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████        | 6864/7473 [00:14<00:01, 511.49it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████▊       | 6916/7473 [00:14<00:01, 513.44it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████▍      | 6968/7473 [00:14<00:00, 513.52it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████      | 7020/7473 [00:14<00:00, 513.21it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████▊     | 7072/7473 [00:14<00:00, 510.28it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████▍    | 7124/7473 [00:14<00:00, 511.93it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████▏   | 7176/7473 [00:15<00:00, 511.89it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████▊   | 7228/7473 [00:15<00:00, 512.65it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████▍  | 7280/7473 [00:15<00:00, 512.74it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████▏ | 7332/7473 [00:15<00:00, 513.10it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████▊ | 7384/7473 [00:15<00:00, 513.14it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████▌| 7436/7473 [00:15<00:00, 513.46it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 7473/7473 [00:15<00:00, 479.44it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.35s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.02s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.43s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.46s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.05s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.30s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.40s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.51s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.41s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.58s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.71s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.87s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.83s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.99s/it]
[2023-08-18 06:49:18,663] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  4.88s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.04s/it]
[2023-08-18 06:49:30,297] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-18 06:49:30,298] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-18 06:49:30,298] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-18 06:49:30,299] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-18 06:49:30,299] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-18 06:49:30,299] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-18 06:49:30,299] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-18 06:49:30,299] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-18 06:49:30,299] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-18 06:49:30,299] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-18 06:49:30,299] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-18 06:49:30,299] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f34a813e370>
[2023-08-18 06:49:30,299] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-18 06:49:30,299] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-18 06:49:30,299] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-18 06:49:30,299] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-18 06:49:30,299] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-18 06:49:30,300] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-18 06:49:30,300] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-18 06:49:30,300] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-18 06:49:30,300] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-18 06:49:30,300] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-18 06:49:30,300] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-18 06:49:30,300] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-18 06:49:30,300] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-18 06:49:30,300] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-18 06:49:30,300] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-18 06:49:30,300] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-18 06:49:30,300] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-18 06:49:30,300] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-18 06:49:30,300] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-18 06:49:30,300] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-18 06:49:30,300] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-18 06:49:30,300] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-18 06:49:30,300] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-18 06:49:30,300] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-18 06:49:30,300] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-18 06:49:30,300] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-18 06:49:30,300] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-18 06:49:30,300] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-18 06:49:30,300] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-18 06:49:30,300] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-18 06:49:30,300] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-18 06:49:30,300] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-18 06:49:30,300] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f34a813e250>
[2023-08-18 06:49:30,300] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-18 06:49:30,300] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-18 06:49:30,300] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-18 06:49:30,300] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-18 06:49:30,300] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-18 06:49:30,300] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-18 06:49:30,300] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-18 06:49:30,300] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-18 06:49:30,300] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-18 06:49:30,301] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-18 06:49:30,301] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-18 06:49:30,301] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-18 06:49:30,301] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-18 06:49:30,301] [INFO] [config.py:1012:print]   train_batch_size ............. 8
[2023-08-18 06:49:30,301] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  2
[2023-08-18 06:49:30,301] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-18 06:49:30,301] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-18 06:49:30,301] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-18 06:49:30,301] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-18 06:49:30,301] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-18 06:49:30,301] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-18 06:49:30,301] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-18 06:49:30,301] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.5042362213134766 seconds
Loading extension module utils...
Time to load utils op: 0.4044966697692871 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Loading extension module utils...
Time to load utils op: 0.5045554637908936 seconds
Evaluating gsm8k :   0%|                                                                                           | 0/125 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following grade math question.

Input: Fabric is cut to order at what type of seller? Choices:  A: curtains B: tailor shop C: clothing store D: sewing room E: hardware store
Output: 1. First, we need to understand what each choice is primarily known for.
2. Option A: Curtains is a type of product generally bought ready-made, and while some fabric stores also sell curtains, the fabric for curtains is generally not cut to order there.
3. Option B: Tailor Shop is a place where clothes are made or altered according to customer's requirements. The fabric is often cut to order based on the client's measurements and the style of the garment desired. 
4. Option C: Clothing Store typically sells ready-to-wear clothing and doesn't usually involve cutting fabric to order.
5. Option D: Sewing Room is a space where sewing activities are conducted, but there isn't typically any customer interaction or custom orders.
6. Option E: Hardware Store primarily sells tools, hardware and construction materials, not fabric. 
7. Therefore, the correct answer is B: Tailor Shop, because fabric is typically cut to order at a tailor shop rather than any of the other options provided.
So the final answer is B: tailor shop

Input: Where are you if your reading magazines while waiting for a vehicle on rails? Choices:  A: vegetables B: market C: doctor D: train station E: bookstore
Output: 1. The question asks for the location of someone reading magazines while waiting for a vehicle that moves on rails.
2. There's a need to evaluate the clues given in the question: reading magazines and waiting for a vehicle on rails.
3. Reading magazines can be done virtually anywhere but waiting for a vehicle on rails means waiting for a type of transportation that moves on tracks, such as a train or a tram.
4. The choices given are vegetables, market, doctor, train station, and bookstore. 
5. The word'vegetables' is not a location, so choice A can be eliminated.
6. 'Market', 'Doctor', and 'Bookstore' are places where people might read magazines, but these are not typically places where one waits for a vehicle on rails.
7. 'Train station' is a place where people often read to pass the time while waiting for a vehicle that moves along rails, which is usually a train.
8. Therefore, the answer is D: train station.
So the final answer is D: train station

Input: What would need oil to be used? Choices:  A: ground B: human  body C: repair shop D: combustion engines E: service station
Output: 1. There are different forms of oil that are used for various purposes. So, the first step is to identify the function of oil in each of the options given.
2. The ground does not need oil. It needs water and minerals for vegetation to grow, so option A is not correct.
3. The human body produces its own oils necessary for skin, hair etc, so option B is not appropriate.
4. Although a repair shop and service station might use oil in their operations, they themselves do not need oil for their existence, they need it as a secondary requirement for an aspect of their service. They use it to service machines or engines so options C and E can be ruled out.
5. Combustion engines, however, directly use oil for their operation. The oil is used as a lubricant to lessen friction between moving parts and also as a fuel in some engines.
6. Hence, the answer is D. Combustion engines need oil to be used.
So the final answer is D: combustion engines

Input:Natalia sold clips to 48 of her friends in April, and then she sold half as many clips in May. How many clips did Natalia sell altogether in April and May?
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o3-tcommonsenseqa-s10-rTrue
Loading extension module utils...
Time to load utils op: 0.5047924518585205 seconds
Evaluating gsm8k :   1%|▋                                                                                  | 1/125 [00:26<54:22, 26.31s/it]Evaluating gsm8k :   2%|█▎                                                                                 | 2/125 [00:51<52:07, 25.43s/it]Evaluating gsm8k :   2%|█▉                                                                                 | 3/125 [01:13<49:18, 24.25s/it]Evaluating gsm8k :   3%|██▋                                                                                | 4/125 [01:38<49:18, 24.45s/it]Evaluating gsm8k :   4%|███▎                                                                               | 5/125 [02:03<49:03, 24.53s/it]Evaluating gsm8k :   5%|███▉                                                                               | 6/125 [02:25<47:07, 23.76s/it]Evaluating gsm8k :   6%|████▋                                                                              | 7/125 [02:50<47:36, 24.21s/it]Evaluating gsm8k :   6%|█████▎                                                                             | 8/125 [03:11<45:07, 23.14s/it]Evaluating gsm8k :   7%|█████▉                                                                             | 9/125 [03:26<39:52, 20.62s/it]Evaluating gsm8k :   8%|██████▌                                                                           | 10/125 [03:51<42:00, 21.92s/it]Evaluating gsm8k :   9%|███████▏                                                                          | 11/125 [04:12<40:58, 21.56s/it]Evaluating gsm8k :  10%|███████▊                                                                          | 12/125 [04:21<33:15, 17.66s/it]Evaluating gsm8k :  10%|████████▌                                                                         | 13/125 [04:45<37:02, 19.85s/it]Evaluating gsm8k :  11%|█████████▏                                                                        | 14/125 [05:01<34:06, 18.44s/it]Evaluating gsm8k :  12%|█████████▊                                                                        | 15/125 [05:25<37:13, 20.30s/it]Evaluating gsm8k :  13%|██████████▍                                                                       | 16/125 [05:39<33:09, 18.26s/it]Evaluating gsm8k :  14%|███████████▏                                                                      | 17/125 [06:00<34:18, 19.06s/it]Evaluating gsm8k :  14%|███████████▊                                                                      | 18/125 [06:15<32:11, 18.05s/it]Evaluating gsm8k :  15%|████████████▍                                                                     | 19/125 [06:40<35:30, 20.10s/it]Evaluating gsm8k :  16%|█████████████                                                                     | 20/125 [06:58<34:12, 19.55s/it]Evaluating gsm8k :  17%|█████████████▊                                                                    | 21/125 [07:23<36:41, 21.17s/it]Evaluating gsm8k :  18%|██████████████▍                                                                   | 22/125 [07:48<38:17, 22.31s/it]Evaluating gsm8k :  18%|███████████████                                                                   | 23/125 [07:55<30:00, 17.65s/it]Evaluating gsm8k :  19%|███████████████▋                                                                  | 24/125 [08:06<26:25, 15.69s/it]Evaluating gsm8k :  20%|████████████████▍                                                                 | 25/125 [08:18<24:22, 14.63s/it]Evaluating gsm8k :  21%|█████████████████                                                                 | 26/125 [08:43<29:05, 17.63s/it]Evaluating gsm8k :  22%|█████████████████▋                                                                | 27/125 [09:03<29:48, 18.25s/it]Evaluating gsm8k :  22%|██████████████████▎                                                               | 28/125 [09:15<26:41, 16.51s/it]Evaluating gsm8k :  23%|███████████████████                                                               | 29/125 [09:40<30:27, 19.04s/it]Evaluating gsm8k :  24%|███████████████████▋                                                              | 30/125 [10:02<31:29, 19.89s/it]Evaluating gsm8k :  25%|████████████████████▎                                                             | 31/125 [10:27<33:33, 21.42s/it]Evaluating gsm8k :  26%|████████████████████▉                                                             | 32/125 [10:52<34:46, 22.44s/it]Evaluating gsm8k :  26%|█████████████████████▋                                                            | 33/125 [11:17<35:27, 23.13s/it]Evaluating gsm8k :  27%|██████████████████████▎                                                           | 34/125 [11:35<32:55, 21.71s/it]Evaluating gsm8k :  28%|██████████████████████▉                                                           | 35/125 [11:56<32:27, 21.64s/it]Evaluating gsm8k :  29%|███████████████████████▌                                                          | 36/125 [12:07<27:09, 18.31s/it]Evaluating gsm8k :  30%|████████████████████████▎                                                         | 37/125 [12:32<29:37, 20.20s/it]Evaluating gsm8k :  30%|████████████████████████▉                                                         | 38/125 [12:56<31:17, 21.58s/it]Evaluating gsm8k :  31%|█████████████████████████▌                                                        | 39/125 [13:21<32:19, 22.55s/it]Evaluating gsm8k :  32%|██████████████████████████▏                                                       | 40/125 [13:38<29:28, 20.81s/it]Evaluating gsm8k :  33%|██████████████████████████▉                                                       | 41/125 [13:52<26:07, 18.66s/it]Evaluating gsm8k :  34%|███████████████████████████▌                                                      | 42/125 [14:17<28:26, 20.55s/it]Evaluating gsm8k :  34%|████████████████████████████▏                                                     | 43/125 [14:32<26:07, 19.11s/it]Evaluating gsm8k :  35%|████████████████████████████▊                                                     | 44/125 [14:57<28:09, 20.86s/it]Evaluating gsm8k :  36%|█████████████████████████████▌                                                    | 45/125 [15:09<24:17, 18.22s/it]Evaluating gsm8k :  37%|██████████████████████████████▏                                                   | 46/125 [15:34<26:35, 20.20s/it]Evaluating gsm8k :  38%|██████████████████████████████▊                                                   | 47/125 [15:59<28:06, 21.63s/it]Evaluating gsm8k :  38%|███████████████████████████████▍                                                  | 48/125 [16:24<28:59, 22.60s/it]Evaluating gsm8k :  39%|████████████████████████████████▏                                                 | 49/125 [16:35<24:19, 19.20s/it]Evaluating gsm8k :  40%|████████████████████████████████▊                                                 | 50/125 [17:00<26:01, 20.83s/it]Evaluating gsm8k :  41%|█████████████████████████████████▍                                                | 51/125 [17:25<27:13, 22.07s/it]Evaluating gsm8k :  42%|██████████████████████████████████                                                | 52/125 [17:47<26:56, 22.14s/it]Evaluating gsm8k :  42%|██████████████████████████████████▊                                               | 53/125 [18:12<27:34, 22.98s/it]Evaluating gsm8k :  43%|███████████████████████████████████▍                                              | 54/125 [18:37<27:54, 23.58s/it]Evaluating gsm8k :  44%|████████████████████████████████████                                              | 55/125 [19:02<27:59, 23.99s/it]Evaluating gsm8k :  45%|████████████████████████████████████▋                                             | 56/125 [19:10<22:10, 19.28s/it]Evaluating gsm8k :  46%|█████████████████████████████████████▍                                            | 57/125 [19:35<23:50, 21.04s/it]Evaluating gsm8k :  46%|██████████████████████████████████████                                            | 58/125 [19:52<22:01, 19.73s/it]Evaluating gsm8k :  47%|██████████████████████████████████████▋                                           | 59/125 [20:08<20:17, 18.45s/it]Evaluating gsm8k :  48%|███████████████████████████████████████▎                                          | 60/125 [20:32<22:02, 20.35s/it]Evaluating gsm8k :  49%|████████████████████████████████████████                                          | 61/125 [20:55<22:22, 20.98s/it]Evaluating gsm8k :  50%|████████████████████████████████████████▋                                         | 62/125 [21:20<23:14, 22.14s/it]Evaluating gsm8k :  50%|█████████████████████████████████████████▎                                        | 63/125 [21:44<23:42, 22.94s/it]Evaluating gsm8k :  51%|█████████████████████████████████████████▉                                        | 64/125 [22:00<20:59, 20.65s/it]Evaluating gsm8k :  52%|██████████████████████████████████████████▋                                       | 65/125 [22:20<20:26, 20.44s/it]Evaluating gsm8k :  53%|███████████████████████████████████████████▎                                      | 66/125 [22:45<21:23, 21.75s/it]Evaluating gsm8k :  54%|███████████████████████████████████████████▉                                      | 67/125 [22:56<18:07, 18.75s/it]Evaluating gsm8k :  54%|████████████████████████████████████████████▌                                     | 68/125 [23:10<16:18, 17.18s/it]Evaluating gsm8k :  55%|█████████████████████████████████████████████▎                                    | 69/125 [23:26<15:49, 16.95s/it]Evaluating gsm8k :  56%|█████████████████████████████████████████████▉                                    | 70/125 [23:51<17:45, 19.36s/it]Evaluating gsm8k :  57%|██████████████████████████████████████████████▌                                   | 71/125 [24:16<18:54, 21.01s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▏                                  | 72/125 [24:41<19:32, 22.13s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▉                                  | 73/125 [25:06<19:51, 22.91s/it]Evaluating gsm8k :  59%|████████████████████████████████████████████████▌                                 | 74/125 [25:31<20:02, 23.58s/it]Evaluating gsm8k :  60%|█████████████████████████████████████████████████▏                                | 75/125 [25:54<19:39, 23.60s/it]Evaluating gsm8k :  61%|█████████████████████████████████████████████████▊                                | 76/125 [26:19<19:32, 23.93s/it]Evaluating gsm8k :  62%|██████████████████████████████████████████████████▌                               | 77/125 [26:44<19:24, 24.25s/it]Evaluating gsm8k :  62%|███████████████████████████████████████████████████▏                              | 78/125 [26:59<16:47, 21.44s/it]Evaluating gsm8k :  63%|███████████████████████████████████████████████████▊                              | 79/125 [27:24<17:14, 22.50s/it]Evaluating gsm8k :  64%|████████████████████████████████████████████████████▍                             | 80/125 [27:37<14:44, 19.65s/it]Evaluating gsm8k :  65%|█████████████████████████████████████████████████████▏                            | 81/125 [28:02<15:37, 21.30s/it]Evaluating gsm8k :  66%|█████████████████████████████████████████████████████▊                            | 82/125 [28:27<16:03, 22.41s/it]Evaluating gsm8k :  66%|██████████████████████████████████████████████████████▍                           | 83/125 [28:52<16:10, 23.11s/it]Evaluating gsm8k :  67%|███████████████████████████████████████████████████████                           | 84/125 [29:16<16:05, 23.56s/it]Evaluating gsm8k :  68%|███████████████████████████████████████████████████████▊                          | 85/125 [29:42<16:01, 24.03s/it]Evaluating gsm8k :  69%|████████████████████████████████████████████████████████▍                         | 86/125 [30:07<15:49, 24.35s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████                         | 87/125 [30:32<15:32, 24.53s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████▋                        | 88/125 [30:41<12:20, 20.02s/it]Evaluating gsm8k :  71%|██████████████████████████████████████████████████████████▍                       | 89/125 [30:53<10:29, 17.49s/it]Evaluating gsm8k :  72%|███████████████████████████████████████████████████████████                       | 90/125 [31:10<10:14, 17.56s/it]Evaluating gsm8k :  73%|███████████████████████████████████████████████████████████▋                      | 91/125 [31:29<10:04, 17.77s/it]Evaluating gsm8k :  74%|████████████████████████████████████████████████████████████▎                     | 92/125 [31:54<10:56, 19.91s/it]Evaluating gsm8k :  74%|█████████████████████████████████████████████████████████████                     | 93/125 [32:19<11:26, 21.45s/it]Evaluating gsm8k :  75%|█████████████████████████████████████████████████████████████▋                    | 94/125 [32:34<10:12, 19.75s/it]Evaluating gsm8k :  76%|██████████████████████████████████████████████████████████████▎                   | 95/125 [32:59<10:36, 21.23s/it]Evaluating gsm8k :  77%|██████████████████████████████████████████████████████████████▉                   | 96/125 [33:24<10:44, 22.22s/it]Evaluating gsm8k :  78%|███████████████████████████████████████████████████████████████▋                  | 97/125 [33:46<10:26, 22.36s/it]Evaluating gsm8k :  78%|████████████████████████████████████████████████████████████████▎                 | 98/125 [34:09<10:03, 22.37s/it]Evaluating gsm8k :  79%|████████████████████████████████████████████████████████████████▉                 | 99/125 [34:17<07:53, 18.23s/it]Evaluating gsm8k :  80%|████████████████████████████████████████████████████████████████▊                | 100/125 [34:42<08:27, 20.30s/it]Evaluating gsm8k :  81%|█████████████████████████████████████████████████████████████████▍               | 101/125 [34:46<06:05, 15.24s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████               | 102/125 [35:11<06:57, 18.14s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████▋              | 103/125 [35:35<07:22, 20.12s/it]Evaluating gsm8k :  83%|███████████████████████████████████████████████████████████████████▍             | 104/125 [35:44<05:52, 16.80s/it]Evaluating gsm8k :  84%|████████████████████████████████████████████████████████████████████             | 105/125 [36:10<06:25, 19.27s/it]Evaluating gsm8k :  85%|████████████████████████████████████████████████████████████████████▋            | 106/125 [36:34<06:38, 20.96s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▎           | 107/125 [36:59<06:37, 22.10s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▉           | 108/125 [37:14<05:38, 19.89s/it]Evaluating gsm8k :  87%|██████████████████████████████████████████████████████████████████████▋          | 109/125 [37:39<05:41, 21.35s/it]Evaluating gsm8k :  88%|███████████████████████████████████████████████████████████████████████▎         | 110/125 [38:03<05:32, 22.17s/it]Evaluating gsm8k :  89%|███████████████████████████████████████████████████████████████████████▉         | 111/125 [38:28<05:23, 23.10s/it]Evaluating gsm8k :  90%|████████████████████████████████████████████████████████████████████████▌        | 112/125 [38:52<05:05, 23.47s/it]Evaluating gsm8k :  90%|█████████████████████████████████████████████████████████████████████████▏       | 113/125 [39:17<04:45, 23.80s/it]Evaluating gsm8k :  91%|█████████████████████████████████████████████████████████████████████████▊       | 114/125 [39:42<04:26, 24.23s/it]Evaluating gsm8k :  92%|██████████████████████████████████████████████████████████████████████████▌      | 115/125 [40:07<04:03, 24.40s/it]Evaluating gsm8k :  93%|███████████████████████████████████████████████████████████████████████████▏     | 116/125 [40:32<03:40, 24.50s/it]Evaluating gsm8k :  94%|███████████████████████████████████████████████████████████████████████████▊     | 117/125 [40:57<03:17, 24.64s/it]Evaluating gsm8k :  94%|████████████████████████████████████████████████████████████████████████████▍    | 118/125 [41:22<02:53, 24.73s/it]Evaluating gsm8k :  95%|█████████████████████████████████████████████████████████████████████████████    | 119/125 [41:33<02:03, 20.60s/it]Evaluating gsm8k :  96%|█████████████████████████████████████████████████████████████████████████████▊   | 120/125 [41:57<01:49, 21.84s/it]Evaluating gsm8k :  97%|██████████████████████████████████████████████████████████████████████████████▍  | 121/125 [42:20<01:28, 22.23s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████  | 122/125 [42:45<01:08, 22.99s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████▋ | 123/125 [43:06<00:44, 22.33s/it]Evaluating gsm8k :  99%|████████████████████████████████████████████████████████████████████████████████▎| 124/125 [43:31<00:23, 23.07s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [43:46<00:00, 20.83s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [43:46<00:00, 21.02s/it]
name: gsm8k | {'exact_match': 0.0, 'rougeL': 0.2746} | lm_loss 11.3286 | avg. gen lenth: 323.78
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name gsm8k --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name commonsenseqa --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 2 --data-dir /scratch/ylu130/processed_data/gsm8k/out-domain/o4-tcommonsenseqa-s10-rTrue --seed 10 --max-prompt-length 2048 --rationales --num-out-domain 4
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-18 07:34:09,730] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... gsm8k
  data_dir ..................... /scratch/ylu130/processed_data/gsm8k/out-domain/o4-tcommonsenseqa-s10-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 4
  out_domain_data_name ......... commonsenseqa
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o4-tcommonsenseqa-s10-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 2
  clip_grad .................... 1.0
  seed ......................... 10
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                                             | 0/7473 [00:00<?, ?it/s]  0%|▎                                                                                                  | 27/7473 [00:00<00:28, 263.15it/s]  1%|▋                                                                                                  | 54/7473 [00:00<00:28, 263.66it/s]  1%|█                                                                                                  | 81/7473 [00:00<00:27, 264.15it/s]  1%|█▍                                                                                                | 108/7473 [00:00<00:27, 264.92it/s]  2%|█▊                                                                                                | 135/7473 [00:00<00:27, 265.23it/s]  2%|██                                                                                                | 162/7473 [00:00<00:27, 266.01it/s]  3%|██▍                                                                                               | 189/7473 [00:00<00:27, 265.97it/s]  3%|██▊                                                                                               | 216/7473 [00:00<00:27, 262.84it/s]  3%|███▏                                                                                              | 243/7473 [00:00<00:27, 262.74it/s]  4%|███▌                                                                                              | 270/7473 [00:01<00:27, 260.23it/s]  4%|███▉                                                                                              | 297/7473 [00:01<00:27, 261.39it/s]  4%|████▏                                                                                             | 324/7473 [00:01<00:27, 262.41it/s]  5%|████▌                                                                                             | 351/7473 [00:01<00:27, 263.01it/s]  5%|████▉                                                                                             | 378/7473 [00:01<00:26, 262.88it/s]  5%|█████▎                                                                                            | 405/7473 [00:01<00:26, 262.52it/s]  6%|█████▋                                                                                            | 432/7473 [00:01<00:26, 263.21it/s]  6%|██████                                                                                            | 459/7473 [00:01<00:26, 263.23it/s]  7%|██████▎                                                                                           | 486/7473 [00:01<00:26, 260.77it/s]  7%|██████▋                                                                                           | 513/7473 [00:01<00:26, 262.02it/s]  7%|███████                                                                                           | 540/7473 [00:02<00:26, 263.88it/s]  8%|███████▍                                                                                          | 567/7473 [00:02<00:26, 264.65it/s]  8%|███████▊                                                                                          | 594/7473 [00:02<00:25, 264.67it/s]  8%|████████▏                                                                                         | 621/7473 [00:02<00:25, 264.17it/s]  9%|████████▍                                                                                         | 648/7473 [00:02<00:25, 264.71it/s]  9%|████████▉                                                                                         | 683/7473 [00:02<00:23, 289.64it/s] 10%|█████████▍                                                                                        | 724/7473 [00:02<00:20, 323.42it/s] 10%|██████████                                                                                        | 765/7473 [00:02<00:19, 348.21it/s] 11%|██████████▌                                                                                       | 806/7473 [00:02<00:18, 364.67it/s] 11%|███████████                                                                                       | 847/7473 [00:02<00:17, 377.01it/s] 12%|███████████▋                                                                                      | 888/7473 [00:03<00:17, 386.04it/s] 12%|████████████▏                                                                                     | 928/7473 [00:03<00:16, 389.74it/s] 13%|████████████▋                                                                                     | 969/7473 [00:03<00:16, 393.64it/s] 14%|█████████████                                                                                    | 1010/7473 [00:03<00:16, 396.87it/s] 14%|█████████████▋                                                                                   | 1051/7473 [00:03<00:16, 399.48it/s] 15%|██████████████▏                                                                                  | 1092/7473 [00:03<00:15, 401.61it/s] 15%|██████████████▋                                                                                  | 1133/7473 [00:03<00:15, 402.16it/s] 16%|███████████████▏                                                                                 | 1174/7473 [00:03<00:15, 401.21it/s] 16%|███████████████▊                                                                                 | 1215/7473 [00:03<00:15, 401.97it/s] 17%|████████████████▎                                                                                | 1256/7473 [00:03<00:15, 402.55it/s] 17%|████████████████▊                                                                                | 1297/7473 [00:04<00:15, 403.36it/s] 18%|█████████████████▎                                                                               | 1338/7473 [00:04<00:15, 404.24it/s] 18%|█████████████████▉                                                                               | 1379/7473 [00:04<00:15, 404.55it/s] 19%|██████████████████▍                                                                              | 1420/7473 [00:04<00:15, 401.64it/s] 20%|██████████████████▉                                                                              | 1461/7473 [00:04<00:15, 398.81it/s] 20%|███████████████████▍                                                                             | 1502/7473 [00:04<00:14, 400.97it/s] 21%|████████████████████                                                                             | 1543/7473 [00:04<00:14, 401.93it/s] 21%|████████████████████▌                                                                            | 1584/7473 [00:04<00:14, 401.20it/s] 22%|█████████████████████                                                                            | 1625/7473 [00:04<00:14, 399.56it/s] 22%|█████████████████████▌                                                                           | 1666/7473 [00:05<00:14, 400.48it/s] 23%|██████████████████████▏                                                                          | 1707/7473 [00:05<00:14, 401.76it/s] 23%|██████████████████████▋                                                                          | 1748/7473 [00:05<00:14, 402.34it/s] 24%|███████████████████████▏                                                                         | 1789/7473 [00:05<00:14, 402.79it/s] 24%|███████████████████████▊                                                                         | 1830/7473 [00:05<00:14, 402.67it/s] 25%|████████████████████████▎                                                                        | 1871/7473 [00:05<00:13, 401.21it/s] 26%|████████████████████████▊                                                                        | 1912/7473 [00:05<00:13, 401.62it/s] 26%|█████████████████████████▎                                                                       | 1953/7473 [00:05<00:13, 399.48it/s] 27%|█████████████████████████▉                                                                       | 1994/7473 [00:05<00:13, 400.63it/s] 27%|██████████████████████████▍                                                                      | 2035/7473 [00:05<00:13, 402.22it/s] 28%|██████████████████████████▉                                                                      | 2076/7473 [00:06<00:13, 400.65it/s] 28%|███████████████████████████▍                                                                     | 2117/7473 [00:06<00:13, 401.37it/s] 29%|████████████████████████████                                                                     | 2158/7473 [00:06<00:13, 402.36it/s] 29%|████████████████████████████▌                                                                    | 2199/7473 [00:06<00:13, 402.69it/s] 30%|█████████████████████████████                                                                    | 2240/7473 [00:06<00:12, 403.34it/s] 31%|█████████████████████████████▌                                                                   | 2281/7473 [00:06<00:12, 403.16it/s] 31%|██████████████████████████████▏                                                                  | 2322/7473 [00:06<00:12, 401.82it/s] 32%|██████████████████████████████▋                                                                  | 2363/7473 [00:06<00:12, 401.51it/s] 32%|███████████████████████████████▏                                                                 | 2404/7473 [00:06<00:12, 402.00it/s] 33%|███████████████████████████████▋                                                                 | 2445/7473 [00:06<00:12, 402.90it/s] 33%|████████████████████████████████▎                                                                | 2486/7473 [00:07<00:12, 403.30it/s] 34%|████████████████████████████████▊                                                                | 2527/7473 [00:07<00:13, 370.75it/s] 34%|█████████████████████████████████▎                                                               | 2568/7473 [00:07<00:12, 379.66it/s] 35%|█████████████████████████████████▊                                                               | 2609/7473 [00:07<00:12, 386.17it/s] 35%|██████████████████████████████████▍                                                              | 2649/7473 [00:07<00:12, 389.79it/s] 36%|██████████████████████████████████▉                                                              | 2690/7473 [00:07<00:12, 393.94it/s] 37%|███████████████████████████████████▍                                                             | 2730/7473 [00:07<00:12, 394.77it/s] 37%|███████████████████████████████████▉                                                             | 2770/7473 [00:07<00:11, 396.03it/s] 38%|████████████████████████████████████▍                                                            | 2811/7473 [00:07<00:11, 398.97it/s] 38%|█████████████████████████████████████                                                            | 2852/7473 [00:07<00:11, 400.99it/s] 39%|█████████████████████████████████████▌                                                           | 2893/7473 [00:08<00:11, 402.16it/s] 39%|██████████████████████████████████████                                                           | 2934/7473 [00:08<00:11, 403.40it/s] 40%|██████████████████████████████████████▌                                                          | 2975/7473 [00:08<00:11, 401.92it/s] 40%|███████████████████████████████████████▏                                                         | 3016/7473 [00:08<00:11, 402.83it/s] 41%|███████████████████████████████████████▋                                                         | 3057/7473 [00:08<00:10, 403.06it/s] 41%|████████████████████████████████████████▏                                                        | 3098/7473 [00:08<00:10, 403.26it/s] 42%|████████████████████████████████████████▋                                                        | 3139/7473 [00:08<00:10, 402.19it/s] 43%|█████████████████████████████████████████▎                                                       | 3180/7473 [00:08<00:10, 402.78it/s] 43%|█████████████████████████████████████████▊                                                       | 3221/7473 [00:08<00:10, 401.60it/s] 44%|██████████████████████████████████████████▎                                                      | 3262/7473 [00:08<00:10, 402.37it/s] 44%|██████████████████████████████████████████▊                                                      | 3303/7473 [00:09<00:10, 402.87it/s] 45%|███████████████████████████████████████████▍                                                     | 3344/7473 [00:09<00:10, 400.50it/s] 45%|███████████████████████████████████████████▉                                                     | 3385/7473 [00:09<00:10, 401.08it/s] 46%|████████████████████████████████████████████▍                                                    | 3426/7473 [00:09<00:10, 401.73it/s] 46%|█████████████████████████████████████████████                                                    | 3467/7473 [00:09<00:10, 398.90it/s] 47%|█████████████████████████████████████████████▌                                                   | 3508/7473 [00:09<00:09, 399.81it/s] 47%|██████████████████████████████████████████████                                                   | 3549/7473 [00:09<00:09, 400.38it/s] 48%|██████████████████████████████████████████████▌                                                  | 3590/7473 [00:09<00:09, 401.19it/s] 49%|███████████████████████████████████████████████▏                                                 | 3631/7473 [00:09<00:09, 400.98it/s] 49%|███████████████████████████████████████████████▋                                                 | 3672/7473 [00:10<00:09, 398.21it/s] 50%|████████████████████████████████████████████████▏                                                | 3712/7473 [00:10<00:09, 398.54it/s] 50%|████████████████████████████████████████████████▋                                                | 3752/7473 [00:10<00:09, 398.91it/s] 51%|█████████████████████████████████████████████████▏                                               | 3793/7473 [00:10<00:09, 399.55it/s] 51%|█████████████████████████████████████████████████▊                                               | 3833/7473 [00:10<00:09, 398.91it/s] 52%|██████████████████████████████████████████████████▎                                              | 3874/7473 [00:10<00:09, 399.63it/s] 52%|██████████████████████████████████████████████████▊                                              | 3914/7473 [00:10<00:08, 398.85it/s] 53%|███████████████████████████████████████████████████▎                                             | 3955/7473 [00:10<00:08, 399.39it/s] 53%|███████████████████████████████████████████████████▊                                             | 3995/7473 [00:10<00:08, 396.67it/s] 54%|████████████████████████████████████████████████████▍                                            | 4036/7473 [00:10<00:08, 399.00it/s] 55%|████████████████████████████████████████████████████▉                                            | 4077/7473 [00:11<00:08, 399.44it/s] 55%|█████████████████████████████████████████████████████▍                                           | 4117/7473 [00:11<00:08, 395.40it/s] 56%|█████████████████████████████████████████████████████▉                                           | 4157/7473 [00:11<00:08, 396.55it/s] 56%|██████████████████████████████████████████████████████▍                                          | 4198/7473 [00:11<00:08, 397.89it/s] 57%|███████████████████████████████████████████████████████                                          | 4238/7473 [00:11<00:08, 397.31it/s] 57%|███████████████████████████████████████████████████████▌                                         | 4278/7473 [00:11<00:08, 396.31it/s] 58%|████████████████████████████████████████████████████████                                         | 4318/7473 [00:11<00:07, 397.32it/s] 58%|████████████████████████████████████████████████████████▌                                        | 4358/7473 [00:11<00:07, 396.77it/s] 59%|█████████████████████████████████████████████████████████                                        | 4398/7473 [00:11<00:07, 397.63it/s] 59%|█████████████████████████████████████████████████████████▌                                       | 4438/7473 [00:11<00:07, 397.16it/s] 60%|██████████████████████████████████████████████████████████                                       | 4478/7473 [00:12<00:07, 397.99it/s] 60%|██████████████████████████████████████████████████████████▋                                      | 4518/7473 [00:12<00:07, 397.87it/s] 61%|███████████████████████████████████████████████████████████▏                                     | 4559/7473 [00:12<00:07, 400.24it/s] 62%|███████████████████████████████████████████████████████████▋                                     | 4600/7473 [00:12<00:07, 398.50it/s] 62%|████████████████████████████████████████████████████████████▏                                    | 4640/7473 [00:12<00:07, 398.36it/s] 63%|████████████████████████████████████████████████████████████▋                                    | 4680/7473 [00:12<00:07, 394.35it/s] 63%|█████████████████████████████████████████████████████████████▎                                   | 4720/7473 [00:12<00:06, 394.55it/s] 64%|█████████████████████████████████████████████████████████████▊                                   | 4760/7473 [00:12<00:06, 394.71it/s] 64%|██████████████████████████████████████████████████████████████▎                                  | 4800/7473 [00:12<00:06, 392.19it/s] 65%|██████████████████████████████████████████████████████████████▊                                  | 4840/7473 [00:12<00:06, 392.80it/s] 65%|███████████████████████████████████████████████████████████████▎                                 | 4880/7473 [00:13<00:06, 391.93it/s] 66%|███████████████████████████████████████████████████████████████▊                                 | 4920/7473 [00:13<00:06, 392.51it/s] 66%|████████████████████████████████████████████████████████████████▍                                | 4960/7473 [00:13<00:06, 392.69it/s] 67%|████████████████████████████████████████████████████████████████▉                                | 5000/7473 [00:13<00:06, 392.95it/s] 67%|█████████████████████████████████████████████████████████████████▍                               | 5040/7473 [00:13<00:06, 391.88it/s] 68%|█████████████████████████████████████████████████████████████████▉                               | 5080/7473 [00:13<00:06, 392.68it/s] 69%|██████████████████████████████████████████████████████████████████▍                              | 5120/7473 [00:13<00:05, 392.52it/s] 69%|██████████████████████████████████████████████████████████████████▉                              | 5160/7473 [00:13<00:05, 392.74it/s] 70%|███████████████████████████████████████████████████████████████████▌                             | 5201/7473 [00:13<00:05, 395.27it/s] 70%|████████████████████████████████████████████████████████████████████                             | 5242/7473 [00:13<00:05, 397.13it/s] 71%|████████████████████████████████████████████████████████████████████▌                            | 5282/7473 [00:14<00:05, 373.20it/s] 71%|█████████████████████████████████████████████████████████████████████                            | 5321/7473 [00:14<00:05, 377.32it/s] 72%|█████████████████████████████████████████████████████████████████████▌                           | 5362/7473 [00:14<00:05, 383.99it/s] 72%|██████████████████████████████████████████████████████████████████████▏                          | 5403/7473 [00:14<00:05, 389.46it/s] 73%|██████████████████████████████████████████████████████████████████████▋                          | 5444/7473 [00:14<00:05, 393.42it/s] 73%|███████████████████████████████████████████████████████████████████████▏                         | 5484/7473 [00:14<00:06, 303.48it/s] 74%|███████████████████████████████████████████████████████████████████████▋                         | 5524/7473 [00:14<00:05, 325.98it/s] 74%|████████████████████████████████████████████████████████████████████████▏                        | 5564/7473 [00:14<00:05, 344.21it/s] 75%|████████████████████████████████████████████████████████████████████████▋                        | 5604/7473 [00:15<00:05, 357.83it/s] 76%|█████████████████████████████████████████████████████████████████████████▎                       | 5644/7473 [00:15<00:04, 368.02it/s] 76%|█████████████████████████████████████████████████████████████████████████▊                       | 5684/7473 [00:15<00:04, 374.43it/s] 77%|██████████████████████████████████████████████████████████████████████████▎                      | 5724/7473 [00:15<00:04, 379.91it/s] 77%|██████████████████████████████████████████████████████████████████████████▊                      | 5764/7473 [00:15<00:04, 384.40it/s] 78%|███████████████████████████████████████████████████████████████████████████▎                     | 5804/7473 [00:15<00:04, 388.08it/s] 78%|███████████████████████████████████████████████████████████████████████████▊                     | 5844/7473 [00:15<00:04, 390.43it/s] 79%|████████████████████████████████████████████████████████████████████████████▎                    | 5884/7473 [00:15<00:04, 393.02it/s] 79%|████████████████████████████████████████████████████████████████████████████▉                    | 5924/7473 [00:15<00:03, 391.69it/s] 80%|█████████████████████████████████████████████████████████████████████████████▍                   | 5964/7473 [00:15<00:03, 389.64it/s] 80%|█████████████████████████████████████████████████████████████████████████████▉                   | 6004/7473 [00:16<00:03, 391.27it/s] 81%|██████████████████████████████████████████████████████████████████████████████▍                  | 6044/7473 [00:16<00:03, 392.59it/s] 81%|██████████████████████████████████████████████████████████████████████████████▉                  | 6085/7473 [00:16<00:03, 396.55it/s] 82%|███████████████████████████████████████████████████████████████████████████████▌                 | 6126/7473 [00:16<00:03, 398.33it/s] 83%|████████████████████████████████████████████████████████████████████████████████                 | 6166/7473 [00:16<00:03, 397.56it/s] 83%|████████████████████████████████████████████████████████████████████████████████▌                | 6206/7473 [00:16<00:03, 397.68it/s] 84%|█████████████████████████████████████████████████████████████████████████████████                | 6246/7473 [00:16<00:03, 398.03it/s] 84%|█████████████████████████████████████████████████████████████████████████████████▌               | 6286/7473 [00:16<00:02, 397.60it/s] 85%|██████████████████████████████████████████████████████████████████████████████████               | 6326/7473 [00:16<00:02, 397.77it/s] 85%|██████████████████████████████████████████████████████████████████████████████████▋              | 6366/7473 [00:16<00:02, 395.34it/s] 86%|███████████████████████████████████████████████████████████████████████████████████▏             | 6406/7473 [00:17<00:02, 395.21it/s] 86%|███████████████████████████████████████████████████████████████████████████████████▋             | 6446/7473 [00:17<00:02, 396.43it/s] 87%|████████████████████████████████████████████████████████████████████████████████████▏            | 6486/7473 [00:17<00:02, 396.38it/s] 87%|████████████████████████████████████████████████████████████████████████████████████▋            | 6526/7473 [00:17<00:02, 395.90it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████▏           | 6567/7473 [00:17<00:02, 396.92it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████▊           | 6607/7473 [00:17<00:02, 396.55it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████▎          | 6647/7473 [00:17<00:02, 393.03it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████▊          | 6687/7473 [00:17<00:01, 394.23it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████▎         | 6727/7473 [00:17<00:01, 395.01it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████▊         | 6767/7473 [00:17<00:01, 396.33it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████▎        | 6807/7473 [00:18<00:01, 397.35it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████▊        | 6847/7473 [00:18<00:01, 394.88it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████▍       | 6887/7473 [00:18<00:01, 395.30it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████▉       | 6928/7473 [00:18<00:01, 397.50it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████▍      | 6969/7473 [00:18<00:01, 398.31it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████▉      | 7010/7473 [00:18<00:01, 399.13it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████▌     | 7050/7473 [00:18<00:01, 398.04it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████     | 7091/7473 [00:18<00:00, 400.15it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████▌    | 7132/7473 [00:18<00:00, 400.51it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████    | 7173/7473 [00:18<00:00, 400.21it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████▋   | 7214/7473 [00:19<00:00, 400.43it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████▏  | 7255/7473 [00:19<00:00, 400.47it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████▋  | 7296/7473 [00:19<00:00, 399.97it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████▏ | 7336/7473 [00:19<00:00, 396.54it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████▊ | 7377/7473 [00:19<00:00, 397.49it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████▎| 7418/7473 [00:19<00:00, 398.98it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████▊| 7459/7473 [00:19<00:00, 399.34it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 7473/7473 [00:19<00:00, 378.73it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:04<00:09,  4.99s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.20s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.13s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.28s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.09s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.29s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.23s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.30s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.49s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.64s/it]
[2023-08-18 07:35:20,701] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.58s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.74s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.62s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.79s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.70s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.86s/it]
[2023-08-18 07:35:33,651] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-18 07:35:33,652] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-18 07:35:33,652] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-18 07:35:33,652] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-18 07:35:33,652] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-18 07:35:33,652] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7ff220021370>
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7ff220021190>
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-18 07:35:33,653] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-18 07:35:33,654] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-18 07:35:33,654] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-18 07:35:33,654] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-18 07:35:33,654] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-18 07:35:33,654] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-18 07:35:33,654] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-18 07:35:33,654] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-18 07:35:33,654] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-18 07:35:33,654] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-18 07:35:33,654] [INFO] [config.py:1012:print]   train_batch_size ............. 8
[2023-08-18 07:35:33,654] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  2
[2023-08-18 07:35:33,654] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-18 07:35:33,654] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-18 07:35:33,654] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-18 07:35:33,654] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-18 07:35:33,654] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-18 07:35:33,654] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-18 07:35:33,654] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-18 07:35:33,654] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.40275120735168457 seconds
Time to load utils op: 0.5049753189086914 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating gsm8k :   0%|                                                                                           | 0/125 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following grade math question.

Input: Fabric is cut to order at what type of seller? Choices:  A: curtains B: tailor shop C: clothing store D: sewing room E: hardware store
Output: 1. The question is asking where fabric can be custom cut to order.
2. Option A, curtains, is a product rather than a seller so can be discounted.
3. Option C, a clothing store, is possible but usually stores sell pre-made clothing.
4. Option E, a hardware store primarily sells tools and other hardware items. It isn't associated with fabric.
5. Option D, a sewing room, is a place where one might cut fabric, but it's not necessarily a seller. 
6. Thus, option B, a tailor shop, is the most logical answer. Tailor shops are places where fabric is specifically cut to order for custom-made clothing.
So the final answer is B: tailor shop

Input: Where are you if your reading magazines while waiting for a vehicle on rails? Choices:  A: vegetables B: market C: doctor D: train station E: bookstore
Output: 1. The question asks where one would be when waiting for a vehicle on rails while reading magazines.
2. The vehicle on rails mentioned is a common description of a train. 
3. You would wait for a train at a train station. 
4. Considering the other options: Vegetables is not a place, so it can be dismissed. The likelihood of waiting for a train at a market, a doctor's office, or a bookstore is low. 
5. Therefore, the most reasonable answer is D: train station.
So the final answer is D: train station

Input: What would need oil to be used? Choices:  A: ground B: human  body C: repair shop D: combustion engines E: service station
Output: 1. The question asks us to evaluate which one of the provided options would require oil.
2. The first option, "ground", does not typically need oil. Oil can sometimes be used in soil treatments, but it is not generally necessary.
3. The second option, "human body", does not typically require oil either. While there are some oils (like essential oils) used in homeopathic remedies or beauty treatments, our bodies do not inherently need oil to function properly.
4. The third option, "repair shop", could potentially use oil for various tasks such as maintaining and fixing machinery or vehicles. However, a repair shop itself does not possess an inherent need for oil. The need for oil is dependent on the specifics of the work being done - which could range from fixing cars (where oil might be needed) to repairing electronic devices (where oil would not be needed).
5. The fourth option, "combustion engines", require oil to function properly. Cars and other machines with combustion engines need oil for lubrication, to help remove heat from the combustion chamber, and to move internal components smoothly.
6. The fifth option, "service station", similar to the "repair shop", could potentially use oil but does not inherently need it. The need for oil depends on the types of services offered at the station.
7. Therefore, the only option that inherently needs oil to function is D: combustion engines.
So the final answer is D: combustion engines

Input: What is person probably feeling that plans on stopping being married to their spouse? Choices:  A: detachment B: bankruptcy C: sad D: fights E: wrong
Output: 1. The first step is to understand the question. You need to determine what emotion or state a person may be experiencing given they plan on ending their marriage. 
2. Now, let's consider the options: detachment, bankruptcy, sadness, fights, or wrongness. 
3. The options 'bankruptcy' and 'fights' could be associated with the aftermath or reasons of a divorce, but they aren't states or emotions a person feels. Thus, we can eliminate options B and D. 
4. 'Wrongness' is usually associated with guilt or making a mistake, and while that could be a possible feeling, it's not the most likely one in anticipation of ending a marriage. So, lets also eliminate E.
5. That leaves us with 'detachment' and'sadness'. Both could arguably apply since a person might be feeling sad about ending their marriage. However, if a person is planning to end their marriage, they likely feel a significant emotional distance or 'detachment' from their spouse. This makes option A, detachment, the most probable feeling.
6. Hence, the solution is A: detachment.
So the final answer is A: detachment

Input:Natalia sold clips to 48 of her friends in April, and then she sold half as many clips in May. How many clips did Natalia sell altogether in April and May?
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o4-tcommonsenseqa-s10-rTrue
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.5047147274017334 seconds
Time to load utils op: 0.4045591354370117 seconds
Evaluating gsm8k :   1%|▋                                                                                  | 1/125 [00:25<52:46, 25.54s/it]Evaluating gsm8k :   2%|█▎                                                                                 | 2/125 [00:38<37:07, 18.11s/it]Evaluating gsm8k :   2%|█▉                                                                                 | 3/125 [01:02<42:17, 20.80s/it]Evaluating gsm8k :   3%|██▋                                                                                | 4/125 [01:17<37:21, 18.52s/it]Evaluating gsm8k :   4%|███▎                                                                               | 5/125 [01:41<40:51, 20.43s/it]Evaluating gsm8k :   5%|███▉                                                                               | 6/125 [02:05<42:51, 21.61s/it]Evaluating gsm8k :   6%|████▋                                                                              | 7/125 [02:29<43:56, 22.34s/it]Evaluating gsm8k :   6%|█████▎                                                                             | 8/125 [02:52<44:31, 22.83s/it]Evaluating gsm8k :   7%|█████▉                                                                             | 9/125 [03:06<38:33, 19.94s/it]Evaluating gsm8k :   8%|██████▌                                                                           | 10/125 [03:30<40:33, 21.16s/it]Evaluating gsm8k :   9%|███████▏                                                                          | 11/125 [03:54<41:56, 22.07s/it]Evaluating gsm8k :  10%|███████▊                                                                          | 12/125 [04:12<39:27, 20.96s/it]Evaluating gsm8k :  10%|████████▌                                                                         | 13/125 [04:36<40:50, 21.88s/it]Evaluating gsm8k :  11%|█████████▏                                                                        | 14/125 [05:00<41:34, 22.47s/it]Evaluating gsm8k :  12%|█████████▊                                                                        | 15/125 [05:24<42:00, 22.92s/it]Evaluating gsm8k :  13%|██████████▍                                                                       | 16/125 [05:41<38:21, 21.12s/it]Evaluating gsm8k :  14%|███████████▏                                                                      | 17/125 [06:05<39:38, 22.03s/it]Evaluating gsm8k :  14%|███████████▊                                                                      | 18/125 [06:29<40:22, 22.64s/it]Evaluating gsm8k :  15%|████████████▍                                                                     | 19/125 [06:53<40:39, 23.01s/it]Evaluating gsm8k :  16%|█████████████                                                                     | 20/125 [07:05<34:06, 19.49s/it]Evaluating gsm8k :  17%|█████████████▊                                                                    | 21/125 [07:28<36:04, 20.81s/it]Evaluating gsm8k :  18%|██████████████▍                                                                   | 22/125 [07:50<36:11, 21.08s/it]Evaluating gsm8k :  18%|███████████████                                                                   | 23/125 [08:14<37:29, 22.06s/it]Evaluating gsm8k :  19%|███████████████▋                                                                  | 24/125 [08:38<37:56, 22.53s/it]Evaluating gsm8k :  20%|████████████████▍                                                                 | 25/125 [09:02<38:18, 22.98s/it]Evaluating gsm8k :  21%|█████████████████                                                                 | 26/125 [09:23<36:57, 22.40s/it]Evaluating gsm8k :  22%|█████████████████▋                                                                | 27/125 [09:47<37:29, 22.96s/it]Evaluating gsm8k :  22%|██████████████████▎                                                               | 28/125 [10:05<34:31, 21.35s/it]Evaluating gsm8k :  23%|███████████████████                                                               | 29/125 [10:27<34:13, 21.39s/it]Evaluating gsm8k :  24%|███████████████████▋                                                              | 30/125 [10:50<35:01, 22.12s/it]Evaluating gsm8k :  25%|████████████████████▎                                                             | 31/125 [11:15<35:36, 22.73s/it]Evaluating gsm8k :  26%|████████████████████▉                                                             | 32/125 [11:39<35:50, 23.13s/it]Evaluating gsm8k :  26%|█████████████████████▋                                                            | 33/125 [11:52<30:46, 20.07s/it]Evaluating gsm8k :  27%|██████████████████████▎                                                           | 34/125 [12:16<32:15, 21.27s/it]Evaluating gsm8k :  28%|██████████████████████▉                                                           | 35/125 [12:30<28:48, 19.21s/it]Evaluating gsm8k :  29%|███████████████████████▌                                                          | 36/125 [12:54<30:44, 20.73s/it]Evaluating gsm8k :  30%|████████████████████████▎                                                         | 37/125 [13:16<30:57, 21.11s/it]Evaluating gsm8k :  30%|████████████████████████▉                                                         | 38/125 [13:32<28:21, 19.56s/it]Evaluating gsm8k :  31%|█████████████████████████▌                                                        | 39/125 [13:56<29:48, 20.80s/it]Evaluating gsm8k :  32%|██████████████████████████▏                                                       | 40/125 [14:09<26:08, 18.46s/it]Evaluating gsm8k :  33%|██████████████████████████▉                                                       | 41/125 [14:33<28:17, 20.21s/it]Evaluating gsm8k :  34%|███████████████████████████▌                                                      | 42/125 [14:57<29:36, 21.41s/it]Evaluating gsm8k :  34%|████████████████████████████▏                                                     | 43/125 [15:21<30:18, 22.17s/it]Evaluating gsm8k :  35%|████████████████████████████▊                                                     | 44/125 [15:38<27:34, 20.42s/it]Evaluating gsm8k :  36%|█████████████████████████████▌                                                    | 45/125 [15:50<23:53, 17.92s/it]Evaluating gsm8k :  37%|██████████████████████████████▏                                                   | 46/125 [16:14<25:59, 19.74s/it]Evaluating gsm8k :  38%|██████████████████████████████▊                                                   | 47/125 [16:38<27:17, 20.99s/it]Evaluating gsm8k :  38%|███████████████████████████████▍                                                  | 48/125 [17:01<27:49, 21.68s/it]Evaluating gsm8k :  39%|████████████████████████████████▏                                                 | 49/125 [17:14<24:16, 19.17s/it]Evaluating gsm8k :  40%|████████████████████████████████▊                                                 | 50/125 [17:34<24:09, 19.33s/it]Evaluating gsm8k :  41%|█████████████████████████████████▍                                                | 51/125 [17:58<25:35, 20.75s/it]Evaluating gsm8k :  42%|██████████████████████████████████                                                | 52/125 [18:22<26:32, 21.81s/it]Evaluating gsm8k :  42%|██████████████████████████████████▊                                               | 53/125 [18:46<27:01, 22.52s/it]Evaluating gsm8k :  43%|███████████████████████████████████▍                                              | 54/125 [19:10<27:10, 22.96s/it]Evaluating gsm8k :  44%|████████████████████████████████████                                              | 55/125 [19:29<25:19, 21.70s/it]Evaluating gsm8k :  45%|████████████████████████████████████▋                                             | 56/125 [19:53<25:46, 22.42s/it]Evaluating gsm8k :  46%|█████████████████████████████████████▍                                            | 57/125 [20:17<25:55, 22.87s/it]Evaluating gsm8k :  46%|██████████████████████████████████████                                            | 58/125 [20:41<25:53, 23.18s/it]Evaluating gsm8k :  47%|██████████████████████████████████████▋                                           | 59/125 [21:05<25:44, 23.40s/it]Evaluating gsm8k :  48%|███████████████████████████████████████▎                                          | 60/125 [21:29<25:31, 23.55s/it]Evaluating gsm8k :  49%|████████████████████████████████████████                                          | 61/125 [21:45<22:36, 21.20s/it]Evaluating gsm8k :  50%|████████████████████████████████████████▋                                         | 62/125 [22:09<23:08, 22.03s/it]Evaluating gsm8k :  50%|█████████████████████████████████████████▎                                        | 63/125 [22:21<19:46, 19.13s/it]Evaluating gsm8k :  51%|█████████████████████████████████████████▉                                        | 64/125 [22:32<16:56, 16.66s/it]Evaluating gsm8k :  52%|██████████████████████████████████████████▋                                       | 65/125 [22:56<18:53, 18.90s/it]Evaluating gsm8k :  53%|███████████████████████████████████████████▎                                      | 66/125 [23:15<18:42, 19.02s/it]Evaluating gsm8k :  54%|███████████████████████████████████████████▉                                      | 67/125 [23:34<18:16, 18.91s/it]Evaluating gsm8k :  54%|████████████████████████████████████████████▌                                     | 68/125 [23:45<15:35, 16.41s/it]Evaluating gsm8k :  55%|█████████████████████████████████████████████▎                                    | 69/125 [24:09<17:26, 18.69s/it]Evaluating gsm8k :  56%|█████████████████████████████████████████████▉                                    | 70/125 [24:33<18:40, 20.38s/it]Evaluating gsm8k :  57%|██████████████████████████████████████████████▌                                   | 71/125 [24:57<19:18, 21.45s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▏                                  | 72/125 [25:21<19:39, 22.26s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▉                                  | 73/125 [25:41<18:50, 21.74s/it]Evaluating gsm8k :  59%|████████████████████████████████████████████████▌                                 | 74/125 [26:05<19:02, 22.39s/it]Evaluating gsm8k :  60%|█████████████████████████████████████████████████▏                                | 75/125 [26:30<19:05, 22.92s/it]Evaluating gsm8k :  61%|█████████████████████████████████████████████████▊                                | 76/125 [26:53<18:44, 22.95s/it]Evaluating gsm8k :  62%|██████████████████████████████████████████████████▌                               | 77/125 [27:17<18:39, 23.32s/it]Evaluating gsm8k :  62%|███████████████████████████████████████████████████▏                              | 78/125 [27:41<18:24, 23.50s/it]Evaluating gsm8k :  63%|███████████████████████████████████████████████████▊                              | 79/125 [27:56<16:14, 21.19s/it]Evaluating gsm8k :  64%|████████████████████████████████████████████████████▍                             | 80/125 [28:20<16:28, 21.97s/it]Evaluating gsm8k :  65%|█████████████████████████████████████████████████████▏                            | 81/125 [28:44<16:33, 22.58s/it]Evaluating gsm8k :  66%|█████████████████████████████████████████████████████▊                            | 82/125 [29:08<16:30, 23.03s/it]Evaluating gsm8k :  66%|██████████████████████████████████████████████████████▍                           | 83/125 [29:32<16:18, 23.29s/it]Evaluating gsm8k :  67%|███████████████████████████████████████████████████████                           | 84/125 [29:56<16:04, 23.52s/it]Evaluating gsm8k :  68%|███████████████████████████████████████████████████████▊                          | 85/125 [30:20<15:47, 23.69s/it]Evaluating gsm8k :  69%|████████████████████████████████████████████████████████▍                         | 86/125 [30:45<15:32, 23.91s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████                         | 87/125 [31:09<15:14, 24.06s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████▋                        | 88/125 [31:33<14:51, 24.09s/it]Evaluating gsm8k :  71%|██████████████████████████████████████████████████████████▍                       | 89/125 [31:54<13:47, 22.98s/it]Evaluating gsm8k :  72%|███████████████████████████████████████████████████████████                       | 90/125 [32:18<13:35, 23.30s/it]Evaluating gsm8k :  73%|███████████████████████████████████████████████████████████▋                      | 91/125 [32:42<13:23, 23.63s/it]Evaluating gsm8k :  74%|████████████████████████████████████████████████████████████▎                     | 92/125 [33:06<13:03, 23.73s/it]Evaluating gsm8k :  74%|█████████████████████████████████████████████████████████████                     | 93/125 [33:31<12:45, 23.92s/it]Evaluating gsm8k :  75%|█████████████████████████████████████████████████████████████▋                    | 94/125 [33:52<11:56, 23.11s/it]Evaluating gsm8k :  76%|██████████████████████████████████████████████████████████████▎                   | 95/125 [34:16<11:40, 23.35s/it]Evaluating gsm8k :  77%|██████████████████████████████████████████████████████████████▉                   | 96/125 [34:39<11:20, 23.48s/it]Evaluating gsm8k :  78%|███████████████████████████████████████████████████████████████▋                  | 97/125 [34:54<09:38, 20.65s/it]Evaluating gsm8k :  78%|████████████████████████████████████████████████████████████████▎                 | 98/125 [35:18<09:44, 21.66s/it]Evaluating gsm8k :  79%|████████████████████████████████████████████████████████████████▉                 | 99/125 [35:42<09:43, 22.45s/it]Evaluating gsm8k :  80%|████████████████████████████████████████████████████████████████▊                | 100/125 [35:49<07:25, 17.81s/it]Evaluating gsm8k :  81%|█████████████████████████████████████████████████████████████████▍               | 101/125 [36:13<07:52, 19.69s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████               | 102/125 [36:37<08:03, 21.03s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████▋              | 103/125 [36:43<06:06, 16.65s/it]Evaluating gsm8k :  83%|███████████████████████████████████████████████████████████████████▍             | 104/125 [36:58<05:33, 15.86s/it]Evaluating gsm8k :  84%|████████████████████████████████████████████████████████████████████             | 105/125 [37:21<06:05, 18.28s/it]Evaluating gsm8k :  85%|████████████████████████████████████████████████████████████████████▋            | 106/125 [37:45<06:19, 19.97s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▎           | 107/125 [38:09<06:20, 21.16s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▉           | 108/125 [38:33<06:14, 22.02s/it]Evaluating gsm8k :  87%|██████████████████████████████████████████████████████████████████████▋          | 109/125 [38:48<05:18, 19.90s/it]Evaluating gsm8k :  88%|███████████████████████████████████████████████████████████████████████▎         | 110/125 [39:12<05:16, 21.13s/it]Evaluating gsm8k :  89%|███████████████████████████████████████████████████████████████████████▉         | 111/125 [39:24<04:18, 18.46s/it]Evaluating gsm8k :  90%|████████████████████████████████████████████████████████████████████████▌        | 112/125 [39:39<03:44, 17.30s/it]Evaluating gsm8k :  90%|█████████████████████████████████████████████████████████████████████████▏       | 113/125 [40:03<03:51, 19.27s/it]Evaluating gsm8k :  91%|█████████████████████████████████████████████████████████████████████████▊       | 114/125 [40:18<03:16, 17.86s/it]Evaluating gsm8k :  92%|██████████████████████████████████████████████████████████████████████████▌      | 115/125 [40:33<02:52, 17.26s/it]Evaluating gsm8k :  93%|███████████████████████████████████████████████████████████████████████████▏     | 116/125 [40:57<02:53, 19.26s/it]Evaluating gsm8k :  94%|███████████████████████████████████████████████████████████████████████████▊     | 117/125 [41:21<02:45, 20.69s/it]Evaluating gsm8k :  94%|████████████████████████████████████████████████████████████████████████████▍    | 118/125 [41:45<02:31, 21.71s/it]Evaluating gsm8k :  95%|█████████████████████████████████████████████████████████████████████████████    | 119/125 [41:58<01:54, 19.10s/it]Evaluating gsm8k :  96%|█████████████████████████████████████████████████████████████████████████████▊   | 120/125 [42:23<01:43, 20.63s/it]Evaluating gsm8k :  97%|██████████████████████████████████████████████████████████████████████████████▍  | 121/125 [42:39<01:17, 19.45s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████  | 122/125 [43:03<01:02, 20.70s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████▋ | 123/125 [43:27<00:43, 21.74s/it]Evaluating gsm8k :  99%|████████████████████████████████████████████████████████████████████████████████▎| 124/125 [43:51<00:22, 22.53s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [44:15<00:00, 22.97s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [44:15<00:00, 21.25s/it]
name: gsm8k | {'exact_match': 0.0, 'rougeL': 0.3727} | lm_loss 11.1781 | avg. gen lenth: 352.204
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name gsm8k --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name commonsenseqa --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 2 --data-dir /scratch/ylu130/processed_data/gsm8k/out-domain/o5-tcommonsenseqa-s10-rTrue --seed 10 --max-prompt-length 2048 --rationales --num-out-domain 5
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
using world size: 4
[nltk_data]   Package punkt is already up-to-date!
[2023-08-18 08:19:58,600] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... gsm8k
  data_dir ..................... /scratch/ylu130/processed_data/gsm8k/out-domain/o5-tcommonsenseqa-s10-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 5
  out_domain_data_name ......... commonsenseqa
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o5-tcommonsenseqa-s10-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 2
  clip_grad .................... 1.0
  seed ......................... 10
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                                             | 0/7473 [00:00<?, ?it/s]  0%|▎                                                                                                  | 22/7473 [00:00<00:35, 212.30it/s]  1%|▌                                                                                                  | 44/7473 [00:00<00:34, 212.34it/s]  1%|▊                                                                                                  | 66/7473 [00:00<00:34, 212.87it/s]  1%|█▏                                                                                                 | 88/7473 [00:00<00:34, 213.54it/s]  1%|█▍                                                                                                | 110/7473 [00:00<00:34, 213.64it/s]  2%|█▋                                                                                                | 132/7473 [00:00<00:34, 213.62it/s]  2%|██                                                                                                | 154/7473 [00:00<00:34, 214.20it/s]  2%|██▎                                                                                               | 176/7473 [00:00<00:34, 214.06it/s]  3%|██▌                                                                                               | 198/7473 [00:00<00:34, 210.80it/s]  3%|██▉                                                                                               | 220/7473 [00:01<00:34, 211.85it/s]  3%|███▏                                                                                              | 242/7473 [00:01<00:34, 212.09it/s]  4%|███▍                                                                                              | 264/7473 [00:01<00:34, 211.04it/s]  4%|███▊                                                                                              | 286/7473 [00:01<00:33, 212.15it/s]  4%|████                                                                                              | 308/7473 [00:01<00:33, 212.65it/s]  4%|████▎                                                                                             | 330/7473 [00:01<00:33, 213.55it/s]  5%|████▌                                                                                             | 352/7473 [00:01<00:33, 213.52it/s]  5%|████▉                                                                                             | 374/7473 [00:01<00:33, 213.29it/s]  5%|█████▏                                                                                            | 396/7473 [00:01<00:33, 213.34it/s]  6%|█████▍                                                                                            | 418/7473 [00:01<00:33, 211.11it/s]  6%|█████▊                                                                                            | 440/7473 [00:02<00:33, 211.11it/s]  6%|██████                                                                                            | 462/7473 [00:02<00:33, 211.40it/s]  6%|██████▎                                                                                           | 484/7473 [00:02<00:33, 210.07it/s]  7%|██████▋                                                                                           | 506/7473 [00:02<00:33, 210.38it/s]  7%|██████▉                                                                                           | 528/7473 [00:02<00:32, 211.32it/s]  7%|███████▎                                                                                          | 555/7473 [00:02<00:30, 228.03it/s]  8%|███████▋                                                                                          | 588/7473 [00:02<00:26, 256.21it/s]  8%|████████▏                                                                                         | 621/7473 [00:02<00:24, 275.58it/s]  9%|████████▌                                                                                         | 654/7473 [00:02<00:23, 289.96it/s]  9%|█████████                                                                                         | 687/7473 [00:02<00:22, 300.67it/s] 10%|█████████▍                                                                                        | 719/7473 [00:03<00:22, 306.24it/s] 10%|█████████▊                                                                                        | 752/7473 [00:03<00:21, 311.98it/s] 11%|██████████▎                                                                                       | 785/7473 [00:03<00:21, 315.21it/s] 11%|██████████▋                                                                                       | 818/7473 [00:03<00:20, 317.71it/s] 11%|███████████▏                                                                                      | 851/7473 [00:03<00:20, 318.73it/s] 12%|███████████▌                                                                                      | 884/7473 [00:03<00:20, 320.56it/s] 12%|████████████                                                                                      | 917/7473 [00:03<00:20, 321.74it/s] 13%|████████████▍                                                                                     | 950/7473 [00:03<00:20, 321.00it/s] 13%|████████████▉                                                                                     | 983/7473 [00:03<00:20, 322.61it/s] 14%|█████████████▏                                                                                   | 1016/7473 [00:04<00:19, 323.09it/s] 14%|█████████████▌                                                                                   | 1049/7473 [00:04<00:19, 323.41it/s] 14%|██████████████                                                                                   | 1082/7473 [00:04<00:19, 324.39it/s] 15%|██████████████▍                                                                                  | 1115/7473 [00:04<00:19, 324.13it/s] 15%|██████████████▉                                                                                  | 1148/7473 [00:04<00:19, 324.08it/s] 16%|███████████████▎                                                                                 | 1181/7473 [00:04<00:19, 322.14it/s] 16%|███████████████▊                                                                                 | 1214/7473 [00:04<00:19, 322.29it/s] 17%|████████████████▏                                                                                | 1247/7473 [00:04<00:19, 322.57it/s] 17%|████████████████▌                                                                                | 1280/7473 [00:04<00:19, 323.04it/s] 18%|█████████████████                                                                                | 1313/7473 [00:04<00:19, 323.54it/s] 18%|█████████████████▍                                                                               | 1346/7473 [00:05<00:18, 323.88it/s] 18%|█████████████████▉                                                                               | 1379/7473 [00:05<00:18, 323.94it/s] 19%|██████████████████▎                                                                              | 1412/7473 [00:05<00:18, 321.38it/s] 19%|██████████████████▊                                                                              | 1445/7473 [00:05<00:18, 322.07it/s] 20%|███████████████████▏                                                                             | 1478/7473 [00:05<00:18, 322.70it/s] 20%|███████████████████▌                                                                             | 1511/7473 [00:05<00:18, 322.95it/s] 21%|████████████████████                                                                             | 1544/7473 [00:05<00:18, 323.42it/s] 21%|████████████████████▍                                                                            | 1577/7473 [00:05<00:18, 322.31it/s] 22%|████████████████████▉                                                                            | 1610/7473 [00:05<00:18, 321.28it/s] 22%|█████████████████████▎                                                                           | 1643/7473 [00:05<00:18, 320.57it/s] 22%|█████████████████████▊                                                                           | 1676/7473 [00:06<00:18, 321.45it/s] 23%|██████████████████████▏                                                                          | 1709/7473 [00:06<00:17, 322.25it/s] 23%|██████████████████████▌                                                                          | 1742/7473 [00:06<00:17, 322.61it/s] 24%|███████████████████████                                                                          | 1775/7473 [00:06<00:17, 322.87it/s] 24%|███████████████████████▍                                                                         | 1808/7473 [00:06<00:17, 323.26it/s] 25%|███████████████████████▉                                                                         | 1841/7473 [00:06<00:17, 321.12it/s] 25%|████████████████████████▎                                                                        | 1874/7473 [00:06<00:17, 321.92it/s] 26%|████████████████████████▊                                                                        | 1907/7473 [00:06<00:17, 321.78it/s] 26%|█████████████████████████▏                                                                       | 1940/7473 [00:06<00:17, 321.78it/s] 26%|█████████████████████████▌                                                                       | 1973/7473 [00:06<00:17, 322.61it/s] 27%|██████████████████████████                                                                       | 2006/7473 [00:07<00:16, 322.84it/s] 27%|██████████████████████████▍                                                                      | 2039/7473 [00:07<00:16, 320.63it/s] 28%|██████████████████████████▉                                                                      | 2072/7473 [00:07<00:16, 319.69it/s] 28%|███████████████████████████▎                                                                     | 2105/7473 [00:07<00:16, 321.09it/s] 29%|███████████████████████████▊                                                                     | 2138/7473 [00:07<00:16, 320.57it/s] 29%|████████████████████████████▏                                                                    | 2171/7473 [00:07<00:16, 321.81it/s] 29%|████████████████████████████▌                                                                    | 2204/7473 [00:07<00:16, 322.25it/s] 30%|█████████████████████████████                                                                    | 2237/7473 [00:07<00:16, 323.07it/s] 30%|█████████████████████████████▍                                                                   | 2270/7473 [00:07<00:16, 322.76it/s] 31%|█████████████████████████████▉                                                                   | 2303/7473 [00:08<00:16, 321.68it/s] 31%|██████████████████████████████▎                                                                  | 2336/7473 [00:08<00:15, 322.52it/s] 32%|██████████████████████████████▋                                                                  | 2369/7473 [00:08<00:15, 322.36it/s] 32%|███████████████████████████████▏                                                                 | 2402/7473 [00:08<00:15, 323.06it/s] 33%|███████████████████████████████▌                                                                 | 2435/7473 [00:08<00:15, 321.22it/s] 33%|████████████████████████████████                                                                 | 2468/7473 [00:08<00:15, 322.03it/s] 33%|████████████████████████████████▍                                                                | 2501/7473 [00:08<00:15, 322.50it/s] 34%|████████████████████████████████▉                                                                | 2534/7473 [00:08<00:16, 295.68it/s] 34%|█████████████████████████████████▎                                                               | 2567/7473 [00:08<00:16, 303.75it/s] 35%|█████████████████████████████████▋                                                               | 2600/7473 [00:08<00:15, 309.42it/s] 35%|██████████████████████████████████▏                                                              | 2633/7473 [00:09<00:15, 313.61it/s] 36%|██████████████████████████████████▌                                                              | 2666/7473 [00:09<00:15, 317.18it/s] 36%|███████████████████████████████████                                                              | 2699/7473 [00:09<00:14, 318.98it/s] 37%|███████████████████████████████████▍                                                             | 2732/7473 [00:09<00:14, 320.24it/s] 37%|███████████████████████████████████▉                                                             | 2765/7473 [00:09<00:14, 319.67it/s] 37%|████████████████████████████████████▎                                                            | 2798/7473 [00:09<00:14, 320.52it/s] 38%|████████████████████████████████████▋                                                            | 2831/7473 [00:09<00:14, 321.90it/s] 38%|█████████████████████████████████████▏                                                           | 2864/7473 [00:09<00:14, 321.97it/s] 39%|█████████████████████████████████████▌                                                           | 2897/7473 [00:09<00:14, 322.83it/s] 39%|██████████████████████████████████████                                                           | 2930/7473 [00:09<00:14, 323.67it/s] 40%|██████████████████████████████████████▍                                                          | 2963/7473 [00:10<00:13, 324.12it/s] 40%|██████████████████████████████████████▉                                                          | 2996/7473 [00:10<00:13, 322.45it/s] 41%|███████████████████████████████████████▎                                                         | 3029/7473 [00:10<00:13, 322.43it/s] 41%|███████████████████████████████████████▋                                                         | 3062/7473 [00:10<00:13, 322.95it/s] 41%|████████████████████████████████████████▏                                                        | 3095/7473 [00:10<00:13, 322.85it/s] 42%|████████████████████████████████████████▌                                                        | 3128/7473 [00:10<00:13, 322.27it/s] 42%|█████████████████████████████████████████                                                        | 3161/7473 [00:10<00:13, 322.23it/s] 43%|█████████████████████████████████████████▍                                                       | 3194/7473 [00:10<00:13, 320.33it/s] 43%|█████████████████████████████████████████▉                                                       | 3227/7473 [00:10<00:13, 319.88it/s] 44%|██████████████████████████████████████████▎                                                      | 3260/7473 [00:11<00:13, 321.04it/s] 44%|██████████████████████████████████████████▋                                                      | 3293/7473 [00:11<00:12, 321.88it/s] 45%|███████████████████████████████████████████▏                                                     | 3326/7473 [00:11<00:12, 321.93it/s] 45%|███████████████████████████████████████████▌                                                     | 3359/7473 [00:11<00:12, 321.82it/s] 45%|████████████████████████████████████████████                                                     | 3392/7473 [00:11<00:12, 321.57it/s] 46%|████████████████████████████████████████████▍                                                    | 3425/7473 [00:11<00:12, 321.90it/s] 46%|████████████████████████████████████████████▉                                                    | 3458/7473 [00:11<00:12, 319.65it/s] 47%|█████████████████████████████████████████████▎                                                   | 3491/7473 [00:11<00:12, 321.09it/s] 47%|█████████████████████████████████████████████▋                                                   | 3524/7473 [00:11<00:12, 321.77it/s] 48%|██████████████████████████████████████████████▏                                                  | 3557/7473 [00:11<00:12, 322.19it/s] 48%|██████████████████████████████████████████████▌                                                  | 3590/7473 [00:12<00:12, 322.74it/s] 48%|███████████████████████████████████████████████                                                  | 3623/7473 [00:12<00:11, 322.96it/s] 49%|███████████████████████████████████████████████▍                                                 | 3656/7473 [00:12<00:11, 320.38it/s] 49%|███████████████████████████████████████████████▉                                                 | 3689/7473 [00:12<00:11, 318.76it/s] 50%|████████████████████████████████████████████████▎                                                | 3722/7473 [00:12<00:11, 319.38it/s] 50%|████████████████████████████████████████████████▋                                                | 3755/7473 [00:12<00:11, 320.20it/s] 51%|█████████████████████████████████████████████████▏                                               | 3788/7473 [00:12<00:11, 320.91it/s] 51%|█████████████████████████████████████████████████▌                                               | 3821/7473 [00:12<00:11, 321.85it/s] 52%|██████████████████████████████████████████████████                                               | 3854/7473 [00:12<00:11, 321.54it/s] 52%|██████████████████████████████████████████████████▍                                              | 3887/7473 [00:12<00:11, 320.06it/s] 52%|██████████████████████████████████████████████████▉                                              | 3920/7473 [00:13<00:11, 321.02it/s] 53%|███████████████████████████████████████████████████▎                                             | 3953/7473 [00:13<00:10, 321.80it/s] 53%|███████████████████████████████████████████████████▋                                             | 3986/7473 [00:13<00:10, 321.99it/s] 54%|████████████████████████████████████████████████████▏                                            | 4019/7473 [00:13<00:10, 322.61it/s] 54%|████████████████████████████████████████████████████▌                                            | 4052/7473 [00:13<00:10, 322.86it/s] 55%|█████████████████████████████████████████████████████                                            | 4085/7473 [00:13<00:10, 321.92it/s] 55%|█████████████████████████████████████████████████████▍                                           | 4118/7473 [00:13<00:10, 319.77it/s] 56%|█████████████████████████████████████████████████████▊                                           | 4150/7473 [00:13<00:10, 319.73it/s] 56%|██████████████████████████████████████████████████████▎                                          | 4183/7473 [00:13<00:10, 320.60it/s] 56%|██████████████████████████████████████████████████████▋                                          | 4216/7473 [00:13<00:10, 321.01it/s] 57%|███████████████████████████████████████████████████████▏                                         | 4249/7473 [00:14<00:10, 320.63it/s] 57%|███████████████████████████████████████████████████████▌                                         | 4282/7473 [00:14<00:09, 320.47it/s] 58%|████████████████████████████████████████████████████████                                         | 4315/7473 [00:14<00:09, 321.11it/s] 58%|████████████████████████████████████████████████████████▍                                        | 4348/7473 [00:14<00:09, 320.58it/s] 59%|████████████████████████████████████████████████████████▊                                        | 4381/7473 [00:14<00:09, 320.66it/s] 59%|█████████████████████████████████████████████████████████▎                                       | 4414/7473 [00:14<00:09, 321.16it/s] 60%|█████████████████████████████████████████████████████████▋                                       | 4447/7473 [00:14<00:09, 321.00it/s] 60%|██████████████████████████████████████████████████████████▏                                      | 4480/7473 [00:14<00:09, 321.32it/s] 60%|██████████████████████████████████████████████████████████▌                                      | 4513/7473 [00:14<00:09, 321.57it/s] 61%|███████████████████████████████████████████████████████████                                      | 4546/7473 [00:15<00:09, 322.06it/s] 61%|███████████████████████████████████████████████████████████▍                                     | 4579/7473 [00:15<00:09, 320.95it/s] 62%|███████████████████████████████████████████████████████████▊                                     | 4612/7473 [00:15<00:08, 321.29it/s] 62%|████████████████████████████████████████████████████████████▎                                    | 4645/7473 [00:15<00:08, 321.41it/s] 63%|████████████████████████████████████████████████████████████▋                                    | 4678/7473 [00:15<00:08, 321.35it/s] 63%|█████████████████████████████████████████████████████████████▏                                   | 4711/7473 [00:15<00:08, 321.70it/s] 63%|█████████████████████████████████████████████████████████████▌                                   | 4744/7473 [00:15<00:08, 321.37it/s] 64%|██████████████████████████████████████████████████████████████                                   | 4777/7473 [00:15<00:08, 321.34it/s] 64%|██████████████████████████████████████████████████████████████▍                                  | 4810/7473 [00:15<00:08, 319.62it/s] 65%|██████████████████████████████████████████████████████████████▊                                  | 4843/7473 [00:15<00:08, 320.86it/s] 65%|███████████████████████████████████████████████████████████████▎                                 | 4876/7473 [00:16<00:08, 320.66it/s] 66%|███████████████████████████████████████████████████████████████▋                                 | 4909/7473 [00:16<00:07, 321.80it/s] 66%|████████████████████████████████████████████████████████████████▏                                | 4942/7473 [00:16<00:07, 321.49it/s] 67%|████████████████████████████████████████████████████████████████▌                                | 4975/7473 [00:16<00:07, 321.58it/s] 67%|█████████████████████████████████████████████████████████████████                                | 5008/7473 [00:16<00:07, 322.17it/s] 67%|█████████████████████████████████████████████████████████████████▍                               | 5041/7473 [00:16<00:07, 320.51it/s] 68%|█████████████████████████████████████████████████████████████████▊                               | 5074/7473 [00:16<00:07, 320.95it/s] 68%|██████████████████████████████████████████████████████████████████▎                              | 5107/7473 [00:16<00:07, 321.17it/s] 69%|██████████████████████████████████████████████████████████████████▋                              | 5140/7473 [00:16<00:07, 321.54it/s] 69%|███████████████████████████████████████████████████████████████████▏                             | 5173/7473 [00:16<00:07, 322.19it/s] 70%|███████████████████████████████████████████████████████████████████▌                             | 5206/7473 [00:17<00:07, 322.15it/s] 70%|████████████████████████████████████████████████████████████████████                             | 5239/7473 [00:17<00:06, 322.18it/s] 71%|████████████████████████████████████████████████████████████████████▍                            | 5272/7473 [00:17<00:07, 300.26it/s] 71%|████████████████████████████████████████████████████████████████████▊                            | 5305/7473 [00:17<00:07, 306.64it/s] 71%|█████████████████████████████████████████████████████████████████████▎                           | 5337/7473 [00:17<00:06, 310.22it/s] 72%|█████████████████████████████████████████████████████████████████████▋                           | 5369/7473 [00:17<00:06, 312.53it/s] 72%|██████████████████████████████████████████████████████████████████████                           | 5402/7473 [00:17<00:06, 315.68it/s] 73%|██████████████████████████████████████████████████████████████████████▌                          | 5435/7473 [00:17<00:06, 317.83it/s] 73%|██████████████████████████████████████████████████████████████████████▉                          | 5468/7473 [00:17<00:06, 319.12it/s] 74%|███████████████████████████████████████████████████████████████████████▍                         | 5500/7473 [00:18<00:09, 211.26it/s] 74%|███████████████████████████████████████████████████████████████████████▊                         | 5533/7473 [00:18<00:08, 236.05it/s] 74%|████████████████████████████████████████████████████████████████████████▏                        | 5566/7473 [00:18<00:07, 256.91it/s] 75%|████████████████████████████████████████████████████████████████████████▋                        | 5599/7473 [00:18<00:06, 273.29it/s] 75%|█████████████████████████████████████████████████████████████████████████                        | 5632/7473 [00:18<00:06, 286.53it/s] 76%|█████████████████████████████████████████████████████████████████████████▌                       | 5665/7473 [00:18<00:06, 296.79it/s] 76%|█████████████████████████████████████████████████████████████████████████▉                       | 5697/7473 [00:18<00:05, 302.47it/s] 77%|██████████████████████████████████████████████████████████████████████████▍                      | 5730/7473 [00:18<00:05, 308.02it/s] 77%|██████████████████████████████████████████████████████████████████████████▊                      | 5763/7473 [00:18<00:05, 312.48it/s] 78%|███████████████████████████████████████████████████████████████████████████▏                     | 5796/7473 [00:19<00:05, 315.30it/s] 78%|███████████████████████████████████████████████████████████████████████████▋                     | 5828/7473 [00:19<00:05, 314.44it/s] 78%|████████████████████████████████████████████████████████████████████████████                     | 5861/7473 [00:19<00:05, 316.66it/s] 79%|████████████████████████████████████████████████████████████████████████████▌                    | 5894/7473 [00:19<00:04, 317.99it/s] 79%|████████████████████████████████████████████████████████████████████████████▉                    | 5926/7473 [00:19<00:04, 316.97it/s] 80%|█████████████████████████████████████████████████████████████████████████████▎                   | 5958/7473 [00:19<00:04, 317.01it/s] 80%|█████████████████████████████████████████████████████████████████████████████▊                   | 5991/7473 [00:19<00:04, 318.11it/s] 81%|██████████████████████████████████████████████████████████████████████████████▏                  | 6024/7473 [00:19<00:04, 318.90it/s] 81%|██████████████████████████████████████████████████████████████████████████████▌                  | 6057/7473 [00:19<00:04, 320.23it/s] 81%|███████████████████████████████████████████████████████████████████████████████                  | 6090/7473 [00:20<00:04, 321.12it/s] 82%|███████████████████████████████████████████████████████████████████████████████▍                 | 6123/7473 [00:20<00:04, 321.80it/s] 82%|███████████████████████████████████████████████████████████████████████████████▉                 | 6156/7473 [00:20<00:04, 320.22it/s] 83%|████████████████████████████████████████████████████████████████████████████████▎                | 6189/7473 [00:20<00:04, 320.85it/s] 83%|████████████████████████████████████████████████████████████████████████████████▊                | 6222/7473 [00:20<00:03, 321.18it/s] 84%|█████████████████████████████████████████████████████████████████████████████████▏               | 6255/7473 [00:20<00:03, 321.81it/s] 84%|█████████████████████████████████████████████████████████████████████████████████▌               | 6288/7473 [00:20<00:03, 321.78it/s] 85%|██████████████████████████████████████████████████████████████████████████████████               | 6321/7473 [00:20<00:03, 322.55it/s] 85%|██████████████████████████████████████████████████████████████████████████████████▍              | 6354/7473 [00:20<00:03, 318.47it/s] 85%|██████████████████████████████████████████████████████████████████████████████████▉              | 6386/7473 [00:20<00:03, 318.65it/s] 86%|███████████████████████████████████████████████████████████████████████████████████▎             | 6419/7473 [00:21<00:03, 319.55it/s] 86%|███████████████████████████████████████████████████████████████████████████████████▋             | 6452/7473 [00:21<00:03, 320.16it/s] 87%|████████████████████████████████████████████████████████████████████████████████████▏            | 6485/7473 [00:21<00:03, 320.76it/s] 87%|████████████████████████████████████████████████████████████████████████████████████▌            | 6518/7473 [00:21<00:02, 320.86it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████            | 6551/7473 [00:21<00:02, 321.65it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████▍           | 6584/7473 [00:21<00:02, 320.23it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████▉           | 6617/7473 [00:21<00:02, 320.33it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████▎          | 6650/7473 [00:21<00:02, 320.41it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████▋          | 6683/7473 [00:21<00:02, 320.40it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████▏         | 6716/7473 [00:21<00:02, 320.65it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████▌         | 6749/7473 [00:22<00:02, 321.25it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████         | 6782/7473 [00:22<00:02, 321.14it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████▍        | 6815/7473 [00:22<00:02, 319.50it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████▉        | 6848/7473 [00:22<00:01, 320.03it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████▎       | 6881/7473 [00:22<00:01, 320.77it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████▋       | 6914/7473 [00:22<00:01, 319.31it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████▏      | 6947/7473 [00:22<00:01, 320.19it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████▌      | 6980/7473 [00:22<00:01, 320.52it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████      | 7013/7473 [00:22<00:01, 320.65it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████▍     | 7046/7473 [00:23<00:01, 318.78it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████▉     | 7079/7473 [00:23<00:01, 319.97it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████▎    | 7112/7473 [00:23<00:01, 320.54it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████▋    | 7145/7473 [00:23<00:01, 320.55it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████▏   | 7178/7473 [00:23<00:00, 320.64it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████▌   | 7211/7473 [00:23<00:00, 321.23it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████   | 7244/7473 [00:23<00:00, 320.99it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████▍  | 7277/7473 [00:23<00:00, 319.56it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████▉  | 7310/7473 [00:23<00:00, 320.57it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████▎ | 7343/7473 [00:23<00:00, 320.69it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████▋ | 7376/7473 [00:24<00:00, 320.68it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████▏| 7409/7473 [00:24<00:00, 321.41it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████▌| 7442/7473 [00:24<00:00, 319.50it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 7473/7473 [00:24<00:00, 307.10it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:04<00:09,  4.91s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.12s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.12s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.34s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:09<00:04,  4.98s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:04,  4.99s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.19s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:12<00:06,  6.34s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.35s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.51s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.38s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.56s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.56s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.73s/it]
[2023-08-18 08:21:14,639] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:16<00:00,  5.48s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:16<00:00,  5.61s/it]
[2023-08-18 08:21:30,568] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-18 08:21:30,569] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-18 08:21:30,570] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-18 08:21:30,570] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-18 08:21:30,570] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-18 08:21:30,570] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-18 08:21:30,570] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-18 08:21:30,570] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-18 08:21:30,570] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-18 08:21:30,570] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-18 08:21:30,571] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-18 08:21:30,571] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7ff56ba71370>
[2023-08-18 08:21:30,571] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-18 08:21:30,571] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-18 08:21:30,571] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-18 08:21:30,571] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-18 08:21:30,571] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-18 08:21:30,571] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-18 08:21:30,571] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-18 08:21:30,571] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-18 08:21:30,571] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-18 08:21:30,571] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-18 08:21:30,571] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-18 08:21:30,571] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-18 08:21:30,571] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-18 08:21:30,571] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-18 08:21:30,571] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-18 08:21:30,571] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-18 08:21:30,571] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-18 08:21:30,571] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-18 08:21:30,571] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-18 08:21:30,571] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-18 08:21:30,571] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-18 08:21:30,571] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-18 08:21:30,571] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-18 08:21:30,571] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-18 08:21:30,571] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-18 08:21:30,571] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-18 08:21:30,571] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-18 08:21:30,571] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-18 08:21:30,571] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-18 08:21:30,571] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-18 08:21:30,571] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-18 08:21:30,571] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-18 08:21:30,571] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7ff56ba71250>
[2023-08-18 08:21:30,572] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-18 08:21:30,572] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-18 08:21:30,572] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-18 08:21:30,572] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-18 08:21:30,572] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-18 08:21:30,572] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-18 08:21:30,572] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-18 08:21:30,572] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-18 08:21:30,572] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-18 08:21:30,572] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-18 08:21:30,572] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-18 08:21:30,572] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-18 08:21:30,572] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-18 08:21:30,572] [INFO] [config.py:1012:print]   train_batch_size ............. 8
[2023-08-18 08:21:30,572] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  2
[2023-08-18 08:21:30,572] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-18 08:21:30,572] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-18 08:21:30,572] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-18 08:21:30,572] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-18 08:21:30,572] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-18 08:21:30,572] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-18 08:21:30,572] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-18 08:21:30,572] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.6291043758392334 seconds
Time to load utils op: 0.4046516418457031 seconds
Loading extension module utils...
Time to load utils op: 0.6048765182495117 seconds
Loading extension module utils...
Time to load utils op: 0.6049637794494629 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating gsm8k :   0%|                                                                                           | 0/125 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following grade math question.

Input: Fabric is cut to order at what type of seller? Choices:  A: curtains B: tailor shop C: clothing store D: sewing room E: hardware store
Output: 1. The question asks where fabric is cut to order. This means a place where fabric is not pre-cut and can be cut based on specific measurements or needs of the customer.
2. Looking at the options:
   A) A curtain store typically sells pre-made curtains and not the fabric to make them.
   B) A tailor shop is a place where clothing items are custom-made to fit an individual's size. They use fabric which they need to cut as per the client's requirements.
   C) While a clothing store does sell fabric in the form of clothes, they do not cut fabric to order. They sell pre-made clothes.
   D) A sewing room is more of a space where sewing activities are carried out but it's not necessarily a commercial selling point where customers come to order.
   E) And obviously, a hardware store sells tools and equipment related to home improvement or construction, not fabric.
3. By process of elimination, the only place where fabric is truly cut to order in order to create custom items is a tailor shop. Hence, the answer is B: tailor shop.
So the final answer is B: tailor shop

Input: Where are you if your reading magazines while waiting for a vehicle on rails? Choices:  A: vegetables B: market C: doctor D: train station E: bookstore
Output: 1. The question describes someone reading magazines while waiting for a vehicle on rails. 
2. Vehicles that move on rails are typically trains, trams, or some kind of rail-based transportation. 
3. Considering where this would take place, it is unlikely to be a location with vegetables or a doctor's office.
4. It could potentially be a market or a bookstore. However, these places typically do not directly serve rail transportation. 
5. Due to the reference to a vehicle on rails, the most suitable answer hence would be a location that directly involves rail travel.
6. Therefore, the answer is D: train station where someone could logically wait for a train while reading magazines.
So the final answer is D: train station

Input: What would need oil to be used? Choices:  A: ground B: human  body C: repair shop D: combustion engines E: service station
Output: 1. The first step is to understand the question. We're asked to identify which of the given options would need oil.
2. Then, we analyze each option carefully:
     A: Ground - oil isn't exactly necessary for the ground or soil. Water is more essential for ground or soil.
     B: Human Body - while our bodies do need types of oils or fats for nutrition, these are usually included in our diets and are not the kind of oil being referred to in this context.
     C: Repair shop - a repair shop might need oil if it's an automotive repair shop, but it's not exact. Also, it's not the repair shop itself that needs oil, but the machines or cars within it.
     D: Combustion Engines - these definitely need oil for their operation. They rely on oil for lubrication to reduce friction and heat, making them run smoother and last longer. This is the technical type of oil the question refers to.
     E: Service Station - similar to 'C', service stations or gas stations store and sell oil, and some equipment there may use it, but the stations themselves do not need oil to function correctly.

3. After careful evaluation, it's clear that 'D: Combustion engines' is the answer because they directly require oil for their proper functioning, while the others do not.
So the final answer is D: combustion engines

Input: What is person probably feeling that plans on stopping being married to their spouse? Choices:  A: detachment B: bankruptcy C: sad D: fights E: wrong
Output: 1. The question presents a scenario where a person is planning to end their marriage.
2. To reach such a decision indicates that the person has likely emotionally distanced themselves from their spouse.
3. The person may not necessarily be experiencing bankruptcy or fights, as these are possible repercussions or triggers of such decisions, but not the feelings associated with the decision.
4. They may also not necessarily feel wrong, as it's more likely that they feel justified in their decision if they've come so far as to contemplate ending the marriage.
5. They can feel sad, however, the primary emotion is likely detachment that drove them to this decision.
6. Hence, given the available choices, detached (A) seems to describe best how the person is probably feeling when they plan on stopping being married to their spouse.
So the final answer is A: detachment

Input: What could you use to store a clock? Choices:  A: shelf B: own bedroom C: desk D: wall E: car
Output: 1. A shelf is a surface or support that is used to store or display items.
2. A clock is a device that tells the time and does not have a specific size, so it can fit on a shelf.
3. The other options - own bedroom, desk, wall, car - are not specific storage places.
4. A bedroom, a desk, a wall, and a car can contain a shelf where a clock is stored.
5. Thus, we conclude that A: Shelf is the correct answer.
So the final answer is A: shelf

Input:Natalia sold clips to 48 of her friends in April, and then she sold half as many clips in May. How many clips did Natalia sell altogether in April and May?
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o5-tcommonsenseqa-s10-rTrue
Evaluating gsm8k :   1%|▋                                                                                  | 1/125 [00:24<51:16, 24.81s/it]Evaluating gsm8k :   2%|█▎                                                                                 | 2/125 [00:48<49:01, 23.92s/it]Evaluating gsm8k :   2%|█▉                                                                                 | 3/125 [01:00<38:10, 18.77s/it]Evaluating gsm8k :   3%|██▋                                                                                | 4/125 [01:14<34:09, 16.94s/it]Evaluating gsm8k :   4%|███▎                                                                               | 5/125 [01:38<38:23, 19.19s/it]Evaluating gsm8k :   5%|███▉                                                                               | 6/125 [02:01<40:59, 20.66s/it]Evaluating gsm8k :   6%|████▋                                                                              | 7/125 [02:24<42:18, 21.51s/it]Evaluating gsm8k :   6%|█████▎                                                                             | 8/125 [02:48<43:02, 22.07s/it]Evaluating gsm8k :   7%|█████▉                                                                             | 9/125 [03:11<43:28, 22.48s/it]Evaluating gsm8k :   8%|██████▌                                                                           | 10/125 [03:34<43:36, 22.75s/it]Evaluating gsm8k :   9%|███████▏                                                                          | 11/125 [03:58<43:42, 23.01s/it]Evaluating gsm8k :  10%|███████▊                                                                          | 12/125 [04:21<43:24, 23.05s/it]Evaluating gsm8k :  10%|████████▌                                                                         | 13/125 [04:44<43:13, 23.16s/it]Evaluating gsm8k :  11%|█████████▏                                                                        | 14/125 [05:08<43:04, 23.28s/it]Evaluating gsm8k :  12%|█████████▊                                                                        | 15/125 [05:31<42:43, 23.31s/it]Evaluating gsm8k :  13%|██████████▍                                                                       | 16/125 [05:55<42:25, 23.36s/it]Evaluating gsm8k :  14%|███████████▏                                                                      | 17/125 [06:19<42:10, 23.43s/it]Evaluating gsm8k :  14%|███████████▊                                                                      | 18/125 [06:42<41:40, 23.37s/it]Evaluating gsm8k :  15%|████████████▍                                                                     | 19/125 [07:05<41:13, 23.33s/it]Evaluating gsm8k :  16%|█████████████                                                                     | 20/125 [07:29<40:58, 23.41s/it]Evaluating gsm8k :  17%|█████████████▊                                                                    | 21/125 [07:45<36:46, 21.21s/it]Evaluating gsm8k :  18%|██████████████▍                                                                   | 22/125 [08:08<37:30, 21.85s/it]Evaluating gsm8k :  18%|███████████████                                                                   | 23/125 [08:16<30:02, 17.67s/it]Evaluating gsm8k :  19%|███████████████▋                                                                  | 24/125 [08:39<32:37, 19.38s/it]Evaluating gsm8k :  20%|████████████████▍                                                                 | 25/125 [08:48<26:53, 16.14s/it]Evaluating gsm8k :  21%|█████████████████                                                                 | 26/125 [09:11<30:15, 18.34s/it]Evaluating gsm8k :  22%|█████████████████▋                                                                | 27/125 [09:35<32:26, 19.86s/it]Evaluating gsm8k :  22%|██████████████████▎                                                               | 28/125 [09:58<33:46, 20.89s/it]Evaluating gsm8k :  23%|███████████████████                                                               | 29/125 [10:22<34:40, 21.67s/it]Evaluating gsm8k :  24%|███████████████████▋                                                              | 30/125 [10:31<28:40, 18.11s/it]Evaluating gsm8k :  25%|████████████████████▎                                                             | 31/125 [10:52<29:36, 18.90s/it]Evaluating gsm8k :  26%|████████████████████▉                                                             | 32/125 [11:03<25:35, 16.51s/it]Evaluating gsm8k :  26%|█████████████████████▋                                                            | 33/125 [11:22<26:25, 17.23s/it]Evaluating gsm8k :  27%|██████████████████████▎                                                           | 34/125 [11:46<29:06, 19.19s/it]Evaluating gsm8k :  28%|██████████████████████▉                                                           | 35/125 [12:01<27:01, 18.01s/it]Evaluating gsm8k :  29%|███████████████████████▌                                                          | 36/125 [12:24<29:05, 19.61s/it]Evaluating gsm8k :  30%|████████████████████████▎                                                         | 37/125 [12:29<22:12, 15.15s/it]Evaluating gsm8k :  30%|████████████████████████▉                                                         | 38/125 [12:42<20:55, 14.43s/it]Evaluating gsm8k :  31%|█████████████████████████▌                                                        | 39/125 [13:05<24:35, 17.16s/it]Evaluating gsm8k :  32%|██████████████████████████▏                                                       | 40/125 [13:29<26:59, 19.05s/it]Evaluating gsm8k :  33%|██████████████████████████▉                                                       | 41/125 [13:52<28:34, 20.41s/it]Evaluating gsm8k :  34%|███████████████████████████▌                                                      | 42/125 [14:16<29:32, 21.35s/it]Evaluating gsm8k :  34%|████████████████████████████▏                                                     | 43/125 [14:39<30:00, 21.96s/it]Evaluating gsm8k :  35%|████████████████████████████▊                                                     | 44/125 [14:59<28:48, 21.34s/it]Evaluating gsm8k :  36%|█████████████████████████████▌                                                    | 45/125 [15:23<29:19, 22.00s/it]Evaluating gsm8k :  37%|██████████████████████████████▏                                                   | 46/125 [15:31<23:43, 18.02s/it]Evaluating gsm8k :  38%|██████████████████████████████▊                                                   | 47/125 [15:55<25:30, 19.63s/it]Evaluating gsm8k :  38%|███████████████████████████████▍                                                  | 48/125 [16:18<26:44, 20.84s/it]Evaluating gsm8k :  39%|████████████████████████████████▏                                                 | 49/125 [16:41<27:01, 21.34s/it]Evaluating gsm8k :  40%|████████████████████████████████▊                                                 | 50/125 [16:55<24:03, 19.24s/it]Evaluating gsm8k :  41%|█████████████████████████████████▍                                                | 51/125 [17:19<25:15, 20.48s/it]Evaluating gsm8k :  42%|██████████████████████████████████                                                | 52/125 [17:42<26:01, 21.40s/it]Evaluating gsm8k :  42%|██████████████████████████████████▊                                               | 53/125 [18:06<26:25, 22.02s/it]Evaluating gsm8k :  43%|███████████████████████████████████▍                                              | 54/125 [18:16<21:44, 18.37s/it]Evaluating gsm8k :  44%|████████████████████████████████████                                              | 55/125 [18:38<22:51, 19.59s/it]Evaluating gsm8k :  45%|████████████████████████████████████▋                                             | 56/125 [19:00<23:26, 20.39s/it]Evaluating gsm8k :  46%|█████████████████████████████████████▍                                            | 57/125 [19:11<19:54, 17.57s/it]Evaluating gsm8k :  46%|██████████████████████████████████████                                            | 58/125 [19:35<21:32, 19.29s/it]Evaluating gsm8k :  47%|██████████████████████████████████████▋                                           | 59/125 [19:57<22:12, 20.19s/it]Evaluating gsm8k :  48%|███████████████████████████████████████▎                                          | 60/125 [20:16<21:37, 19.96s/it]Evaluating gsm8k :  49%|████████████████████████████████████████                                          | 61/125 [20:40<22:21, 20.96s/it]Evaluating gsm8k :  50%|████████████████████████████████████████▋                                         | 62/125 [21:03<22:45, 21.68s/it]Evaluating gsm8k :  50%|█████████████████████████████████████████▎                                        | 63/125 [21:26<22:56, 22.20s/it]Evaluating gsm8k :  51%|█████████████████████████████████████████▉                                        | 64/125 [21:50<22:55, 22.56s/it]Evaluating gsm8k :  52%|██████████████████████████████████████████▋                                       | 65/125 [22:13<22:48, 22.80s/it]Evaluating gsm8k :  53%|███████████████████████████████████████████▎                                      | 66/125 [22:37<22:38, 23.03s/it]Evaluating gsm8k :  54%|███████████████████████████████████████████▉                                      | 67/125 [22:46<18:09, 18.78s/it]Evaluating gsm8k :  54%|████████████████████████████████████████████▌                                     | 68/125 [23:09<19:12, 20.22s/it]Evaluating gsm8k :  55%|█████████████████████████████████████████████▎                                    | 69/125 [23:18<15:34, 16.69s/it]Evaluating gsm8k :  56%|█████████████████████████████████████████████▉                                    | 70/125 [23:41<17:09, 18.72s/it]Evaluating gsm8k :  57%|██████████████████████████████████████████████▌                                   | 71/125 [23:57<16:00, 17.79s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▏                                  | 72/125 [24:20<17:13, 19.50s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▉                                  | 73/125 [24:44<17:59, 20.75s/it]Evaluating gsm8k :  59%|████████████████████████████████████████████████▌                                 | 74/125 [25:07<18:22, 21.63s/it]Evaluating gsm8k :  60%|█████████████████████████████████████████████████▏                                | 75/125 [25:31<18:31, 22.22s/it]Evaluating gsm8k :  61%|█████████████████████████████████████████████████▊                                | 76/125 [25:54<18:20, 22.46s/it]Evaluating gsm8k :  62%|██████████████████████████████████████████████████▌                               | 77/125 [26:18<18:15, 22.83s/it]Evaluating gsm8k :  62%|███████████████████████████████████████████████████▏                              | 78/125 [26:41<18:03, 23.05s/it]Evaluating gsm8k :  63%|███████████████████████████████████████████████████▊                              | 79/125 [27:05<17:45, 23.17s/it]Evaluating gsm8k :  64%|████████████████████████████████████████████████████▍                             | 80/125 [27:28<17:26, 23.26s/it]Evaluating gsm8k :  65%|█████████████████████████████████████████████████████▏                            | 81/125 [27:52<17:11, 23.45s/it]Evaluating gsm8k :  66%|█████████████████████████████████████████████████████▊                            | 82/125 [28:16<16:49, 23.47s/it]Evaluating gsm8k :  66%|██████████████████████████████████████████████████████▍                           | 83/125 [28:39<16:20, 23.35s/it]Evaluating gsm8k :  67%|███████████████████████████████████████████████████████                           | 84/125 [29:02<15:58, 23.39s/it]Evaluating gsm8k :  68%|███████████████████████████████████████████████████████▊                          | 85/125 [29:26<15:36, 23.42s/it]Evaluating gsm8k :  69%|████████████████████████████████████████████████████████▍                         | 86/125 [29:48<15:02, 23.15s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████                         | 87/125 [30:12<14:47, 23.35s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████▋                        | 88/125 [30:23<12:07, 19.66s/it]Evaluating gsm8k :  71%|██████████████████████████████████████████████████████████▍                       | 89/125 [30:46<12:22, 20.62s/it]Evaluating gsm8k :  72%|███████████████████████████████████████████████████████████                       | 90/125 [31:10<12:32, 21.51s/it]Evaluating gsm8k :  73%|███████████████████████████████████████████████████████████▋                      | 91/125 [31:33<12:32, 22.14s/it]Evaluating gsm8k :  74%|████████████████████████████████████████████████████████████▎                     | 92/125 [31:57<12:22, 22.51s/it]Evaluating gsm8k :  74%|█████████████████████████████████████████████████████████████                     | 93/125 [32:20<12:08, 22.78s/it]Evaluating gsm8k :  75%|█████████████████████████████████████████████████████████████▋                    | 94/125 [32:43<11:53, 23.01s/it]Evaluating gsm8k :  76%|██████████████████████████████████████████████████████████████▎                   | 95/125 [33:07<11:35, 23.19s/it]Evaluating gsm8k :  77%|██████████████████████████████████████████████████████████████▉                   | 96/125 [33:30<11:14, 23.25s/it]Evaluating gsm8k :  78%|███████████████████████████████████████████████████████████████▋                  | 97/125 [33:54<10:53, 23.33s/it]Evaluating gsm8k :  78%|████████████████████████████████████████████████████████████████▎                 | 98/125 [34:13<09:52, 21.94s/it]Evaluating gsm8k :  79%|████████████████████████████████████████████████████████████████▉                 | 99/125 [34:22<07:50, 18.09s/it]Evaluating gsm8k :  80%|████████████████████████████████████████████████████████████████▊                | 100/125 [34:41<07:39, 18.40s/it]Evaluating gsm8k :  81%|█████████████████████████████████████████████████████████████████▍               | 101/125 [34:58<07:09, 17.89s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████               | 102/125 [35:05<05:37, 14.66s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████▋              | 103/125 [35:21<05:36, 15.28s/it]Evaluating gsm8k :  83%|███████████████████████████████████████████████████████████████████▍             | 104/125 [35:40<05:40, 16.23s/it]Evaluating gsm8k :  84%|████████████████████████████████████████████████████████████████████             | 105/125 [36:04<06:09, 18.49s/it]Evaluating gsm8k :  85%|████████████████████████████████████████████████████████████████████▋            | 106/125 [36:27<06:20, 20.02s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▎           | 107/125 [36:51<06:20, 21.16s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▉           | 108/125 [37:09<05:44, 20.29s/it]Evaluating gsm8k :  87%|██████████████████████████████████████████████████████████████████████▋          | 109/125 [37:28<05:15, 19.74s/it]Evaluating gsm8k :  88%|███████████████████████████████████████████████████████████████████████▎         | 110/125 [37:39<04:19, 17.29s/it]Evaluating gsm8k :  89%|███████████████████████████████████████████████████████████████████████▉         | 111/125 [38:03<04:27, 19.13s/it]Evaluating gsm8k :  90%|████████████████████████████████████████████████████████████████████████▌        | 112/125 [38:26<04:25, 20.40s/it]Evaluating gsm8k :  90%|█████████████████████████████████████████████████████████████████████████▏       | 113/125 [38:50<04:15, 21.33s/it]Evaluating gsm8k :  91%|█████████████████████████████████████████████████████████████████████████▊       | 114/125 [39:13<04:01, 21.98s/it]Evaluating gsm8k :  92%|██████████████████████████████████████████████████████████████████████████▌      | 115/125 [39:25<03:10, 19.05s/it]Evaluating gsm8k :  93%|███████████████████████████████████████████████████████████████████████████▏     | 116/125 [39:31<02:15, 15.04s/it]Evaluating gsm8k :  94%|███████████████████████████████████████████████████████████████████████████▊     | 117/125 [39:51<02:10, 16.36s/it]Evaluating gsm8k :  94%|████████████████████████████████████████████████████████████████████████████▍    | 118/125 [40:14<02:09, 18.48s/it]Evaluating gsm8k :  95%|█████████████████████████████████████████████████████████████████████████████    | 119/125 [40:38<02:00, 20.01s/it]Evaluating gsm8k :  96%|█████████████████████████████████████████████████████████████████████████████▊   | 120/125 [40:50<01:28, 17.62s/it]Evaluating gsm8k :  97%|██████████████████████████████████████████████████████████████████████████████▍  | 121/125 [41:13<01:17, 19.31s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████  | 122/125 [41:36<01:01, 20.56s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████▋ | 123/125 [42:00<00:42, 21.46s/it]Evaluating gsm8k :  99%|████████████████████████████████████████████████████████████████████████████████▎| 124/125 [42:21<00:21, 21.31s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [42:45<00:00, 22.02s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [42:45<00:00, 20.52s/it]
name: gsm8k | {'exact_match': 0.0, 'rougeL': 0.3898} | lm_loss 10.9089 | avg. gen lenth: 348.976
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name gsm8k --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name commonsenseqa --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 2 --data-dir /scratch/ylu130/processed_data/gsm8k/out-domain/o6-tcommonsenseqa-s10-rTrue --seed 10 --max-prompt-length 2048 --rationales --num-out-domain 6
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-18 09:04:22,933] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... gsm8k
  data_dir ..................... /scratch/ylu130/processed_data/gsm8k/out-domain/o6-tcommonsenseqa-s10-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 6
  out_domain_data_name ......... commonsenseqa
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o6-tcommonsenseqa-s10-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 2
  clip_grad .................... 1.0
  seed ......................... 10
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                                             | 0/7473 [00:00<?, ?it/s]  0%|▏                                                                                                  | 14/7473 [00:00<00:56, 131.71it/s]  0%|▎                                                                                                  | 28/7473 [00:00<00:56, 131.68it/s]  1%|▌                                                                                                  | 42/7473 [00:00<00:56, 132.04it/s]  1%|▋                                                                                                  | 56/7473 [00:00<00:56, 132.21it/s]  1%|▉                                                                                                  | 70/7473 [00:00<00:56, 132.00it/s]  1%|█                                                                                                  | 84/7473 [00:00<00:56, 130.18it/s]  1%|█▎                                                                                                 | 98/7473 [00:00<00:56, 131.01it/s]  1%|█▍                                                                                                | 112/7473 [00:00<00:55, 131.57it/s]  2%|█▋                                                                                                | 126/7473 [00:00<00:55, 131.97it/s]  2%|█▊                                                                                                | 140/7473 [00:01<00:55, 130.96it/s]  2%|██                                                                                                | 154/7473 [00:01<00:55, 131.44it/s]  2%|██▏                                                                                               | 168/7473 [00:01<00:55, 131.48it/s]  2%|██▍                                                                                               | 182/7473 [00:01<00:55, 131.75it/s]  3%|██▌                                                                                               | 196/7473 [00:01<00:55, 131.90it/s]  3%|██▊                                                                                               | 210/7473 [00:01<00:54, 132.23it/s]  3%|██▉                                                                                               | 224/7473 [00:01<00:55, 130.89it/s]  3%|███                                                                                               | 238/7473 [00:01<00:55, 130.79it/s]  3%|███▎                                                                                              | 252/7473 [00:01<00:56, 128.56it/s]  4%|███▍                                                                                              | 266/7473 [00:02<00:55, 129.65it/s]  4%|███▋                                                                                              | 280/7473 [00:02<00:55, 130.39it/s]  4%|███▊                                                                                              | 294/7473 [00:02<00:54, 130.88it/s]  4%|████                                                                                              | 308/7473 [00:02<00:54, 131.15it/s]  4%|████▏                                                                                             | 322/7473 [00:02<00:54, 132.13it/s]  4%|████▍                                                                                             | 336/7473 [00:02<00:53, 132.24it/s]  5%|████▌                                                                                             | 350/7473 [00:02<00:53, 132.52it/s]  5%|████▊                                                                                             | 364/7473 [00:02<00:53, 132.35it/s]  5%|████▉                                                                                             | 378/7473 [00:02<00:53, 132.78it/s]  5%|█████▏                                                                                            | 395/7473 [00:02<00:49, 142.49it/s]  6%|█████▍                                                                                            | 416/7473 [00:03<00:44, 160.30it/s]  6%|█████▋                                                                                            | 437/7473 [00:03<00:40, 172.92it/s]  6%|██████                                                                                            | 458/7473 [00:03<00:38, 181.75it/s]  6%|██████▎                                                                                           | 478/7473 [00:03<00:37, 186.13it/s]  7%|██████▌                                                                                           | 499/7473 [00:03<00:36, 190.99it/s]  7%|██████▊                                                                                           | 520/7473 [00:03<00:35, 194.85it/s]  7%|███████                                                                                           | 541/7473 [00:03<00:35, 197.51it/s]  8%|███████▎                                                                                          | 562/7473 [00:03<00:34, 199.40it/s]  8%|███████▋                                                                                          | 583/7473 [00:03<00:34, 200.29it/s]  8%|███████▉                                                                                          | 604/7473 [00:04<00:34, 199.93it/s]  8%|████████▏                                                                                         | 625/7473 [00:04<00:34, 200.27it/s]  9%|████████▍                                                                                         | 646/7473 [00:04<00:33, 201.00it/s]  9%|████████▋                                                                                         | 667/7473 [00:04<00:33, 201.86it/s]  9%|█████████                                                                                         | 688/7473 [00:04<00:33, 202.34it/s]  9%|█████████▎                                                                                        | 709/7473 [00:04<00:33, 201.08it/s] 10%|█████████▌                                                                                        | 730/7473 [00:04<00:33, 202.03it/s] 10%|█████████▊                                                                                        | 751/7473 [00:04<00:33, 202.49it/s] 10%|██████████                                                                                        | 772/7473 [00:04<00:33, 202.36it/s] 11%|██████████▍                                                                                       | 793/7473 [00:04<00:33, 202.41it/s] 11%|██████████▋                                                                                       | 814/7473 [00:05<00:32, 202.53it/s] 11%|██████████▉                                                                                       | 835/7473 [00:05<00:32, 202.63it/s] 11%|███████████▏                                                                                      | 856/7473 [00:05<00:32, 201.44it/s] 12%|███████████▌                                                                                      | 877/7473 [00:05<00:32, 200.80it/s] 12%|███████████▊                                                                                      | 898/7473 [00:05<00:32, 200.55it/s] 12%|████████████                                                                                      | 919/7473 [00:05<00:32, 200.54it/s] 13%|████████████▎                                                                                     | 940/7473 [00:05<00:32, 198.87it/s] 13%|████████████▌                                                                                     | 961/7473 [00:05<00:32, 199.77it/s] 13%|████████████▉                                                                                     | 982/7473 [00:05<00:32, 200.38it/s] 13%|█████████████                                                                                    | 1003/7473 [00:05<00:32, 200.27it/s] 14%|█████████████▎                                                                                   | 1024/7473 [00:06<00:32, 200.77it/s] 14%|█████████████▌                                                                                   | 1045/7473 [00:06<00:32, 200.55it/s] 14%|█████████████▊                                                                                   | 1066/7473 [00:06<00:31, 200.84it/s] 15%|██████████████                                                                                   | 1087/7473 [00:06<00:31, 200.90it/s] 15%|██████████████▍                                                                                  | 1108/7473 [00:06<00:31, 200.50it/s] 15%|██████████████▋                                                                                  | 1129/7473 [00:06<00:31, 198.50it/s] 15%|██████████████▉                                                                                  | 1150/7473 [00:06<00:31, 198.95it/s] 16%|███████████████▏                                                                                 | 1170/7473 [00:06<00:32, 196.20it/s] 16%|███████████████▍                                                                                 | 1190/7473 [00:06<00:31, 197.06it/s] 16%|███████████████▋                                                                                 | 1210/7473 [00:07<00:31, 197.81it/s] 16%|███████████████▉                                                                                 | 1231/7473 [00:07<00:31, 198.45it/s] 17%|████████████████▎                                                                                | 1252/7473 [00:07<00:31, 199.04it/s] 17%|████████████████▌                                                                                | 1272/7473 [00:07<00:31, 199.26it/s] 17%|████████████████▊                                                                                | 1293/7473 [00:07<00:30, 199.60it/s] 18%|█████████████████                                                                                | 1313/7473 [00:07<00:30, 199.68it/s] 18%|█████████████████▎                                                                               | 1334/7473 [00:07<00:30, 200.13it/s] 18%|█████████████████▌                                                                               | 1355/7473 [00:07<00:30, 200.33it/s] 18%|█████████████████▊                                                                               | 1376/7473 [00:07<00:30, 200.31it/s] 19%|██████████████████▏                                                                              | 1397/7473 [00:07<00:30, 198.29it/s] 19%|██████████████████▍                                                                              | 1418/7473 [00:08<00:30, 199.65it/s] 19%|██████████████████▋                                                                              | 1439/7473 [00:08<00:30, 200.37it/s] 20%|██████████████████▉                                                                              | 1460/7473 [00:08<00:30, 200.41it/s] 20%|███████████████████▏                                                                             | 1481/7473 [00:08<00:29, 201.17it/s] 20%|███████████████████▍                                                                             | 1502/7473 [00:08<00:29, 201.70it/s] 20%|███████████████████▊                                                                             | 1523/7473 [00:08<00:29, 201.57it/s] 21%|████████████████████                                                                             | 1544/7473 [00:08<00:29, 201.08it/s] 21%|████████████████████▎                                                                            | 1565/7473 [00:08<00:29, 200.20it/s] 21%|████████████████████▌                                                                            | 1586/7473 [00:08<00:29, 199.55it/s] 22%|████████████████████▊                                                                            | 1607/7473 [00:09<00:29, 199.68it/s] 22%|█████████████████████                                                                            | 1627/7473 [00:09<00:29, 198.86it/s] 22%|█████████████████████▍                                                                           | 1648/7473 [00:09<00:29, 199.98it/s] 22%|█████████████████████▋                                                                           | 1669/7473 [00:09<00:28, 200.63it/s] 23%|█████████████████████▉                                                                           | 1690/7473 [00:09<00:28, 201.33it/s] 23%|██████████████████████▏                                                                          | 1711/7473 [00:09<00:28, 201.49it/s] 23%|██████████████████████▍                                                                          | 1732/7473 [00:09<00:28, 202.06it/s] 23%|██████████████████████▊                                                                          | 1753/7473 [00:09<00:28, 201.98it/s] 24%|███████████████████████                                                                          | 1774/7473 [00:09<00:28, 201.95it/s] 24%|███████████████████████▎                                                                         | 1795/7473 [00:09<00:28, 201.55it/s] 24%|███████████████████████▌                                                                         | 1816/7473 [00:10<00:28, 201.18it/s] 25%|███████████████████████▊                                                                         | 1837/7473 [00:10<00:28, 200.96it/s] 25%|████████████████████████                                                                         | 1858/7473 [00:10<00:28, 199.47it/s] 25%|████████████████████████▍                                                                        | 1879/7473 [00:10<00:27, 200.35it/s] 25%|████████████████████████▋                                                                        | 1900/7473 [00:10<00:27, 200.74it/s] 26%|████████████████████████▉                                                                        | 1921/7473 [00:10<00:27, 200.99it/s] 26%|█████████████████████████▏                                                                       | 1942/7473 [00:10<00:27, 201.22it/s] 26%|█████████████████████████▍                                                                       | 1963/7473 [00:10<00:27, 201.73it/s] 27%|█████████████████████████▊                                                                       | 1984/7473 [00:10<00:27, 201.50it/s] 27%|██████████████████████████                                                                       | 2005/7473 [00:10<00:27, 201.40it/s] 27%|██████████████████████████▎                                                                      | 2026/7473 [00:11<00:26, 201.79it/s] 27%|██████████████████████████▌                                                                      | 2047/7473 [00:11<00:26, 201.65it/s] 28%|██████████████████████████▊                                                                      | 2068/7473 [00:11<00:27, 199.88it/s] 28%|███████████████████████████                                                                      | 2089/7473 [00:11<00:26, 200.05it/s] 28%|███████████████████████████▍                                                                     | 2110/7473 [00:11<00:26, 199.96it/s] 29%|███████████████████████████▋                                                                     | 2130/7473 [00:11<00:26, 199.26it/s] 29%|███████████████████████████▉                                                                     | 2151/7473 [00:11<00:26, 199.65it/s] 29%|████████████████████████████▏                                                                    | 2171/7473 [00:11<00:26, 199.74it/s] 29%|████████████████████████████▍                                                                    | 2191/7473 [00:11<00:26, 199.53it/s] 30%|████████████████████████████▋                                                                    | 2212/7473 [00:12<00:26, 200.02it/s] 30%|████████████████████████████▉                                                                    | 2233/7473 [00:12<00:26, 200.04it/s] 30%|█████████████████████████████▎                                                                   | 2254/7473 [00:12<00:26, 199.54it/s] 30%|█████████████████████████████▌                                                                   | 2274/7473 [00:12<00:26, 199.26it/s] 31%|█████████████████████████████▊                                                                   | 2294/7473 [00:12<00:26, 197.89it/s] 31%|██████████████████████████████                                                                   | 2315/7473 [00:12<00:25, 198.75it/s] 31%|██████████████████████████████▎                                                                  | 2336/7473 [00:12<00:25, 199.48it/s] 32%|██████████████████████████████▌                                                                  | 2356/7473 [00:12<00:25, 199.56it/s] 32%|██████████████████████████████▊                                                                  | 2377/7473 [00:12<00:25, 200.00it/s] 32%|███████████████████████████████▏                                                                 | 2398/7473 [00:12<00:25, 200.11it/s] 32%|███████████████████████████████▍                                                                 | 2419/7473 [00:13<00:25, 200.46it/s] 33%|███████████████████████████████▋                                                                 | 2440/7473 [00:13<00:25, 200.91it/s] 33%|███████████████████████████████▉                                                                 | 2461/7473 [00:13<00:24, 200.96it/s] 33%|████████████████████████████████▏                                                                | 2482/7473 [00:13<00:24, 200.54it/s] 33%|████████████████████████████████▍                                                                | 2503/7473 [00:13<00:24, 200.36it/s] 34%|████████████████████████████████▊                                                                | 2524/7473 [00:13<00:27, 177.26it/s] 34%|█████████████████████████████████                                                                | 2545/7473 [00:13<00:26, 183.56it/s] 34%|█████████████████████████████████▎                                                               | 2566/7473 [00:13<00:26, 188.68it/s] 35%|█████████████████████████████████▌                                                               | 2587/7473 [00:13<00:25, 192.17it/s] 35%|█████████████████████████████████▊                                                               | 2608/7473 [00:14<00:24, 194.74it/s] 35%|██████████████████████████████████                                                               | 2629/7473 [00:14<00:24, 196.66it/s] 35%|██████████████████████████████████▍                                                              | 2650/7473 [00:14<00:24, 197.86it/s] 36%|██████████████████████████████████▋                                                              | 2671/7473 [00:14<00:24, 199.00it/s] 36%|██████████████████████████████████▉                                                              | 2692/7473 [00:14<00:23, 199.89it/s] 36%|███████████████████████████████████▏                                                             | 2713/7473 [00:14<00:23, 200.40it/s] 37%|███████████████████████████████████▍                                                             | 2734/7473 [00:14<00:23, 200.48it/s] 37%|███████████████████████████████████▊                                                             | 2755/7473 [00:14<00:23, 199.69it/s] 37%|████████████████████████████████████                                                             | 2776/7473 [00:14<00:23, 200.32it/s] 37%|████████████████████████████████████▎                                                            | 2797/7473 [00:14<00:23, 200.70it/s] 38%|████████████████████████████████████▌                                                            | 2818/7473 [00:15<00:23, 200.03it/s] 38%|████████████████████████████████████▊                                                            | 2839/7473 [00:15<00:23, 200.94it/s] 38%|█████████████████████████████████████                                                            | 2860/7473 [00:15<00:22, 200.77it/s] 39%|█████████████████████████████████████▍                                                           | 2881/7473 [00:15<00:22, 200.73it/s] 39%|█████████████████████████████████████▋                                                           | 2902/7473 [00:15<00:22, 201.14it/s] 39%|█████████████████████████████████████▉                                                           | 2923/7473 [00:15<00:22, 201.24it/s] 39%|██████████████████████████████████████▏                                                          | 2944/7473 [00:15<00:22, 201.68it/s] 40%|██████████████████████████████████████▍                                                          | 2965/7473 [00:15<00:22, 201.98it/s] 40%|██████████████████████████████████████▊                                                          | 2986/7473 [00:15<00:22, 200.37it/s] 40%|███████████████████████████████████████                                                          | 3007/7473 [00:16<00:22, 200.80it/s] 41%|███████████████████████████████████████▎                                                         | 3028/7473 [00:16<00:22, 200.98it/s] 41%|███████████████████████████████████████▌                                                         | 3049/7473 [00:16<00:21, 201.23it/s] 41%|███████████████████████████████████████▊                                                         | 3070/7473 [00:16<00:21, 201.39it/s] 41%|████████████████████████████████████████                                                         | 3091/7473 [00:16<00:21, 201.11it/s] 42%|████████████████████████████████████████▍                                                        | 3112/7473 [00:16<00:21, 200.95it/s] 42%|████████████████████████████████████████▋                                                        | 3133/7473 [00:16<00:21, 200.97it/s] 42%|████████████████████████████████████████▉                                                        | 3154/7473 [00:16<00:21, 199.60it/s] 42%|█████████████████████████████████████████▏                                                       | 3175/7473 [00:16<00:21, 200.19it/s] 43%|█████████████████████████████████████████▍                                                       | 3196/7473 [00:16<00:21, 200.54it/s] 43%|█████████████████████████████████████████▊                                                       | 3217/7473 [00:17<00:21, 198.97it/s] 43%|██████████████████████████████████████████                                                       | 3238/7473 [00:17<00:21, 199.75it/s] 44%|██████████████████████████████████████████▎                                                      | 3259/7473 [00:17<00:21, 200.36it/s] 44%|██████████████████████████████████████████▌                                                      | 3280/7473 [00:17<00:20, 201.02it/s] 44%|██████████████████████████████████████████▊                                                      | 3301/7473 [00:17<00:20, 201.25it/s] 44%|███████████████████████████████████████████                                                      | 3322/7473 [00:17<00:20, 201.47it/s] 45%|███████████████████████████████████████████▍                                                     | 3343/7473 [00:17<00:20, 200.80it/s] 45%|███████████████████████████████████████████▋                                                     | 3364/7473 [00:17<00:20, 200.66it/s] 45%|███████████████████████████████████████████▉                                                     | 3385/7473 [00:17<00:20, 200.69it/s] 46%|████████████████████████████████████████████▏                                                    | 3406/7473 [00:18<00:20, 200.83it/s] 46%|████████████████████████████████████████████▍                                                    | 3427/7473 [00:18<00:20, 199.33it/s] 46%|████████████████████████████████████████████▊                                                    | 3448/7473 [00:18<00:20, 199.64it/s] 46%|█████████████████████████████████████████████                                                    | 3469/7473 [00:18<00:20, 199.90it/s] 47%|█████████████████████████████████████████████▎                                                   | 3489/7473 [00:18<00:19, 199.29it/s] 47%|█████████████████████████████████████████████▌                                                   | 3510/7473 [00:18<00:19, 199.95it/s] 47%|█████████████████████████████████████████████▊                                                   | 3531/7473 [00:18<00:19, 200.38it/s] 48%|██████████████████████████████████████████████                                                   | 3552/7473 [00:18<00:19, 200.80it/s] 48%|██████████████████████████████████████████████▍                                                  | 3573/7473 [00:18<00:19, 201.42it/s] 48%|██████████████████████████████████████████████▋                                                  | 3594/7473 [00:18<00:19, 201.47it/s] 48%|██████████████████████████████████████████████▉                                                  | 3615/7473 [00:19<00:19, 201.36it/s] 49%|███████████████████████████████████████████████▏                                                 | 3636/7473 [00:19<00:19, 201.17it/s] 49%|███████████████████████████████████████████████▍                                                 | 3657/7473 [00:19<00:19, 199.31it/s] 49%|███████████████████████████████████████████████▋                                                 | 3678/7473 [00:19<00:19, 199.63it/s] 49%|████████████████████████████████████████████████                                                 | 3699/7473 [00:19<00:18, 200.32it/s] 50%|████████████████████████████████████████████████▎                                                | 3720/7473 [00:19<00:18, 200.53it/s] 50%|████████████████████████████████████████████████▌                                                | 3741/7473 [00:19<00:18, 200.57it/s] 50%|████████████████████████████████████████████████▊                                                | 3762/7473 [00:19<00:18, 200.55it/s] 51%|█████████████████████████████████████████████████                                                | 3783/7473 [00:19<00:18, 201.00it/s] 51%|█████████████████████████████████████████████████▍                                               | 3804/7473 [00:20<00:18, 200.83it/s] 51%|█████████████████████████████████████████████████▋                                               | 3825/7473 [00:20<00:18, 200.90it/s] 51%|█████████████████████████████████████████████████▉                                               | 3846/7473 [00:20<00:18, 199.93it/s] 52%|██████████████████████████████████████████████████▏                                              | 3867/7473 [00:20<00:18, 200.27it/s] 52%|██████████████████████████████████████████████████▍                                              | 3888/7473 [00:20<00:18, 198.52it/s] 52%|██████████████████████████████████████████████████▋                                              | 3909/7473 [00:20<00:17, 199.34it/s] 53%|███████████████████████████████████████████████████                                              | 3930/7473 [00:20<00:17, 200.12it/s] 53%|███████████████████████████████████████████████████▎                                             | 3951/7473 [00:20<00:17, 200.50it/s] 53%|███████████████████████████████████████████████████▌                                             | 3972/7473 [00:20<00:17, 200.84it/s] 53%|███████████████████████████████████████████████████▊                                             | 3993/7473 [00:20<00:17, 201.19it/s] 54%|████████████████████████████████████████████████████                                             | 4014/7473 [00:21<00:17, 201.78it/s] 54%|████████████████████████████████████████████████████▎                                            | 4035/7473 [00:21<00:17, 201.53it/s] 54%|████████████████████████████████████████████████████▋                                            | 4056/7473 [00:21<00:16, 201.49it/s] 55%|████████████████████████████████████████████████████▉                                            | 4077/7473 [00:21<00:16, 201.40it/s] 55%|█████████████████████████████████████████████████████▏                                           | 4098/7473 [00:21<00:16, 201.48it/s] 55%|█████████████████████████████████████████████████████▍                                           | 4119/7473 [00:21<00:16, 199.38it/s] 55%|█████████████████████████████████████████████████████▋                                           | 4139/7473 [00:21<00:16, 199.50it/s] 56%|█████████████████████████████████████████████████████▉                                           | 4160/7473 [00:21<00:16, 199.97it/s] 56%|██████████████████████████████████████████████████████▎                                          | 4180/7473 [00:21<00:16, 198.80it/s] 56%|██████████████████████████████████████████████████████▌                                          | 4201/7473 [00:21<00:16, 199.76it/s] 56%|██████████████████████████████████████████████████████▊                                          | 4222/7473 [00:22<00:16, 200.01it/s] 57%|███████████████████████████████████████████████████████                                          | 4243/7473 [00:22<00:16, 200.42it/s] 57%|███████████████████████████████████████████████████████▎                                         | 4264/7473 [00:22<00:15, 200.57it/s] 57%|███████████████████████████████████████████████████████▌                                         | 4285/7473 [00:22<00:15, 200.60it/s] 58%|███████████████████████████████████████████████████████▉                                         | 4306/7473 [00:22<00:15, 200.60it/s] 58%|████████████████████████████████████████████████████████▏                                        | 4327/7473 [00:22<00:15, 200.68it/s] 58%|████████████████████████████████████████████████████████▍                                        | 4348/7473 [00:22<00:15, 199.35it/s] 58%|████████████████████████████████████████████████████████▋                                        | 4369/7473 [00:22<00:15, 199.79it/s] 59%|████████████████████████████████████████████████████████▉                                        | 4390/7473 [00:22<00:15, 200.16it/s] 59%|█████████████████████████████████████████████████████████▎                                       | 4411/7473 [00:23<00:15, 200.59it/s] 59%|█████████████████████████████████████████████████████████▌                                       | 4432/7473 [00:23<00:15, 200.67it/s] 60%|█████████████████████████████████████████████████████████▊                                       | 4453/7473 [00:23<00:15, 200.20it/s] 60%|██████████████████████████████████████████████████████████                                       | 4474/7473 [00:23<00:14, 200.68it/s] 60%|██████████████████████████████████████████████████████████▎                                      | 4495/7473 [00:23<00:14, 200.79it/s] 60%|██████████████████████████████████████████████████████████▌                                      | 4516/7473 [00:23<00:14, 199.00it/s] 61%|██████████████████████████████████████████████████████████▉                                      | 4537/7473 [00:23<00:14, 199.81it/s] 61%|███████████████████████████████████████████████████████████▏                                     | 4558/7473 [00:23<00:14, 200.60it/s] 61%|███████████████████████████████████████████████████████████▍                                     | 4579/7473 [00:23<00:14, 199.18it/s] 62%|███████████████████████████████████████████████████████████▋                                     | 4600/7473 [00:23<00:14, 199.56it/s] 62%|███████████████████████████████████████████████████████████▉                                     | 4621/7473 [00:24<00:14, 200.02it/s] 62%|████████████████████████████████████████████████████████████▎                                    | 4642/7473 [00:24<00:14, 200.05it/s] 62%|████████████████████████████████████████████████████████████▌                                    | 4663/7473 [00:24<00:14, 200.41it/s] 63%|████████████████████████████████████████████████████████████▊                                    | 4684/7473 [00:24<00:13, 200.53it/s] 63%|█████████████████████████████████████████████████████████████                                    | 4705/7473 [00:24<00:13, 200.68it/s] 63%|█████████████████████████████████████████████████████████████▎                                   | 4726/7473 [00:24<00:13, 200.90it/s] 64%|█████████████████████████████████████████████████████████████▌                                   | 4747/7473 [00:24<00:13, 200.52it/s] 64%|█████████████████████████████████████████████████████████████▉                                   | 4768/7473 [00:24<00:13, 200.58it/s] 64%|██████████████████████████████████████████████████████████████▏                                  | 4789/7473 [00:24<00:13, 199.01it/s] 64%|██████████████████████████████████████████████████████████████▍                                  | 4810/7473 [00:25<00:13, 199.36it/s] 65%|██████████████████████████████████████████████████████████████▋                                  | 4831/7473 [00:25<00:13, 200.19it/s] 65%|██████████████████████████████████████████████████████████████▉                                  | 4852/7473 [00:25<00:13, 200.07it/s] 65%|███████████████████████████████████████████████████████████████▎                                 | 4873/7473 [00:25<00:12, 200.09it/s] 65%|███████████████████████████████████████████████████████████████▌                                 | 4894/7473 [00:25<00:12, 200.48it/s] 66%|███████████████████████████████████████████████████████████████▊                                 | 4915/7473 [00:25<00:12, 200.60it/s] 66%|████████████████████████████████████████████████████████████████                                 | 4936/7473 [00:25<00:12, 200.59it/s] 66%|████████████████████████████████████████████████████████████████▎                                | 4957/7473 [00:25<00:12, 200.93it/s] 67%|████████████████████████████████████████████████████████████████▌                                | 4978/7473 [00:25<00:12, 200.76it/s] 67%|████████████████████████████████████████████████████████████████▉                                | 4999/7473 [00:25<00:12, 200.74it/s] 67%|█████████████████████████████████████████████████████████████████▏                               | 5020/7473 [00:26<00:12, 199.63it/s] 67%|█████████████████████████████████████████████████████████████████▍                               | 5041/7473 [00:26<00:12, 199.81it/s] 68%|█████████████████████████████████████████████████████████████████▋                               | 5062/7473 [00:26<00:12, 200.34it/s] 68%|█████████████████████████████████████████████████████████████████▉                               | 5083/7473 [00:26<00:11, 200.54it/s] 68%|██████████████████████████████████████████████████████████████████▎                              | 5104/7473 [00:26<00:11, 200.74it/s] 69%|██████████████████████████████████████████████████████████████████▌                              | 5125/7473 [00:26<00:11, 200.82it/s] 69%|██████████████████████████████████████████████████████████████████▊                              | 5146/7473 [00:26<00:11, 200.91it/s] 69%|███████████████████████████████████████████████████████████████████                              | 5167/7473 [00:26<00:11, 200.86it/s] 69%|███████████████████████████████████████████████████████████████████▎                             | 5188/7473 [00:26<00:11, 200.95it/s] 70%|███████████████████████████████████████████████████████████████████▌                             | 5209/7473 [00:27<00:11, 200.94it/s] 70%|███████████████████████████████████████████████████████████████████▉                             | 5230/7473 [00:27<00:11, 200.90it/s] 70%|████████████████████████████████████████████████████████████████████▏                            | 5251/7473 [00:27<00:12, 173.72it/s] 71%|████████████████████████████████████████████████████████████████████▍                            | 5272/7473 [00:27<00:12, 180.96it/s] 71%|████████████████████████████████████████████████████████████████████▋                            | 5292/7473 [00:27<00:11, 185.56it/s] 71%|████████████████████████████████████████████████████████████████████▉                            | 5313/7473 [00:27<00:11, 189.83it/s] 71%|█████████████████████████████████████████████████████████████████████▏                           | 5333/7473 [00:27<00:11, 192.64it/s] 72%|█████████████████████████████████████████████████████████████████████▍                           | 5354/7473 [00:27<00:10, 195.05it/s] 72%|█████████████████████████████████████████████████████████████████████▊                           | 5375/7473 [00:27<00:10, 196.78it/s] 72%|██████████████████████████████████████████████████████████████████████                           | 5396/7473 [00:28<00:10, 198.15it/s] 72%|██████████████████████████████████████████████████████████████████████▎                          | 5416/7473 [00:28<00:10, 198.65it/s] 73%|██████████████████████████████████████████████████████████████████████▌                          | 5437/7473 [00:28<00:10, 199.34it/s] 73%|██████████████████████████████████████████████████████████████████████▊                          | 5457/7473 [00:28<00:10, 198.80it/s] 73%|███████████████████████████████████████████████████████████████████████                          | 5477/7473 [00:28<00:14, 137.44it/s] 74%|███████████████████████████████████████████████████████████████████████▎                         | 5497/7473 [00:28<00:13, 151.22it/s] 74%|███████████████████████████████████████████████████████████████████████▌                         | 5517/7473 [00:28<00:12, 162.77it/s] 74%|███████████████████████████████████████████████████████████████████████▊                         | 5537/7473 [00:28<00:11, 171.71it/s] 74%|████████████████████████████████████████████████████████████████████████▏                        | 5557/7473 [00:28<00:10, 179.18it/s] 75%|████████████████████████████████████████████████████████████████████████▍                        | 5577/7473 [00:29<00:10, 184.50it/s] 75%|████████████████████████████████████████████████████████████████████████▋                        | 5597/7473 [00:29<00:09, 188.41it/s] 75%|████████████████████████████████████████████████████████████████████████▉                        | 5617/7473 [00:29<00:09, 191.55it/s] 75%|█████████████████████████████████████████████████████████████████████████▏                       | 5637/7473 [00:29<00:09, 193.86it/s] 76%|█████████████████████████████████████████████████████████████████████████▍                       | 5657/7473 [00:29<00:09, 195.47it/s] 76%|█████████████████████████████████████████████████████████████████████████▋                       | 5677/7473 [00:29<00:09, 194.74it/s] 76%|█████████████████████████████████████████████████████████████████████████▉                       | 5697/7473 [00:29<00:09, 195.74it/s] 77%|██████████████████████████████████████████████████████████████████████████▏                      | 5717/7473 [00:29<00:08, 196.45it/s] 77%|██████████████████████████████████████████████████████████████████████████▍                      | 5737/7473 [00:29<00:08, 197.42it/s] 77%|██████████████████████████████████████████████████████████████████████████▋                      | 5757/7473 [00:29<00:08, 198.05it/s] 77%|██████████████████████████████████████████████████████████████████████████▉                      | 5777/7473 [00:30<00:08, 198.58it/s] 78%|███████████████████████████████████████████████████████████████████████████▏                     | 5797/7473 [00:30<00:08, 198.44it/s] 78%|███████████████████████████████████████████████████████████████████████████▌                     | 5817/7473 [00:30<00:08, 198.29it/s] 78%|███████████████████████████████████████████████████████████████████████████▊                     | 5837/7473 [00:30<00:08, 198.30it/s] 78%|████████████████████████████████████████████████████████████████████████████                     | 5857/7473 [00:30<00:08, 198.57it/s] 79%|████████████████████████████████████████████████████████████████████████████▎                    | 5877/7473 [00:30<00:08, 198.72it/s] 79%|████████████████████████████████████████████████████████████████████████████▌                    | 5897/7473 [00:30<00:07, 198.67it/s] 79%|████████████████████████████████████████████████████████████████████████████▊                    | 5917/7473 [00:30<00:07, 196.98it/s] 79%|█████████████████████████████████████████████████████████████████████████████                    | 5937/7473 [00:30<00:07, 197.09it/s] 80%|█████████████████████████████████████████████████████████████████████████████▎                   | 5957/7473 [00:30<00:07, 197.18it/s] 80%|█████████████████████████████████████████████████████████████████████████████▌                   | 5977/7473 [00:31<00:07, 197.49it/s] 80%|█████████████████████████████████████████████████████████████████████████████▊                   | 5997/7473 [00:31<00:07, 197.89it/s] 81%|██████████████████████████████████████████████████████████████████████████████                   | 6017/7473 [00:31<00:07, 198.09it/s] 81%|██████████████████████████████████████████████████████████████████████████████▎                  | 6037/7473 [00:31<00:07, 198.38it/s] 81%|██████████████████████████████████████████████████████████████████████████████▋                  | 6058/7473 [00:31<00:07, 199.06it/s] 81%|██████████████████████████████████████████████████████████████████████████████▉                  | 6078/7473 [00:31<00:07, 199.01it/s] 82%|███████████████████████████████████████████████████████████████████████████████▏                 | 6098/7473 [00:31<00:06, 198.81it/s] 82%|███████████████████████████████████████████████████████████████████████████████▍                 | 6118/7473 [00:31<00:06, 198.82it/s] 82%|███████████████████████████████████████████████████████████████████████████████▋                 | 6138/7473 [00:31<00:06, 197.14it/s] 82%|███████████████████████████████████████████████████████████████████████████████▉                 | 6158/7473 [00:32<00:06, 197.71it/s] 83%|████████████████████████████████████████████████████████████████████████████████▏                | 6178/7473 [00:32<00:06, 198.03it/s] 83%|████████████████████████████████████████████████████████████████████████████████▍                | 6198/7473 [00:32<00:06, 198.45it/s] 83%|████████████████████████████████████████████████████████████████████████████████▋                | 6218/7473 [00:32<00:06, 198.52it/s] 83%|████████████████████████████████████████████████████████████████████████████████▉                | 6238/7473 [00:32<00:06, 198.82it/s] 84%|█████████████████████████████████████████████████████████████████████████████████▏               | 6259/7473 [00:32<00:06, 199.33it/s] 84%|█████████████████████████████████████████████████████████████████████████████████▌               | 6280/7473 [00:32<00:05, 199.88it/s] 84%|█████████████████████████████████████████████████████████████████████████████████▊               | 6300/7473 [00:32<00:05, 199.86it/s] 85%|██████████████████████████████████████████████████████████████████████████████████               | 6321/7473 [00:32<00:05, 200.56it/s] 85%|██████████████████████████████████████████████████████████████████████████████████▎              | 6342/7473 [00:32<00:05, 200.08it/s] 85%|██████████████████████████████████████████████████████████████████████████████████▌              | 6363/7473 [00:33<00:05, 198.85it/s] 85%|██████████████████████████████████████████████████████████████████████████████████▊              | 6383/7473 [00:33<00:05, 198.63it/s] 86%|███████████████████████████████████████████████████████████████████████████████████              | 6404/7473 [00:33<00:05, 199.25it/s] 86%|███████████████████████████████████████████████████████████████████████████████████▍             | 6425/7473 [00:33<00:05, 199.65it/s] 86%|███████████████████████████████████████████████████████████████████████████████████▋             | 6446/7473 [00:33<00:05, 199.93it/s] 87%|███████████████████████████████████████████████████████████████████████████████████▉             | 6467/7473 [00:33<00:05, 200.01it/s] 87%|████████████████████████████████████████████████████████████████████████████████████▏            | 6488/7473 [00:33<00:04, 200.20it/s] 87%|████████████████████████████████████████████████████████████████████████████████████▍            | 6509/7473 [00:33<00:04, 200.19it/s] 87%|████████████████████████████████████████████████████████████████████████████████████▊            | 6530/7473 [00:33<00:04, 200.27it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████            | 6551/7473 [00:33<00:04, 200.70it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████▎           | 6572/7473 [00:34<00:04, 200.26it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████▌           | 6593/7473 [00:34<00:04, 199.11it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████▊           | 6613/7473 [00:34<00:04, 199.33it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████           | 6633/7473 [00:34<00:04, 199.31it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████▎          | 6654/7473 [00:34<00:04, 199.48it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████▋          | 6674/7473 [00:34<00:04, 199.63it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████▉          | 6695/7473 [00:34<00:03, 200.21it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████▏         | 6716/7473 [00:34<00:03, 199.97it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████▍         | 6737/7473 [00:34<00:03, 200.29it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████▋         | 6758/7473 [00:35<00:03, 200.03it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████▉         | 6779/7473 [00:35<00:03, 199.96it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████▎        | 6800/7473 [00:35<00:03, 200.02it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████▌        | 6821/7473 [00:35<00:03, 198.46it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████▊        | 6842/7473 [00:35<00:03, 199.15it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████        | 6863/7473 [00:35<00:03, 199.52it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████▎       | 6884/7473 [00:35<00:02, 199.97it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████▋       | 6905/7473 [00:35<00:02, 200.41it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████▉       | 6926/7473 [00:35<00:02, 200.48it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████▏      | 6947/7473 [00:35<00:02, 200.55it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████▍      | 6968/7473 [00:36<00:02, 200.43it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████▋      | 6989/7473 [00:36<00:02, 200.38it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████▉      | 7010/7473 [00:36<00:02, 200.11it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████▎     | 7031/7473 [00:36<00:02, 200.01it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████▌     | 7052/7473 [00:36<00:02, 198.48it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████▊     | 7073/7473 [00:36<00:02, 199.11it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████     | 7094/7473 [00:36<00:01, 199.79it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████▎    | 7115/7473 [00:36<00:01, 199.96it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████▌    | 7135/7473 [00:36<00:01, 199.81it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████▉    | 7156/7473 [00:37<00:01, 200.17it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████▏   | 7177/7473 [00:37<00:01, 200.28it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████▍   | 7198/7473 [00:37<00:01, 200.49it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████▋   | 7219/7473 [00:37<00:01, 200.75it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████▉   | 7240/7473 [00:37<00:01, 201.00it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████▏  | 7261/7473 [00:37<00:01, 201.10it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████▌  | 7282/7473 [00:37<00:00, 199.56it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████▊  | 7303/7473 [00:37<00:00, 199.93it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████  | 7323/7473 [00:37<00:00, 199.78it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████▎ | 7343/7473 [00:37<00:00, 199.61it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████▌ | 7364/7473 [00:38<00:00, 199.86it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████▊ | 7385/7473 [00:38<00:00, 200.08it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████▏| 7406/7473 [00:38<00:00, 200.30it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████▍| 7427/7473 [00:38<00:00, 200.17it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████▋| 7448/7473 [00:38<00:00, 199.75it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████▉| 7468/7473 [00:38<00:00, 199.07it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 7473/7473 [00:38<00:00, 193.64it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.03s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.04s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:11,  5.52s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:11,  5.52s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.02s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.29s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.20s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.43s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.42s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.58s/it]
[2023-08-18 09:05:52,979] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.52s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.73s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.64s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.79s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  4.91s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.06s/it]
[2023-08-18 09:06:05,303] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-18 09:06:05,304] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-18 09:06:05,305] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-18 09:06:05,305] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-18 09:06:05,305] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-18 09:06:05,305] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-18 09:06:05,305] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-18 09:06:05,305] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-18 09:06:05,305] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-18 09:06:05,305] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-18 09:06:05,305] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-18 09:06:05,305] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f5796f6bbb0>
[2023-08-18 09:06:05,305] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-18 09:06:05,305] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-18 09:06:05,306] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-18 09:06:05,306] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-18 09:06:05,306] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-18 09:06:05,306] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-18 09:06:05,306] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-18 09:06:05,306] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-18 09:06:05,306] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-18 09:06:05,306] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-18 09:06:05,306] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-18 09:06:05,306] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-18 09:06:05,306] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-18 09:06:05,306] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-18 09:06:05,306] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-18 09:06:05,306] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-18 09:06:05,306] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-18 09:06:05,306] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-18 09:06:05,306] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-18 09:06:05,306] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-18 09:06:05,306] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-18 09:06:05,306] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-18 09:06:05,306] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-18 09:06:05,306] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-18 09:06:05,306] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-18 09:06:05,306] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-18 09:06:05,306] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-18 09:06:05,306] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-18 09:06:05,306] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-18 09:06:05,306] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-18 09:06:05,306] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-18 09:06:05,306] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-18 09:06:05,306] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f5796f6bd90>
[2023-08-18 09:06:05,306] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-18 09:06:05,306] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-18 09:06:05,306] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-18 09:06:05,306] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-18 09:06:05,306] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-18 09:06:05,306] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-18 09:06:05,307] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-18 09:06:05,307] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-18 09:06:05,307] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-18 09:06:05,307] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-18 09:06:05,307] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-18 09:06:05,307] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-18 09:06:05,307] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-18 09:06:05,307] [INFO] [config.py:1012:print]   train_batch_size ............. 8
[2023-08-18 09:06:05,307] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  2
[2023-08-18 09:06:05,307] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-18 09:06:05,307] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-18 09:06:05,307] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-18 09:06:05,307] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-18 09:06:05,307] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-18 09:06:05,307] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-18 09:06:05,307] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-18 09:06:05,307] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.6778831481933594 seconds
Loading extension module utils...
Time to load utils op: 0.6048521995544434 seconds
Loading extension module utils...
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Time to load utils op: 0.6055562496185303 seconds
Evaluating gsm8k :   0%|                                                                                           | 0/125 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following grade math question.

Input: Fabric is cut to order at what type of seller? Choices:  A: curtains B: tailor shop C: clothing store D: sewing room E: hardware store
Output: 1. The question asks where fabric is cut to order. This means we're looking for a seller that provides customized services, specifically in relation to fabric. 
2. Looking at the choices: curtains, tailor shop, clothing store, sewing room, and hardware store. 
3. We can eliminate "curtains" as it is a type of product, not a place where things are sold. 
4. A "sewing room" can be a location where fabrics could potentially be cut, but it's more of a place in a house or premises where sewing is done, not typically a commercial seller. 
5. A "hardware store" does not usually deal with fabric or sewing; it typically sells materials related to home improvement or construction project, such as tools and hardware components. So, we can eliminate that as well. 
6. Between "clothing store" and "tailor shop", a clothing store normally sells ready-made clothes, and does not typically offer custom services like cutting fabric to a specific size. 
7. Therefore, the only viable choice left is "tailor shop". A tailor shop does offer services of custom fitting and alterations hence they do cut fabrics to order. Correct answer is B: tailor shop.
So the final answer is B: tailor shop

Input: Where are you if your reading magazines while waiting for a vehicle on rails? Choices:  A: vegetables B: market C: doctor D: train station E: bookstore
Output: 1. The question provides a scenario where you're reading magazines while waiting for a vehicle that moves on rails.
2. This scenario involves two important clues: reading magazines and a vehicle that moves on rails.
3. Looking at the choices, we can start to eliminate options that don't fit both parts of the scenario.
4. Vegetables are an item, not a place. So, A "vegetables" would not be the correct answer.
5. Marketplaces or stores do involve buying and possibly reading magazines, but typically, they don’t have vehicles on rails, so B "market" would not be the right answer.
6. Similarly, in a doctor's office, you can read magazines, but there would be no vehicles on rails, so C "doctor" would not be the correct choice.
7. In a bookstore, you can surely read a variety of magazines, but you do not typically find vehicles on rails. Hence, E "bookstore" can also be eliminated.
8. Now if you consider choice D "train station," you can surely find magazines to read (in the waiting area) while waiting and the vehicle that is coming on rails would be a train.
9. Therefore after analyzing all the choices, in combination with the scenario provided in the question, D "train station" seems to be the best fitting answer.
So the final answer is D: train station

Input: What would need oil to be used? Choices:  A: ground B: human  body C: repair shop D: combustion engines E: service station
Output: Step 1: Consider each of the options individually.
Step 2: A: Ground doesn't require oil for its functioning, so this option can be eliminated.
Step 3: B: The human body produces its own oils and doesn't require external oil, so this option can be eliminated.
Step 4: C: A repair shop may make use of oil for certain tasks, but oil is not inherently needed for a repair shop to function, so this option can also be eliminated.
Step 5: D: Combustion engines require oil for lubrication, cooling, cleaning, and protecting against rust. This option is valid.
Step 6: E: A service station might sell or change oil, but it technically doesn't need oil to operate, so this option can also be eliminated.
Step 7: Only one option left which is combustion engines and that's why the answer is D.
So the final answer is D: combustion engines

Input: What is person probably feeling that plans on stopping being married to their spouse? Choices:  A: detachment B: bankruptcy C: sad D: fights E: wrong
Output: Reasoning:

In the context of the question, we are looking for an emotion or state which corresponds with someone planning to end their marriage relationship.

A: Detachment - In psychology, detachment is an individual's ability to separate their thoughts and feelings in a neutral manner, taking a step back from immediate, overwhelming and possibly negative emotions. If a person plans to end their marriage, it's likely they are emotionally and/or psychologically detached from their spouse. This seems like a plausible answer.

B: Bankruptcy - While financial troubles can occur during a breakup, feeling "bankruptcy" isn't directly related to the emotional status of a person planning to get divorced. It's more associated with financial status. So, this wouldn't be a logical answer.

C: Sad - While the person may very well feel sad, it does not necessarily correspond with the intention to stop being married. One can be sad due to many reasons within a marriage, and doesn't always imply the intention to end the relationship. Thus, it is not the most appropriate solution.

D: Fights - This option could lead to a person wanting to end a marriage, but the term 'fights' is not an emotion or feelings. It's a situation or a type of conflict. Therefore, this option doesn't fit with the solution.

E: Wrong - The term "wrong" is a moral judgment or a feeling of guilt which is not necessarily connected to the decision of stopping the marital relationship. It's a state of perception rather than emotion structure. So, this answer doesn't suit in best way.

Hence, among the provided choices, the most accurate answer to the question as to how the person probably feels when planning to end their marriage is detachment. They would have decided to emotionally disconnect from their spouse and thus feel detached.
So the final answer is A: detachment

Input: What could you use to store a clock? Choices:  A: shelf B: own bedroom C: desk D: wall E: car
Output: 1. The question is asking for a location or item that could be used to store a clock.
2. Thus, we need to evaluate each choice to determine if a clock can be practically stored there.
3. Starting with choice A: a shelf, this is a common place to store a clock. They can be placed there and remain stable.
4. Next, choice B: an own bedroom. However, this is not an actual item or specific location you can put the clock. It's just a general area, the clock could be anywhere in it, so it's not as correct as other specific options.
5. Choice C: desk. While it's true that a clock can be put on a desk, the phrase we're looking for is'store a clock', implying a more permanent place to keep it when it's not in use, a desk normally is not used for storage.
6. Choice D: wall. Clocks do hang on walls, but walls are not typically used for storage as things can’t be placed inside them.
7. Finally, choice E: a car. While you can store things in a car temporarily, it is not a practical or common place to store a clock. 
8. Therefore, out of all the listed choices, the shelf (choice A) would be the best option to store a clock.
So the final answer is A: shelf

Input: The person put on lotion, what did they want? Choices:  A: fresh smell B: good credit C: smooth skin D: fresh produce E: headache
Output: 1. Lotion application doesn't directly influence or cause fresh smell, good credit, fresh produce, or headache. 
2. Therefore, we can eliminate options A, B, D, and E.
3. When we put on lotion, it's usually for the purpose of moisturizing our skin.
4. Moisturizing makes the skin feel soft and smooth.
5. Therefore, the person who put on the lotion would want C: smooth skin.
So the final answer is C: smooth skin

Input:Natalia sold clips to 48 of her friends in April, and then she sold half as many clips in May. How many clips did Natalia sell altogether in April and May?
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o6-tcommonsenseqa-s10-rTrue
Loading extension module utils...
Time to load utils op: 0.6051528453826904 seconds
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Evaluating gsm8k :   0%|                                                                                           | 0/125 [00:03<?, ?it/s]
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 1874607) of binary: /home/ylu130/.conda/envs/distllm/bin/python
Traceback (most recent call last):
  File "/home/ylu130/.conda/envs/distllm/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 345, in wrapper
    return f(*args, **kwargs)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 761, in main
    run(args)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 752, in run
    elastic_launch(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 131, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 245, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
/home/ylu130/workspace/in-context-generalization/inference.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2023-08-18_09:06:10
  host      : ia1.wse.jhu.edu
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 1874608)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2023-08-18_09:06:10
  host      : ia1.wse.jhu.edu
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 1874610)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2023-08-18_09:06:10
  host      : ia1.wse.jhu.edu
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 1874611)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2023-08-18_09:06:10
  host      : ia1.wse.jhu.edu
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 1874607)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name gsm8k --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name commonsenseqa --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 2 --data-dir /scratch/ylu130/processed_data/gsm8k/out-domain/o7-tcommonsenseqa-s10-rTrue --seed 10 --max-prompt-length 2048 --rationales --num-out-domain 7
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date![nltk_data]   Package punkt is already up-to-date!

using world size: 4
[2023-08-18 09:06:14,389] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... gsm8k
  data_dir ..................... /scratch/ylu130/processed_data/gsm8k/out-domain/o7-tcommonsenseqa-s10-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 7
  out_domain_data_name ......... commonsenseqa
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o7-tcommonsenseqa-s10-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 2
  clip_grad .................... 1.0
  seed ......................... 10
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                                             | 0/7473 [00:00<?, ?it/s]  0%|▏                                                                                                  | 14/7473 [00:00<00:55, 134.35it/s]  0%|▎                                                                                                  | 28/7473 [00:00<00:55, 134.52it/s]  1%|▌                                                                                                  | 42/7473 [00:00<00:55, 134.19it/s]  1%|▋                                                                                                  | 56/7473 [00:00<00:55, 134.42it/s]  1%|▉                                                                                                  | 70/7473 [00:00<00:54, 134.61it/s]  1%|█                                                                                                  | 84/7473 [00:00<00:54, 134.99it/s]  1%|█▎                                                                                                 | 98/7473 [00:00<00:55, 133.12it/s]  1%|█▍                                                                                                | 112/7473 [00:00<00:55, 133.76it/s]  2%|█▋                                                                                                | 126/7473 [00:00<00:54, 134.12it/s]  2%|█▊                                                                                                | 140/7473 [00:01<00:54, 134.49it/s]  2%|██                                                                                                | 154/7473 [00:01<00:54, 134.82it/s]  2%|██▏                                                                                               | 168/7473 [00:01<00:54, 134.62it/s]  2%|██▍                                                                                               | 182/7473 [00:01<00:54, 134.73it/s]  3%|██▌                                                                                               | 196/7473 [00:01<00:54, 134.63it/s]  3%|██▊                                                                                               | 210/7473 [00:01<00:53, 134.72it/s]  3%|██▉                                                                                               | 224/7473 [00:01<00:53, 134.47it/s]  3%|███                                                                                               | 238/7473 [00:01<00:54, 132.37it/s]  3%|███▎                                                                                              | 252/7473 [00:01<00:53, 134.47it/s]  4%|███▌                                                                                              | 273/7473 [00:01<00:46, 155.28it/s]  4%|███▊                                                                                              | 294/7473 [00:02<00:42, 170.27it/s]  4%|████▏                                                                                             | 315/7473 [00:02<00:39, 181.33it/s]  4%|████▍                                                                                             | 336/7473 [00:02<00:37, 188.66it/s]  5%|████▋                                                                                             | 357/7473 [00:02<00:36, 194.34it/s]  5%|████▉                                                                                             | 378/7473 [00:02<00:35, 197.98it/s]  5%|█████▏                                                                                            | 399/7473 [00:02<00:35, 200.75it/s]  6%|█████▌                                                                                            | 420/7473 [00:02<00:34, 202.61it/s]  6%|█████▊                                                                                            | 441/7473 [00:02<00:34, 203.81it/s]  6%|██████                                                                                            | 462/7473 [00:02<00:34, 204.91it/s]  6%|██████▎                                                                                           | 483/7473 [00:02<00:34, 203.58it/s]  7%|██████▌                                                                                           | 504/7473 [00:03<00:34, 204.50it/s]  7%|██████▉                                                                                           | 525/7473 [00:03<00:33, 205.44it/s]  7%|███████▏                                                                                          | 546/7473 [00:03<00:33, 206.06it/s]  8%|███████▍                                                                                          | 567/7473 [00:03<00:33, 206.53it/s]  8%|███████▋                                                                                          | 588/7473 [00:03<00:33, 206.54it/s]  8%|███████▉                                                                                          | 609/7473 [00:03<00:33, 206.53it/s]  8%|████████▎                                                                                         | 630/7473 [00:03<00:33, 206.29it/s]  9%|████████▌                                                                                         | 651/7473 [00:03<00:33, 206.02it/s]  9%|████████▊                                                                                         | 672/7473 [00:03<00:32, 206.88it/s]  9%|█████████                                                                                         | 693/7473 [00:04<00:32, 207.37it/s] 10%|█████████▎                                                                                        | 714/7473 [00:04<00:32, 206.19it/s] 10%|█████████▋                                                                                        | 735/7473 [00:04<00:32, 206.97it/s] 10%|█████████▉                                                                                        | 756/7473 [00:04<00:32, 206.40it/s] 10%|██████████▏                                                                                       | 777/7473 [00:04<00:32, 206.03it/s] 11%|██████████▍                                                                                       | 798/7473 [00:04<00:32, 206.02it/s] 11%|██████████▋                                                                                       | 819/7473 [00:04<00:32, 205.83it/s] 11%|███████████                                                                                       | 840/7473 [00:04<00:32, 205.99it/s] 12%|███████████▎                                                                                      | 861/7473 [00:04<00:32, 206.27it/s] 12%|███████████▌                                                                                      | 882/7473 [00:04<00:31, 206.52it/s] 12%|███████████▊                                                                                      | 903/7473 [00:05<00:31, 206.34it/s] 12%|████████████                                                                                      | 924/7473 [00:05<00:31, 206.12it/s] 13%|████████████▍                                                                                     | 945/7473 [00:05<00:31, 204.38it/s] 13%|████████████▋                                                                                     | 966/7473 [00:05<00:31, 204.98it/s] 13%|████████████▉                                                                                     | 987/7473 [00:05<00:31, 205.68it/s] 13%|█████████████                                                                                    | 1008/7473 [00:05<00:31, 205.58it/s] 14%|█████████████▎                                                                                   | 1029/7473 [00:05<00:31, 204.26it/s] 14%|█████████████▋                                                                                   | 1050/7473 [00:05<00:31, 204.40it/s] 14%|█████████████▉                                                                                   | 1071/7473 [00:05<00:31, 205.28it/s] 15%|██████████████▏                                                                                  | 1092/7473 [00:05<00:31, 204.91it/s] 15%|██████████████▍                                                                                  | 1113/7473 [00:06<00:31, 204.58it/s] 15%|██████████████▋                                                                                  | 1134/7473 [00:06<00:31, 204.40it/s] 15%|██████████████▉                                                                                  | 1155/7473 [00:06<00:30, 204.70it/s] 16%|███████████████▎                                                                                 | 1176/7473 [00:06<00:31, 202.60it/s] 16%|███████████████▌                                                                                 | 1197/7473 [00:06<00:30, 203.30it/s] 16%|███████████████▊                                                                                 | 1218/7473 [00:06<00:30, 204.20it/s] 17%|████████████████                                                                                 | 1239/7473 [00:06<00:30, 205.01it/s] 17%|████████████████▎                                                                                | 1260/7473 [00:06<00:30, 205.49it/s] 17%|████████████████▋                                                                                | 1281/7473 [00:06<00:30, 205.68it/s] 17%|████████████████▉                                                                                | 1302/7473 [00:06<00:30, 204.12it/s] 18%|█████████████████▏                                                                               | 1323/7473 [00:07<00:30, 204.95it/s] 18%|█████████████████▍                                                                               | 1344/7473 [00:07<00:29, 205.82it/s] 18%|█████████████████▋                                                                               | 1365/7473 [00:07<00:29, 206.31it/s] 19%|█████████████████▉                                                                               | 1386/7473 [00:07<00:29, 203.39it/s] 19%|██████████████████▎                                                                              | 1407/7473 [00:07<00:29, 204.19it/s] 19%|██████████████████▌                                                                              | 1428/7473 [00:07<00:29, 204.72it/s] 19%|██████████████████▊                                                                              | 1449/7473 [00:07<00:29, 205.48it/s] 20%|███████████████████                                                                              | 1470/7473 [00:07<00:29, 205.22it/s] 20%|███████████████████▎                                                                             | 1491/7473 [00:07<00:29, 205.84it/s] 20%|███████████████████▋                                                                             | 1512/7473 [00:08<00:28, 206.19it/s] 21%|███████████████████▉                                                                             | 1533/7473 [00:08<00:28, 206.47it/s] 21%|████████████████████▏                                                                            | 1554/7473 [00:08<00:28, 206.23it/s] 21%|████████████████████▍                                                                            | 1575/7473 [00:08<00:28, 205.66it/s] 21%|████████████████████▋                                                                            | 1596/7473 [00:08<00:28, 205.64it/s] 22%|████████████████████▉                                                                            | 1617/7473 [00:08<00:28, 203.82it/s] 22%|█████████████████████▎                                                                           | 1638/7473 [00:08<00:28, 204.80it/s] 22%|█████████████████████▌                                                                           | 1659/7473 [00:08<00:28, 204.97it/s] 22%|█████████████████████▊                                                                           | 1680/7473 [00:08<00:28, 206.09it/s] 23%|██████████████████████                                                                           | 1701/7473 [00:08<00:27, 206.49it/s] 23%|██████████████████████▎                                                                          | 1722/7473 [00:09<00:27, 206.80it/s] 23%|██████████████████████▌                                                                          | 1743/7473 [00:09<00:27, 206.89it/s] 24%|██████████████████████▉                                                                          | 1764/7473 [00:09<00:27, 207.19it/s] 24%|███████████████████████▏                                                                         | 1785/7473 [00:09<00:27, 207.06it/s] 24%|███████████████████████▍                                                                         | 1806/7473 [00:09<00:28, 198.88it/s] 24%|███████████████████████▋                                                                         | 1827/7473 [00:09<00:28, 200.92it/s] 25%|███████████████████████▉                                                                         | 1848/7473 [00:09<00:27, 200.90it/s] 25%|████████████████████████▎                                                                        | 1869/7473 [00:09<00:27, 202.54it/s] 25%|████████████████████████▌                                                                        | 1890/7473 [00:09<00:27, 203.19it/s] 26%|████████████████████████▊                                                                        | 1911/7473 [00:09<00:27, 204.04it/s] 26%|█████████████████████████                                                                        | 1932/7473 [00:10<00:27, 204.38it/s] 26%|█████████████████████████▎                                                                       | 1953/7473 [00:10<00:26, 204.52it/s] 26%|█████████████████████████▌                                                                       | 1974/7473 [00:10<00:26, 205.18it/s] 27%|█████████████████████████▉                                                                       | 1995/7473 [00:10<00:26, 205.53it/s] 27%|██████████████████████████▏                                                                      | 2016/7473 [00:10<00:26, 205.31it/s] 27%|██████████████████████████▍                                                                      | 2037/7473 [00:10<00:26, 205.30it/s] 28%|██████████████████████████▋                                                                      | 2058/7473 [00:10<00:26, 204.79it/s] 28%|██████████████████████████▉                                                                      | 2079/7473 [00:10<00:26, 202.85it/s] 28%|███████████████████████████▎                                                                     | 2100/7473 [00:10<00:26, 203.73it/s] 28%|███████████████████████████▌                                                                     | 2121/7473 [00:10<00:26, 203.53it/s] 29%|███████████████████████████▊                                                                     | 2142/7473 [00:11<00:26, 203.86it/s] 29%|████████████████████████████                                                                     | 2163/7473 [00:11<00:25, 204.58it/s] 29%|████████████████████████████▎                                                                    | 2184/7473 [00:11<00:25, 205.21it/s] 30%|████████████████████████████▌                                                                    | 2205/7473 [00:11<00:25, 206.08it/s] 30%|████████████████████████████▉                                                                    | 2226/7473 [00:11<00:25, 206.45it/s] 30%|█████████████████████████████▏                                                                   | 2247/7473 [00:11<00:25, 206.00it/s] 30%|█████████████████████████████▍                                                                   | 2268/7473 [00:11<00:25, 205.58it/s] 31%|█████████████████████████████▋                                                                   | 2289/7473 [00:11<00:25, 204.82it/s] 31%|█████████████████████████████▉                                                                   | 2310/7473 [00:11<00:25, 203.72it/s] 31%|██████████████████████████████▎                                                                  | 2331/7473 [00:12<00:25, 204.50it/s] 31%|██████████████████████████████▌                                                                  | 2352/7473 [00:12<00:25, 204.70it/s] 32%|██████████████████████████████▊                                                                  | 2373/7473 [00:12<00:24, 204.53it/s] 32%|███████████████████████████████                                                                  | 2394/7473 [00:12<00:24, 204.99it/s] 32%|███████████████████████████████▎                                                                 | 2415/7473 [00:12<00:24, 205.33it/s] 33%|███████████████████████████████▌                                                                 | 2436/7473 [00:12<00:24, 205.61it/s] 33%|███████████████████████████████▉                                                                 | 2457/7473 [00:12<00:24, 205.69it/s] 33%|████████████████████████████████▏                                                                | 2478/7473 [00:12<00:24, 205.78it/s] 33%|████████████████████████████████▍                                                                | 2499/7473 [00:12<00:24, 206.09it/s] 34%|████████████████████████████████▋                                                                | 2520/7473 [00:12<00:27, 180.72it/s] 34%|████████████████████████████████▉                                                                | 2541/7473 [00:13<00:26, 187.42it/s] 34%|█████████████████████████████████▎                                                               | 2562/7473 [00:13<00:25, 192.59it/s] 35%|█████████████████████████████████▌                                                               | 2583/7473 [00:13<00:24, 196.31it/s] 35%|█████████████████████████████████▊                                                               | 2604/7473 [00:13<00:24, 198.50it/s] 35%|██████████████████████████████████                                                               | 2625/7473 [00:13<00:24, 200.71it/s] 35%|██████████████████████████████████▎                                                              | 2646/7473 [00:13<00:23, 202.39it/s] 36%|██████████████████████████████████▌                                                              | 2667/7473 [00:13<00:23, 203.82it/s] 36%|██████████████████████████████████▉                                                              | 2688/7473 [00:13<00:23, 204.49it/s] 36%|███████████████████████████████████▏                                                             | 2709/7473 [00:13<00:23, 204.60it/s] 37%|███████████████████████████████████▍                                                             | 2730/7473 [00:13<00:23, 204.62it/s] 37%|███████████████████████████████████▋                                                             | 2751/7473 [00:14<00:23, 203.58it/s] 37%|███████████████████████████████████▉                                                             | 2772/7473 [00:14<00:22, 204.50it/s] 37%|████████████████████████████████████▎                                                            | 2793/7473 [00:14<00:22, 204.55it/s] 38%|████████████████████████████████████▌                                                            | 2814/7473 [00:14<00:22, 204.42it/s] 38%|████████████████████████████████████▊                                                            | 2835/7473 [00:14<00:22, 204.98it/s] 38%|█████████████████████████████████████                                                            | 2856/7473 [00:14<00:22, 204.82it/s] 38%|█████████████████████████████████████▎                                                           | 2877/7473 [00:14<00:22, 204.62it/s] 39%|█████████████████████████████████████▌                                                           | 2898/7473 [00:14<00:22, 205.51it/s] 39%|█████████████████████████████████████▉                                                           | 2919/7473 [00:14<00:22, 205.59it/s] 39%|██████████████████████████████████████▏                                                          | 2940/7473 [00:15<00:22, 206.02it/s] 40%|██████████████████████████████████████▍                                                          | 2961/7473 [00:15<00:21, 206.14it/s] 40%|██████████████████████████████████████▋                                                          | 2982/7473 [00:15<00:21, 204.57it/s] 40%|██████████████████████████████████████▉                                                          | 3003/7473 [00:15<00:21, 205.00it/s] 40%|███████████████████████████████████████▎                                                         | 3024/7473 [00:15<00:21, 205.36it/s] 41%|███████████████████████████████████████▌                                                         | 3045/7473 [00:15<00:21, 205.27it/s] 41%|███████████████████████████████████████▊                                                         | 3066/7473 [00:15<00:21, 205.63it/s] 41%|████████████████████████████████████████                                                         | 3087/7473 [00:15<00:21, 205.36it/s] 42%|████████████████████████████████████████▎                                                        | 3108/7473 [00:15<00:21, 205.15it/s] 42%|████████████████████████████████████████▌                                                        | 3129/7473 [00:15<00:21, 204.80it/s] 42%|████████████████████████████████████████▉                                                        | 3150/7473 [00:16<00:21, 204.19it/s] 42%|█████████████████████████████████████████▏                                                       | 3171/7473 [00:16<00:21, 204.51it/s] 43%|█████████████████████████████████████████▍                                                       | 3192/7473 [00:16<00:20, 204.67it/s] 43%|█████████████████████████████████████████▋                                                       | 3213/7473 [00:16<00:20, 203.48it/s] 43%|█████████████████████████████████████████▉                                                       | 3234/7473 [00:16<00:20, 204.09it/s] 44%|██████████████████████████████████████████▎                                                      | 3255/7473 [00:16<00:20, 204.78it/s] 44%|██████████████████████████████████████████▌                                                      | 3276/7473 [00:16<00:20, 205.02it/s] 44%|██████████████████████████████████████████▊                                                      | 3297/7473 [00:16<00:20, 204.06it/s] 44%|███████████████████████████████████████████                                                      | 3318/7473 [00:16<00:20, 204.73it/s] 45%|███████████████████████████████████████████▎                                                     | 3339/7473 [00:16<00:20, 204.07it/s] 45%|███████████████████████████████████████████▌                                                     | 3360/7473 [00:17<00:20, 204.55it/s] 45%|███████████████████████████████████████████▉                                                     | 3381/7473 [00:17<00:20, 204.51it/s] 46%|████████████████████████████████████████████▏                                                    | 3402/7473 [00:17<00:19, 204.82it/s] 46%|████████████████████████████████████████████▍                                                    | 3423/7473 [00:17<00:19, 204.89it/s] 46%|████████████████████████████████████████████▋                                                    | 3444/7473 [00:17<00:19, 203.72it/s] 46%|████████████████████████████████████████████▉                                                    | 3465/7473 [00:17<00:19, 204.01it/s] 47%|█████████████████████████████████████████████▏                                                   | 3486/7473 [00:17<00:19, 204.61it/s] 47%|█████████████████████████████████████████████▌                                                   | 3507/7473 [00:17<00:19, 204.81it/s] 47%|█████████████████████████████████████████████▊                                                   | 3528/7473 [00:17<00:19, 204.67it/s] 47%|██████████████████████████████████████████████                                                   | 3549/7473 [00:17<00:19, 205.18it/s] 48%|██████████████████████████████████████████████▎                                                  | 3570/7473 [00:18<00:18, 205.74it/s] 48%|██████████████████████████████████████████████▌                                                  | 3591/7473 [00:18<00:18, 205.67it/s] 48%|██████████████████████████████████████████████▉                                                  | 3612/7473 [00:18<00:18, 205.83it/s] 49%|███████████████████████████████████████████████▏                                                 | 3633/7473 [00:18<00:18, 204.33it/s] 49%|███████████████████████████████████████████████▍                                                 | 3654/7473 [00:18<00:18, 202.41it/s] 49%|███████████████████████████████████████████████▋                                                 | 3675/7473 [00:18<00:18, 202.79it/s] 49%|███████████████████████████████████████████████▉                                                 | 3696/7473 [00:18<00:18, 203.21it/s] 50%|████████████████████████████████████████████████▏                                                | 3717/7473 [00:18<00:18, 203.64it/s] 50%|████████████████████████████████████████████████▌                                                | 3738/7473 [00:18<00:18, 204.38it/s] 50%|████████████████████████████████████████████████▊                                                | 3759/7473 [00:19<00:18, 204.68it/s] 51%|█████████████████████████████████████████████████                                                | 3780/7473 [00:19<00:18, 205.16it/s] 51%|█████████████████████████████████████████████████▎                                               | 3801/7473 [00:19<00:17, 205.74it/s] 51%|█████████████████████████████████████████████████▌                                               | 3822/7473 [00:19<00:17, 205.66it/s] 51%|█████████████████████████████████████████████████▉                                               | 3843/7473 [00:19<00:17, 205.40it/s] 52%|██████████████████████████████████████████████████▏                                              | 3864/7473 [00:19<00:17, 204.60it/s] 52%|██████████████████████████████████████████████████▍                                              | 3885/7473 [00:19<00:17, 203.06it/s] 52%|██████████████████████████████████████████████████▋                                              | 3906/7473 [00:19<00:17, 203.83it/s] 53%|██████████████████████████████████████████████████▉                                              | 3927/7473 [00:19<00:17, 204.51it/s] 53%|███████████████████████████████████████████████████▏                                             | 3948/7473 [00:19<00:17, 204.38it/s] 53%|███████████████████████████████████████████████████▌                                             | 3969/7473 [00:20<00:17, 204.58it/s] 53%|███████████████████████████████████████████████████▊                                             | 3990/7473 [00:20<00:17, 203.31it/s] 54%|████████████████████████████████████████████████████                                             | 4011/7473 [00:20<00:16, 204.24it/s] 54%|████████████████████████████████████████████████████▎                                            | 4032/7473 [00:20<00:16, 204.68it/s] 54%|████████████████████████████████████████████████████▌                                            | 4053/7473 [00:20<00:16, 205.05it/s] 55%|████████████████████████████████████████████████████▉                                            | 4074/7473 [00:20<00:16, 204.96it/s] 55%|█████████████████████████████████████████████████████▏                                           | 4095/7473 [00:20<00:16, 205.21it/s] 55%|█████████████████████████████████████████████████████▍                                           | 4116/7473 [00:20<00:16, 202.79it/s] 55%|█████████████████████████████████████████████████████▋                                           | 4137/7473 [00:20<00:16, 203.06it/s] 56%|█████████████████████████████████████████████████████▉                                           | 4158/7473 [00:20<00:16, 203.59it/s] 56%|██████████████████████████████████████████████████████▏                                          | 4179/7473 [00:21<00:16, 204.15it/s] 56%|██████████████████████████████████████████████████████▌                                          | 4200/7473 [00:21<00:15, 204.92it/s] 56%|██████████████████████████████████████████████████████▊                                          | 4221/7473 [00:21<00:15, 204.88it/s] 57%|███████████████████████████████████████████████████████                                          | 4242/7473 [00:21<00:15, 205.02it/s] 57%|███████████████████████████████████████████████████████▎                                         | 4263/7473 [00:21<00:15, 204.91it/s] 57%|███████████████████████████████████████████████████████▌                                         | 4284/7473 [00:21<00:15, 204.73it/s] 58%|███████████████████████████████████████████████████████▉                                         | 4305/7473 [00:21<00:15, 205.03it/s] 58%|████████████████████████████████████████████████████████▏                                        | 4326/7473 [00:21<00:15, 203.95it/s] 58%|████████████████████████████████████████████████████████▍                                        | 4347/7473 [00:21<00:15, 202.60it/s] 58%|████████████████████████████████████████████████████████▋                                        | 4368/7473 [00:22<00:15, 203.15it/s] 59%|████████████████████████████████████████████████████████▉                                        | 4389/7473 [00:22<00:15, 203.70it/s] 59%|█████████████████████████████████████████████████████████▏                                       | 4410/7473 [00:22<00:15, 204.17it/s] 59%|█████████████████████████████████████████████████████████▌                                       | 4431/7473 [00:22<00:14, 204.31it/s] 60%|█████████████████████████████████████████████████████████▊                                       | 4452/7473 [00:22<00:14, 204.19it/s] 60%|██████████████████████████████████████████████████████████                                       | 4473/7473 [00:22<00:14, 204.72it/s] 60%|██████████████████████████████████████████████████████████▎                                      | 4494/7473 [00:22<00:14, 205.09it/s] 60%|██████████████████████████████████████████████████████████▌                                      | 4515/7473 [00:22<00:14, 204.60it/s] 61%|██████████████████████████████████████████████████████████▉                                      | 4536/7473 [00:22<00:14, 204.97it/s] 61%|███████████████████████████████████████████████████████████▏                                     | 4557/7473 [00:22<00:14, 205.41it/s] 61%|███████████████████████████████████████████████████████████▍                                     | 4578/7473 [00:23<00:14, 203.98it/s] 62%|███████████████████████████████████████████████████████████▋                                     | 4599/7473 [00:23<00:14, 204.21it/s] 62%|███████████████████████████████████████████████████████████▉                                     | 4620/7473 [00:23<00:13, 204.65it/s] 62%|████████████████████████████████████████████████████████████▏                                    | 4641/7473 [00:23<00:13, 204.48it/s] 62%|████████████████████████████████████████████████████████████▌                                    | 4662/7473 [00:23<00:13, 204.64it/s] 63%|████████████████████████████████████████████████████████████▊                                    | 4683/7473 [00:23<00:13, 202.90it/s] 63%|█████████████████████████████████████████████████████████████                                    | 4704/7473 [00:23<00:13, 203.45it/s] 63%|█████████████████████████████████████████████████████████████▎                                   | 4725/7473 [00:23<00:13, 204.23it/s] 64%|█████████████████████████████████████████████████████████████▌                                   | 4746/7473 [00:23<00:13, 204.50it/s] 64%|█████████████████████████████████████████████████████████████▉                                   | 4767/7473 [00:23<00:13, 204.47it/s] 64%|██████████████████████████████████████████████████████████████▏                                  | 4788/7473 [00:24<00:13, 204.41it/s] 64%|██████████████████████████████████████████████████████████████▍                                  | 4809/7473 [00:24<00:13, 202.67it/s] 65%|██████████████████████████████████████████████████████████████▋                                  | 4830/7473 [00:24<00:12, 203.51it/s] 65%|██████████████████████████████████████████████████████████████▉                                  | 4851/7473 [00:24<00:12, 204.18it/s] 65%|███████████████████████████████████████████████████████████████▏                                 | 4872/7473 [00:24<00:12, 204.09it/s] 65%|███████████████████████████████████████████████████████████████▌                                 | 4893/7473 [00:24<00:12, 204.79it/s] 66%|███████████████████████████████████████████████████████████████▊                                 | 4914/7473 [00:24<00:12, 205.19it/s] 66%|████████████████████████████████████████████████████████████████                                 | 4935/7473 [00:24<00:12, 204.83it/s] 66%|████████████████████████████████████████████████████████████████▎                                | 4956/7473 [00:24<00:12, 204.74it/s] 67%|████████████████████████████████████████████████████████████████▌                                | 4977/7473 [00:24<00:12, 204.57it/s] 67%|████████████████████████████████████████████████████████████████▊                                | 4998/7473 [00:25<00:12, 204.77it/s] 67%|█████████████████████████████████████████████████████████████████▏                               | 5019/7473 [00:25<00:12, 202.12it/s] 67%|█████████████████████████████████████████████████████████████████▍                               | 5040/7473 [00:25<00:11, 203.02it/s] 68%|█████████████████████████████████████████████████████████████████▋                               | 5061/7473 [00:25<00:11, 203.57it/s] 68%|█████████████████████████████████████████████████████████████████▉                               | 5082/7473 [00:25<00:11, 203.89it/s] 68%|██████████████████████████████████████████████████████████████████▏                              | 5103/7473 [00:25<00:11, 204.01it/s] 69%|██████████████████████████████████████████████████████████████████▌                              | 5124/7473 [00:25<00:11, 204.19it/s] 69%|██████████████████████████████████████████████████████████████████▊                              | 5145/7473 [00:25<00:11, 204.20it/s] 69%|███████████████████████████████████████████████████████████████████                              | 5166/7473 [00:25<00:11, 204.14it/s] 69%|███████████████████████████████████████████████████████████████████▎                             | 5187/7473 [00:26<00:11, 204.61it/s] 70%|███████████████████████████████████████████████████████████████████▌                             | 5208/7473 [00:26<00:11, 204.59it/s] 70%|███████████████████████████████████████████████████████████████████▊                             | 5229/7473 [00:26<00:10, 205.02it/s] 70%|████████████████████████████████████████████████████████████████████▏                            | 5250/7473 [00:26<00:12, 176.15it/s] 71%|████████████████████████████████████████████████████████████████████▍                            | 5271/7473 [00:26<00:11, 183.59it/s] 71%|████████████████████████████████████████████████████████████████████▋                            | 5292/7473 [00:26<00:11, 189.67it/s] 71%|████████████████████████████████████████████████████████████████████▉                            | 5313/7473 [00:26<00:11, 194.14it/s] 71%|█████████████████████████████████████████████████████████████████████▏                           | 5334/7473 [00:26<00:10, 196.77it/s] 72%|█████████████████████████████████████████████████████████████████████▍                           | 5354/7473 [00:26<00:10, 196.36it/s] 72%|█████████████████████████████████████████████████████████████████████▊                           | 5375/7473 [00:26<00:10, 197.88it/s] 72%|██████████████████████████████████████████████████████████████████████                           | 5396/7473 [00:27<00:10, 199.04it/s] 72%|██████████████████████████████████████████████████████████████████████▎                          | 5417/7473 [00:27<00:10, 200.00it/s] 73%|██████████████████████████████████████████████████████████████████████▌                          | 5438/7473 [00:27<00:10, 200.98it/s] 73%|██████████████████████████████████████████████████████████████████████▊                          | 5459/7473 [00:27<00:10, 201.10it/s] 73%|███████████████████████████████████████████████████████████████████████▏                         | 5480/7473 [00:27<00:15, 125.85it/s] 74%|███████████████████████████████████████████████████████████████████████▍                         | 5501/7473 [00:27<00:13, 141.84it/s] 74%|███████████████████████████████████████████████████████████████████████▋                         | 5522/7473 [00:27<00:12, 156.13it/s] 74%|███████████████████████████████████████████████████████████████████████▉                         | 5543/7473 [00:28<00:11, 168.03it/s] 74%|████████████████████████████████████████████████████████████████████████▏                        | 5564/7473 [00:28<00:10, 178.04it/s] 75%|████████████████████████████████████████████████████████████████████████▍                        | 5585/7473 [00:28<00:10, 184.73it/s] 75%|████████████████████████████████████████████████████████████████████████▊                        | 5606/7473 [00:28<00:09, 190.35it/s] 75%|█████████████████████████████████████████████████████████████████████████                        | 5627/7473 [00:28<00:09, 194.27it/s] 76%|█████████████████████████████████████████████████████████████████████████▎                       | 5648/7473 [00:28<00:09, 197.09it/s] 76%|█████████████████████████████████████████████████████████████████████████▌                       | 5669/7473 [00:28<00:09, 198.90it/s] 76%|█████████████████████████████████████████████████████████████████████████▊                       | 5690/7473 [00:28<00:08, 198.34it/s] 76%|██████████████████████████████████████████████████████████████████████████▏                      | 5711/7473 [00:28<00:08, 199.77it/s] 77%|██████████████████████████████████████████████████████████████████████████▍                      | 5732/7473 [00:28<00:08, 201.30it/s] 77%|██████████████████████████████████████████████████████████████████████████▋                      | 5753/7473 [00:29<00:08, 202.52it/s] 77%|██████████████████████████████████████████████████████████████████████████▉                      | 5774/7473 [00:29<00:08, 203.13it/s] 78%|███████████████████████████████████████████████████████████████████████████▏                     | 5795/7473 [00:29<00:08, 203.36it/s] 78%|███████████████████████████████████████████████████████████████████████████▍                     | 5816/7473 [00:29<00:08, 203.31it/s] 78%|███████████████████████████████████████████████████████████████████████████▊                     | 5837/7473 [00:29<00:08, 203.34it/s] 78%|████████████████████████████████████████████████████████████████████████████                     | 5858/7473 [00:29<00:07, 203.70it/s] 79%|████████████████████████████████████████████████████████████████████████████▎                    | 5879/7473 [00:29<00:07, 204.07it/s] 79%|████████████████████████████████████████████████████████████████████████████▌                    | 5900/7473 [00:29<00:07, 203.75it/s] 79%|████████████████████████████████████████████████████████████████████████████▊                    | 5921/7473 [00:29<00:07, 201.93it/s] 80%|█████████████████████████████████████████████████████████████████████████████▏                   | 5942/7473 [00:29<00:07, 201.95it/s] 80%|█████████████████████████████████████████████████████████████████████████████▍                   | 5963/7473 [00:30<00:07, 202.04it/s] 80%|█████████████████████████████████████████████████████████████████████████████▋                   | 5984/7473 [00:30<00:07, 202.67it/s] 80%|█████████████████████████████████████████████████████████████████████████████▉                   | 6005/7473 [00:30<00:07, 203.08it/s] 81%|██████████████████████████████████████████████████████████████████████████████▏                  | 6026/7473 [00:30<00:07, 203.16it/s] 81%|██████████████████████████████████████████████████████████████████████████████▍                  | 6047/7473 [00:30<00:07, 203.39it/s] 81%|██████████████████████████████████████████████████████████████████████████████▊                  | 6068/7473 [00:30<00:06, 203.02it/s] 81%|███████████████████████████████████████████████████████████████████████████████                  | 6089/7473 [00:30<00:06, 203.02it/s] 82%|███████████████████████████████████████████████████████████████████████████████▎                 | 6110/7473 [00:30<00:06, 202.63it/s] 82%|███████████████████████████████████████████████████████████████████████████████▌                 | 6131/7473 [00:30<00:06, 200.86it/s] 82%|███████████████████████████████████████████████████████████████████████████████▊                 | 6152/7473 [00:31<00:06, 201.34it/s] 83%|████████████████████████████████████████████████████████████████████████████████▏                | 6173/7473 [00:31<00:06, 201.27it/s] 83%|████████████████████████████████████████████████████████████████████████████████▍                | 6194/7473 [00:31<00:06, 201.62it/s] 83%|████████████████████████████████████████████████████████████████████████████████▋                | 6215/7473 [00:31<00:06, 201.66it/s] 83%|████████████████████████████████████████████████████████████████████████████████▉                | 6236/7473 [00:31<00:06, 201.71it/s] 84%|█████████████████████████████████████████████████████████████████████████████████▏               | 6257/7473 [00:31<00:06, 201.83it/s] 84%|█████████████████████████████████████████████████████████████████████████████████▍               | 6278/7473 [00:31<00:05, 202.24it/s] 84%|█████████████████████████████████████████████████████████████████████████████████▊               | 6299/7473 [00:31<00:05, 202.08it/s] 85%|██████████████████████████████████████████████████████████████████████████████████               | 6320/7473 [00:31<00:05, 202.04it/s] 85%|██████████████████████████████████████████████████████████████████████████████████▎              | 6341/7473 [00:31<00:05, 201.63it/s] 85%|██████████████████████████████████████████████████████████████████████████████████▌              | 6362/7473 [00:32<00:05, 200.06it/s] 85%|██████████████████████████████████████████████████████████████████████████████████▊              | 6383/7473 [00:32<00:05, 200.04it/s] 86%|███████████████████████████████████████████████████████████████████████████████████              | 6404/7473 [00:32<00:05, 200.56it/s] 86%|███████████████████████████████████████████████████████████████████████████████████▍             | 6425/7473 [00:32<00:05, 200.84it/s] 86%|███████████████████████████████████████████████████████████████████████████████████▋             | 6446/7473 [00:32<00:05, 200.99it/s] 87%|███████████████████████████████████████████████████████████████████████████████████▉             | 6467/7473 [00:32<00:04, 201.27it/s] 87%|████████████████████████████████████████████████████████████████████████████████████▏            | 6488/7473 [00:32<00:04, 201.36it/s] 87%|████████████████████████████████████████████████████████████████████████████████████▍            | 6509/7473 [00:32<00:04, 201.82it/s] 87%|████████████████████████████████████████████████████████████████████████████████████▊            | 6530/7473 [00:32<00:04, 202.30it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████            | 6551/7473 [00:33<00:04, 202.87it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████▎           | 6572/7473 [00:33<00:04, 202.77it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████▌           | 6593/7473 [00:33<00:04, 201.87it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████▊           | 6614/7473 [00:33<00:04, 202.55it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████           | 6635/7473 [00:33<00:04, 202.54it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████▍          | 6656/7473 [00:33<00:04, 202.75it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████▋          | 6677/7473 [00:33<00:03, 202.75it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████▉          | 6698/7473 [00:33<00:03, 203.38it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████▏         | 6719/7473 [00:33<00:03, 203.12it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████▍         | 6740/7473 [00:33<00:03, 203.57it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████▊         | 6761/7473 [00:34<00:03, 202.67it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████         | 6782/7473 [00:34<00:03, 202.72it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████▎        | 6803/7473 [00:34<00:03, 202.83it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████▌        | 6824/7473 [00:34<00:03, 201.35it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████▊        | 6845/7473 [00:34<00:03, 202.29it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████        | 6866/7473 [00:34<00:02, 202.41it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████▍       | 6887/7473 [00:34<00:02, 203.19it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████▋       | 6908/7473 [00:34<00:02, 203.21it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████▉       | 6929/7473 [00:34<00:02, 203.26it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████▏      | 6950/7473 [00:34<00:02, 203.28it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████▍      | 6971/7473 [00:35<00:02, 203.11it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████▊      | 6992/7473 [00:35<00:02, 203.10it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████      | 7013/7473 [00:35<00:02, 203.36it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████▎     | 7034/7473 [00:35<00:02, 203.26it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████▌     | 7055/7473 [00:35<00:02, 201.19it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████▊     | 7076/7473 [00:35<00:01, 202.13it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████     | 7097/7473 [00:35<00:01, 202.45it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████▍    | 7118/7473 [00:35<00:01, 202.37it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████▋    | 7139/7473 [00:35<00:01, 202.41it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████▉    | 7160/7473 [00:36<00:01, 202.27it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████▏   | 7181/7473 [00:36<00:01, 202.10it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████▍   | 7202/7473 [00:36<00:01, 202.62it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████▊   | 7223/7473 [00:36<00:01, 202.83it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████   | 7244/7473 [00:36<00:01, 203.07it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████▎  | 7265/7473 [00:36<00:01, 201.72it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████▌  | 7286/7473 [00:36<00:00, 202.41it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████▊  | 7307/7473 [00:36<00:00, 202.69it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████  | 7328/7473 [00:36<00:00, 203.03it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████▍ | 7349/7473 [00:36<00:00, 202.83it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████▋ | 7370/7473 [00:37<00:00, 202.64it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████▉ | 7391/7473 [00:37<00:00, 202.81it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████▏| 7412/7473 [00:37<00:00, 202.90it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████▍| 7433/7473 [00:37<00:00, 203.18it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████▊| 7454/7473 [00:37<00:00, 203.00it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 7473/7473 [00:37<00:00, 198.97it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:04<00:09,  4.94s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.17s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.23s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:06<00:13,  6.83s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:09<00:04,  4.86s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.29s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.26s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.26s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.43s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.68s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.83s/it]
Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:12<00:06,  6.37s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.65s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.81s/it]
[2023-08-18 09:07:43,844] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:17<00:00,  5.54s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:17<00:00,  5.81s/it]
[2023-08-18 09:07:59,169] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-18 09:07:59,170] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-18 09:07:59,171] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-18 09:07:59,171] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-18 09:07:59,171] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-18 09:07:59,171] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-18 09:07:59,171] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-18 09:07:59,171] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-18 09:07:59,171] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-18 09:07:59,171] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-18 09:07:59,171] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-18 09:07:59,171] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7efdca83a370>
[2023-08-18 09:07:59,171] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-18 09:07:59,171] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-18 09:07:59,171] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-18 09:07:59,171] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-18 09:07:59,171] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-18 09:07:59,172] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-18 09:07:59,172] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-18 09:07:59,172] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-18 09:07:59,172] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-18 09:07:59,172] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-18 09:07:59,172] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-18 09:07:59,172] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-18 09:07:59,172] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-18 09:07:59,172] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-18 09:07:59,172] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-18 09:07:59,172] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-18 09:07:59,172] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-18 09:07:59,172] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-18 09:07:59,172] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-18 09:07:59,172] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-18 09:07:59,172] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-18 09:07:59,172] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-18 09:07:59,172] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-18 09:07:59,172] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-18 09:07:59,172] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-18 09:07:59,172] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-18 09:07:59,172] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-18 09:07:59,172] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-18 09:07:59,172] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-18 09:07:59,172] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-18 09:07:59,172] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-18 09:07:59,172] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-18 09:07:59,172] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7efdca83a250>
[2023-08-18 09:07:59,172] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-18 09:07:59,172] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-18 09:07:59,172] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-18 09:07:59,172] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-18 09:07:59,172] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-18 09:07:59,172] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-18 09:07:59,172] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-18 09:07:59,172] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-18 09:07:59,173] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-18 09:07:59,173] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-18 09:07:59,173] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-18 09:07:59,173] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-18 09:07:59,173] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-18 09:07:59,173] [INFO] [config.py:1012:print]   train_batch_size ............. 8
[2023-08-18 09:07:59,173] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  2
[2023-08-18 09:07:59,173] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-18 09:07:59,173] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-18 09:07:59,173] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-18 09:07:59,173] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-18 09:07:59,173] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-18 09:07:59,173] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-18 09:07:59,173] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-18 09:07:59,173] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.6512124538421631 seconds
Loading extension module utils...
Time to load utils op: 0.6048922538757324 seconds
Loading extension module utils...
Time to load utils op: 0.7051382064819336 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Loading extension module utils...
Time to load utils op: 0.6045997142791748 seconds
Evaluating gsm8k :   0%|                                                                                           | 0/125 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following grade math question.

Input: Fabric is cut to order at what type of seller? Choices:  A: curtains B: tailor shop C: clothing store D: sewing room E: hardware store
Output: 1. The question wants to know in what place fabric is normally cut in order to meet the specifics of a customer's order.
2. Options A: curtains and E: hardware store, are not suitable because they are not places.
3. Between the remaining options B: tailor shop, C: clothing store, and D: sewing room, it is important to identify where the customization of fabric typically happens.
4. A sewing room, D, could be a place where fabric is cut for personal use, but it is not necessarily a seller or a place where commercial transactions happen. 
5. A clothing store, C, typically sells ready-made clothes and does not usually offer services where fabric is cut to order. 
6. Therefore, the answer is B: tailor shop, as these are places where fabric is directly cut to order as per the customer's requests. Tailors typically make custom clothing, and as such, they cut fabrics as per the specific orders given by customers.
So the final answer is B: tailor shop

Input: Where are you if your reading magazines while waiting for a vehicle on rails? Choices:  A: vegetables B: market C: doctor D: train station E: bookstore
Output: 1. The question is asking for a location where we might wait for a vehicle on rails. 
2. Our options are vegetables, market, doctor, train station, and bookstore. 
3. If we consider the phrase "vehicle on rails", we can guess that this refers to a train.
4. So, we're likely in a place where trains are found.
5. Vegetables don't make sense as they aren't a location. 
6. A market usually entails shops or stalls where goods are sold, not typically a place for trains.
7. A doctor refers to a medical professional and not a place where trains are found.
8. A bookstore is a place where books are sold and not typically a place for waiting for a train.
9. A train station is a place where trains stop to pick up or let off passengers, so it's a logical place for waiting for a train.
10. Therefore, the answer is D: train station.
So the final answer is D: train station

Input: What would need oil to be used? Choices:  A: ground B: human  body C: repair shop D: combustion engines E: service station
Output: 1. This question requires a basic understanding of what kind of processes require oil.
2. The ground typically does not require oil for any known natural or man-made process.
3. While the human body does require certain kinds of "oils" (fats and lipids) for metabolic processes, they aren't the same as the oil in question.
4. A repair shop might use oil occasionally for certain repair processes, but it is not a strict requirement for repair shops to function.
5. A service station might also handle oil as part of its services (changing motor oil, for example), however, it doesn't need oil itself.
6. Combustion engines, however, require oil both for lubrication (to reduce friction between its moving parts) and as fuel in some cases.
7. Thus, the answer that makes the most sense is D: combustion engines.
So the final answer is D: combustion engines

Input: What is person probably feeling that plans on stopping being married to their spouse? Choices:  A: detachment B: bankruptcy C: sad D: fights E: wrong
Output: 1. The question is asking about an emotion or feeling a person might have if they are planning to end their marriage.
2. We are looking for a response that fits the context of emotional responses or states in relation to this action or decision.
3. "Bankruptcy" is a financial state, not an emotion or feeling, so we can eliminate that.
4. "Fights" is not an emotion or feeling, but rather refers to a situation or action. So this does not fit our requirement.
5. "Wrong" is an adjective that refers to a moral state rather than a feeling or emotion. It doesn't directly refer to someone's emotions. Therefore, we can eliminate this option.
6. "Sad" is an emotion, however, it doesn't specifically relate to the context of the person planning on ending their marriage because sadness can be linked with many circumstances, not just ending a marriage.
7. This leaves us with "detachment". "Detachment" refers to a state where someone feels emotionally distant or separated from something or someone. This would fit well with someone who is planning to stop being married as they are likely emotionally distancing themselves from their partner. 
8. In conclusion, the answer is A: detachment.
So the final answer is A: detachment

Input: What could you use to store a clock? Choices:  A: shelf B: own bedroom C: desk D: wall E: car
Output: Step 1: Consider each choice individually to determine how suitable each option is.
Step 2: Consider option A: a shelf. A shelf is a flat horizontal plane used for displaying or storing items and is often found in a house or building. A clock can be placed on a shelf.
Step 3: Consider option B: own bedroom. A bedroom is a room used primarily for sleeping. Although a clock could be put in a bedroom, the bedroom itself is not a place to store a clock. 
Step 4: Consider option C: a desk. A desk is a piece of furniture with a flat or sloped surface and typically with drawers, at which one can read, write, or do other work. Although a clock could be put on a desk, for the purpose of the question, it is not as specific as option A: shelf.
Step 5: Consider option D: a wall. Although a wall clock can be hung on a wall, this choice is less specific than shelf since not all kinds of clocks can be put on walls, for example desk clocks.
Step 6: Consider option E: a car. There is often a digital clock in a car's console, but a car is primarily a vehicle and not a place to store a clock.
Step 7: In light of these considerations, option A: shelf is the most appropriate place to store a clock.
So the final answer is A: shelf

Input: The person put on lotion, what did they want? Choices:  A: fresh smell B: good credit C: smooth skin D: fresh produce E: headache
Output: 1. The question tells us that a person is putting on lotion. 
2. From the choices given, we know that putting on lotion can't help with getting a fresh smell, so we eliminate answer A.
3. Answer B, good credit, is clearly not related to putting on lotion, so we eliminate that as well.
4. Answer D, fresh produce, is also unrelated to putting on lotion and therefore we remove this option.
5. Answer E, headache, makes no sense in this context, so we will eliminate this too.
6. We are left with answer C, smooth skin, which is a common reason someone would put on lotion.
7. Therefore, the answer is C: smooth skin.
So the final answer is C: smooth skin

Input: They burned the record, they were trying to do what to history? Choices:  A: compact disc B: tape C: rewrite D: play music E: erase
Output: 1. The question is asking about an action being done to a "record" and the possible implications this specific action might have on history.
2. The action specified in the question is "burned". Burning a record destroys it.
3. When a record is destroyed, whatever information it held is lost.
4. Thus, by burning the record, someone is effectively erasing the information or the history it contained.
5. Therefore, out of the provided choices, which are A: compact disc, B: tape, C: rewrite, D: play music, E: erase, they were trying to do E: erase to the history.
So the final answer is E: erase

Input:Natalia sold clips to 48 of her friends in April, and then she sold half as many clips in May. How many clips did Natalia sell altogether in April and May?
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o7-tcommonsenseqa-s10-rTrue
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Evaluating gsm8k :   0%|                                                                                           | 0/125 [00:03<?, ?it/s]
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 1875779) of binary: /home/ylu130/.conda/envs/distllm/bin/python
Traceback (most recent call last):
  File "/home/ylu130/.conda/envs/distllm/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 345, in wrapper
    return f(*args, **kwargs)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 761, in main
    run(args)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 752, in run
    elastic_launch(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 131, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 245, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
/home/ylu130/workspace/in-context-generalization/inference.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2023-08-18_09:08:07
  host      : ia1.wse.jhu.edu
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 1875780)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2023-08-18_09:08:07
  host      : ia1.wse.jhu.edu
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 1875781)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2023-08-18_09:08:07
  host      : ia1.wse.jhu.edu
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 1875782)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2023-08-18_09:08:07
  host      : ia1.wse.jhu.edu
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 1875779)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name gsm8k --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name commonsenseqa --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 2 --data-dir /scratch/ylu130/processed_data/gsm8k/out-domain/o8-tcommonsenseqa-s10-rTrue --seed 10 --max-prompt-length 2048 --rationales --num-out-domain 8
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-18 09:08:10,846] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... gsm8k
  data_dir ..................... /scratch/ylu130/processed_data/gsm8k/out-domain/o8-tcommonsenseqa-s10-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 8
  out_domain_data_name ......... commonsenseqa
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o8-tcommonsenseqa-s10-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 2
  clip_grad .................... 1.0
  seed ......................... 10
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                                             | 0/7473 [00:00<?, ?it/s]  0%|                                                                                                     | 9/7473 [00:00<01:24, 88.28it/s]  0%|▏                                                                                                   | 18/7473 [00:00<01:24, 88.72it/s]  0%|▎                                                                                                   | 27/7473 [00:00<01:24, 88.62it/s]  0%|▍                                                                                                   | 36/7473 [00:00<01:23, 88.69it/s]  1%|▌                                                                                                   | 45/7473 [00:00<01:23, 88.75it/s]  1%|▋                                                                                                   | 54/7473 [00:00<01:23, 88.91it/s]  1%|▊                                                                                                   | 63/7473 [00:00<01:24, 87.38it/s]  1%|▉                                                                                                   | 72/7473 [00:00<01:24, 87.82it/s]  1%|█                                                                                                   | 81/7473 [00:00<01:23, 88.21it/s]  1%|█▏                                                                                                  | 90/7473 [00:01<01:23, 88.48it/s]  1%|█▎                                                                                                  | 99/7473 [00:01<01:23, 88.57it/s]  1%|█▍                                                                                                 | 108/7473 [00:01<01:23, 88.63it/s]  2%|█▌                                                                                                 | 117/7473 [00:01<01:22, 88.80it/s]  2%|█▋                                                                                                 | 126/7473 [00:01<01:22, 88.82it/s]  2%|█▊                                                                                                 | 135/7473 [00:01<01:22, 88.86it/s]  2%|█▉                                                                                                 | 144/7473 [00:01<01:22, 88.93it/s]  2%|██                                                                                                 | 153/7473 [00:01<01:23, 88.14it/s]  2%|██▏                                                                                                | 162/7473 [00:01<01:22, 88.32it/s]  2%|██▎                                                                                                | 171/7473 [00:01<01:22, 88.45it/s]  2%|██▍                                                                                                | 180/7473 [00:02<01:22, 88.61it/s]  3%|██▌                                                                                                | 189/7473 [00:02<01:22, 88.69it/s]  3%|██▌                                                                                                | 198/7473 [00:02<01:21, 88.93it/s]  3%|██▋                                                                                                | 207/7473 [00:02<01:21, 89.02it/s]  3%|██▉                                                                                                | 220/7473 [00:02<01:12, 99.46it/s]  3%|███                                                                                               | 234/7473 [00:02<01:05, 110.42it/s]  3%|███▎                                                                                              | 248/7473 [00:02<01:01, 117.97it/s]  3%|███▍                                                                                              | 261/7473 [00:02<00:59, 120.99it/s]  4%|███▌                                                                                              | 275/7473 [00:02<00:57, 125.60it/s]  4%|███▊                                                                                              | 289/7473 [00:02<00:55, 128.84it/s]  4%|███▉                                                                                              | 303/7473 [00:03<00:54, 131.13it/s]  4%|████▏                                                                                             | 317/7473 [00:03<00:53, 132.77it/s]  4%|████▎                                                                                             | 331/7473 [00:03<00:53, 133.95it/s]  5%|████▌                                                                                             | 345/7473 [00:03<00:53, 134.40it/s]  5%|████▋                                                                                             | 359/7473 [00:03<00:52, 134.83it/s]  5%|████▉                                                                                             | 373/7473 [00:03<00:52, 135.12it/s]  5%|█████                                                                                             | 387/7473 [00:03<00:52, 135.55it/s]  5%|█████▎                                                                                            | 401/7473 [00:03<00:52, 135.53it/s]  6%|█████▍                                                                                            | 415/7473 [00:03<00:51, 135.80it/s]  6%|█████▋                                                                                            | 429/7473 [00:03<00:51, 135.83it/s]  6%|█████▊                                                                                            | 443/7473 [00:04<00:51, 135.78it/s]  6%|█████▉                                                                                            | 457/7473 [00:04<00:51, 136.08it/s]  6%|██████▏                                                                                           | 471/7473 [00:04<00:51, 135.97it/s]  6%|██████▎                                                                                           | 485/7473 [00:04<00:51, 134.64it/s]  7%|██████▌                                                                                           | 499/7473 [00:04<00:51, 134.96it/s]  7%|██████▋                                                                                           | 513/7473 [00:04<00:51, 135.41it/s]  7%|██████▉                                                                                           | 527/7473 [00:04<00:51, 135.72it/s]  7%|███████                                                                                           | 541/7473 [00:04<00:50, 136.09it/s]  7%|███████▎                                                                                          | 555/7473 [00:04<00:50, 136.31it/s]  8%|███████▍                                                                                          | 569/7473 [00:05<00:50, 136.25it/s]  8%|███████▋                                                                                          | 583/7473 [00:05<00:50, 136.16it/s]  8%|███████▊                                                                                          | 597/7473 [00:05<00:50, 136.13it/s]  8%|████████                                                                                          | 611/7473 [00:05<00:50, 136.00it/s]  8%|████████▏                                                                                         | 625/7473 [00:05<00:50, 135.76it/s]  9%|████████▍                                                                                         | 639/7473 [00:05<00:50, 135.99it/s]  9%|████████▌                                                                                         | 653/7473 [00:05<00:50, 135.59it/s]  9%|████████▋                                                                                         | 667/7473 [00:05<00:50, 135.87it/s]  9%|████████▉                                                                                         | 681/7473 [00:05<00:49, 136.09it/s]  9%|█████████                                                                                         | 695/7473 [00:05<00:49, 136.30it/s]  9%|█████████▎                                                                                        | 709/7473 [00:06<00:50, 134.88it/s] 10%|█████████▍                                                                                        | 723/7473 [00:06<00:49, 135.51it/s] 10%|█████████▋                                                                                        | 737/7473 [00:06<00:49, 136.05it/s] 10%|█████████▊                                                                                        | 751/7473 [00:06<00:49, 136.29it/s] 10%|██████████                                                                                        | 765/7473 [00:06<00:49, 136.04it/s] 10%|██████████▏                                                                                       | 779/7473 [00:06<00:49, 136.06it/s] 11%|██████████▍                                                                                       | 793/7473 [00:06<00:49, 136.16it/s] 11%|██████████▌                                                                                       | 807/7473 [00:06<00:48, 136.12it/s] 11%|██████████▊                                                                                       | 821/7473 [00:06<00:48, 136.05it/s] 11%|██████████▉                                                                                       | 835/7473 [00:06<00:49, 135.09it/s] 11%|███████████▏                                                                                      | 849/7473 [00:07<00:48, 135.36it/s] 12%|███████████▎                                                                                      | 863/7473 [00:07<00:48, 135.76it/s] 12%|███████████▌                                                                                      | 877/7473 [00:07<00:48, 135.95it/s] 12%|███████████▋                                                                                      | 891/7473 [00:07<00:48, 136.07it/s] 12%|███████████▊                                                                                      | 905/7473 [00:07<00:48, 136.14it/s] 12%|████████████                                                                                      | 919/7473 [00:07<00:48, 135.89it/s] 12%|████████████▏                                                                                     | 933/7473 [00:07<00:48, 134.24it/s] 13%|████████████▍                                                                                     | 947/7473 [00:07<00:48, 134.73it/s] 13%|████████████▌                                                                                     | 961/7473 [00:07<00:48, 135.16it/s] 13%|████████████▊                                                                                     | 975/7473 [00:08<00:47, 135.47it/s] 13%|████████████▉                                                                                     | 989/7473 [00:08<00:47, 135.64it/s] 13%|█████████████                                                                                    | 1003/7473 [00:08<00:48, 134.08it/s] 14%|█████████████▏                                                                                   | 1017/7473 [00:08<00:47, 134.66it/s] 14%|█████████████▍                                                                                   | 1031/7473 [00:08<00:47, 134.93it/s] 14%|█████████████▌                                                                                   | 1045/7473 [00:08<00:47, 135.05it/s] 14%|█████████████▋                                                                                   | 1059/7473 [00:08<00:47, 134.48it/s] 14%|█████████████▉                                                                                   | 1073/7473 [00:08<00:47, 134.66it/s] 15%|██████████████                                                                                   | 1087/7473 [00:08<00:47, 135.00it/s] 15%|██████████████▎                                                                                  | 1101/7473 [00:08<00:47, 135.00it/s] 15%|██████████████▍                                                                                  | 1115/7473 [00:09<00:47, 134.97it/s] 15%|██████████████▋                                                                                  | 1129/7473 [00:09<00:47, 134.95it/s] 15%|██████████████▊                                                                                  | 1143/7473 [00:09<00:46, 135.17it/s] 15%|███████████████                                                                                  | 1157/7473 [00:09<00:47, 133.45it/s] 16%|███████████████▏                                                                                 | 1171/7473 [00:09<00:47, 133.79it/s] 16%|███████████████▍                                                                                 | 1185/7473 [00:09<00:47, 133.56it/s] 16%|███████████████▌                                                                                 | 1199/7473 [00:09<00:46, 134.25it/s] 16%|███████████████▋                                                                                 | 1213/7473 [00:09<00:46, 134.29it/s] 16%|███████████████▉                                                                                 | 1227/7473 [00:09<00:46, 134.55it/s] 17%|████████████████                                                                                 | 1241/7473 [00:09<00:46, 134.66it/s] 17%|████████████████▎                                                                                | 1255/7473 [00:10<00:46, 134.33it/s] 17%|████████████████▍                                                                                | 1269/7473 [00:10<00:46, 134.71it/s] 17%|████████████████▋                                                                                | 1283/7473 [00:10<00:45, 134.86it/s] 17%|████████████████▊                                                                                | 1297/7473 [00:10<00:45, 135.13it/s] 18%|█████████████████                                                                                | 1311/7473 [00:10<00:45, 135.15it/s] 18%|█████████████████▏                                                                               | 1325/7473 [00:10<00:45, 135.40it/s] 18%|█████████████████▍                                                                               | 1339/7473 [00:10<00:45, 135.22it/s] 18%|█████████████████▌                                                                               | 1353/7473 [00:10<00:45, 135.23it/s] 18%|█████████████████▋                                                                               | 1367/7473 [00:10<00:45, 135.35it/s] 18%|█████████████████▉                                                                               | 1381/7473 [00:11<00:45, 135.06it/s] 19%|██████████████████                                                                               | 1395/7473 [00:11<00:45, 133.55it/s] 19%|██████████████████▎                                                                              | 1409/7473 [00:11<00:45, 133.98it/s] 19%|██████████████████▍                                                                              | 1423/7473 [00:11<00:45, 134.33it/s] 19%|██████████████████▋                                                                              | 1437/7473 [00:11<00:44, 134.45it/s] 19%|██████████████████▊                                                                              | 1451/7473 [00:11<00:44, 134.68it/s] 20%|███████████████████                                                                              | 1465/7473 [00:11<00:44, 134.76it/s] 20%|███████████████████▏                                                                             | 1479/7473 [00:11<00:44, 135.00it/s] 20%|███████████████████▍                                                                             | 1493/7473 [00:11<00:44, 135.18it/s] 20%|███████████████████▌                                                                             | 1507/7473 [00:11<00:44, 135.00it/s] 20%|███████████████████▋                                                                             | 1521/7473 [00:12<00:44, 135.16it/s] 21%|███████████████████▉                                                                             | 1535/7473 [00:12<00:43, 135.14it/s] 21%|████████████████████                                                                             | 1549/7473 [00:12<00:43, 134.94it/s] 21%|████████████████████▎                                                                            | 1563/7473 [00:12<00:43, 134.64it/s] 21%|████████████████████▍                                                                            | 1577/7473 [00:12<00:43, 134.43it/s] 21%|████████████████████▋                                                                            | 1591/7473 [00:12<00:43, 134.46it/s] 21%|████████████████████▊                                                                            | 1605/7473 [00:12<00:43, 134.72it/s] 22%|█████████████████████                                                                            | 1619/7473 [00:12<00:43, 133.26it/s] 22%|█████████████████████▏                                                                           | 1633/7473 [00:12<00:43, 133.58it/s] 22%|█████████████████████▍                                                                           | 1647/7473 [00:13<00:43, 134.15it/s] 22%|█████████████████████▌                                                                           | 1661/7473 [00:13<00:43, 134.04it/s] 22%|█████████████████████▋                                                                           | 1675/7473 [00:13<00:43, 134.41it/s] 23%|█████████████████████▉                                                                           | 1689/7473 [00:13<00:42, 134.70it/s] 23%|██████████████████████                                                                           | 1703/7473 [00:13<00:42, 134.67it/s] 23%|██████████████████████▎                                                                          | 1717/7473 [00:13<00:42, 134.77it/s] 23%|██████████████████████▍                                                                          | 1731/7473 [00:13<00:42, 135.12it/s] 23%|██████████████████████▋                                                                          | 1745/7473 [00:13<00:42, 134.75it/s] 24%|██████████████████████▊                                                                          | 1759/7473 [00:13<00:42, 134.87it/s] 24%|███████████████████████                                                                          | 1773/7473 [00:13<00:42, 134.76it/s] 24%|███████████████████████▏                                                                         | 1787/7473 [00:14<00:42, 134.79it/s] 24%|███████████████████████▍                                                                         | 1801/7473 [00:14<00:42, 134.86it/s] 24%|███████████████████████▌                                                                         | 1815/7473 [00:14<00:41, 134.92it/s] 24%|███████████████████████▋                                                                         | 1829/7473 [00:14<00:41, 134.47it/s] 25%|███████████████████████▉                                                                         | 1843/7473 [00:14<00:42, 133.06it/s] 25%|████████████████████████                                                                         | 1857/7473 [00:14<00:42, 133.65it/s] 25%|████████████████████████▎                                                                        | 1871/7473 [00:14<00:41, 134.06it/s] 25%|████████████████████████▍                                                                        | 1885/7473 [00:14<00:41, 134.41it/s] 25%|████████████████████████▋                                                                        | 1899/7473 [00:14<00:41, 134.34it/s] 26%|████████████████████████▊                                                                        | 1913/7473 [00:14<00:41, 134.04it/s] 26%|█████████████████████████                                                                        | 1927/7473 [00:15<00:41, 134.44it/s] 26%|█████████████████████████▏                                                                       | 1941/7473 [00:15<00:41, 134.36it/s] 26%|█████████████████████████▍                                                                       | 1955/7473 [00:15<00:40, 134.62it/s] 26%|█████████████████████████▌                                                                       | 1969/7473 [00:15<00:40, 134.65it/s] 27%|█████████████████████████▋                                                                       | 1983/7473 [00:15<00:40, 134.66it/s] 27%|█████████████████████████▉                                                                       | 1997/7473 [00:15<00:40, 134.76it/s] 27%|██████████████████████████                                                                       | 2011/7473 [00:15<00:40, 134.76it/s] 27%|██████████████████████████▎                                                                      | 2025/7473 [00:15<00:40, 134.96it/s] 27%|██████████████████████████▍                                                                      | 2039/7473 [00:15<00:40, 134.96it/s] 27%|██████████████████████████▋                                                                      | 2053/7473 [00:16<00:40, 135.01it/s] 28%|██████████████████████████▊                                                                      | 2067/7473 [00:16<00:40, 133.49it/s] 28%|███████████████████████████                                                                      | 2081/7473 [00:16<00:40, 133.76it/s] 28%|███████████████████████████▏                                                                     | 2095/7473 [00:16<00:40, 134.26it/s] 28%|███████████████████████████▎                                                                     | 2109/7473 [00:16<00:39, 134.37it/s] 28%|███████████████████████████▌                                                                     | 2123/7473 [00:16<00:39, 134.09it/s] 29%|███████████████████████████▋                                                                     | 2137/7473 [00:16<00:39, 134.29it/s] 29%|███████████████████████████▉                                                                     | 2151/7473 [00:16<00:39, 134.62it/s] 29%|████████████████████████████                                                                     | 2165/7473 [00:16<00:39, 134.64it/s] 29%|████████████████████████████▎                                                                    | 2179/7473 [00:16<00:39, 134.79it/s] 29%|████████████████████████████▍                                                                    | 2193/7473 [00:17<00:39, 134.58it/s] 30%|████████████████████████████▋                                                                    | 2207/7473 [00:17<00:39, 134.89it/s] 30%|████████████████████████████▊                                                                    | 2221/7473 [00:17<00:38, 134.96it/s] 30%|█████████████████████████████                                                                    | 2235/7473 [00:17<00:38, 134.93it/s] 30%|█████████████████████████████▏                                                                   | 2249/7473 [00:17<00:38, 134.70it/s] 30%|█████████████████████████████▎                                                                   | 2263/7473 [00:17<00:38, 134.76it/s] 30%|█████████████████████████████▌                                                                   | 2277/7473 [00:17<00:38, 134.50it/s] 31%|█████████████████████████████▋                                                                   | 2291/7473 [00:17<00:38, 134.56it/s] 31%|█████████████████████████████▉                                                                   | 2305/7473 [00:17<00:38, 133.46it/s] 31%|██████████████████████████████                                                                   | 2319/7473 [00:17<00:38, 133.64it/s] 31%|██████████████████████████████▎                                                                  | 2333/7473 [00:18<00:38, 134.08it/s] 31%|██████████████████████████████▍                                                                  | 2347/7473 [00:18<00:38, 134.03it/s] 32%|██████████████████████████████▋                                                                  | 2361/7473 [00:18<00:38, 134.33it/s] 32%|██████████████████████████████▊                                                                  | 2375/7473 [00:18<00:37, 134.31it/s] 32%|███████████████████████████████                                                                  | 2389/7473 [00:18<00:37, 134.56it/s] 32%|███████████████████████████████▏                                                                 | 2403/7473 [00:18<00:37, 134.55it/s] 32%|███████████████████████████████▎                                                                 | 2417/7473 [00:18<00:37, 134.66it/s] 33%|███████████████████████████████▌                                                                 | 2431/7473 [00:18<00:37, 134.47it/s] 33%|███████████████████████████████▋                                                                 | 2445/7473 [00:18<00:37, 134.54it/s] 33%|███████████████████████████████▉                                                                 | 2459/7473 [00:19<00:37, 134.48it/s] 33%|████████████████████████████████                                                                 | 2473/7473 [00:19<00:37, 134.55it/s] 33%|████████████████████████████████▎                                                                | 2487/7473 [00:19<00:37, 134.61it/s] 33%|████████████████████████████████▍                                                                | 2501/7473 [00:19<00:36, 134.58it/s] 34%|████████████████████████████████▋                                                                | 2515/7473 [00:19<00:36, 134.52it/s] 34%|████████████████████████████████▊                                                                | 2529/7473 [00:19<00:42, 115.46it/s] 34%|█████████████████████████████████                                                                | 2543/7473 [00:19<00:41, 120.16it/s] 34%|█████████████████████████████████▏                                                               | 2557/7473 [00:19<00:39, 124.20it/s] 34%|█████████████████████████████████▎                                                               | 2571/7473 [00:19<00:38, 127.49it/s] 35%|█████████████████████████████████▌                                                               | 2585/7473 [00:20<00:37, 129.67it/s] 35%|█████████████████████████████████▋                                                               | 2599/7473 [00:20<00:37, 131.05it/s] 35%|█████████████████████████████████▉                                                               | 2613/7473 [00:20<00:36, 132.28it/s] 35%|██████████████████████████████████                                                               | 2627/7473 [00:20<00:36, 132.94it/s] 35%|██████████████████████████████████▎                                                              | 2641/7473 [00:20<00:36, 133.58it/s] 36%|██████████████████████████████████▍                                                              | 2655/7473 [00:20<00:35, 133.91it/s] 36%|██████████████████████████████████▋                                                              | 2669/7473 [00:20<00:35, 134.30it/s] 36%|██████████████████████████████████▊                                                              | 2683/7473 [00:20<00:35, 134.41it/s] 36%|███████████████████████████████████                                                              | 2697/7473 [00:20<00:35, 134.48it/s] 36%|███████████████████████████████████▏                                                             | 2711/7473 [00:20<00:35, 134.47it/s] 36%|███████████████████████████████████▎                                                             | 2725/7473 [00:21<00:35, 134.32it/s] 37%|███████████████████████████████████▌                                                             | 2739/7473 [00:21<00:35, 134.29it/s] 37%|███████████████████████████████████▋                                                             | 2753/7473 [00:21<00:35, 133.07it/s] 37%|███████████████████████████████████▉                                                             | 2767/7473 [00:21<00:35, 132.36it/s] 37%|████████████████████████████████████                                                             | 2781/7473 [00:21<00:35, 132.98it/s] 37%|████████████████████████████████████▎                                                            | 2795/7473 [00:21<00:35, 133.29it/s] 38%|████████████████████████████████████▍                                                            | 2809/7473 [00:21<00:34, 133.58it/s] 38%|████████████████████████████████████▋                                                            | 2823/7473 [00:21<00:34, 133.62it/s] 38%|████████████████████████████████████▊                                                            | 2837/7473 [00:21<00:34, 133.77it/s] 38%|█████████████████████████████████████                                                            | 2851/7473 [00:22<00:34, 133.75it/s] 38%|█████████████████████████████████████▏                                                           | 2865/7473 [00:22<00:34, 133.63it/s] 39%|█████████████████████████████████████▎                                                           | 2879/7473 [00:22<00:34, 133.55it/s] 39%|█████████████████████████████████████▌                                                           | 2893/7473 [00:22<00:34, 133.93it/s] 39%|█████████████████████████████████████▋                                                           | 2907/7473 [00:22<00:34, 134.02it/s] 39%|█████████████████████████████████████▉                                                           | 2921/7473 [00:22<00:33, 133.97it/s] 39%|██████████████████████████████████████                                                           | 2935/7473 [00:22<00:33, 134.25it/s] 39%|██████████████████████████████████████▎                                                          | 2949/7473 [00:22<00:33, 134.30it/s] 40%|██████████████████████████████████████▍                                                          | 2963/7473 [00:22<00:33, 134.23it/s] 40%|██████████████████████████████████████▋                                                          | 2977/7473 [00:22<00:33, 132.78it/s] 40%|██████████████████████████████████████▊                                                          | 2991/7473 [00:23<00:33, 132.18it/s] 40%|███████████████████████████████████████                                                          | 3005/7473 [00:23<00:33, 132.68it/s] 40%|███████████████████████████████████████▏                                                         | 3019/7473 [00:23<00:33, 132.93it/s] 41%|███████████████████████████████████████▎                                                         | 3033/7473 [00:23<00:33, 133.10it/s] 41%|███████████████████████████████████████▌                                                         | 3047/7473 [00:23<00:33, 133.19it/s] 41%|███████████████████████████████████████▋                                                         | 3061/7473 [00:23<00:33, 133.65it/s] 41%|███████████████████████████████████████▉                                                         | 3075/7473 [00:23<00:32, 133.63it/s] 41%|████████████████████████████████████████                                                         | 3089/7473 [00:23<00:32, 133.72it/s] 42%|████████████████████████████████████████▎                                                        | 3103/7473 [00:23<00:32, 133.61it/s] 42%|████████████████████████████████████████▍                                                        | 3117/7473 [00:24<00:32, 133.10it/s] 42%|████████████████████████████████████████▋                                                        | 3131/7473 [00:24<00:32, 133.37it/s] 42%|████████████████████████████████████████▊                                                        | 3145/7473 [00:24<00:32, 133.22it/s] 42%|█████████████████████████████████████████                                                        | 3159/7473 [00:24<00:32, 133.41it/s] 42%|█████████████████████████████████████████▏                                                       | 3173/7473 [00:24<00:32, 133.60it/s] 43%|█████████████████████████████████████████▎                                                       | 3187/7473 [00:24<00:32, 133.52it/s] 43%|█████████████████████████████████████████▌                                                       | 3201/7473 [00:24<00:32, 132.35it/s] 43%|█████████████████████████████████████████▋                                                       | 3215/7473 [00:24<00:32, 132.96it/s] 43%|█████████████████████████████████████████▉                                                       | 3229/7473 [00:24<00:32, 132.33it/s] 43%|██████████████████████████████████████████                                                       | 3243/7473 [00:24<00:31, 132.93it/s] 44%|██████████████████████████████████████████▎                                                      | 3257/7473 [00:25<00:31, 133.27it/s] 44%|██████████████████████████████████████████▍                                                      | 3271/7473 [00:25<00:31, 133.50it/s] 44%|██████████████████████████████████████████▋                                                      | 3285/7473 [00:25<00:31, 133.73it/s] 44%|██████████████████████████████████████████▊                                                      | 3299/7473 [00:25<00:31, 133.83it/s] 44%|███████████████████████████████████████████                                                      | 3313/7473 [00:25<00:31, 133.82it/s] 45%|███████████████████████████████████████████▏                                                     | 3327/7473 [00:25<00:31, 133.48it/s] 45%|███████████████████████████████████████████▎                                                     | 3341/7473 [00:25<00:31, 133.16it/s] 45%|███████████████████████████████████████████▌                                                     | 3355/7473 [00:25<00:30, 133.24it/s] 45%|███████████████████████████████████████████▋                                                     | 3369/7473 [00:25<00:30, 133.29it/s] 45%|███████████████████████████████████████████▉                                                     | 3383/7473 [00:26<00:30, 133.12it/s] 45%|████████████████████████████████████████████                                                     | 3397/7473 [00:26<00:30, 133.00it/s] 46%|████████████████████████████████████████████▎                                                    | 3411/7473 [00:26<00:30, 133.23it/s] 46%|████████████████████████████████████████████▍                                                    | 3425/7473 [00:26<00:30, 133.15it/s] 46%|████████████████████████████████████████████▋                                                    | 3439/7473 [00:26<00:30, 131.82it/s] 46%|████████████████████████████████████████████▊                                                    | 3453/7473 [00:26<00:30, 131.09it/s] 46%|█████████████████████████████████████████████                                                    | 3467/7473 [00:26<00:30, 131.50it/s] 47%|█████████████████████████████████████████████▏                                                   | 3481/7473 [00:26<00:30, 132.04it/s] 47%|█████████████████████████████████████████████▎                                                   | 3495/7473 [00:26<00:30, 132.51it/s] 47%|█████████████████████████████████████████████▌                                                   | 3509/7473 [00:26<00:29, 132.73it/s] 47%|█████████████████████████████████████████████▋                                                   | 3523/7473 [00:27<00:29, 132.95it/s] 47%|█████████████████████████████████████████████▉                                                   | 3537/7473 [00:27<00:29, 133.15it/s] 48%|██████████████████████████████████████████████                                                   | 3551/7473 [00:27<00:29, 133.17it/s] 48%|██████████████████████████████████████████████▎                                                  | 3565/7473 [00:27<00:29, 133.23it/s] 48%|██████████████████████████████████████████████▍                                                  | 3579/7473 [00:27<00:29, 133.33it/s] 48%|██████████████████████████████████████████████▋                                                  | 3593/7473 [00:27<00:29, 133.35it/s] 48%|██████████████████████████████████████████████▊                                                  | 3607/7473 [00:27<00:29, 133.30it/s] 48%|███████████████████████████████████████████████                                                  | 3621/7473 [00:27<00:28, 133.39it/s] 49%|███████████████████████████████████████████████▏                                                 | 3635/7473 [00:27<00:28, 133.23it/s] 49%|███████████████████████████████████████████████▎                                                 | 3649/7473 [00:28<00:28, 132.90it/s] 49%|███████████████████████████████████████████████▌                                                 | 3663/7473 [00:28<00:28, 131.52it/s] 49%|███████████████████████████████████████████████▋                                                 | 3677/7473 [00:28<00:28, 131.11it/s] 49%|███████████████████████████████████████████████▉                                                 | 3691/7473 [00:28<00:28, 131.85it/s] 50%|████████████████████████████████████████████████                                                 | 3705/7473 [00:28<00:28, 132.16it/s] 50%|████████████████████████████████████████████████▎                                                | 3719/7473 [00:28<00:28, 132.46it/s] 50%|████████████████████████████████████████████████▍                                                | 3733/7473 [00:28<00:28, 132.75it/s] 50%|████████████████████████████████████████████████▋                                                | 3747/7473 [00:28<00:28, 132.71it/s] 50%|████████████████████████████████████████████████▊                                                | 3761/7473 [00:28<00:27, 132.71it/s] 51%|████████████████████████████████████████████████▉                                                | 3775/7473 [00:28<00:27, 133.00it/s] 51%|█████████████████████████████████████████████████▏                                               | 3789/7473 [00:29<00:27, 133.11it/s] 51%|█████████████████████████████████████████████████▎                                               | 3803/7473 [00:29<00:27, 133.39it/s] 51%|█████████████████████████████████████████████████▌                                               | 3817/7473 [00:29<00:27, 133.45it/s] 51%|█████████████████████████████████████████████████▋                                               | 3831/7473 [00:29<00:27, 133.34it/s] 51%|█████████████████████████████████████████████████▉                                               | 3845/7473 [00:29<00:27, 133.32it/s] 52%|██████████████████████████████████████████████████                                               | 3859/7473 [00:29<00:27, 133.07it/s] 52%|██████████████████████████████████████████████████▎                                              | 3873/7473 [00:29<00:27, 133.09it/s] 52%|██████████████████████████████████████████████████▍                                              | 3887/7473 [00:29<00:27, 131.68it/s] 52%|██████████████████████████████████████████████████▋                                              | 3901/7473 [00:29<00:27, 131.19it/s] 52%|██████████████████████████████████████████████████▊                                              | 3915/7473 [00:30<00:26, 132.37it/s] 53%|██████████████████████████████████████████████████▉                                              | 3929/7473 [00:30<00:26, 133.40it/s] 53%|███████████████████████████████████████████████████▏                                             | 3943/7473 [00:30<00:26, 133.93it/s] 53%|███████████████████████████████████████████████████▎                                             | 3957/7473 [00:30<00:26, 134.50it/s] 53%|███████████████████████████████████████████████████▌                                             | 3971/7473 [00:30<00:25, 134.84it/s] 53%|███████████████████████████████████████████████████▋                                             | 3985/7473 [00:30<00:25, 135.20it/s] 54%|███████████████████████████████████████████████████▉                                             | 3999/7473 [00:30<00:25, 135.49it/s] 54%|████████████████████████████████████████████████████                                             | 4013/7473 [00:30<00:25, 135.77it/s] 54%|████████████████████████████████████████████████████▎                                            | 4027/7473 [00:30<00:25, 135.70it/s] 54%|████████████████████████████████████████████████████▍                                            | 4041/7473 [00:30<00:25, 135.63it/s] 54%|████████████████████████████████████████████████████▋                                            | 4055/7473 [00:31<00:25, 135.75it/s] 54%|████████████████████████████████████████████████████▊                                            | 4069/7473 [00:31<00:25, 135.84it/s] 55%|████████████████████████████████████████████████████▉                                            | 4083/7473 [00:31<00:24, 135.80it/s] 55%|█████████████████████████████████████████████████████▏                                           | 4097/7473 [00:31<00:24, 135.83it/s] 55%|█████████████████████████████████████████████████████▎                                           | 4111/7473 [00:31<00:25, 134.07it/s] 55%|█████████████████████████████████████████████████████▌                                           | 4125/7473 [00:31<00:24, 134.09it/s] 55%|█████████████████████████████████████████████████████▋                                           | 4139/7473 [00:31<00:24, 134.40it/s] 56%|█████████████████████████████████████████████████████▉                                           | 4153/7473 [00:31<00:24, 134.64it/s] 56%|██████████████████████████████████████████████████████                                           | 4167/7473 [00:31<00:24, 135.20it/s] 56%|██████████████████████████████████████████████████████▎                                          | 4181/7473 [00:31<00:24, 135.16it/s] 56%|██████████████████████████████████████████████████████▍                                          | 4195/7473 [00:32<00:24, 135.42it/s] 56%|██████████████████████████████████████████████████████▋                                          | 4209/7473 [00:32<00:24, 135.27it/s] 57%|██████████████████████████████████████████████████████▊                                          | 4223/7473 [00:32<00:24, 135.29it/s] 57%|██████████████████████████████████████████████████████▉                                          | 4237/7473 [00:32<00:23, 135.56it/s] 57%|███████████████████████████████████████████████████████▏                                         | 4251/7473 [00:32<00:23, 135.49it/s] 57%|███████████████████████████████████████████████████████▎                                         | 4265/7473 [00:32<00:23, 135.48it/s] 57%|███████████████████████████████████████████████████████▌                                         | 4279/7473 [00:32<00:23, 135.27it/s] 57%|███████████████████████████████████████████████████████▋                                         | 4293/7473 [00:32<00:23, 135.44it/s] 58%|███████████████████████████████████████████████████████▉                                         | 4307/7473 [00:32<00:23, 135.38it/s] 58%|████████████████████████████████████████████████████████                                         | 4321/7473 [00:33<00:23, 135.51it/s] 58%|████████████████████████████████████████████████████████▎                                        | 4335/7473 [00:33<00:23, 134.42it/s] 58%|████████████████████████████████████████████████████████▍                                        | 4349/7473 [00:33<00:23, 135.00it/s] 58%|████████████████████████████████████████████████████████▋                                        | 4363/7473 [00:33<00:23, 135.05it/s] 59%|████████████████████████████████████████████████████████▊                                        | 4377/7473 [00:33<00:22, 135.17it/s] 59%|████████████████████████████████████████████████████████▉                                        | 4391/7473 [00:33<00:22, 135.20it/s] 59%|█████████████████████████████████████████████████████████▏                                       | 4405/7473 [00:33<00:22, 134.84it/s] 59%|█████████████████████████████████████████████████████████▎                                       | 4419/7473 [00:33<00:22, 135.02it/s] 59%|█████████████████████████████████████████████████████████▌                                       | 4433/7473 [00:33<00:22, 134.98it/s] 60%|█████████████████████████████████████████████████████████▋                                       | 4447/7473 [00:33<00:22, 135.08it/s] 60%|█████████████████████████████████████████████████████████▉                                       | 4461/7473 [00:34<00:22, 135.16it/s] 60%|██████████████████████████████████████████████████████████                                       | 4475/7473 [00:34<00:22, 135.36it/s] 60%|██████████████████████████████████████████████████████████▎                                      | 4489/7473 [00:34<00:22, 135.21it/s] 60%|██████████████████████████████████████████████████████████▍                                      | 4503/7473 [00:34<00:21, 135.22it/s] 60%|██████████████████████████████████████████████████████████▋                                      | 4517/7473 [00:34<00:21, 135.18it/s] 61%|██████████████████████████████████████████████████████████▊                                      | 4531/7473 [00:34<00:21, 135.32it/s] 61%|██████████████████████████████████████████████████████████▉                                      | 4545/7473 [00:34<00:21, 135.59it/s] 61%|███████████████████████████████████████████████████████████▏                                     | 4559/7473 [00:34<00:21, 135.75it/s] 61%|███████████████████████████████████████████████████████████▎                                     | 4573/7473 [00:34<00:21, 134.43it/s] 61%|███████████████████████████████████████████████████████████▌                                     | 4587/7473 [00:34<00:21, 134.88it/s] 62%|███████████████████████████████████████████████████████████▋                                     | 4601/7473 [00:35<00:21, 134.94it/s] 62%|███████████████████████████████████████████████████████████▉                                     | 4615/7473 [00:35<00:21, 135.22it/s] 62%|████████████████████████████████████████████████████████████                                     | 4629/7473 [00:35<00:21, 135.33it/s] 62%|████████████████████████████████████████████████████████████▎                                    | 4643/7473 [00:35<00:20, 135.31it/s] 62%|████████████████████████████████████████████████████████████▍                                    | 4657/7473 [00:35<00:20, 135.51it/s] 63%|████████████████████████████████████████████████████████████▋                                    | 4671/7473 [00:35<00:20, 135.20it/s] 63%|████████████████████████████████████████████████████████████▊                                    | 4685/7473 [00:35<00:20, 135.20it/s] 63%|████████████████████████████████████████████████████████████▉                                    | 4699/7473 [00:35<00:20, 135.26it/s] 63%|█████████████████████████████████████████████████████████████▏                                   | 4713/7473 [00:35<00:20, 135.34it/s] 63%|█████████████████████████████████████████████████████████████▎                                   | 4727/7473 [00:36<00:20, 135.60it/s] 63%|█████████████████████████████████████████████████████████████▌                                   | 4741/7473 [00:36<00:20, 135.62it/s] 64%|█████████████████████████████████████████████████████████████▋                                   | 4755/7473 [00:36<00:20, 135.76it/s] 64%|█████████████████████████████████████████████████████████████▉                                   | 4769/7473 [00:36<00:19, 135.74it/s] 64%|██████████████████████████████████████████████████████████████                                   | 4783/7473 [00:36<00:19, 135.72it/s] 64%|██████████████████████████████████████████████████████████████▎                                  | 4797/7473 [00:36<00:19, 134.12it/s] 64%|██████████████████████████████████████████████████████████████▍                                  | 4811/7473 [00:36<00:19, 134.56it/s] 65%|██████████████████████████████████████████████████████████████▋                                  | 4825/7473 [00:36<00:19, 134.91it/s] 65%|██████████████████████████████████████████████████████████████▊                                  | 4839/7473 [00:36<00:19, 135.11it/s] 65%|██████████████████████████████████████████████████████████████▉                                  | 4853/7473 [00:36<00:19, 135.11it/s] 65%|███████████████████████████████████████████████████████████████▏                                 | 4867/7473 [00:37<00:19, 135.05it/s] 65%|███████████████████████████████████████████████████████████████▎                                 | 4881/7473 [00:37<00:19, 135.16it/s] 66%|███████████████████████████████████████████████████████████████▌                                 | 4895/7473 [00:37<00:19, 135.59it/s] 66%|███████████████████████████████████████████████████████████████▋                                 | 4909/7473 [00:37<00:18, 135.70it/s] 66%|███████████████████████████████████████████████████████████████▉                                 | 4923/7473 [00:37<00:18, 135.68it/s] 66%|████████████████████████████████████████████████████████████████                                 | 4937/7473 [00:37<00:18, 135.46it/s] 66%|████████████████████████████████████████████████████████████████▎                                | 4951/7473 [00:37<00:18, 135.51it/s] 66%|████████████████████████████████████████████████████████████████▍                                | 4965/7473 [00:37<00:18, 135.26it/s] 67%|████████████████████████████████████████████████████████████████▋                                | 4979/7473 [00:37<00:18, 135.38it/s] 67%|████████████████████████████████████████████████████████████████▊                                | 4993/7473 [00:37<00:18, 135.31it/s] 67%|████████████████████████████████████████████████████████████████▉                                | 5007/7473 [00:38<00:18, 135.65it/s] 67%|█████████████████████████████████████████████████████████████████▏                               | 5021/7473 [00:38<00:18, 134.19it/s] 67%|█████████████████████████████████████████████████████████████████▎                               | 5035/7473 [00:38<00:18, 134.52it/s] 68%|█████████████████████████████████████████████████████████████████▌                               | 5049/7473 [00:38<00:17, 134.84it/s] 68%|█████████████████████████████████████████████████████████████████▋                               | 5063/7473 [00:38<00:17, 135.06it/s] 68%|█████████████████████████████████████████████████████████████████▉                               | 5077/7473 [00:38<00:17, 135.11it/s] 68%|██████████████████████████████████████████████████████████████████                               | 5091/7473 [00:38<00:17, 135.09it/s] 68%|██████████████████████████████████████████████████████████████████▎                              | 5105/7473 [00:38<00:17, 135.12it/s] 68%|██████████████████████████████████████████████████████████████████▍                              | 5119/7473 [00:38<00:17, 135.23it/s] 69%|██████████████████████████████████████████████████████████████████▋                              | 5133/7473 [00:39<00:17, 135.51it/s] 69%|██████████████████████████████████████████████████████████████████▊                              | 5147/7473 [00:39<00:17, 135.37it/s] 69%|██████████████████████████████████████████████████████████████████▉                              | 5161/7473 [00:39<00:17, 135.38it/s] 69%|███████████████████████████████████████████████████████████████████▏                             | 5175/7473 [00:39<00:16, 135.53it/s] 69%|███████████████████████████████████████████████████████████████████▎                             | 5189/7473 [00:39<00:16, 135.56it/s] 70%|███████████████████████████████████████████████████████████████████▌                             | 5203/7473 [00:39<00:16, 135.43it/s] 70%|███████████████████████████████████████████████████████████████████▋                             | 5217/7473 [00:39<00:16, 135.55it/s] 70%|███████████████████████████████████████████████████████████████████▉                             | 5231/7473 [00:39<00:16, 135.42it/s] 70%|████████████████████████████████████████████████████████████████████                             | 5245/7473 [00:39<00:19, 114.63it/s] 70%|████████████████████████████████████████████████████████████████████▎                            | 5259/7473 [00:40<00:18, 119.87it/s] 71%|████████████████████████████████████████████████████████████████████▍                            | 5273/7473 [00:40<00:17, 124.18it/s] 71%|████████████████████████████████████████████████████████████████████▋                            | 5287/7473 [00:40<00:17, 127.46it/s] 71%|████████████████████████████████████████████████████████████████████▊                            | 5301/7473 [00:40<00:16, 129.78it/s] 71%|████████████████████████████████████████████████████████████████████▉                            | 5315/7473 [00:40<00:16, 130.87it/s] 71%|█████████████████████████████████████████████████████████████████████▏                           | 5329/7473 [00:40<00:16, 132.02it/s] 71%|█████████████████████████████████████████████████████████████████████▎                           | 5343/7473 [00:40<00:16, 133.03it/s] 72%|█████████████████████████████████████████████████████████████████████▌                           | 5357/7473 [00:40<00:15, 133.70it/s] 72%|█████████████████████████████████████████████████████████████████████▋                           | 5371/7473 [00:40<00:15, 134.23it/s] 72%|█████████████████████████████████████████████████████████████████████▉                           | 5385/7473 [00:40<00:15, 134.61it/s] 72%|██████████████████████████████████████████████████████████████████████                           | 5399/7473 [00:41<00:15, 134.96it/s] 72%|██████████████████████████████████████████████████████████████████████▎                          | 5413/7473 [00:41<00:15, 135.05it/s] 73%|██████████████████████████████████████████████████████████████████████▍                          | 5427/7473 [00:41<00:15, 135.24it/s] 73%|██████████████████████████████████████████████████████████████████████▌                          | 5441/7473 [00:41<00:15, 135.40it/s] 73%|██████████████████████████████████████████████████████████████████████▊                          | 5455/7473 [00:41<00:14, 135.35it/s] 73%|██████████████████████████████████████████████████████████████████████▉                          | 5469/7473 [00:41<00:14, 135.36it/s] 73%|███████████████████████████████████████████████████████████████████████▉                          | 5483/7473 [00:41<00:23, 83.01it/s] 74%|████████████████████████████████████████████████████████████████████████                          | 5497/7473 [00:41<00:21, 93.95it/s] 74%|███████████████████████████████████████████████████████████████████████▌                         | 5511/7473 [00:42<00:18, 103.45it/s] 74%|███████████████████████████████████████████████████████████████████████▋                         | 5525/7473 [00:42<00:17, 111.38it/s] 74%|███████████████████████████████████████████████████████████████████████▉                         | 5539/7473 [00:42<00:16, 117.03it/s] 74%|████████████████████████████████████████████████████████████████████████                         | 5553/7473 [00:42<00:15, 121.89it/s] 74%|████████████████████████████████████████████████████████████████████████▎                        | 5567/7473 [00:42<00:15, 125.38it/s] 75%|████████████████████████████████████████████████████████████████████████▍                        | 5581/7473 [00:42<00:14, 127.90it/s] 75%|████████████████████████████████████████████████████████████████████████▌                        | 5595/7473 [00:42<00:14, 129.85it/s] 75%|████████████████████████████████████████████████████████████████████████▊                        | 5609/7473 [00:42<00:14, 131.53it/s] 75%|████████████████████████████████████████████████████████████████████████▉                        | 5623/7473 [00:42<00:13, 132.55it/s] 75%|█████████████████████████████████████████████████████████████████████████▏                       | 5637/7473 [00:43<00:13, 133.45it/s] 76%|█████████████████████████████████████████████████████████████████████████▎                       | 5651/7473 [00:43<00:13, 134.26it/s] 76%|█████████████████████████████████████████████████████████████████████████▌                       | 5665/7473 [00:43<00:13, 134.63it/s] 76%|█████████████████████████████████████████████████████████████████████████▋                       | 5679/7473 [00:43<00:13, 133.36it/s] 76%|█████████████████████████████████████████████████████████████████████████▉                       | 5693/7473 [00:43<00:13, 134.03it/s] 76%|██████████████████████████████████████████████████████████████████████████                       | 5707/7473 [00:43<00:13, 134.39it/s] 77%|██████████████████████████████████████████████████████████████████████████▎                      | 5721/7473 [00:43<00:13, 134.56it/s] 77%|██████████████████████████████████████████████████████████████████████████▍                      | 5735/7473 [00:43<00:12, 134.63it/s] 77%|██████████████████████████████████████████████████████████████████████████▌                      | 5749/7473 [00:43<00:12, 135.02it/s] 77%|██████████████████████████████████████████████████████████████████████████▊                      | 5763/7473 [00:43<00:12, 135.05it/s] 77%|██████████████████████████████████████████████████████████████████████████▉                      | 5777/7473 [00:44<00:12, 135.15it/s] 77%|███████████████████████████████████████████████████████████████████████████▏                     | 5791/7473 [00:44<00:12, 135.20it/s] 78%|███████████████████████████████████████████████████████████████████████████▎                     | 5805/7473 [00:44<00:12, 135.26it/s] 78%|███████████████████████████████████████████████████████████████████████████▌                     | 5819/7473 [00:44<00:12, 135.17it/s] 78%|███████████████████████████████████████████████████████████████████████████▋                     | 5833/7473 [00:44<00:12, 135.16it/s] 78%|███████████████████████████████████████████████████████████████████████████▉                     | 5847/7473 [00:44<00:12, 135.19it/s] 78%|████████████████████████████████████████████████████████████████████████████                     | 5861/7473 [00:44<00:11, 135.21it/s] 79%|████████████████████████████████████████████████████████████████████████████▎                    | 5875/7473 [00:44<00:11, 135.30it/s] 79%|████████████████████████████████████████████████████████████████████████████▍                    | 5889/7473 [00:44<00:11, 135.34it/s] 79%|████████████████████████████████████████████████████████████████████████████▌                    | 5903/7473 [00:45<00:11, 133.86it/s] 79%|████████████████████████████████████████████████████████████████████████████▊                    | 5917/7473 [00:45<00:11, 134.27it/s] 79%|████████████████████████████████████████████████████████████████████████████▉                    | 5931/7473 [00:45<00:11, 134.49it/s] 80%|█████████████████████████████████████████████████████████████████████████████▏                   | 5945/7473 [00:45<00:11, 134.56it/s] 80%|█████████████████████████████████████████████████████████████████████████████▎                   | 5959/7473 [00:45<00:11, 134.43it/s] 80%|█████████████████████████████████████████████████████████████████████████████▌                   | 5973/7473 [00:45<00:11, 134.56it/s] 80%|█████████████████████████████████████████████████████████████████████████████▋                   | 5987/7473 [00:45<00:11, 134.88it/s] 80%|█████████████████████████████████████████████████████████████████████████████▉                   | 6001/7473 [00:45<00:10, 134.97it/s] 80%|██████████████████████████████████████████████████████████████████████████████                   | 6015/7473 [00:45<00:10, 134.70it/s] 81%|██████████████████████████████████████████████████████████████████████████████▎                  | 6029/7473 [00:45<00:10, 134.96it/s] 81%|██████████████████████████████████████████████████████████████████████████████▍                  | 6043/7473 [00:46<00:10, 135.09it/s] 81%|██████████████████████████████████████████████████████████████████████████████▌                  | 6057/7473 [00:46<00:10, 135.32it/s] 81%|██████████████████████████████████████████████████████████████████████████████▊                  | 6071/7473 [00:46<00:10, 135.38it/s] 81%|██████████████████████████████████████████████████████████████████████████████▉                  | 6085/7473 [00:46<00:10, 135.51it/s] 82%|███████████████████████████████████████████████████████████████████████████████▏                 | 6099/7473 [00:46<00:10, 135.53it/s] 82%|███████████████████████████████████████████████████████████████████████████████▎                 | 6113/7473 [00:46<00:10, 135.52it/s] 82%|███████████████████████████████████████████████████████████████████████████████▌                 | 6127/7473 [00:46<00:09, 135.48it/s] 82%|███████████████████████████████████████████████████████████████████████████████▋                 | 6141/7473 [00:46<00:09, 134.04it/s] 82%|███████████████████████████████████████████████████████████████████████████████▉                 | 6155/7473 [00:46<00:09, 134.39it/s] 83%|████████████████████████████████████████████████████████████████████████████████                 | 6169/7473 [00:46<00:09, 134.67it/s] 83%|████████████████████████████████████████████████████████████████████████████████▎                | 6183/7473 [00:47<00:09, 134.81it/s] 83%|████████████████████████████████████████████████████████████████████████████████▍                | 6197/7473 [00:47<00:09, 135.15it/s] 83%|████████████████████████████████████████████████████████████████████████████████▌                | 6211/7473 [00:47<00:09, 135.23it/s] 83%|████████████████████████████████████████████████████████████████████████████████▊                | 6225/7473 [00:47<00:09, 135.09it/s] 83%|████████████████████████████████████████████████████████████████████████████████▉                | 6239/7473 [00:47<00:09, 135.07it/s] 84%|█████████████████████████████████████████████████████████████████████████████████▏               | 6253/7473 [00:47<00:09, 135.24it/s] 84%|█████████████████████████████████████████████████████████████████████████████████▎               | 6267/7473 [00:47<00:08, 135.16it/s] 84%|█████████████████████████████████████████████████████████████████████████████████▌               | 6281/7473 [00:47<00:08, 135.13it/s] 84%|█████████████████████████████████████████████████████████████████████████████████▋               | 6295/7473 [00:47<00:08, 133.92it/s] 84%|█████████████████████████████████████████████████████████████████████████████████▉               | 6309/7473 [00:48<00:08, 134.48it/s] 85%|██████████████████████████████████████████████████████████████████████████████████               | 6323/7473 [00:48<00:08, 134.84it/s] 85%|██████████████████████████████████████████████████████████████████████████████████▎              | 6337/7473 [00:48<00:08, 135.02it/s] 85%|██████████████████████████████████████████████████████████████████████████████████▍              | 6351/7473 [00:48<00:08, 135.05it/s] 85%|██████████████████████████████████████████████████████████████████████████████████▌              | 6365/7473 [00:48<00:08, 133.60it/s] 85%|██████████████████████████████████████████████████████████████████████████████████▊              | 6379/7473 [00:48<00:08, 133.76it/s] 86%|██████████████████████████████████████████████████████████████████████████████████▉              | 6393/7473 [00:48<00:08, 134.21it/s] 86%|███████████████████████████████████████████████████████████████████████████████████▏             | 6407/7473 [00:48<00:07, 134.54it/s] 86%|███████████████████████████████████████████████████████████████████████████████████▎             | 6421/7473 [00:48<00:07, 134.47it/s] 86%|███████████████████████████████████████████████████████████████████████████████████▌             | 6435/7473 [00:48<00:07, 134.72it/s] 86%|███████████████████████████████████████████████████████████████████████████████████▋             | 6449/7473 [00:49<00:07, 134.94it/s] 86%|███████████████████████████████████████████████████████████████████████████████████▉             | 6463/7473 [00:49<00:07, 134.96it/s] 87%|████████████████████████████████████████████████████████████████████████████████████             | 6477/7473 [00:49<00:07, 135.14it/s] 87%|████████████████████████████████████████████████████████████████████████████████████▎            | 6491/7473 [00:49<00:07, 135.10it/s] 87%|████████████████████████████████████████████████████████████████████████████████████▍            | 6505/7473 [00:49<00:07, 135.18it/s] 87%|████████████████████████████████████████████████████████████████████████████████████▌            | 6519/7473 [00:49<00:07, 134.72it/s] 87%|████████████████████████████████████████████████████████████████████████████████████▊            | 6533/7473 [00:49<00:06, 134.87it/s] 88%|████████████████████████████████████████████████████████████████████████████████████▉            | 6547/7473 [00:49<00:06, 134.97it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████▏           | 6561/7473 [00:49<00:06, 134.21it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████▎           | 6575/7473 [00:49<00:06, 134.51it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████▌           | 6589/7473 [00:50<00:06, 133.55it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████▋           | 6603/7473 [00:50<00:06, 134.17it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████▉           | 6617/7473 [00:50<00:06, 134.41it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████           | 6631/7473 [00:50<00:06, 134.40it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████▎          | 6645/7473 [00:50<00:06, 134.45it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████▍          | 6659/7473 [00:50<00:06, 134.63it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████▌          | 6673/7473 [00:50<00:05, 134.63it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████▊          | 6687/7473 [00:50<00:05, 134.89it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████▉          | 6701/7473 [00:50<00:05, 135.01it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████▏         | 6715/7473 [00:51<00:05, 134.94it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████▎         | 6729/7473 [00:51<00:05, 135.15it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████▌         | 6743/7473 [00:51<00:05, 134.99it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████▋         | 6757/7473 [00:51<00:05, 134.99it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████▉         | 6771/7473 [00:51<00:05, 134.90it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████         | 6785/7473 [00:51<00:05, 135.08it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████▎        | 6799/7473 [00:51<00:04, 135.09it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████▍        | 6813/7473 [00:51<00:04, 133.73it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████▌        | 6827/7473 [00:51<00:04, 133.93it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████▊        | 6841/7473 [00:51<00:04, 133.40it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████▉        | 6855/7473 [00:52<00:04, 134.02it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████▏       | 6869/7473 [00:52<00:04, 134.38it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████▎       | 6883/7473 [00:52<00:04, 134.82it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████▌       | 6897/7473 [00:52<00:04, 134.99it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████▋       | 6911/7473 [00:52<00:04, 135.37it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████▉       | 6925/7473 [00:52<00:04, 135.09it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████       | 6939/7473 [00:52<00:03, 135.13it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████▎      | 6953/7473 [00:52<00:03, 135.08it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████▍      | 6967/7473 [00:52<00:03, 135.03it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████▌      | 6981/7473 [00:53<00:03, 135.04it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████▊      | 6995/7473 [00:53<00:03, 135.00it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████▉      | 7009/7473 [00:53<00:03, 134.97it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████▏     | 7023/7473 [00:53<00:03, 134.93it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████▎     | 7037/7473 [00:53<00:03, 133.53it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████▌     | 7051/7473 [00:53<00:03, 133.93it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████▋     | 7065/7473 [00:53<00:03, 134.37it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████▉     | 7079/7473 [00:53<00:02, 134.70it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████     | 7093/7473 [00:53<00:02, 134.92it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████▏    | 7107/7473 [00:53<00:02, 133.98it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████▍    | 7121/7473 [00:54<00:02, 134.08it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████▌    | 7135/7473 [00:54<00:02, 134.18it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████▊    | 7149/7473 [00:54<00:02, 134.60it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████▉    | 7163/7473 [00:54<00:02, 134.67it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████▏   | 7177/7473 [00:54<00:02, 134.78it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████▎   | 7191/7473 [00:54<00:02, 134.80it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████▌   | 7205/7473 [00:54<00:01, 134.91it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████▋   | 7219/7473 [00:54<00:01, 135.06it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████▉   | 7233/7473 [00:54<00:01, 135.22it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████   | 7247/7473 [00:54<00:01, 135.24it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████▏  | 7261/7473 [00:55<00:01, 135.36it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████▍  | 7275/7473 [00:55<00:01, 133.73it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████▌  | 7289/7473 [00:55<00:01, 134.15it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████▊  | 7303/7473 [00:55<00:01, 134.51it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████▉  | 7317/7473 [00:55<00:01, 134.73it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████▏ | 7331/7473 [00:55<00:01, 134.73it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████▎ | 7345/7473 [00:55<00:00, 134.74it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████▌ | 7359/7473 [00:55<00:00, 134.76it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████▋ | 7373/7473 [00:55<00:00, 134.52it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████▉ | 7387/7473 [00:56<00:00, 133.83it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████ | 7401/7473 [00:56<00:00, 134.24it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████▏| 7415/7473 [00:56<00:00, 134.42it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████▍| 7429/7473 [00:56<00:00, 134.71it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████▌| 7443/7473 [00:56<00:00, 134.80it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████▊| 7457/7473 [00:56<00:00, 134.79it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████▉| 7471/7473 [00:56<00:00, 134.60it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 7473/7473 [00:56<00:00, 131.89it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.13s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.11s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:04<00:09,  4.97s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.29s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.20s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.06s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:09<00:05,  5.00s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.34s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.73s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.85s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.50s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.66s/it]
[2023-08-18 09:09:59,281] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.46s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.60s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.79s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.93s/it]
[2023-08-18 09:10:08,208] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-18 09:10:08,209] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-18 09:10:08,210] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-18 09:10:08,210] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-18 09:10:08,210] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-18 09:10:08,210] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-18 09:10:08,210] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-18 09:10:08,211] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-18 09:10:08,211] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-18 09:10:08,211] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-18 09:10:08,211] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-18 09:10:08,211] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fe377615130>
[2023-08-18 09:10:08,211] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-18 09:10:08,211] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-18 09:10:08,211] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-18 09:10:08,211] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-18 09:10:08,211] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-18 09:10:08,211] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-18 09:10:08,211] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-18 09:10:08,211] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-18 09:10:08,211] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-18 09:10:08,211] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-18 09:10:08,211] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-18 09:10:08,211] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-18 09:10:08,211] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-18 09:10:08,211] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-18 09:10:08,211] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-18 09:10:08,211] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-18 09:10:08,211] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-18 09:10:08,211] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-18 09:10:08,211] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-18 09:10:08,211] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-18 09:10:08,211] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-18 09:10:08,211] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-18 09:10:08,211] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-18 09:10:08,211] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-18 09:10:08,211] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-18 09:10:08,211] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-18 09:10:08,211] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-18 09:10:08,211] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-18 09:10:08,211] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-18 09:10:08,211] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-18 09:10:08,212] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-18 09:10:08,212] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-18 09:10:08,212] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7fe377615280>
[2023-08-18 09:10:08,212] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-18 09:10:08,212] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-18 09:10:08,212] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-18 09:10:08,212] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-18 09:10:08,212] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-18 09:10:08,212] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-18 09:10:08,212] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-18 09:10:08,212] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-18 09:10:08,212] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-18 09:10:08,212] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-18 09:10:08,212] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-18 09:10:08,212] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-18 09:10:08,212] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-18 09:10:08,212] [INFO] [config.py:1012:print]   train_batch_size ............. 8
[2023-08-18 09:10:08,212] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  2
[2023-08-18 09:10:08,212] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-18 09:10:08,212] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-18 09:10:08,212] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-18 09:10:08,212] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-18 09:10:08,212] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-18 09:10:08,212] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-18 09:10:08,212] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-18 09:10:08,212] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.7888438701629639 seconds
Loading extension module utils...
Time to load utils op: 0.7050013542175293 seconds
Loading extension module utils...
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Loading extension module utils...
Time to load utils op: 0.7051563262939453 seconds
Time to load utils op: 0.7049679756164551 seconds
Evaluating gsm8k :   0%|                                                                                           | 0/125 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following grade math question.

Input: Fabric is cut to order at what type of seller? Choices:  A: curtains B: tailor shop C: clothing store D: sewing room E: hardware store
Output: 1. First, let's understand the question. The question is asking where is fabric cut to order. This means we need to identify a place where customized orders involving fabric cuts are likely to take place.
2. Now, let's analyze the options.
3. Choice A is curtains. Although curtains are made of fabric, they are not a place. So this option is not correct.
4. Choice B is a tailor shop. A tailor shop is a place where fabric is directly cut and altered to custom dimensions for tailoring needs. This fits the description of a place where fabric is cut to order.
5. Choice C is a clothing store. While clothing stores do sell fabric items often, it is less common for them to cut fabric to order because they typically sell ready-made clothes.
6. Choice D is a sewing room. A sewing room could potentially be a place where fabric is cut to order, but it is not a service provided universally where all sewing rooms work professionally to service custom orders. A sewing room is more of a space where one can sew, rather than a commercial setting where one can order fabric.
7. Choice E is a hardware store. A hardware store generally sells tools, hardware, and materials related to home improvement but not usually fabric. This option does not fit as a place where fabric is cut to order.
8. Therefore, the best fit according to the given options is B: tailor shop, as it is a place where fabric is indeed cut to customer orders.
So the final answer is B: tailor shop

Input: Where are you if your reading magazines while waiting for a vehicle on rails? Choices:  A: vegetables B: market C: doctor D: train station E: bookstore
Output: 1. The question asks where you are if you're waiting for a vehicle that is on rails.
2. We need to look for a place associated with a vehicle on rails among the choices.
3. The vehicles on rails are known as trains.
4. Trains are usually boarded at the stated place which is a train station.
5. So, the place where you are most likely waiting for a vehicle on rails is a train station.
6. Therefore, the answer is D: train station.
So the final answer is D: train station

Input: What would need oil to be used? Choices:  A: ground B: human  body C: repair shop D: combustion engines E: service station
Output: 1. The question requires us to identify which among the choices provided would typically need oil for its function or operation.
2. Let's break down each choice:
    A: Ground - The ground or soil does not require oil for its function. It is primarily composed of organic materials, minerals, water, and air. Oil spillage on the ground can actually cause environmental damage, so it's not the right answer.
    B: Human body - Our bodies use various fluids for functioning such as blood and body water, but not oil. While some people use oil-based products for skin care, humans don't typically require oil internally for their bodies to function. So this is also not the correct answer. 
    C: Repair shop - A repair shop is a place where various machinery and items are fixed or maintained. While it is likely to use oil in some of its functions, such as in the maintenance of machinery, oil is not integral or essential to the existence or operation of the shop itself.
    D: Combustion engines - These engines work on the principle of internal combustion where fuel (usually a mix of petrol and air) is burned inside the engine's combustion chamber to produce power. Oil plays a crucial role in this process for lubrication, cooling, and cleaning purposes. Therefore, combustion engines do need oil to function.
    E: Service station - Similar to a repair shop, a service station might use oil to service the vehicles, but oil is not explicitly necessary for a service station to function.
3. Hence, out of the provided options, the most fitting answer is D: combustion engines as they require oil to operate efficiently.
So the final answer is D: combustion engines

Input: What is person probably feeling that plans on stopping being married to their spouse? Choices:  A: detachment B: bankruptcy C: sad D: fights E: wrong
Output: 1. Let's examine the question: "What is a person probably feeling that plans on stopping being married to their spouse?" This statement refers to a person's emotional state in a situation where they are thinking of ending their marital relationship.
2. The options given are:  A: detachment B: bankruptcy C: sad D: fights E: wrong. We have to identify which among these choices represent an emotional state a person might experience in the given situation.
3. Option B: bankruptcy is generally associated with financial circumstances and doesn't easily tie in directly to emotional states. This makes it less likely.
4. Option D: fights refers to conflicts or disagreements, which are situations or causes of a feeling rather than an emotional state itself. So, this option is also less likely.
5. Option E: wrong is not typically an emotion, but rather a descriptor of incorrectness or inappropriateness, so it doesn't fit as an answer. 
6. Option C: sad is a relevant emotional state. However, someone planning to'stop being married' implies they have considered it to a point where they have made the decision themselves, which might suggest they aren't necessarily sad about this outcome but more resigned or detached.
7. The remaining option is A: detachment which is an emotional state where a person is distant or disconnected emotionally. This could be a very likely emotional state of someone who has come to the decision to end a marriage. They might be feeling emotionally distant or detached from their spouse.
8. Therefore, considering the reasoning above, the answer is A: detachment.
So the final answer is A: detachment

Input: What could you use to store a clock? Choices:  A: shelf B: own bedroom C: desk D: wall E: car
Output: 1. The question is asking where you could place a clock for storage or display.
2. Choice A is a shelf. A shelf is a flat horizontal plane which is used in homes, offices, etc. to hold items. It's common to place clocks on a shelf.
3. Choice B is your own bedroom. While you might place a clock in your bedroom, the bedroom itself is not a storage medium for a clock.
4. Choice C is a desk. Similar to a shelf, you might put a clock on a desk, but the question is asking for a specific location to store a clock, not a furniture item you might put it on.
5. Choice D is a wall. Though wall clocks are common, a wall is not a place for storing a clock, but rather a place for hanging it.
6. Choice E is a car. Although certain cars do have built-in clocks, you typically don't store a regular clock in a car.
7. Therefore, the most appropriate answer would be A: Shelf, because it is a specific location in which one might store a clock.
So the final answer is A: shelf

Input: The person put on lotion, what did they want? Choices:  A: fresh smell B: good credit C: smooth skin D: fresh produce E: headache
Output: Step 1: Clarify the options in each of the answer choices. A fresh smell could be associated with putting on lotion, but not necessarily. Good credit, fresh produce, and a headache have no logical connection with putting on lotion.
 
Step 2: Identify the key principle that the person is employing when putting on lotion. The main goal of this action is typically to moisturize the skin.

Step 3: Compare the goal found in step 2 with each of the answer choices. The choice that matches up best with this goal is the one that should be selected.

Step 4: Good credit, fresh produce and a headache are completely unrelated to the goal of moisturizing skin and thus are not correct. The Answer choice B, D and E can be eliminated.

Step 5: Considering fresh smell and smooth skin, it's important to remember that not all lotions give a fresh smell. The primary goal of lotion is to moisturize and make the skin smoother, not necessarily to smell good.

Step 6: Therefore, the most logical answer choice would be C: smooth skin.
So the final answer is C: smooth skin

Input: They burned the record, they were trying
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o8-tcommonsenseqa-s10-rTrue
Evaluating gsm8k :   1%|▋                                                                                  | 1/125 [00:24<49:39, 24.03s/it]Evaluating gsm8k :   2%|█▎                                                                                 | 2/125 [00:47<48:06, 23.46s/it]Evaluating gsm8k :   2%|█▉                                                                                 | 3/125 [01:10<47:20, 23.28s/it]Evaluating gsm8k :   3%|██▋                                                                                | 4/125 [01:33<46:46, 23.20s/it]Evaluating gsm8k :   4%|███▎                                                                               | 5/125 [01:56<46:15, 23.13s/it]Evaluating gsm8k :   5%|███▉                                                                               | 6/125 [02:19<45:52, 23.13s/it]Evaluating gsm8k :   6%|████▋                                                                              | 7/125 [02:42<45:24, 23.09s/it]Evaluating gsm8k :   6%|█████▎                                                                             | 8/125 [03:01<42:33, 21.83s/it]Evaluating gsm8k :   7%|█████▉                                                                             | 9/125 [03:24<42:59, 22.23s/it]Evaluating gsm8k :   8%|██████▌                                                                           | 10/125 [03:46<42:24, 22.13s/it]Evaluating gsm8k :   9%|███████▏                                                                          | 11/125 [04:07<41:10, 21.68s/it]Evaluating gsm8k :  10%|███████▊                                                                          | 12/125 [04:30<41:34, 22.08s/it]Evaluating gsm8k :  10%|████████▌                                                                         | 13/125 [04:53<41:47, 22.39s/it]Evaluating gsm8k :  11%|█████████▏                                                                        | 14/125 [05:16<41:46, 22.58s/it]Evaluating gsm8k :  12%|█████████▊                                                                        | 15/125 [05:39<41:38, 22.71s/it]Evaluating gsm8k :  13%|██████████▍                                                                       | 16/125 [06:02<41:28, 22.83s/it]Evaluating gsm8k :  14%|███████████▏                                                                      | 17/125 [06:25<41:13, 22.91s/it]Evaluating gsm8k :  14%|███████████▊                                                                      | 18/125 [06:48<40:58, 22.98s/it]Evaluating gsm8k :  15%|████████████▍                                                                     | 19/125 [07:11<40:37, 23.00s/it]Evaluating gsm8k :  16%|█████████████                                                                     | 20/125 [07:34<40:15, 23.00s/it]Evaluating gsm8k :  17%|█████████████▊                                                                    | 21/125 [07:57<39:55, 23.04s/it]Evaluating gsm8k :  18%|██████████████▍                                                                   | 22/125 [08:20<39:32, 23.04s/it]Evaluating gsm8k :  18%|███████████████                                                                   | 23/125 [08:40<37:36, 22.13s/it]Evaluating gsm8k :  19%|███████████████▋                                                                  | 24/125 [09:03<37:43, 22.41s/it]Evaluating gsm8k :  20%|████████████████▍                                                                 | 25/125 [09:27<37:42, 22.62s/it]Evaluating gsm8k :  21%|█████████████████                                                                 | 26/125 [09:50<37:33, 22.76s/it]Evaluating gsm8k :  22%|█████████████████▋                                                                | 27/125 [10:13<37:20, 22.86s/it]Evaluating gsm8k :  22%|██████████████████▎                                                               | 28/125 [10:29<33:46, 20.89s/it]Evaluating gsm8k :  23%|███████████████████                                                               | 29/125 [10:52<34:28, 21.55s/it]Evaluating gsm8k :  24%|███████████████████▋                                                              | 30/125 [11:08<31:20, 19.79s/it]Evaluating gsm8k :  25%|████████████████████▎                                                             | 31/125 [11:31<32:48, 20.94s/it]Evaluating gsm8k :  26%|████████████████████▉                                                             | 32/125 [11:55<33:27, 21.58s/it]Evaluating gsm8k :  26%|█████████████████████▋                                                            | 33/125 [12:16<33:07, 21.61s/it]Evaluating gsm8k :  27%|██████████████████████▎                                                           | 34/125 [12:39<33:26, 22.05s/it]Evaluating gsm8k :  28%|██████████████████████▉                                                           | 35/125 [13:02<33:29, 22.33s/it]Evaluating gsm8k :  29%|███████████████████████▌                                                          | 36/125 [13:25<33:27, 22.55s/it]Evaluating gsm8k :  30%|████████████████████████▎                                                         | 37/125 [13:49<33:25, 22.79s/it]Evaluating gsm8k :  30%|████████████████████████▉                                                         | 38/125 [14:12<33:16, 22.95s/it]Evaluating gsm8k :  31%|█████████████████████████▌                                                        | 39/125 [14:35<32:57, 23.00s/it]Evaluating gsm8k :  32%|██████████████████████████▏                                                       | 40/125 [14:58<32:38, 23.04s/it]Evaluating gsm8k :  33%|██████████████████████████▉                                                       | 41/125 [15:21<32:18, 23.08s/it]Evaluating gsm8k :  34%|███████████████████████████▌                                                      | 42/125 [15:45<31:56, 23.09s/it]Evaluating gsm8k :  34%|████████████████████████████▏                                                     | 43/125 [16:08<31:34, 23.10s/it]Evaluating gsm8k :  35%|████████████████████████████▊                                                     | 44/125 [16:31<31:11, 23.10s/it]Evaluating gsm8k :  36%|█████████████████████████████▌                                                    | 45/125 [16:54<30:47, 23.10s/it]Evaluating gsm8k :  37%|██████████████████████████████▏                                                   | 46/125 [17:17<30:24, 23.10s/it]Evaluating gsm8k :  38%|██████████████████████████████▊                                                   | 47/125 [17:40<30:02, 23.10s/it]Evaluating gsm8k :  38%|███████████████████████████████▍                                                  | 48/125 [18:03<29:37, 23.09s/it]Evaluating gsm8k :  39%|████████████████████████████████▏                                                 | 49/125 [18:26<29:14, 23.09s/it]Evaluating gsm8k :  40%|████████████████████████████████▊                                                 | 50/125 [18:49<28:53, 23.12s/it]Evaluating gsm8k :  41%|█████████████████████████████████▍                                                | 51/125 [19:12<28:29, 23.11s/it]Evaluating gsm8k :  42%|██████████████████████████████████                                                | 52/125 [19:36<28:07, 23.12s/it]Evaluating gsm8k :  42%|██████████████████████████████████▊                                               | 53/125 [19:59<27:43, 23.11s/it]Evaluating gsm8k :  43%|███████████████████████████████████▍                                              | 54/125 [20:22<27:21, 23.12s/it]Evaluating gsm8k :  44%|████████████████████████████████████                                              | 55/125 [20:45<26:57, 23.11s/it]Evaluating gsm8k :  45%|████████████████████████████████████▋                                             | 56/125 [21:08<26:33, 23.09s/it]Evaluating gsm8k :  46%|█████████████████████████████████████▍                                            | 57/125 [21:31<26:11, 23.10s/it]Evaluating gsm8k :  46%|██████████████████████████████████████                                            | 58/125 [21:54<25:48, 23.11s/it]Evaluating gsm8k :  47%|██████████████████████████████████████▋                                           | 59/125 [22:17<25:24, 23.11s/it]Evaluating gsm8k :  48%|███████████████████████████████████████▎                                          | 60/125 [22:40<25:03, 23.12s/it]Evaluating gsm8k :  49%|████████████████████████████████████████                                          | 61/125 [23:04<24:38, 23.10s/it]Evaluating gsm8k :  50%|████████████████████████████████████████▋                                         | 62/125 [23:27<24:16, 23.11s/it]Evaluating gsm8k :  50%|█████████████████████████████████████████▎                                        | 63/125 [23:50<23:53, 23.13s/it]Evaluating gsm8k :  51%|█████████████████████████████████████████▉                                        | 64/125 [24:13<23:30, 23.12s/it]Evaluating gsm8k :  52%|██████████████████████████████████████████▋                                       | 65/125 [24:36<23:07, 23.13s/it]Evaluating gsm8k :  53%|███████████████████████████████████████████▎                                      | 66/125 [24:59<22:45, 23.15s/it]Evaluating gsm8k :  54%|███████████████████████████████████████████▉                                      | 67/125 [25:22<22:20, 23.11s/it]Evaluating gsm8k :  54%|████████████████████████████████████████████▌                                     | 68/125 [25:45<21:56, 23.10s/it]Evaluating gsm8k :  55%|█████████████████████████████████████████████▎                                    | 69/125 [26:08<21:33, 23.10s/it]Evaluating gsm8k :  56%|█████████████████████████████████████████████▉                                    | 70/125 [26:31<21:08, 23.06s/it]Evaluating gsm8k :  57%|██████████████████████████████████████████████▌                                   | 71/125 [26:55<20:48, 23.11s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▏                                  | 72/125 [27:18<20:23, 23.08s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▉                                  | 73/125 [27:41<20:00, 23.08s/it]Evaluating gsm8k :  59%|████████████████████████████████████████████████▌                                 | 74/125 [28:04<19:38, 23.11s/it]Evaluating gsm8k :  60%|█████████████████████████████████████████████████▏                                | 75/125 [28:16<16:33, 19.87s/it]Evaluating gsm8k :  61%|█████████████████████████████████████████████████▊                                | 76/125 [28:39<17:00, 20.83s/it]Evaluating gsm8k :  62%|██████████████████████████████████████████████████▌                               | 77/125 [29:02<17:12, 21.52s/it]Evaluating gsm8k :  62%|███████████████████████████████████████████████████▏                              | 78/125 [29:26<17:14, 22.01s/it]Evaluating gsm8k :  63%|███████████████████████████████████████████████████▊                              | 79/125 [29:49<17:06, 22.32s/it]Evaluating gsm8k :  64%|████████████████████████████████████████████████████▍                             | 80/125 [30:12<16:54, 22.54s/it]Evaluating gsm8k :  65%|█████████████████████████████████████████████████████▏                            | 81/125 [30:35<16:39, 22.71s/it]Evaluating gsm8k :  66%|█████████████████████████████████████████████████████▊                            | 82/125 [30:58<16:22, 22.85s/it]Evaluating gsm8k :  66%|██████████████████████████████████████████████████████▍                           | 83/125 [31:20<15:43, 22.47s/it]Evaluating gsm8k :  67%|███████████████████████████████████████████████████████                           | 84/125 [31:43<15:29, 22.66s/it]Evaluating gsm8k :  68%|███████████████████████████████████████████████████████▊                          | 85/125 [32:06<15:12, 22.82s/it]Evaluating gsm8k :  69%|████████████████████████████████████████████████████████▍                         | 86/125 [32:29<14:52, 22.90s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████                         | 87/125 [32:52<14:31, 22.94s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████▋                        | 88/125 [33:15<14:11, 23.00s/it]Evaluating gsm8k :  71%|██████████████████████████████████████████████████████████▍                       | 89/125 [33:38<13:48, 23.01s/it]Evaluating gsm8k :  72%|███████████████████████████████████████████████████████████                       | 90/125 [34:01<13:26, 23.05s/it]Evaluating gsm8k :  73%|███████████████████████████████████████████████████████████▋                      | 91/125 [34:24<13:03, 23.06s/it]Evaluating gsm8k :  74%|████████████████████████████████████████████████████████████▎                     | 92/125 [34:48<12:41, 23.09s/it]Evaluating gsm8k :  74%|█████████████████████████████████████████████████████████████                     | 93/125 [35:11<12:18, 23.09s/it]Evaluating gsm8k :  75%|█████████████████████████████████████████████████████████████▋                    | 94/125 [35:34<11:56, 23.11s/it]Evaluating gsm8k :  76%|██████████████████████████████████████████████████████████████▎                   | 95/125 [35:57<11:32, 23.08s/it]Evaluating gsm8k :  77%|██████████████████████████████████████████████████████████████▉                   | 96/125 [36:20<11:09, 23.10s/it]Evaluating gsm8k :  78%|███████████████████████████████████████████████████████████████▋                  | 97/125 [36:43<10:46, 23.10s/it]Evaluating gsm8k :  78%|████████████████████████████████████████████████████████████████▎                 | 98/125 [37:06<10:23, 23.10s/it]Evaluating gsm8k :  79%|████████████████████████████████████████████████████████████████▉                 | 99/125 [37:29<10:01, 23.12s/it]Evaluating gsm8k :  80%|████████████████████████████████████████████████████████████████▊                | 100/125 [37:52<09:37, 23.10s/it]Evaluating gsm8k :  81%|█████████████████████████████████████████████████████████████████▍               | 101/125 [38:16<09:15, 23.14s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████               | 102/125 [38:39<08:51, 23.12s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████▋              | 103/125 [39:02<08:28, 23.11s/it]Evaluating gsm8k :  83%|███████████████████████████████████████████████████████████████████▍             | 104/125 [39:25<08:05, 23.13s/it]Evaluating gsm8k :  84%|████████████████████████████████████████████████████████████████████             | 105/125 [39:48<07:42, 23.11s/it]Evaluating gsm8k :  85%|████████████████████████████████████████████████████████████████████▋            | 106/125 [40:11<07:18, 23.10s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▎           | 107/125 [40:34<06:56, 23.11s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▉           | 108/125 [40:57<06:33, 23.15s/it]Evaluating gsm8k :  87%|██████████████████████████████████████████████████████████████████████▋          | 109/125 [41:21<06:09, 23.12s/it]Evaluating gsm8k :  88%|███████████████████████████████████████████████████████████████████████▎         | 110/125 [41:43<05:42, 22.83s/it]Evaluating gsm8k :  89%|███████████████████████████████████████████████████████████████████████▉         | 111/125 [42:06<05:20, 22.91s/it]Evaluating gsm8k :  90%|████████████████████████████████████████████████████████████████████████▌        | 112/125 [42:29<04:58, 22.97s/it]Evaluating gsm8k :  90%|█████████████████████████████████████████████████████████████████████████▏       | 113/125 [42:52<04:36, 23.00s/it]Evaluating gsm8k :  91%|█████████████████████████████████████████████████████████████████████████▊       | 114/125 [43:15<04:13, 23.03s/it]Evaluating gsm8k :  92%|██████████████████████████████████████████████████████████████████████████▌      | 115/125 [43:38<03:50, 23.07s/it]Evaluating gsm8k :  93%|███████████████████████████████████████████████████████████████████████████▏     | 116/125 [44:01<03:28, 23.12s/it]Evaluating gsm8k :  94%|███████████████████████████████████████████████████████████████████████████▊     | 117/125 [44:24<03:04, 23.07s/it]Evaluating gsm8k :  94%|████████████████████████████████████████████████████████████████████████████▍    | 118/125 [44:48<02:41, 23.10s/it]Evaluating gsm8k :  95%|█████████████████████████████████████████████████████████████████████████████    | 119/125 [45:11<02:18, 23.08s/it]Evaluating gsm8k :  96%|█████████████████████████████████████████████████████████████████████████████▊   | 120/125 [45:34<01:55, 23.09s/it]Evaluating gsm8k :  97%|██████████████████████████████████████████████████████████████████████████████▍  | 121/125 [45:57<01:32, 23.08s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████  | 122/125 [46:20<01:09, 23.10s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████▋ | 123/125 [46:43<00:46, 23.13s/it]Evaluating gsm8k :  99%|████████████████████████████████████████████████████████████████████████████████▎| 124/125 [47:06<00:23, 23.12s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [47:29<00:00, 23.11s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [47:29<00:00, 22.80s/it]
name: gsm8k | {'exact_match': 0.0, 'rougeL': 0.0435} | lm_loss 11.3306 | avg. gen lenth: 440.292
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name gsm8k --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name commonsenseqa --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 2 --data-dir /scratch/ylu130/processed_data/gsm8k/out-domain/o9-tcommonsenseqa-s10-rTrue --seed 10 --max-prompt-length 2048 --rationales --num-out-domain 9
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date![nltk_data]   Package punkt is already up-to-date!

[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-18 09:57:45,430] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... gsm8k
  data_dir ..................... /scratch/ylu130/processed_data/gsm8k/out-domain/o9-tcommonsenseqa-s10-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 9
  out_domain_data_name ......... commonsenseqa
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o9-tcommonsenseqa-s10-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 2
  clip_grad .................... 1.0
  seed ......................... 10
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                                             | 0/7473 [00:00<?, ?it/s]  0%|                                                                                                     | 9/7473 [00:00<01:28, 84.70it/s]  0%|▏                                                                                                   | 18/7473 [00:00<01:27, 84.97it/s]  0%|▎                                                                                                   | 27/7473 [00:00<01:27, 84.84it/s]  0%|▍                                                                                                   | 36/7473 [00:00<01:27, 84.78it/s]  1%|▌                                                                                                   | 45/7473 [00:00<01:27, 84.97it/s]  1%|▋                                                                                                   | 54/7473 [00:00<01:28, 83.69it/s]  1%|▊                                                                                                   | 63/7473 [00:00<01:28, 83.94it/s]  1%|▉                                                                                                   | 72/7473 [00:00<01:27, 84.42it/s]  1%|█                                                                                                   | 81/7473 [00:00<01:27, 84.66it/s]  1%|█▏                                                                                                  | 90/7473 [00:01<01:26, 84.86it/s]  1%|█▎                                                                                                  | 99/7473 [00:01<01:26, 84.84it/s]  1%|█▍                                                                                                 | 108/7473 [00:01<01:26, 84.88it/s]  2%|█▌                                                                                                 | 117/7473 [00:01<01:26, 84.90it/s]  2%|█▋                                                                                                 | 126/7473 [00:01<01:26, 84.98it/s]  2%|█▊                                                                                                 | 135/7473 [00:01<01:26, 85.09it/s]  2%|█▉                                                                                                 | 144/7473 [00:01<01:27, 84.01it/s]  2%|██                                                                                                 | 153/7473 [00:01<01:26, 84.24it/s]  2%|██▏                                                                                                | 162/7473 [00:01<01:26, 84.63it/s]  2%|██▎                                                                                                | 175/7473 [00:02<01:15, 96.14it/s]  3%|██▍                                                                                               | 188/7473 [00:02<01:09, 105.51it/s]  3%|██▋                                                                                               | 202/7473 [00:02<01:04, 113.13it/s]  3%|██▊                                                                                               | 214/7473 [00:02<01:05, 110.78it/s]  3%|██▉                                                                                               | 226/7473 [00:02<01:11, 101.40it/s]  3%|███▏                                                                                               | 237/7473 [00:02<01:15, 96.12it/s]  3%|███▎                                                                                               | 247/7473 [00:02<01:17, 92.74it/s]  3%|███▍                                                                                               | 257/7473 [00:02<01:21, 88.69it/s]  4%|███▌                                                                                               | 266/7473 [00:02<01:21, 87.91it/s]  4%|███▋                                                                                               | 275/7473 [00:03<01:22, 87.12it/s]  4%|███▊                                                                                               | 284/7473 [00:03<01:23, 86.61it/s]  4%|███▉                                                                                               | 293/7473 [00:03<01:23, 86.11it/s]  4%|████                                                                                               | 302/7473 [00:03<01:23, 85.89it/s]  4%|████                                                                                               | 311/7473 [00:03<01:23, 85.71it/s]  4%|████▏                                                                                              | 320/7473 [00:03<01:23, 85.77it/s]  4%|████▎                                                                                              | 329/7473 [00:03<01:23, 85.39it/s]  5%|████▍                                                                                              | 338/7473 [00:03<01:23, 85.22it/s]  5%|████▌                                                                                              | 347/7473 [00:03<01:23, 85.30it/s]  5%|████▋                                                                                              | 356/7473 [00:04<01:23, 85.25it/s]  5%|████▊                                                                                              | 365/7473 [00:04<01:23, 84.92it/s]  5%|█████                                                                                              | 378/7473 [00:04<01:13, 96.13it/s]  5%|█████▏                                                                                            | 392/7473 [00:04<01:06, 106.37it/s]  5%|█████▎                                                                                            | 405/7473 [00:04<01:02, 112.93it/s]  6%|█████▍                                                                                            | 418/7473 [00:04<00:59, 117.82it/s]  6%|█████▋                                                                                            | 431/7473 [00:04<00:58, 121.09it/s]  6%|█████▊                                                                                            | 444/7473 [00:04<00:56, 123.62it/s]  6%|██████                                                                                            | 458/7473 [00:04<00:55, 125.70it/s]  6%|██████▏                                                                                           | 471/7473 [00:04<00:55, 126.84it/s]  6%|██████▎                                                                                           | 484/7473 [00:05<00:55, 126.16it/s]  7%|██████▌                                                                                           | 497/7473 [00:05<00:54, 127.13it/s]  7%|██████▋                                                                                           | 510/7473 [00:05<00:54, 127.96it/s]  7%|██████▊                                                                                           | 524/7473 [00:05<00:53, 128.73it/s]  7%|███████                                                                                           | 538/7473 [00:05<00:53, 129.31it/s]  7%|███████▏                                                                                          | 551/7473 [00:05<00:53, 129.30it/s]  8%|███████▍                                                                                          | 564/7473 [00:05<00:53, 129.46it/s]  8%|███████▌                                                                                          | 577/7473 [00:05<00:53, 129.49it/s]  8%|███████▋                                                                                          | 590/7473 [00:05<00:53, 129.48it/s]  8%|███████▉                                                                                          | 603/7473 [00:05<00:53, 129.46it/s]  8%|████████                                                                                          | 617/7473 [00:06<00:52, 129.59it/s]  8%|████████▎                                                                                         | 630/7473 [00:06<00:52, 129.60it/s]  9%|████████▍                                                                                         | 643/7473 [00:06<00:52, 129.58it/s]  9%|████████▌                                                                                         | 656/7473 [00:06<00:52, 129.60it/s]  9%|████████▊                                                                                         | 670/7473 [00:06<00:52, 129.89it/s]  9%|████████▉                                                                                         | 684/7473 [00:06<00:52, 130.04it/s]  9%|█████████▏                                                                                        | 698/7473 [00:06<00:52, 130.11it/s] 10%|█████████▎                                                                                        | 712/7473 [00:06<00:52, 128.71it/s] 10%|█████████▌                                                                                        | 725/7473 [00:06<00:52, 128.38it/s] 10%|█████████▋                                                                                        | 739/7473 [00:07<00:52, 128.88it/s] 10%|█████████▊                                                                                        | 753/7473 [00:07<00:51, 129.41it/s] 10%|██████████                                                                                        | 766/7473 [00:07<00:51, 129.28it/s] 10%|██████████▏                                                                                       | 779/7473 [00:07<00:51, 129.36it/s] 11%|██████████▍                                                                                       | 792/7473 [00:07<00:51, 129.51it/s] 11%|██████████▌                                                                                       | 805/7473 [00:07<00:51, 129.45it/s] 11%|██████████▋                                                                                       | 819/7473 [00:07<00:51, 129.56it/s] 11%|██████████▉                                                                                       | 832/7473 [00:07<00:51, 129.66it/s] 11%|███████████                                                                                       | 846/7473 [00:07<00:51, 129.80it/s] 12%|███████████▎                                                                                      | 860/7473 [00:07<00:50, 129.89it/s] 12%|███████████▍                                                                                      | 873/7473 [00:08<00:50, 129.74it/s] 12%|███████████▌                                                                                      | 886/7473 [00:08<00:50, 129.67it/s] 12%|███████████▊                                                                                      | 899/7473 [00:08<00:51, 128.23it/s] 12%|███████████▉                                                                                      | 913/7473 [00:08<00:50, 128.86it/s] 12%|████████████▏                                                                                     | 926/7473 [00:08<00:50, 128.97it/s] 13%|████████████▎                                                                                     | 939/7473 [00:08<00:51, 126.37it/s] 13%|████████████▍                                                                                     | 953/7473 [00:08<00:51, 127.53it/s] 13%|████████████▋                                                                                     | 967/7473 [00:08<00:50, 128.36it/s] 13%|████████████▊                                                                                     | 981/7473 [00:08<00:50, 128.96it/s] 13%|█████████████                                                                                     | 994/7473 [00:08<00:50, 129.16it/s] 13%|█████████████                                                                                    | 1007/7473 [00:09<00:50, 129.11it/s] 14%|█████████████▏                                                                                   | 1020/7473 [00:09<00:49, 129.34it/s] 14%|█████████████▍                                                                                   | 1033/7473 [00:09<00:49, 129.49it/s] 14%|█████████████▌                                                                                   | 1046/7473 [00:09<00:49, 129.56it/s] 14%|█████████████▋                                                                                   | 1059/7473 [00:09<00:49, 129.54it/s] 14%|█████████████▉                                                                                   | 1072/7473 [00:09<00:49, 129.21it/s] 15%|██████████████                                                                                   | 1085/7473 [00:09<00:49, 129.40it/s] 15%|██████████████▎                                                                                  | 1098/7473 [00:09<00:49, 129.41it/s] 15%|██████████████▍                                                                                  | 1111/7473 [00:09<00:49, 129.40it/s] 15%|██████████████▌                                                                                  | 1124/7473 [00:10<00:49, 129.51it/s] 15%|██████████████▊                                                                                  | 1137/7473 [00:10<00:48, 129.52it/s] 15%|██████████████▉                                                                                  | 1150/7473 [00:10<00:48, 129.63it/s] 16%|███████████████                                                                                  | 1163/7473 [00:10<00:49, 127.77it/s] 16%|███████████████▎                                                                                 | 1176/7473 [00:10<00:49, 128.27it/s] 16%|███████████████▍                                                                                 | 1189/7473 [00:10<00:48, 128.61it/s] 16%|███████████████▌                                                                                 | 1203/7473 [00:10<00:48, 128.99it/s] 16%|███████████████▊                                                                                 | 1217/7473 [00:10<00:48, 129.46it/s] 16%|███████████████▉                                                                                 | 1230/7473 [00:10<00:48, 128.62it/s] 17%|████████████████▏                                                                                | 1243/7473 [00:10<00:48, 129.02it/s] 17%|████████████████▎                                                                                | 1257/7473 [00:11<00:48, 129.43it/s] 17%|████████████████▍                                                                                | 1271/7473 [00:11<00:47, 129.65it/s] 17%|████████████████▋                                                                                | 1284/7473 [00:11<00:47, 129.67it/s] 17%|████████████████▊                                                                                | 1298/7473 [00:11<00:47, 129.89it/s] 18%|█████████████████                                                                                | 1311/7473 [00:11<00:47, 129.92it/s] 18%|█████████████████▏                                                                               | 1325/7473 [00:11<00:47, 130.25it/s] 18%|█████████████████▍                                                                               | 1339/7473 [00:11<00:47, 130.22it/s] 18%|█████████████████▌                                                                               | 1353/7473 [00:11<00:47, 130.04it/s] 18%|█████████████████▋                                                                               | 1367/7473 [00:11<00:46, 130.16it/s] 18%|█████████████████▉                                                                               | 1381/7473 [00:11<00:46, 129.90it/s] 19%|██████████████████                                                                               | 1394/7473 [00:12<00:47, 128.32it/s] 19%|██████████████████▎                                                                              | 1407/7473 [00:12<00:47, 128.74it/s] 19%|██████████████████▍                                                                              | 1420/7473 [00:12<00:46, 129.05it/s] 19%|██████████████████▌                                                                              | 1434/7473 [00:12<00:46, 129.43it/s] 19%|██████████████████▊                                                                              | 1447/7473 [00:12<00:46, 129.47it/s] 20%|██████████████████▉                                                                              | 1461/7473 [00:12<00:46, 129.73it/s] 20%|███████████████████▏                                                                             | 1475/7473 [00:12<00:46, 129.85it/s] 20%|███████████████████▎                                                                             | 1488/7473 [00:12<00:46, 129.82it/s] 20%|███████████████████▍                                                                             | 1501/7473 [00:12<00:46, 129.71it/s] 20%|███████████████████▋                                                                             | 1515/7473 [00:13<00:45, 129.94it/s] 20%|███████████████████▊                                                                             | 1529/7473 [00:13<00:45, 130.08it/s] 21%|████████████████████                                                                             | 1543/7473 [00:13<00:45, 129.90it/s] 21%|████████████████████▏                                                                            | 1556/7473 [00:13<00:45, 129.37it/s] 21%|████████████████████▎                                                                            | 1569/7473 [00:13<00:45, 129.38it/s] 21%|████████████████████▌                                                                            | 1582/7473 [00:13<00:45, 129.39it/s] 21%|████████████████████▋                                                                            | 1595/7473 [00:13<00:45, 129.36it/s] 22%|████████████████████▊                                                                            | 1608/7473 [00:13<00:45, 129.49it/s] 22%|█████████████████████                                                                            | 1621/7473 [00:13<00:45, 127.73it/s] 22%|█████████████████████▏                                                                           | 1635/7473 [00:13<00:45, 128.62it/s] 22%|█████████████████████▍                                                                           | 1648/7473 [00:14<00:45, 128.78it/s] 22%|█████████████████████▌                                                                           | 1661/7473 [00:14<00:45, 129.08it/s] 22%|█████████████████████▋                                                                           | 1675/7473 [00:14<00:44, 129.60it/s] 23%|█████████████████████▉                                                                           | 1689/7473 [00:14<00:44, 129.89it/s] 23%|██████████████████████                                                                           | 1702/7473 [00:14<00:44, 129.53it/s] 23%|██████████████████████▎                                                                          | 1715/7473 [00:14<00:44, 129.54it/s] 23%|██████████████████████▍                                                                          | 1729/7473 [00:14<00:44, 129.96it/s] 23%|██████████████████████▌                                                                          | 1742/7473 [00:14<00:44, 129.80it/s] 23%|██████████████████████▊                                                                          | 1756/7473 [00:14<00:44, 129.91it/s] 24%|██████████████████████▉                                                                          | 1769/7473 [00:14<00:44, 129.60it/s] 24%|███████████████████████▏                                                                         | 1782/7473 [00:15<00:43, 129.64it/s] 24%|███████████████████████▎                                                                         | 1796/7473 [00:15<00:43, 129.70it/s] 24%|███████████████████████▍                                                                         | 1810/7473 [00:15<00:43, 129.90it/s] 24%|███████████████████████▋                                                                         | 1823/7473 [00:15<00:43, 129.51it/s] 25%|███████████████████████▊                                                                         | 1836/7473 [00:15<00:43, 129.37it/s] 25%|████████████████████████                                                                         | 1849/7473 [00:15<00:43, 128.04it/s] 25%|████████████████████████▏                                                                        | 1863/7473 [00:15<00:43, 128.76it/s] 25%|████████████████████████▎                                                                        | 1877/7473 [00:15<00:43, 129.08it/s] 25%|████████████████████████▌                                                                        | 1890/7473 [00:15<00:43, 129.27it/s] 25%|████████████████████████▋                                                                        | 1903/7473 [00:16<00:43, 129.40it/s] 26%|████████████████████████▉                                                                        | 1917/7473 [00:16<00:42, 129.61it/s] 26%|█████████████████████████                                                                        | 1931/7473 [00:16<00:42, 129.86it/s] 26%|█████████████████████████▏                                                                       | 1944/7473 [00:16<00:42, 129.11it/s] 26%|█████████████████████████▍                                                                       | 1958/7473 [00:16<00:42, 129.59it/s] 26%|█████████████████████████▌                                                                       | 1972/7473 [00:16<00:42, 129.85it/s] 27%|█████████████████████████▊                                                                       | 1986/7473 [00:16<00:42, 130.13it/s] 27%|█████████████████████████▉                                                                       | 2000/7473 [00:16<00:42, 130.04it/s] 27%|██████████████████████████▏                                                                      | 2014/7473 [00:16<00:41, 130.12it/s] 27%|██████████████████████████▎                                                                      | 2028/7473 [00:16<00:41, 130.30it/s] 27%|██████████████████████████▌                                                                      | 2042/7473 [00:17<00:41, 130.17it/s] 28%|██████████████████████████▋                                                                      | 2056/7473 [00:17<00:41, 130.23it/s] 28%|██████████████████████████▊                                                                      | 2070/7473 [00:17<00:42, 128.51it/s] 28%|███████████████████████████                                                                      | 2084/7473 [00:17<00:41, 129.14it/s] 28%|███████████████████████████▏                                                                     | 2098/7473 [00:17<00:41, 129.66it/s] 28%|███████████████████████████▍                                                                     | 2111/7473 [00:17<00:41, 129.62it/s] 28%|███████████████████████████▌                                                                     | 2124/7473 [00:17<00:41, 129.39it/s] 29%|███████████████████████████▊                                                                     | 2138/7473 [00:17<00:41, 129.77it/s] 29%|███████████████████████████▉                                                                     | 2152/7473 [00:17<00:40, 130.16it/s] 29%|████████████████████████████                                                                     | 2166/7473 [00:18<00:41, 129.09it/s] 29%|████████████████████████████▎                                                                    | 2180/7473 [00:18<00:40, 129.41it/s] 29%|████████████████████████████▍                                                                    | 2194/7473 [00:18<00:40, 129.62it/s] 30%|████████████████████████████▋                                                                    | 2208/7473 [00:18<00:40, 130.09it/s] 30%|████████████████████████████▊                                                                    | 2222/7473 [00:18<00:40, 130.20it/s] 30%|█████████████████████████████                                                                    | 2236/7473 [00:18<00:40, 130.16it/s] 30%|█████████████████████████████▏                                                                   | 2250/7473 [00:18<00:40, 130.05it/s] 30%|█████████████████████████████▍                                                                   | 2264/7473 [00:18<00:39, 130.31it/s] 30%|█████████████████████████████▌                                                                   | 2278/7473 [00:18<00:39, 130.05it/s] 31%|█████████████████████████████▊                                                                   | 2292/7473 [00:19<00:40, 128.76it/s] 31%|█████████████████████████████▉                                                                   | 2306/7473 [00:19<00:39, 129.26it/s] 31%|██████████████████████████████                                                                   | 2320/7473 [00:19<00:39, 129.60it/s] 31%|██████████████████████████████▎                                                                  | 2334/7473 [00:19<00:39, 129.89it/s] 31%|██████████████████████████████▍                                                                  | 2347/7473 [00:19<00:39, 129.82it/s] 32%|██████████████████████████████▋                                                                  | 2361/7473 [00:19<00:39, 130.06it/s] 32%|██████████████████████████████▊                                                                  | 2375/7473 [00:19<00:39, 129.05it/s] 32%|███████████████████████████████                                                                  | 2389/7473 [00:19<00:39, 129.46it/s] 32%|███████████████████████████████▏                                                                 | 2403/7473 [00:19<00:39, 129.90it/s] 32%|███████████████████████████████▎                                                                 | 2417/7473 [00:19<00:38, 130.08it/s] 33%|███████████████████████████████▌                                                                 | 2431/7473 [00:20<00:38, 130.36it/s] 33%|███████████████████████████████▋                                                                 | 2445/7473 [00:20<00:38, 130.43it/s] 33%|███████████████████████████████▉                                                                 | 2459/7473 [00:20<00:38, 130.50it/s] 33%|████████████████████████████████                                                                 | 2473/7473 [00:20<00:38, 130.39it/s] 33%|████████████████████████████████▎                                                                | 2487/7473 [00:20<00:38, 129.99it/s] 33%|████████████████████████████████▍                                                                | 2500/7473 [00:20<00:38, 129.86it/s] 34%|████████████████████████████████▋                                                                | 2514/7473 [00:20<00:38, 130.04it/s] 34%|████████████████████████████████▊                                                                | 2528/7473 [00:20<00:45, 109.79it/s] 34%|████████████████████████████████▉                                                                | 2542/7473 [00:21<00:42, 115.21it/s] 34%|█████████████████████████████████▏                                                               | 2556/7473 [00:21<00:41, 119.46it/s] 34%|█████████████████████████████████▎                                                               | 2570/7473 [00:21<00:39, 122.89it/s] 35%|█████████████████████████████████▌                                                               | 2584/7473 [00:21<00:39, 125.18it/s] 35%|█████████████████████████████████▋                                                               | 2597/7473 [00:21<00:38, 125.26it/s] 35%|█████████████████████████████████▉                                                               | 2611/7473 [00:21<00:38, 126.96it/s] 35%|██████████████████████████████████                                                               | 2625/7473 [00:21<00:37, 128.05it/s] 35%|██████████████████████████████████▎                                                              | 2639/7473 [00:21<00:37, 128.73it/s] 36%|██████████████████████████████████▍                                                              | 2653/7473 [00:21<00:37, 129.30it/s] 36%|██████████████████████████████████▌                                                              | 2667/7473 [00:21<00:37, 129.86it/s] 36%|██████████████████████████████████▊                                                              | 2681/7473 [00:22<00:36, 130.06it/s] 36%|██████████████████████████████████▉                                                              | 2695/7473 [00:22<00:36, 130.32it/s] 36%|███████████████████████████████████▏                                                             | 2709/7473 [00:22<00:36, 129.93it/s] 36%|███████████████████████████████████▎                                                             | 2723/7473 [00:22<00:36, 130.12it/s] 37%|███████████████████████████████████▌                                                             | 2737/7473 [00:22<00:36, 130.16it/s] 37%|███████████████████████████████████▋                                                             | 2751/7473 [00:22<00:36, 128.18it/s] 37%|███████████████████████████████████▉                                                             | 2764/7473 [00:22<00:36, 128.69it/s] 37%|████████████████████████████████████                                                             | 2778/7473 [00:22<00:36, 129.33it/s] 37%|████████████████████████████████████▏                                                            | 2792/7473 [00:22<00:36, 129.74it/s] 38%|████████████████████████████████████▍                                                            | 2806/7473 [00:23<00:35, 130.13it/s] 38%|████████████████████████████████████▌                                                            | 2820/7473 [00:23<00:36, 128.51it/s] 38%|████████████████████████████████████▊                                                            | 2834/7473 [00:23<00:35, 129.31it/s] 38%|████████████████████████████████████▉                                                            | 2848/7473 [00:23<00:35, 129.71it/s] 38%|█████████████████████████████████████▏                                                           | 2862/7473 [00:23<00:35, 129.85it/s] 38%|█████████████████████████████████████▎                                                           | 2875/7473 [00:23<00:35, 129.74it/s] 39%|█████████████████████████████████████▍                                                           | 2889/7473 [00:23<00:35, 130.09it/s] 39%|█████████████████████████████████████▋                                                           | 2903/7473 [00:23<00:35, 130.36it/s] 39%|█████████████████████████████████████▊                                                           | 2917/7473 [00:23<00:34, 130.55it/s] 39%|██████████████████████████████████████                                                           | 2931/7473 [00:24<00:35, 129.66it/s] 39%|██████████████████████████████████████▏                                                          | 2945/7473 [00:24<00:34, 130.08it/s] 40%|██████████████████████████████████████▍                                                          | 2959/7473 [00:24<00:34, 130.37it/s] 40%|██████████████████████████████████████▌                                                          | 2973/7473 [00:24<00:34, 129.07it/s] 40%|██████████████████████████████████████▊                                                          | 2987/7473 [00:24<00:34, 129.52it/s] 40%|██████████████████████████████████████▉                                                          | 3000/7473 [00:24<00:34, 129.56it/s] 40%|███████████████████████████████████████                                                          | 3014/7473 [00:24<00:34, 129.93it/s] 41%|███████████████████████████████████████▎                                                         | 3028/7473 [00:24<00:34, 129.95it/s] 41%|███████████████████████████████████████▍                                                         | 3042/7473 [00:24<00:34, 130.02it/s] 41%|███████████████████████████████████████▋                                                         | 3056/7473 [00:24<00:33, 130.23it/s] 41%|███████████████████████████████████████▊                                                         | 3070/7473 [00:25<00:33, 130.02it/s] 41%|████████████████████████████████████████                                                         | 3084/7473 [00:25<00:33, 129.95it/s] 41%|████████████████████████████████████████▏                                                        | 3097/7473 [00:25<00:33, 129.46it/s] 42%|████████████████████████████████████████▎                                                        | 3110/7473 [00:25<00:33, 129.34it/s] 42%|████████████████████████████████████████▌                                                        | 3123/7473 [00:25<00:33, 129.45it/s] 42%|████████████████████████████████████████▋                                                        | 3136/7473 [00:25<00:33, 129.55it/s] 42%|████████████████████████████████████████▊                                                        | 3149/7473 [00:25<00:33, 129.67it/s] 42%|█████████████████████████████████████████                                                        | 3162/7473 [00:25<00:33, 128.90it/s] 42%|█████████████████████████████████████████▏                                                       | 3176/7473 [00:25<00:33, 129.42it/s] 43%|█████████████████████████████████████████▍                                                       | 3190/7473 [00:26<00:33, 129.71it/s] 43%|█████████████████████████████████████████▌                                                       | 3203/7473 [00:26<00:33, 128.39it/s] 43%|█████████████████████████████████████████▊                                                       | 3217/7473 [00:26<00:32, 129.24it/s] 43%|█████████████████████████████████████████▉                                                       | 3231/7473 [00:26<00:32, 129.63it/s] 43%|██████████████████████████████████████████                                                       | 3244/7473 [00:26<00:32, 129.61it/s] 44%|██████████████████████████████████████████▎                                                      | 3258/7473 [00:26<00:32, 129.84it/s] 44%|██████████████████████████████████████████▍                                                      | 3272/7473 [00:26<00:32, 130.13it/s] 44%|██████████████████████████████████████████▋                                                      | 3286/7473 [00:26<00:32, 130.33it/s] 44%|██████████████████████████████████████████▊                                                      | 3300/7473 [00:26<00:32, 130.39it/s] 44%|███████████████████████████████████████████                                                      | 3314/7473 [00:26<00:31, 130.12it/s] 45%|███████████████████████████████████████████▏                                                     | 3328/7473 [00:27<00:31, 129.74it/s] 45%|███████████████████████████████████████████▎                                                     | 3341/7473 [00:27<00:31, 129.27it/s] 45%|███████████████████████████████████████████▌                                                     | 3355/7473 [00:27<00:31, 129.53it/s] 45%|███████████████████████████████████████████▋                                                     | 3369/7473 [00:27<00:31, 129.70it/s] 45%|███████████████████████████████████████████▉                                                     | 3382/7473 [00:27<00:31, 129.76it/s] 45%|████████████████████████████████████████████                                                     | 3395/7473 [00:27<00:31, 129.69it/s] 46%|████████████████████████████████████████████▏                                                    | 3408/7473 [00:27<00:31, 129.33it/s] 46%|████████████████████████████████████████████▍                                                    | 3421/7473 [00:27<00:31, 128.48it/s] 46%|████████████████████████████████████████████▌                                                    | 3434/7473 [00:27<00:31, 127.63it/s] 46%|████████████████████████████████████████████▋                                                    | 3447/7473 [00:27<00:31, 128.29it/s] 46%|████████████████████████████████████████████▉                                                    | 3461/7473 [00:28<00:31, 128.91it/s] 47%|█████████████████████████████████████████████                                                    | 3475/7473 [00:28<00:30, 129.33it/s] 47%|█████████████████████████████████████████████▎                                                   | 3489/7473 [00:28<00:30, 129.83it/s] 47%|█████████████████████████████████████████████▍                                                   | 3503/7473 [00:28<00:30, 130.13it/s] 47%|█████████████████████████████████████████████▋                                                   | 3517/7473 [00:28<00:30, 129.95it/s] 47%|█████████████████████████████████████████████▊                                                   | 3531/7473 [00:28<00:30, 130.03it/s] 47%|██████████████████████████████████████████████                                                   | 3545/7473 [00:28<00:30, 130.20it/s] 48%|██████████████████████████████████████████████▏                                                  | 3559/7473 [00:28<00:30, 130.32it/s] 48%|██████████████████████████████████████████████▍                                                  | 3573/7473 [00:28<00:29, 130.55it/s] 48%|██████████████████████████████████████████████▌                                                  | 3587/7473 [00:29<00:29, 130.46it/s] 48%|██████████████████████████████████████████████▋                                                  | 3601/7473 [00:29<00:29, 130.34it/s] 48%|██████████████████████████████████████████████▉                                                  | 3615/7473 [00:29<00:29, 130.26it/s] 49%|███████████████████████████████████████████████                                                  | 3629/7473 [00:29<00:29, 130.25it/s] 49%|███████████████████████████████████████████████▎                                                 | 3643/7473 [00:29<00:29, 130.08it/s] 49%|███████████████████████████████████████████████▍                                                 | 3657/7473 [00:29<00:29, 128.64it/s] 49%|███████████████████████████████████████████████▋                                                 | 3671/7473 [00:29<00:29, 129.01it/s] 49%|███████████████████████████████████████████████▊                                                 | 3685/7473 [00:29<00:29, 129.54it/s] 49%|████████████████████████████████████████████████                                                 | 3698/7473 [00:29<00:29, 129.65it/s] 50%|████████████████████████████████████████████████▏                                                | 3712/7473 [00:30<00:28, 129.85it/s] 50%|████████████████████████████████████████████████▎                                                | 3726/7473 [00:30<00:28, 130.01it/s] 50%|████████████████████████████████████████████████▌                                                | 3740/7473 [00:30<00:28, 130.02it/s] 50%|████████████████████████████████████████████████▋                                                | 3754/7473 [00:30<00:28, 130.15it/s] 50%|████████████████████████████████████████████████▉                                                | 3768/7473 [00:30<00:28, 130.21it/s] 51%|█████████████████████████████████████████████████                                                | 3782/7473 [00:30<00:28, 130.32it/s] 51%|█████████████████████████████████████████████████▎                                               | 3796/7473 [00:30<00:28, 130.34it/s] 51%|█████████████████████████████████████████████████▍                                               | 3810/7473 [00:30<00:28, 130.51it/s] 51%|█████████████████████████████████████████████████▋                                               | 3824/7473 [00:30<00:27, 130.36it/s] 51%|█████████████████████████████████████████████████▊                                               | 3838/7473 [00:30<00:27, 130.30it/s] 52%|█████████████████████████████████████████████████▉                                               | 3852/7473 [00:31<00:27, 130.36it/s] 52%|██████████████████████████████████████████████████▏                                              | 3866/7473 [00:31<00:27, 130.44it/s] 52%|██████████████████████████████████████████████████▎                                              | 3880/7473 [00:31<00:27, 130.30it/s] 52%|██████████████████████████████████████████████████▌                                              | 3894/7473 [00:31<00:27, 128.77it/s] 52%|██████████████████████████████████████████████████▋                                              | 3908/7473 [00:31<00:27, 129.27it/s] 52%|██████████████████████████████████████████████████▉                                              | 3922/7473 [00:31<00:27, 129.56it/s] 53%|███████████████████████████████████████████████████                                              | 3936/7473 [00:31<00:27, 129.91it/s] 53%|███████████████████████████████████████████████████▎                                             | 3950/7473 [00:31<00:27, 130.06it/s] 53%|███████████████████████████████████████████████████▍                                             | 3964/7473 [00:31<00:26, 130.21it/s] 53%|███████████████████████████████████████████████████▋                                             | 3978/7473 [00:32<00:27, 129.35it/s] 53%|███████████████████████████████████████████████████▊                                             | 3991/7473 [00:32<00:28, 122.50it/s] 54%|███████████████████████████████████████████████████▉                                             | 4005/7473 [00:32<00:27, 124.97it/s] 54%|████████████████████████████████████████████████████▏                                            | 4018/7473 [00:32<00:27, 126.09it/s] 54%|████████████████████████████████████████████████████▎                                            | 4032/7473 [00:32<00:27, 127.44it/s] 54%|████████████████████████████████████████████████████▌                                            | 4045/7473 [00:32<00:26, 127.40it/s] 54%|████████████████████████████████████████████████████▋                                            | 4058/7473 [00:32<00:27, 124.20it/s] 54%|████████████████████████████████████████████████████▊                                            | 4071/7473 [00:32<00:27, 125.68it/s] 55%|█████████████████████████████████████████████████████                                            | 4085/7473 [00:32<00:26, 127.13it/s] 55%|█████████████████████████████████████████████████████▏                                           | 4098/7473 [00:33<00:26, 125.99it/s] 55%|█████████████████████████████████████████████████████▎                                           | 4111/7473 [00:33<00:26, 125.27it/s] 55%|█████████████████████████████████████████████████████▌                                           | 4124/7473 [00:33<00:26, 125.86it/s] 55%|█████████████████████████████████████████████████████▋                                           | 4137/7473 [00:33<00:26, 126.06it/s] 56%|█████████████████████████████████████████████████████▊                                           | 4150/7473 [00:33<00:26, 127.16it/s] 56%|██████████████████████████████████████████████████████                                           | 4164/7473 [00:33<00:25, 128.27it/s] 56%|██████████████████████████████████████████████████████▏                                          | 4177/7473 [00:33<00:25, 128.58it/s] 56%|██████████████████████████████████████████████████████▍                                          | 4190/7473 [00:33<00:25, 128.95it/s] 56%|██████████████████████████████████████████████████████▌                                          | 4204/7473 [00:33<00:25, 129.39it/s] 56%|██████████████████████████████████████████████████████▋                                          | 4218/7473 [00:33<00:25, 129.58it/s] 57%|██████████████████████████████████████████████████████▉                                          | 4232/7473 [00:34<00:24, 129.97it/s] 57%|███████████████████████████████████████████████████████                                          | 4245/7473 [00:34<00:24, 129.78it/s] 57%|███████████████████████████████████████████████████████▎                                         | 4258/7473 [00:34<00:24, 129.69it/s] 57%|███████████████████████████████████████████████████████▍                                         | 4271/7473 [00:34<00:24, 129.29it/s] 57%|███████████████████████████████████████████████████████▌                                         | 4284/7473 [00:34<00:24, 129.42it/s] 58%|███████████████████████████████████████████████████████▊                                         | 4297/7473 [00:34<00:26, 121.45it/s] 58%|███████████████████████████████████████████████████████▉                                         | 4310/7473 [00:34<00:27, 113.99it/s] 58%|████████████████████████████████████████████████████████                                         | 4323/7473 [00:34<00:26, 117.03it/s] 58%|████████████████████████████████████████████████████████▎                                        | 4336/7473 [00:34<00:26, 119.50it/s] 58%|████████████████████████████████████████████████████████▍                                        | 4350/7473 [00:35<00:25, 122.81it/s] 58%|████████████████████████████████████████████████████████▋                                        | 4364/7473 [00:35<00:24, 124.99it/s] 59%|████████████████████████████████████████████████████████▊                                        | 4378/7473 [00:35<00:24, 126.55it/s] 59%|████████████████████████████████████████████████████████▉                                        | 4391/7473 [00:35<00:24, 127.41it/s] 59%|█████████████████████████████████████████████████████████▏                                       | 4405/7473 [00:35<00:23, 128.33it/s] 59%|█████████████████████████████████████████████████████████▎                                       | 4419/7473 [00:35<00:23, 128.85it/s] 59%|█████████████████████████████████████████████████████████▌                                       | 4432/7473 [00:35<00:23, 129.09it/s] 59%|█████████████████████████████████████████████████████████▋                                       | 4445/7473 [00:35<00:23, 129.22it/s] 60%|█████████████████████████████████████████████████████████▊                                       | 4458/7473 [00:35<00:23, 129.26it/s] 60%|██████████████████████████████████████████████████████████                                       | 4472/7473 [00:35<00:23, 129.56it/s] 60%|██████████████████████████████████████████████████████████▏                                      | 4485/7473 [00:36<00:23, 129.66it/s] 60%|██████████████████████████████████████████████████████████▍                                      | 4499/7473 [00:36<00:22, 129.90it/s] 60%|██████████████████████████████████████████████████████████▌                                      | 4513/7473 [00:36<00:22, 129.91it/s] 61%|██████████████████████████████████████████████████████████▋                                      | 4526/7473 [00:36<00:22, 129.86it/s] 61%|██████████████████████████████████████████████████████████▉                                      | 4540/7473 [00:36<00:22, 130.01it/s] 61%|███████████████████████████████████████████████████████████                                      | 4554/7473 [00:36<00:22, 130.25it/s] 61%|███████████████████████████████████████████████████████████▎                                     | 4568/7473 [00:36<00:22, 128.91it/s] 61%|███████████████████████████████████████████████████████████▍                                     | 4582/7473 [00:36<00:22, 129.36it/s] 61%|███████████████████████████████████████████████████████████▋                                     | 4595/7473 [00:36<00:22, 129.43it/s] 62%|███████████████████████████████████████████████████████████▊                                     | 4609/7473 [00:37<00:22, 129.80it/s] 62%|████████████████████████████████████████████████████████████                                     | 4623/7473 [00:37<00:21, 129.95it/s] 62%|████████████████████████████████████████████████████████████▏                                    | 4636/7473 [00:37<00:21, 129.73it/s] 62%|████████████████████████████████████████████████████████████▎                                    | 4650/7473 [00:37<00:21, 129.88it/s] 62%|████████████████████████████████████████████████████████████▌                                    | 4663/7473 [00:37<00:21, 129.87it/s] 63%|████████████████████████████████████████████████████████████▋                                    | 4676/7473 [00:37<00:21, 129.82it/s] 63%|████████████████████████████████████████████████████████████▉                                    | 4690/7473 [00:37<00:21, 130.06it/s] 63%|█████████████████████████████████████████████████████████████                                    | 4704/7473 [00:37<00:21, 129.95it/s] 63%|█████████████████████████████████████████████████████████████▏                                   | 4717/7473 [00:37<00:21, 129.96it/s] 63%|█████████████████████████████████████████████████████████████▍                                   | 4731/7473 [00:37<00:21, 129.92it/s] 63%|█████████████████████████████████████████████████████████████▌                                   | 4745/7473 [00:38<00:20, 129.98it/s] 64%|█████████████████████████████████████████████████████████████▊                                   | 4759/7473 [00:38<00:20, 130.15it/s] 64%|█████████████████████████████████████████████████████████████▉                                   | 4773/7473 [00:38<00:20, 130.22it/s] 64%|██████████████████████████████████████████████████████████████▏                                  | 4787/7473 [00:38<00:20, 130.28it/s] 64%|██████████████████████████████████████████████████████████████▎                                  | 4801/7473 [00:38<00:20, 128.61it/s] 64%|██████████████████████████████████████████████████████████████▍                                  | 4815/7473 [00:38<00:20, 129.18it/s] 65%|██████████████████████████████████████████████████████████████▋                                  | 4829/7473 [00:38<00:20, 129.61it/s] 65%|██████████████████████████████████████████████████████████████▊                                  | 4843/7473 [00:38<00:20, 129.88it/s] 65%|███████████████████████████████████████████████████████████████                                  | 4856/7473 [00:38<00:20, 129.76it/s] 65%|███████████████████████████████████████████████████████████████▏                                 | 4869/7473 [00:39<00:20, 129.71it/s] 65%|███████████████████████████████████████████████████████████████▍                                 | 4883/7473 [00:39<00:19, 129.88it/s] 66%|███████████████████████████████████████████████████████████████▌                                 | 4897/7473 [00:39<00:19, 130.21it/s] 66%|███████████████████████████████████████████████████████████████▋                                 | 4911/7473 [00:39<00:19, 130.31it/s] 66%|███████████████████████████████████████████████████████████████▉                                 | 4925/7473 [00:39<00:19, 130.23it/s] 66%|████████████████████████████████████████████████████████████████                                 | 4939/7473 [00:39<00:19, 130.06it/s] 66%|████████████████████████████████████████████████████████████████▎                                | 4953/7473 [00:39<00:19, 130.25it/s] 66%|████████████████████████████████████████████████████████████████▍                                | 4967/7473 [00:39<00:19, 130.02it/s] 67%|████████████████████████████████████████████████████████████████▋                                | 4981/7473 [00:39<00:19, 130.07it/s] 67%|████████████████████████████████████████████████████████████████▊                                | 4995/7473 [00:40<00:19, 130.01it/s] 67%|█████████████████████████████████████████████████████████████████                                | 5009/7473 [00:40<00:18, 130.34it/s] 67%|█████████████████████████████████████████████████████████████████▏                               | 5023/7473 [00:40<00:19, 128.08it/s] 67%|█████████████████████████████████████████████████████████████████▎                               | 5036/7473 [00:40<00:18, 128.61it/s] 68%|█████████████████████████████████████████████████████████████████▌                               | 5050/7473 [00:40<00:18, 129.16it/s] 68%|█████████████████████████████████████████████████████████████████▋                               | 5064/7473 [00:40<00:18, 129.58it/s] 68%|█████████████████████████████████████████████████████████████████▉                               | 5078/7473 [00:40<00:18, 129.74it/s] 68%|██████████████████████████████████████████████████████████████████                               | 5092/7473 [00:40<00:18, 129.82it/s] 68%|██████████████████████████████████████████████████████████████████▎                              | 5106/7473 [00:40<00:18, 129.89it/s] 69%|██████████████████████████████████████████████████████████████████▍                              | 5120/7473 [00:40<00:18, 130.02it/s] 69%|██████████████████████████████████████████████████████████████████▋                              | 5134/7473 [00:41<00:17, 130.17it/s] 69%|██████████████████████████████████████████████████████████████████▊                              | 5148/7473 [00:41<00:17, 130.25it/s] 69%|███████████████████████████████████████████████████████████████████                              | 5162/7473 [00:41<00:17, 130.26it/s] 69%|███████████████████████████████████████████████████████████████████▏                             | 5176/7473 [00:41<00:17, 130.41it/s] 69%|███████████████████████████████████████████████████████████████████▎                             | 5190/7473 [00:41<00:17, 130.41it/s] 70%|███████████████████████████████████████████████████████████████████▌                             | 5204/7473 [00:41<00:17, 130.17it/s] 70%|███████████████████████████████████████████████████████████████████▋                             | 5218/7473 [00:41<00:17, 130.29it/s] 70%|███████████████████████████████████████████████████████████████████▉                             | 5232/7473 [00:41<00:17, 130.35it/s] 70%|████████████████████████████████████████████████████████████████████                             | 5246/7473 [00:41<00:19, 113.98it/s] 70%|████████████████████████████████████████████████████████████████████▎                            | 5259/7473 [00:42<00:18, 117.99it/s] 71%|████████████████████████████████████████████████████████████████████▍                            | 5273/7473 [00:42<00:18, 121.48it/s] 71%|████████████████████████████████████████████████████████████████████▋                            | 5287/7473 [00:42<00:17, 124.12it/s] 71%|████████████████████████████████████████████████████████████████████▊                            | 5300/7473 [00:42<00:17, 124.91it/s] 71%|████████████████████████████████████████████████████████████████████▉                            | 5314/7473 [00:42<00:17, 126.45it/s] 71%|█████████████████████████████████████████████████████████████████████▏                           | 5327/7473 [00:42<00:16, 127.40it/s] 71%|█████████████████████████████████████████████████████████████████████▎                           | 5340/7473 [00:42<00:16, 128.04it/s] 72%|█████████████████████████████████████████████████████████████████████▍                           | 5353/7473 [00:42<00:16, 128.58it/s] 72%|█████████████████████████████████████████████████████████████████████▋                           | 5367/7473 [00:42<00:16, 129.10it/s] 72%|█████████████████████████████████████████████████████████████████████▊                           | 5381/7473 [00:43<00:16, 129.50it/s] 72%|██████████████████████████████████████████████████████████████████████                           | 5395/7473 [00:43<00:16, 129.72it/s] 72%|██████████████████████████████████████████████████████████████████████▏                          | 5408/7473 [00:43<00:15, 129.75it/s] 73%|██████████████████████████████████████████████████████████████████████▍                          | 5422/7473 [00:43<00:15, 129.93it/s] 73%|██████████████████████████████████████████████████████████████████████▌                          | 5436/7473 [00:43<00:15, 130.00it/s] 73%|██████████████████████████████████████████████████████████████████████▋                          | 5450/7473 [00:43<00:15, 129.68it/s] 73%|██████████████████████████████████████████████████████████████████████▉                          | 5463/7473 [00:43<00:15, 129.75it/s] 73%|███████████████████████████████████████████████████████████████████████▊                          | 5476/7473 [00:44<00:26, 75.75it/s] 73%|███████████████████████████████████████████████████████████████████████▉                          | 5489/7473 [00:44<00:22, 86.32it/s] 74%|████████████████████████████████████████████████████████████████████████▏                         | 5502/7473 [00:44<00:20, 95.84it/s] 74%|███████████████████████████████████████████████████████████████████████▌                         | 5516/7473 [00:44<00:18, 104.56it/s] 74%|███████████████████████████████████████████████████████████████████████▊                         | 5530/7473 [00:44<00:17, 111.35it/s] 74%|███████████████████████████████████████████████████████████████████████▉                         | 5543/7473 [00:44<00:16, 115.99it/s] 74%|████████████████████████████████████████████████████████████████████████                         | 5556/7473 [00:44<00:16, 118.97it/s] 75%|████████████████████████████████████████████████████████████████████████▎                        | 5570/7473 [00:44<00:15, 122.19it/s] 75%|████████████████████████████████████████████████████████████████████████▍                        | 5583/7473 [00:44<00:15, 124.36it/s] 75%|████████████████████████████████████████████████████████████████████████▋                        | 5596/7473 [00:44<00:14, 125.83it/s] 75%|████████████████████████████████████████████████████████████████████████▊                        | 5610/7473 [00:45<00:14, 127.19it/s] 75%|████████████████████████████████████████████████████████████████████████▉                        | 5623/7473 [00:45<00:14, 127.93it/s] 75%|█████████████████████████████████████████████████████████████████████████▏                       | 5637/7473 [00:45<00:14, 128.63it/s] 76%|█████████████████████████████████████████████████████████████████████████▎                       | 5651/7473 [00:45<00:14, 129.30it/s] 76%|█████████████████████████████████████████████████████████████████████████▌                       | 5665/7473 [00:45<00:13, 129.54it/s] 76%|█████████████████████████████████████████████████████████████████████████▋                       | 5678/7473 [00:45<00:13, 128.35it/s] 76%|█████████████████████████████████████████████████████████████████████████▉                       | 5692/7473 [00:45<00:13, 128.92it/s] 76%|██████████████████████████████████████████████████████████████████████████                       | 5706/7473 [00:45<00:13, 129.35it/s] 77%|██████████████████████████████████████████████████████████████████████████▏                      | 5719/7473 [00:45<00:13, 129.37it/s] 77%|██████████████████████████████████████████████████████████████████████████▍                      | 5733/7473 [00:45<00:13, 129.65it/s] 77%|██████████████████████████████████████████████████████████████████████████▌                      | 5747/7473 [00:46<00:13, 129.84it/s] 77%|██████████████████████████████████████████████████████████████████████████▊                      | 5761/7473 [00:46<00:13, 129.92it/s] 77%|██████████████████████████████████████████████████████████████████████████▉                      | 5775/7473 [00:46<00:13, 130.05it/s] 77%|███████████████████████████████████████████████████████████████████████████▏                     | 5789/7473 [00:46<00:12, 130.02it/s] 78%|███████████████████████████████████████████████████████████████████████████▎                     | 5803/7473 [00:46<00:12, 130.03it/s] 78%|███████████████████████████████████████████████████████████████████████████▌                     | 5817/7473 [00:46<00:12, 129.87it/s] 78%|███████████████████████████████████████████████████████████████████████████▋                     | 5830/7473 [00:46<00:12, 129.79it/s] 78%|███████████████████████████████████████████████████████████████████████████▊                     | 5843/7473 [00:46<00:12, 128.98it/s] 78%|████████████████████████████████████████████████████████████████████████████                     | 5856/7473 [00:46<00:12, 129.26it/s] 79%|████████████████████████████████████████████████████████████████████████████▏                    | 5869/7473 [00:47<00:12, 129.43it/s] 79%|████████████████████████████████████████████████████████████████████████████▎                    | 5882/7473 [00:47<00:12, 129.55it/s] 79%|████████████████████████████████████████████████████████████████████████████▌                    | 5895/7473 [00:47<00:12, 129.58it/s] 79%|████████████████████████████████████████████████████████████████████████████▋                    | 5908/7473 [00:47<00:12, 128.26it/s] 79%|████████████████████████████████████████████████████████████████████████████▊                    | 5921/7473 [00:47<00:12, 128.51it/s] 79%|█████████████████████████████████████████████████████████████████████████████                    | 5935/7473 [00:47<00:11, 129.05it/s] 80%|█████████████████████████████████████████████████████████████████████████████▏                   | 5948/7473 [00:47<00:11, 129.21it/s] 80%|█████████████████████████████████████████████████████████████████████████████▎                   | 5961/7473 [00:47<00:11, 129.18it/s] 80%|█████████████████████████████████████████████████████████████████████████████▌                   | 5974/7473 [00:47<00:11, 129.27it/s] 80%|█████████████████████████████████████████████████████████████████████████████▋                   | 5988/7473 [00:47<00:11, 129.49it/s] 80%|█████████████████████████████████████████████████████████████████████████████▉                   | 6002/7473 [00:48<00:11, 129.61it/s] 80%|██████████████████████████████████████████████████████████████████████████████                   | 6015/7473 [00:48<00:11, 129.59it/s] 81%|██████████████████████████████████████████████████████████████████████████████▎                  | 6029/7473 [00:48<00:11, 129.74it/s] 81%|██████████████████████████████████████████████████████████████████████████████▍                  | 6043/7473 [00:48<00:11, 129.84it/s] 81%|██████████████████████████████████████████████████████████████████████████████▌                  | 6057/7473 [00:48<00:10, 130.12it/s] 81%|██████████████████████████████████████████████████████████████████████████████▊                  | 6071/7473 [00:48<00:10, 130.17it/s] 81%|██████████████████████████████████████████████████████████████████████████████▉                  | 6085/7473 [00:48<00:10, 130.22it/s] 82%|███████████████████████████████████████████████████████████████████████████████▏                 | 6099/7473 [00:48<00:10, 130.22it/s] 82%|███████████████████████████████████████████████████████████████████████████████▎                 | 6113/7473 [00:48<00:10, 130.17it/s] 82%|███████████████████████████████████████████████████████████████████████████████▌                 | 6127/7473 [00:49<00:10, 129.28it/s] 82%|███████████████████████████████████████████████████████████████████████████████▋                 | 6140/7473 [00:49<00:10, 128.14it/s] 82%|███████████████████████████████████████████████████████████████████████████████▉                 | 6154/7473 [00:49<00:10, 128.77it/s] 83%|████████████████████████████████████████████████████████████████████████████████                 | 6167/7473 [00:49<00:10, 129.05it/s] 83%|████████████████████████████████████████████████████████████████████████████████▏                | 6180/7473 [00:49<00:10, 129.28it/s] 83%|████████████████████████████████████████████████████████████████████████████████▍                | 6194/7473 [00:49<00:09, 129.60it/s] 83%|████████████████████████████████████████████████████████████████████████████████▌                | 6208/7473 [00:49<00:09, 129.76it/s] 83%|████████████████████████████████████████████████████████████████████████████████▋                | 6221/7473 [00:49<00:09, 129.78it/s] 83%|████████████████████████████████████████████████████████████████████████████████▉                | 6234/7473 [00:49<00:09, 129.74it/s] 84%|█████████████████████████████████████████████████████████████████████████████████                | 6248/7473 [00:49<00:09, 130.02it/s] 84%|█████████████████████████████████████████████████████████████████████████████████▎               | 6262/7473 [00:50<00:09, 129.88it/s] 84%|█████████████████████████████████████████████████████████████████████████████████▍               | 6276/7473 [00:50<00:09, 130.06it/s] 84%|█████████████████████████████████████████████████████████████████████████████████▋               | 6290/7473 [00:50<00:09, 129.78it/s] 84%|█████████████████████████████████████████████████████████████████████████████████▊               | 6304/7473 [00:50<00:08, 130.06it/s] 85%|██████████████████████████████████████████████████████████████████████████████████               | 6318/7473 [00:50<00:08, 130.04it/s] 85%|██████████████████████████████████████████████████████████████████████████████████▏              | 6332/7473 [00:50<00:08, 130.19it/s] 85%|██████████████████████████████████████████████████████████████████████████████████▎              | 6346/7473 [00:50<00:08, 130.10it/s] 85%|██████████████████████████████████████████████████████████████████████████████████▌              | 6360/7473 [00:50<00:08, 128.70it/s] 85%|██████████████████████████████████████████████████████████████████████████████████▋              | 6373/7473 [00:50<00:08, 128.75it/s] 85%|██████████████████████████████████████████████████████████████████████████████████▉              | 6386/7473 [00:51<00:08, 128.92it/s] 86%|███████████████████████████████████████████████████████████████████████████████████              | 6399/7473 [00:51<00:08, 129.15it/s] 86%|███████████████████████████████████████████████████████████████████████████████████▏             | 6412/7473 [00:51<00:08, 128.38it/s] 86%|███████████████████████████████████████████████████████████████████████████████████▍             | 6425/7473 [00:51<00:08, 128.74it/s] 86%|███████████████████████████████████████████████████████████████████████████████████▌             | 6439/7473 [00:51<00:08, 129.12it/s] 86%|███████████████████████████████████████████████████████████████████████████████████▋             | 6452/7473 [00:51<00:07, 129.33it/s] 87%|███████████████████████████████████████████████████████████████████████████████████▉             | 6465/7473 [00:51<00:07, 129.52it/s] 87%|████████████████████████████████████████████████████████████████████████████████████             | 6478/7473 [00:51<00:07, 129.61it/s] 87%|████████████████████████████████████████████████████████████████████████████████████▎            | 6491/7473 [00:51<00:07, 129.67it/s] 87%|████████████████████████████████████████████████████████████████████████████████████▍            | 6504/7473 [00:51<00:07, 129.73it/s] 87%|████████████████████████████████████████████████████████████████████████████████████▌            | 6517/7473 [00:52<00:07, 129.64it/s] 87%|████████████████████████████████████████████████████████████████████████████████████▊            | 6531/7473 [00:52<00:07, 129.75it/s] 88%|████████████████████████████████████████████████████████████████████████████████████▉            | 6545/7473 [00:52<00:07, 129.89it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████            | 6558/7473 [00:52<00:07, 129.83it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████▎           | 6571/7473 [00:52<00:06, 129.78it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████▍           | 6584/7473 [00:52<00:06, 128.47it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████▋           | 6598/7473 [00:52<00:06, 129.07it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████▊           | 6611/7473 [00:52<00:06, 129.30it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████▉           | 6624/7473 [00:52<00:06, 129.35it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████▏          | 6637/7473 [00:52<00:06, 129.27it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████▎          | 6651/7473 [00:53<00:06, 129.59it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████▍          | 6664/7473 [00:53<00:06, 129.52it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████▋          | 6677/7473 [00:53<00:06, 129.62it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████▊          | 6691/7473 [00:53<00:06, 129.78it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████          | 6704/7473 [00:53<00:05, 128.90it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████▏         | 6717/7473 [00:53<00:05, 129.02it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████▎         | 6731/7473 [00:53<00:05, 129.54it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████▌         | 6744/7473 [00:53<00:05, 129.56it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████▋         | 6757/7473 [00:53<00:05, 129.57it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████▉         | 6770/7473 [00:54<00:05, 129.44it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████         | 6783/7473 [00:54<00:05, 129.57it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████▏        | 6796/7473 [00:54<00:05, 129.62it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████▍        | 6809/7473 [00:54<00:05, 128.09it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████▌        | 6822/7473 [00:54<00:05, 128.41it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████▋        | 6836/7473 [00:54<00:04, 128.89it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████▉        | 6849/7473 [00:54<00:04, 129.21it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████        | 6862/7473 [00:54<00:04, 129.22it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████▎       | 6876/7473 [00:54<00:04, 129.61it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████▍       | 6890/7473 [00:54<00:04, 129.74it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████▌       | 6904/7473 [00:55<00:04, 129.94it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████▊       | 6917/7473 [00:55<00:04, 129.95it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████▉       | 6930/7473 [00:55<00:04, 129.92it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████       | 6943/7473 [00:55<00:04, 129.94it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████▎      | 6956/7473 [00:55<00:03, 129.71it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████▍      | 6969/7473 [00:55<00:03, 129.74it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████▋      | 6982/7473 [00:55<00:03, 128.70it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████▊      | 6995/7473 [00:55<00:03, 128.92it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████▉      | 7009/7473 [00:55<00:03, 129.29it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████▏     | 7022/7473 [00:55<00:03, 129.31it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████▎     | 7035/7473 [00:56<00:03, 127.86it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████▍     | 7048/7473 [00:56<00:03, 128.23it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████▋     | 7061/7473 [00:56<00:03, 128.75it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████▊     | 7074/7473 [00:56<00:03, 129.11it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████▉     | 7087/7473 [00:56<00:02, 129.25it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████▏    | 7101/7473 [00:56<00:02, 129.63it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████▎    | 7114/7473 [00:56<00:02, 129.44it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████▌    | 7127/7473 [00:56<00:02, 129.36it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████▋    | 7140/7473 [00:56<00:02, 129.30it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████▊    | 7153/7473 [00:56<00:02, 129.39it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████    | 7166/7473 [00:57<00:02, 129.39it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████▏   | 7179/7473 [00:57<00:02, 129.56it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████▎   | 7192/7473 [00:57<00:02, 129.63it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████▌   | 7205/7473 [00:57<00:02, 129.64it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████▋   | 7218/7473 [00:57<00:01, 129.69it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████▊   | 7231/7473 [00:57<00:01, 129.76it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████   | 7245/7473 [00:57<00:01, 129.89it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████▏  | 7258/7473 [00:57<00:01, 129.91it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████▍  | 7271/7473 [00:57<00:01, 127.43it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████▌  | 7284/7473 [00:57<00:01, 128.13it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████▋  | 7297/7473 [00:58<00:01, 128.67it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████▉  | 7310/7473 [00:58<00:01, 128.96it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████  | 7323/7473 [00:58<00:01, 129.25it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████▏ | 7336/7473 [00:58<00:01, 129.21it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████▍ | 7349/7473 [00:58<00:00, 129.41it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████▌ | 7362/7473 [00:58<00:00, 129.27it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████▋ | 7375/7473 [00:58<00:00, 129.32it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████▉ | 7389/7473 [00:58<00:00, 129.62it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████ | 7402/7473 [00:58<00:00, 129.62it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████▏| 7415/7473 [00:58<00:00, 129.49it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████▍| 7428/7473 [00:59<00:00, 129.52it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████▌| 7441/7473 [00:59<00:00, 129.56it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████▊| 7454/7473 [00:59<00:00, 129.50it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████▉| 7467/7473 [00:59<00:00, 129.39it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 7473/7473 [00:59<00:00, 125.72it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.13s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.05s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.05s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.10s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.12s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.01s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.04s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.08s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.51s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.67s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.46s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.61s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.46s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.62s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.48s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.65s/it]
[2023-08-18 09:59:36,875] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
[2023-08-18 09:59:43,756] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-18 09:59:43,757] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-18 09:59:43,757] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-18 09:59:43,757] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-18 09:59:43,757] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-18 09:59:43,757] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-18 09:59:43,757] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-18 09:59:43,757] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-18 09:59:43,757] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-18 09:59:43,757] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-18 09:59:43,757] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-18 09:59:43,757] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f7e119ab130>
[2023-08-18 09:59:43,757] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-18 09:59:43,757] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-18 09:59:43,757] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-18 09:59:43,757] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f7e119ab280>
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   train_batch_size ............. 8
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  2
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-18 09:59:43,758] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-18 09:59:43,758] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.7255282402038574 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating gsm8k :   0%|                                                                                           | 0/125 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following grade math question.

Input: Fabric is cut to order at what type of seller? Choices:  A: curtains B: tailor shop C: clothing store D: sewing room E: hardware store
Output: 1. Firstly, we need to understand what the hint "fabric is cut to order" suggests. It means that the fabric is custom cut based on specific requirements or orders. 
2. Now we need to think about which of the given options would deal with custom-made fabric.
3. The options are curtains, tailor shop, clothing store, sewing room, and hardware store.
4. Considering the first option, the curtains, usually specializes in ready-made curtain panels or finished products. They do not generally cut fabric to make custom designs.
5. Looking at the second option - tailor shops. Tailors custom cut fabric to create garments based on customers' requirements. So, it makes sense for them to cut fabric as per order.
6. Clothing stores, similar to curtain sellers, typically sell ready-made garments. They do not typically cut fabric to the customers' order.
7. A sewing room is a place where sewing is done. While fabric may be cut here, it is not a place customers usually visit to order cut fabric.
8. Finally, a hardware store would mostly sell tools, machinery, and other hardware equipment. It has nothing to do with selling fabric.
9. Hence, from the given choices, the place that fits with the given hint is B: a tailor shop.
So the final answer is B: tailor shop

Input: Where are you if your reading magazines while waiting for a vehicle on rails? Choices:  A: vegetables B: market C: doctor D: train station E: bookstore
Output: 1. The question is a riddle asking for your location given certain activities and conditions.
2. Reading magazines and waiting for a vehicle on rails are the important clues here.
3. The first part, reading magazines, could place you in several locations like a bookstore or a market. However, the second clue (waiting for a vehicle on rails) is more specific.
4. A vehicle on rails is most commonly a train. 
5. Thus, the location where you are most likely to wait for a train is at a train station. 
6. So, combining the activity of reading magazines and waiting for a train, you can conclude that the place should be a train station.
7. Therefore, among the given choices (A: vegetables B: market C: doctor D: train station E: bookstore), the correct answer is D: train station.
So the final answer is D: train station

Input: What would need oil to be used? Choices:  A: ground B: human  body C: repair shop D: combustion engines E: service station
Output: 1. The question asks about what would require oil to be used.
2. Start by evaluating each choice.
3. Choice A, ground. The ground doesn't typically require oil. So, this is likely not the answer.
4. Choice B, human body. The human body does need oil in the sense of fats and lipids for cellular function, but in the common context, oil is not applied or used on the human body, therefore it's not correct.
5. Choice C, repair shop, and Choice E, service station. These places might use oil as part of their functions or services, especially if they service vehicles or machinery. However, they're locations, not things that in themselves would need oil.
6. Choice D, combustion engines. Combustion engines inherently require oil for their operation. The oil is used to lubricate the moving parts and helps to reduce the heat produced by the engine. Without oil, an engine would quickly overheat and fail.
7. Therefore, the answer is D: combustion engines.
So the final answer is D: combustion engines

Input: What is person probably feeling that plans on stopping being married to their spouse? Choices:  A: detachment B: bankruptcy C: sad D: fights E: wrong
Output: 1. The question asks for the emotional state of a person who plans to end their marriage. 
2. This rules out choices B: bankruptcy and E: wrong, as they are not feelings or emotions. 
3. Then consider option D: fights. Even though fights might be a reason that leads to the decision of stopping being married, it isn't necessarily a feeling someone has when contemplating ending the marriage.
4. It leaves us with options A: detachment and C: sad. While someone considering ending their marriage may feel sad, the act of planning to end a marriage indicates a level of emotional separation, or detachment, from their spouse.
5. Thus, the most suitable answer would be A: detachment.
So the final answer is A: detachment

Input: What could you use to store a clock? Choices:  A: shelf B: own bedroom C: desk D: wall E: car
Output: 1. The question is asking about a place or object that could be used to store a clock. In particular, a place where a clock could be safely kept and is also easily visible.
2. Let's consider each of the options. 
3. Option A is'shelf'. A shelf is a suitable place to store a clock because you can easily place it there and the clock is typically easily visible when placed on a shelf.
4. Option B is 'own bedroom'. While you can keep a clock in your bedroom, the question is asking for a specific place or object to store a clock and 'own bedroom' is generally too broad. Plus, a clock may not be easily visible depending on where it is placed in the bedroom. 
5. Option C is 'desk'. A desk could be a suitable place to store a clock but a clock can easily be knocked over or cluttered among other things on the desk.
6. Option D is 'wall'. A wall is not generally a place to'store' things; instead, you might hang or mount something on a wall. Hence, it does not fit in this context.
7. Option E is 'car'. While you could potentially have a clock in your car, it is not a practical place to store a clock, and the clock may not be easily visible.
8. Based on this analysis, the right answer is A: shelf as it offers a suitable place to store a clock where it can also be easily visible.
So the final answer is A: shelf

Input: The person put on lotion, what did they want? Choices:  A: fresh smell B: good credit C: smooth skin D: fresh produce E: headache
Output: 1. The question describes a person applying lotion, which is typically a beauty or skincare product.
2. This action implies an intention related to one's physical skin condition, well-being, or personal grooming.
3. Looking at the options given, option A: fresh smell could be a possible reason. Some lotions do have fragrant smells. But, this is not the primary reason people use lotion.
4. Option B: good credit and Option D: fresh produce are not related to the act of applying lotion whatsoever.
5. Option E: headache is not typically associated with applying lotion unless it's a specific type of medicinal lotion, which is not mentioned in the question.
6. Therefore, option C: smooth skin is the answer since it's the most direct reason why people use lotion: to nourish and soften their skin. This aligns with the implications of the task realized by the person as described in the question.
So the final answer is C: smooth skin

Input: They burned the record, they were trying to do what to history? Choices:  A: compact disc B: tape C: rewrite D: play music E: erase
Output: 1. The question is essentially metaphorical and requires understanding the implied meaning of the action given, which is "burning the record".
2. In this context, the record doesn't refer to a musical record but it can be understood as a reference to historical records or documents.
3. When you burn a record, you are essentially destroying the document or whatever is recorded on it.
4. This brings us to consider what it might symbolize when someone destroys a historical document or record. Basically, they are trying to remove or eliminate that piece of history. 
5. Looking at the given choices, we need to pick the one that closely resembles this symbolic action of removing or eliminating. The options "compact disc", "tape", "rewrite", "play music", do not carry this implication.
6. Only the option "E: erase" fits this context. Erasing something means removing or eliminating it completely, which aligns perfectly with the act of burning a record which would ultimately remove or eliminate the historical document.
7. Therefore, the
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o9-tcommonsenseqa-s10-rTrue
Loading extension module utils...
Time to load utils op: 0.7073380947113037 seconds
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.8052995204925537 seconds
Time to load utils op: 0.8050985336303711 seconds
Evaluating gsm8k :   1%|▋                                                                                  | 1/125 [00:12<25:16, 12.23s/it]Evaluating gsm8k :   2%|█▎                                                                                 | 2/125 [00:35<38:09, 18.62s/it]Evaluating gsm8k :   2%|█▉                                                                                 | 3/125 [00:58<42:05, 20.70s/it]Evaluating gsm8k :   3%|██▋                                                                                | 4/125 [01:21<43:40, 21.66s/it]Evaluating gsm8k :   4%|███▎                                                                               | 5/125 [01:31<34:45, 17.38s/it]Evaluating gsm8k :   5%|███▉                                                                               | 6/125 [01:54<38:20, 19.33s/it]Evaluating gsm8k :   6%|████▋                                                                              | 7/125 [02:00<29:09, 14.82s/it]Evaluating gsm8k :   6%|█████▎                                                                             | 8/125 [02:02<21:25, 10.99s/it]Evaluating gsm8k :   7%|█████▉                                                                             | 9/125 [02:23<27:21, 14.15s/it]Evaluating gsm8k :   8%|██████▌                                                                           | 10/125 [02:47<32:31, 16.97s/it]Evaluating gsm8k :   9%|███████▏                                                                          | 11/125 [03:10<35:51, 18.88s/it]Evaluating gsm8k :  10%|███████▊                                                                          | 12/125 [03:33<38:00, 20.19s/it]Evaluating gsm8k :  10%|████████▌                                                                         | 13/125 [03:53<37:15, 19.96s/it]Evaluating gsm8k :  11%|█████████▏                                                                        | 14/125 [04:16<38:43, 20.93s/it]Evaluating gsm8k :  12%|█████████▊                                                                        | 15/125 [04:28<33:44, 18.40s/it]Evaluating gsm8k :  13%|██████████▍                                                                       | 16/125 [04:52<36:04, 19.86s/it]Evaluating gsm8k :  14%|███████████▏                                                                      | 17/125 [05:08<33:39, 18.70s/it]Evaluating gsm8k :  14%|███████████▊                                                                      | 18/125 [05:31<35:46, 20.06s/it]Evaluating gsm8k :  15%|████████████▍                                                                     | 19/125 [05:54<37:04, 20.99s/it]Evaluating gsm8k :  16%|█████████████                                                                     | 20/125 [06:17<37:50, 21.63s/it]Evaluating gsm8k :  17%|█████████████▊                                                                    | 21/125 [06:40<38:20, 22.12s/it]Evaluating gsm8k :  18%|██████████████▍                                                                   | 22/125 [07:03<38:29, 22.43s/it]Evaluating gsm8k :  18%|███████████████                                                                   | 23/125 [07:27<38:32, 22.67s/it]Evaluating gsm8k :  19%|███████████████▋                                                                  | 24/125 [07:44<35:32, 21.12s/it]Evaluating gsm8k :  20%|████████████████▍                                                                 | 25/125 [08:07<36:14, 21.75s/it]Evaluating gsm8k :  21%|█████████████████                                                                 | 26/125 [08:31<36:36, 22.19s/it]Evaluating gsm8k :  22%|█████████████████▋                                                                | 27/125 [08:54<36:46, 22.51s/it]Evaluating gsm8k :  22%|██████████████████▎                                                               | 28/125 [09:17<36:40, 22.68s/it]Evaluating gsm8k :  23%|███████████████████                                                               | 29/125 [09:40<36:31, 22.83s/it]Evaluating gsm8k :  24%|███████████████████▋                                                              | 30/125 [10:03<36:17, 22.92s/it]Evaluating gsm8k :  25%|████████████████████▎                                                             | 31/125 [10:26<36:02, 23.00s/it]Evaluating gsm8k :  26%|████████████████████▉                                                             | 32/125 [10:38<30:09, 19.46s/it]Evaluating gsm8k :  26%|█████████████████████▋                                                            | 33/125 [10:57<29:53, 19.50s/it]Evaluating gsm8k :  27%|██████████████████████▎                                                           | 34/125 [11:18<30:03, 19.82s/it]Evaluating gsm8k :  28%|██████████████████████▉                                                           | 35/125 [11:33<27:25, 18.29s/it]Evaluating gsm8k :  29%|███████████████████████▌                                                          | 36/125 [11:56<29:17, 19.75s/it]Evaluating gsm8k :  30%|████████████████████████▎                                                         | 37/125 [12:19<30:31, 20.81s/it]Evaluating gsm8k :  30%|████████████████████████▉                                                         | 38/125 [12:42<31:11, 21.51s/it]Evaluating gsm8k :  31%|█████████████████████████▌                                                        | 39/125 [13:05<31:31, 21.99s/it]Evaluating gsm8k :  32%|██████████████████████████▏                                                       | 40/125 [13:28<31:40, 22.36s/it]Evaluating gsm8k :  33%|██████████████████████████▉                                                       | 41/125 [13:46<29:14, 20.88s/it]Evaluating gsm8k :  34%|███████████████████████████▌                                                      | 42/125 [14:09<29:52, 21.59s/it]Evaluating gsm8k :  34%|████████████████████████████▏                                                     | 43/125 [14:30<29:23, 21.51s/it]Evaluating gsm8k :  35%|████████████████████████████▊                                                     | 44/125 [14:54<29:42, 22.01s/it]Evaluating gsm8k :  36%|█████████████████████████████▌                                                    | 45/125 [15:17<29:47, 22.35s/it]Evaluating gsm8k :  37%|██████████████████████████████▏                                                   | 46/125 [15:40<29:43, 22.57s/it]Evaluating gsm8k :  38%|██████████████████████████████▊                                                   | 47/125 [16:03<29:36, 22.77s/it]Evaluating gsm8k :  38%|███████████████████████████████▍                                                  | 48/125 [16:13<24:10, 18.83s/it]Evaluating gsm8k :  39%|████████████████████████████████▏                                                 | 49/125 [16:36<25:29, 20.12s/it]Evaluating gsm8k :  40%|████████████████████████████████▊                                                 | 50/125 [16:55<24:45, 19.81s/it]Evaluating gsm8k :  41%|█████████████████████████████████▍                                                | 51/125 [17:05<21:00, 17.03s/it]Evaluating gsm8k :  42%|██████████████████████████████████                                                | 52/125 [17:29<22:57, 18.87s/it]Evaluating gsm8k :  42%|██████████████████████████████████▊                                               | 53/125 [17:52<24:11, 20.17s/it]Evaluating gsm8k :  43%|███████████████████████████████████▍                                              | 54/125 [18:15<24:57, 21.10s/it]Evaluating gsm8k :  44%|████████████████████████████████████                                              | 55/125 [18:37<24:45, 21.22s/it]Evaluating gsm8k :  45%|████████████████████████████████████▋                                             | 56/125 [18:55<23:23, 20.34s/it]Evaluating gsm8k :  46%|█████████████████████████████████████▍                                            | 57/125 [19:18<24:01, 21.20s/it]Evaluating gsm8k :  46%|██████████████████████████████████████                                            | 58/125 [19:41<24:19, 21.79s/it]Evaluating gsm8k :  47%|██████████████████████████████████████▋                                           | 59/125 [19:44<17:43, 16.11s/it]Evaluating gsm8k :  48%|███████████████████████████████████████▎                                          | 60/125 [20:07<19:45, 18.24s/it]Evaluating gsm8k :  49%|████████████████████████████████████████                                          | 61/125 [20:27<19:53, 18.65s/it]Evaluating gsm8k :  50%|████████████████████████████████████████▋                                         | 62/125 [20:50<21:00, 20.00s/it]Evaluating gsm8k :  50%|█████████████████████████████████████████▎                                        | 63/125 [21:13<21:38, 20.95s/it]Evaluating gsm8k :  51%|█████████████████████████████████████████▉                                        | 64/125 [21:36<21:58, 21.61s/it]Evaluating gsm8k :  52%|██████████████████████████████████████████▋                                       | 65/125 [22:00<22:03, 22.06s/it]Evaluating gsm8k :  53%|███████████████████████████████████████████▎                                      | 66/125 [22:16<20:08, 20.48s/it]Evaluating gsm8k :  54%|███████████████████████████████████████████▉                                      | 67/125 [22:39<20:33, 21.27s/it]Evaluating gsm8k :  54%|████████████████████████████████████████████▌                                     | 68/125 [23:01<20:12, 21.27s/it]Evaluating gsm8k :  55%|█████████████████████████████████████████████▎                                    | 69/125 [23:18<18:52, 20.23s/it]Evaluating gsm8k :  56%|█████████████████████████████████████████████▉                                    | 70/125 [23:42<19:20, 21.09s/it]Evaluating gsm8k :  57%|██████████████████████████████████████████████▌                                   | 71/125 [24:05<19:31, 21.70s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▏                                  | 72/125 [24:28<19:33, 22.14s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▉                                  | 73/125 [24:51<19:28, 22.48s/it]Evaluating gsm8k :  59%|████████████████████████████████████████████████▌                                 | 74/125 [25:14<19:16, 22.67s/it]Evaluating gsm8k :  60%|█████████████████████████████████████████████████▏                                | 75/125 [25:37<19:01, 22.83s/it]Evaluating gsm8k :  61%|█████████████████████████████████████████████████▊                                | 76/125 [26:01<18:42, 22.91s/it]Evaluating gsm8k :  62%|██████████████████████████████████████████████████▌                               | 77/125 [26:24<18:23, 22.98s/it]Evaluating gsm8k :  62%|███████████████████████████████████████████████████▏                              | 78/125 [26:47<18:03, 23.05s/it]Evaluating gsm8k :  63%|███████████████████████████████████████████████████▊                              | 79/125 [27:10<17:41, 23.08s/it]Evaluating gsm8k :  64%|████████████████████████████████████████████████████▍                             | 80/125 [27:33<17:20, 23.13s/it]Evaluating gsm8k :  65%|█████████████████████████████████████████████████████▏                            | 81/125 [27:56<16:57, 23.14s/it]Evaluating gsm8k :  66%|█████████████████████████████████████████████████████▊                            | 82/125 [28:20<16:35, 23.16s/it]Evaluating gsm8k :  66%|██████████████████████████████████████████████████████▍                           | 83/125 [28:43<16:12, 23.16s/it]Evaluating gsm8k :  67%|███████████████████████████████████████████████████████                           | 84/125 [29:06<15:48, 23.13s/it]Evaluating gsm8k :  68%|███████████████████████████████████████████████████████▊                          | 85/125 [29:29<15:26, 23.17s/it]Evaluating gsm8k :  69%|████████████████████████████████████████████████████████▍                         | 86/125 [29:52<15:04, 23.18s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████                         | 87/125 [30:15<14:39, 23.15s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████▋                        | 88/125 [30:39<14:16, 23.16s/it]Evaluating gsm8k :  71%|██████████████████████████████████████████████████████████▍                       | 89/125 [30:46<11:07, 18.55s/it]Evaluating gsm8k :  72%|███████████████████████████████████████████████████████████                       | 90/125 [31:10<11:38, 19.94s/it]Evaluating gsm8k :  73%|███████████████████████████████████████████████████████████▋                      | 91/125 [31:22<10:00, 17.65s/it]Evaluating gsm8k :  74%|████████████████████████████████████████████████████████████▎                     | 92/125 [31:45<10:36, 19.30s/it]Evaluating gsm8k :  74%|█████████████████████████████████████████████████████████████                     | 93/125 [32:08<10:54, 20.44s/it]Evaluating gsm8k :  75%|█████████████████████████████████████████████████████████████▋                    | 94/125 [32:31<10:59, 21.26s/it]Evaluating gsm8k :  76%|██████████████████████████████████████████████████████████████▎                   | 95/125 [32:55<10:55, 21.84s/it]Evaluating gsm8k :  77%|██████████████████████████████████████████████████████████████▉                   | 96/125 [33:18<10:44, 22.23s/it]Evaluating gsm8k :  78%|███████████████████████████████████████████████████████████████▋                  | 97/125 [33:41<10:30, 22.53s/it]Evaluating gsm8k :  78%|████████████████████████████████████████████████████████████████▎                 | 98/125 [34:04<10:13, 22.71s/it]Evaluating gsm8k :  79%|████████████████████████████████████████████████████████████████▉                 | 99/125 [34:27<09:53, 22.83s/it]Evaluating gsm8k :  80%|████████████████████████████████████████████████████████████████▊                | 100/125 [34:50<09:33, 22.93s/it]Evaluating gsm8k :  81%|█████████████████████████████████████████████████████████████████▍               | 101/125 [35:13<09:10, 22.94s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████               | 102/125 [35:36<08:48, 22.98s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████▋              | 103/125 [36:00<08:27, 23.06s/it]Evaluating gsm8k :  83%|███████████████████████████████████████████████████████████████████▍             | 104/125 [36:03<05:57, 17.03s/it]Evaluating gsm8k :  84%|████████████████████████████████████████████████████████████████████             | 105/125 [36:21<05:50, 17.52s/it]Evaluating gsm8k :  85%|████████████████████████████████████████████████████████████████████▋            | 106/125 [36:45<06:05, 19.26s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▎           | 107/125 [37:08<06:07, 20.42s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▉           | 108/125 [37:31<06:01, 21.26s/it]Evaluating gsm8k :  87%|██████████████████████████████████████████████████████████████████████▋          | 109/125 [37:54<05:49, 21.83s/it]Evaluating gsm8k :  88%|███████████████████████████████████████████████████████████████████████▎         | 110/125 [38:17<05:33, 22.23s/it]Evaluating gsm8k :  89%|███████████████████████████████████████████████████████████████████████▉         | 111/125 [38:40<05:14, 22.49s/it]Evaluating gsm8k :  90%|████████████████████████████████████████████████████████████████████████▌        | 112/125 [39:04<04:55, 22.72s/it]Evaluating gsm8k :  90%|█████████████████████████████████████████████████████████████████████████▏       | 113/125 [39:27<04:34, 22.85s/it]Evaluating gsm8k :  91%|█████████████████████████████████████████████████████████████████████████▊       | 114/125 [39:50<04:12, 22.93s/it]Evaluating gsm8k :  92%|██████████████████████████████████████████████████████████████████████████▌      | 115/125 [40:13<03:50, 23.01s/it]Evaluating gsm8k :  93%|███████████████████████████████████████████████████████████████████████████▏     | 116/125 [40:36<03:27, 23.06s/it]Evaluating gsm8k :  94%|███████████████████████████████████████████████████████████████████████████▊     | 117/125 [40:59<03:04, 23.06s/it]Evaluating gsm8k :  94%|████████████████████████████████████████████████████████████████████████████▍    | 118/125 [41:18<02:33, 21.87s/it]Evaluating gsm8k :  95%|█████████████████████████████████████████████████████████████████████████████    | 119/125 [41:41<02:13, 22.23s/it]Evaluating gsm8k :  96%|█████████████████████████████████████████████████████████████████████████████▊   | 120/125 [42:05<01:52, 22.53s/it]Evaluating gsm8k :  97%|██████████████████████████████████████████████████████████████████████████████▍  | 121/125 [42:28<01:30, 22.68s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████  | 122/125 [42:51<01:08, 22.76s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████▋ | 123/125 [43:14<00:45, 22.87s/it]Evaluating gsm8k :  99%|████████████████████████████████████████████████████████████████████████████████▎| 124/125 [43:37<00:22, 22.92s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [44:00<00:00, 22.97s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [44:00<00:00, 21.12s/it]
name: gsm8k | {'exact_match': 0.0, 'rougeL': 0.0715} | lm_loss 12.2578 | avg. gen lenth: 356.36
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name gsm8k --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name commonsenseqa --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 2 --data-dir /scratch/ylu130/processed_data/gsm8k/out-domain/o1-tcommonsenseqa-s10-rFalse --seed 10 --max-prompt-length 2048 --num-out-domain 1
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-18 10:43:54,692] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... gsm8k
  data_dir ..................... /scratch/ylu130/processed_data/gsm8k/out-domain/o1-tcommonsenseqa-s10-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 1
  out_domain_data_name ......... commonsenseqa
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o1-tcommonsenseqa-s10-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 2
  clip_grad .................... 1.0
  seed ......................... 10
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                                             | 0/7473 [00:00<?, ?it/s]  3%|███▎                                                                                             | 258/7473 [00:00<00:02, 2578.62it/s]  7%|██████▋                                                                                          | 518/7473 [00:00<00:02, 2586.93it/s] 11%|██████████▏                                                                                      | 785/7473 [00:00<00:02, 2621.68it/s] 14%|█████████████▌                                                                                  | 1052/7473 [00:00<00:02, 2638.33it/s] 18%|████████████████▉                                                                               | 1317/7473 [00:00<00:02, 2642.00it/s] 21%|████████████████████▎                                                                           | 1582/7473 [00:00<00:02, 2632.93it/s] 25%|███████████████████████▋                                                                        | 1846/7473 [00:00<00:02, 2626.69it/s] 28%|███████████████████████████                                                                     | 2109/7473 [00:00<00:02, 2627.19it/s] 32%|██████████████████████████████▍                                                                 | 2372/7473 [00:00<00:01, 2577.11it/s] 35%|█████████████████████████████████▊                                                              | 2630/7473 [00:01<00:01, 2556.74it/s] 39%|█████████████████████████████████████▏                                                          | 2899/7473 [00:01<00:01, 2593.61it/s] 42%|████████████████████████████████████████▋                                                       | 3164/7473 [00:01<00:01, 2607.86it/s] 46%|███████████████████████████████████████████▉                                                    | 3425/7473 [00:01<00:01, 2607.45it/s] 49%|███████████████████████████████████████████████▎                                                | 3686/7473 [00:01<00:01, 2603.83it/s] 53%|██████████████████████████████████████████████████▋                                             | 3947/7473 [00:01<00:01, 2605.33it/s] 56%|██████████████████████████████████████████████████████                                          | 4208/7473 [00:01<00:01, 2605.95it/s] 60%|█████████████████████████████████████████████████████████▍                                      | 4469/7473 [00:01<00:01, 2604.95it/s] 63%|████████████████████████████████████████████████████████████▊                                   | 4732/7473 [00:01<00:01, 2610.77it/s] 67%|████████████████████████████████████████████████████████████████▏                               | 4994/7473 [00:01<00:00, 2609.24it/s] 70%|███████████████████████████████████████████████████████████████████▌                            | 5255/7473 [00:02<00:00, 2595.71it/s] 74%|██████████████████████████████████████████████████████████████████████▊                         | 5515/7473 [00:02<00:00, 2178.61it/s] 77%|██████████████████████████████████████████████████████████████████████████▏                     | 5778/7473 [00:02<00:00, 2295.80it/s] 81%|█████████████████████████████████████████████████████████████████████████████▌                  | 6035/7473 [00:02<00:00, 2368.41it/s] 84%|████████████████████████████████████████████████████████████████████████████████▉               | 6302/7473 [00:02<00:00, 2452.24it/s] 88%|████████████████████████████████████████████████████████████████████████████████████▎           | 6563/7473 [00:02<00:00, 2496.53it/s] 93%|████████████████████████████████████████████████████████████████████████████████████████▊       | 6918/7473 [00:02<00:00, 2800.86it/s] 98%|█████████████████████████████████████████████████████████████████████████████████████████████▉  | 7315/7473 [00:02<00:00, 3141.68it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████| 7473/7473 [00:02<00:00, 2647.90it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.17s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.09s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.19s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:11,  5.61s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.05s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.05s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.19s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.40s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.44s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.61s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.43s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.61s/it]
[2023-08-18 10:44:48,549] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.59s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.74s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.76s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.96s/it]
[2023-08-18 10:44:58,187] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-18 10:44:58,188] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-18 10:44:58,188] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-18 10:44:58,188] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-18 10:44:58,188] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-18 10:44:58,188] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-18 10:44:58,188] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-18 10:44:58,188] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-18 10:44:58,188] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-18 10:44:58,188] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fb8591fe370>
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7fb8591fe190>
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   train_batch_size ............. 8
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  2
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-18 10:44:58,189] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-18 10:44:58,190] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-18 10:44:58,190] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-18 10:44:58,190] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-18 10:44:58,190] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.37658238410949707 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating gsm8k :   0%|                                                                                           | 0/125 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following grade math question.

Input: Fabric is cut to order at what type of seller? Choices:  A: curtains B: tailor shop C: clothing store D: sewing room E: hardware store
Output: B: tailor shop

Input:Natalia sold clips to 48 of her friends in April, and then she sold half as many clips in May. How many clips did Natalia sell altogether in April and May?
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o1-tcommonsenseqa-s10-rFalse
Loading extension module utils...
Time to load utils op: 0.3086209297180176 seconds
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.4047536849975586 seconds
Time to load utils op: 0.40469884872436523 seconds
Evaluating gsm8k :   1%|▋                                                                                  | 1/125 [00:06<13:47,  6.68s/it]Evaluating gsm8k :   2%|█▎                                                                                 | 2/125 [00:36<41:18, 20.15s/it]Evaluating gsm8k :   2%|█▉                                                                                 | 3/125 [00:42<28:09, 13.85s/it]Evaluating gsm8k :   3%|██▋                                                                                | 4/125 [01:12<40:40, 20.17s/it]Evaluating gsm8k :   4%|███▎                                                                               | 5/125 [01:40<46:14, 23.12s/it]Evaluating gsm8k :   5%|███▉                                                                               | 6/125 [01:56<40:58, 20.66s/it]Evaluating gsm8k :   6%|████▋                                                                              | 7/125 [02:04<32:21, 16.46s/it]Evaluating gsm8k :   6%|█████▎                                                                             | 8/125 [02:28<36:50, 18.89s/it]Evaluating gsm8k :   7%|█████▉                                                                             | 9/125 [02:58<43:26, 22.47s/it]Evaluating gsm8k :   8%|██████▌                                                                           | 10/125 [03:14<39:08, 20.42s/it]Evaluating gsm8k :   9%|███████▏                                                                          | 11/125 [03:21<30:46, 16.20s/it]Evaluating gsm8k :  10%|███████▊                                                                          | 12/125 [03:51<38:11, 20.28s/it]Evaluating gsm8k :  10%|████████▌                                                                         | 13/125 [03:54<28:11, 15.11s/it]Evaluating gsm8k :  11%|█████████▏                                                                        | 14/125 [04:10<28:41, 15.51s/it]Evaluating gsm8k :  12%|█████████▊                                                                        | 15/125 [04:41<36:37, 19.98s/it]Evaluating gsm8k :  13%|██████████▍                                                                       | 16/125 [04:48<29:39, 16.33s/it]Evaluating gsm8k :  14%|███████████▏                                                                      | 17/125 [05:00<26:43, 14.84s/it]Evaluating gsm8k :  14%|███████████▊                                                                      | 18/125 [05:18<28:05, 15.75s/it]Evaluating gsm8k :  15%|████████████▍                                                                     | 19/125 [05:24<23:05, 13.07s/it]Evaluating gsm8k :  16%|█████████████                                                                     | 20/125 [05:55<32:03, 18.32s/it]Evaluating gsm8k :  17%|█████████████▊                                                                    | 21/125 [06:05<27:32, 15.89s/it]Evaluating gsm8k :  18%|██████████████▍                                                                   | 22/125 [06:35<34:29, 20.09s/it]Evaluating gsm8k :  18%|███████████████                                                                   | 23/125 [06:51<31:52, 18.75s/it]Evaluating gsm8k :  19%|███████████████▋                                                                  | 24/125 [06:59<26:18, 15.63s/it]Evaluating gsm8k :  20%|████████████████▍                                                                 | 25/125 [07:29<32:59, 19.80s/it]Evaluating gsm8k :  21%|█████████████████                                                                 | 26/125 [07:32<24:20, 14.76s/it]Evaluating gsm8k :  22%|█████████████████▋                                                                | 27/125 [07:53<27:27, 16.81s/it]Evaluating gsm8k :  22%|██████████████████▎                                                               | 28/125 [08:23<33:33, 20.76s/it]Evaluating gsm8k :  23%|███████████████████                                                               | 29/125 [08:53<37:31, 23.45s/it]Evaluating gsm8k :  24%|███████████████████▋                                                              | 30/125 [09:24<40:31, 25.60s/it]Evaluating gsm8k :  25%|████████████████████▎                                                             | 31/125 [09:54<42:15, 26.97s/it]Evaluating gsm8k :  26%|████████████████████▉                                                             | 32/125 [09:59<31:50, 20.54s/it]Evaluating gsm8k :  26%|█████████████████████▋                                                            | 33/125 [10:12<27:56, 18.23s/it]Evaluating gsm8k :  27%|██████████████████████▎                                                           | 34/125 [10:42<32:53, 21.68s/it]Evaluating gsm8k :  28%|██████████████████████▉                                                           | 35/125 [10:57<29:29, 19.66s/it]Evaluating gsm8k :  29%|███████████████████████▌                                                          | 36/125 [11:02<22:54, 15.45s/it]Evaluating gsm8k :  30%|████████████████████████▎                                                         | 37/125 [11:05<16:55, 11.54s/it]Evaluating gsm8k :  30%|████████████████████████▉                                                         | 38/125 [11:18<17:17, 11.93s/it]Evaluating gsm8k :  31%|█████████████████████████▌                                                        | 39/125 [11:20<13:03,  9.11s/it]Evaluating gsm8k :  32%|██████████████████████████▏                                                       | 40/125 [11:43<18:41, 13.19s/it]Evaluating gsm8k :  33%|██████████████████████████▉                                                       | 41/125 [12:06<22:26, 16.03s/it]Evaluating gsm8k :  34%|███████████████████████████▌                                                      | 42/125 [12:16<19:55, 14.40s/it]Evaluating gsm8k :  34%|████████████████████████████▏                                                     | 43/125 [12:46<26:05, 19.09s/it]Evaluating gsm8k :  35%|████████████████████████████▊                                                     | 44/125 [13:16<30:01, 22.24s/it]Evaluating gsm8k :  36%|█████████████████████████████▌                                                    | 45/125 [13:38<29:33, 22.17s/it]Evaluating gsm8k :  37%|██████████████████████████████▏                                                   | 46/125 [13:54<27:01, 20.53s/it]Evaluating gsm8k :  38%|██████████████████████████████▊                                                   | 47/125 [14:12<25:39, 19.74s/it]Evaluating gsm8k :  38%|███████████████████████████████▍                                                  | 48/125 [14:22<21:38, 16.87s/it]Evaluating gsm8k :  39%|████████████████████████████████▏                                                 | 49/125 [14:35<19:37, 15.49s/it]Evaluating gsm8k :  40%|████████████████████████████████▊                                                 | 50/125 [14:58<22:07, 17.70s/it]Evaluating gsm8k :  41%|█████████████████████████████████▍                                                | 51/125 [15:28<26:26, 21.44s/it]Evaluating gsm8k :  42%|██████████████████████████████████                                                | 52/125 [15:58<29:12, 24.01s/it]Evaluating gsm8k :  42%|██████████████████████████████████▊                                               | 53/125 [16:27<30:46, 25.65s/it]Evaluating gsm8k :  43%|███████████████████████████████████▍                                              | 54/125 [16:58<32:09, 27.17s/it]Evaluating gsm8k :  44%|████████████████████████████████████                                              | 55/125 [17:06<25:05, 21.51s/it]Evaluating gsm8k :  45%|████████████████████████████████████▋                                             | 56/125 [17:26<24:10, 21.02s/it]Evaluating gsm8k :  46%|█████████████████████████████████████▍                                            | 57/125 [17:33<18:56, 16.72s/it]Evaluating gsm8k :  46%|██████████████████████████████████████                                            | 58/125 [18:02<22:58, 20.57s/it]Evaluating gsm8k :  47%|██████████████████████████████████████▋                                           | 59/125 [18:32<25:37, 23.29s/it]Evaluating gsm8k :  48%|███████████████████████████████████████▎                                          | 60/125 [18:57<25:38, 23.67s/it]Evaluating gsm8k :  49%|████████████████████████████████████████                                          | 61/125 [19:05<20:15, 18.99s/it]Evaluating gsm8k :  50%|████████████████████████████████████████▋                                         | 62/125 [19:34<23:14, 22.14s/it]Evaluating gsm8k :  50%|█████████████████████████████████████████▎                                        | 63/125 [20:05<25:27, 24.64s/it]Evaluating gsm8k :  51%|█████████████████████████████████████████▉                                        | 64/125 [20:35<26:53, 26.44s/it]Evaluating gsm8k :  52%|██████████████████████████████████████████▋                                       | 65/125 [20:43<20:50, 20.84s/it]Evaluating gsm8k :  53%|███████████████████████████████████████████▎                                      | 66/125 [20:56<18:09, 18.46s/it]Evaluating gsm8k :  54%|███████████████████████████████████████████▉                                      | 67/125 [21:24<20:29, 21.20s/it]Evaluating gsm8k :  54%|████████████████████████████████████████████▌                                     | 68/125 [21:33<16:54, 17.80s/it]Evaluating gsm8k :  55%|█████████████████████████████████████████████▎                                    | 69/125 [22:04<20:04, 21.51s/it]Evaluating gsm8k :  56%|█████████████████████████████████████████████▉                                    | 70/125 [22:19<18:06, 19.75s/it]Evaluating gsm8k :  57%|██████████████████████████████████████████████▌                                   | 71/125 [22:37<17:15, 19.17s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▏                                  | 72/125 [22:54<16:21, 18.51s/it]Evaluating gsm8k :  58%|███████████████████████████████████████████████▉                                  | 73/125 [23:24<18:54, 21.82s/it]Evaluating gsm8k :  59%|████████████████████████████████████████████████▌                                 | 74/125 [23:53<20:32, 24.17s/it]Evaluating gsm8k :  60%|█████████████████████████████████████████████████▏                                | 75/125 [24:18<20:10, 24.20s/it]Evaluating gsm8k :  61%|█████████████████████████████████████████████████▊                                | 76/125 [24:47<21:02, 25.77s/it]Evaluating gsm8k :  62%|██████████████████████████████████████████████████▌                               | 77/125 [25:18<21:50, 27.30s/it]Evaluating gsm8k :  62%|███████████████████████████████████████████████████▏                              | 78/125 [25:48<22:00, 28.09s/it]Evaluating gsm8k :  63%|███████████████████████████████████████████████████▊                              | 79/125 [25:57<17:09, 22.39s/it]Evaluating gsm8k :  64%|████████████████████████████████████████████████████▍                             | 80/125 [26:27<18:31, 24.71s/it]Evaluating gsm8k :  65%|█████████████████████████████████████████████████████▏                            | 81/125 [26:32<13:51, 18.90s/it]Evaluating gsm8k :  66%|█████████████████████████████████████████████████████▊                            | 82/125 [26:37<10:35, 14.78s/it]Evaluating gsm8k :  66%|██████████████████████████████████████████████████████▍                           | 83/125 [26:55<11:01, 15.74s/it]Evaluating gsm8k :  67%|███████████████████████████████████████████████████████                           | 84/125 [27:25<13:39, 20.00s/it]Evaluating gsm8k :  68%|███████████████████████████████████████████████████████▊                          | 85/125 [27:56<15:26, 23.16s/it]Evaluating gsm8k :  69%|████████████████████████████████████████████████████████▍                         | 86/125 [28:17<14:36, 22.48s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████                         | 87/125 [28:32<12:50, 20.28s/it]Evaluating gsm8k :  70%|█████████████████████████████████████████████████████████▋                        | 88/125 [28:45<11:07, 18.04s/it]Evaluating gsm8k :  71%|██████████████████████████████████████████████████████████▍                       | 89/125 [28:49<08:19, 13.88s/it]Evaluating gsm8k :  72%|███████████████████████████████████████████████████████████                       | 90/125 [28:53<06:26, 11.05s/it]Evaluating gsm8k :  73%|███████████████████████████████████████████████████████████▋                      | 91/125 [29:24<09:31, 16.80s/it]Evaluating gsm8k :  74%|████████████████████████████████████████████████████████████▎                     | 92/125 [29:43<09:38, 17.53s/it]Evaluating gsm8k :  74%|█████████████████████████████████████████████████████████████                     | 93/125 [29:57<08:45, 16.42s/it]Evaluating gsm8k :  75%|█████████████████████████████████████████████████████████████▋                    | 94/125 [30:11<08:10, 15.81s/it]Evaluating gsm8k :  76%|██████████████████████████████████████████████████████████████▎                   | 95/125 [30:37<09:22, 18.75s/it]Evaluating gsm8k :  77%|██████████████████████████████████████████████████████████████▉                   | 96/125 [31:06<10:36, 21.96s/it]Evaluating gsm8k :  78%|███████████████████████████████████████████████████████████████▋                  | 97/125 [31:30<10:32, 22.59s/it]Evaluating gsm8k :  78%|████████████████████████████████████████████████████████████████▎                 | 98/125 [31:49<09:42, 21.57s/it]Evaluating gsm8k :  79%|████████████████████████████████████████████████████████████████▉                 | 99/125 [31:52<06:50, 15.79s/it]Evaluating gsm8k :  80%|████████████████████████████████████████████████████████████████▊                | 100/125 [32:22<08:21, 20.08s/it]Evaluating gsm8k :  81%|█████████████████████████████████████████████████████████████████▍               | 101/125 [32:52<09:12, 23.02s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████               | 102/125 [33:22<09:36, 25.09s/it]Evaluating gsm8k :  82%|██████████████████████████████████████████████████████████████████▋              | 103/125 [33:36<08:03, 21.96s/it]Evaluating gsm8k :  83%|███████████████████████████████████████████████████████████████████▍             | 104/125 [33:50<06:51, 19.61s/it]Evaluating gsm8k :  84%|████████████████████████████████████████████████████████████████████             | 105/125 [34:07<06:13, 18.68s/it]Evaluating gsm8k :  85%|████████████████████████████████████████████████████████████████████▋            | 106/125 [34:37<06:57, 21.99s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▎           | 107/125 [35:07<07:20, 24.47s/it]Evaluating gsm8k :  86%|█████████████████████████████████████████████████████████████████████▉           | 108/125 [35:36<07:22, 26.01s/it]Evaluating gsm8k :  87%|██████████████████████████████████████████████████████████████████████▋          | 109/125 [36:04<07:02, 26.38s/it]Evaluating gsm8k :  88%|███████████████████████████████████████████████████████████████████████▎         | 110/125 [36:33<06:50, 27.40s/it]Evaluating gsm8k :  89%|███████████████████████████████████████████████████████████████████████▉         | 111/125 [37:03<06:33, 28.09s/it]Evaluating gsm8k :  90%|████████████████████████████████████████████████████████████████████████▌        | 112/125 [37:24<05:36, 25.90s/it]Evaluating gsm8k :  90%|█████████████████████████████████████████████████████████████████████████▏       | 113/125 [37:42<04:43, 23.62s/it]Evaluating gsm8k :  91%|█████████████████████████████████████████████████████████████████████████▊       | 114/125 [37:45<03:10, 17.27s/it]Evaluating gsm8k :  92%|██████████████████████████████████████████████████████████████████████████▌      | 115/125 [38:13<03:25, 20.59s/it]Evaluating gsm8k :  93%|███████████████████████████████████████████████████████████████████████████▏     | 116/125 [38:19<02:26, 16.32s/it]Evaluating gsm8k :  94%|███████████████████████████████████████████████████████████████████████████▊     | 117/125 [38:50<02:44, 20.54s/it]Evaluating gsm8k :  94%|████████████████████████████████████████████████████████████████████████████▍    | 118/125 [39:20<02:43, 23.39s/it]Evaluating gsm8k :  95%|█████████████████████████████████████████████████████████████████████████████    | 119/125 [39:28<01:52, 18.72s/it]Evaluating gsm8k :  96%|█████████████████████████████████████████████████████████████████████████████▊   | 120/125 [39:54<01:44, 20.88s/it]Evaluating gsm8k :  97%|██████████████████████████████████████████████████████████████████████████████▍  | 121/125 [40:14<01:22, 20.67s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████  | 122/125 [40:29<00:57, 19.06s/it]Evaluating gsm8k :  98%|███████████████████████████████████████████████████████████████████████████████▋ | 123/125 [40:55<00:42, 21.14s/it]Evaluating gsm8k :  99%|████████████████████████████████████████████████████████████████████████████████▎| 124/125 [41:26<00:23, 23.99s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [41:56<00:00, 25.77s/it]Evaluating gsm8k : 100%|█████████████████████████████████████████████████████████████████████████████████| 125/125 [41:56<00:00, 20.13s/it]
name: gsm8k | {'exact_match': 0.4, 'rougeL': 0.9799} | lm_loss 9.9254 | avg. gen lenth: 235.9
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2113 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name gsm8k --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name commonsenseqa --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 2 --data-dir /scratch/ylu130/processed_data/gsm8k/out-domain/o2-tcommonsenseqa-s10-rFalse --seed 10 --max-prompt-length 2048 --num-out-domain 2
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date![nltk_data]   Package punkt is already up-to-date![nltk_data]   Package punkt is already up-to-date!


[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-18 11:30:08,843] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... gsm8k
  data_dir ..................... /scratch/ylu130/processed_data/gsm8k/out-domain/o2-tcommonsenseqa-s10-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 2
  out_domain_data_name ......... commonsenseqa
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o2-tcommonsenseqa-s10-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 2
  clip_grad .................... 1.0
  seed ......................... 10
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                                             | 0/7473 [00:00<?, ?it/s]  3%|██▌                                                                                              | 197/7473 [00:00<00:03, 1968.00it/s]  5%|█████▏                                                                                           | 397/7473 [00:00<00:03, 1983.41it/s]  8%|███████▊                                                                                         | 598/7473 [00:00<00:03, 1988.96it/s] 11%|██████████▍                                                                                      | 802/7473 [00:00<00:03, 2007.95it/s] 13%|████████████▉                                                                                   | 1005/7473 [00:00<00:03, 2014.20it/s] 16%|███████████████▌                                                                                | 1208/7473 [00:00<00:03, 2016.63it/s] 19%|██████████████████                                                                              | 1410/7473 [00:00<00:03, 2012.64it/s] 22%|████████████████████▋                                                                           | 1612/7473 [00:00<00:02, 2010.63it/s] 24%|███████████████████████▎                                                                        | 1814/7473 [00:00<00:02, 1969.07it/s] 27%|█████████████████████████▊                                                                      | 2012/7473 [00:01<00:02, 1961.91it/s] 30%|████████████████████████████▍                                                                   | 2213/7473 [00:01<00:02, 1973.49it/s] 32%|███████████████████████████████                                                                 | 2414/7473 [00:01<00:02, 1982.98it/s] 35%|█████████████████████████████████▌                                                              | 2613/7473 [00:01<00:02, 1953.34it/s] 38%|████████████████████████████████████▏                                                           | 2817/7473 [00:01<00:02, 1977.74it/s] 40%|██████████████████████████████████████▊                                                         | 3022/7473 [00:01<00:02, 1997.88it/s] 43%|█████████████████████████████████████████▍                                                      | 3222/7473 [00:01<00:02, 1993.81it/s] 46%|███████████████████████████████████████████▉                                                    | 3422/7473 [00:01<00:02, 1992.57it/s] 48%|██████████████████████████████████████████████▌                                                 | 3624/7473 [00:01<00:01, 1998.57it/s] 51%|█████████████████████████████████████████████████                                               | 3824/7473 [00:01<00:01, 1984.13it/s] 54%|███████████████████████████████████████████████████▋                                            | 4025/7473 [00:02<00:01, 1989.95it/s] 57%|██████████████████████████████████████████████████████▎                                         | 4225/7473 [00:02<00:01, 1984.52it/s] 59%|████████████████████████████████████████████████████████▊                                       | 4425/7473 [00:02<00:01, 1987.56it/s] 62%|███████████████████████████████████████████████████████████▍                                    | 4626/7473 [00:02<00:01, 1992.49it/s] 65%|█████████████████████████████████████████████████████████████▉                                  | 4826/7473 [00:02<00:01, 1992.24it/s] 67%|████████████████████████████████████████████████████████████████▌                               | 5027/7473 [00:02<00:01, 1995.55it/s] 71%|████████████████████████████████████████████████████████████████████▎                           | 5315/7473 [00:02<00:00, 2257.49it/s] 74%|███████████████████████████████████████████████████████████████████████▏                        | 5541/7473 [00:02<00:01, 1866.37it/s] 78%|███████████████████████████████████████████████████████████████████████████                     | 5844/7473 [00:02<00:00, 2169.48it/s] 82%|██████████████████████████████████████████████████████████████████████████████▉                 | 6147/7473 [00:02<00:00, 2400.91it/s] 86%|██████████████████████████████████████████████████████████████████████████████████▉             | 6453/7473 [00:03<00:00, 2583.91it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████▊         | 6758/7473 [00:03<00:00, 2716.36it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████▋     | 7061/7473 [00:03<00:00, 2805.28it/s] 99%|██████████████████████████████████████████████████████████████████████████████████████████████▋ | 7366/7473 [00:03<00:00, 2876.05it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████| 7473/7473 [00:03<00:00, 2176.97it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:04<00:09,  4.93s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.22s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.24s/it]Loading checkpoint shards:  33%|█████████████████████████▋                                                   | 1/3 [00:05<00:10,  5.32s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:09<00:04,  4.99s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.10s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.31s/it]Loading checkpoint shards:  67%|███████████████████████████████████████████████████▎                         | 2/3 [00:10<00:05,  5.38s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.35s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.52s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.50s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.67s/it]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.66s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.83s/it]
[2023-08-18 11:31:03,896] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.76s/it]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.92s/it]
[2023-08-18 11:31:11,380] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-18 11:31:11,381] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-18 11:31:11,381] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-18 11:31:11,381] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-18 11:31:11,381] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-18 11:31:11,381] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f78cc1ca370>
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f78cc1ca250>
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-18 11:31:11,382] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-18 11:31:11,383] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-18 11:31:11,383] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-18 11:31:11,383] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-18 11:31:11,383] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-18 11:31:11,383] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-18 11:31:11,383] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-18 11:31:11,383] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-18 11:31:11,383] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-18 11:31:11,383] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-18 11:31:11,383] [INFO] [config.py:1012:print]   train_batch_size ............. 8
[2023-08-18 11:31:11,383] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  2
[2023-08-18 11:31:11,383] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-18 11:31:11,383] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-18 11:31:11,383] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-18 11:31:11,383] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-18 11:31:11,383] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-18 11:31:11,383] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-18 11:31:11,383] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-18 11:31:11,383] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.36273193359375 seconds
Loading extension module utils...
Time to load utils op: 0.4046354293823242 seconds
Loading extension module utils...
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Time to load utils op: 0.3041834831237793 seconds
Evaluating gsm8k :   0%|                                                                                           | 0/125 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following grade math question.

Input: Fabric is cut to order at what type of seller? Choices:  A: curtains B: tailor shop C: clothing store D: sewing room E: hardware store
Output: B: tailor shop

Input: Where are you if your reading magazines while waiting for a vehicle on rails? Choices:  A: vegetables B: market C: doctor D: train station E: bookstore
Output: D: train station

Input:Natalia sold clips to 48 of her friends in April, and then she sold half as many clips in May. How many clips did Natalia sell altogether in April and May?
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/gsm8k/out-domain/o2-tcommonsenseqa-s10-rFalse
Loading extension module utils...
Time to load utils op: 0.30444931983947754 seconds
Evaluating gsm8k :   1%|▋                                                                                  | 1/125 [00:08<18:26,  8.92s/it]Evaluating gsm8k :   2%|█▎                                                                                 | 2/125 [00:20<21:54, 10.69s/it]Evaluating gsm8k :   2%|█▉                                                                                 | 3/125 [00:47<36:44, 18.07s/it]Evaluating gsm8k :   3%|██▋                                                                                | 4/125 [01:12<42:01, 20.84s/it]Evaluating gsm8k :   4%|███▎                                                                               | 5/125 [01:42<47:58, 23.99s/it]Evaluating gsm8k :   5%|███▉                                                                               | 6/125 [02:12<51:47, 26.11s/it]Evaluating gsm8k :   6%|████▋                                                                              | 7/125 [02:41<53:18, 27.11s/it]Evaluating gsm8k :   6%|█████▎                                                                             | 8/125 [03:11<54:47, 28.10s/it]Evaluating gsm8k :   7%|█████▉                                                                             | 9/125 [03:17<40:35, 20.99s/it]Evaluating gsm8k :   8%|██████▌                                                                           | 10/125 [03:27<33:46, 17.62s/it]Evaluating gsm8k :   9%|███████▏                                                                          | 11/125 [03:52<37:59, 19.99s/it]Evaluating gsm8k :  10%|███████▊                                                                          | 12/125 [04:22<43:27, 23.07s/it]Evaluating gsm8k :  10%|████████▌                                                                         | 13/125 [04:52<46:51, 25.10s/it]Evaluating gsm8k :  11%|█████████▏                                                                        | 14/125 [05:21<48:45, 26.35s/it]Evaluating gsm8k :  12%|█████████▊                                                                        | 15/125 [05:37<42:37, 23.25s/it]Evaluating gsm8k :  13%|██████████▍                                                                       | 16/125 [06:08<46:03, 25.36s/it]Evaluating gsm8k :  14%|███████████▏                                                                      | 17/125 [06:38<48:17, 26.83s/it]Evaluating gsm8k :  14%|███████████▊                                                                      | 18/125 [07:07<49:10, 27.58s/it]Evaluating gsm8k :  15%|████████████▍                                                                     | 19/125 [07:37<49:51, 28.22s/it]Evaluating gsm8k :  16%|█████████████                                                                     | 20/125 [07:45<38:44, 22.14s/it]Evaluating gsm8k :  17%|█████████████▊                                                                    | 21/125 [08:04<36:34, 21.10s/it]Evaluating gsm8k :  18%|██████████████▍                                                                   | 22/125 [08:33<40:34, 23.64s/it]Evaluating gsm8k :  18%|███████████████                                                                   | 23/125 [08:51<37:05, 21.82s/it]Evaluating gsm8k :  19%|███████████████▋                                                                  | 24/125 [09:21<40:56, 24.33s/it]Evaluating gsm8k :  20%|████████████████▍                                                                 | 25/125 [09:36<35:47, 21.47s/it]Evaluating gsm8k :  21%|█████████████████                                                                 | 26/125 [09:43<28:18, 17.15s/it]Evaluating gsm8k :  22%|█████████████████▋                                                                | 27/125 [10:13<34:20, 21.03s/it]Evaluating gsm8k :  22%|██████████████████▎                                                               | 28/125 [10:38<35:51, 22.18s/it]Evaluating gsm8k :  23%|███████████████████                                                               | 29/125 [11:03<37:05, 23.19s/it]Evaluating gsm8k :  24%|███████████████████▋                                                              | 30/125 [11:33<39:58, 25.25s/it]Evaluating gsm8k :  25%|████████████████████▎                                                             | 31/125 [12:04<41:55, 26.76s/it]Evaluating gsm8k :  26%|████████████████████▉                                                             | 32/125 [12:13<33:31, 21.63s/it]Evaluating gsm8k :  26%|█████████████████████▋                                                            | 33/125 [12:43<36:48, 24.01s/it]Evaluating gsm8k :  27%|██████████████████████▎                                                           | 34/125 [13:08<37:04, 24.45s/it]Evaluating gsm8k :  28%|██████████████████████▉                                                           | 35/125 [13:13<27:43, 18.49s/it]Evaluating gsm8k :  29%|███████████████████████▌                                                          | 36/125 [13:35<28:55, 19.50s/it]Evaluating gsm8k :  30%|████████████████████████▎                                                         | 37/125 [13:52<27:41, 18.88s/it]Evaluating gsm8k :  30%|████████████████████████▉                                                         | 38/125 [14:03<24:00, 16.56s/it]Evaluating gsm8k :  31%|█████████████████████████▌                                                        | 39/125 [14:27<26:49, 18.71s/it]Evaluating gsm8k :  32%|██████████████████████████▏                                                       | 40/125 [14:30<19:52, 14.03s/it]Evaluating gsm8k :  33%|██████████████████████████▉                                                       | 41/125 [14:36<15:58, 11.41s/it]Evaluating gsm8k :  34%|███████████████████████████▌                                                      | 42/125 [15:06<23:44, 17.17s/it]Evaluating gsm8k :  34%|████████████████████████████▏                                                     | 43/125 [15:36<28:47, 21.07s/it]Evaluating gsm8k :  35%|████████████████████████████▊                                                     | 44/125 [16:06<31:57, 23.67s/it]Evaluating gsm8k :  36%|█████████████████████████████▌                                                    | 45/125 [16:32<32:18, 24.24s/it]Evaluating gsm8k :  37%|██████████████████████████████▏                                                   | 46/125 [16:43<26:53, 20.42s/it]Evaluating gsm8k :  38%|██████████████████████████████▊                                                   | 47/125 [16:52<22:03, 16.97s/it]Evaluating gsm8k :  38%|███████████████████████████████▍                                                  | 48/125 [17:22<26:41, 20.80s/it]Evaluating gsm8k :  39%|████████████████████████████████▏                                                 | 49/125 [17:52<29:54, 23.62s/it]