PYTHONPATH=/home/ylu130/workspace/in-context-generalization
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i0-s1-rTrue --seed 1 --max-prompt-length 2048 --rationales --num-in-domain 0
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date![nltk_data]   Package punkt is already up-to-date!

[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-21 11:42:39,283] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i0-s1-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i0-s1-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9741 [00:00<?, ?it/s]  4%|██▎                                                 | 429/9741 [00:00<00:02, 4283.35it/s]  9%|████▌                                               | 866/9741 [00:00<00:02, 4331.34it/s] 13%|██████▊                                            | 1303/9741 [00:00<00:01, 4343.70it/s] 18%|█████████                                          | 1738/9741 [00:00<00:01, 4334.85it/s] 22%|███████████▎                                       | 2172/9741 [00:00<00:01, 4284.39it/s] 27%|█████████████▌                                     | 2601/9741 [00:00<00:01, 4160.18it/s] 31%|███████████████▊                                   | 3024/9741 [00:00<00:01, 4181.76it/s] 35%|██████████████████                                 | 3454/9741 [00:00<00:01, 4217.65it/s] 40%|████████████████████▎                              | 3881/9741 [00:00<00:01, 4232.04it/s] 44%|██████████████████████▌                            | 4311/9741 [00:01<00:01, 4250.10it/s] 49%|████████████████████████▊                          | 4737/9741 [00:01<00:01, 4231.50it/s] 53%|███████████████████████████                        | 5161/9741 [00:01<00:01, 2749.23it/s] 57%|█████████████████████████████▎                     | 5592/9741 [00:01<00:01, 3090.15it/s] 62%|███████████████████████████████▋                   | 6045/9741 [00:01<00:01, 3431.27it/s] 67%|█████████████████████████████████▉                 | 6488/9741 [00:01<00:00, 3684.07it/s] 71%|████████████████████████████████████▎              | 6936/9741 [00:01<00:00, 3895.25it/s] 76%|██████████████████████████████████████▋            | 7392/9741 [00:01<00:00, 4076.29it/s] 80%|█████████████████████████████████████████          | 7841/9741 [00:01<00:00, 4190.85it/s] 85%|███████████████████████████████████████████▌       | 8309/9741 [00:02<00:00, 4329.93it/s] 90%|█████████████████████████████████████████████▉     | 8774/9741 [00:02<00:00, 4422.83it/s] 95%|████████████████████████████████████████████████▎  | 9239/9741 [00:02<00:00, 4487.01it/s]100%|██████████████████████████████████████████████████▉| 9724/9741 [00:02<00:00, 4593.93it/s]100%|███████████████████████████████████████████████████| 9741/9741 [00:02<00:00, 4061.21it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:04<00:09,  4.82s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:11,  5.51s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.48s/it]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:09<00:04,  4.96s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.38s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.34s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.26s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.38s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.53s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.75s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.93s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.71s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.89s/it]
[2023-08-21 11:43:33,836] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.23s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.65s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.81s/it]
[2023-08-21 11:43:47,306] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-21 11:43:47,307] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-21 11:43:47,307] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-21 11:43:47,308] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-21 11:43:47,308] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-21 11:43:47,308] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-21 11:43:47,308] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-21 11:43:47,308] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-21 11:43:47,308] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-21 11:43:47,308] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-21 11:43:47,308] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-21 11:43:47,308] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f42d7637f40>
[2023-08-21 11:43:47,308] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-21 11:43:47,308] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-21 11:43:47,308] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-21 11:43:47,308] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-21 11:43:47,308] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-21 11:43:47,308] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-21 11:43:47,308] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-21 11:43:47,308] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-21 11:43:47,308] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-21 11:43:47,308] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-21 11:43:47,308] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-21 11:43:47,308] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f42d50dcdc0>
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-21 11:43:47,310] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-21 11:43:47,310] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-21 11:43:47,310] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-21 11:43:47,310] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-21 11:43:47,310] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.3605022430419922 seconds
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.3051154613494873 seconds
Time to load utils op: 0.3043360710144043 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Loading extension module utils...
Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]Time to load utils op: 0.3044140338897705 seconds
############### Example ###############
### Instruction:Answer the following multiple choice question.



Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i0-s1-rTrue
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:59<48:49, 59.78s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:45<41:02, 51.29s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [02:46<43:40, 55.76s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [03:45<43:42, 57.00s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [04:45<43:41, 58.27s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [05:40<41:57, 57.23s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [06:41<41:42, 58.20s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [07:41<41:13, 58.88s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [08:40<40:22, 59.08s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [09:40<39:24, 59.11s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [10:39<38:28, 59.20s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [11:39<37:34, 59.33s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [12:39<36:43, 59.55s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [13:37<35:35, 59.32s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [14:38<34:54, 59.84s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [15:38<33:50, 59.71s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [16:38<32:54, 59.85s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [17:22<29:23, 55.12s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [17:58<25:25, 49.20s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [18:32<22:22, 44.76s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [19:10<20:35, 42.60s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [20:08<22:08, 47.46s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [21:08<22:59, 51.11s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [21:53<21:21, 49.30s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [22:40<20:13, 48.55s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [23:40<20:46, 51.93s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [24:40<20:53, 54.50s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [25:40<20:32, 56.01s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [26:41<20:07, 57.51s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [27:10<16:22, 49.10s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [27:52<14:53, 47.00s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [28:25<12:51, 42.85s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [29:25<13:31, 47.74s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [29:47<10:42, 40.13s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [30:28<10:04, 40.28s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [31:28<10:47, 46.23s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [32:03<09:18, 42.98s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [33:02<09:33, 47.80s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [34:02<09:23, 51.27s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [34:32<07:31, 45.10s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [35:33<07:29, 49.93s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [36:33<07:01, 52.71s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [37:19<05:55, 50.82s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [38:19<05:21, 53.51s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [39:19<04:37, 55.51s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [40:18<03:45, 56.42s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [41:12<02:47, 55.73s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [42:10<01:53, 56.55s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [43:09<00:57, 57.24s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [43:33<00:00, 47.19s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [43:33<00:00, 52.27s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 4.8648} | lm_loss 7.4377 | avg. gen lenth: 216.032
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i1-s1-rTrue --seed 1 --max-prompt-length 2048 --rationales --num-in-domain 1
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-21 12:28:18,140] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i1-s1-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 1
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i1-s1-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9740 [00:00<?, ?it/s]  1%|▍                                                     | 78/9740 [00:00<00:12, 778.28it/s]  2%|▊                                                    | 157/9740 [00:00<00:12, 784.95it/s]  2%|█▎                                                   | 236/9740 [00:00<00:12, 781.34it/s]  3%|█▋                                                   | 315/9740 [00:00<00:12, 783.47it/s]  4%|██▏                                                  | 394/9740 [00:00<00:11, 785.70it/s]  5%|██▌                                                  | 473/9740 [00:00<00:11, 782.80it/s]  6%|███                                                  | 552/9740 [00:00<00:11, 784.63it/s]  6%|███▍                                                 | 631/9740 [00:00<00:11, 784.11it/s]  7%|███▊                                                 | 710/9740 [00:00<00:11, 766.85it/s]  8%|████▎                                                | 789/9740 [00:01<00:11, 771.38it/s]  9%|████▋                                                | 868/9740 [00:01<00:11, 776.89it/s] 10%|█████▏                                               | 947/9740 [00:01<00:11, 778.20it/s] 11%|█████▍                                              | 1026/9740 [00:01<00:11, 781.57it/s] 11%|█████▉                                              | 1106/9740 [00:01<00:11, 784.59it/s] 12%|██████▎                                             | 1185/9740 [00:01<00:10, 784.16it/s] 13%|██████▋                                             | 1264/9740 [00:01<00:10, 783.94it/s] 14%|███████▏                                            | 1343/9740 [00:01<00:10, 783.08it/s] 15%|███████▌                                            | 1422/9740 [00:01<00:10, 782.92it/s] 15%|████████                                            | 1501/9740 [00:01<00:10, 778.83it/s] 16%|████████▍                                           | 1579/9740 [00:02<00:10, 777.64it/s] 17%|████████▊                                           | 1658/9740 [00:02<00:10, 780.02it/s] 18%|█████████▎                                          | 1737/9740 [00:02<00:10, 782.10it/s] 19%|█████████▋                                          | 1816/9740 [00:02<00:10, 762.17it/s] 19%|██████████                                          | 1896/9740 [00:02<00:10, 773.04it/s] 21%|██████████▊                                         | 2016/9740 [00:02<00:08, 895.99it/s] 22%|███████████▍                                        | 2135/9740 [00:02<00:07, 982.02it/s] 23%|███████████▊                                       | 2254/9740 [00:02<00:07, 1043.39it/s] 24%|████████████▍                                      | 2374/9740 [00:02<00:06, 1088.31it/s] 26%|█████████████                                      | 2494/9740 [00:02<00:06, 1121.10it/s] 27%|█████████████▋                                     | 2614/9740 [00:03<00:06, 1142.78it/s] 28%|██████████████▎                                    | 2731/9740 [00:03<00:06, 1148.10it/s] 29%|██████████████▉                                    | 2850/9740 [00:03<00:05, 1159.77it/s] 30%|███████████████▌                                   | 2969/9740 [00:03<00:05, 1167.41it/s] 32%|████████████████▏                                  | 3089/9740 [00:03<00:05, 1175.30it/s] 33%|████████████████▊                                  | 3208/9740 [00:03<00:05, 1178.44it/s] 34%|█████████████████▍                                 | 3328/9740 [00:03<00:05, 1183.28it/s] 35%|██████████████████                                 | 3447/9740 [00:03<00:05, 1184.75it/s] 37%|██████████████████▋                                | 3567/9740 [00:03<00:05, 1186.90it/s] 38%|███████████████████▎                               | 3686/9740 [00:03<00:05, 1185.31it/s] 39%|███████████████████▉                               | 3807/9740 [00:04<00:04, 1189.55it/s] 40%|████████████████████▌                              | 3926/9740 [00:04<00:04, 1189.58it/s] 42%|█████████████████████▏                             | 4046/9740 [00:04<00:04, 1191.28it/s] 43%|█████████████████████▊                             | 4166/9740 [00:04<00:04, 1189.12it/s] 44%|██████████████████████▍                            | 4285/9740 [00:04<00:04, 1180.72it/s] 45%|███████████████████████                            | 4404/9740 [00:04<00:04, 1178.53it/s] 46%|███████████████████████▋                           | 4522/9740 [00:04<00:04, 1124.14it/s] 48%|████████████████████████▎                          | 4642/9740 [00:04<00:04, 1144.46it/s] 49%|█████████████████████████▍                          | 4757/9740 [00:04<00:05, 873.90it/s] 50%|██████████████████████████                          | 4876/9740 [00:05<00:05, 949.62it/s] 51%|██████████████████████████▏                        | 4995/9740 [00:05<00:04, 1010.64it/s] 53%|██████████████████████████▊                        | 5115/9740 [00:05<00:04, 1059.88it/s] 54%|███████████████████████████▍                       | 5234/9740 [00:05<00:04, 1094.52it/s] 55%|████████████████████████████                       | 5353/9740 [00:05<00:03, 1120.86it/s] 56%|████████████████████████████▋                      | 5472/9740 [00:05<00:03, 1139.21it/s] 57%|█████████████████████████████▎                     | 5596/9740 [00:05<00:03, 1168.03it/s] 59%|█████████████████████████████▉                     | 5719/9740 [00:05<00:03, 1183.93it/s] 60%|██████████████████████████████▌                    | 5843/9740 [00:05<00:03, 1199.14it/s] 61%|███████████████████████████████▏                   | 5967/9740 [00:05<00:03, 1209.21it/s] 63%|███████████████████████████████▉                   | 6090/9740 [00:06<00:03, 1214.69it/s] 64%|████████████████████████████████▌                  | 6214/9740 [00:06<00:02, 1219.74it/s] 65%|█████████████████████████████████▏                 | 6337/9740 [00:06<00:02, 1220.16it/s] 66%|█████████████████████████████████▊                 | 6461/9740 [00:06<00:02, 1225.71it/s] 68%|██████████████████████████████████▍                | 6584/9740 [00:06<00:02, 1225.53it/s] 69%|███████████████████████████████████▏               | 6709/9740 [00:06<00:02, 1230.19it/s] 70%|███████████████████████████████████▊               | 6833/9740 [00:06<00:02, 1231.43it/s] 71%|████████████████████████████████████▍              | 6958/9740 [00:06<00:02, 1235.13it/s] 73%|█████████████████████████████████████              | 7082/9740 [00:06<00:02, 1234.47it/s] 74%|█████████████████████████████████████▋             | 7207/9740 [00:06<00:02, 1236.00it/s] 75%|██████████████████████████████████████▍            | 7331/9740 [00:07<00:01, 1234.02it/s] 77%|███████████████████████████████████████            | 7455/9740 [00:07<00:01, 1204.03it/s] 78%|███████████████████████████████████████▋           | 7579/9740 [00:07<00:01, 1211.90it/s] 79%|████████████████████████████████████████▎          | 7702/9740 [00:07<00:01, 1216.71it/s] 80%|████████████████████████████████████████▉          | 7825/9740 [00:07<00:01, 1219.33it/s] 82%|█████████████████████████████████████████▌         | 7948/9740 [00:07<00:01, 1174.22it/s] 83%|██████████████████████████████████████████▎        | 8072/9740 [00:07<00:01, 1191.94it/s] 84%|██████████████████████████████████████████▉        | 8196/9740 [00:07<00:01, 1205.37it/s] 85%|███████████████████████████████████████████▌       | 8319/9740 [00:07<00:01, 1211.06it/s] 87%|████████████████████████████████████████████▏      | 8443/9740 [00:08<00:01, 1218.43it/s] 88%|████████████████████████████████████████████▊      | 8567/9740 [00:08<00:00, 1223.13it/s] 89%|█████████████████████████████████████████████▌     | 8690/9740 [00:08<00:00, 1224.57it/s] 90%|██████████████████████████████████████████████▏    | 8813/9740 [00:08<00:00, 1224.88it/s] 92%|██████████████████████████████████████████████▊    | 8938/9740 [00:08<00:00, 1229.97it/s] 93%|███████████████████████████████████████████████▍   | 9062/9740 [00:08<00:00, 1229.49it/s] 94%|████████████████████████████████████████████████   | 9187/9740 [00:08<00:00, 1232.91it/s] 96%|████████████████████████████████████████████████▊  | 9311/9740 [00:08<00:00, 1230.96it/s] 97%|█████████████████████████████████████████████████▍ | 9435/9740 [00:08<00:00, 1232.12it/s] 98%|██████████████████████████████████████████████████ | 9559/9740 [00:08<00:00, 1231.03it/s] 99%|██████████████████████████████████████████████████▋| 9683/9740 [00:09<00:00, 1233.36it/s]100%|███████████████████████████████████████████████████| 9740/9740 [00:09<00:00, 1075.00it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.20s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.12s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.40s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.42s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.06s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.17s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:11<00:05,  5.52s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:11<00:05,  5.60s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.47s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.65s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.50s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.67s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.80s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.99s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  5.10s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  5.21s/it]
[2023-08-21 12:29:20,218] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
[2023-08-21 12:29:30,138] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-21 12:29:30,140] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-21 12:29:30,140] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-21 12:29:30,140] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-21 12:29:30,140] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-21 12:29:30,140] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fc7401c0f40>
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7fc71ac01dc0>
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-21 12:29:30,143] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.40443897247314453 seconds
Loading extension module utils...
Time to load utils op: 0.30432772636413574 seconds
Loading extension module utils...
Time to load utils op: 0.3046755790710449 seconds
Loading extension module utils...
Time to load utils op: 0.3043360710144043 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: 1. The question is asking where you could find some plumbing that would not be of use to you if you are thirsty.
2. We then consider each of the given options.
3. Option A: oil refineries. Even though there may be water available in oil refineries, it is not safe to drink as it may be contaminated with oil.
4. Option B: wall. In most cases, there may be water pipes inside walls of buildings that supplies water. Therefore, if you are thirsty, these pipes in the wall may be of use to you as they may contain drinkable water.
5. Option C: show. It doesn't specify what kind of "show" it is, but if it's a TV show, there could be no actual plumbing. If it's a trade show, you could find usable plumbing in display booths or restroom areas. Therefore, the possibility of getting drinkable water from a "show" depends largely on context and cannot be completely ruled out.
6. Option D: own home. This should not be the correct answer because in your own home, the plumbing serves you with fresh water, which you can drink when you're thirsty.
7. Option E: water fountain. Plumbing for a water fountain usually includes potable water that is treated and safe to drink.
8. After considering all the options, it is clear that option A, oil refineries, is the only one where you would not access potable water through the plumbing.
So the final answer is A: oil refineries

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i1-s1-rTrue
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:52<42:54, 52.55s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:43<41:21, 51.69s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [02:34<40:04, 51.16s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [03:24<39:00, 50.89s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [04:02<34:38, 46.19s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [04:53<34:59, 47.71s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [05:44<34:58, 48.81s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [06:35<34:42, 49.58s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [07:26<34:16, 50.15s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [08:17<33:34, 50.37s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [09:09<33:05, 50.90s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [10:01<32:21, 51.10s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [10:53<31:40, 51.36s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [11:45<30:55, 51.53s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [12:36<30:03, 51.53s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [13:28<29:14, 51.61s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [14:19<28:20, 51.53s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [15:11<27:30, 51.58s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [16:02<26:32, 51.39s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [16:53<25:40, 51.35s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [17:44<24:40, 51.07s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [18:34<23:46, 50.94s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [19:25<22:52, 50.85s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [20:16<22:00, 50.77s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [21:06<21:09, 50.78s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [21:58<20:21, 50.90s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [22:49<19:34, 51.08s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [23:40<18:40, 50.92s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [24:31<17:50, 50.96s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [25:22<16:58, 50.94s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [26:12<16:07, 50.93s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [27:04<15:20, 51.13s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [27:55<14:28, 51.07s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [28:46<13:37, 51.09s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [29:37<12:46, 51.08s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [30:29<11:58, 51.33s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [31:20<11:06, 51.26s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [32:11<10:13, 51.11s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [33:02<09:21, 51.08s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [33:53<08:30, 51.05s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [34:44<07:38, 50.99s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [35:35<06:47, 50.91s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [36:25<05:56, 50.86s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [37:16<05:05, 50.89s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [38:07<04:14, 50.80s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [38:57<03:23, 50.76s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [39:48<02:32, 50.67s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [40:39<01:41, 50.70s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [41:29<00:50, 50.63s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [42:20<00:00, 50.71s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [42:20<00:00, 50.81s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 1.8858} | lm_loss 8.0438 | avg. gen lenth: 389.872
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i2-s1-rTrue --seed 1 --max-prompt-length 2048 --rationales --num-in-domain 2
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-21 13:12:02,277] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i2-s1-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 2
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i2-s1-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9739 [00:00<?, ?it/s]  0%|▏                                                     | 45/9739 [00:00<00:21, 442.85it/s]  1%|▍                                                     | 90/9739 [00:00<00:21, 443.46it/s]  1%|▋                                                    | 135/9739 [00:00<00:21, 444.17it/s]  2%|▉                                                    | 180/9739 [00:00<00:21, 444.16it/s]  2%|█▏                                                   | 225/9739 [00:00<00:21, 442.05it/s]  3%|█▍                                                   | 270/9739 [00:00<00:21, 442.63it/s]  3%|█▋                                                   | 315/9739 [00:00<00:21, 443.54it/s]  4%|█▉                                                   | 360/9739 [00:00<00:21, 437.68it/s]  4%|██▏                                                  | 405/9739 [00:00<00:21, 439.51it/s]  5%|██▍                                                  | 449/9739 [00:01<00:21, 438.13it/s]  5%|██▋                                                  | 494/9739 [00:01<00:21, 439.46it/s]  6%|██▉                                                  | 539/9739 [00:01<00:20, 441.24it/s]  6%|███▏                                                 | 584/9739 [00:01<00:20, 442.07it/s]  6%|███▍                                                 | 629/9739 [00:01<00:20, 442.26it/s]  7%|███▋                                                 | 674/9739 [00:01<00:20, 441.32it/s]  7%|███▉                                                 | 719/9739 [00:01<00:20, 441.80it/s]  8%|████▏                                                | 764/9739 [00:01<00:20, 442.46it/s]  8%|████▍                                                | 809/9739 [00:01<00:20, 438.23it/s]  9%|████▋                                                | 854/9739 [00:01<00:20, 439.13it/s]  9%|████▉                                                | 898/9739 [00:02<00:20, 437.25it/s] 10%|█████▏                                               | 943/9739 [00:02<00:20, 438.46it/s] 10%|█████▍                                               | 988/9739 [00:02<00:19, 439.62it/s] 11%|█████▌                                              | 1033/9739 [00:02<00:19, 440.58it/s] 11%|█████▊                                              | 1078/9739 [00:02<00:19, 441.58it/s] 12%|██████                                              | 1138/9739 [00:02<00:17, 488.20it/s] 12%|██████▍                                             | 1205/9739 [00:02<00:15, 541.14it/s] 13%|██████▊                                             | 1272/9739 [00:02<00:14, 577.85it/s] 14%|███████▏                                            | 1338/9739 [00:02<00:13, 601.83it/s] 14%|███████▌                                            | 1405/9739 [00:02<00:13, 620.57it/s] 15%|███████▊                                            | 1472/9739 [00:03<00:13, 633.31it/s] 16%|████████▏                                           | 1539/9739 [00:03<00:12, 641.60it/s] 16%|████████▌                                           | 1605/9739 [00:03<00:12, 645.29it/s] 17%|████████▉                                           | 1672/9739 [00:03<00:12, 651.51it/s] 18%|█████████▎                                          | 1739/9739 [00:03<00:12, 654.93it/s] 19%|█████████▋                                          | 1805/9739 [00:03<00:12, 633.29it/s] 19%|█████████▉                                          | 1872/9739 [00:03<00:12, 641.76it/s] 20%|██████████▎                                         | 1939/9739 [00:03<00:12, 648.67it/s] 21%|██████████▋                                         | 2006/9739 [00:03<00:11, 653.65it/s] 21%|███████████                                         | 2072/9739 [00:03<00:11, 653.90it/s] 22%|███████████▍                                        | 2139/9739 [00:04<00:11, 655.81it/s] 23%|███████████▊                                        | 2206/9739 [00:04<00:11, 658.89it/s] 23%|████████████▏                                       | 2272/9739 [00:04<00:11, 657.95it/s] 24%|████████████▍                                       | 2339/9739 [00:04<00:11, 659.72it/s] 25%|████████████▊                                       | 2406/9739 [00:04<00:11, 661.25it/s] 25%|█████████████▏                                      | 2473/9739 [00:04<00:11, 660.45it/s] 26%|█████████████▌                                      | 2540/9739 [00:04<00:10, 660.49it/s] 27%|█████████████▉                                      | 2607/9739 [00:04<00:10, 662.01it/s] 27%|██████████████▎                                     | 2674/9739 [00:04<00:10, 662.19it/s] 28%|██████████████▋                                     | 2741/9739 [00:04<00:10, 659.68it/s] 29%|██████████████▉                                     | 2807/9739 [00:05<00:10, 659.59it/s] 29%|███████████████▎                                    | 2873/9739 [00:05<00:10, 659.45it/s] 30%|███████████████▋                                    | 2939/9739 [00:05<00:10, 658.46it/s] 31%|████████████████                                    | 3006/9739 [00:05<00:10, 659.74it/s] 32%|████████████████▍                                   | 3073/9739 [00:05<00:10, 659.83it/s] 32%|████████████████▊                                   | 3140/9739 [00:05<00:09, 660.79it/s] 33%|█████████████████                                   | 3207/9739 [00:05<00:09, 656.60it/s] 34%|█████████████████▍                                  | 3274/9739 [00:05<00:09, 658.01it/s] 34%|█████████████████▊                                  | 3341/9739 [00:05<00:09, 658.67it/s] 35%|██████████████████▏                                 | 3407/9739 [00:05<00:09, 657.14it/s] 36%|██████████████████▌                                 | 3474/9739 [00:06<00:09, 658.08it/s] 36%|██████████████████▉                                 | 3540/9739 [00:06<00:09, 658.31it/s] 37%|███████████████████▎                                | 3606/9739 [00:06<00:09, 657.27it/s] 38%|███████████████████▌                                | 3673/9739 [00:06<00:09, 658.77it/s] 38%|███████████████████▉                                | 3740/9739 [00:06<00:09, 659.62it/s] 39%|████████████████████▎                               | 3807/9739 [00:06<00:08, 660.38it/s] 40%|████████████████████▋                               | 3874/9739 [00:06<00:08, 659.15it/s] 40%|█████████████████████                               | 3941/9739 [00:06<00:08, 660.01it/s] 41%|█████████████████████▍                              | 4008/9739 [00:06<00:08, 660.85it/s] 42%|█████████████████████▊                              | 4075/9739 [00:07<00:08, 653.53it/s] 43%|██████████████████████                              | 4142/9739 [00:07<00:08, 655.71it/s] 43%|██████████████████████▍                             | 4208/9739 [00:07<00:08, 652.50it/s] 44%|██████████████████████▊                             | 4275/9739 [00:07<00:08, 656.18it/s] 45%|███████████████████████▏                            | 4341/9739 [00:07<00:08, 655.90it/s] 45%|███████████████████████▌                            | 4407/9739 [00:07<00:08, 653.88it/s] 46%|███████████████████████▉                            | 4473/9739 [00:07<00:08, 645.21it/s] 47%|████████████████████████▏                           | 4538/9739 [00:07<00:08, 619.58it/s] 47%|████████████████████████▌                           | 4605/9739 [00:07<00:08, 632.59it/s] 48%|████████████████████████▉                           | 4672/9739 [00:07<00:07, 642.08it/s] 49%|█████████████████████████▎                          | 4739/9739 [00:08<00:07, 649.09it/s] 49%|█████████████████████████▋                          | 4805/9739 [00:08<00:10, 476.13it/s] 50%|█████████████████████████▉                          | 4869/9739 [00:08<00:09, 514.58it/s] 51%|██████████████████████████▎                         | 4936/9739 [00:08<00:08, 551.91it/s] 51%|██████████████████████████▋                         | 5002/9739 [00:08<00:08, 579.21it/s] 52%|███████████████████████████                         | 5069/9739 [00:08<00:07, 601.98it/s] 53%|███████████████████████████▍                        | 5136/9739 [00:08<00:07, 619.21it/s] 53%|███████████████████████████▊                        | 5202/9739 [00:08<00:07, 629.46it/s] 54%|████████████████████████████▏                       | 5268/9739 [00:08<00:07, 638.03it/s] 55%|████████████████████████████▍                       | 5334/9739 [00:09<00:06, 644.14it/s] 55%|████████████████████████████▊                       | 5400/9739 [00:09<00:06, 646.67it/s] 56%|█████████████████████████████▏                      | 5467/9739 [00:09<00:06, 651.30it/s] 57%|█████████████████████████████▌                      | 5536/9739 [00:09<00:06, 661.37it/s] 58%|█████████████████████████████▉                      | 5605/9739 [00:09<00:06, 668.78it/s] 58%|██████████████████████████████▎                     | 5674/9739 [00:09<00:06, 672.40it/s] 59%|██████████████████████████████▋                     | 5742/9739 [00:09<00:05, 670.59it/s] 60%|███████████████████████████████                     | 5811/9739 [00:09<00:05, 675.11it/s] 60%|███████████████████████████████▍                    | 5879/9739 [00:09<00:05, 674.61it/s] 61%|███████████████████████████████▊                    | 5948/9739 [00:09<00:05, 678.86it/s] 62%|████████████████████████████████▏                   | 6018/9739 [00:10<00:05, 682.43it/s] 63%|████████████████████████████████▌                   | 6087/9739 [00:10<00:05, 682.11it/s] 63%|████████████████████████████████▊                   | 6156/9739 [00:10<00:05, 682.54it/s] 64%|█████████████████████████████████▏                  | 6225/9739 [00:10<00:05, 683.42it/s] 65%|█████████████████████████████████▌                  | 6294/9739 [00:10<00:05, 683.77it/s] 65%|█████████████████████████████████▉                  | 6363/9739 [00:10<00:04, 682.16it/s] 66%|██████████████████████████████████▎                 | 6432/9739 [00:10<00:04, 683.75it/s] 67%|██████████████████████████████████▋                 | 6501/9739 [00:10<00:04, 683.55it/s] 67%|███████████████████████████████████                 | 6570/9739 [00:10<00:04, 680.71it/s] 68%|███████████████████████████████████▍                | 6639/9739 [00:10<00:04, 680.85it/s] 69%|███████████████████████████████████▊                | 6708/9739 [00:11<00:04, 682.30it/s] 70%|████████████████████████████████████▏               | 6777/9739 [00:11<00:04, 681.87it/s] 70%|████████████████████████████████████▌               | 6846/9739 [00:11<00:04, 683.76it/s] 71%|████████████████████████████████████▉               | 6915/9739 [00:11<00:04, 683.32it/s] 72%|█████████████████████████████████████▎              | 6984/9739 [00:11<00:04, 683.94it/s] 72%|█████████████████████████████████████▋              | 7053/9739 [00:11<00:03, 681.52it/s] 73%|██████████████████████████████████████              | 7122/9739 [00:11<00:03, 683.43it/s] 74%|██████████████████████████████████████▍             | 7191/9739 [00:11<00:03, 684.20it/s] 75%|██████████████████████████████████████▊             | 7260/9739 [00:11<00:03, 682.47it/s] 75%|███████████████████████████████████████▏            | 7329/9739 [00:11<00:03, 683.07it/s] 76%|███████████████████████████████████████▌            | 7398/9739 [00:12<00:03, 683.38it/s] 77%|███████████████████████████████████████▊            | 7467/9739 [00:12<00:03, 641.80it/s] 77%|████████████████████████████████████████▏           | 7535/9739 [00:12<00:03, 652.60it/s] 78%|████████████████████████████████████████▌           | 7604/9739 [00:12<00:03, 661.87it/s] 79%|████████████████████████████████████████▉           | 7672/9739 [00:12<00:03, 664.66it/s] 79%|█████████████████████████████████████████▎          | 7741/9739 [00:12<00:02, 671.04it/s] 80%|█████████████████████████████████████████▋          | 7810/9739 [00:12<00:02, 674.95it/s] 81%|██████████████████████████████████████████          | 7879/9739 [00:12<00:02, 677.64it/s] 82%|██████████████████████████████████████████▍         | 7948/9739 [00:12<00:02, 678.51it/s] 82%|██████████████████████████████████████████▊         | 8017/9739 [00:13<00:02, 679.86it/s] 83%|███████████████████████████████████████████▏        | 8086/9739 [00:13<00:02, 680.22it/s] 84%|███████████████████████████████████████████▌        | 8155/9739 [00:13<00:02, 679.01it/s] 84%|███████████████████████████████████████████▉        | 8224/9739 [00:13<00:02, 680.17it/s] 85%|████████████████████████████████████████████▎       | 8293/9739 [00:13<00:02, 681.12it/s] 86%|████████████████████████████████████████████▋       | 8362/9739 [00:13<00:02, 678.42it/s] 87%|█████████████████████████████████████████████       | 8431/9739 [00:13<00:01, 680.33it/s] 87%|█████████████████████████████████████████████▍      | 8500/9739 [00:13<00:01, 682.15it/s] 88%|█████████████████████████████████████████████▊      | 8569/9739 [00:13<00:01, 682.31it/s] 89%|██████████████████████████████████████████████      | 8638/9739 [00:13<00:01, 677.37it/s] 89%|██████████████████████████████████████████████▍     | 8707/9739 [00:14<00:01, 678.43it/s] 90%|██████████████████████████████████████████████▊     | 8776/9739 [00:14<00:01, 679.55it/s] 91%|███████████████████████████████████████████████▏    | 8844/9739 [00:14<00:01, 677.18it/s] 92%|███████████████████████████████████████████████▌    | 8913/9739 [00:14<00:01, 678.29it/s] 92%|███████████████████████████████████████████████▉    | 8982/9739 [00:14<00:01, 680.05it/s] 93%|████████████████████████████████████████████████▎   | 9051/9739 [00:14<00:01, 677.30it/s] 94%|████████████████████████████████████████████████▋   | 9120/9739 [00:14<00:00, 678.84it/s] 94%|█████████████████████████████████████████████████   | 9189/9739 [00:14<00:00, 680.65it/s] 95%|█████████████████████████████████████████████████▍  | 9258/9739 [00:14<00:00, 679.89it/s] 96%|█████████████████████████████████████████████████▊  | 9327/9739 [00:14<00:00, 681.28it/s] 96%|██████████████████████████████████████████████████▏ | 9396/9739 [00:15<00:00, 681.47it/s] 97%|██████████████████████████████████████████████████▌ | 9465/9739 [00:15<00:00, 682.13it/s] 98%|██████████████████████████████████████████████████▉ | 9534/9739 [00:15<00:00, 680.15it/s] 99%|███████████████████████████████████████████████████▎| 9603/9739 [00:15<00:00, 678.05it/s] 99%|███████████████████████████████████████████████████▋| 9671/9739 [00:15<00:00, 677.70it/s]100%|████████████████████████████████████████████████████| 9739/9739 [00:15<00:00, 676.09it/s]100%|████████████████████████████████████████████████████| 9739/9739 [00:15<00:00, 625.70it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.22s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.06s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.14s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.34s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.14s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.09s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.18s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.24s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.47s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.66s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.42s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.60s/it]
[2023-08-21 13:13:09,037] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.50s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.68s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.65s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.82s/it]
[2023-08-21 13:13:16,848] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-21 13:13:16,849] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-21 13:13:16,849] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-21 13:13:16,849] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fa3c3ba9f40>
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7fa39b9bfdc0>
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-21 13:13:16,851] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.43611812591552734 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Loading extension module utils...
Time to load utils op: 0.4044969081878662 seconds
Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: 1. The question is asking for a place where plumbing exists but is not useful for someone who is thirsty. 
2. This means we are looking for a place where the plumbing doesn't carry potable water that one could drink to quench their thirst.
3. We can first eliminate choices that are obviously incorrect. The plumbing in your own home (D) and a water fountain (E) would undoubtedly be able to provide drinkable water. So these cannot be the correct options.
4. Considering option B, the wall, it could contain plumbing if, for example, it's a wall in a home with pipes for bathrooms or the kitchen running through it. Therefore, you could potentially get water from here if you're thirsty. We can rule this option out as well.
5. Looking at option C, the show, it's a bit unclear whether this is referring to a television show, a theatre show, or something else entirely. If we take it to mean a television or theatre show, then there certainly is no plumbing there that you could drink from. However, such shows typically don't have any plumbing to begin with, so this option is not a 'perfect' fit as per the exact wording of the question.
6. This leaves us with choice A, oil refineries. Oil refineries do have extensive plumbing for the transportation and processing of petroleum products. However, this plumbing system does not carry potable water, and definitely isn't something you could drink from if you're thirsty. 
7. Therefore the correct answer is A: oil refineries.
So the final answer is A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Output: 1. The question is about identifying what a person is not doing yet when they are beginning work.
2. Let's consider each answer choice:
    - A: working – This isn't the answer because when a person is beginning work, they are indeed working.
    - B: resting – This isn't applicable because not all people rest before they begin to work, and the process of beginning work is contradictory to resting. 
    - C: tiredness – This is not an action and therefore, it can't be the answer. 
    - D: accomplishing – In the context of this question, when a person is just beginning work, they haven't yet completed or accomplished any of the tasks they're setting out to do. Therefore, it's accurately describing what they aren't doing yet.
    - E: momentum – This isn't the correct answer either because one can have momentum as soon as they begin work.
3. With these considerations, the answer is D: accomplishing.
So the final answer is D: accomplishing

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i2-s1-rTrue
Loading extension module utils...
Time to load utils op: 0.4050166606903076 seconds
Loading extension module utils...
Time to load utils op: 0.4045989513397217 seconds
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:47<38:24, 47.03s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:33<37:22, 46.71s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [02:20<36:51, 47.06s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [03:07<35:55, 46.87s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [03:54<35:13, 46.97s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [04:41<34:25, 46.95s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [05:28<33:39, 46.96s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [06:15<32:50, 46.92s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [07:01<31:56, 46.74s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [07:48<31:10, 46.75s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [08:35<30:21, 46.71s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [09:21<29:33, 46.68s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [10:08<28:44, 46.61s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [10:55<28:09, 46.92s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [11:42<27:15, 46.74s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [12:28<26:27, 46.70s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [13:15<25:36, 46.55s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [14:02<24:53, 46.69s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [14:48<24:09, 46.76s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [15:35<23:23, 46.77s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [16:22<22:33, 46.66s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [17:09<21:49, 46.78s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [17:55<21:02, 46.77s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [18:42<20:17, 46.83s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [19:29<19:28, 46.76s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [20:16<18:41, 46.72s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [21:02<17:53, 46.69s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [21:49<17:09, 46.78s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [22:36<16:21, 46.72s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [23:23<15:35, 46.79s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [24:09<14:48, 46.75s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [24:56<13:59, 46.63s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [25:43<13:14, 46.74s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [26:29<12:25, 46.62s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [27:16<11:38, 46.56s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [28:02<10:51, 46.57s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [28:49<10:07, 46.72s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [29:37<09:23, 46.94s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [30:24<08:37, 47.08s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [31:11<07:50, 47.07s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [31:58<07:01, 46.88s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [32:44<06:13, 46.71s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [33:30<05:26, 46.66s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [34:17<04:40, 46.70s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [35:04<03:53, 46.73s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [35:51<03:06, 46.69s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [36:37<02:19, 46.61s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [37:24<01:33, 46.64s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [38:11<00:46, 46.70s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [38:58<00:00, 46.86s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [38:58<00:00, 46.77s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 1.7126} | lm_loss 8.1612 | avg. gen lenth: 414.716
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i3-s1-rTrue --seed 1 --max-prompt-length 2048 --rationales --num-in-domain 3
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date![nltk_data]   Package punkt is already up-to-date!

[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-21 13:52:26,177] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i3-s1-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 3
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i3-s1-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9738 [00:00<?, ?it/s]  0%|▏                                                     | 34/9738 [00:00<00:28, 339.34it/s]  1%|▍                                                     | 69/9738 [00:00<00:28, 341.10it/s]  1%|▌                                                    | 104/9738 [00:00<00:28, 342.24it/s]  1%|▊                                                    | 139/9738 [00:00<00:28, 342.41it/s]  2%|▉                                                    | 174/9738 [00:00<00:27, 342.74it/s]  2%|█▏                                                   | 209/9738 [00:00<00:28, 340.03it/s]  3%|█▎                                                   | 244/9738 [00:00<00:27, 340.18it/s]  3%|█▌                                                   | 279/9738 [00:00<00:28, 335.56it/s]  3%|█▋                                                   | 314/9738 [00:00<00:27, 337.36it/s]  4%|█▉                                                   | 349/9738 [00:01<00:27, 338.51it/s]  4%|██                                                   | 384/9738 [00:01<00:27, 339.68it/s]  4%|██▎                                                  | 419/9738 [00:01<00:27, 340.33it/s]  5%|██▍                                                  | 454/9738 [00:01<00:27, 338.96it/s]  5%|██▋                                                  | 489/9738 [00:01<00:27, 339.72it/s]  5%|██▊                                                  | 524/9738 [00:01<00:27, 340.42it/s]  6%|███                                                  | 559/9738 [00:01<00:26, 340.72it/s]  6%|███▏                                                 | 594/9738 [00:01<00:26, 339.28it/s]  6%|███▍                                                 | 629/9738 [00:01<00:26, 339.96it/s]  7%|███▌                                                 | 663/9738 [00:01<00:26, 338.85it/s]  7%|███▊                                                 | 698/9738 [00:02<00:26, 339.61it/s]  8%|███▉                                                 | 732/9738 [00:02<00:26, 339.51it/s]  8%|████▏                                                | 767/9738 [00:02<00:26, 339.81it/s]  8%|████▎                                                | 803/9738 [00:02<00:25, 344.97it/s]  9%|████▋                                                | 855/9738 [00:02<00:22, 396.23it/s]  9%|████▉                                                | 907/9738 [00:02<00:20, 430.67it/s] 10%|█████▏                                               | 959/9738 [00:02<00:19, 456.11it/s] 10%|█████▍                                              | 1011/9738 [00:02<00:18, 474.63it/s] 11%|█████▋                                              | 1063/9738 [00:02<00:17, 487.76it/s] 11%|█████▉                                              | 1115/9738 [00:02<00:17, 495.14it/s] 12%|██████▏                                             | 1166/9738 [00:03<00:17, 498.99it/s] 13%|██████▌                                             | 1218/9738 [00:03<00:16, 504.33it/s] 13%|██████▊                                             | 1270/9738 [00:03<00:16, 508.38it/s] 14%|███████                                             | 1322/9738 [00:03<00:16, 510.99it/s] 14%|███████▎                                            | 1374/9738 [00:03<00:16, 511.29it/s] 15%|███████▌                                            | 1426/9738 [00:03<00:16, 513.02it/s] 15%|███████▉                                            | 1478/9738 [00:03<00:16, 514.93it/s] 16%|████████▏                                           | 1530/9738 [00:03<00:15, 515.75it/s] 16%|████████▍                                           | 1582/9738 [00:03<00:15, 515.27it/s] 17%|████████▋                                           | 1634/9738 [00:03<00:15, 516.24it/s] 17%|█████████                                           | 1686/9738 [00:04<00:15, 516.89it/s] 18%|█████████▎                                          | 1738/9738 [00:04<00:15, 516.99it/s] 18%|█████████▌                                          | 1790/9738 [00:04<00:15, 497.18it/s] 19%|█████████▊                                          | 1840/9738 [00:04<00:15, 496.97it/s] 19%|██████████                                          | 1892/9738 [00:04<00:15, 502.78it/s] 20%|██████████▍                                         | 1944/9738 [00:04<00:15, 506.94it/s] 20%|██████████▋                                         | 1996/9738 [00:04<00:15, 510.27it/s] 21%|██████████▉                                         | 2048/9738 [00:04<00:15, 509.94it/s] 22%|███████████▏                                        | 2100/9738 [00:04<00:14, 511.59it/s] 22%|███████████▍                                        | 2152/9738 [00:04<00:14, 513.49it/s] 23%|███████████▊                                        | 2204/9738 [00:05<00:14, 514.26it/s] 23%|████████████                                        | 2256/9738 [00:05<00:14, 513.35it/s] 24%|████████████▎                                       | 2308/9738 [00:05<00:14, 514.30it/s] 24%|████████████▌                                       | 2360/9738 [00:05<00:14, 514.79it/s] 25%|████████████▉                                       | 2412/9738 [00:05<00:14, 515.91it/s] 25%|█████████████▏                                      | 2464/9738 [00:05<00:14, 516.57it/s] 26%|█████████████▍                                      | 2516/9738 [00:05<00:14, 513.92it/s] 26%|█████████████▋                                      | 2568/9738 [00:05<00:13, 514.70it/s] 27%|█████████████▉                                      | 2620/9738 [00:05<00:13, 516.09it/s] 27%|██████████████▎                                     | 2672/9738 [00:05<00:13, 516.21it/s] 28%|██████████████▌                                     | 2724/9738 [00:06<00:13, 513.78it/s] 29%|██████████████▊                                     | 2776/9738 [00:06<00:13, 514.25it/s] 29%|███████████████                                     | 2828/9738 [00:06<00:13, 514.45it/s] 30%|███████████████▍                                    | 2880/9738 [00:06<00:13, 515.34it/s] 30%|███████████████▋                                    | 2932/9738 [00:06<00:13, 513.16it/s] 31%|███████████████▉                                    | 2984/9738 [00:06<00:13, 513.49it/s] 31%|████████████████▏                                   | 3036/9738 [00:06<00:13, 514.29it/s] 32%|████████████████▍                                   | 3088/9738 [00:06<00:12, 514.43it/s] 32%|████████████████▊                                   | 3140/9738 [00:06<00:12, 515.27it/s] 33%|█████████████████                                   | 3192/9738 [00:07<00:12, 514.50it/s] 33%|█████████████████▎                                  | 3244/9738 [00:07<00:12, 515.33it/s] 34%|█████████████████▌                                  | 3296/9738 [00:07<00:12, 515.77it/s] 34%|█████████████████▉                                  | 3348/9738 [00:07<00:12, 515.92it/s] 35%|██████████████████▏                                 | 3400/9738 [00:07<00:12, 512.45it/s] 35%|██████████████████▍                                 | 3452/9738 [00:07<00:12, 513.35it/s] 36%|██████████████████▋                                 | 3504/9738 [00:07<00:12, 513.37it/s] 37%|██████████████████▉                                 | 3556/9738 [00:07<00:12, 514.14it/s] 37%|███████████████████▎                                | 3608/9738 [00:07<00:11, 512.52it/s] 38%|███████████████████▌                                | 3660/9738 [00:07<00:11, 513.32it/s] 38%|███████████████████▊                                | 3712/9738 [00:08<00:11, 514.44it/s] 39%|████████████████████                                | 3764/9738 [00:08<00:11, 513.70it/s] 39%|████████████████████▍                               | 3816/9738 [00:08<00:11, 514.92it/s] 40%|████████████████████▋                               | 3868/9738 [00:08<00:11, 513.95it/s] 40%|████████████████████▉                               | 3920/9738 [00:08<00:11, 515.69it/s] 41%|█████████████████████▏                              | 3972/9738 [00:08<00:11, 515.54it/s] 41%|█████████████████████▍                              | 4024/9738 [00:08<00:11, 515.77it/s] 42%|█████████████████████▊                              | 4076/9738 [00:08<00:11, 513.44it/s] 42%|██████████████████████                              | 4128/9738 [00:08<00:10, 513.98it/s] 43%|██████████████████████▎                             | 4180/9738 [00:08<00:10, 514.52it/s] 43%|██████████████████████▌                             | 4232/9738 [00:09<00:10, 515.24it/s] 44%|██████████████████████▉                             | 4284/9738 [00:09<00:10, 514.04it/s] 45%|███████████████████████▏                            | 4336/9738 [00:09<00:10, 513.01it/s] 45%|███████████████████████▍                            | 4388/9738 [00:09<00:10, 514.26it/s] 46%|███████████████████████▋                            | 4440/9738 [00:09<00:10, 515.01it/s] 46%|███████████████████████▉                            | 4492/9738 [00:09<00:10, 515.97it/s] 47%|████████████████████████▎                           | 4544/9738 [00:09<00:10, 488.82it/s] 47%|████████████████████████▌                           | 4596/9738 [00:09<00:10, 496.78it/s] 48%|████████████████████████▊                           | 4648/9738 [00:09<00:10, 502.59it/s] 48%|█████████████████████████                           | 4700/9738 [00:09<00:09, 506.60it/s] 49%|█████████████████████████▎                          | 4751/9738 [00:10<00:12, 395.70it/s] 49%|█████████████████████████▋                          | 4803/9738 [00:10<00:11, 425.30it/s] 50%|█████████████████████████▉                          | 4855/9738 [00:10<00:10, 448.79it/s] 50%|██████████████████████████▏                         | 4907/9738 [00:10<00:10, 466.88it/s] 51%|██████████████████████████▍                         | 4959/9738 [00:10<00:09, 479.24it/s] 51%|██████████████████████████▊                         | 5011/9738 [00:10<00:09, 490.08it/s] 52%|███████████████████████████                         | 5063/9738 [00:10<00:09, 497.89it/s] 53%|███████████████████████████▎                        | 5115/9738 [00:10<00:09, 503.02it/s] 53%|███████████████████████████▌                        | 5167/9738 [00:10<00:09, 507.24it/s] 54%|███████████████████████████▊                        | 5219/9738 [00:11<00:08, 508.06it/s] 54%|████████████████████████████▏                       | 5271/9738 [00:11<00:08, 510.78it/s] 55%|████████████████████████████▍                       | 5323/9738 [00:11<00:08, 511.90it/s] 55%|████████████████████████████▋                       | 5375/9738 [00:11<00:08, 513.17it/s] 56%|████████████████████████████▉                       | 5427/9738 [00:11<00:08, 511.87it/s] 56%|█████████████████████████████▎                      | 5479/9738 [00:11<00:08, 514.17it/s] 57%|█████████████████████████████▌                      | 5533/9738 [00:11<00:08, 520.52it/s] 57%|█████████████████████████████▊                      | 5587/9738 [00:11<00:07, 524.07it/s] 58%|██████████████████████████████                      | 5640/9738 [00:11<00:07, 524.59it/s] 58%|██████████████████████████████▍                     | 5694/9738 [00:11<00:07, 527.43it/s] 59%|██████████████████████████████▋                     | 5748/9738 [00:12<00:07, 529.65it/s] 60%|██████████████████████████████▉                     | 5802/9738 [00:12<00:07, 531.10it/s] 60%|███████████████████████████████▎                    | 5856/9738 [00:12<00:07, 529.86it/s] 61%|███████████████████████████████▌                    | 5910/9738 [00:12<00:07, 531.37it/s] 61%|███████████████████████████████▊                    | 5964/9738 [00:12<00:07, 527.69it/s] 62%|████████████████████████████████▏                   | 6018/9738 [00:12<00:07, 528.66it/s] 62%|████████████████████████████████▍                   | 6072/9738 [00:12<00:06, 530.30it/s] 63%|████████████████████████████████▋                   | 6126/9738 [00:12<00:06, 529.20it/s] 63%|█████████████████████████████████                   | 6180/9738 [00:12<00:06, 530.54it/s] 64%|█████████████████████████████████▎                  | 6234/9738 [00:12<00:06, 530.66it/s] 65%|█████████████████████████████████▌                  | 6288/9738 [00:13<00:06, 531.40it/s] 65%|█████████████████████████████████▊                  | 6342/9738 [00:13<00:06, 529.89it/s] 66%|██████████████████████████████████▏                 | 6396/9738 [00:13<00:06, 530.96it/s] 66%|██████████████████████████████████▍                 | 6450/9738 [00:13<00:06, 531.18it/s] 67%|██████████████████████████████████▋                 | 6504/9738 [00:13<00:06, 531.30it/s] 67%|███████████████████████████████████                 | 6558/9738 [00:13<00:06, 528.78it/s] 68%|███████████████████████████████████▎                | 6612/9738 [00:13<00:05, 529.65it/s] 68%|███████████████████████████████████▌                | 6666/9738 [00:13<00:05, 530.77it/s] 69%|███████████████████████████████████▉                | 6720/9738 [00:13<00:05, 531.77it/s] 70%|████████████████████████████████████▏               | 6774/9738 [00:14<00:05, 530.95it/s] 70%|████████████████████████████████████▍               | 6828/9738 [00:14<00:05, 531.49it/s] 71%|████████████████████████████████████▋               | 6882/9738 [00:14<00:05, 527.18it/s] 71%|█████████████████████████████████████               | 6936/9738 [00:14<00:05, 528.27it/s] 72%|█████████████████████████████████████▎              | 6989/9738 [00:14<00:05, 527.19it/s] 72%|█████████████████████████████████████▌              | 7043/9738 [00:14<00:05, 528.55it/s] 73%|█████████████████████████████████████▉              | 7097/9738 [00:14<00:04, 529.67it/s] 73%|██████████████████████████████████████▏             | 7151/9738 [00:14<00:04, 530.65it/s] 74%|██████████████████████████████████████▍             | 7205/9738 [00:14<00:04, 531.18it/s] 75%|██████████████████████████████████████▊             | 7259/9738 [00:14<00:04, 529.58it/s] 75%|███████████████████████████████████████             | 7313/9738 [00:15<00:04, 530.08it/s] 76%|███████████████████████████████████████▎            | 7367/9738 [00:15<00:04, 530.94it/s] 76%|███████████████████████████████████████▋            | 7421/9738 [00:15<00:04, 531.06it/s] 77%|███████████████████████████████████████▉            | 7475/9738 [00:15<00:04, 503.19it/s] 77%|████████████████████████████████████████▏           | 7528/9738 [00:15<00:04, 508.92it/s] 78%|████████████████████████████████████████▍           | 7581/9738 [00:15<00:04, 513.60it/s] 78%|████████████████████████████████████████▊           | 7634/9738 [00:15<00:04, 517.20it/s] 79%|█████████████████████████████████████████           | 7686/9738 [00:15<00:03, 516.82it/s] 79%|█████████████████████████████████████████▎          | 7738/9738 [00:15<00:03, 514.67it/s] 80%|█████████████████████████████████████████▌          | 7791/9738 [00:15<00:03, 516.65it/s] 81%|█████████████████████████████████████████▉          | 7844/9738 [00:16<00:03, 519.10it/s] 81%|██████████████████████████████████████████▏         | 7896/9738 [00:16<00:03, 518.58it/s] 82%|██████████████████████████████████████████▍         | 7949/9738 [00:16<00:03, 520.78it/s] 82%|██████████████████████████████████████████▋         | 8002/9738 [00:16<00:03, 521.52it/s] 83%|███████████████████████████████████████████         | 8055/9738 [00:16<00:03, 522.26it/s] 83%|███████████████████████████████████████████▎        | 8108/9738 [00:16<00:03, 523.44it/s] 84%|███████████████████████████████████████████▌        | 8161/9738 [00:16<00:03, 522.17it/s] 84%|███████████████████████████████████████████▊        | 8214/9738 [00:16<00:02, 522.19it/s] 85%|████████████████████████████████████████████▏       | 8267/9738 [00:16<00:02, 522.76it/s] 85%|████████████████████████████████████████████▍       | 8320/9738 [00:16<00:02, 522.94it/s] 86%|████████████████████████████████████████████▋       | 8373/9738 [00:17<00:02, 521.78it/s] 87%|████████████████████████████████████████████▉       | 8426/9738 [00:17<00:02, 522.88it/s] 87%|█████████████████████████████████████████████▎      | 8479/9738 [00:17<00:02, 523.50it/s] 88%|█████████████████████████████████████████████▌      | 8532/9738 [00:17<00:02, 523.52it/s] 88%|█████████████████████████████████████████████▊      | 8585/9738 [00:17<00:02, 521.13it/s] 89%|██████████████████████████████████████████████▏     | 8638/9738 [00:17<00:02, 518.25it/s] 89%|██████████████████████████████████████████████▍     | 8691/9738 [00:17<00:02, 519.36it/s] 90%|██████████████████████████████████████████████▋     | 8744/9738 [00:17<00:01, 520.67it/s] 90%|██████████████████████████████████████████████▉     | 8797/9738 [00:17<00:01, 520.86it/s] 91%|███████████████████████████████████████████████▎    | 8850/9738 [00:17<00:01, 519.50it/s] 91%|███████████████████████████████████████████████▌    | 8903/9738 [00:18<00:01, 521.01it/s] 92%|███████████████████████████████████████████████▊    | 8956/9738 [00:18<00:01, 522.23it/s] 93%|████████████████████████████████████████████████    | 9009/9738 [00:18<00:01, 522.66it/s] 93%|████████████████████████████████████████████████▍   | 9062/9738 [00:18<00:01, 520.20it/s] 94%|████████████████████████████████████████████████▋   | 9115/9738 [00:18<00:01, 521.07it/s] 94%|████████████████████████████████████████████████▉   | 9168/9738 [00:18<00:01, 521.62it/s] 95%|█████████████████████████████████████████████████▏  | 9221/9738 [00:18<00:00, 522.12it/s] 95%|█████████████████████████████████████████████████▌  | 9274/9738 [00:18<00:00, 520.93it/s] 96%|█████████████████████████████████████████████████▊  | 9327/9738 [00:18<00:00, 521.84it/s] 96%|██████████████████████████████████████████████████  | 9380/9738 [00:19<00:00, 521.95it/s] 97%|██████████████████████████████████████████████████▎ | 9433/9738 [00:19<00:00, 522.60it/s] 97%|██████████████████████████████████████████████████▋ | 9486/9738 [00:19<00:00, 521.04it/s] 98%|██████████████████████████████████████████████████▉ | 9539/9738 [00:19<00:00, 521.78it/s] 99%|███████████████████████████████████████████████████▏| 9592/9738 [00:19<00:00, 521.87it/s] 99%|███████████████████████████████████████████████████▌| 9645/9738 [00:19<00:00, 522.05it/s]100%|███████████████████████████████████████████████████▊| 9698/9738 [00:19<00:00, 522.08it/s]100%|████████████████████████████████████████████████████| 9738/9738 [00:19<00:00, 494.56it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.18s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.14s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.22s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.30s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.09s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.03s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.20s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.19s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.40s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.58s/it]
[2023-08-21 13:53:37,279] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.45s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.63s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.62s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.78s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.60s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.77s/it]
[2023-08-21 13:53:46,376] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-21 13:53:46,377] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-21 13:53:46,377] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-21 13:53:46,377] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-21 13:53:46,377] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-21 13:53:46,377] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-21 13:53:46,378] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-21 13:53:46,378] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-21 13:53:46,378] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-21 13:53:46,378] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-21 13:53:46,378] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-21 13:53:46,378] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f29ae59df40>
[2023-08-21 13:53:46,378] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-21 13:53:46,378] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-21 13:53:46,378] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-21 13:53:46,378] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-21 13:53:46,378] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-21 13:53:46,378] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-21 13:53:46,378] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-21 13:53:46,378] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-21 13:53:46,378] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-21 13:53:46,378] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-21 13:53:46,378] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-21 13:53:46,378] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-21 13:53:46,378] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-21 13:53:46,378] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f2984d3cdc0>
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-21 13:53:46,380] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-21 13:53:46,380] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-21 13:53:46,380] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-21 13:53:46,380] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-21 13:53:46,380] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-21 13:53:46,380] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-21 13:53:46,380] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.4832792282104492 seconds
Loading extension module utils...
Time to load utils op: 0.30419921875 seconds
Loading extension module utils...
Time to load utils op: 0.4059171676635742 seconds
Loading extension module utils...
Time to load utils op: 0.40446043014526367 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: 1. The question is asking about a location where there would be plumbing, but it wouldn't be of use to you if you were thirsty.
2. When we are thirsty, we need to drink water for hydration.
3. To understand the possibilities, let's investigate the options individually.
4. Option A: Oil refineries have plumbing to transport oil and various by-products. These pipelines do not contain drinking water.
5. Option B: Walls may have plumbing inside for residential water distribution, which contains water.
6. Option C: Shows represent an event place and they could also have some plumbing for firefighting or sanitary purposes, which again, contains water.
7. Option D: Own home obviously contains plenty of plumbing for water usage.
8. Option E: Water fountains have plumbing that contains water which is drinkable.
9. Comparing all the choices, the only one that doesn't have drinking water in its plumbing is the oil refinery.
10. Thus, the answer is A: Oil refineries.
So the final answer is A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Output: 1. Let's examine each answer choice closely. 
2. Choice A: working. This cannot be the answer because when a person is beginning work, they are working.
3. Choice B: resting. This also cannot be the answer because when a person is beginning work, they are inherently not resting.
4. Choice C: tiredness. Similarly, this cannot be the answer because this is a state that can occur both during and after work, but not necessarily when a person is beginning work. 
5. Choice E: momentum. This is not the answer because momentum refers to the drive or push for doing something, which would likely be present at the beginning of work.
6. Lastly, we look at Choice D: accomplishing. This is the correct answer because when a person is beginning work, they are in the process of attempting to accomplish something. Therefore, they aren't accomplishing something yet, as the task is merely just starting and there hasn't been enough time to complete anything meaningful.
So the final answer is D: accomplishing

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Output: 1. Begin by understanding what the question is asking. "Where might I find pens with a company logo?" The key here is "company logo". This implies a professional setting where a company will give out pens with their logo.
2. Let's eliminate the options that are not directly related to professional environments. "On a pencil" (B) is a place you wouldn't find a logoed pen because pens and pencils are different objects. "Write sentences on paper" (C) is not a place but an activity. 
3. Options "School" (D) and "Backpack" (E) could potentially have pens, but they are not the most direct answers. While a school or backpack might contain a logoed pen, they aren't places associated directly with companies. 
4. That leaves us with "Office" (A), which is a professional environment and the most likely place to find pens with a company logo. Companies often have pens with their logos in offices for employees to use or give to clients.
5. Therefore, the answer is A: Office.
So the final answer is A: office

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i3-s1-rTrue
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:46<37:39, 46.10s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:31<36:28, 45.60s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [02:16<35:36, 45.46s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [03:01<34:39, 45.21s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [03:46<33:53, 45.18s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [04:31<33:05, 45.12s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [05:16<32:21, 45.15s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [06:01<31:29, 44.98s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [06:46<30:47, 45.06s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [07:31<29:59, 44.98s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [08:16<29:14, 44.98s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [09:02<28:40, 45.26s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [09:47<27:50, 45.15s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [10:32<27:05, 45.15s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [11:17<26:19, 45.12s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [12:02<25:32, 45.08s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [12:47<24:48, 45.10s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [13:32<24:00, 45.00s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [14:16<23:10, 44.85s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [15:01<22:27, 44.92s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [15:46<21:43, 44.94s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [16:31<20:58, 44.94s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [17:17<20:15, 45.03s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [18:01<19:26, 44.88s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [18:47<18:47, 45.12s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [19:32<18:01, 45.06s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [20:17<17:15, 45.02s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [21:01<16:28, 44.94s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [21:46<15:43, 44.93s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [22:32<15:01, 45.05s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [23:17<14:18, 45.19s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [23:59<13:16, 44.27s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [24:44<12:36, 44.48s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [25:30<11:55, 44.74s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [26:14<11:11, 44.76s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [26:59<10:27, 44.81s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [27:45<09:44, 44.99s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [28:30<09:00, 45.02s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [29:15<08:15, 45.08s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [30:00<07:29, 44.99s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [30:45<06:45, 45.06s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [31:30<06:00, 45.05s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [32:15<05:15, 45.02s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [33:00<04:29, 44.90s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [33:44<03:44, 44.88s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [34:30<03:00, 45.13s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [35:15<02:15, 45.06s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [36:00<01:30, 45.10s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [36:45<00:45, 45.03s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [37:31<00:00, 45.22s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [37:31<00:00, 45.03s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 1.6918} | lm_loss 8.2776 | avg. gen lenth: 415.668
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i4-s1-rTrue --seed 1 --max-prompt-length 2048 --rationales --num-in-domain 4
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-21 14:31:24,459] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i4-s1-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 4
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i4-s1-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9737 [00:00<?, ?it/s]  0%|▏                                                     | 24/9737 [00:00<00:40, 238.60it/s]  0%|▎                                                     | 48/9737 [00:00<00:41, 231.58it/s]  1%|▍                                                     | 72/9737 [00:00<00:41, 234.38it/s]  1%|▌                                                     | 96/9737 [00:00<00:40, 235.78it/s]  1%|▋                                                    | 120/9737 [00:00<00:40, 236.44it/s]  1%|▊                                                    | 144/9737 [00:00<00:40, 236.79it/s]  2%|▉                                                    | 168/9737 [00:00<00:40, 237.23it/s]  2%|█                                                    | 192/9737 [00:00<00:40, 236.96it/s]  2%|█▏                                                   | 216/9737 [00:00<00:40, 235.47it/s]  2%|█▎                                                   | 240/9737 [00:01<00:40, 235.78it/s]  3%|█▍                                                   | 264/9737 [00:01<00:40, 235.24it/s]  3%|█▌                                                   | 288/9737 [00:01<00:40, 236.05it/s]  3%|█▋                                                   | 312/9737 [00:01<00:39, 236.81it/s]  3%|█▊                                                   | 336/9737 [00:01<00:39, 237.22it/s]  4%|█▉                                                   | 360/9737 [00:01<00:39, 237.73it/s]  4%|██                                                   | 384/9737 [00:01<00:39, 238.21it/s]  4%|██▏                                                  | 408/9737 [00:01<00:39, 238.45it/s]  4%|██▎                                                  | 432/9737 [00:01<00:39, 237.05it/s]  5%|██▍                                                  | 457/9737 [00:01<00:38, 238.03it/s]  5%|██▌                                                  | 481/9737 [00:02<00:38, 238.23it/s]  5%|██▋                                                  | 505/9737 [00:02<00:38, 238.32it/s]  5%|██▉                                                  | 529/9737 [00:02<00:38, 238.50it/s]  6%|███                                                  | 553/9737 [00:02<00:38, 238.55it/s]  6%|███▏                                                 | 577/9737 [00:02<00:38, 236.70it/s]  6%|███▎                                                 | 601/9737 [00:02<00:38, 236.96it/s]  6%|███▍                                                 | 625/9737 [00:02<00:38, 236.96it/s]  7%|███▌                                                 | 649/9737 [00:02<00:38, 237.38it/s]  7%|███▋                                                 | 676/9737 [00:02<00:36, 246.92it/s]  7%|███▉                                                 | 713/9737 [00:02<00:31, 282.08it/s]  8%|████                                                 | 750/9737 [00:03<00:29, 306.38it/s]  8%|████▎                                                | 787/9737 [00:03<00:27, 323.96it/s]  8%|████▍                                                | 824/9737 [00:03<00:26, 335.90it/s]  9%|████▋                                                | 861/9737 [00:03<00:25, 344.13it/s]  9%|████▉                                                | 897/9737 [00:03<00:25, 348.18it/s] 10%|█████                                                | 934/9737 [00:03<00:24, 352.43it/s] 10%|█████▎                                               | 971/9737 [00:03<00:24, 355.64it/s] 10%|█████▍                                              | 1007/9737 [00:03<00:24, 354.69it/s] 11%|█████▌                                              | 1044/9737 [00:03<00:24, 357.01it/s] 11%|█████▊                                              | 1081/9737 [00:03<00:24, 358.35it/s] 11%|█████▉                                              | 1117/9737 [00:04<00:24, 355.61it/s] 12%|██████▏                                             | 1154/9737 [00:04<00:24, 357.29it/s] 12%|██████▎                                             | 1191/9737 [00:04<00:23, 358.51it/s] 13%|██████▌                                             | 1228/9737 [00:04<00:23, 359.43it/s] 13%|██████▊                                             | 1265/9737 [00:04<00:23, 360.22it/s] 13%|██████▉                                             | 1302/9737 [00:04<00:23, 361.22it/s] 14%|███████▏                                            | 1339/9737 [00:04<00:23, 359.95it/s] 14%|███████▎                                            | 1376/9737 [00:04<00:23, 360.77it/s] 15%|███████▌                                            | 1413/9737 [00:04<00:23, 361.22it/s] 15%|███████▋                                            | 1450/9737 [00:04<00:22, 361.72it/s] 15%|███████▉                                            | 1487/9737 [00:05<00:22, 362.21it/s] 16%|████████▏                                           | 1524/9737 [00:05<00:22, 361.89it/s] 16%|████████▎                                           | 1561/9737 [00:05<00:22, 362.38it/s] 16%|████████▌                                           | 1598/9737 [00:05<00:22, 360.58it/s] 17%|████████▋                                           | 1635/9737 [00:05<00:22, 360.15it/s] 17%|████████▉                                           | 1672/9737 [00:05<00:22, 361.26it/s] 18%|█████████▏                                          | 1709/9737 [00:05<00:22, 361.81it/s] 18%|█████████▎                                          | 1746/9737 [00:05<00:22, 362.53it/s] 18%|█████████▌                                          | 1783/9737 [00:05<00:21, 362.68it/s] 19%|█████████▋                                          | 1820/9737 [00:06<00:23, 340.09it/s] 19%|█████████▉                                          | 1857/9737 [00:06<00:22, 346.38it/s] 19%|██████████                                          | 1894/9737 [00:06<00:22, 351.22it/s] 20%|██████████▎                                         | 1931/9737 [00:06<00:22, 354.46it/s] 20%|██████████▌                                         | 1968/9737 [00:06<00:21, 356.88it/s] 21%|██████████▋                                         | 2005/9737 [00:06<00:21, 359.07it/s] 21%|██████████▉                                         | 2041/9737 [00:06<00:21, 358.01it/s] 21%|███████████                                         | 2078/9737 [00:06<00:21, 359.21it/s] 22%|███████████▎                                        | 2115/9737 [00:06<00:21, 359.72it/s] 22%|███████████▍                                        | 2152/9737 [00:06<00:21, 360.38it/s] 22%|███████████▋                                        | 2189/9737 [00:07<00:20, 360.87it/s] 23%|███████████▉                                        | 2226/9737 [00:07<00:20, 360.22it/s] 23%|████████████                                        | 2263/9737 [00:07<00:20, 359.24it/s] 24%|████████████▎                                       | 2300/9737 [00:07<00:20, 360.40it/s] 24%|████████████▍                                       | 2337/9737 [00:07<00:20, 360.76it/s] 24%|████████████▋                                       | 2374/9737 [00:07<00:20, 361.66it/s] 25%|████████████▉                                       | 2411/9737 [00:07<00:20, 362.48it/s] 25%|█████████████                                       | 2448/9737 [00:07<00:20, 362.71it/s] 26%|█████████████▎                                      | 2485/9737 [00:07<00:20, 361.03it/s] 26%|█████████████▍                                      | 2522/9737 [00:07<00:19, 361.49it/s] 26%|█████████████▋                                      | 2559/9737 [00:08<00:19, 361.87it/s] 27%|█████████████▊                                      | 2596/9737 [00:08<00:19, 362.78it/s] 27%|██████████████                                      | 2633/9737 [00:08<00:19, 362.83it/s] 27%|██████████████▎                                     | 2670/9737 [00:08<00:19, 362.58it/s] 28%|██████████████▍                                     | 2707/9737 [00:08<00:19, 360.63it/s] 28%|██████████████▋                                     | 2744/9737 [00:08<00:19, 361.35it/s] 29%|██████████████▊                                     | 2781/9737 [00:08<00:19, 361.54it/s] 29%|███████████████                                     | 2818/9737 [00:08<00:19, 362.09it/s] 29%|███████████████▏                                    | 2855/9737 [00:08<00:19, 359.72it/s] 30%|███████████████▍                                    | 2892/9737 [00:08<00:18, 361.12it/s] 30%|███████████████▋                                    | 2929/9737 [00:09<00:18, 359.91it/s] 30%|███████████████▊                                    | 2966/9737 [00:09<00:18, 360.55it/s] 31%|████████████████                                    | 3003/9737 [00:09<00:18, 361.42it/s] 31%|████████████████▏                                   | 3040/9737 [00:09<00:18, 361.64it/s] 32%|████████████████▍                                   | 3077/9737 [00:09<00:18, 361.83it/s] 32%|████████████████▋                                   | 3114/9737 [00:09<00:18, 362.20it/s] 32%|████████████████▊                                   | 3151/9737 [00:09<00:18, 362.54it/s] 33%|█████████████████                                   | 3188/9737 [00:09<00:18, 361.00it/s] 33%|█████████████████▏                                  | 3225/9737 [00:09<00:18, 361.47it/s] 34%|█████████████████▍                                  | 3262/9737 [00:10<00:17, 361.78it/s] 34%|█████████████████▌                                  | 3299/9737 [00:10<00:17, 362.29it/s] 34%|█████████████████▊                                  | 3336/9737 [00:10<00:17, 362.08it/s] 35%|██████████████████                                  | 3373/9737 [00:10<00:17, 362.28it/s] 35%|██████████████████▏                                 | 3410/9737 [00:10<00:17, 360.78it/s] 35%|██████████████████▍                                 | 3447/9737 [00:10<00:17, 360.90it/s] 36%|██████████████████▌                                 | 3484/9737 [00:10<00:17, 361.44it/s] 36%|██████████████████▊                                 | 3521/9737 [00:10<00:17, 361.16it/s] 37%|███████████████████                                 | 3558/9737 [00:10<00:17, 361.70it/s] 37%|███████████████████▏                                | 3595/9737 [00:10<00:16, 361.74it/s] 37%|███████████████████▍                                | 3632/9737 [00:11<00:16, 360.45it/s] 38%|███████████████████▌                                | 3669/9737 [00:11<00:16, 360.87it/s] 38%|███████████████████▊                                | 3706/9737 [00:11<00:16, 361.58it/s] 38%|███████████████████▉                                | 3743/9737 [00:11<00:16, 361.81it/s] 39%|████████████████████▏                               | 3780/9737 [00:11<00:16, 362.09it/s] 39%|████████████████████▍                               | 3817/9737 [00:11<00:16, 361.93it/s] 40%|████████████████████▌                               | 3854/9737 [00:11<00:16, 360.46it/s] 40%|████████████████████▊                               | 3891/9737 [00:11<00:16, 361.40it/s] 40%|████████████████████▉                               | 3928/9737 [00:11<00:16, 361.86it/s] 41%|█████████████████████▏                              | 3965/9737 [00:11<00:15, 361.87it/s] 41%|█████████████████████▎                              | 4002/9737 [00:12<00:15, 362.24it/s] 41%|█████████████████████▌                              | 4039/9737 [00:12<00:15, 362.61it/s] 42%|█████████████████████▊                              | 4076/9737 [00:12<00:15, 357.69it/s] 42%|█████████████████████▉                              | 4113/9737 [00:12<00:15, 358.89it/s] 43%|██████████████████████▏                             | 4150/9737 [00:12<00:15, 359.59it/s] 43%|██████████████████████▎                             | 4187/9737 [00:12<00:15, 360.48it/s] 43%|██████████████████████▌                             | 4224/9737 [00:12<00:15, 361.12it/s] 44%|██████████████████████▊                             | 4261/9737 [00:12<00:15, 361.90it/s] 44%|██████████████████████▉                             | 4298/9737 [00:12<00:15, 360.69it/s] 45%|███████████████████████▏                            | 4335/9737 [00:12<00:14, 361.41it/s] 45%|███████████████████████▎                            | 4372/9737 [00:13<00:14, 361.97it/s] 45%|███████████████████████▌                            | 4409/9737 [00:13<00:14, 361.89it/s] 46%|███████████████████████▋                            | 4446/9737 [00:13<00:14, 361.65it/s] 46%|███████████████████████▉                            | 4483/9737 [00:13<00:14, 361.87it/s] 46%|████████████████████████▏                           | 4520/9737 [00:13<00:15, 335.53it/s] 47%|████████████████████████▎                           | 4557/9737 [00:13<00:15, 343.27it/s] 47%|████████████████████████▌                           | 4594/9737 [00:13<00:14, 349.10it/s] 48%|████████████████████████▋                           | 4631/9737 [00:13<00:14, 353.19it/s] 48%|████████████████████████▉                           | 4667/9737 [00:13<00:14, 353.59it/s] 48%|█████████████████████████                           | 4704/9737 [00:14<00:14, 356.27it/s] 49%|█████████████████████████▎                          | 4741/9737 [00:14<00:19, 256.21it/s] 49%|█████████████████████████▌                          | 4778/9737 [00:14<00:17, 280.65it/s] 49%|█████████████████████████▋                          | 4815/9737 [00:14<00:16, 301.19it/s] 50%|█████████████████████████▉                          | 4852/9737 [00:14<00:15, 316.92it/s] 50%|██████████████████████████                          | 4889/9737 [00:14<00:14, 329.20it/s] 51%|██████████████████████████▎                         | 4926/9737 [00:14<00:14, 338.73it/s] 51%|██████████████████████████▍                         | 4962/9737 [00:14<00:13, 344.05it/s] 51%|██████████████████████████▋                         | 4999/9737 [00:14<00:13, 348.99it/s] 52%|██████████████████████████▉                         | 5036/9737 [00:15<00:13, 353.11it/s] 52%|███████████████████████████                         | 5073/9737 [00:15<00:13, 355.41it/s] 52%|███████████████████████████▎                        | 5110/9737 [00:15<00:12, 357.57it/s] 53%|███████████████████████████▍                        | 5147/9737 [00:15<00:12, 359.27it/s] 53%|███████████████████████████▋                        | 5184/9737 [00:15<00:12, 358.74it/s] 54%|███████████████████████████▉                        | 5221/9737 [00:15<00:12, 360.17it/s] 54%|████████████████████████████                        | 5258/9737 [00:15<00:12, 357.67it/s] 54%|████████████████████████████▎                       | 5295/9737 [00:15<00:12, 359.21it/s] 55%|████████████████████████████▍                       | 5332/9737 [00:15<00:12, 359.83it/s] 55%|████████████████████████████▋                       | 5369/9737 [00:16<00:12, 360.81it/s] 56%|████████████████████████████▊                       | 5406/9737 [00:16<00:12, 359.36it/s] 56%|█████████████████████████████                       | 5443/9737 [00:16<00:11, 360.61it/s] 56%|█████████████████████████████▎                      | 5480/9737 [00:16<00:11, 362.25it/s] 57%|█████████████████████████████▍                      | 5518/9737 [00:16<00:11, 365.97it/s] 57%|█████████████████████████████▋                      | 5556/9737 [00:16<00:11, 368.44it/s] 57%|█████████████████████████████▊                      | 5594/9737 [00:16<00:11, 369.94it/s] 58%|██████████████████████████████                      | 5631/9737 [00:16<00:11, 369.18it/s] 58%|██████████████████████████████▎                     | 5669/9737 [00:16<00:10, 370.38it/s] 59%|██████████████████████████████▍                     | 5707/9737 [00:16<00:10, 371.33it/s] 59%|██████████████████████████████▋                     | 5745/9737 [00:17<00:10, 372.07it/s] 59%|██████████████████████████████▉                     | 5783/9737 [00:17<00:10, 372.63it/s] 60%|███████████████████████████████                     | 5821/9737 [00:17<00:10, 372.78it/s] 60%|███████████████████████████████▎                    | 5859/9737 [00:17<00:10, 370.73it/s] 61%|███████████████████████████████▍                    | 5897/9737 [00:17<00:10, 371.69it/s] 61%|███████████████████████████████▋                    | 5935/9737 [00:17<00:10, 372.42it/s] 61%|███████████████████████████████▉                    | 5973/9737 [00:17<00:10, 373.09it/s] 62%|████████████████████████████████                    | 6011/9737 [00:17<00:09, 373.11it/s] 62%|████████████████████████████████▎                   | 6049/9737 [00:17<00:09, 371.37it/s] 63%|████████████████████████████████▌                   | 6087/9737 [00:17<00:09, 369.92it/s] 63%|████████████████████████████████▋                   | 6125/9737 [00:18<00:09, 370.94it/s] 63%|████████████████████████████████▉                   | 6163/9737 [00:18<00:09, 371.79it/s] 64%|█████████████████████████████████                   | 6201/9737 [00:18<00:09, 372.30it/s] 64%|█████████████████████████████████▎                  | 6239/9737 [00:18<00:09, 372.38it/s] 64%|█████████████████████████████████▌                  | 6277/9737 [00:18<00:09, 372.84it/s] 65%|█████████████████████████████████▋                  | 6315/9737 [00:18<00:09, 370.96it/s] 65%|█████████████████████████████████▉                  | 6353/9737 [00:18<00:09, 371.31it/s] 66%|██████████████████████████████████▏                 | 6391/9737 [00:18<00:09, 371.73it/s] 66%|██████████████████████████████████▎                 | 6429/9737 [00:18<00:08, 372.30it/s] 66%|██████████████████████████████████▌                 | 6467/9737 [00:18<00:08, 372.24it/s] 67%|██████████████████████████████████▋                 | 6505/9737 [00:19<00:08, 372.86it/s] 67%|██████████████████████████████████▉                 | 6543/9737 [00:19<00:08, 371.30it/s] 68%|███████████████████████████████████▏                | 6581/9737 [00:19<00:08, 372.13it/s] 68%|███████████████████████████████████▎                | 6619/9737 [00:19<00:08, 372.55it/s] 68%|███████████████████████████████████▌                | 6657/9737 [00:19<00:08, 372.79it/s] 69%|███████████████████████████████████▊                | 6695/9737 [00:19<00:08, 372.56it/s] 69%|███████████████████████████████████▉                | 6733/9737 [00:19<00:08, 372.64it/s] 70%|████████████████████████████████████▏               | 6771/9737 [00:19<00:07, 370.77it/s] 70%|████████████████████████████████████▎               | 6809/9737 [00:19<00:07, 371.75it/s] 70%|████████████████████████████████████▌               | 6847/9737 [00:19<00:07, 371.85it/s] 71%|████████████████████████████████████▊               | 6885/9737 [00:20<00:07, 372.36it/s] 71%|████████████████████████████████████▉               | 6923/9737 [00:20<00:07, 372.84it/s] 71%|█████████████████████████████████████▏              | 6961/9737 [00:20<00:07, 373.12it/s] 72%|█████████████████████████████████████▍              | 6999/9737 [00:20<00:07, 370.83it/s] 72%|█████████████████████████████████████▌              | 7037/9737 [00:20<00:07, 371.23it/s] 73%|█████████████████████████████████████▊              | 7075/9737 [00:20<00:07, 371.78it/s] 73%|█████████████████████████████████████▉              | 7113/9737 [00:20<00:07, 372.25it/s] 73%|██████████████████████████████████████▏             | 7151/9737 [00:20<00:06, 372.43it/s] 74%|██████████████████████████████████████▍             | 7189/9737 [00:20<00:06, 372.87it/s] 74%|██████████████████████████████████████▌             | 7227/9737 [00:21<00:06, 371.17it/s] 75%|██████████████████████████████████████▊             | 7265/9737 [00:21<00:06, 371.81it/s] 75%|███████████████████████████████████████             | 7303/9737 [00:21<00:06, 372.07it/s] 75%|███████████████████████████████████████▏            | 7341/9737 [00:21<00:06, 371.86it/s] 76%|███████████████████████████████████████▍            | 7379/9737 [00:21<00:06, 372.15it/s] 76%|███████████████████████████████████████▌            | 7417/9737 [00:21<00:06, 372.23it/s] 77%|███████████████████████████████████████▊            | 7455/9737 [00:21<00:06, 349.97it/s] 77%|████████████████████████████████████████            | 7493/9737 [00:21<00:06, 356.60it/s] 77%|████████████████████████████████████████▏           | 7531/9737 [00:21<00:06, 361.05it/s] 78%|████████████████████████████████████████▍           | 7569/9737 [00:21<00:05, 364.58it/s] 78%|████████████████████████████████████████▌           | 7607/9737 [00:22<00:05, 366.87it/s] 79%|████████████████████████████████████████▊           | 7645/9737 [00:22<00:05, 368.26it/s] 79%|█████████████████████████████████████████           | 7682/9737 [00:22<00:05, 366.89it/s] 79%|█████████████████████████████████████████▏          | 7720/9737 [00:22<00:05, 368.91it/s] 80%|█████████████████████████████████████████▍          | 7758/9737 [00:22<00:05, 370.36it/s] 80%|█████████████████████████████████████████▋          | 7796/9737 [00:22<00:05, 371.17it/s] 80%|█████████████████████████████████████████▊          | 7834/9737 [00:22<00:05, 371.74it/s] 81%|██████████████████████████████████████████          | 7872/9737 [00:22<00:05, 372.06it/s] 81%|██████████████████████████████████████████▏         | 7910/9737 [00:22<00:04, 370.71it/s] 82%|██████████████████████████████████████████▍         | 7948/9737 [00:22<00:04, 370.86it/s] 82%|██████████████████████████████████████████▋         | 7986/9737 [00:23<00:04, 371.13it/s] 82%|██████████████████████████████████████████▊         | 8024/9737 [00:23<00:04, 371.60it/s] 83%|███████████████████████████████████████████         | 8062/9737 [00:23<00:04, 371.86it/s] 83%|███████████████████████████████████████████▎        | 8100/9737 [00:23<00:04, 372.49it/s] 84%|███████████████████████████████████████████▍        | 8138/9737 [00:23<00:04, 371.26it/s] 84%|███████████████████████████████████████████▋        | 8176/9737 [00:23<00:04, 371.72it/s] 84%|███████████████████████████████████████████▊        | 8214/9737 [00:23<00:04, 372.33it/s] 85%|████████████████████████████████████████████        | 8252/9737 [00:23<00:03, 372.31it/s] 85%|████████████████████████████████████████████▎       | 8290/9737 [00:23<00:03, 371.67it/s] 86%|████████████████████████████████████████████▍       | 8328/9737 [00:23<00:03, 371.57it/s] 86%|████████████████████████████████████████████▋       | 8366/9737 [00:24<00:03, 370.02it/s] 86%|████████████████████████████████████████████▉       | 8404/9737 [00:24<00:03, 370.73it/s] 87%|█████████████████████████████████████████████       | 8442/9737 [00:24<00:03, 371.66it/s] 87%|█████████████████████████████████████████████▎      | 8480/9737 [00:24<00:03, 371.86it/s] 87%|█████████████████████████████████████████████▍      | 8518/9737 [00:24<00:03, 371.73it/s] 88%|█████████████████████████████████████████████▋      | 8556/9737 [00:24<00:03, 371.84it/s] 88%|█████████████████████████████████████████████▉      | 8594/9737 [00:24<00:03, 369.12it/s] 89%|██████████████████████████████████████████████      | 8632/9737 [00:24<00:02, 369.46it/s] 89%|██████████████████████████████████████████████▎     | 8670/9737 [00:24<00:02, 370.04it/s] 89%|██████████████████████████████████████████████▌     | 8708/9737 [00:25<00:02, 369.91it/s] 90%|██████████████████████████████████████████████▋     | 8745/9737 [00:25<00:02, 369.25it/s] 90%|██████████████████████████████████████████████▉     | 8783/9737 [00:25<00:02, 370.18it/s] 91%|███████████████████████████████████████████████     | 8821/9737 [00:25<00:02, 369.01it/s] 91%|███████████████████████████████████████████████▎    | 8859/9737 [00:25<00:02, 369.89it/s] 91%|███████████████████████████████████████████████▌    | 8897/9737 [00:25<00:02, 370.13it/s] 92%|███████████████████████████████████████████████▋    | 8935/9737 [00:25<00:02, 370.76it/s] 92%|███████████████████████████████████████████████▉    | 8973/9737 [00:25<00:02, 371.19it/s] 93%|████████████████████████████████████████████████    | 9011/9737 [00:25<00:01, 371.49it/s] 93%|████████████████████████████████████████████████▎   | 9049/9737 [00:25<00:01, 370.00it/s] 93%|████████████████████████████████████████████████▌   | 9087/9737 [00:26<00:01, 370.89it/s] 94%|████████████████████████████████████████████████▋   | 9125/9737 [00:26<00:01, 371.46it/s] 94%|████████████████████████████████████████████████▉   | 9163/9737 [00:26<00:01, 371.62it/s] 94%|█████████████████████████████████████████████████▏  | 9201/9737 [00:26<00:01, 371.64it/s] 95%|█████████████████████████████████████████████████▎  | 9239/9737 [00:26<00:01, 371.23it/s] 95%|█████████████████████████████████████████████████▌  | 9277/9737 [00:26<00:01, 369.48it/s] 96%|█████████████████████████████████████████████████▋  | 9315/9737 [00:26<00:01, 369.97it/s] 96%|█████████████████████████████████████████████████▉  | 9353/9737 [00:26<00:01, 370.56it/s] 96%|██████████████████████████████████████████████████▏ | 9391/9737 [00:26<00:00, 371.39it/s] 97%|██████████████████████████████████████████████████▎ | 9429/9737 [00:26<00:00, 371.69it/s] 97%|██████████████████████████████████████████████████▌ | 9467/9737 [00:27<00:00, 371.61it/s] 98%|██████████████████████████████████████████████████▊ | 9505/9737 [00:27<00:00, 370.05it/s] 98%|██████████████████████████████████████████████████▉ | 9543/9737 [00:27<00:00, 370.48it/s] 98%|███████████████████████████████████████████████████▏| 9581/9737 [00:27<00:00, 370.66it/s] 99%|███████████████████████████████████████████████████▎| 9619/9737 [00:27<00:00, 370.75it/s] 99%|███████████████████████████████████████████████████▌| 9657/9737 [00:27<00:00, 370.79it/s]100%|███████████████████████████████████████████████████▊| 9695/9737 [00:27<00:00, 371.30it/s]100%|███████████████████████████████████████████████████▉| 9733/9737 [00:27<00:00, 369.90it/s]100%|████████████████████████████████████████████████████| 9737/9737 [00:27<00:00, 350.27it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.24s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.08s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.10s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.33s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.17s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.04s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:04,  5.00s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.23s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.61s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.77s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.46s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.62s/it]
[2023-08-21 14:32:44,113] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.47s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.62s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.62s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.80s/it]
[2023-08-21 14:32:51,720] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-21 14:32:51,721] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-21 14:32:51,722] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-21 14:32:51,722] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-21 14:32:51,722] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-21 14:32:51,722] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f8600ecaf40>
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f85d8179dc0>
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-21 14:32:51,725] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-21 14:32:51,725] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-21 14:32:51,725] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-21 14:32:51,725] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-21 14:32:51,725] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-21 14:32:51,725] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-21 14:32:51,725] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-21 14:32:51,725] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.4522836208343506 seconds
Loading extension module utils...
Time to load utils op: 0.4044163227081299 seconds
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.5047407150268555 seconds
Time to load utils op: 0.5047478675842285 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: 1. The question asks where you would find plumbing that is not useful to you when you are thirsty.
2. This means we're looking for a place with plumbing that does not contain potable, or drinkable, water.
3. The choices are: oil refineries, a wall, a show, your own home, and a water fountain.
4. You can eliminate "a wall" because generally, walls do not have plumbing.
5. You can also eliminate "a show" because it refers to a type of event rather than a place which could contain plumbing.
6. In your own home and at water fountains, you would generally expect the plumbing to supply clean, drinkable water. Therefore, these can also be eliminated.
7. That leaves "oil refineries." Oil refineries use complex systems of plumbing to transport and process oil.
8. You wouldn't want to or be able to drink the liquids (like oil or other chemicals) passing through an oil refinery's plumbing system. 
9. Therefore, the answer is A: oil refineries.
So the final answer is A: oil refineries.

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Output: 1. The question is asking for what a person isn't doing yet when they are beginning to work. 

2. Let's analyze each answer choice: 

   A: working - this suggests that the person is actually in action. But since they are just starting, they may not yet be fully engaged. However, they are still technically working. So, this isn't the right choice.
  
   B: resting - this implies that the person is not involved in any activities. If they are beginning to work, then they are definitely not resting. This answer can be eliminated as well.
   
   C: tiredness - this relates to a physical or mental state of exhaustion. It is possible that a person might feel tired at the beginning of work. However, it isn't necessarily true that they are not experiencing tiredness. So, this isn't the best choice.
   
   D: accomplishing - this refers to the act of achieving or completing something. If the person is just beginning to work, they have not completed or achieved their task yet. Thus, this could be a possible correct answer.
   
   E: momentum - this implies movement or progress. Since the person is just beginning work, they haven't started gaining momentum yet. It could be a close contender, but not as precise as choice D.

3. Therefore, the best answer is D: accomplishing, because when a person is just starting to work, they are not yet achieving or completing anything.
So the final answer is D: accomplishing.

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Output: Step 1: Understand the question, which is asking for a location where pens with a company logo might be found.
Step 2: Review each of the choices individually and analyze their relevance to the question.
Step 3: Look at choice A: "Office". This is a common setting where pens are used and many companies distribute logoed pens as promotional items to their employees or during meetings.
Step 4: Look at choice B: "On a pencil". This doesn't provide a location, rather a different object. This is not a logical answer to the question. 
Step 5: Look at choice C: "Write sentences on paper". This again is not a location so it cannot be the correct answer. 
Step 6: Look at choice D: "School". While this is a location and pens are used here, it's less usual to find pens with a company logo at a school as compared to an office.
Step 7: Look at choice E: "Backpack". Bags might hold pens, but it's not directly related to company logo pens, as these could be anywhere rather than specifically in a backpack.
Step 8: After reviewing all the choices, choice A "office" appears to be the most likely and logical location to find pens with a company logo.
So the final answer is A: office.

Input: Billy called out to John, and listened for what? Choices:  A: silence B: response C: communication D: hanging up E: whisper
Output: 1. The question is about what Billy is expecting after he calls out to John.
2. To understand what Billy is expecting, we have to understand the usual sequence of events in a conversation.
3. When one person calls out to another, typically they are doing so to elicit some sort of reaction.
4. This reaction can take on various forms but in the context of a conversation, this reaction is usually a response.
5. Among the answer choices provided, "response" is the one that suits best in this context.
6. Therefore, the answer is B: response.
So the final answer is B: response.

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i4-s1-rTrue
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:42<34:56, 42.79s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:25<33:59, 42.48s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [02:07<33:11, 42.37s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [02:49<32:24, 42.28s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [03:31<31:46, 42.37s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [04:14<31:03, 42.34s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [04:56<30:20, 42.34s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [05:39<29:39, 42.36s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [06:21<28:56, 42.34s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [07:03<28:13, 42.35s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [07:46<27:35, 42.44s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [08:28<26:52, 42.44s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [09:11<26:11, 42.47s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [09:53<25:26, 42.40s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [10:35<24:42, 42.35s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [11:17<23:57, 42.29s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [12:00<23:16, 42.31s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [12:42<22:36, 42.38s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [13:23<21:34, 41.76s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [14:05<20:57, 41.93s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [14:47<20:18, 42.02s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [15:29<19:36, 42.03s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [16:11<18:55, 42.06s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [16:54<18:15, 42.12s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [17:36<17:36, 42.24s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [18:19<16:57, 42.38s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [19:01<16:15, 42.43s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [19:44<15:32, 42.37s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [20:26<14:50, 42.41s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [21:09<14:09, 42.47s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [21:51<13:26, 42.43s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [22:33<12:42, 42.36s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [23:16<11:59, 42.35s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [23:58<11:17, 42.33s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [24:40<10:35, 42.37s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [25:23<09:53, 42.36s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [26:06<09:13, 42.56s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [26:48<08:28, 42.38s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [27:31<07:48, 42.59s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [28:13<07:05, 42.51s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [28:55<06:22, 42.48s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [29:38<05:39, 42.49s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [30:20<04:57, 42.44s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [31:03<04:14, 42.40s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [31:45<03:31, 42.37s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [32:27<02:49, 42.41s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [33:10<02:07, 42.40s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [33:52<01:24, 42.38s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [34:35<00:42, 42.48s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [35:17<00:00, 42.44s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [35:17<00:00, 42.35s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 1.7481} | lm_loss 8.1333 | avg. gen lenth: 398.764
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i5-s1-rTrue --seed 1 --max-prompt-length 2048 --rationales --num-in-domain 5
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-21 15:08:18,673] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i5-s1-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 5
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i5-s1-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9736 [00:00<?, ?it/s]  0%|                                                      | 19/9736 [00:00<00:51, 188.41it/s]  0%|▏                                                     | 38/9736 [00:00<00:51, 188.98it/s]  1%|▎                                                     | 58/9736 [00:00<00:51, 189.57it/s]  1%|▍                                                     | 78/9736 [00:00<00:50, 190.18it/s]  1%|▌                                                     | 98/9736 [00:00<00:50, 190.55it/s]  1%|▋                                                    | 118/9736 [00:00<00:51, 187.42it/s]  1%|▊                                                    | 138/9736 [00:00<00:50, 188.33it/s]  2%|▊                                                    | 158/9736 [00:00<00:50, 189.14it/s]  2%|▉                                                    | 178/9736 [00:00<00:50, 189.48it/s]  2%|█                                                    | 198/9736 [00:01<00:50, 189.78it/s]  2%|█▏                                                   | 217/9736 [00:01<00:50, 188.45it/s]  2%|█▎                                                   | 237/9736 [00:01<00:50, 189.11it/s]  3%|█▍                                                   | 262/9736 [00:01<00:45, 206.50it/s]  3%|█▌                                                   | 291/9736 [00:01<00:40, 230.93it/s]  3%|█▋                                                   | 320/9736 [00:01<00:37, 248.39it/s]  4%|█▉                                                   | 348/9736 [00:01<00:36, 257.05it/s]  4%|██                                                   | 377/9736 [00:01<00:35, 266.56it/s]  4%|██▏                                                  | 406/9736 [00:01<00:34, 273.50it/s]  4%|██▎                                                  | 434/9736 [00:01<00:33, 275.28it/s]  5%|██▌                                                  | 463/9736 [00:02<00:33, 278.84it/s]  5%|██▋                                                  | 492/9736 [00:02<00:32, 281.60it/s]  5%|██▊                                                  | 521/9736 [00:02<00:32, 283.95it/s]  6%|██▉                                                  | 550/9736 [00:02<00:32, 285.58it/s]  6%|███▏                                                 | 579/9736 [00:02<00:31, 286.66it/s]  6%|███▎                                                 | 608/9736 [00:02<00:31, 287.45it/s]  7%|███▍                                                 | 637/9736 [00:02<00:31, 287.58it/s]  7%|███▋                                                 | 666/9736 [00:02<00:31, 286.12it/s]  7%|███▊                                                 | 695/9736 [00:02<00:31, 287.04it/s]  7%|███▉                                                 | 724/9736 [00:02<00:32, 275.77it/s]  8%|████                                                 | 753/9736 [00:03<00:32, 279.64it/s]  8%|████▎                                                | 782/9736 [00:03<00:31, 282.22it/s]  8%|████▍                                                | 811/9736 [00:03<00:31, 284.03it/s]  9%|████▌                                                | 840/9736 [00:03<00:31, 285.40it/s]  9%|████▋                                                | 869/9736 [00:03<00:30, 286.44it/s]  9%|████▉                                                | 898/9736 [00:03<00:31, 285.03it/s] 10%|█████                                                | 927/9736 [00:03<00:30, 285.79it/s] 10%|█████▏                                               | 956/9736 [00:03<00:30, 286.50it/s] 10%|█████▎                                               | 985/9736 [00:03<00:30, 287.18it/s] 10%|█████▍                                              | 1014/9736 [00:03<00:30, 286.55it/s] 11%|█████▌                                              | 1043/9736 [00:04<00:30, 286.86it/s] 11%|█████▋                                              | 1072/9736 [00:04<00:30, 287.41it/s] 11%|█████▉                                              | 1101/9736 [00:04<00:29, 287.86it/s] 12%|██████                                              | 1130/9736 [00:04<00:30, 286.13it/s] 12%|██████▏                                             | 1159/9736 [00:04<00:29, 286.70it/s] 12%|██████▎                                             | 1188/9736 [00:04<00:29, 286.95it/s] 12%|██████▌                                             | 1217/9736 [00:04<00:29, 287.07it/s] 13%|██████▋                                             | 1246/9736 [00:04<00:29, 287.36it/s] 13%|██████▊                                             | 1275/9736 [00:04<00:29, 287.51it/s] 13%|██████▉                                             | 1304/9736 [00:04<00:29, 287.45it/s] 14%|███████                                             | 1333/9736 [00:05<00:29, 287.69it/s] 14%|███████▎                                            | 1362/9736 [00:05<00:29, 285.98it/s] 14%|███████▍                                            | 1391/9736 [00:05<00:29, 286.23it/s] 15%|███████▌                                            | 1420/9736 [00:05<00:29, 286.05it/s] 15%|███████▋                                            | 1449/9736 [00:05<00:28, 285.76it/s] 15%|███████▉                                            | 1478/9736 [00:05<00:28, 285.55it/s] 15%|████████                                            | 1507/9736 [00:05<00:28, 285.13it/s] 16%|████████▏                                           | 1536/9736 [00:05<00:28, 285.36it/s] 16%|████████▎                                           | 1565/9736 [00:05<00:28, 283.78it/s] 16%|████████▌                                           | 1594/9736 [00:06<00:28, 284.09it/s] 17%|████████▋                                           | 1623/9736 [00:06<00:28, 284.58it/s] 17%|████████▊                                           | 1652/9736 [00:06<00:28, 284.97it/s] 17%|████████▉                                           | 1681/9736 [00:06<00:28, 285.02it/s] 18%|█████████▏                                          | 1710/9736 [00:06<00:28, 285.20it/s] 18%|█████████▎                                          | 1739/9736 [00:06<00:28, 285.29it/s] 18%|█████████▍                                          | 1768/9736 [00:06<00:27, 285.35it/s] 18%|█████████▌                                          | 1797/9736 [00:06<00:29, 268.15it/s] 19%|█████████▊                                          | 1826/9736 [00:06<00:28, 273.00it/s] 19%|█████████▉                                          | 1855/9736 [00:06<00:28, 276.57it/s] 19%|██████████                                          | 1884/9736 [00:07<00:28, 278.49it/s] 20%|██████████▏                                         | 1913/9736 [00:07<00:27, 280.49it/s] 20%|██████████▎                                         | 1942/9736 [00:07<00:27, 281.80it/s] 20%|██████████▌                                         | 1971/9736 [00:07<00:27, 282.81it/s] 21%|██████████▋                                         | 2000/9736 [00:07<00:27, 283.64it/s] 21%|██████████▊                                         | 2029/9736 [00:07<00:27, 282.06it/s] 21%|██████████▉                                         | 2058/9736 [00:07<00:27, 282.74it/s] 21%|███████████▏                                        | 2087/9736 [00:07<00:27, 283.04it/s] 22%|███████████▎                                        | 2116/9736 [00:07<00:27, 281.48it/s] 22%|███████████▍                                        | 2145/9736 [00:07<00:26, 282.35it/s] 22%|███████████▌                                        | 2174/9736 [00:08<00:26, 283.30it/s] 23%|███████████▊                                        | 2203/9736 [00:08<00:26, 283.74it/s] 23%|███████████▉                                        | 2232/9736 [00:08<00:26, 284.22it/s] 23%|████████████                                        | 2261/9736 [00:08<00:26, 282.57it/s] 24%|████████████▏                                       | 2290/9736 [00:08<00:26, 283.28it/s] 24%|████████████▍                                       | 2319/9736 [00:08<00:26, 283.69it/s] 24%|████████████▌                                       | 2348/9736 [00:08<00:25, 284.24it/s] 24%|████████████▋                                       | 2377/9736 [00:08<00:25, 284.67it/s] 25%|████████████▊                                       | 2406/9736 [00:08<00:25, 284.97it/s] 25%|█████████████                                       | 2435/9736 [00:08<00:25, 284.92it/s] 25%|█████████████▏                                      | 2464/9736 [00:09<00:25, 285.00it/s] 26%|█████████████▎                                      | 2493/9736 [00:09<00:25, 280.43it/s] 26%|█████████████▍                                      | 2522/9736 [00:09<00:25, 281.62it/s] 26%|█████████████▌                                      | 2551/9736 [00:09<00:25, 282.36it/s] 26%|█████████████▊                                      | 2580/9736 [00:09<00:25, 283.28it/s] 27%|█████████████▉                                      | 2609/9736 [00:09<00:25, 283.84it/s] 27%|██████████████                                      | 2638/9736 [00:09<00:25, 283.84it/s] 27%|██████████████▏                                     | 2667/9736 [00:09<00:24, 284.17it/s] 28%|██████████████▍                                     | 2696/9736 [00:09<00:24, 283.97it/s] 28%|██████████████▌                                     | 2725/9736 [00:10<00:24, 281.91it/s] 28%|██████████████▋                                     | 2754/9736 [00:10<00:24, 282.77it/s] 29%|██████████████▊                                     | 2783/9736 [00:10<00:24, 283.07it/s] 29%|███████████████                                     | 2812/9736 [00:10<00:24, 283.33it/s] 29%|███████████████▏                                    | 2841/9736 [00:10<00:24, 283.87it/s] 29%|███████████████▎                                    | 2870/9736 [00:10<00:24, 284.13it/s] 30%|███████████████▍                                    | 2899/9736 [00:10<00:24, 284.13it/s] 30%|███████████████▋                                    | 2928/9736 [00:10<00:24, 282.54it/s] 30%|███████████████▊                                    | 2957/9736 [00:10<00:23, 282.91it/s] 31%|███████████████▉                                    | 2986/9736 [00:10<00:23, 283.43it/s] 31%|████████████████                                    | 3015/9736 [00:11<00:23, 283.46it/s] 31%|████████████████▎                                   | 3044/9736 [00:11<00:23, 283.75it/s] 32%|████████████████▍                                   | 3073/9736 [00:11<00:23, 283.87it/s] 32%|████████████████▌                                   | 3102/9736 [00:11<00:23, 284.07it/s] 32%|████████████████▋                                   | 3131/9736 [00:11<00:23, 284.06it/s] 32%|████████████████▉                                   | 3160/9736 [00:11<00:23, 282.21it/s] 33%|█████████████████                                   | 3189/9736 [00:11<00:23, 283.05it/s] 33%|█████████████████▏                                  | 3218/9736 [00:11<00:23, 283.31it/s] 33%|█████████████████▎                                  | 3247/9736 [00:11<00:22, 283.74it/s] 34%|█████████████████▍                                  | 3276/9736 [00:11<00:22, 283.79it/s] 34%|█████████████████▋                                  | 3305/9736 [00:12<00:22, 283.86it/s] 34%|█████████████████▊                                  | 3334/9736 [00:12<00:22, 283.78it/s] 35%|█████████████████▉                                  | 3363/9736 [00:12<00:22, 283.77it/s] 35%|██████████████████                                  | 3392/9736 [00:12<00:22, 281.85it/s] 35%|██████████████████▎                                 | 3421/9736 [00:12<00:22, 282.68it/s] 35%|██████████████████▍                                 | 3450/9736 [00:12<00:22, 282.95it/s] 36%|██████████████████▌                                 | 3479/9736 [00:12<00:22, 283.13it/s] 36%|██████████████████▋                                 | 3508/9736 [00:12<00:21, 283.10it/s] 36%|██████████████████▉                                 | 3537/9736 [00:12<00:21, 283.48it/s] 37%|███████████████████                                 | 3566/9736 [00:12<00:21, 283.60it/s] 37%|███████████████████▏                                | 3595/9736 [00:13<00:21, 281.21it/s] 37%|███████████████████▎                                | 3624/9736 [00:13<00:21, 280.29it/s] 38%|███████████████████▌                                | 3653/9736 [00:13<00:21, 281.52it/s] 38%|███████████████████▋                                | 3682/9736 [00:13<00:21, 282.32it/s] 38%|███████████████████▊                                | 3711/9736 [00:13<00:21, 282.89it/s] 38%|███████████████████▉                                | 3740/9736 [00:13<00:21, 283.38it/s] 39%|████████████████████▏                               | 3769/9736 [00:13<00:21, 283.70it/s] 39%|████████████████████▎                               | 3798/9736 [00:13<00:20, 283.96it/s] 39%|████████████████████▍                               | 3827/9736 [00:13<00:20, 284.17it/s] 40%|████████████████████▌                               | 3856/9736 [00:14<00:20, 282.25it/s] 40%|████████████████████▋                               | 3885/9736 [00:14<00:20, 282.89it/s] 40%|████████████████████▉                               | 3914/9736 [00:14<00:20, 283.34it/s] 40%|█████████████████████                               | 3943/9736 [00:14<00:20, 283.55it/s] 41%|█████████████████████▏                              | 3972/9736 [00:14<00:20, 281.18it/s] 41%|█████████████████████▎                              | 4001/9736 [00:14<00:20, 282.21it/s] 41%|█████████████████████▌                              | 4030/9736 [00:14<00:20, 282.76it/s] 42%|█████████████████████▋                              | 4059/9736 [00:14<00:20, 283.37it/s] 42%|█████████████████████▊                              | 4088/9736 [00:14<00:20, 281.97it/s] 42%|█████████████████████▉                              | 4117/9736 [00:14<00:19, 282.55it/s] 43%|██████████████████████▏                             | 4146/9736 [00:15<00:19, 282.75it/s] 43%|██████████████████████▎                             | 4175/9736 [00:15<00:19, 283.24it/s] 43%|██████████████████████▍                             | 4204/9736 [00:15<00:19, 283.47it/s] 43%|██████████████████████▌                             | 4233/9736 [00:15<00:19, 283.69it/s] 44%|██████████████████████▊                             | 4262/9736 [00:15<00:19, 284.06it/s] 44%|██████████████████████▉                             | 4291/9736 [00:15<00:19, 282.64it/s] 44%|███████████████████████                             | 4320/9736 [00:15<00:19, 280.79it/s] 45%|███████████████████████▏                            | 4349/9736 [00:15<00:19, 281.74it/s] 45%|███████████████████████▍                            | 4378/9736 [00:15<00:18, 282.47it/s] 45%|███████████████████████▌                            | 4407/9736 [00:15<00:18, 282.81it/s] 46%|███████████████████████▋                            | 4436/9736 [00:16<00:18, 283.03it/s] 46%|███████████████████████▊                            | 4465/9736 [00:16<00:18, 283.43it/s] 46%|████████████████████████                            | 4494/9736 [00:16<00:18, 283.77it/s] 46%|████████████████████████▏                           | 4523/9736 [00:16<00:21, 248.12it/s] 47%|████████████████████████▎                           | 4552/9736 [00:16<00:20, 258.07it/s] 47%|████████████████████████▍                           | 4581/9736 [00:16<00:19, 265.31it/s] 47%|████████████████████████▌                           | 4610/9736 [00:16<00:18, 270.85it/s] 48%|████████████████████████▊                           | 4639/9736 [00:16<00:18, 274.65it/s] 48%|████████████████████████▉                           | 4668/9736 [00:16<00:18, 277.36it/s] 48%|█████████████████████████                           | 4696/9736 [00:17<00:18, 277.09it/s] 49%|█████████████████████████▏                          | 4725/9736 [00:17<00:17, 278.46it/s] 49%|█████████████████████████▍                          | 4753/9736 [00:17<00:26, 186.15it/s] 49%|█████████████████████████▌                          | 4782/9736 [00:17<00:23, 207.87it/s] 49%|█████████████████████████▋                          | 4811/9736 [00:17<00:21, 226.24it/s] 50%|█████████████████████████▊                          | 4840/9736 [00:17<00:20, 241.03it/s] 50%|██████████████████████████                          | 4869/9736 [00:17<00:19, 252.35it/s] 50%|██████████████████████████▏                         | 4898/9736 [00:17<00:18, 261.18it/s] 51%|██████████████████████████▎                         | 4927/9736 [00:18<00:17, 267.64it/s] 51%|██████████████████████████▍                         | 4955/9736 [00:18<00:17, 270.98it/s] 51%|██████████████████████████▌                         | 4984/9736 [00:18<00:17, 275.01it/s] 51%|██████████████████████████▊                         | 5013/9736 [00:18<00:16, 277.86it/s] 52%|██████████████████████████▉                         | 5042/9736 [00:18<00:16, 280.34it/s] 52%|███████████████████████████                         | 5071/9736 [00:18<00:16, 282.02it/s] 52%|███████████████████████████▏                        | 5100/9736 [00:18<00:16, 283.08it/s] 53%|███████████████████████████▍                        | 5129/9736 [00:18<00:16, 282.48it/s] 53%|███████████████████████████▌                        | 5158/9736 [00:18<00:16, 283.65it/s] 53%|███████████████████████████▋                        | 5187/9736 [00:18<00:16, 282.39it/s] 54%|███████████████████████████▊                        | 5216/9736 [00:19<00:15, 283.33it/s] 54%|████████████████████████████                        | 5245/9736 [00:19<00:15, 283.78it/s] 54%|████████████████████████████▏                       | 5274/9736 [00:19<00:15, 284.35it/s] 54%|████████████████████████████▎                       | 5303/9736 [00:19<00:15, 284.97it/s] 55%|████████████████████████████▍                       | 5332/9736 [00:19<00:15, 284.88it/s] 55%|████████████████████████████▋                       | 5361/9736 [00:19<00:15, 285.22it/s] 55%|████████████████████████████▊                       | 5390/9736 [00:19<00:15, 285.29it/s] 56%|████████████████████████████▉                       | 5419/9736 [00:19<00:15, 283.47it/s] 56%|█████████████████████████████                       | 5448/9736 [00:19<00:15, 284.36it/s] 56%|█████████████████████████████▎                      | 5477/9736 [00:19<00:14, 285.17it/s] 57%|█████████████████████████████▍                      | 5507/9736 [00:20<00:14, 287.65it/s] 57%|█████████████████████████████▌                      | 5537/9736 [00:20<00:14, 289.45it/s] 57%|█████████████████████████████▋                      | 5567/9736 [00:20<00:14, 290.81it/s] 57%|█████████████████████████████▉                      | 5597/9736 [00:20<00:14, 291.40it/s] 58%|██████████████████████████████                      | 5627/9736 [00:20<00:14, 290.59it/s] 58%|██████████████████████████████▏                     | 5657/9736 [00:20<00:13, 291.60it/s] 58%|██████████████████████████████▎                     | 5687/9736 [00:20<00:13, 292.13it/s] 59%|██████████████████████████████▌                     | 5717/9736 [00:20<00:13, 292.17it/s] 59%|██████████████████████████████▋                     | 5747/9736 [00:20<00:13, 292.64it/s] 59%|██████████████████████████████▊                     | 5777/9736 [00:20<00:13, 293.05it/s] 60%|███████████████████████████████                     | 5807/9736 [00:21<00:13, 292.83it/s] 60%|███████████████████████████████▏                    | 5837/9736 [00:21<00:13, 292.78it/s] 60%|███████████████████████████████▎                    | 5867/9736 [00:21<00:13, 291.37it/s] 61%|███████████████████████████████▍                    | 5897/9736 [00:21<00:13, 292.05it/s] 61%|███████████████████████████████▋                    | 5927/9736 [00:21<00:13, 292.42it/s] 61%|███████████████████████████████▊                    | 5957/9736 [00:21<00:12, 292.93it/s] 61%|███████████████████████████████▉                    | 5987/9736 [00:21<00:12, 293.36it/s] 62%|████████████████████████████████▏                   | 6017/9736 [00:21<00:12, 293.48it/s] 62%|████████████████████████████████▎                   | 6047/9736 [00:21<00:12, 293.50it/s] 62%|████████████████████████████████▍                   | 6077/9736 [00:21<00:12, 293.43it/s] 63%|████████████████████████████████▌                   | 6107/9736 [00:22<00:12, 291.88it/s] 63%|████████████████████████████████▊                   | 6137/9736 [00:22<00:12, 292.14it/s] 63%|████████████████████████████████▉                   | 6167/9736 [00:22<00:12, 292.48it/s] 64%|█████████████████████████████████                   | 6197/9736 [00:22<00:12, 292.79it/s] 64%|█████████████████████████████████▎                  | 6227/9736 [00:22<00:11, 292.48it/s] 64%|█████████████████████████████████▍                  | 6257/9736 [00:22<00:11, 292.27it/s] 65%|█████████████████████████████████▌                  | 6287/9736 [00:22<00:11, 292.74it/s] 65%|█████████████████████████████████▋                  | 6317/9736 [00:22<00:11, 291.21it/s] 65%|█████████████████████████████████▉                  | 6347/9736 [00:22<00:11, 291.70it/s] 65%|██████████████████████████████████                  | 6377/9736 [00:23<00:11, 292.22it/s] 66%|██████████████████████████████████▏                 | 6407/9736 [00:23<00:11, 292.33it/s] 66%|██████████████████████████████████▍                 | 6437/9736 [00:23<00:11, 292.59it/s] 66%|██████████████████████████████████▌                 | 6467/9736 [00:23<00:11, 292.50it/s] 67%|██████████████████████████████████▋                 | 6497/9736 [00:23<00:11, 292.82it/s] 67%|██████████████████████████████████▊                 | 6527/9736 [00:23<00:10, 292.76it/s] 67%|███████████████████████████████████                 | 6557/9736 [00:23<00:10, 291.32it/s] 68%|███████████████████████████████████▏                | 6587/9736 [00:23<00:10, 291.46it/s] 68%|███████████████████████████████████▎                | 6617/9736 [00:23<00:10, 292.03it/s] 68%|███████████████████████████████████▌                | 6647/9736 [00:23<00:10, 292.63it/s] 69%|███████████████████████████████████▋                | 6677/9736 [00:24<00:10, 292.60it/s] 69%|███████████████████████████████████▊                | 6707/9736 [00:24<00:10, 292.57it/s] 69%|███████████████████████████████████▉                | 6737/9736 [00:24<00:10, 293.01it/s] 70%|████████████████████████████████████▏               | 6767/9736 [00:24<00:10, 291.82it/s] 70%|████████████████████████████████████▎               | 6797/9736 [00:24<00:10, 292.37it/s] 70%|████████████████████████████████████▍               | 6827/9736 [00:24<00:09, 292.88it/s] 70%|████████████████████████████████████▌               | 6857/9736 [00:24<00:09, 293.07it/s] 71%|████████████████████████████████████▊               | 6887/9736 [00:24<00:09, 293.41it/s] 71%|████████████████████████████████████▉               | 6917/9736 [00:24<00:09, 293.38it/s] 71%|█████████████████████████████████████               | 6947/9736 [00:24<00:09, 293.33it/s] 72%|█████████████████████████████████████▎              | 6977/9736 [00:25<00:09, 293.28it/s] 72%|█████████████████████████████████████▍              | 7007/9736 [00:25<00:09, 291.21it/s] 72%|█████████████████████████████████████▌              | 7037/9736 [00:25<00:09, 291.97it/s] 73%|█████████████████████████████████████▋              | 7067/9736 [00:25<00:09, 292.66it/s] 73%|█████████████████████████████████████▉              | 7097/9736 [00:25<00:09, 292.57it/s] 73%|██████████████████████████████████████              | 7127/9736 [00:25<00:08, 292.68it/s] 74%|██████████████████████████████████████▏             | 7157/9736 [00:25<00:08, 292.97it/s] 74%|██████████████████████████████████████▍             | 7187/9736 [00:25<00:08, 293.03it/s] 74%|██████████████████████████████████████▌             | 7217/9736 [00:25<00:08, 291.18it/s] 74%|██████████████████████████████████████▋             | 7247/9736 [00:26<00:08, 291.79it/s] 75%|██████████████████████████████████████▊             | 7277/9736 [00:26<00:08, 292.21it/s] 75%|███████████████████████████████████████             | 7307/9736 [00:26<00:08, 292.50it/s] 75%|███████████████████████████████████████▏            | 7337/9736 [00:26<00:08, 292.50it/s] 76%|███████████████████████████████████████▎            | 7367/9736 [00:26<00:08, 292.82it/s] 76%|███████████████████████████████████████▌            | 7397/9736 [00:26<00:07, 292.91it/s] 76%|███████████████████████████████████████▋            | 7427/9736 [00:26<00:07, 292.91it/s] 77%|███████████████████████████████████████▊            | 7457/9736 [00:26<00:08, 271.28it/s] 77%|███████████████████████████████████████▉            | 7487/9736 [00:26<00:08, 277.47it/s] 77%|████████████████████████████████████████▏           | 7517/9736 [00:26<00:07, 281.98it/s] 78%|████████████████████████████████████████▎           | 7547/9736 [00:27<00:07, 285.15it/s] 78%|████████████████████████████████████████▍           | 7576/9736 [00:27<00:07, 286.38it/s] 78%|████████████████████████████████████████▌           | 7606/9736 [00:27<00:07, 288.36it/s] 78%|████████████████████████████████████████▊           | 7636/9736 [00:27<00:07, 289.81it/s] 79%|████████████████████████████████████████▉           | 7666/9736 [00:27<00:07, 290.73it/s] 79%|█████████████████████████████████████████           | 7696/9736 [00:27<00:07, 289.77it/s] 79%|█████████████████████████████████████████▎          | 7726/9736 [00:27<00:06, 291.30it/s] 80%|█████████████████████████████████████████▍          | 7756/9736 [00:27<00:06, 291.97it/s] 80%|█████████████████████████████████████████▌          | 7786/9736 [00:27<00:06, 292.18it/s] 80%|█████████████████████████████████████████▋          | 7816/9736 [00:27<00:06, 292.36it/s] 81%|█████████████████████████████████████████▉          | 7846/9736 [00:28<00:06, 292.40it/s] 81%|██████████████████████████████████████████          | 7876/9736 [00:28<00:06, 292.45it/s] 81%|██████████████████████████████████████████▏         | 7906/9736 [00:28<00:06, 291.08it/s] 82%|██████████████████████████████████████████▍         | 7936/9736 [00:28<00:06, 291.79it/s] 82%|██████████████████████████████████████████▌         | 7966/9736 [00:28<00:06, 292.40it/s] 82%|██████████████████████████████████████████▋         | 7996/9736 [00:28<00:05, 292.87it/s] 82%|██████████████████████████████████████████▊         | 8026/9736 [00:28<00:05, 293.32it/s] 83%|███████████████████████████████████████████         | 8056/9736 [00:28<00:05, 293.51it/s] 83%|███████████████████████████████████████████▏        | 8086/9736 [00:28<00:05, 293.45it/s] 83%|███████████████████████████████████████████▎        | 8116/9736 [00:28<00:05, 294.15it/s] 84%|███████████████████████████████████████████▌        | 8146/9736 [00:29<00:05, 292.55it/s] 84%|███████████████████████████████████████████▋        | 8176/9736 [00:29<00:05, 292.45it/s] 84%|███████████████████████████████████████████▊        | 8206/9736 [00:29<00:05, 293.27it/s] 85%|███████████████████████████████████████████▉        | 8236/9736 [00:29<00:05, 293.88it/s] 85%|████████████████████████████████████████████▏       | 8266/9736 [00:29<00:05, 293.97it/s] 85%|████████████████████████████████████████████▎       | 8296/9736 [00:29<00:04, 293.89it/s] 86%|████████████████████████████████████████████▍       | 8326/9736 [00:29<00:04, 294.12it/s] 86%|████████████████████████████████████████████▋       | 8356/9736 [00:29<00:04, 292.59it/s] 86%|████████████████████████████████████████████▊       | 8386/9736 [00:29<00:04, 293.43it/s] 86%|████████████████████████████████████████████▉       | 8416/9736 [00:30<00:04, 293.98it/s] 87%|█████████████████████████████████████████████       | 8446/9736 [00:30<00:04, 294.30it/s] 87%|█████████████████████████████████████████████▎      | 8476/9736 [00:30<00:04, 294.50it/s] 87%|█████████████████████████████████████████████▍      | 8506/9736 [00:30<00:04, 294.85it/s] 88%|█████████████████████████████████████████████▌      | 8536/9736 [00:30<00:04, 294.32it/s] 88%|█████████████████████████████████████████████▊      | 8566/9736 [00:30<00:03, 293.30it/s] 88%|█████████████████████████████████████████████▉      | 8596/9736 [00:30<00:03, 291.88it/s] 89%|██████████████████████████████████████████████      | 8626/9736 [00:30<00:03, 292.67it/s] 89%|██████████████████████████████████████████████▏     | 8656/9736 [00:30<00:03, 293.29it/s] 89%|██████████████████████████████████████████████▍     | 8686/9736 [00:30<00:03, 293.83it/s] 90%|██████████████████████████████████████████████▌     | 8716/9736 [00:31<00:03, 294.20it/s] 90%|██████████████████████████████████████████████▋     | 8746/9736 [00:31<00:03, 294.10it/s] 90%|██████████████████████████████████████████████▊     | 8776/9736 [00:31<00:03, 293.33it/s] 90%|███████████████████████████████████████████████     | 8806/9736 [00:31<00:03, 291.79it/s] 91%|███████████████████████████████████████████████▏    | 8836/9736 [00:31<00:03, 292.49it/s] 91%|███████████████████████████████████████████████▎    | 8866/9736 [00:31<00:02, 293.15it/s] 91%|███████████████████████████████████████████████▌    | 8896/9736 [00:31<00:02, 293.68it/s] 92%|███████████████████████████████████████████████▋    | 8926/9736 [00:31<00:02, 294.29it/s] 92%|███████████████████████████████████████████████▊    | 8956/9736 [00:31<00:02, 294.17it/s] 92%|███████████████████████████████████████████████▉    | 8986/9736 [00:31<00:02, 294.12it/s] 93%|████████████████████████████████████████████████▏   | 9016/9736 [00:32<00:02, 294.08it/s] 93%|████████████████████████████████████████████████▎   | 9046/9736 [00:32<00:02, 292.40it/s] 93%|████████████████████████████████████████████████▍   | 9076/9736 [00:32<00:02, 290.55it/s] 94%|████████████████████████████████████████████████▋   | 9106/9736 [00:32<00:02, 291.59it/s] 94%|████████████████████████████████████████████████▊   | 9136/9736 [00:32<00:02, 292.64it/s] 94%|████████████████████████████████████████████████▉   | 9166/9736 [00:32<00:01, 293.28it/s] 94%|█████████████████████████████████████████████████   | 9196/9736 [00:32<00:01, 293.39it/s] 95%|█████████████████████████████████████████████████▎  | 9226/9736 [00:32<00:01, 292.79it/s] 95%|█████████████████████████████████████████████████▍  | 9256/9736 [00:32<00:01, 293.24it/s] 95%|█████████████████████████████████████████████████▌  | 9286/9736 [00:32<00:01, 291.79it/s] 96%|█████████████████████████████████████████████████▊  | 9316/9736 [00:33<00:01, 292.79it/s] 96%|█████████████████████████████████████████████████▉  | 9346/9736 [00:33<00:01, 292.97it/s] 96%|██████████████████████████████████████████████████  | 9376/9736 [00:33<00:01, 293.67it/s] 97%|██████████████████████████████████████████████████▏ | 9406/9736 [00:33<00:01, 293.66it/s] 97%|██████████████████████████████████████████████████▍ | 9436/9736 [00:33<00:01, 293.85it/s] 97%|██████████████████████████████████████████████████▌ | 9466/9736 [00:33<00:00, 293.95it/s] 98%|██████████████████████████████████████████████████▋ | 9496/9736 [00:33<00:00, 292.07it/s] 98%|██████████████████████████████████████████████████▉ | 9526/9736 [00:33<00:00, 292.95it/s] 98%|███████████████████████████████████████████████████ | 9556/9736 [00:33<00:00, 293.52it/s] 98%|███████████████████████████████████████████████████▏| 9586/9736 [00:34<00:00, 291.02it/s] 99%|███████████████████████████████████████████████████▎| 9616/9736 [00:34<00:00, 291.69it/s] 99%|███████████████████████████████████████████████████▌| 9646/9736 [00:34<00:00, 291.98it/s] 99%|███████████████████████████████████████████████████▋| 9676/9736 [00:34<00:00, 292.71it/s]100%|███████████████████████████████████████████████████▊| 9706/9736 [00:34<00:00, 293.07it/s]100%|████████████████████████████████████████████████████| 9736/9736 [00:34<00:00, 290.56it/s]100%|████████████████████████████████████████████████████| 9736/9736 [00:34<00:00, 281.99it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.30s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:04<00:09,  4.96s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.14s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.17s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.18s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.03s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.15s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.06s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.57s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.75s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.42s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.60s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.52s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.67s/it]
[2023-08-21 15:09:44,955] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.44s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.61s/it]
[2023-08-21 15:09:52,115] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-21 15:09:52,116] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-21 15:09:52,117] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-21 15:09:52,117] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-21 15:09:52,117] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-21 15:09:52,117] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-21 15:09:52,117] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-21 15:09:52,117] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-21 15:09:52,117] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-21 15:09:52,117] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-21 15:09:52,117] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-21 15:09:52,117] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fb78b754f40>
[2023-08-21 15:09:52,117] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-21 15:09:52,117] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-21 15:09:52,117] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-21 15:09:52,117] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-21 15:09:52,117] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-21 15:09:52,117] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-21 15:09:52,117] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-21 15:09:52,117] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-21 15:09:52,117] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-21 15:09:52,117] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-21 15:09:52,117] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7fb75c9dbdc0>
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-21 15:09:52,119] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-21 15:09:52,119] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-21 15:09:52,119] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-21 15:09:52,119] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-21 15:09:52,119] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-21 15:09:52,119] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-21 15:09:52,119] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-21 15:09:52,119] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.5663115978240967 seconds
Loading extension module utils...
Time to load utils op: 0.5046308040618896 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Loading extension module utils...
Time to load utils op: 0.5046541690826416 seconds
Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: 1. To be "of use when thirsty," the plumbing in question would need to convey water.
2. Starting from the answer choices given:
    A: Oil refineries: The primary function of an oil refinery is to process and refine crude oil. Any plumbing found in an oil refinery would therefore be used to transport oil, not water.
    B: Wall: While walls can contain plumbing, this plumbing could provide water, especially if it serves sinks, showers or other water-based utilities within a building.
    C: Show: This choice is vague, but if it refers to a show or performance, any plumbing might be for special effects or backstage utilities - which could still potentially provide water.
    D: Own home: The plumbing in your own home would certainly be useful if you were thirsty, as it provides taps, showers, and other water sources.
    E: Water fountain: A water fountain might be the most obvious source of drinakble water and would certainly be useful if you were thirsty.
3. Therefore, by process of elimination, you would only find plumbing that would not be "of use to you if you are thirsty" in an oil refinery, making `A: oil refineries` the correct answer.
So the final answer is A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Output: 1. The question is asking for the activity that a person is not immediately doing when they are beginning to work. 
2. To determine the correct response, we need to compare each option, while considering the immediate meaning of "beginning work".
3. In terms of immediate actions, "beginning to work" could also imply "working" (Option A), so it cannot be the correct answer.
4. Similarly, "momentum" (Option E) is a phenomenon that can start as soon as one begins to work, so it is also not the answer.
5. "Resting" (Option B) is an action contrary to working so it doesn't fit the context. They are not resting but working.
6. Option C: "Tiredness", associated with extensive effort or work, doesn't fit either. It's unlikely for a person to feel tired at the beginning.
7. The remaining option is "Accomplishing" (Option D). When a person is just beginning to work, they haven't had time to accomplish their tasks or goals yet. Hence, this must be the correct answer. 
8. So, the right answer is D: accomplishing.
So the final answer is D: accomplishing

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Output: 1. The question is asking for a place (location) where one may find pens containing a company logo. 
2. Look at each of the choices and consider whether it is a viable location for finding such pens.
3. Choice B: on a pencil - This is unlikely as pencils and pens are different types of writing instruments. They would not usually be found together as part of the same item.
4. Choice C: write sentences on paper - This is not a place or location, rather it's an activity involving using a pen or pencil.
5. Choice D: school - Though it is a location, it's less common to find pens with company logos in a school setting. Usually, pens in schools are for students who likely wouldn't have pens with company logos.
6. Choice E: backpack - It is a viable place to find pens but doesn't specify the type of pen like those with a company logo.
7. Choice A: office - This is the most likely place as promotional pens are often dispersed in such professional environments. Company logo pens are commonly used in offices as part of a company's stationery.
8. Hence, the answer is A: office, as it's the most probable location to find pens that have a company's logo.
So the final answer is A: office

Input: Billy called out to John, and listened for what? Choices:  A: silence B: response C: communication D: hanging up E: whisper
Output: 1. The question is about what Billy expected after he called out to John. 
2. When someone calls out to another person, it generally means they want to get their attention or want to communicate something to them. 
3. After calling out, the normal expectation is that the other person will acknowledge or respond in some way. 
4. The option 'A: silence' does not fit because it is the opposite of what should normally happen if Billy is calling out to John.
5. The option 'C: communication' might seem plausible but in the provided options, there is a more appropriate answer.
6. 'D: hanging up' and 'E: whisper' are not a probable outcome from calling out, unless mentioned beforehand.
7. Therefore, the most logical choice, considering the normally expected outcome of calling out to someone, is 'B: response'.
So the final answer is B: response

Input: The lizard frightened the hiker, it's movements made what rustle? Choices:  A: garden B: trees C: books D: rocks E: bushes
Output: 1. The question tells us that the "lizard frightened the hiker".
2. Following this, it specifies that the lizard caused a rustle movement.
3. We need to find out where this rustling movement happened - a place associated with both lizard's habitat and a hiker’s path.
4. Looking at the choices, we can eliminate 'garden' and 'books' as a lizard would not frequently be found rustling around in a garden or within books, especially in a context involving a hiker.
5. We can also eliminate 'rocks' as rocks can't rustle.
6. Out of 'trees' and 'bushes', a lizard is more likely to cause rustling in bushes than in trees as lizards are more commonly found on or near the ground.
7. Thus, the correct answer is E: bushes.
So the final answer is E: bushes

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i5-s1-rTrue
Loading extension module utils...
Time to load utils op: 0.6042706966400146 seconds
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:41<34:06, 41.76s/it]Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:46<38:07, 46.68s/it]
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 3272684 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 3272685 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 3272686 closing signal SIGTERM
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 3272683) of binary: /home/ylu130/.conda/envs/distllm/bin/python
Traceback (most recent call last):
  File "/home/ylu130/.conda/envs/distllm/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 345, in wrapper
    return f(*args, **kwargs)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 761, in main
    run(args)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 752, in run
    elastic_launch(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 131, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 245, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
/home/ylu130/workspace/in-context-generalization/inference.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2023-08-21_15:10:41
  host      : ia1.wse.jhu.edu
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 3272683)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i6-s1-rTrue --seed 1 --max-prompt-length 2048 --rationales --num-in-domain 6
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-21 15:10:45,540] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i6-s1-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 6
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i6-s1-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9735 [00:00<?, ?it/s]  0%|                                                      | 17/9735 [00:00<00:58, 166.54it/s]  0%|▏                                                     | 34/9735 [00:00<01:02, 155.58it/s]  1%|▎                                                     | 52/9735 [00:00<00:59, 163.86it/s]  1%|▍                                                     | 70/9735 [00:00<00:57, 167.81it/s]  1%|▍                                                     | 88/9735 [00:00<00:56, 170.12it/s]  1%|▌                                                    | 106/9735 [00:00<00:56, 171.70it/s]  1%|▋                                                    | 124/9735 [00:00<00:55, 172.43it/s]  1%|▊                                                    | 142/9735 [00:00<00:55, 173.07it/s]  2%|▊                                                    | 160/9735 [00:00<00:55, 173.61it/s]  2%|▉                                                    | 178/9735 [00:01<00:55, 173.74it/s]  2%|█                                                    | 196/9735 [00:01<00:56, 169.66it/s]  2%|█▏                                                   | 221/9735 [00:01<00:49, 191.96it/s]  3%|█▎                                                   | 248/9735 [00:01<00:44, 213.83it/s]  3%|█▍                                                   | 275/9735 [00:01<00:41, 229.48it/s]  3%|█▋                                                   | 302/9735 [00:01<00:39, 240.56it/s]  3%|█▊                                                   | 329/9735 [00:01<00:37, 248.43it/s]  4%|█▉                                                   | 356/9735 [00:01<00:36, 253.83it/s]  4%|██                                                   | 383/9735 [00:01<00:36, 257.64it/s]  4%|██▏                                                  | 410/9735 [00:01<00:35, 260.57it/s]  4%|██▍                                                  | 437/9735 [00:02<00:35, 260.97it/s]  5%|██▌                                                  | 464/9735 [00:02<00:35, 263.37it/s]  5%|██▋                                                  | 491/9735 [00:02<00:34, 264.55it/s]  5%|██▊                                                  | 518/9735 [00:02<00:34, 265.63it/s]  6%|██▉                                                  | 545/9735 [00:02<00:34, 266.42it/s]  6%|███                                                  | 572/9735 [00:02<00:34, 266.66it/s]  6%|███▎                                                 | 599/9735 [00:02<00:34, 266.86it/s]  6%|███▍                                                 | 626/9735 [00:02<00:34, 267.02it/s]  7%|███▌                                                 | 653/9735 [00:02<00:33, 267.43it/s]  7%|███▋                                                 | 680/9735 [00:02<00:34, 265.71it/s]  7%|███▊                                                 | 707/9735 [00:03<00:33, 266.25it/s]  8%|███▉                                                 | 734/9735 [00:03<00:33, 266.52it/s]  8%|████▏                                                | 761/9735 [00:03<00:33, 267.33it/s]  8%|████▎                                                | 788/9735 [00:03<00:33, 267.64it/s]  8%|████▍                                                | 815/9735 [00:03<00:33, 267.80it/s]  9%|████▌                                                | 842/9735 [00:03<00:33, 267.71it/s]  9%|████▋                                                | 869/9735 [00:03<00:33, 267.72it/s]  9%|████▉                                                | 896/9735 [00:03<00:33, 263.97it/s]  9%|█████                                                | 923/9735 [00:03<00:33, 264.42it/s] 10%|█████▏                                               | 950/9735 [00:03<00:33, 265.25it/s] 10%|█████▎                                               | 977/9735 [00:04<00:32, 265.87it/s] 10%|█████▎                                              | 1004/9735 [00:04<00:32, 266.25it/s] 11%|█████▌                                              | 1031/9735 [00:04<00:32, 266.74it/s] 11%|█████▋                                              | 1058/9735 [00:04<00:32, 264.71it/s] 11%|█████▊                                              | 1085/9735 [00:04<00:32, 265.45it/s] 11%|█████▉                                              | 1112/9735 [00:04<00:32, 262.53it/s] 12%|██████                                              | 1139/9735 [00:04<00:32, 263.41it/s] 12%|██████▏                                             | 1166/9735 [00:04<00:32, 264.46it/s] 12%|██████▎                                             | 1193/9735 [00:04<00:32, 265.20it/s] 13%|██████▌                                             | 1220/9735 [00:05<00:32, 265.66it/s] 13%|██████▋                                             | 1247/9735 [00:05<00:32, 264.60it/s] 13%|██████▊                                             | 1274/9735 [00:05<00:31, 265.23it/s] 13%|██████▉                                             | 1301/9735 [00:05<00:31, 265.81it/s] 14%|███████                                             | 1328/9735 [00:05<00:31, 266.00it/s] 14%|███████▏                                            | 1355/9735 [00:05<00:31, 264.08it/s] 14%|███████▍                                            | 1382/9735 [00:05<00:31, 264.67it/s] 14%|███████▌                                            | 1409/9735 [00:05<00:31, 265.35it/s] 15%|███████▋                                            | 1436/9735 [00:05<00:31, 265.74it/s] 15%|███████▊                                            | 1463/9735 [00:05<00:31, 265.27it/s] 15%|███████▉                                            | 1490/9735 [00:06<00:31, 265.63it/s] 16%|████████                                            | 1517/9735 [00:06<00:30, 265.77it/s] 16%|████████▏                                           | 1544/9735 [00:06<00:30, 266.05it/s] 16%|████████▍                                           | 1571/9735 [00:06<00:30, 264.36it/s] 16%|████████▌                                           | 1598/9735 [00:06<00:30, 265.02it/s] 17%|████████▋                                           | 1625/9735 [00:06<00:30, 265.75it/s] 17%|████████▊                                           | 1652/9735 [00:06<00:30, 266.30it/s] 17%|████████▉                                           | 1679/9735 [00:06<00:30, 266.08it/s] 18%|█████████                                           | 1706/9735 [00:06<00:30, 266.38it/s] 18%|█████████▎                                          | 1733/9735 [00:06<00:30, 266.66it/s] 18%|█████████▍                                          | 1760/9735 [00:07<00:29, 266.90it/s] 18%|█████████▌                                          | 1787/9735 [00:07<00:29, 266.87it/s] 19%|█████████▋                                          | 1814/9735 [00:07<00:32, 243.06it/s] 19%|█████████▊                                          | 1841/9735 [00:07<00:31, 249.52it/s] 19%|█████████▉                                          | 1868/9735 [00:07<00:30, 254.33it/s] 19%|██████████                                          | 1894/9735 [00:07<00:30, 255.85it/s] 20%|██████████▎                                         | 1921/9735 [00:07<00:30, 258.93it/s] 20%|██████████▍                                         | 1948/9735 [00:07<00:29, 261.11it/s] 20%|██████████▌                                         | 1975/9735 [00:07<00:29, 262.69it/s] 21%|██████████▋                                         | 2002/9735 [00:07<00:29, 263.92it/s] 21%|██████████▊                                         | 2029/9735 [00:08<00:29, 261.78it/s] 21%|██████████▉                                         | 2056/9735 [00:08<00:29, 263.06it/s] 21%|███████████▏                                        | 2083/9735 [00:08<00:28, 263.90it/s] 22%|███████████▎                                        | 2110/9735 [00:08<00:28, 264.63it/s] 22%|███████████▍                                        | 2137/9735 [00:08<00:28, 262.84it/s] 22%|███████████▌                                        | 2164/9735 [00:08<00:28, 264.26it/s] 23%|███████████▋                                        | 2191/9735 [00:08<00:28, 264.86it/s] 23%|███████████▊                                        | 2218/9735 [00:08<00:28, 265.38it/s] 23%|███████████▉                                        | 2245/9735 [00:08<00:28, 263.45it/s] 23%|████████████▏                                       | 2272/9735 [00:09<00:28, 264.23it/s] 24%|████████████▎                                       | 2299/9735 [00:09<00:28, 265.00it/s] 24%|████████████▍                                       | 2326/9735 [00:09<00:27, 265.38it/s] 24%|████████████▌                                       | 2353/9735 [00:09<00:27, 265.80it/s] 24%|████████████▋                                       | 2380/9735 [00:09<00:27, 266.14it/s] 25%|████████████▊                                       | 2407/9735 [00:09<00:27, 266.55it/s] 25%|█████████████                                       | 2434/9735 [00:09<00:27, 266.70it/s] 25%|█████████████▏                                      | 2461/9735 [00:09<00:27, 266.72it/s] 26%|█████████████▎                                      | 2488/9735 [00:09<00:27, 264.63it/s] 26%|█████████████▍                                      | 2515/9735 [00:09<00:27, 265.21it/s] 26%|█████████████▌                                      | 2542/9735 [00:10<00:27, 265.70it/s] 26%|█████████████▋                                      | 2569/9735 [00:10<00:26, 265.98it/s] 27%|█████████████▊                                      | 2596/9735 [00:10<00:26, 266.23it/s] 27%|██████████████                                      | 2623/9735 [00:10<00:26, 266.26it/s] 27%|██████████████▏                                     | 2650/9735 [00:10<00:26, 266.30it/s] 27%|██████████████▎                                     | 2677/9735 [00:10<00:26, 266.23it/s] 28%|██████████████▍                                     | 2704/9735 [00:10<00:26, 264.44it/s] 28%|██████████████▌                                     | 2731/9735 [00:10<00:26, 264.83it/s] 28%|██████████████▋                                     | 2758/9735 [00:10<00:26, 265.11it/s] 29%|██████████████▉                                     | 2785/9735 [00:10<00:26, 265.21it/s] 29%|███████████████                                     | 2812/9735 [00:11<00:26, 265.43it/s] 29%|███████████████▏                                    | 2839/9735 [00:11<00:25, 265.77it/s] 29%|███████████████▎                                    | 2866/9735 [00:11<00:25, 266.02it/s] 30%|███████████████▍                                    | 2893/9735 [00:11<00:25, 266.07it/s] 30%|███████████████▌                                    | 2920/9735 [00:11<00:25, 266.24it/s] 30%|███████████████▋                                    | 2947/9735 [00:11<00:25, 264.46it/s] 31%|███████████████▉                                    | 2974/9735 [00:11<00:25, 265.02it/s] 31%|████████████████                                    | 3001/9735 [00:11<00:25, 265.57it/s] 31%|████████████████▏                                   | 3028/9735 [00:11<00:25, 266.05it/s] 31%|████████████████▎                                   | 3055/9735 [00:11<00:25, 266.11it/s] 32%|████████████████▍                                   | 3082/9735 [00:12<00:24, 266.30it/s] 32%|████████████████▌                                   | 3109/9735 [00:12<00:24, 266.30it/s] 32%|████████████████▊                                   | 3136/9735 [00:12<00:24, 266.18it/s] 32%|████████████████▉                                   | 3163/9735 [00:12<00:24, 264.48it/s] 33%|█████████████████                                   | 3190/9735 [00:12<00:24, 265.32it/s] 33%|█████████████████▏                                  | 3217/9735 [00:12<00:24, 265.47it/s] 33%|█████████████████▎                                  | 3244/9735 [00:12<00:24, 265.94it/s] 34%|█████████████████▍                                  | 3271/9735 [00:12<00:24, 265.99it/s] 34%|█████████████████▌                                  | 3298/9735 [00:12<00:24, 265.19it/s] 34%|█████████████████▊                                  | 3325/9735 [00:12<00:24, 265.06it/s] 34%|█████████████████▉                                  | 3352/9735 [00:13<00:24, 265.80it/s] 35%|██████████████████                                  | 3379/9735 [00:13<00:24, 264.57it/s] 35%|██████████████████▏                                 | 3406/9735 [00:13<00:23, 265.16it/s] 35%|██████████████████▎                                 | 3433/9735 [00:13<00:23, 265.44it/s] 36%|██████████████████▍                                 | 3460/9735 [00:13<00:23, 265.66it/s] 36%|██████████████████▋                                 | 3487/9735 [00:13<00:23, 265.67it/s] 36%|██████████████████▊                                 | 3514/9735 [00:13<00:23, 265.41it/s] 36%|██████████████████▉                                 | 3541/9735 [00:13<00:23, 265.67it/s] 37%|███████████████████                                 | 3568/9735 [00:13<00:23, 265.31it/s] 37%|███████████████████▏                                | 3595/9735 [00:13<00:23, 264.88it/s] 37%|███████████████████▎                                | 3622/9735 [00:14<00:23, 263.40it/s] 37%|███████████████████▍                                | 3649/9735 [00:14<00:22, 264.65it/s] 38%|███████████████████▋                                | 3676/9735 [00:14<00:22, 264.86it/s] 38%|███████████████████▊                                | 3703/9735 [00:14<00:22, 265.33it/s] 38%|███████████████████▉                                | 3730/9735 [00:14<00:22, 265.77it/s] 39%|████████████████████                                | 3757/9735 [00:14<00:22, 265.89it/s] 39%|████████████████████▏                               | 3784/9735 [00:14<00:22, 265.92it/s] 39%|████████████████████▎                               | 3811/9735 [00:14<00:22, 265.86it/s] 39%|████████████████████▌                               | 3838/9735 [00:14<00:22, 263.91it/s] 40%|████████████████████▋                               | 3865/9735 [00:15<00:22, 264.53it/s] 40%|████████████████████▊                               | 3892/9735 [00:15<00:22, 264.54it/s] 40%|████████████████████▉                               | 3919/9735 [00:15<00:21, 264.93it/s] 41%|█████████████████████                               | 3946/9735 [00:15<00:21, 265.45it/s] 41%|█████████████████████▏                              | 3973/9735 [00:15<00:21, 265.58it/s] 41%|█████████████████████▎                              | 4000/9735 [00:15<00:21, 265.84it/s] 41%|█████████████████████▌                              | 4027/9735 [00:15<00:21, 265.98it/s] 42%|█████████████████████▋                              | 4054/9735 [00:15<00:21, 265.80it/s] 42%|█████████████████████▊                              | 4081/9735 [00:15<00:21, 263.83it/s] 42%|█████████████████████▉                              | 4108/9735 [00:15<00:21, 264.13it/s] 42%|██████████████████████                              | 4135/9735 [00:16<00:21, 264.65it/s] 43%|██████████████████████▏                             | 4162/9735 [00:16<00:21, 264.93it/s] 43%|██████████████████████▍                             | 4189/9735 [00:16<00:21, 263.29it/s] 43%|██████████████████████▌                             | 4216/9735 [00:16<00:20, 264.17it/s] 44%|██████████████████████▋                             | 4243/9735 [00:16<00:20, 265.15it/s] 44%|██████████████████████▊                             | 4270/9735 [00:16<00:20, 265.30it/s] 44%|██████████████████████▉                             | 4297/9735 [00:16<00:20, 263.65it/s] 44%|███████████████████████                             | 4324/9735 [00:16<00:20, 264.06it/s] 45%|███████████████████████▏                            | 4351/9735 [00:16<00:20, 264.44it/s] 45%|███████████████████████▍                            | 4378/9735 [00:16<00:20, 264.86it/s] 45%|███████████████████████▌                            | 4405/9735 [00:17<00:20, 265.03it/s] 46%|███████████████████████▋                            | 4432/9735 [00:17<00:19, 265.30it/s] 46%|███████████████████████▊                            | 4459/9735 [00:17<00:19, 265.52it/s] 46%|███████████████████████▉                            | 4486/9735 [00:17<00:19, 263.66it/s] 46%|████████████████████████                            | 4513/9735 [00:17<00:19, 264.32it/s] 47%|████████████████████████▎                           | 4540/9735 [00:17<00:21, 239.65it/s] 47%|████████████████████████▍                           | 4567/9735 [00:17<00:20, 246.81it/s] 47%|████████████████████████▌                           | 4594/9735 [00:17<00:20, 252.37it/s] 47%|████████████████████████▋                           | 4621/9735 [00:17<00:19, 256.58it/s] 48%|████████████████████████▊                           | 4648/9735 [00:17<00:19, 259.41it/s] 48%|████████████████████████▉                           | 4675/9735 [00:18<00:19, 261.27it/s] 48%|█████████████████████████                           | 4702/9735 [00:18<00:19, 262.76it/s] 49%|█████████████████████████▎                          | 4729/9735 [00:18<00:18, 263.76it/s] 49%|█████████████████████████▍                          | 4756/9735 [00:18<00:27, 177.83it/s] 49%|█████████████████████████▌                          | 4783/9735 [00:18<00:25, 197.31it/s] 49%|█████████████████████████▋                          | 4810/9735 [00:18<00:23, 213.86it/s] 50%|█████████████████████████▊                          | 4837/9735 [00:18<00:21, 227.13it/s] 50%|█████████████████████████▉                          | 4864/9735 [00:18<00:20, 237.10it/s] 50%|██████████████████████████▏                         | 4891/9735 [00:19<00:19, 245.00it/s] 51%|██████████████████████████▎                         | 4918/9735 [00:19<00:19, 250.73it/s] 51%|██████████████████████████▍                         | 4945/9735 [00:19<00:18, 253.54it/s] 51%|██████████████████████████▌                         | 4972/9735 [00:19<00:18, 256.98it/s] 51%|██████████████████████████▋                         | 4999/9735 [00:19<00:18, 257.69it/s] 52%|██████████████████████████▊                         | 5026/9735 [00:19<00:18, 260.32it/s] 52%|██████████████████████████▉                         | 5053/9735 [00:19<00:17, 262.27it/s] 52%|███████████████████████████▏                        | 5080/9735 [00:19<00:17, 263.25it/s] 52%|███████████████████████████▎                        | 5107/9735 [00:19<00:17, 264.25it/s] 53%|███████████████████████████▍                        | 5134/9735 [00:19<00:17, 264.92it/s] 53%|███████████████████████████▌                        | 5161/9735 [00:20<00:17, 265.11it/s] 53%|███████████████████████████▋                        | 5188/9735 [00:20<00:17, 262.57it/s] 54%|███████████████████████████▊                        | 5215/9735 [00:20<00:17, 263.27it/s] 54%|████████████████████████████                        | 5242/9735 [00:20<00:17, 263.90it/s] 54%|████████████████████████████▏                       | 5269/9735 [00:20<00:16, 264.22it/s] 54%|████████████████████████████▎                       | 5296/9735 [00:20<00:16, 262.45it/s] 55%|████████████████████████████▍                       | 5323/9735 [00:20<00:16, 263.23it/s] 55%|████████████████████████████▌                       | 5350/9735 [00:20<00:16, 263.77it/s] 55%|████████████████████████████▋                       | 5377/9735 [00:20<00:16, 264.16it/s] 56%|████████████████████████████▊                       | 5404/9735 [00:21<00:16, 262.42it/s] 56%|█████████████████████████████                       | 5431/9735 [00:21<00:16, 263.29it/s] 56%|█████████████████████████████▏                      | 5458/9735 [00:21<00:16, 263.89it/s] 56%|█████████████████████████████▎                      | 5485/9735 [00:21<00:16, 265.43it/s] 57%|█████████████████████████████▍                      | 5513/9735 [00:21<00:15, 267.77it/s] 57%|█████████████████████████████▌                      | 5541/9735 [00:21<00:15, 269.40it/s] 57%|█████████████████████████████▋                      | 5569/9735 [00:21<00:15, 270.60it/s] 57%|█████████████████████████████▉                      | 5597/9735 [00:21<00:15, 270.54it/s] 58%|██████████████████████████████                      | 5625/9735 [00:21<00:15, 269.57it/s] 58%|██████████████████████████████▏                     | 5652/9735 [00:21<00:15, 268.78it/s] 58%|██████████████████████████████▎                     | 5680/9735 [00:22<00:15, 269.93it/s] 59%|██████████████████████████████▍                     | 5708/9735 [00:22<00:14, 270.95it/s] 59%|██████████████████████████████▋                     | 5736/9735 [00:22<00:14, 271.75it/s] 59%|██████████████████████████████▊                     | 5764/9735 [00:22<00:14, 272.04it/s] 59%|██████████████████████████████▉                     | 5792/9735 [00:22<00:14, 272.32it/s] 60%|███████████████████████████████                     | 5820/9735 [00:22<00:14, 271.98it/s] 60%|███████████████████████████████▏                    | 5848/9735 [00:22<00:14, 271.81it/s] 60%|███████████████████████████████▍                    | 5876/9735 [00:22<00:14, 270.35it/s] 61%|███████████████████████████████▌                    | 5904/9735 [00:22<00:14, 271.11it/s] 61%|███████████████████████████████▋                    | 5932/9735 [00:22<00:14, 271.54it/s] 61%|███████████████████████████████▊                    | 5960/9735 [00:23<00:13, 272.13it/s] 62%|███████████████████████████████▉                    | 5988/9735 [00:23<00:13, 272.47it/s] 62%|████████████████████████████████▏                   | 6016/9735 [00:23<00:13, 272.29it/s] 62%|████████████████████████████████▎                   | 6044/9735 [00:23<00:13, 272.40it/s] 62%|████████████████████████████████▍                   | 6072/9735 [00:23<00:13, 272.36it/s] 63%|████████████████████████████████▌                   | 6100/9735 [00:23<00:13, 270.53it/s] 63%|████████████████████████████████▋                   | 6128/9735 [00:23<00:13, 271.01it/s] 63%|████████████████████████████████▉                   | 6156/9735 [00:23<00:13, 269.82it/s] 64%|█████████████████████████████████                   | 6184/9735 [00:23<00:13, 270.77it/s] 64%|█████████████████████████████████▏                  | 6212/9735 [00:24<00:12, 271.40it/s] 64%|█████████████████████████████████▎                  | 6240/9735 [00:24<00:12, 271.46it/s] 64%|█████████████████████████████████▍                  | 6268/9735 [00:24<00:12, 271.45it/s] 65%|█████████████████████████████████▋                  | 6296/9735 [00:24<00:12, 271.68it/s] 65%|█████████████████████████████████▊                  | 6324/9735 [00:24<00:12, 270.13it/s] 65%|█████████████████████████████████▉                  | 6352/9735 [00:24<00:12, 270.89it/s] 66%|██████████████████████████████████                  | 6380/9735 [00:24<00:12, 271.26it/s] 66%|██████████████████████████████████▏                 | 6408/9735 [00:24<00:12, 271.68it/s] 66%|██████████████████████████████████▍                 | 6436/9735 [00:24<00:12, 272.03it/s] 66%|██████████████████████████████████▌                 | 6464/9735 [00:24<00:12, 272.12it/s] 67%|██████████████████████████████████▋                 | 6492/9735 [00:25<00:11, 272.02it/s] 67%|██████████████████████████████████▊                 | 6520/9735 [00:25<00:11, 271.94it/s] 67%|██████████████████████████████████▉                 | 6548/9735 [00:25<00:11, 270.29it/s] 68%|███████████████████████████████████▏                | 6576/9735 [00:25<00:11, 270.88it/s] 68%|███████████████████████████████████▎                | 6604/9735 [00:25<00:11, 271.28it/s] 68%|███████████████████████████████████▍                | 6632/9735 [00:25<00:11, 271.88it/s] 68%|███████████████████████████████████▌                | 6660/9735 [00:25<00:11, 272.38it/s] 69%|███████████████████████████████████▋                | 6688/9735 [00:25<00:11, 272.41it/s] 69%|███████████████████████████████████▊                | 6716/9735 [00:25<00:11, 272.29it/s] 69%|████████████████████████████████████                | 6744/9735 [00:25<00:11, 271.76it/s] 70%|████████████████████████████████████▏               | 6772/9735 [00:26<00:10, 270.34it/s] 70%|████████████████████████████████████▎               | 6800/9735 [00:26<00:10, 271.00it/s] 70%|████████████████████████████████████▍               | 6828/9735 [00:26<00:10, 271.56it/s] 70%|████████████████████████████████████▌               | 6856/9735 [00:26<00:10, 272.01it/s] 71%|████████████████████████████████████▊               | 6884/9735 [00:26<00:10, 272.30it/s] 71%|████████████████████████████████████▉               | 6912/9735 [00:26<00:10, 272.07it/s] 71%|█████████████████████████████████████               | 6940/9735 [00:26<00:10, 272.22it/s] 72%|█████████████████████████████████████▏              | 6968/9735 [00:26<00:10, 272.00it/s] 72%|█████████████████████████████████████▎              | 6996/9735 [00:26<00:10, 270.48it/s] 72%|█████████████████████████████████████▌              | 7024/9735 [00:26<00:09, 271.19it/s] 72%|█████████████████████████████████████▋              | 7052/9735 [00:27<00:09, 271.84it/s] 73%|█████████████████████████████████████▊              | 7080/9735 [00:27<00:09, 272.29it/s] 73%|█████████████████████████████████████▉              | 7108/9735 [00:27<00:09, 272.29it/s] 73%|██████████████████████████████████████              | 7136/9735 [00:27<00:09, 272.38it/s] 74%|██████████████████████████████████████▎             | 7164/9735 [00:27<00:09, 272.16it/s] 74%|██████████████████████████████████████▍             | 7192/9735 [00:27<00:09, 272.27it/s] 74%|██████████████████████████████████████▌             | 7220/9735 [00:27<00:09, 270.47it/s] 74%|██████████████████████████████████████▋             | 7248/9735 [00:27<00:09, 271.10it/s] 75%|██████████████████████████████████████▊             | 7276/9735 [00:27<00:09, 271.56it/s] 75%|███████████████████████████████████████             | 7304/9735 [00:28<00:08, 271.97it/s] 75%|███████████████████████████████████████▏            | 7332/9735 [00:28<00:08, 272.15it/s] 76%|███████████████████████████████████████▎            | 7360/9735 [00:28<00:08, 272.26it/s] 76%|███████████████████████████████████████▍            | 7388/9735 [00:28<00:08, 272.26it/s] 76%|███████████████████████████████████████▌            | 7416/9735 [00:28<00:08, 272.22it/s] 76%|███████████████████████████████████████▊            | 7444/9735 [00:28<00:09, 248.98it/s] 77%|███████████████████████████████████████▉            | 7472/9735 [00:28<00:08, 255.59it/s] 77%|████████████████████████████████████████            | 7500/9735 [00:28<00:08, 260.47it/s] 77%|████████████████████████████████████████▏           | 7528/9735 [00:28<00:08, 263.76it/s] 78%|████████████████████████████████████████▎           | 7556/9735 [00:28<00:08, 266.01it/s] 78%|████████████████████████████████████████▌           | 7584/9735 [00:29<00:08, 267.65it/s] 78%|████████████████████████████████████████▋           | 7612/9735 [00:29<00:07, 268.95it/s] 78%|████████████████████████████████████████▊           | 7640/9735 [00:29<00:07, 269.75it/s] 79%|████████████████████████████████████████▉           | 7668/9735 [00:29<00:07, 268.77it/s] 79%|█████████████████████████████████████████           | 7696/9735 [00:29<00:07, 269.70it/s] 79%|█████████████████████████████████████████▎          | 7724/9735 [00:29<00:07, 270.70it/s] 80%|█████████████████████████████████████████▍          | 7752/9735 [00:29<00:07, 271.27it/s] 80%|█████████████████████████████████████████▌          | 7780/9735 [00:29<00:07, 271.33it/s] 80%|█████████████████████████████████████████▋          | 7808/9735 [00:29<00:07, 270.04it/s] 80%|█████████████████████████████████████████▊          | 7836/9735 [00:30<00:07, 270.50it/s] 81%|██████████████████████████████████████████          | 7864/9735 [00:30<00:06, 270.90it/s] 81%|██████████████████████████████████████████▏         | 7892/9735 [00:30<00:06, 271.48it/s] 81%|██████████████████████████████████████████▎         | 7920/9735 [00:30<00:06, 270.23it/s] 82%|██████████████████████████████████████████▍         | 7948/9735 [00:30<00:06, 270.76it/s] 82%|██████████████████████████████████████████▌         | 7976/9735 [00:30<00:06, 271.17it/s] 82%|██████████████████████████████████████████▊         | 8004/9735 [00:30<00:06, 271.55it/s] 83%|██████████████████████████████████████████▉         | 8032/9735 [00:30<00:06, 271.67it/s] 83%|███████████████████████████████████████████         | 8060/9735 [00:30<00:06, 271.64it/s] 83%|███████████████████████████████████████████▏        | 8088/9735 [00:30<00:06, 271.94it/s] 83%|███████████████████████████████████████████▎        | 8116/9735 [00:31<00:05, 272.36it/s] 84%|███████████████████████████████████████████▌        | 8144/9735 [00:31<00:05, 270.69it/s] 84%|███████████████████████████████████████████▋        | 8172/9735 [00:31<00:05, 269.42it/s] 84%|███████████████████████████████████████████▊        | 8200/9735 [00:31<00:05, 270.20it/s] 85%|███████████████████████████████████████████▉        | 8228/9735 [00:31<00:05, 270.70it/s] 85%|████████████████████████████████████████████        | 8256/9735 [00:31<00:05, 271.14it/s] 85%|████████████████████████████████████████████▏       | 8284/9735 [00:31<00:05, 271.19it/s] 85%|████████████████████████████████████████████▍       | 8312/9735 [00:31<00:05, 271.51it/s] 86%|████████████████████████████████████████████▌       | 8340/9735 [00:31<00:05, 271.90it/s] 86%|████████████████████████████████████████████▋       | 8368/9735 [00:31<00:05, 270.18it/s] 86%|████████████████████████████████████████████▊       | 8396/9735 [00:32<00:04, 270.47it/s] 87%|████████████████████████████████████████████▉       | 8424/9735 [00:32<00:04, 271.02it/s] 87%|█████████████████████████████████████████████▏      | 8452/9735 [00:32<00:04, 271.36it/s] 87%|█████████████████████████████████████████████▎      | 8480/9735 [00:32<00:04, 271.42it/s] 87%|█████████████████████████████████████████████▍      | 8508/9735 [00:32<00:04, 271.57it/s] 88%|█████████████████████████████████████████████▌      | 8536/9735 [00:32<00:04, 270.47it/s] 88%|█████████████████████████████████████████████▋      | 8564/9735 [00:32<00:04, 270.89it/s] 88%|█████████████████████████████████████████████▉      | 8592/9735 [00:32<00:04, 269.76it/s] 89%|██████████████████████████████████████████████      | 8620/9735 [00:32<00:04, 269.99it/s] 89%|██████████████████████████████████████████████▏     | 8648/9735 [00:33<00:04, 270.53it/s] 89%|██████████████████████████████████████████████▎     | 8676/9735 [00:33<00:03, 271.19it/s] 89%|██████████████████████████████████████████████▍     | 8704/9735 [00:33<00:03, 271.32it/s] 90%|██████████████████████████████████████████████▋     | 8732/9735 [00:33<00:03, 271.40it/s] 90%|██████████████████████████████████████████████▊     | 8760/9735 [00:33<00:03, 271.58it/s] 90%|██████████████████████████████████████████████▉     | 8788/9735 [00:33<00:03, 271.55it/s] 91%|███████████████████████████████████████████████     | 8816/9735 [00:33<00:03, 269.60it/s] 91%|███████████████████████████████████████████████▏    | 8844/9735 [00:33<00:03, 270.11it/s] 91%|███████████████████████████████████████████████▍    | 8872/9735 [00:33<00:03, 270.76it/s] 91%|███████████████████████████████████████████████▌    | 8900/9735 [00:33<00:03, 270.76it/s] 92%|███████████████████████████████████████████████▋    | 8928/9735 [00:34<00:02, 270.91it/s] 92%|███████████████████████████████████████████████▊    | 8956/9735 [00:34<00:02, 270.32it/s] 92%|███████████████████████████████████████████████▉    | 8984/9735 [00:34<00:02, 270.57it/s] 93%|████████████████████████████████████████████████▏   | 9012/9735 [00:34<00:02, 270.75it/s] 93%|████████████████████████████████████████████████▎   | 9040/9735 [00:34<00:02, 268.98it/s] 93%|████████████████████████████████████████████████▍   | 9068/9735 [00:34<00:02, 269.92it/s] 93%|████████████████████████████████████████████████▌   | 9096/9735 [00:34<00:02, 270.49it/s] 94%|████████████████████████████████████████████████▋   | 9124/9735 [00:34<00:02, 270.69it/s] 94%|████████████████████████████████████████████████▉   | 9152/9735 [00:34<00:02, 271.03it/s] 94%|█████████████████████████████████████████████████   | 9180/9735 [00:34<00:02, 271.35it/s] 95%|█████████████████████████████████████████████████▏  | 9208/9735 [00:35<00:01, 271.46it/s] 95%|█████████████████████████████████████████████████▎  | 9236/9735 [00:35<00:01, 271.55it/s] 95%|█████████████████████████████████████████████████▍  | 9264/9735 [00:35<00:01, 269.85it/s] 95%|█████████████████████████████████████████████████▋  | 9292/9735 [00:35<00:01, 270.44it/s] 96%|█████████████████████████████████████████████████▊  | 9320/9735 [00:35<00:01, 270.96it/s] 96%|█████████████████████████████████████████████████▉  | 9348/9735 [00:35<00:01, 271.20it/s] 96%|██████████████████████████████████████████████████  | 9376/9735 [00:35<00:01, 271.27it/s] 97%|██████████████████████████████████████████████████▏ | 9404/9735 [00:35<00:01, 271.14it/s] 97%|██████████████████████████████████████████████████▍ | 9432/9735 [00:35<00:01, 271.41it/s] 97%|██████████████████████████████████████████████████▌ | 9460/9735 [00:36<00:01, 263.57it/s] 97%|██████████████████████████████████████████████████▋ | 9487/9735 [00:36<00:00, 264.12it/s] 98%|██████████████████████████████████████████████████▊ | 9515/9735 [00:36<00:00, 266.39it/s] 98%|██████████████████████████████████████████████████▉ | 9543/9735 [00:36<00:00, 268.02it/s] 98%|███████████████████████████████████████████████████ | 9571/9735 [00:36<00:00, 269.17it/s] 99%|███████████████████████████████████████████████████▎| 9599/9735 [00:36<00:00, 269.70it/s] 99%|███████████████████████████████████████████████████▍| 9627/9735 [00:36<00:00, 270.38it/s] 99%|███████████████████████████████████████████████████▌| 9655/9735 [00:36<00:00, 270.82it/s] 99%|███████████████████████████████████████████████████▋| 9683/9735 [00:36<00:00, 271.09it/s]100%|███████████████████████████████████████████████████▊| 9711/9735 [00:36<00:00, 269.41it/s]100%|████████████████████████████████████████████████████| 9735/9735 [00:37<00:00, 262.83it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.15s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.28s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:11,  5.57s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:11,  5.84s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:04,  4.98s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.39s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:11<00:05,  5.51s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:11<00:05,  5.85s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.37s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.55s/it]
[2023-08-21 15:12:14,372] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.79s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.94s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  4.91s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  5.08s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:18<00:00,  6.11s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:18<00:00,  6.04s/it]
[2023-08-21 15:12:31,950] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-21 15:12:31,952] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-21 15:12:31,952] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-21 15:12:31,952] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-21 15:12:31,952] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-21 15:12:31,952] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fcdef971f40>
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7fce03796dc0>
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-21 15:12:31,955] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-21 15:12:31,955] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-21 15:12:31,955] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-21 15:12:31,955] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.6860218048095703 seconds
Loading extension module utils...
Time to load utils op: 0.5047280788421631 seconds
Loading extension module utils...
Time to load utils op: 0.7048795223236084 seconds
Loading extension module utils...
Time to load utils op: 0.7047910690307617 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: 1. First, let's understand the question which is asking where you can find some plumbing that would not be beneficial if you are thirsty. 
2. The plumbing system of interest here should be one that does not carry drinkable water.
3. We start to eliminate the options. Looking at choice E: water fountain, this obviously carries drinkable water so it can't be it.
4. Option D: own home, also carries drinkable water from faucets, so we eliminate this option too.
5. Option C: show and option B: wall do not seem to make sense in this context as they do not typically refer to places with a plumbing system.
6. This leaves us with option A: oil refineries. Oil refineries typically have pipelines for transporting oil, not water. So, the plumbing in oil refineries would not be of use if you are thirsty.
7. Therefore, the answer is A: oil refineries.
So the final answer is A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Output: 1. The question asks us to identify what a person is not doing when they are beginning work.
2. Let's look at each option individually: 
3. Option A: Working. This option is probable because when someone is beginning work, they are indeed working.
4. Option B: Resting. This is unlikely as someone can't be starting to work and resting at the same time.
5. Option C: Tiredness. This could be ruled out because it is a state of feeling, not an action. Although one might argue that someone could be tired from the onset of work, it doesn't make sense within the context of the question.
6. Option D: Accomplishing. This seems to be the most likely answer. When someone is beginning their work, they will most likely not have accomplished anything yet as they have just started.
7. Option E: Momentum. This could be ruled out because similar to tiredness, it is not an action one performs. Rather, it can be a result or a product of work over time.
8. Hence, the correct answer is D: Accomplishing.
So the final answer is D: accomplishing

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Output: Reasoning:
1. Pens with a company logo are often passed out or used in an office setting.
2. They could be given to employees to use, or to visitors as part of a promotional activity.
3. A pencil is a different stationery item, so it is not likely to find pens inscribed with logos on them.
4. Also, while pens are commonly used to write sentences on paper, the paper doesn't have anything to do with where you might discover logo-embossed pens.
5. Although students use pens at school, it is unusual for schools to distribute pens with company logos, so it is less likely you will find such pens there.
6. A backpack could hold a pen with a logo, but this choice is more about where someone might store such an item, it doesn't necessarily provide a good answer to where you might encounter one.
7. Therefore, considering all the options, 'office' makes the most sense as an answer.
So the final answer is A: office

Input: Billy called out to John, and listened for what? Choices:  A: silence B: response C: communication D: hanging up E: whisper
Output: 1. The question pertains to the reason why Billy called out to John.
2. Usually, when a person calls out to someone else, it's to attract their attention and generate some form of verbal or non-verbal acknowledgment or reply.
3. 'Silence' and 'hanging up' would not be what Billy would be waiting for after calling out to John.
4. 'Whisper' could be a type of response, but it is not the most direct answer. 'Communication' is more general and less direct than'response'.
5. Hence, the most appropriate choice is B:'response'. This indicates that Billy is waiting for John to reply or acknowledge him in some way.
So the final answer is B: response

Input: The lizard frightened the hiker, it's movements made what rustle? Choices:  A: garden B: trees C: books D: rocks E: bushes
Output: 1. This question calls for reasoning based on understanding of common contextual usage and behavior of lizards and hikers.
2. We start by eliminating irrelevant options: Lizards aren't usually found in gardens, nor do they frighten hikers there typically. Books are definitely out of question since lizards don't rustle books.
3. Between trees, rocks, and bushes, lizards can't make trees rustle because they are too small and light, and rocks don't rustle at all.
4. Therefore, by process of elimination, the answer has to be E: bushes. Lizards often inhabit areas with bushes and their movement through them can cause rustling sounds, which could frighten a hiker.
So the final answer is E: bushes

Input: The man spent big money and time maintaining his lawn, it was part of keeping up with the Joneses where? Choices:  A: front yard B: suburbia C: neighborhood D: back yard E: golf course
Output: 1. The phrase "keeping up with the Joneses" refers to the comparison to one's neighbors as a benchmark for social class or the accumulation of material goods. 
2. This means the context is most likely a residential area where there are neighbors to compare with.
3. Among the options, A: front yard, B: suburbia, C: neighborhood, D: back yard, E: golf course, the phrase could technically apply to the front yard, the suburbia, the neighborhood, or the back yard, but not the golf course. The golf course option can be eliminated as it's not a residential area. 
4. However, the phrase "keeping up with the Joneses" is often applied in a broader sense, on a community level.
5. Therefore, the front yard and the back yard can be eliminated. The phrase does not usually refer to individual properties but rather to an entire residential community.
6. This then narrows down the choice to either suburbia or neighborhood. 
7. The "man spent big money", which suggests the community is relatively affluent, characteristic of suburbia.
8. Therefore, the answer is B: suburbia.
So the final answer is B: suburbia

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i6-s1-rTrue
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Evaluating commonsenseqa :   0%|                                       | 0/50 [00:05<?, ?it/s]
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 3273979) of binary: /home/ylu130/.conda/envs/distllm/bin/python
Traceback (most recent call last):
  File "/home/ylu130/.conda/envs/distllm/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 345, in wrapper
    return f(*args, **kwargs)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 761, in main
    run(args)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 752, in run
    elastic_launch(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 131, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 245, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
/home/ylu130/workspace/in-context-generalization/inference.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2023-08-21_15:12:43
  host      : ia1.wse.jhu.edu
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 3273980)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2023-08-21_15:12:43
  host      : ia1.wse.jhu.edu
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 3273981)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2023-08-21_15:12:43
  host      : ia1.wse.jhu.edu
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 3273982)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2023-08-21_15:12:43
  host      : ia1.wse.jhu.edu
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 3273979)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i7-s1-rTrue --seed 1 --max-prompt-length 2048 --rationales --num-in-domain 7
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[nltk_data]   Package punkt is already up-to-date!
[2023-08-21 15:12:47,390] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i7-s1-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 7
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i7-s1-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9734 [00:00<?, ?it/s]  0%|                                                      | 13/9734 [00:00<01:19, 121.64it/s]  0%|▏                                                     | 26/9734 [00:00<01:19, 122.08it/s]  0%|▏                                                     | 39/9734 [00:00<01:19, 121.97it/s]  1%|▎                                                     | 52/9734 [00:00<01:19, 121.98it/s]  1%|▎                                                     | 65/9734 [00:00<01:19, 121.83it/s]  1%|▍                                                     | 78/9734 [00:00<01:19, 121.79it/s]  1%|▌                                                     | 91/9734 [00:00<01:20, 120.26it/s]  1%|▌                                                    | 104/9734 [00:00<01:19, 120.72it/s]  1%|▋                                                    | 117/9734 [00:00<01:19, 121.31it/s]  1%|▋                                                    | 130/9734 [00:01<01:18, 121.79it/s]  1%|▊                                                    | 143/9734 [00:01<01:18, 122.07it/s]  2%|▊                                                    | 156/9734 [00:01<01:18, 122.35it/s]  2%|▉                                                    | 169/9734 [00:01<01:18, 122.40it/s]  2%|▉                                                    | 182/9734 [00:01<01:17, 122.48it/s]  2%|█                                                    | 195/9734 [00:01<01:17, 122.49it/s]  2%|█▏                                                   | 208/9734 [00:01<01:19, 119.91it/s]  2%|█▏                                                   | 221/9734 [00:01<01:18, 120.66it/s]  2%|█▎                                                   | 234/9734 [00:01<01:18, 121.24it/s]  3%|█▎                                                   | 247/9734 [00:02<01:18, 121.59it/s]  3%|█▍                                                   | 260/9734 [00:02<01:17, 121.86it/s]  3%|█▍                                                   | 273/9734 [00:02<01:17, 122.09it/s]  3%|█▌                                                   | 286/9734 [00:02<01:16, 122.77it/s]  3%|█▋                                                   | 305/9734 [00:02<01:06, 141.48it/s]  3%|█▊                                                   | 324/9734 [00:02<01:00, 154.81it/s]  4%|█▊                                                   | 343/9734 [00:02<00:57, 164.46it/s]  4%|█▉                                                   | 362/9734 [00:02<00:54, 170.91it/s]  4%|██                                                   | 381/9734 [00:02<00:53, 175.70it/s]  4%|██▏                                                  | 400/9734 [00:02<00:52, 179.05it/s]  4%|██▎                                                  | 419/9734 [00:03<00:51, 181.30it/s]  4%|██▍                                                  | 438/9734 [00:03<00:51, 181.27it/s]  5%|██▍                                                  | 457/9734 [00:03<00:50, 183.06it/s]  5%|██▌                                                  | 476/9734 [00:03<00:50, 184.16it/s]  5%|██▋                                                  | 495/9734 [00:03<00:49, 185.01it/s]  5%|██▊                                                  | 514/9734 [00:03<00:49, 185.58it/s]  5%|██▉                                                  | 533/9734 [00:03<00:49, 185.70it/s]  6%|███                                                  | 552/9734 [00:03<00:49, 185.96it/s]  6%|███                                                  | 571/9734 [00:03<00:49, 185.80it/s]  6%|███▏                                                 | 590/9734 [00:03<00:49, 185.94it/s]  6%|███▎                                                 | 609/9734 [00:04<00:49, 185.66it/s]  6%|███▍                                                 | 628/9734 [00:04<00:49, 185.60it/s]  7%|███▌                                                 | 647/9734 [00:04<00:48, 185.76it/s]  7%|███▋                                                 | 666/9734 [00:04<00:49, 184.29it/s]  7%|███▋                                                 | 685/9734 [00:04<00:49, 184.66it/s]  7%|███▊                                                 | 704/9734 [00:04<00:48, 184.97it/s]  7%|███▉                                                 | 723/9734 [00:04<00:48, 185.12it/s]  8%|████                                                 | 742/9734 [00:04<00:48, 185.34it/s]  8%|████▏                                                | 761/9734 [00:04<00:48, 185.55it/s]  8%|████▏                                                | 780/9734 [00:05<00:48, 185.70it/s]  8%|████▎                                                | 799/9734 [00:05<00:48, 185.61it/s]  8%|████▍                                                | 818/9734 [00:05<00:48, 185.50it/s]  9%|████▌                                                | 837/9734 [00:05<00:48, 184.44it/s]  9%|████▋                                                | 856/9734 [00:05<00:48, 184.91it/s]  9%|████▊                                                | 875/9734 [00:05<00:47, 185.27it/s]  9%|████▊                                                | 894/9734 [00:05<00:48, 183.81it/s]  9%|████▉                                                | 913/9734 [00:05<00:47, 184.25it/s] 10%|█████                                                | 932/9734 [00:05<00:47, 184.39it/s] 10%|█████▏                                               | 951/9734 [00:05<00:47, 184.83it/s] 10%|█████▎                                               | 970/9734 [00:06<00:47, 185.04it/s] 10%|█████▍                                               | 989/9734 [00:06<00:47, 185.33it/s] 10%|█████▍                                              | 1008/9734 [00:06<00:47, 185.51it/s] 11%|█████▍                                              | 1027/9734 [00:06<00:46, 185.94it/s] 11%|█████▌                                              | 1046/9734 [00:06<00:46, 186.17it/s] 11%|█████▋                                              | 1065/9734 [00:06<00:46, 186.18it/s] 11%|█████▊                                              | 1084/9734 [00:06<00:46, 184.49it/s] 11%|█████▉                                              | 1103/9734 [00:06<00:46, 185.04it/s] 12%|█████▉                                              | 1122/9734 [00:06<00:47, 182.30it/s] 12%|██████                                              | 1141/9734 [00:06<00:46, 183.65it/s] 12%|██████▏                                             | 1160/9734 [00:07<00:46, 184.33it/s] 12%|██████▎                                             | 1179/9734 [00:07<00:46, 184.80it/s] 12%|██████▍                                             | 1198/9734 [00:07<00:46, 185.11it/s] 13%|██████▌                                             | 1217/9734 [00:07<00:45, 185.40it/s] 13%|██████▌                                             | 1236/9734 [00:07<00:45, 185.56it/s] 13%|██████▋                                             | 1255/9734 [00:07<00:45, 185.73it/s] 13%|██████▊                                             | 1274/9734 [00:07<00:45, 185.81it/s] 13%|██████▉                                             | 1293/9734 [00:07<00:45, 185.97it/s] 13%|███████                                             | 1312/9734 [00:07<00:45, 186.12it/s] 14%|███████                                             | 1331/9734 [00:07<00:45, 185.39it/s] 14%|███████▏                                            | 1350/9734 [00:08<00:45, 183.95it/s] 14%|███████▎                                            | 1369/9734 [00:08<00:45, 184.57it/s] 14%|███████▍                                            | 1388/9734 [00:08<00:45, 184.66it/s] 14%|███████▌                                            | 1407/9734 [00:08<00:45, 185.00it/s] 15%|███████▌                                            | 1426/9734 [00:08<00:44, 185.28it/s] 15%|███████▋                                            | 1445/9734 [00:08<00:44, 185.55it/s] 15%|███████▊                                            | 1464/9734 [00:08<00:44, 185.65it/s] 15%|███████▉                                            | 1483/9734 [00:08<00:44, 185.90it/s] 15%|████████                                            | 1502/9734 [00:08<00:44, 185.73it/s] 16%|████████▏                                           | 1521/9734 [00:09<00:44, 185.77it/s] 16%|████████▏                                           | 1540/9734 [00:09<00:44, 185.85it/s] 16%|████████▎                                           | 1559/9734 [00:09<00:43, 185.88it/s] 16%|████████▍                                           | 1578/9734 [00:09<00:44, 184.13it/s] 16%|████████▌                                           | 1597/9734 [00:09<00:44, 184.64it/s] 17%|████████▋                                           | 1616/9734 [00:09<00:43, 185.01it/s] 17%|████████▋                                           | 1635/9734 [00:09<00:43, 184.77it/s] 17%|████████▊                                           | 1654/9734 [00:09<00:43, 184.47it/s] 17%|████████▉                                           | 1673/9734 [00:09<00:43, 185.00it/s] 17%|█████████                                           | 1692/9734 [00:09<00:43, 185.26it/s] 18%|█████████▏                                          | 1711/9734 [00:10<00:43, 185.45it/s] 18%|█████████▏                                          | 1730/9734 [00:10<00:43, 185.61it/s] 18%|█████████▎                                          | 1749/9734 [00:10<00:42, 185.79it/s] 18%|█████████▍                                          | 1768/9734 [00:10<00:42, 185.88it/s] 18%|█████████▌                                          | 1787/9734 [00:10<00:42, 185.82it/s] 19%|█████████▋                                          | 1806/9734 [00:10<00:47, 167.23it/s] 19%|█████████▋                                          | 1825/9734 [00:10<00:45, 172.38it/s] 19%|█████████▊                                          | 1844/9734 [00:10<00:44, 175.94it/s] 19%|█████████▉                                          | 1863/9734 [00:10<00:44, 178.89it/s] 19%|██████████                                          | 1882/9734 [00:10<00:43, 180.80it/s] 20%|██████████▏                                         | 1901/9734 [00:11<00:42, 182.25it/s] 20%|██████████▎                                         | 1920/9734 [00:11<00:42, 183.18it/s] 20%|██████████▎                                         | 1939/9734 [00:11<00:42, 183.86it/s] 20%|██████████▍                                         | 1958/9734 [00:11<00:42, 184.39it/s] 20%|██████████▌                                         | 1977/9734 [00:11<00:41, 184.88it/s] 21%|██████████▋                                         | 1996/9734 [00:11<00:41, 185.22it/s] 21%|██████████▊                                         | 2015/9734 [00:11<00:41, 185.49it/s] 21%|██████████▊                                         | 2034/9734 [00:11<00:41, 183.63it/s] 21%|██████████▉                                         | 2053/9734 [00:11<00:41, 183.91it/s] 21%|███████████                                         | 2072/9734 [00:12<00:41, 184.13it/s] 21%|███████████▏                                        | 2091/9734 [00:12<00:41, 184.16it/s] 22%|███████████▎                                        | 2110/9734 [00:12<00:41, 184.54it/s] 22%|███████████▎                                        | 2129/9734 [00:12<00:41, 184.72it/s] 22%|███████████▍                                        | 2148/9734 [00:12<00:41, 184.99it/s] 22%|███████████▌                                        | 2167/9734 [00:12<00:40, 185.18it/s] 22%|███████████▋                                        | 2186/9734 [00:12<00:40, 185.23it/s] 23%|███████████▊                                        | 2205/9734 [00:12<00:40, 185.12it/s] 23%|███████████▉                                        | 2224/9734 [00:12<00:40, 185.24it/s] 23%|███████████▉                                        | 2243/9734 [00:12<00:40, 185.44it/s] 23%|████████████                                        | 2262/9734 [00:13<00:40, 183.48it/s] 23%|████████████▏                                       | 2281/9734 [00:13<00:40, 184.12it/s] 24%|████████████▎                                       | 2300/9734 [00:13<00:40, 184.56it/s] 24%|████████████▍                                       | 2319/9734 [00:13<00:40, 184.70it/s] 24%|████████████▍                                       | 2338/9734 [00:13<00:39, 184.90it/s] 24%|████████████▌                                       | 2357/9734 [00:13<00:39, 185.12it/s] 24%|████████████▋                                       | 2376/9734 [00:13<00:39, 185.45it/s] 25%|████████████▊                                       | 2395/9734 [00:13<00:39, 185.64it/s] 25%|████████████▉                                       | 2414/9734 [00:13<00:39, 185.72it/s] 25%|████████████▉                                       | 2433/9734 [00:13<00:39, 185.69it/s] 25%|█████████████                                       | 2452/9734 [00:14<00:39, 185.61it/s] 25%|█████████████▏                                      | 2471/9734 [00:14<00:39, 185.48it/s] 26%|█████████████▎                                      | 2490/9734 [00:14<00:39, 183.77it/s] 26%|█████████████▍                                      | 2509/9734 [00:14<00:39, 184.42it/s] 26%|█████████████▌                                      | 2528/9734 [00:14<00:39, 184.32it/s] 26%|█████████████▌                                      | 2547/9734 [00:14<00:38, 184.60it/s] 26%|█████████████▋                                      | 2566/9734 [00:14<00:38, 184.98it/s] 27%|█████████████▊                                      | 2585/9734 [00:14<00:38, 184.92it/s] 27%|█████████████▉                                      | 2604/9734 [00:14<00:38, 185.15it/s] 27%|██████████████                                      | 2623/9734 [00:15<00:38, 185.04it/s] 27%|██████████████                                      | 2642/9734 [00:15<00:38, 185.09it/s] 27%|██████████████▏                                     | 2661/9734 [00:15<00:38, 185.28it/s] 28%|██████████████▎                                     | 2680/9734 [00:15<00:38, 185.36it/s] 28%|██████████████▍                                     | 2699/9734 [00:15<00:38, 183.51it/s] 28%|██████████████▌                                     | 2718/9734 [00:15<00:38, 183.91it/s] 28%|██████████████▌                                     | 2737/9734 [00:15<00:37, 184.26it/s] 28%|██████████████▋                                     | 2756/9734 [00:15<00:37, 184.40it/s] 29%|██████████████▊                                     | 2775/9734 [00:15<00:37, 184.54it/s] 29%|██████████████▉                                     | 2794/9734 [00:15<00:37, 184.75it/s] 29%|███████████████                                     | 2813/9734 [00:16<00:37, 184.73it/s] 29%|███████████████▏                                    | 2832/9734 [00:16<00:37, 185.06it/s] 29%|███████████████▏                                    | 2851/9734 [00:16<00:37, 184.95it/s] 29%|███████████████▎                                    | 2870/9734 [00:16<00:37, 185.23it/s] 30%|███████████████▍                                    | 2889/9734 [00:16<00:37, 184.45it/s] 30%|███████████████▌                                    | 2908/9734 [00:16<00:36, 184.86it/s] 30%|███████████████▋                                    | 2927/9734 [00:16<00:37, 183.32it/s] 30%|███████████████▋                                    | 2946/9734 [00:16<00:36, 183.93it/s] 30%|███████████████▊                                    | 2965/9734 [00:16<00:36, 184.37it/s] 31%|███████████████▉                                    | 2984/9734 [00:16<00:36, 184.66it/s] 31%|████████████████                                    | 3003/9734 [00:17<00:36, 184.73it/s] 31%|████████████████▏                                   | 3022/9734 [00:17<00:36, 184.85it/s] 31%|████████████████▏                                   | 3041/9734 [00:17<00:36, 184.91it/s] 31%|████████████████▎                                   | 3060/9734 [00:17<00:36, 184.86it/s] 32%|████████████████▍                                   | 3079/9734 [00:17<00:36, 184.80it/s] 32%|████████████████▌                                   | 3098/9734 [00:17<00:35, 184.80it/s] 32%|████████████████▋                                   | 3117/9734 [00:17<00:35, 185.04it/s] 32%|████████████████▊                                   | 3136/9734 [00:17<00:35, 185.05it/s] 32%|████████████████▊                                   | 3155/9734 [00:17<00:35, 183.58it/s] 33%|████████████████▉                                   | 3174/9734 [00:17<00:35, 184.14it/s] 33%|█████████████████                                   | 3193/9734 [00:18<00:35, 184.51it/s] 33%|█████████████████▏                                  | 3212/9734 [00:18<00:35, 183.00it/s] 33%|█████████████████▎                                  | 3231/9734 [00:18<00:35, 183.81it/s] 33%|█████████████████▎                                  | 3250/9734 [00:18<00:35, 184.32it/s] 34%|█████████████████▍                                  | 3269/9734 [00:18<00:35, 184.58it/s] 34%|█████████████████▌                                  | 3288/9734 [00:18<00:34, 184.72it/s] 34%|█████████████████▋                                  | 3307/9734 [00:18<00:34, 184.95it/s] 34%|█████████████████▊                                  | 3326/9734 [00:18<00:34, 184.89it/s] 34%|█████████████████▊                                  | 3345/9734 [00:18<00:34, 185.21it/s] 35%|█████████████████▉                                  | 3364/9734 [00:19<00:34, 185.24it/s] 35%|██████████████████                                  | 3383/9734 [00:19<00:34, 183.75it/s] 35%|██████████████████▏                                 | 3402/9734 [00:19<00:34, 184.14it/s] 35%|██████████████████▎                                 | 3421/9734 [00:19<00:34, 184.44it/s] 35%|██████████████████▍                                 | 3440/9734 [00:19<00:34, 184.47it/s] 36%|██████████████████▍                                 | 3459/9734 [00:19<00:33, 184.60it/s] 36%|██████████████████▌                                 | 3478/9734 [00:19<00:33, 184.74it/s] 36%|██████████████████▋                                 | 3497/9734 [00:19<00:33, 184.72it/s] 36%|██████████████████▊                                 | 3516/9734 [00:19<00:33, 183.49it/s] 36%|██████████████████▉                                 | 3535/9734 [00:19<00:33, 183.77it/s] 37%|██████████████████▉                                 | 3554/9734 [00:20<00:33, 184.25it/s] 37%|███████████████████                                 | 3573/9734 [00:20<00:33, 184.54it/s] 37%|███████████████████▏                                | 3592/9734 [00:20<00:33, 184.73it/s] 37%|███████████████████▎                                | 3611/9734 [00:20<00:33, 183.33it/s] 37%|███████████████████▍                                | 3630/9734 [00:20<00:33, 183.97it/s] 37%|███████████████████▍                                | 3649/9734 [00:20<00:33, 184.24it/s] 38%|███████████████████▌                                | 3668/9734 [00:20<00:32, 184.31it/s] 38%|███████████████████▋                                | 3687/9734 [00:20<00:32, 184.60it/s] 38%|███████████████████▊                                | 3706/9734 [00:20<00:32, 184.68it/s] 38%|███████████████████▉                                | 3725/9734 [00:20<00:32, 184.89it/s] 38%|████████████████████                                | 3744/9734 [00:21<00:32, 184.98it/s] 39%|████████████████████                                | 3763/9734 [00:21<00:32, 185.04it/s] 39%|████████████████████▏                               | 3782/9734 [00:21<00:32, 185.05it/s] 39%|████████████████████▎                               | 3801/9734 [00:21<00:32, 185.08it/s] 39%|████████████████████▍                               | 3820/9734 [00:21<00:32, 183.61it/s] 39%|████████████████████▌                               | 3839/9734 [00:21<00:32, 182.25it/s] 40%|████████████████████▌                               | 3858/9734 [00:21<00:32, 181.88it/s] 40%|████████████████████▋                               | 3877/9734 [00:21<00:32, 182.76it/s] 40%|████████████████████▊                               | 3896/9734 [00:21<00:31, 183.46it/s] 40%|████████████████████▉                               | 3915/9734 [00:22<00:31, 183.91it/s] 40%|█████████████████████                               | 3934/9734 [00:22<00:31, 184.30it/s] 41%|█████████████████████                               | 3953/9734 [00:22<00:31, 184.60it/s] 41%|█████████████████████▏                              | 3972/9734 [00:22<00:31, 184.81it/s] 41%|█████████████████████▎                              | 3991/9734 [00:22<00:31, 185.08it/s] 41%|█████████████████████▍                              | 4010/9734 [00:22<00:30, 185.23it/s] 41%|█████████████████████▌                              | 4029/9734 [00:22<00:30, 184.97it/s] 42%|█████████████████████▌                              | 4048/9734 [00:22<00:30, 185.06it/s] 42%|█████████████████████▋                              | 4067/9734 [00:22<00:30, 183.45it/s] 42%|█████████████████████▊                              | 4086/9734 [00:22<00:30, 184.01it/s] 42%|█████████████████████▉                              | 4105/9734 [00:23<00:30, 184.25it/s] 42%|██████████████████████                              | 4124/9734 [00:23<00:30, 184.67it/s] 43%|██████████████████████▏                             | 4143/9734 [00:23<00:30, 183.37it/s] 43%|██████████████████████▏                             | 4162/9734 [00:23<00:30, 183.94it/s] 43%|██████████████████████▎                             | 4181/9734 [00:23<00:30, 184.08it/s] 43%|██████████████████████▍                             | 4200/9734 [00:23<00:30, 184.30it/s] 43%|██████████████████████▌                             | 4219/9734 [00:23<00:29, 184.59it/s] 44%|██████████████████████▋                             | 4238/9734 [00:23<00:29, 184.59it/s] 44%|██████████████████████▋                             | 4257/9734 [00:23<00:29, 184.81it/s] 44%|██████████████████████▊                             | 4276/9734 [00:23<00:29, 184.92it/s] 44%|██████████████████████▉                             | 4295/9734 [00:24<00:29, 183.45it/s] 44%|███████████████████████                             | 4314/9734 [00:24<00:29, 183.98it/s] 45%|███████████████████████▏                            | 4333/9734 [00:24<00:29, 184.08it/s] 45%|███████████████████████▏                            | 4352/9734 [00:24<00:29, 184.23it/s] 45%|███████████████████████▎                            | 4371/9734 [00:24<00:29, 184.58it/s] 45%|███████████████████████▍                            | 4390/9734 [00:24<00:28, 184.66it/s] 45%|███████████████████████▌                            | 4409/9734 [00:24<00:28, 184.60it/s] 45%|███████████████████████▋                            | 4428/9734 [00:24<00:28, 184.73it/s] 46%|███████████████████████▊                            | 4447/9734 [00:24<00:28, 183.39it/s] 46%|███████████████████████▊                            | 4466/9734 [00:24<00:28, 183.88it/s] 46%|███████████████████████▉                            | 4485/9734 [00:25<00:28, 184.17it/s] 46%|████████████████████████                            | 4504/9734 [00:25<00:28, 184.22it/s] 46%|████████████████████████▏                           | 4523/9734 [00:25<00:32, 159.83it/s] 47%|████████████████████████▎                           | 4542/9734 [00:25<00:31, 166.65it/s] 47%|████████████████████████▎                           | 4561/9734 [00:25<00:30, 170.54it/s] 47%|████████████████████████▍                           | 4580/9734 [00:25<00:29, 174.66it/s] 47%|████████████████████████▌                           | 4599/9734 [00:25<00:28, 177.79it/s] 47%|████████████████████████▋                           | 4618/9734 [00:25<00:28, 180.06it/s] 48%|████████████████████████▊                           | 4637/9734 [00:25<00:28, 181.63it/s] 48%|████████████████████████▊                           | 4656/9734 [00:26<00:27, 182.61it/s] 48%|████████████████████████▉                           | 4675/9734 [00:26<00:27, 183.43it/s] 48%|█████████████████████████                           | 4694/9734 [00:26<00:27, 184.05it/s] 48%|█████████████████████████▏                          | 4713/9734 [00:26<00:27, 184.11it/s] 49%|█████████████████████████▎                          | 4732/9734 [00:26<00:27, 184.63it/s] 49%|█████████████████████████▍                          | 4751/9734 [00:26<00:40, 123.48it/s] 49%|█████████████████████████▍                          | 4770/9734 [00:26<00:36, 136.67it/s] 49%|█████████████████████████▌                          | 4789/9734 [00:26<00:33, 147.87it/s] 49%|█████████████████████████▋                          | 4808/9734 [00:27<00:31, 157.43it/s] 50%|█████████████████████████▊                          | 4827/9734 [00:27<00:29, 164.81it/s] 50%|█████████████████████████▉                          | 4846/9734 [00:27<00:28, 170.25it/s] 50%|█████████████████████████▉                          | 4865/9734 [00:27<00:27, 174.39it/s] 50%|██████████████████████████                          | 4884/9734 [00:27<00:27, 177.55it/s] 50%|██████████████████████████▏                         | 4903/9734 [00:27<00:26, 179.83it/s] 51%|██████████████████████████▎                         | 4922/9734 [00:27<00:26, 181.42it/s] 51%|██████████████████████████▍                         | 4941/9734 [00:27<00:26, 182.60it/s] 51%|██████████████████████████▍                         | 4960/9734 [00:27<00:26, 181.96it/s] 51%|██████████████████████████▌                         | 4979/9734 [00:28<00:25, 182.91it/s] 51%|██████████████████████████▋                         | 4998/9734 [00:28<00:25, 183.32it/s] 52%|██████████████████████████▊                         | 5017/9734 [00:28<00:25, 183.78it/s] 52%|██████████████████████████▉                         | 5036/9734 [00:28<00:25, 183.33it/s] 52%|███████████████████████████                         | 5055/9734 [00:28<00:25, 183.72it/s] 52%|███████████████████████████                         | 5074/9734 [00:28<00:25, 184.12it/s] 52%|███████████████████████████▏                        | 5093/9734 [00:28<00:25, 184.31it/s] 53%|███████████████████████████▎                        | 5112/9734 [00:28<00:25, 184.38it/s] 53%|███████████████████████████▍                        | 5131/9734 [00:28<00:24, 184.48it/s] 53%|███████████████████████████▌                        | 5150/9734 [00:28<00:24, 184.77it/s] 53%|███████████████████████████▌                        | 5169/9734 [00:29<00:24, 184.80it/s] 53%|███████████████████████████▋                        | 5188/9734 [00:29<00:24, 183.27it/s] 53%|███████████████████████████▊                        | 5207/9734 [00:29<00:24, 183.80it/s] 54%|███████████████████████████▉                        | 5226/9734 [00:29<00:24, 184.13it/s] 54%|████████████████████████████                        | 5245/9734 [00:29<00:24, 184.48it/s] 54%|████████████████████████████                        | 5264/9734 [00:29<00:24, 184.43it/s] 54%|████████████████████████████▏                       | 5283/9734 [00:29<00:24, 184.35it/s] 54%|████████████████████████████▎                       | 5302/9734 [00:29<00:23, 184.67it/s] 55%|████████████████████████████▍                       | 5321/9734 [00:29<00:23, 184.65it/s] 55%|████████████████████████████▌                       | 5340/9734 [00:29<00:23, 184.75it/s] 55%|████████████████████████████▋                       | 5359/9734 [00:30<00:23, 184.69it/s] 55%|████████████████████████████▋                       | 5378/9734 [00:30<00:23, 184.72it/s] 55%|████████████████████████████▊                       | 5397/9734 [00:30<00:23, 184.73it/s] 56%|████████████████████████████▉                       | 5416/9734 [00:30<00:23, 183.17it/s] 56%|█████████████████████████████                       | 5435/9734 [00:30<00:23, 183.57it/s] 56%|█████████████████████████████▏                      | 5454/9734 [00:30<00:23, 183.01it/s] 56%|█████████████████████████████▏                      | 5473/9734 [00:30<00:23, 183.59it/s] 56%|█████████████████████████████▎                      | 5492/9734 [00:30<00:22, 185.33it/s] 57%|█████████████████████████████▍                      | 5512/9734 [00:30<00:22, 186.86it/s] 57%|█████████████████████████████▌                      | 5532/9734 [00:30<00:22, 187.90it/s] 57%|█████████████████████████████▋                      | 5552/9734 [00:31<00:22, 188.72it/s] 57%|█████████████████████████████▊                      | 5571/9734 [00:31<00:22, 188.87it/s] 57%|█████████████████████████████▊                      | 5590/9734 [00:31<00:21, 189.06it/s] 58%|█████████████████████████████▉                      | 5610/9734 [00:31<00:21, 189.41it/s] 58%|██████████████████████████████                      | 5629/9734 [00:31<00:21, 187.83it/s] 58%|██████████████████████████████▏                     | 5648/9734 [00:31<00:21, 188.24it/s] 58%|██████████████████████████████▎                     | 5667/9734 [00:31<00:21, 188.71it/s] 58%|██████████████████████████████▍                     | 5686/9734 [00:31<00:21, 189.07it/s] 59%|██████████████████████████████▍                     | 5706/9734 [00:31<00:21, 189.41it/s] 59%|██████████████████████████████▌                     | 5726/9734 [00:32<00:21, 189.68it/s] 59%|██████████████████████████████▋                     | 5746/9734 [00:32<00:21, 189.86it/s] 59%|██████████████████████████████▊                     | 5766/9734 [00:32<00:20, 189.96it/s] 59%|██████████████████████████████▉                     | 5786/9734 [00:32<00:20, 190.01it/s] 60%|███████████████████████████████                     | 5806/9734 [00:32<00:20, 189.84it/s] 60%|███████████████████████████████                     | 5825/9734 [00:32<00:20, 189.82it/s] 60%|███████████████████████████████▏                    | 5844/9734 [00:32<00:20, 189.81it/s] 60%|███████████████████████████████▎                    | 5863/9734 [00:32<00:20, 188.07it/s] 60%|███████████████████████████████▍                    | 5883/9734 [00:32<00:20, 188.69it/s] 61%|███████████████████████████████▌                    | 5902/9734 [00:32<00:20, 188.91it/s] 61%|███████████████████████████████▋                    | 5921/9734 [00:33<00:20, 189.18it/s] 61%|███████████████████████████████▋                    | 5941/9734 [00:33<00:20, 189.49it/s] 61%|███████████████████████████████▊                    | 5960/9734 [00:33<00:19, 189.63it/s] 61%|███████████████████████████████▉                    | 5979/9734 [00:33<00:19, 189.71it/s] 62%|████████████████████████████████                    | 5998/9734 [00:33<00:19, 189.74it/s] 62%|████████████████████████████████▏                   | 6017/9734 [00:33<00:19, 189.70it/s] 62%|████████████████████████████████▏                   | 6036/9734 [00:33<00:19, 189.70it/s] 62%|████████████████████████████████▎                   | 6056/9734 [00:33<00:19, 189.88it/s] 62%|████████████████████████████████▍                   | 6075/9734 [00:33<00:19, 189.89it/s] 63%|████████████████████████████████▌                   | 6094/9734 [00:33<00:19, 188.44it/s] 63%|████████████████████████████████▋                   | 6113/9734 [00:34<00:19, 188.77it/s] 63%|████████████████████████████████▊                   | 6132/9734 [00:34<00:19, 188.98it/s] 63%|████████████████████████████████▊                   | 6151/9734 [00:34<00:18, 189.20it/s] 63%|████████████████████████████████▉                   | 6171/9734 [00:34<00:18, 189.53it/s] 64%|█████████████████████████████████                   | 6191/9734 [00:34<00:18, 189.81it/s] 64%|█████████████████████████████████▏                  | 6211/9734 [00:34<00:18, 189.94it/s] 64%|█████████████████████████████████▎                  | 6230/9734 [00:34<00:18, 189.78it/s] 64%|█████████████████████████████████▍                  | 6249/9734 [00:34<00:18, 189.73it/s] 64%|█████████████████████████████████▍                  | 6268/9734 [00:34<00:18, 189.78it/s] 65%|█████████████████████████████████▌                  | 6287/9734 [00:34<00:18, 189.65it/s] 65%|█████████████████████████████████▋                  | 6306/9734 [00:35<00:18, 189.69it/s] 65%|█████████████████████████████████▊                  | 6325/9734 [00:35<00:18, 188.23it/s] 65%|█████████████████████████████████▉                  | 6344/9734 [00:35<00:17, 188.73it/s] 65%|█████████████████████████████████▉                  | 6363/9734 [00:35<00:17, 189.03it/s] 66%|██████████████████████████████████                  | 6383/9734 [00:35<00:17, 189.43it/s] 66%|██████████████████████████████████▏                 | 6402/9734 [00:35<00:17, 189.59it/s] 66%|██████████████████████████████████▎                 | 6421/9734 [00:35<00:17, 189.68it/s] 66%|██████████████████████████████████▍                 | 6440/9734 [00:35<00:17, 189.73it/s] 66%|██████████████████████████████████▌                 | 6459/9734 [00:35<00:17, 189.60it/s] 67%|██████████████████████████████████▌                 | 6479/9734 [00:35<00:17, 189.82it/s] 67%|██████████████████████████████████▋                 | 6499/9734 [00:36<00:17, 190.02it/s] 67%|██████████████████████████████████▊                 | 6519/9734 [00:36<00:16, 189.82it/s] 67%|██████████████████████████████████▉                 | 6538/9734 [00:36<00:16, 188.07it/s] 67%|███████████████████████████████████                 | 6557/9734 [00:36<00:16, 188.44it/s] 68%|███████████████████████████████████▏                | 6576/9734 [00:36<00:16, 188.70it/s] 68%|███████████████████████████████████▏                | 6595/9734 [00:36<00:16, 188.97it/s] 68%|███████████████████████████████████▎                | 6614/9734 [00:36<00:16, 189.26it/s] 68%|███████████████████████████████████▍                | 6634/9734 [00:36<00:16, 189.57it/s] 68%|███████████████████████████████████▌                | 6654/9734 [00:36<00:16, 189.84it/s] 69%|███████████████████████████████████▋                | 6674/9734 [00:37<00:16, 189.90it/s] 69%|███████████████████████████████████▊                | 6693/9734 [00:37<00:16, 189.66it/s] 69%|███████████████████████████████████▊                | 6712/9734 [00:37<00:15, 189.45it/s] 69%|███████████████████████████████████▉                | 6731/9734 [00:37<00:15, 189.60it/s] 69%|████████████████████████████████████                | 6751/9734 [00:37<00:15, 189.81it/s] 70%|████████████████████████████████████▏               | 6770/9734 [00:37<00:15, 188.31it/s] 70%|████████████████████████████████████▎               | 6789/9734 [00:37<00:15, 188.78it/s] 70%|████████████████████████████████████▎               | 6809/9734 [00:37<00:15, 189.18it/s] 70%|████████████████████████████████████▍               | 6829/9734 [00:37<00:15, 189.46it/s] 70%|████████████████████████████████████▌               | 6848/9734 [00:37<00:15, 189.59it/s] 71%|████████████████████████████████████▋               | 6867/9734 [00:38<00:15, 189.64it/s] 71%|████████████████████████████████████▊               | 6886/9734 [00:38<00:15, 189.50it/s] 71%|████████████████████████████████████▉               | 6905/9734 [00:38<00:14, 189.55it/s] 71%|████████████████████████████████████▉               | 6925/9734 [00:38<00:14, 189.78it/s] 71%|█████████████████████████████████████               | 6945/9734 [00:38<00:14, 189.92it/s] 72%|█████████████████████████████████████▏              | 6964/9734 [00:38<00:14, 189.86it/s] 72%|█████████████████████████████████████▎              | 6984/9734 [00:38<00:14, 189.94it/s] 72%|█████████████████████████████████████▍              | 7003/9734 [00:38<00:14, 187.87it/s] 72%|█████████████████████████████████████▌              | 7022/9734 [00:38<00:14, 188.33it/s] 72%|█████████████████████████████████████▌              | 7041/9734 [00:38<00:14, 188.55it/s] 73%|█████████████████████████████████████▋              | 7060/9734 [00:39<00:14, 188.96it/s] 73%|█████████████████████████████████████▊              | 7080/9734 [00:39<00:14, 189.31it/s] 73%|█████████████████████████████████████▉              | 7100/9734 [00:39<00:13, 189.55it/s] 73%|██████████████████████████████████████              | 7119/9734 [00:39<00:13, 189.48it/s] 73%|██████████████████████████████████████▏             | 7138/9734 [00:39<00:13, 189.51it/s] 74%|██████████████████████████████████████▏             | 7157/9734 [00:39<00:13, 189.58it/s] 74%|██████████████████████████████████████▎             | 7176/9734 [00:39<00:13, 189.63it/s] 74%|██████████████████████████████████████▍             | 7196/9734 [00:39<00:13, 189.76it/s] 74%|██████████████████████████████████████▌             | 7215/9734 [00:39<00:13, 187.92it/s] 74%|██████████████████████████████████████▋             | 7234/9734 [00:39<00:13, 188.41it/s] 75%|██████████████████████████████████████▋             | 7253/9734 [00:40<00:13, 188.66it/s] 75%|██████████████████████████████████████▊             | 7272/9734 [00:40<00:13, 188.96it/s] 75%|██████████████████████████████████████▉             | 7292/9734 [00:40<00:12, 189.33it/s] 75%|███████████████████████████████████████             | 7311/9734 [00:40<00:12, 189.26it/s] 75%|███████████████████████████████████████▏            | 7330/9734 [00:40<00:12, 189.47it/s] 75%|███████████████████████████████████████▎            | 7349/9734 [00:40<00:12, 189.60it/s] 76%|███████████████████████████████████████▎            | 7368/9734 [00:40<00:12, 189.70it/s] 76%|███████████████████████████████████████▍            | 7387/9734 [00:40<00:12, 189.74it/s] 76%|███████████████████████████████████████▌            | 7406/9734 [00:40<00:12, 189.80it/s] 76%|███████████████████████████████████████▋            | 7426/9734 [00:40<00:12, 189.86it/s] 76%|███████████████████████████████████████▊            | 7445/9734 [00:41<00:13, 170.78it/s] 77%|███████████████████████████████████████▊            | 7464/9734 [00:41<00:12, 176.01it/s] 77%|███████████████████████████████████████▉            | 7483/9734 [00:41<00:12, 179.42it/s] 77%|████████████████████████████████████████            | 7502/9734 [00:41<00:12, 182.26it/s] 77%|████████████████████████████████████████▏           | 7521/9734 [00:41<00:12, 184.06it/s] 77%|████████████████████████████████████████▎           | 7540/9734 [00:41<00:11, 185.42it/s] 78%|████████████████████████████████████████▍           | 7559/9734 [00:41<00:11, 186.72it/s] 78%|████████████████████████████████████████▍           | 7578/9734 [00:41<00:11, 187.60it/s] 78%|████████████████████████████████████████▌           | 7597/9734 [00:41<00:11, 188.15it/s] 78%|████████████████████████████████████████▋           | 7616/9734 [00:42<00:11, 188.64it/s] 78%|████████████████████████████████████████▊           | 7635/9734 [00:42<00:11, 188.99it/s] 79%|████████████████████████████████████████▉           | 7654/9734 [00:42<00:10, 189.13it/s] 79%|████████████████████████████████████████▉           | 7673/9734 [00:42<00:10, 187.69it/s] 79%|█████████████████████████████████████████           | 7692/9734 [00:42<00:10, 188.13it/s] 79%|█████████████████████████████████████████▏          | 7711/9734 [00:42<00:10, 188.62it/s] 79%|█████████████████████████████████████████▎          | 7730/9734 [00:42<00:10, 188.99it/s] 80%|█████████████████████████████████████████▍          | 7749/9734 [00:42<00:10, 189.10it/s] 80%|█████████████████████████████████████████▍          | 7768/9734 [00:42<00:10, 189.30it/s] 80%|█████████████████████████████████████████▌          | 7787/9734 [00:42<00:10, 189.42it/s] 80%|█████████████████████████████████████████▋          | 7807/9734 [00:43<00:10, 189.64it/s] 80%|█████████████████████████████████████████▊          | 7826/9734 [00:43<00:10, 189.74it/s] 81%|█████████████████████████████████████████▉          | 7845/9734 [00:43<00:09, 189.72it/s] 81%|██████████████████████████████████████████          | 7864/9734 [00:43<00:09, 189.57it/s] 81%|██████████████████████████████████████████          | 7883/9734 [00:43<00:09, 189.60it/s] 81%|██████████████████████████████████████████▏         | 7902/9734 [00:43<00:09, 188.00it/s] 81%|██████████████████████████████████████████▎         | 7921/9734 [00:43<00:09, 188.57it/s] 82%|██████████████████████████████████████████▍         | 7940/9734 [00:43<00:09, 188.64it/s] 82%|██████████████████████████████████████████▌         | 7959/9734 [00:43<00:09, 188.97it/s] 82%|██████████████████████████████████████████▌         | 7978/9734 [00:43<00:09, 188.62it/s] 82%|██████████████████████████████████████████▋         | 7998/9734 [00:44<00:09, 189.07it/s] 82%|██████████████████████████████████████████▊         | 8017/9734 [00:44<00:09, 189.19it/s] 83%|██████████████████████████████████████████▉         | 8036/9734 [00:44<00:08, 189.24it/s] 83%|███████████████████████████████████████████         | 8055/9734 [00:44<00:08, 189.19it/s] 83%|███████████████████████████████████████████▏        | 8074/9734 [00:44<00:08, 189.35it/s] 83%|███████████████████████████████████████████▏        | 8094/9734 [00:44<00:08, 189.61it/s] 83%|███████████████████████████████████████████▎        | 8114/9734 [00:44<00:08, 189.83it/s] 84%|███████████████████████████████████████████▍        | 8133/9734 [00:44<00:08, 188.25it/s] 84%|███████████████████████████████████████████▌        | 8152/9734 [00:44<00:08, 188.72it/s] 84%|███████████████████████████████████████████▋        | 8171/9734 [00:44<00:08, 188.93it/s] 84%|███████████████████████████████████████████▊        | 8190/9734 [00:45<00:08, 188.88it/s] 84%|███████████████████████████████████████████▊        | 8209/9734 [00:45<00:08, 189.08it/s] 85%|███████████████████████████████████████████▉        | 8228/9734 [00:45<00:07, 189.28it/s] 85%|████████████████████████████████████████████        | 8247/9734 [00:45<00:07, 189.45it/s] 85%|████████████████████████████████████████████▏       | 8266/9734 [00:45<00:07, 189.55it/s] 85%|████████████████████████████████████████████▎       | 8285/9734 [00:45<00:07, 189.51it/s] 85%|████████████████████████████████████████████▎       | 8304/9734 [00:45<00:07, 189.44it/s] 86%|████████████████████████████████████████████▍       | 8324/9734 [00:45<00:07, 189.65it/s] 86%|████████████████████████████████████████████▌       | 8343/9734 [00:45<00:07, 189.40it/s] 86%|████████████████████████████████████████████▋       | 8362/9734 [00:45<00:07, 187.33it/s] 86%|████████████████████████████████████████████▊       | 8381/9734 [00:46<00:07, 187.98it/s] 86%|████████████████████████████████████████████▊       | 8400/9734 [00:46<00:07, 188.39it/s] 87%|████████████████████████████████████████████▉       | 8420/9734 [00:46<00:06, 188.94it/s] 87%|█████████████████████████████████████████████       | 8440/9734 [00:46<00:06, 189.28it/s] 87%|█████████████████████████████████████████████▏      | 8459/9734 [00:46<00:06, 189.40it/s] 87%|█████████████████████████████████████████████▎      | 8478/9734 [00:46<00:06, 189.32it/s] 87%|█████████████████████████████████████████████▍      | 8497/9734 [00:46<00:06, 189.23it/s] 87%|█████████████████████████████████████████████▍      | 8516/9734 [00:46<00:06, 189.36it/s] 88%|█████████████████████████████████████████████▌      | 8535/9734 [00:46<00:06, 189.38it/s] 88%|█████████████████████████████████████████████▋      | 8554/9734 [00:46<00:06, 189.47it/s] 88%|█████████████████████████████████████████████▊      | 8573/9734 [00:47<00:06, 189.50it/s] 88%|█████████████████████████████████████████████▉      | 8592/9734 [00:47<00:06, 187.93it/s] 88%|██████████████████████████████████████████████      | 8611/9734 [00:47<00:05, 188.28it/s] 89%|██████████████████████████████████████████████      | 8630/9734 [00:47<00:05, 188.46it/s] 89%|██████████████████████████████████████████████▏     | 8649/9734 [00:47<00:05, 188.68it/s] 89%|██████████████████████████████████████████████▎     | 8668/9734 [00:47<00:05, 188.84it/s] 89%|██████████████████████████████████████████████▍     | 8687/9734 [00:47<00:05, 189.18it/s] 89%|██████████████████████████████████████████████▌     | 8706/9734 [00:47<00:05, 189.41it/s] 90%|██████████████████████████████████████████████▌     | 8725/9734 [00:47<00:05, 189.53it/s] 90%|██████████████████████████████████████████████▋     | 8744/9734 [00:48<00:05, 189.49it/s] 90%|██████████████████████████████████████████████▊     | 8763/9734 [00:48<00:05, 189.51it/s] 90%|██████████████████████████████████████████████▉     | 8782/9734 [00:48<00:05, 188.08it/s] 90%|███████████████████████████████████████████████     | 8801/9734 [00:48<00:04, 188.34it/s] 91%|███████████████████████████████████████████████     | 8820/9734 [00:48<00:04, 187.02it/s] 91%|███████████████████████████████████████████████▏    | 8839/9734 [00:48<00:04, 187.63it/s] 91%|███████████████████████████████████████████████▎    | 8858/9734 [00:48<00:04, 188.11it/s] 91%|███████████████████████████████████████████████▍    | 8877/9734 [00:48<00:04, 188.63it/s] 91%|███████████████████████████████████████████████▌    | 8896/9734 [00:48<00:04, 188.99it/s] 92%|███████████████████████████████████████████████▌    | 8915/9734 [00:48<00:04, 189.06it/s] 92%|███████████████████████████████████████████████▋    | 8934/9734 [00:49<00:04, 189.17it/s] 92%|███████████████████████████████████████████████▊    | 8953/9734 [00:49<00:04, 189.29it/s] 92%|███████████████████████████████████████████████▉    | 8972/9734 [00:49<00:04, 189.19it/s] 92%|████████████████████████████████████████████████    | 8991/9734 [00:49<00:03, 189.29it/s] 93%|████████████████████████████████████████████████▏   | 9010/9734 [00:49<00:03, 189.41it/s] 93%|████████████████████████████████████████████████▏   | 9029/9734 [00:49<00:03, 189.53it/s] 93%|████████████████████████████████████████████████▎   | 9048/9734 [00:49<00:03, 187.30it/s] 93%|████████████████████████████████████████████████▍   | 9067/9734 [00:49<00:03, 187.92it/s] 93%|████████████████████████████████████████████████▌   | 9086/9734 [00:49<00:03, 188.29it/s] 94%|████████████████████████████████████████████████▋   | 9105/9734 [00:49<00:03, 188.65it/s] 94%|████████████████████████████████████████████████▋   | 9124/9734 [00:50<00:03, 188.70it/s] 94%|████████████████████████████████████████████████▊   | 9143/9734 [00:50<00:03, 188.95it/s] 94%|████████████████████████████████████████████████▉   | 9162/9734 [00:50<00:03, 189.15it/s] 94%|█████████████████████████████████████████████████   | 9181/9734 [00:50<00:02, 189.36it/s] 95%|█████████████████████████████████████████████████▏  | 9200/9734 [00:50<00:02, 187.10it/s] 95%|█████████████████████████████████████████████████▏  | 9219/9734 [00:50<00:02, 187.69it/s] 95%|█████████████████████████████████████████████████▎  | 9238/9734 [00:50<00:02, 188.20it/s] 95%|█████████████████████████████████████████████████▍  | 9257/9734 [00:50<00:02, 188.49it/s] 95%|█████████████████████████████████████████████████▌  | 9276/9734 [00:50<00:02, 185.99it/s] 95%|█████████████████████████████████████████████████▋  | 9295/9734 [00:50<00:02, 186.81it/s] 96%|█████████████████████████████████████████████████▊  | 9314/9734 [00:51<00:02, 187.62it/s] 96%|█████████████████████████████████████████████████▊  | 9333/9734 [00:51<00:02, 188.19it/s] 96%|█████████████████████████████████████████████████▉  | 9352/9734 [00:51<00:02, 188.41it/s] 96%|██████████████████████████████████████████████████  | 9371/9734 [00:51<00:01, 188.79it/s] 96%|██████████████████████████████████████████████████▏ | 9390/9734 [00:51<00:01, 189.07it/s] 97%|██████████████████████████████████████████████████▎ | 9409/9734 [00:51<00:01, 189.23it/s] 97%|██████████████████████████████████████████████████▎ | 9428/9734 [00:51<00:01, 189.13it/s] 97%|██████████████████████████████████████████████████▍ | 9447/9734 [00:51<00:01, 189.25it/s] 97%|██████████████████████████████████████████████████▌ | 9466/9734 [00:51<00:01, 189.28it/s] 97%|██████████████████████████████████████████████████▋ | 9485/9734 [00:51<00:01, 187.62it/s] 98%|██████████████████████████████████████████████████▊ | 9504/9734 [00:52<00:01, 188.04it/s] 98%|██████████████████████████████████████████████████▊ | 9523/9734 [00:52<00:01, 188.50it/s] 98%|██████████████████████████████████████████████████▉ | 9542/9734 [00:52<00:01, 188.76it/s] 98%|███████████████████████████████████████████████████ | 9561/9734 [00:52<00:00, 188.99it/s] 98%|███████████████████████████████████████████████████▏| 9580/9734 [00:52<00:00, 188.94it/s] 99%|███████████████████████████████████████████████████▎| 9599/9734 [00:52<00:00, 187.86it/s] 99%|███████████████████████████████████████████████████▍| 9618/9734 [00:52<00:00, 188.40it/s] 99%|███████████████████████████████████████████████████▍| 9637/9734 [00:52<00:00, 188.56it/s] 99%|███████████████████████████████████████████████████▌| 9656/9734 [00:52<00:00, 188.76it/s] 99%|███████████████████████████████████████████████████▋| 9675/9734 [00:52<00:00, 189.03it/s]100%|███████████████████████████████████████████████████▊| 9694/9734 [00:53<00:00, 189.14it/s]100%|███████████████████████████████████████████████████▉| 9713/9734 [00:53<00:00, 187.61it/s]100%|███████████████████████████████████████████████████▉| 9732/9734 [00:53<00:00, 187.83it/s]100%|████████████████████████████████████████████████████| 9734/9734 [00:53<00:00, 182.77it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.24s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.21s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:11,  5.52s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:11,  5.58s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.32s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.44s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.41s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:12<00:06,  6.29s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.71s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.87s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.74s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.93s/it]
[2023-08-21 15:14:33,308] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.75s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.91s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:18<00:00,  6.21s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:18<00:00,  6.16s/it]
[2023-08-21 15:14:49,005] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-21 15:14:49,006] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-21 15:14:49,006] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-21 15:14:49,006] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-21 15:14:49,006] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f7891664fd0>
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f785dde8cd0>
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-21 15:14:49,008] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.6408486366271973 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: 1. The question asks where you could find plumbing that would not be useful to you if you were thirsty.
2. This means we need to identify an option among A: oil refineries, B: wall, C: show, D: own home, E: water fountain where the plumbing would not be capable of supplying drinkable water.
3. We know that plumbing in our own home (D) and at a water fountain (E) would provide water for thirst, so we eliminate these options.
4. The plumbing within a wall (B) could potentially supply water if it's connected to a suitable source, so we can also remove this option.
5. A show (C) is a vague answer and may or may not have plumbing. However, if it has a plumbing system, it would more likely be connected to drinkable water supply eliminating this option too.
6. This leaves us with A: oil refineries. Oil refineries, while having an extensive network of pipes and plumbing, these are designed to transport oil, not drinkable water.
7. Therefore, the answer is A: oil refineries as it's the only place where the plumbing would not be of use if you were thirsty.
So the final answer is A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Output: 1. The question is asking what a person is not doing when they are just starting to work. 
2. The first option "working" is not correct since the person is obviously just beginning to work or is in the process of working.
3. Similarly, the fifth option "momentum" cannot fit as it implies being under motion or making progress, which the person may well be doing while starting to work.
4. While it's possible for some to consider "tiredness," as a right option assuming that the person wouldn't be tired just starting to work, the keyword here is "doing." "Tiredness" isn't an action; instead, it's a state. So, "tiredness" can't be the right answer.
5. The third option "resting" is also incorrect because if a person is beginning to work it implies they're not at rest. 
6. Thus, the only remaining option is "accomplishing," which makes sense since when a person is just beginning work, they have not accomplished anything just yet. 
7. Therefore, the answer is D: accomplishing.
So the final answer is D: accomplishing

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Output: 1. Start with the given question which is asking where you can find pens with a company logo. 
2. Company logo pens are usually used in places of business or organizations, where they may be given out to employees, clients or customers. 
3. These places want to have their branding on items such as pens, which are seen and used by many people. 
4. With this in mind, let's evaluate each of the given options.
5. Option B: Pens aren't usually found on pencils, and pencils are not likely to carry a company logo.
6. Option C: Writing sentences on paper doesn't relate to the location where you can find pens with a company logo.
7. Option D: Schools are more likely to have pens with school logos, not company logos.
8. Option E: A backpack could theoretically hold a pen with a company logo, but it's not a place where you primarily find them.
9. However, option A: Office, is strongly associated with companies and businesses, and it’s mostly in the office space that a person would come across pens with a company logo.
10. Therefore, the answer is A: office.
So the final answer is A: office

Input: Billy called out to John, and listened for what? Choices:  A: silence B: response C: communication D: hanging up E: whisper
Output: Step 1: Understand the context of the question. It is about communication between two people, where one person (Billy) initiates the contact.
 
Step 2: Evaluate the options. It mentions that Billy 'called out' implying he is seeking attention or an answer. When you communicate or 'call out' to someone else, you typically await their reply.

Step 3: Options A and E, silence and whisper, don't fit the context as Billy would be expecting clear communication after he called out. Option D, hanging up, is not suitable because it refers to ending a call on a phone, not initiating a conversation.

Step 4: Option C, communication, is close but too broad. Communication can refer to any exchange or transfer of information between people, not specifically a return message from John.

Step 5: Option B, response, is the best answer. It correctly defines what Billy would be waiting for after he called out to John - a reply or return communication from John. 

In conclusion, the answer is B: response.
So the final answer is B: response

Input: The lizard frightened the hiker, it's movements made what rustle? Choices:  A: garden B: trees C: books D: rocks E: bushes
Output: 1. The primary information provided in the question is that the lizard frightened the hiker through its movements that made some rustle.
2. To find the right answer, we need to pinpoint what the lizard's movements could have rustled. We need something that can rustle or make a rustling sound.
3. Let's go through the options one by one. 
4. Option A is garden. However, a garden itself cannot rustle, various elements within it might, but it's not specific enough. This does not seem to fit the given situation.
5. Next is Option B, trees. Trees do make rustle-like noises when the wind blows through their leaves, but usually, they are not low enough to the ground for a lizard to rustle.
6. Then we have Option C, books. It is very unlikely for a lizard to rustle books as they are typically indoors and lizards are mostly found outside. So option C is out.
7. Option D, rocks, cannot rustle as they are solid and non-flexible objects.
8. Finally, Option E is bushes. Bushes contain leaves that could easily rustle with the slightest touch or when wind passes through them. And more importantly, a lizard, being a creature that usually stays on the ground, could easily create a rustle by moving through them.
9. Therefore, putting together all the information and reasoning, we find that the answer is E: bushes.
So the final answer is E: bushes

Input: The man spent big money and time maintaining his lawn, it was part of keeping up with the Joneses where? Choices:  A: front yard B: suburbia C: neighborhood D: back yard E: golf course
Output: 1. The phrase "keeping up with the Joneses" refers to the comparison to one's neighbor as a benchmark for social class or the accumulation of material goods.
2. This phrase is often used in the context of appearances and the social status related to where one lives.
3. Therefore, the answer should be a place where neighbors could see and compare such material displays.
4. Although options A, C, D, and E are all plausible locations for a lawn to be maintained, option B, the suburbia encompasses the whole neighborhood where 'keeping up with the Joneses' is an essential part.
5. This means that'suburbia' is the most appropriate answer, as it covers a greater area where this social comparison can occur.
6. Hence, the answer is B: suburbia.
So the final answer is B: suburbia

Input: What would a human do if they want to get to a store that he or she can see? Choices:  A: cross road B: see around C: drink coffee D: dream dreams E: think critically
Output: The question gives a scenario where a person can see the store they want to reach.

This implies a physical distance between the person and the store that needs to be covered.

Among the options provided, option B: seeing around, may be a part of the process, but it wouldn't necessarily help the person get closer to the store.

Option C: Drinking coffee, Option D: Dreaming dreams, and Option E: Thinking critically
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i7-s1-rTrue
Loading extension module utils...
Time to load utils op: 0.503293514251709 seconds
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.6038291454315186 seconds
Time to load utils op: 0.5048162937164307 seconds
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:41<34:16, 41.96s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:23<33:12, 41.50s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [02:04<32:24, 41.38s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [02:45<31:39, 41.28s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [03:26<30:59, 41.33s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [04:08<30:19, 41.35s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [04:49<29:38, 41.35s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [05:31<28:56, 41.35s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [06:12<28:15, 41.35s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [06:53<27:34, 41.35s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [07:35<26:54, 41.40s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [08:16<26:12, 41.37s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [08:58<25:31, 41.40s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [09:39<24:51, 41.43s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [10:20<24:07, 41.36s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [11:02<23:25, 41.35s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [11:43<22:44, 41.35s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [12:24<22:03, 41.35s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [13:05<21:21, 41.32s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [13:47<20:40, 41.34s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [14:28<19:58, 41.33s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [15:09<19:17, 41.32s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [15:51<18:35, 41.31s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [16:32<17:54, 41.33s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [17:14<17:15, 41.40s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [17:55<16:33, 41.38s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [18:36<15:52, 41.40s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [19:18<15:11, 41.44s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [20:00<14:31, 41.48s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [20:41<13:49, 41.46s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [21:22<13:06, 41.41s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [22:04<12:25, 41.40s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [22:45<11:44, 41.44s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [23:12<09:54, 37.14s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [23:32<07:58, 31.89s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [24:13<08:06, 34.71s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [24:55<07:57, 36.71s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [25:36<07:36, 38.07s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [26:17<07:09, 39.03s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [26:58<06:37, 39.70s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [27:40<06:01, 40.18s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [28:21<05:24, 40.52s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [29:02<04:45, 40.75s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [29:44<04:05, 40.91s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [30:25<03:24, 40.98s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [31:06<02:44, 41.06s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [31:47<02:03, 41.16s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [32:29<01:22, 41.22s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [33:10<00:41, 41.24s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [33:51<00:00, 41.25s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [33:51<00:00, 40.64s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 0.8013} | lm_loss 12.3303 | avg. gen lenth: 359.136
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i8-s1-rTrue --seed 1 --max-prompt-length 2048 --rationales --num-in-domain 8
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-21 15:49:21,251] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i8-s1-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 8
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i8-s1-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9733 [00:00<?, ?it/s]  0%|                                                      | 12/9733 [00:00<01:24, 114.85it/s]  0%|▏                                                     | 24/9733 [00:00<01:24, 115.21it/s]  0%|▏                                                     | 36/9733 [00:00<01:24, 115.36it/s]  0%|▎                                                     | 48/9733 [00:00<01:23, 115.54it/s]  1%|▎                                                     | 60/9733 [00:00<01:23, 115.84it/s]  1%|▍                                                     | 72/9733 [00:00<01:24, 113.90it/s]  1%|▍                                                     | 84/9733 [00:00<01:24, 114.67it/s]  1%|▌                                                     | 96/9733 [00:00<01:23, 115.23it/s]  1%|▌                                                    | 108/9733 [00:00<01:23, 115.51it/s]  1%|▋                                                    | 120/9733 [00:01<01:23, 115.78it/s]  1%|▋                                                    | 132/9733 [00:01<01:22, 116.12it/s]  1%|▊                                                    | 144/9733 [00:01<01:22, 116.25it/s]  2%|▊                                                    | 156/9733 [00:01<01:22, 116.55it/s]  2%|▉                                                    | 168/9733 [00:01<01:22, 116.47it/s]  2%|▉                                                    | 180/9733 [00:01<01:22, 116.34it/s]  2%|█                                                    | 192/9733 [00:01<01:23, 114.43it/s]  2%|█                                                    | 204/9733 [00:01<01:24, 112.73it/s]  2%|█▏                                                   | 216/9733 [00:01<01:23, 113.92it/s]  2%|█▏                                                   | 228/9733 [00:01<01:22, 114.85it/s]  2%|█▎                                                   | 240/9733 [00:02<01:22, 115.37it/s]  3%|█▎                                                   | 252/9733 [00:02<01:21, 115.63it/s]  3%|█▍                                                   | 265/9733 [00:02<01:20, 117.87it/s]  3%|█▌                                                   | 283/9733 [00:02<01:09, 135.56it/s]  3%|█▋                                                   | 301/9733 [00:02<01:03, 148.05it/s]  3%|█▋                                                   | 319/9733 [00:02<01:00, 156.56it/s]  3%|█▊                                                   | 337/9733 [00:02<00:57, 162.44it/s]  4%|█▉                                                   | 355/9733 [00:02<00:56, 167.04it/s]  4%|██                                                   | 373/9733 [00:02<00:54, 170.34it/s]  4%|██▏                                                  | 391/9733 [00:03<00:54, 172.69it/s]  4%|██▏                                                  | 409/9733 [00:03<00:53, 174.21it/s]  4%|██▎                                                  | 427/9733 [00:03<00:53, 175.26it/s]  5%|██▍                                                  | 445/9733 [00:03<00:53, 174.73it/s]  5%|██▌                                                  | 463/9733 [00:03<00:52, 175.80it/s]  5%|██▌                                                  | 481/9733 [00:03<00:52, 176.23it/s]  5%|██▋                                                  | 499/9733 [00:03<00:52, 176.66it/s]  5%|██▊                                                  | 517/9733 [00:03<00:52, 176.96it/s]  5%|██▉                                                  | 535/9733 [00:03<00:51, 177.00it/s]  6%|███                                                  | 553/9733 [00:03<00:51, 177.26it/s]  6%|███                                                  | 571/9733 [00:04<00:51, 177.16it/s]  6%|███▏                                                 | 589/9733 [00:04<00:51, 177.37it/s]  6%|███▎                                                 | 607/9733 [00:04<00:51, 177.14it/s]  6%|███▍                                                 | 625/9733 [00:04<00:51, 177.25it/s]  7%|███▌                                                 | 643/9733 [00:04<00:51, 177.44it/s]  7%|███▌                                                 | 661/9733 [00:04<00:51, 176.08it/s]  7%|███▋                                                 | 679/9733 [00:04<00:51, 176.28it/s]  7%|███▊                                                 | 697/9733 [00:04<00:51, 176.99it/s]  7%|███▉                                                 | 715/9733 [00:04<00:50, 177.01it/s]  8%|███▉                                                 | 733/9733 [00:04<00:50, 177.18it/s]  8%|████                                                 | 751/9733 [00:05<00:50, 177.30it/s]  8%|████▏                                                | 769/9733 [00:05<00:50, 177.45it/s]  8%|████▎                                                | 787/9733 [00:05<00:50, 177.71it/s]  8%|████▍                                                | 805/9733 [00:05<00:50, 177.67it/s]  8%|████▍                                                | 823/9733 [00:05<00:50, 177.67it/s]  9%|████▌                                                | 841/9733 [00:05<00:50, 176.57it/s]  9%|████▋                                                | 859/9733 [00:05<00:50, 176.53it/s]  9%|████▊                                                | 877/9733 [00:05<00:50, 176.88it/s]  9%|████▊                                                | 895/9733 [00:05<00:50, 175.59it/s]  9%|████▉                                                | 913/9733 [00:05<00:50, 176.12it/s] 10%|█████                                                | 931/9733 [00:06<00:49, 176.60it/s] 10%|█████▏                                               | 949/9733 [00:06<00:49, 176.89it/s] 10%|█████▎                                               | 967/9733 [00:06<00:49, 177.04it/s] 10%|█████▎                                               | 985/9733 [00:06<00:49, 177.26it/s] 10%|█████▎                                              | 1003/9733 [00:06<00:49, 177.25it/s] 10%|█████▍                                              | 1021/9733 [00:06<00:49, 177.26it/s] 11%|█████▌                                              | 1039/9733 [00:06<00:49, 177.40it/s] 11%|█████▋                                              | 1057/9733 [00:06<00:48, 177.41it/s] 11%|█████▋                                              | 1075/9733 [00:06<00:49, 175.79it/s] 11%|█████▊                                              | 1093/9733 [00:06<00:49, 176.11it/s] 11%|█████▉                                              | 1111/9733 [00:07<00:49, 173.67it/s] 12%|██████                                              | 1129/9733 [00:07<00:49, 174.69it/s] 12%|██████▏                                             | 1147/9733 [00:07<00:49, 174.76it/s] 12%|██████▏                                             | 1165/9733 [00:07<00:48, 175.22it/s] 12%|██████▎                                             | 1183/9733 [00:07<00:48, 175.72it/s] 12%|██████▍                                             | 1201/9733 [00:07<00:48, 175.49it/s] 13%|██████▌                                             | 1219/9733 [00:07<00:48, 175.21it/s] 13%|██████▌                                             | 1237/9733 [00:07<00:48, 175.90it/s] 13%|██████▋                                             | 1255/9733 [00:07<00:47, 176.64it/s] 13%|██████▊                                             | 1273/9733 [00:07<00:47, 176.93it/s] 13%|██████▉                                             | 1291/9733 [00:08<00:47, 176.92it/s] 13%|██████▉                                             | 1309/9733 [00:08<00:47, 176.98it/s] 14%|███████                                             | 1327/9733 [00:08<00:47, 177.07it/s] 14%|███████▏                                            | 1345/9733 [00:08<00:47, 175.50it/s] 14%|███████▎                                            | 1363/9733 [00:08<00:47, 175.82it/s] 14%|███████▍                                            | 1381/9733 [00:08<00:47, 175.85it/s] 14%|███████▍                                            | 1399/9733 [00:08<00:47, 176.34it/s] 15%|███████▌                                            | 1417/9733 [00:08<00:47, 176.72it/s] 15%|███████▋                                            | 1435/9733 [00:08<00:46, 176.97it/s] 15%|███████▊                                            | 1453/9733 [00:09<00:46, 177.35it/s] 15%|███████▊                                            | 1471/9733 [00:09<00:46, 177.17it/s] 15%|███████▉                                            | 1489/9733 [00:09<00:46, 177.26it/s] 15%|████████                                            | 1507/9733 [00:09<00:46, 176.96it/s] 16%|████████▏                                           | 1525/9733 [00:09<00:46, 177.04it/s] 16%|████████▏                                           | 1543/9733 [00:09<00:46, 177.16it/s] 16%|████████▎                                           | 1561/9733 [00:09<00:46, 177.45it/s] 16%|████████▍                                           | 1579/9733 [00:09<00:46, 175.76it/s] 16%|████████▌                                           | 1597/9733 [00:09<00:46, 176.23it/s] 17%|████████▋                                           | 1615/9733 [00:09<00:46, 176.42it/s] 17%|████████▋                                           | 1633/9733 [00:10<00:45, 176.78it/s] 17%|████████▊                                           | 1651/9733 [00:10<00:45, 177.13it/s] 17%|████████▉                                           | 1669/9733 [00:10<00:45, 177.23it/s] 17%|█████████                                           | 1687/9733 [00:10<00:47, 170.29it/s] 18%|█████████                                           | 1705/9733 [00:10<00:46, 172.55it/s] 18%|█████████▏                                          | 1723/9733 [00:10<00:46, 174.02it/s] 18%|█████████▎                                          | 1741/9733 [00:10<00:45, 175.08it/s] 18%|█████████▍                                          | 1759/9733 [00:10<00:45, 175.50it/s] 18%|█████████▍                                          | 1777/9733 [00:10<00:45, 175.78it/s] 18%|█████████▌                                          | 1795/9733 [00:10<00:50, 158.24it/s] 19%|█████████▋                                          | 1813/9733 [00:11<00:48, 163.38it/s] 19%|█████████▊                                          | 1831/9733 [00:11<00:47, 167.26it/s] 19%|█████████▉                                          | 1849/9733 [00:11<00:46, 169.97it/s] 19%|█████████▉                                          | 1867/9733 [00:11<00:45, 172.15it/s] 19%|██████████                                          | 1885/9733 [00:11<00:45, 173.24it/s] 20%|██████████▏                                         | 1903/9733 [00:11<00:44, 174.14it/s] 20%|██████████▎                                         | 1921/9733 [00:11<00:44, 174.76it/s] 20%|██████████▎                                         | 1939/9733 [00:11<00:44, 175.23it/s] 20%|██████████▍                                         | 1957/9733 [00:11<00:44, 175.73it/s] 20%|██████████▌                                         | 1975/9733 [00:12<00:44, 176.20it/s] 20%|██████████▋                                         | 1993/9733 [00:12<00:43, 176.65it/s] 21%|██████████▋                                         | 2011/9733 [00:12<00:43, 176.79it/s] 21%|██████████▊                                         | 2029/9733 [00:12<00:43, 175.17it/s] 21%|██████████▉                                         | 2047/9733 [00:12<00:43, 175.62it/s] 21%|███████████                                         | 2065/9733 [00:12<00:43, 176.00it/s] 21%|███████████▏                                        | 2083/9733 [00:12<00:43, 176.11it/s] 22%|███████████▏                                        | 2101/9733 [00:12<00:43, 176.38it/s] 22%|███████████▎                                        | 2119/9733 [00:12<00:43, 176.27it/s] 22%|███████████▍                                        | 2137/9733 [00:12<00:43, 176.29it/s] 22%|███████████▌                                        | 2155/9733 [00:13<00:43, 174.82it/s] 22%|███████████▌                                        | 2173/9733 [00:13<00:43, 174.86it/s] 23%|███████████▋                                        | 2191/9733 [00:13<00:43, 175.30it/s] 23%|███████████▊                                        | 2209/9733 [00:13<00:42, 175.82it/s] 23%|███████████▉                                        | 2227/9733 [00:13<00:42, 175.54it/s] 23%|███████████▉                                        | 2245/9733 [00:13<00:43, 173.13it/s] 23%|████████████                                        | 2263/9733 [00:13<00:43, 173.61it/s] 23%|████████████▏                                       | 2281/9733 [00:13<00:42, 173.67it/s] 24%|████████████▎                                       | 2299/9733 [00:13<00:42, 174.68it/s] 24%|████████████▍                                       | 2317/9733 [00:13<00:42, 175.04it/s] 24%|████████████▍                                       | 2335/9733 [00:14<00:42, 175.73it/s] 24%|████████████▌                                       | 2353/9733 [00:14<00:41, 176.10it/s] 24%|████████████▋                                       | 2371/9733 [00:14<00:41, 176.35it/s] 25%|████████████▊                                       | 2389/9733 [00:14<00:41, 176.48it/s] 25%|████████████▊                                       | 2407/9733 [00:14<00:41, 176.69it/s] 25%|████████████▉                                       | 2425/9733 [00:14<00:41, 176.54it/s] 25%|█████████████                                       | 2443/9733 [00:14<00:41, 175.57it/s] 25%|█████████████▏                                      | 2461/9733 [00:14<00:41, 175.28it/s] 25%|█████████████▏                                      | 2479/9733 [00:14<00:41, 174.16it/s] 26%|█████████████▎                                      | 2497/9733 [00:14<00:41, 174.89it/s] 26%|█████████████▍                                      | 2515/9733 [00:15<00:41, 175.44it/s] 26%|█████████████▌                                      | 2533/9733 [00:15<00:40, 175.91it/s] 26%|█████████████▋                                      | 2551/9733 [00:15<00:40, 176.09it/s] 26%|█████████████▋                                      | 2569/9733 [00:15<00:40, 176.24it/s] 27%|█████████████▊                                      | 2587/9733 [00:15<00:40, 176.68it/s] 27%|█████████████▉                                      | 2605/9733 [00:15<00:40, 176.64it/s] 27%|██████████████                                      | 2623/9733 [00:15<00:40, 176.34it/s] 27%|██████████████                                      | 2641/9733 [00:15<00:40, 176.12it/s] 27%|██████████████▏                                     | 2659/9733 [00:15<00:40, 176.14it/s] 28%|██████████████▎                                     | 2677/9733 [00:16<00:40, 176.02it/s] 28%|██████████████▍                                     | 2695/9733 [00:16<00:40, 175.46it/s] 28%|██████████████▍                                     | 2713/9733 [00:16<00:40, 173.73it/s] 28%|██████████████▌                                     | 2731/9733 [00:16<00:40, 174.56it/s] 28%|██████████████▋                                     | 2749/9733 [00:16<00:39, 175.34it/s] 28%|██████████████▊                                     | 2767/9733 [00:16<00:39, 175.90it/s] 29%|██████████████▉                                     | 2785/9733 [00:16<00:39, 176.21it/s] 29%|██████████████▉                                     | 2803/9733 [00:16<00:39, 176.46it/s] 29%|███████████████                                     | 2821/9733 [00:16<00:39, 176.42it/s] 29%|███████████████▏                                    | 2839/9733 [00:16<00:39, 176.49it/s] 29%|███████████████▎                                    | 2857/9733 [00:17<00:38, 176.54it/s] 30%|███████████████▎                                    | 2875/9733 [00:17<00:38, 176.55it/s] 30%|███████████████▍                                    | 2893/9733 [00:17<00:38, 176.51it/s] 30%|███████████████▌                                    | 2911/9733 [00:17<00:38, 176.46it/s] 30%|███████████████▋                                    | 2929/9733 [00:17<00:38, 174.82it/s] 30%|███████████████▋                                    | 2947/9733 [00:17<00:38, 175.18it/s] 30%|███████████████▊                                    | 2965/9733 [00:17<00:38, 174.92it/s] 31%|███████████████▉                                    | 2983/9733 [00:17<00:38, 174.11it/s] 31%|████████████████                                    | 3001/9733 [00:17<00:38, 174.18it/s] 31%|████████████████▏                                   | 3019/9733 [00:17<00:38, 174.83it/s] 31%|████████████████▏                                   | 3037/9733 [00:18<00:38, 175.07it/s] 31%|████████████████▎                                   | 3055/9733 [00:18<00:38, 175.39it/s] 32%|████████████████▍                                   | 3073/9733 [00:18<00:38, 174.63it/s] 32%|████████████████▌                                   | 3091/9733 [00:18<00:38, 174.36it/s] 32%|████████████████▌                                   | 3109/9733 [00:18<00:37, 174.94it/s] 32%|████████████████▋                                   | 3127/9733 [00:18<00:37, 175.07it/s] 32%|████████████████▊                                   | 3145/9733 [00:18<00:37, 174.22it/s] 32%|████████████████▉                                   | 3163/9733 [00:18<00:37, 173.01it/s] 33%|████████████████▉                                   | 3181/9733 [00:18<00:37, 173.31it/s] 33%|█████████████████                                   | 3199/9733 [00:18<00:37, 173.82it/s] 33%|█████████████████▏                                  | 3217/9733 [00:19<00:37, 174.05it/s] 33%|█████████████████▎                                  | 3235/9733 [00:19<00:37, 175.16it/s] 33%|█████████████████▍                                  | 3253/9733 [00:19<00:36, 175.86it/s] 34%|█████████████████▍                                  | 3271/9733 [00:19<00:36, 175.75it/s] 34%|█████████████████▌                                  | 3289/9733 [00:19<00:36, 175.45it/s] 34%|█████████████████▋                                  | 3307/9733 [00:19<00:36, 174.91it/s] 34%|█████████████████▊                                  | 3325/9733 [00:19<00:36, 173.84it/s] 34%|█████████████████▊                                  | 3343/9733 [00:19<00:36, 173.31it/s] 35%|█████████████████▉                                  | 3361/9733 [00:19<00:36, 172.92it/s] 35%|██████████████████                                  | 3379/9733 [00:20<00:36, 172.58it/s] 35%|██████████████████▏                                 | 3397/9733 [00:20<00:37, 171.03it/s] 35%|██████████████████▏                                 | 3415/9733 [00:20<00:36, 171.55it/s] 35%|██████████████████▎                                 | 3433/9733 [00:20<00:36, 172.62it/s] 35%|██████████████████▍                                 | 3451/9733 [00:20<00:36, 173.57it/s] 36%|██████████████████▌                                 | 3469/9733 [00:20<00:35, 174.36it/s] 36%|██████████████████▋                                 | 3487/9733 [00:20<00:35, 174.14it/s] 36%|██████████████████▋                                 | 3505/9733 [00:20<00:35, 174.72it/s] 36%|██████████████████▊                                 | 3523/9733 [00:20<00:35, 175.37it/s] 36%|██████████████████▉                                 | 3541/9733 [00:20<00:35, 175.64it/s] 37%|███████████████████                                 | 3559/9733 [00:21<00:35, 175.79it/s] 37%|███████████████████                                 | 3577/9733 [00:21<00:34, 176.10it/s] 37%|███████████████████▏                                | 3595/9733 [00:21<00:34, 176.15it/s] 37%|███████████████████▎                                | 3613/9733 [00:21<00:35, 174.64it/s] 37%|███████████████████▍                                | 3631/9733 [00:21<00:34, 175.20it/s] 37%|███████████████████▍                                | 3649/9733 [00:21<00:34, 175.45it/s] 38%|███████████████████▌                                | 3667/9733 [00:21<00:34, 175.60it/s] 38%|███████████████████▋                                | 3685/9733 [00:21<00:34, 176.02it/s] 38%|███████████████████▊                                | 3703/9733 [00:21<00:34, 176.36it/s] 38%|███████████████████▉                                | 3721/9733 [00:21<00:34, 176.42it/s] 38%|███████████████████▉                                | 3739/9733 [00:22<00:33, 176.48it/s] 39%|████████████████████                                | 3757/9733 [00:22<00:33, 176.38it/s] 39%|████████████████████▏                               | 3775/9733 [00:22<00:33, 175.45it/s] 39%|████████████████████▎                               | 3793/9733 [00:22<00:33, 175.71it/s] 39%|████████████████████▎                               | 3811/9733 [00:22<00:33, 175.68it/s] 39%|████████████████████▍                               | 3829/9733 [00:22<00:33, 175.97it/s] 40%|████████████████████▌                               | 3847/9733 [00:22<00:33, 174.68it/s] 40%|████████████████████▋                               | 3865/9733 [00:22<00:33, 175.13it/s] 40%|████████████████████▋                               | 3883/9733 [00:22<00:33, 175.21it/s] 40%|████████████████████▊                               | 3901/9733 [00:23<00:33, 175.39it/s] 40%|████████████████████▉                               | 3919/9733 [00:23<00:33, 175.35it/s] 40%|█████████████████████                               | 3937/9733 [00:23<00:33, 175.38it/s] 41%|█████████████████████▏                              | 3955/9733 [00:23<00:32, 175.32it/s] 41%|█████████████████████▏                              | 3973/9733 [00:23<00:32, 175.16it/s] 41%|█████████████████████▎                              | 3991/9733 [00:23<00:32, 175.17it/s] 41%|█████████████████████▍                              | 4009/9733 [00:23<00:32, 175.23it/s] 41%|█████████████████████▌                              | 4027/9733 [00:23<00:32, 174.98it/s] 42%|█████████████████████▌                              | 4045/9733 [00:23<00:32, 173.75it/s] 42%|█████████████████████▋                              | 4063/9733 [00:23<00:32, 172.58it/s] 42%|█████████████████████▊                              | 4081/9733 [00:24<00:32, 173.31it/s] 42%|█████████████████████▉                              | 4099/9733 [00:24<00:32, 173.83it/s] 42%|█████████████████████▉                              | 4117/9733 [00:24<00:32, 174.19it/s] 42%|██████████████████████                              | 4135/9733 [00:24<00:32, 174.77it/s] 43%|██████████████████████▏                             | 4153/9733 [00:24<00:31, 175.52it/s] 43%|██████████████████████▎                             | 4171/9733 [00:24<00:31, 175.95it/s] 43%|██████████████████████▍                             | 4189/9733 [00:24<00:31, 176.35it/s] 43%|██████████████████████▍                             | 4207/9733 [00:24<00:31, 176.57it/s] 43%|██████████████████████▌                             | 4225/9733 [00:24<00:31, 176.70it/s] 44%|██████████████████████▋                             | 4243/9733 [00:24<00:31, 176.83it/s] 44%|██████████████████████▊                             | 4261/9733 [00:25<00:30, 177.02it/s] 44%|██████████████████████▊                             | 4279/9733 [00:25<00:30, 177.13it/s] 44%|██████████████████████▉                             | 4297/9733 [00:25<00:30, 175.55it/s] 44%|███████████████████████                             | 4315/9733 [00:25<00:31, 174.76it/s] 45%|███████████████████████▏                            | 4333/9733 [00:25<00:30, 175.41it/s] 45%|███████████████████████▏                            | 4351/9733 [00:25<00:30, 175.74it/s] 45%|███████████████████████▎                            | 4369/9733 [00:25<00:30, 176.03it/s] 45%|███████████████████████▍                            | 4387/9733 [00:25<00:30, 176.28it/s] 45%|███████████████████████▌                            | 4405/9733 [00:25<00:30, 176.49it/s] 45%|███████████████████████▋                            | 4423/9733 [00:25<00:30, 176.59it/s] 46%|███████████████████████▋                            | 4441/9733 [00:26<00:29, 176.67it/s] 46%|███████████████████████▊                            | 4459/9733 [00:26<00:29, 176.82it/s] 46%|███████████████████████▉                            | 4477/9733 [00:26<00:29, 176.75it/s] 46%|████████████████████████                            | 4495/9733 [00:26<00:29, 176.81it/s] 46%|████████████████████████                            | 4513/9733 [00:26<00:29, 176.69it/s] 47%|████████████████████████▏                           | 4531/9733 [00:26<00:33, 156.52it/s] 47%|████████████████████████▎                           | 4549/9733 [00:26<00:31, 162.08it/s] 47%|████████████████████████▍                           | 4567/9733 [00:26<00:31, 166.13it/s] 47%|████████████████████████▍                           | 4585/9733 [00:26<00:30, 168.14it/s] 47%|████████████████████████▌                           | 4603/9733 [00:27<00:30, 170.71it/s] 47%|████████████████████████▋                           | 4621/9733 [00:27<00:29, 172.52it/s] 48%|████████████████████████▊                           | 4639/9733 [00:27<00:29, 173.84it/s] 48%|████████████████████████▉                           | 4657/9733 [00:27<00:29, 174.61it/s] 48%|████████████████████████▉                           | 4675/9733 [00:27<00:28, 175.36it/s] 48%|█████████████████████████                           | 4693/9733 [00:27<00:28, 175.79it/s] 48%|█████████████████████████▏                          | 4711/9733 [00:27<00:28, 175.88it/s] 49%|█████████████████████████▎                          | 4729/9733 [00:27<00:28, 175.69it/s] 49%|█████████████████████████▎                          | 4747/9733 [00:28<00:42, 117.82it/s] 49%|█████████████████████████▍                          | 4765/9733 [00:28<00:38, 130.41it/s] 49%|█████████████████████████▌                          | 4783/9733 [00:28<00:35, 141.35it/s] 49%|█████████████████████████▋                          | 4801/9733 [00:28<00:32, 150.25it/s] 50%|█████████████████████████▋                          | 4819/9733 [00:28<00:31, 157.16it/s] 50%|█████████████████████████▊                          | 4837/9733 [00:28<00:30, 161.41it/s] 50%|█████████████████████████▉                          | 4855/9733 [00:28<00:29, 165.57it/s] 50%|██████████████████████████                          | 4873/9733 [00:28<00:28, 168.43it/s] 50%|██████████████████████████▏                         | 4891/9733 [00:28<00:28, 170.77it/s] 50%|██████████████████████████▏                         | 4909/9733 [00:28<00:28, 172.17it/s] 51%|██████████████████████████▎                         | 4927/9733 [00:29<00:27, 173.39it/s] 51%|██████████████████████████▍                         | 4945/9733 [00:29<00:27, 174.19it/s] 51%|██████████████████████████▌                         | 4963/9733 [00:29<00:27, 173.49it/s] 51%|██████████████████████████▌                         | 4981/9733 [00:29<00:27, 174.24it/s] 51%|██████████████████████████▋                         | 4999/9733 [00:29<00:27, 174.90it/s] 52%|██████████████████████████▊                         | 5017/9733 [00:29<00:26, 175.29it/s] 52%|██████████████████████████▉                         | 5035/9733 [00:29<00:26, 175.73it/s] 52%|██████████████████████████▉                         | 5053/9733 [00:29<00:26, 175.85it/s] 52%|███████████████████████████                         | 5071/9733 [00:29<00:26, 176.02it/s] 52%|███████████████████████████▏                        | 5089/9733 [00:29<00:26, 176.01it/s] 52%|███████████████████████████▎                        | 5107/9733 [00:30<00:26, 174.95it/s] 53%|███████████████████████████▍                        | 5125/9733 [00:30<00:26, 175.26it/s] 53%|███████████████████████████▍                        | 5143/9733 [00:30<00:26, 175.50it/s] 53%|███████████████████████████▌                        | 5161/9733 [00:30<00:26, 175.48it/s] 53%|███████████████████████████▋                        | 5179/9733 [00:30<00:26, 173.17it/s] 53%|███████████████████████████▊                        | 5197/9733 [00:30<00:26, 173.80it/s] 54%|███████████████████████████▊                        | 5215/9733 [00:30<00:25, 174.47it/s] 54%|███████████████████████████▉                        | 5233/9733 [00:30<00:25, 174.94it/s] 54%|████████████████████████████                        | 5251/9733 [00:30<00:25, 175.45it/s] 54%|████████████████████████████▏                       | 5269/9733 [00:31<00:25, 175.64it/s] 54%|████████████████████████████▏                       | 5287/9733 [00:31<00:25, 175.79it/s] 55%|████████████████████████████▎                       | 5305/9733 [00:31<00:25, 175.90it/s] 55%|████████████████████████████▍                       | 5323/9733 [00:31<00:25, 176.00it/s] 55%|████████████████████████████▌                       | 5341/9733 [00:31<00:24, 175.87it/s] 55%|████████████████████████████▋                       | 5359/9733 [00:31<00:24, 175.75it/s] 55%|████████████████████████████▋                       | 5377/9733 [00:31<00:25, 174.19it/s] 55%|████████████████████████████▊                       | 5395/9733 [00:31<00:24, 174.70it/s] 56%|████████████████████████████▉                       | 5413/9733 [00:31<00:24, 173.75it/s] 56%|█████████████████████████████                       | 5431/9733 [00:31<00:24, 174.36it/s] 56%|█████████████████████████████                       | 5449/9733 [00:32<00:24, 174.80it/s] 56%|█████████████████████████████▏                      | 5467/9733 [00:32<00:24, 174.80it/s] 56%|█████████████████████████████▎                      | 5485/9733 [00:32<00:24, 175.83it/s] 57%|█████████████████████████████▍                      | 5503/9733 [00:32<00:23, 176.85it/s] 57%|█████████████████████████████▍                      | 5521/9733 [00:32<00:23, 177.63it/s] 57%|█████████████████████████████▌                      | 5539/9733 [00:32<00:23, 178.20it/s] 57%|█████████████████████████████▋                      | 5558/9733 [00:32<00:23, 178.85it/s] 57%|█████████████████████████████▊                      | 5576/9733 [00:32<00:23, 179.12it/s] 57%|█████████████████████████████▉                      | 5594/9733 [00:32<00:23, 179.27it/s] 58%|█████████████████████████████▉                      | 5612/9733 [00:32<00:22, 179.33it/s] 58%|██████████████████████████████                      | 5630/9733 [00:33<00:23, 177.82it/s] 58%|██████████████████████████████▏                     | 5648/9733 [00:33<00:22, 178.30it/s] 58%|██████████████████████████████▎                     | 5666/9733 [00:33<00:22, 177.89it/s] 58%|██████████████████████████████▎                     | 5684/9733 [00:33<00:22, 178.47it/s] 59%|██████████████████████████████▍                     | 5703/9733 [00:33<00:22, 179.08it/s] 59%|██████████████████████████████▌                     | 5722/9733 [00:33<00:22, 179.51it/s] 59%|██████████████████████████████▋                     | 5741/9733 [00:33<00:22, 179.77it/s] 59%|██████████████████████████████▊                     | 5760/9733 [00:33<00:22, 179.86it/s] 59%|██████████████████████████████▉                     | 5779/9733 [00:33<00:21, 179.98it/s] 60%|██████████████████████████████▉                     | 5798/9733 [00:33<00:21, 180.05it/s] 60%|███████████████████████████████                     | 5817/9733 [00:34<00:21, 180.14it/s] 60%|███████████████████████████████▏                    | 5836/9733 [00:34<00:21, 180.10it/s] 60%|███████████████████████████████▎                    | 5855/9733 [00:34<00:21, 178.81it/s] 60%|███████████████████████████████▍                    | 5874/9733 [00:34<00:21, 179.36it/s] 61%|███████████████████████████████▍                    | 5892/9733 [00:34<00:21, 179.52it/s] 61%|███████████████████████████████▌                    | 5911/9733 [00:34<00:21, 179.75it/s] 61%|███████████████████████████████▋                    | 5929/9733 [00:34<00:21, 179.82it/s] 61%|███████████████████████████████▊                    | 5947/9733 [00:34<00:21, 179.85it/s] 61%|███████████████████████████████▊                    | 5966/9733 [00:34<00:20, 179.91it/s] 61%|███████████████████████████████▉                    | 5984/9733 [00:35<00:20, 179.84it/s] 62%|████████████████████████████████                    | 6002/9733 [00:35<00:20, 178.92it/s] 62%|████████████████████████████████▏                   | 6020/9733 [00:35<00:20, 179.18it/s] 62%|████████████████████████████████▎                   | 6039/9733 [00:35<00:20, 179.44it/s] 62%|████████████████████████████████▎                   | 6057/9733 [00:35<00:20, 179.60it/s] 62%|████████████████████████████████▍                   | 6075/9733 [00:35<00:20, 179.49it/s] 63%|████████████████████████████████▌                   | 6093/9733 [00:35<00:20, 178.01it/s] 63%|████████████████████████████████▋                   | 6111/9733 [00:35<00:20, 178.45it/s] 63%|████████████████████████████████▋                   | 6129/9733 [00:35<00:20, 178.73it/s] 63%|████████████████████████████████▊                   | 6147/9733 [00:35<00:20, 178.99it/s] 63%|████████████████████████████████▉                   | 6165/9733 [00:36<00:19, 179.23it/s] 64%|█████████████████████████████████                   | 6183/9733 [00:36<00:19, 179.41it/s] 64%|█████████████████████████████████▏                  | 6201/9733 [00:36<00:19, 179.54it/s] 64%|█████████████████████████████████▏                  | 6219/9733 [00:36<00:19, 179.50it/s] 64%|█████████████████████████████████▎                  | 6237/9733 [00:36<00:19, 179.39it/s] 64%|█████████████████████████████████▍                  | 6255/9733 [00:36<00:19, 179.41it/s] 64%|█████████████████████████████████▌                  | 6273/9733 [00:36<00:19, 179.56it/s] 65%|█████████████████████████████████▌                  | 6291/9733 [00:36<00:19, 179.67it/s] 65%|█████████████████████████████████▋                  | 6309/9733 [00:36<00:19, 178.15it/s] 65%|█████████████████████████████████▊                  | 6327/9733 [00:36<00:19, 178.42it/s] 65%|█████████████████████████████████▉                  | 6345/9733 [00:37<00:18, 178.82it/s] 65%|██████████████████████████████████                  | 6364/9733 [00:37<00:18, 179.22it/s] 66%|██████████████████████████████████                  | 6383/9733 [00:37<00:18, 179.59it/s] 66%|██████████████████████████████████▏                 | 6402/9733 [00:37<00:18, 179.85it/s] 66%|██████████████████████████████████▎                 | 6421/9733 [00:37<00:18, 180.04it/s] 66%|██████████████████████████████████▍                 | 6440/9733 [00:37<00:18, 180.15it/s] 66%|██████████████████████████████████▌                 | 6459/9733 [00:37<00:18, 180.01it/s] 67%|██████████████████████████████████▌                 | 6478/9733 [00:37<00:18, 180.11it/s] 67%|██████████████████████████████████▋                 | 6497/9733 [00:37<00:17, 180.11it/s] 67%|██████████████████████████████████▊                 | 6516/9733 [00:37<00:17, 179.70it/s] 67%|██████████████████████████████████▉                 | 6534/9733 [00:38<00:17, 178.25it/s] 67%|███████████████████████████████████                 | 6552/9733 [00:38<00:17, 178.61it/s] 68%|███████████████████████████████████                 | 6570/9733 [00:38<00:17, 178.90it/s] 68%|███████████████████████████████████▏                | 6588/9733 [00:38<00:17, 179.12it/s] 68%|███████████████████████████████████▎                | 6606/9733 [00:38<00:17, 179.32it/s] 68%|███████████████████████████████████▍                | 6625/9733 [00:38<00:17, 179.61it/s] 68%|███████████████████████████████████▍                | 6644/9733 [00:38<00:17, 179.77it/s] 68%|███████████████████████████████████▌                | 6663/9733 [00:38<00:17, 179.92it/s] 69%|███████████████████████████████████▋                | 6681/9733 [00:38<00:16, 179.66it/s] 69%|███████████████████████████████████▊                | 6699/9733 [00:39<00:16, 179.51it/s] 69%|███████████████████████████████████▉                | 6718/9733 [00:39<00:16, 179.74it/s] 69%|███████████████████████████████████▉                | 6736/9733 [00:39<00:16, 179.79it/s] 69%|████████████████████████████████████                | 6755/9733 [00:39<00:16, 179.87it/s] 70%|████████████████████████████████████▏               | 6773/9733 [00:39<00:16, 178.38it/s] 70%|████████████████████████████████████▎               | 6792/9733 [00:39<00:16, 178.89it/s] 70%|████████████████████████████████████▍               | 6811/9733 [00:39<00:16, 179.28it/s] 70%|████████████████████████████████████▍               | 6830/9733 [00:39<00:16, 179.50it/s] 70%|████████████████████████████████████▌               | 6848/9733 [00:39<00:16, 179.55it/s] 71%|████████████████████████████████████▋               | 6867/9733 [00:39<00:15, 179.73it/s] 71%|████████████████████████████████████▊               | 6885/9733 [00:40<00:15, 179.69it/s] 71%|████████████████████████████████████▉               | 6903/9733 [00:40<00:15, 179.77it/s] 71%|████████████████████████████████████▉               | 6922/9733 [00:40<00:15, 179.93it/s] 71%|█████████████████████████████████████               | 6941/9733 [00:40<00:15, 179.96it/s] 72%|█████████████████████████████████████▏              | 6960/9733 [00:40<00:15, 180.01it/s] 72%|█████████████████████████████████████▎              | 6979/9733 [00:40<00:15, 179.99it/s] 72%|█████████████████████████████████████▍              | 6997/9733 [00:40<00:15, 178.30it/s] 72%|█████████████████████████████████████▍              | 7015/9733 [00:40<00:15, 178.64it/s] 72%|█████████████████████████████████████▌              | 7034/9733 [00:40<00:15, 179.11it/s] 72%|█████████████████████████████████████▋              | 7053/9733 [00:40<00:14, 179.44it/s] 73%|█████████████████████████████████████▊              | 7071/9733 [00:41<00:14, 179.56it/s] 73%|█████████████████████████████████████▊              | 7089/9733 [00:41<00:14, 179.68it/s] 73%|█████████████████████████████████████▉              | 7108/9733 [00:41<00:14, 179.80it/s] 73%|██████████████████████████████████████              | 7127/9733 [00:41<00:14, 179.89it/s] 73%|██████████████████████████████████████▏             | 7146/9733 [00:41<00:14, 179.91it/s] 74%|██████████████████████████████████████▎             | 7164/9733 [00:41<00:14, 179.85it/s] 74%|██████████████████████████████████████▎             | 7182/9733 [00:41<00:14, 179.89it/s] 74%|██████████████████████████████████████▍             | 7201/9733 [00:41<00:14, 179.93it/s] 74%|██████████████████████████████████████▌             | 7219/9733 [00:41<00:14, 178.50it/s] 74%|██████████████████████████████████████▋             | 7238/9733 [00:42<00:13, 179.08it/s] 75%|██████████████████████████████████████▊             | 7257/9733 [00:42<00:13, 179.57it/s] 75%|██████████████████████████████████████▊             | 7276/9733 [00:42<00:13, 179.84it/s] 75%|██████████████████████████████████████▉             | 7295/9733 [00:42<00:13, 180.10it/s] 75%|███████████████████████████████████████             | 7314/9733 [00:42<00:13, 180.12it/s] 75%|███████████████████████████████████████▏            | 7333/9733 [00:42<00:13, 180.21it/s] 76%|███████████████████████████████████████▎            | 7352/9733 [00:42<00:13, 180.38it/s] 76%|███████████████████████████████████████▍            | 7371/9733 [00:42<00:13, 180.52it/s] 76%|███████████████████████████████████████▍            | 7390/9733 [00:42<00:12, 180.50it/s] 76%|███████████████████████████████████████▌            | 7409/9733 [00:42<00:12, 180.45it/s] 76%|███████████████████████████████████████▋            | 7428/9733 [00:43<00:12, 180.47it/s] 77%|███████████████████████████████████████▊            | 7447/9733 [00:43<00:14, 162.13it/s] 77%|███████████████████████████████████████▉            | 7465/9733 [00:43<00:13, 166.89it/s] 77%|███████████████████████████████████████▉            | 7483/9733 [00:43<00:13, 170.36it/s] 77%|████████████████████████████████████████            | 7501/9733 [00:43<00:12, 172.91it/s] 77%|████████████████████████████████████████▏           | 7519/9733 [00:43<00:12, 174.87it/s] 77%|████████████████████████████████████████▎           | 7537/9733 [00:43<00:12, 176.29it/s] 78%|████████████████████████████████████████▎           | 7555/9733 [00:43<00:12, 177.35it/s] 78%|████████████████████████████████████████▍           | 7574/9733 [00:43<00:12, 178.17it/s] 78%|████████████████████████████████████████▌           | 7592/9733 [00:44<00:11, 178.64it/s] 78%|████████████████████████████████████████▋           | 7611/9733 [00:44<00:11, 179.09it/s] 78%|████████████████████████████████████████▊           | 7629/9733 [00:44<00:11, 179.19it/s] 79%|████████████████████████████████████████▊           | 7647/9733 [00:44<00:11, 179.29it/s] 79%|████████████████████████████████████████▉           | 7665/9733 [00:44<00:11, 179.40it/s] 79%|█████████████████████████████████████████           | 7683/9733 [00:44<00:11, 177.74it/s] 79%|█████████████████████████████████████████▏          | 7702/9733 [00:44<00:11, 178.45it/s] 79%|█████████████████████████████████████████▎          | 7721/9733 [00:44<00:11, 178.99it/s] 80%|█████████████████████████████████████████▎          | 7740/9733 [00:44<00:11, 179.40it/s] 80%|█████████████████████████████████████████▍          | 7758/9733 [00:44<00:11, 179.50it/s] 80%|█████████████████████████████████████████▌          | 7776/9733 [00:45<00:10, 179.53it/s] 80%|█████████████████████████████████████████▋          | 7794/9733 [00:45<00:10, 179.66it/s] 80%|█████████████████████████████████████████▋          | 7812/9733 [00:45<00:10, 179.74it/s] 80%|█████████████████████████████████████████▊          | 7831/9733 [00:45<00:10, 179.88it/s] 81%|█████████████████████████████████████████▉          | 7850/9733 [00:45<00:10, 179.97it/s] 81%|██████████████████████████████████████████          | 7869/9733 [00:45<00:10, 180.12it/s] 81%|██████████████████████████████████████████▏         | 7888/9733 [00:45<00:10, 180.27it/s] 81%|██████████████████████████████████████████▏         | 7907/9733 [00:45<00:10, 179.16it/s] 81%|██████████████████████████████████████████▎         | 7926/9733 [00:45<00:10, 179.44it/s] 82%|██████████████████████████████████████████▍         | 7945/9733 [00:45<00:09, 179.70it/s] 82%|██████████████████████████████████████████▌         | 7964/9733 [00:46<00:09, 179.98it/s] 82%|██████████████████████████████████████████▋         | 7983/9733 [00:46<00:09, 180.09it/s] 82%|██████████████████████████████████████████▊         | 8002/9733 [00:46<00:09, 180.16it/s] 82%|██████████████████████████████████████████▊         | 8021/9733 [00:46<00:09, 180.13it/s] 83%|██████████████████████████████████████████▉         | 8040/9733 [00:46<00:09, 180.20it/s] 83%|███████████████████████████████████████████         | 8059/9733 [00:46<00:09, 180.23it/s] 83%|███████████████████████████████████████████▏        | 8078/9733 [00:46<00:09, 180.30it/s] 83%|███████████████████████████████████████████▎        | 8097/9733 [00:46<00:09, 180.46it/s] 83%|███████████████████████████████████████████▎        | 8116/9733 [00:46<00:08, 180.67it/s] 84%|███████████████████████████████████████████▍        | 8135/9733 [00:47<00:08, 179.33it/s] 84%|███████████████████████████████████████████▌        | 8154/9733 [00:47<00:08, 179.66it/s] 84%|███████████████████████████████████████████▋        | 8173/9733 [00:47<00:08, 179.84it/s] 84%|███████████████████████████████████████████▊        | 8192/9733 [00:47<00:08, 180.10it/s] 84%|███████████████████████████████████████████▊        | 8211/9733 [00:47<00:08, 180.19it/s] 85%|███████████████████████████████████████████▉        | 8230/9733 [00:47<00:08, 179.12it/s] 85%|████████████████████████████████████████████        | 8249/9733 [00:47<00:08, 179.60it/s] 85%|████████████████████████████████████████████▏       | 8268/9733 [00:47<00:08, 179.81it/s] 85%|████████████████████████████████████████████▎       | 8287/9733 [00:47<00:08, 179.90it/s] 85%|████████████████████████████████████████████▍       | 8306/9733 [00:47<00:07, 180.10it/s] 86%|████████████████████████████████████████████▍       | 8325/9733 [00:48<00:07, 180.29it/s] 86%|████████████████████████████████████████████▌       | 8344/9733 [00:48<00:07, 180.11it/s] 86%|████████████████████████████████████████████▋       | 8363/9733 [00:48<00:07, 178.81it/s] 86%|████████████████████████████████████████████▊       | 8382/9733 [00:48<00:07, 179.32it/s] 86%|████████████████████████████████████████████▉       | 8401/9733 [00:48<00:07, 179.70it/s] 87%|████████████████████████████████████████████▉       | 8420/9733 [00:48<00:07, 180.04it/s] 87%|█████████████████████████████████████████████       | 8439/9733 [00:48<00:07, 180.23it/s] 87%|█████████████████████████████████████████████▏      | 8458/9733 [00:48<00:07, 180.25it/s] 87%|█████████████████████████████████████████████▎      | 8477/9733 [00:48<00:06, 180.21it/s] 87%|█████████████████████████████████████████████▍      | 8496/9733 [00:49<00:06, 180.29it/s] 87%|█████████████████████████████████████████████▍      | 8515/9733 [00:49<00:06, 180.30it/s] 88%|█████████████████████████████████████████████▌      | 8534/9733 [00:49<00:06, 180.27it/s] 88%|█████████████████████████████████████████████▋      | 8553/9733 [00:49<00:06, 180.28it/s] 88%|█████████████████████████████████████████████▊      | 8572/9733 [00:49<00:06, 180.32it/s] 88%|█████████████████████████████████████████████▉      | 8591/9733 [00:49<00:06, 179.11it/s] 88%|██████████████████████████████████████████████      | 8610/9733 [00:49<00:06, 179.42it/s] 89%|██████████████████████████████████████████████      | 8629/9733 [00:49<00:06, 179.75it/s] 89%|██████████████████████████████████████████████▏     | 8648/9733 [00:49<00:06, 179.82it/s] 89%|██████████████████████████████████████████████▎     | 8666/9733 [00:49<00:05, 179.83it/s] 89%|██████████████████████████████████████████████▍     | 8684/9733 [00:50<00:05, 179.83it/s] 89%|██████████████████████████████████████████████▍     | 8703/9733 [00:50<00:05, 179.98it/s] 90%|██████████████████████████████████████████████▌     | 8722/9733 [00:50<00:05, 180.10it/s] 90%|██████████████████████████████████████████████▋     | 8741/9733 [00:50<00:05, 180.15it/s] 90%|██████████████████████████████████████████████▊     | 8760/9733 [00:50<00:05, 180.10it/s] 90%|██████████████████████████████████████████████▉     | 8779/9733 [00:50<00:05, 180.14it/s] 90%|███████████████████████████████████████████████     | 8798/9733 [00:50<00:05, 180.11it/s] 91%|███████████████████████████████████████████████     | 8817/9733 [00:50<00:05, 178.56it/s] 91%|███████████████████████████████████████████████▏    | 8836/9733 [00:50<00:05, 179.00it/s] 91%|███████████████████████████████████████████████▎    | 8855/9733 [00:51<00:04, 179.37it/s] 91%|███████████████████████████████████████████████▍    | 8874/9733 [00:51<00:04, 179.73it/s] 91%|███████████████████████████████████████████████▌    | 8893/9733 [00:51<00:04, 179.94it/s] 92%|███████████████████████████████████████████████▌    | 8912/9733 [00:51<00:04, 180.16it/s] 92%|███████████████████████████████████████████████▋    | 8931/9733 [00:51<00:04, 180.12it/s] 92%|███████████████████████████████████████████████▊    | 8950/9733 [00:51<00:04, 180.16it/s] 92%|███████████████████████████████████████████████▉    | 8969/9733 [00:51<00:04, 180.10it/s] 92%|████████████████████████████████████████████████    | 8988/9733 [00:51<00:04, 180.18it/s] 93%|████████████████████████████████████████████████    | 9007/9733 [00:51<00:04, 180.21it/s] 93%|████████████████████████████████████████████████▏   | 9026/9733 [00:51<00:03, 180.00it/s] 93%|████████████████████████████████████████████████▎   | 9044/9733 [00:52<00:03, 178.61it/s] 93%|████████████████████████████████████████████████▍   | 9063/9733 [00:52<00:03, 179.19it/s] 93%|████████████████████████████████████████████████▌   | 9082/9733 [00:52<00:03, 179.47it/s] 94%|████████████████████████████████████████████████▌   | 9101/9733 [00:52<00:03, 179.76it/s] 94%|████████████████████████████████████████████████▋   | 9119/9733 [00:52<00:03, 179.81it/s] 94%|████████████████████████████████████████████████▊   | 9138/9733 [00:52<00:03, 179.99it/s] 94%|████████████████████████████████████████████████▉   | 9157/9733 [00:52<00:03, 180.01it/s] 94%|█████████████████████████████████████████████████   | 9176/9733 [00:52<00:03, 180.18it/s] 94%|█████████████████████████████████████████████████▏  | 9195/9733 [00:52<00:02, 180.25it/s] 95%|█████████████████████████████████████████████████▏  | 9214/9733 [00:53<00:02, 180.21it/s] 95%|█████████████████████████████████████████████████▎  | 9233/9733 [00:53<00:02, 180.27it/s] 95%|█████████████████████████████████████████████████▍  | 9252/9733 [00:53<00:02, 180.26it/s] 95%|█████████████████████████████████████████████████▌  | 9271/9733 [00:53<00:02, 178.69it/s] 95%|█████████████████████████████████████████████████▋  | 9290/9733 [00:53<00:02, 179.16it/s] 96%|█████████████████████████████████████████████████▋  | 9309/9733 [00:53<00:02, 179.55it/s] 96%|█████████████████████████████████████████████████▊  | 9328/9733 [00:53<00:02, 179.85it/s] 96%|█████████████████████████████████████████████████▉  | 9347/9733 [00:53<00:02, 179.93it/s] 96%|██████████████████████████████████████████████████  | 9365/9733 [00:53<00:02, 179.51it/s] 96%|██████████████████████████████████████████████████▏ | 9384/9733 [00:53<00:01, 179.70it/s] 97%|██████████████████████████████████████████████████▏ | 9403/9733 [00:54<00:01, 179.77it/s] 97%|██████████████████████████████████████████████████▎ | 9422/9733 [00:54<00:01, 179.90it/s] 97%|██████████████████████████████████████████████████▍ | 9440/9733 [00:54<00:01, 179.92it/s] 97%|██████████████████████████████████████████████████▌ | 9459/9733 [00:54<00:01, 180.04it/s] 97%|██████████████████████████████████████████████████▋ | 9478/9733 [00:54<00:01, 180.11it/s] 98%|██████████████████████████████████████████████████▋ | 9497/9733 [00:54<00:01, 178.63it/s] 98%|██████████████████████████████████████████████████▊ | 9516/9733 [00:54<00:01, 179.10it/s] 98%|██████████████████████████████████████████████████▉ | 9534/9733 [00:54<00:01, 179.28it/s] 98%|███████████████████████████████████████████████████ | 9552/9733 [00:54<00:01, 179.40it/s] 98%|███████████████████████████████████████████████████▏| 9570/9733 [00:55<00:00, 179.56it/s] 99%|███████████████████████████████████████████████████▏| 9588/9733 [00:55<00:00, 179.62it/s] 99%|███████████████████████████████████████████████████▎| 9607/9733 [00:55<00:00, 179.74it/s] 99%|███████████████████████████████████████████████████▍| 9625/9733 [00:55<00:00, 179.79it/s] 99%|███████████████████████████████████████████████████▌| 9643/9733 [00:55<00:00, 179.70it/s] 99%|███████████████████████████████████████████████████▌| 9662/9733 [00:55<00:00, 179.93it/s] 99%|███████████████████████████████████████████████████▋| 9681/9733 [00:55<00:00, 179.93it/s]100%|███████████████████████████████████████████████████▊| 9699/9733 [00:55<00:00, 178.53it/s]100%|███████████████████████████████████████████████████▉| 9717/9733 [00:55<00:00, 175.91it/s]100%|████████████████████████████████████████████████████| 9733/9733 [00:55<00:00, 174.01it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:04<00:09,  4.88s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:04<00:09,  4.97s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.42s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.37s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:09<00:04,  4.94s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.08s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.45s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.38s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.41s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.55s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.48s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.63s/it]
[2023-08-21 15:51:09,017] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.80s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.98s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.74s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.91s/it]
[2023-08-21 15:51:18,160] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-21 15:51:18,162] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-21 15:51:18,162] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-21 15:51:18,162] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-21 15:51:18,162] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-21 15:51:18,162] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-21 15:51:18,163] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-21 15:51:18,163] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-21 15:51:18,163] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-21 15:51:18,163] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-21 15:51:18,163] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-21 15:51:18,163] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f530e796fd0>
[2023-08-21 15:51:18,163] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-21 15:51:18,163] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-21 15:51:18,163] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-21 15:51:18,163] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-21 15:51:18,163] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f52da2e1cd0>
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-21 15:51:18,166] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.573643684387207 seconds
torch.Size([5, 2048])
torch.Size([5, 8])
torch.Size([5, 2055])
Loading extension module utils...
Time to load utils op: 0.40465211868286133 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: 1. The question is asking where you would find plumbing that would not be helpful if you were thirsty, meaning the plumbing would not provide drinkable water. 
2. Choice B - a wall wouldn't typically have any plumbing, so that choice doesn't make sense. 
3. Choice C - is not specific enough, as it doesn't even refer to a place, thus it can be eliminated.
4. Choice D - own home would likely have drinkable water, so that option doesn't make sense either.
5. Choice E - a water fountain is specifically designed to provide drinkable water, so this can't be the correct answer.
6. That leaves us with choice A - an oil refinery. This is a place where plumbing is used, but the pipelines carry oil, not water.
7. So, the correct response is A: oil refineries. This is a place where you could find plumbing (in the form of oil pipelines) but drinking the oil from these pipes when you're thirsty isn't possible or safe.
So the final answer is A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Output: 1. The question asks "What aren't they doing yet when a person is beginning work?"
2. Let's analyze each of the choices:

   - A: Working - incorrect, since the person is beginning work, so they are doing this.
 
   - B: Resting - incorrect, it's not related to starting work. One can rest before or after work.
   
   - C: Tiredness - incorrect, tiredness is a state and not an action. Plus it could happen during or after work.
   
   - D: Accomplishing - correct, as this is something which hasn't happened yet when a person is beginning to work. It's the result of completed work.
   
   - E: Momentum - incorrect, momentum implies motion or progress which can be a part of work process but not an outcome.

3. Therefore, the answer is D: Accomplishing.
So the final answer is D: accomplishing

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Output: 1. The question is asking where one might find pens with a company logo.
2. A company logo is typically seen on company property or items that represent a certain company. 
3. Option B: On a pencil is incorrect because pencils and pens are two different types of stationery and they are not a place to find anything.
4. Option C: Write sentences on paper is not a place, rather it's a process you could do with a pen.
5. Option D: School is plausible; however, pens with company logos are less likely to be found in Schools as schools typically use generic or school-branded pens.
6. Option E: Backpack can be a possible place but it doesn't directly imply the presence of company logo pens.
7. Option A: Is an office, typically, companies will have pens with their logo in their office for employees, visitors, or clients to use. This makes it the most probable place to find pens with a company logo.
8. Therefore, the answer is A: office.
So the final answer is A: office

Input: Billy called out to John, and listened for what? Choices:  A: silence B: response C: communication D: hanging up E: whisper
Output: 1. The question provides a scenario in which Billy is calling out to John.
2. The key here is to understand what Billy is expecting after he calls out.
3. When we call out to someone, it's generally implied that we are expecting an answer or a'response' from them. This is an interpretation based on common social conventions.
4. Checking the given options for what goes with this scenario, "response" seems to fit the context most appropriately as it signifies something in return to Billy's call out.
5. Option A, silence, would mean that Billy is expecting no return. This doesn't typically fit the context when someone calls out.
6. Option C, communication, although not entirely incorrect, it's important to note that the communication has already begun when Billy called out. He's now waiting for John's part.
7. Option D, hanging up, and option E, whisper, don't apply to the situation described, as they are more suited to phone call scenarios or situations requiring secrecy respectively.
8. Based on these reasonings, the most appropriate answer would be B: response.
So the final answer is B: response

Input: The lizard frightened the hiker, it's movements made what rustle? Choices:  A: garden B: trees C: books D: rocks E: bushes
Output: 1. The question is asking us to identify what a lizard, in its movement, would make rustle that could frighten a hiker.
2. We can eliminate choice A: garden, as it's too broad; a lizard can't make an entire garden rustle.
3. We also eliminate option C: books because typically, lizards and hikers would not be interacting in a place where books are present.
4. Consider choice D: rocks. Rocks do not rustle, hence it can't be the correct answer.
5. Looking at choice B: trees, this could be a plausible answer. However, lizards contain mostly ground-dwelling species and are likely too small and light to create a rustling sound in a tree.
6. We're left with choice E: bushes. Bushes could reasonably rustle with the movement of a lizard, especially if it was moving quickly.
7. Therefore, the most fitting answer is E: bushes.
So the final answer is E: bushes

Input: The man spent big money and time maintaining his lawn, it was part of keeping up with the Joneses where? Choices:  A: front yard B: suburbia C: neighborhood D: back yard E: golf course
Output: 1. The phrase "keeping up with the Joneses" is a figure of speech that originates from the suburbs. 
2. It is used to describe the phenomenon of using your neighbors as a standard for comparison and always trying to outdo or compete with them, especially in terms of material possessions. 
3. The context clues that help us in solving this question are "man spent big money and time maintaining his lawn" and "keeping up with the Joneses"; both are quite relevant to the suburban lifestyle and competition. 
4. Although options C 'neighborhood' and A 'front yard' might seem plausible, they could apply to urban or rural environments as well, not exclusively to suburban ones, therefore making them too broad. 
5. Option D 'back yard' doesn't accurately reflect the competition aspect of the expression as backyards are typically private venture, and E 'golf course' is not relevant to the scenario described. 
6. Therefore, the answer that best fits the question is B:'suburbia'.
So the final answer is B: suburbia

Input: What would a human do if they want to get to a store that he or she can see? Choices:  A: cross road B: see around C: drink coffee D: dream dreams E: think critically
Output: 1. The objective is for the person to reach a store he or she can already see.
2. Getting to the store involves some form of movement or action on the person's part.
3. Looking at the given choices, options B: see around, C: drink coffee, D: dream dreams, and E: think critically do not involve immediate physical movement towards the store.
4. The only choice that involves the person physically moving towards the store is A: cross road.
5. Therefore, the answer is A: cross road.
So the final answer is A: cross road

Input: Where would you grab an object contained by a doorway? Choices:  A: television B: control panel C: opening doors D: doorknob E: doorway
Output: 1. The question asks where you would grab an object contained by a doorway. 
2. This word 'contained by' implies that the object must be within the structure of the doorway instead of being an independent object that could be located elsewhere.
3. While a television (A), control panel (B), opening doors (C
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i8-s1-rTrue
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
Loading extension module utils...
Time to load utils op: 0.6050422191619873 seconds
Loading extension module utils...
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
Time to load utils op: 0.504812479019165 seconds
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 8])
torch.Size([5, 2055])
torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:41<34:10, 41.85s/it]torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:22<33:01, 41.29s/it]torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 8])
torch.Size([5, 2055])
torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
Evaluating commonsenseqa :   6%|█▊                             | 3/50 [02:03<32:12, 41.11s/it]torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
Evaluating commonsenseqa :   8%|██▍                            | 4/50 [02:44<31:28, 41.05s/it]torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
