PYTHONPATH=/home/ylu130/workspace/in-context-generalization
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i0-s1-rTrue --seed 1 --max-prompt-length 2048 --rationales --num-in-domain 0
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date![nltk_data]   Package punkt is already up-to-date!

[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-21 11:42:39,283] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i0-s1-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i0-s1-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9741 [00:00<?, ?it/s]  4%|██▎                                                 | 429/9741 [00:00<00:02, 4283.35it/s]  9%|████▌                                               | 866/9741 [00:00<00:02, 4331.34it/s] 13%|██████▊                                            | 1303/9741 [00:00<00:01, 4343.70it/s] 18%|█████████                                          | 1738/9741 [00:00<00:01, 4334.85it/s] 22%|███████████▎                                       | 2172/9741 [00:00<00:01, 4284.39it/s] 27%|█████████████▌                                     | 2601/9741 [00:00<00:01, 4160.18it/s] 31%|███████████████▊                                   | 3024/9741 [00:00<00:01, 4181.76it/s] 35%|██████████████████                                 | 3454/9741 [00:00<00:01, 4217.65it/s] 40%|████████████████████▎                              | 3881/9741 [00:00<00:01, 4232.04it/s] 44%|██████████████████████▌                            | 4311/9741 [00:01<00:01, 4250.10it/s] 49%|████████████████████████▊                          | 4737/9741 [00:01<00:01, 4231.50it/s] 53%|███████████████████████████                        | 5161/9741 [00:01<00:01, 2749.23it/s] 57%|█████████████████████████████▎                     | 5592/9741 [00:01<00:01, 3090.15it/s] 62%|███████████████████████████████▋                   | 6045/9741 [00:01<00:01, 3431.27it/s] 67%|█████████████████████████████████▉                 | 6488/9741 [00:01<00:00, 3684.07it/s] 71%|████████████████████████████████████▎              | 6936/9741 [00:01<00:00, 3895.25it/s] 76%|██████████████████████████████████████▋            | 7392/9741 [00:01<00:00, 4076.29it/s] 80%|█████████████████████████████████████████          | 7841/9741 [00:01<00:00, 4190.85it/s] 85%|███████████████████████████████████████████▌       | 8309/9741 [00:02<00:00, 4329.93it/s] 90%|█████████████████████████████████████████████▉     | 8774/9741 [00:02<00:00, 4422.83it/s] 95%|████████████████████████████████████████████████▎  | 9239/9741 [00:02<00:00, 4487.01it/s]100%|██████████████████████████████████████████████████▉| 9724/9741 [00:02<00:00, 4593.93it/s]100%|███████████████████████████████████████████████████| 9741/9741 [00:02<00:00, 4061.21it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:04<00:09,  4.82s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:11,  5.51s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.48s/it]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:09<00:04,  4.96s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.38s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.34s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.26s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.38s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.53s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.75s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.93s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.71s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.89s/it]
[2023-08-21 11:43:33,836] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.23s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.65s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.81s/it]
[2023-08-21 11:43:47,306] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-21 11:43:47,307] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-21 11:43:47,307] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-21 11:43:47,308] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-21 11:43:47,308] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-21 11:43:47,308] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-21 11:43:47,308] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-21 11:43:47,308] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-21 11:43:47,308] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-21 11:43:47,308] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-21 11:43:47,308] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-21 11:43:47,308] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f42d7637f40>
[2023-08-21 11:43:47,308] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-21 11:43:47,308] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-21 11:43:47,308] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-21 11:43:47,308] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-21 11:43:47,308] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-21 11:43:47,308] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-21 11:43:47,308] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-21 11:43:47,308] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-21 11:43:47,308] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-21 11:43:47,308] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-21 11:43:47,308] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-21 11:43:47,308] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f42d50dcdc0>
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-21 11:43:47,309] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-21 11:43:47,310] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-21 11:43:47,310] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-21 11:43:47,310] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-21 11:43:47,310] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-21 11:43:47,310] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.3605022430419922 seconds
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.3051154613494873 seconds
Time to load utils op: 0.3043360710144043 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Loading extension module utils...
Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]Time to load utils op: 0.3044140338897705 seconds
############### Example ###############
### Instruction:Answer the following multiple choice question.



Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i0-s1-rTrue
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:59<48:49, 59.78s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:45<41:02, 51.29s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [02:46<43:40, 55.76s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [03:45<43:42, 57.00s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [04:45<43:41, 58.27s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [05:40<41:57, 57.23s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [06:41<41:42, 58.20s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [07:41<41:13, 58.88s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [08:40<40:22, 59.08s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [09:40<39:24, 59.11s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [10:39<38:28, 59.20s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [11:39<37:34, 59.33s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [12:39<36:43, 59.55s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [13:37<35:35, 59.32s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [14:38<34:54, 59.84s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [15:38<33:50, 59.71s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [16:38<32:54, 59.85s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [17:22<29:23, 55.12s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [17:58<25:25, 49.20s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [18:32<22:22, 44.76s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [19:10<20:35, 42.60s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [20:08<22:08, 47.46s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [21:08<22:59, 51.11s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [21:53<21:21, 49.30s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [22:40<20:13, 48.55s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [23:40<20:46, 51.93s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [24:40<20:53, 54.50s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [25:40<20:32, 56.01s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [26:41<20:07, 57.51s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [27:10<16:22, 49.10s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [27:52<14:53, 47.00s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [28:25<12:51, 42.85s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [29:25<13:31, 47.74s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [29:47<10:42, 40.13s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [30:28<10:04, 40.28s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [31:28<10:47, 46.23s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [32:03<09:18, 42.98s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [33:02<09:33, 47.80s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [34:02<09:23, 51.27s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [34:32<07:31, 45.10s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [35:33<07:29, 49.93s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [36:33<07:01, 52.71s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [37:19<05:55, 50.82s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [38:19<05:21, 53.51s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [39:19<04:37, 55.51s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [40:18<03:45, 56.42s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [41:12<02:47, 55.73s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [42:10<01:53, 56.55s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [43:09<00:57, 57.24s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [43:33<00:00, 47.19s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [43:33<00:00, 52.27s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 4.8648} | lm_loss 7.4377 | avg. gen lenth: 216.032
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i1-s1-rTrue --seed 1 --max-prompt-length 2048 --rationales --num-in-domain 1
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-21 12:28:18,140] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i1-s1-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 1
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i1-s1-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9740 [00:00<?, ?it/s]  1%|▍                                                     | 78/9740 [00:00<00:12, 778.28it/s]  2%|▊                                                    | 157/9740 [00:00<00:12, 784.95it/s]  2%|█▎                                                   | 236/9740 [00:00<00:12, 781.34it/s]  3%|█▋                                                   | 315/9740 [00:00<00:12, 783.47it/s]  4%|██▏                                                  | 394/9740 [00:00<00:11, 785.70it/s]  5%|██▌                                                  | 473/9740 [00:00<00:11, 782.80it/s]  6%|███                                                  | 552/9740 [00:00<00:11, 784.63it/s]  6%|███▍                                                 | 631/9740 [00:00<00:11, 784.11it/s]  7%|███▊                                                 | 710/9740 [00:00<00:11, 766.85it/s]  8%|████▎                                                | 789/9740 [00:01<00:11, 771.38it/s]  9%|████▋                                                | 868/9740 [00:01<00:11, 776.89it/s] 10%|█████▏                                               | 947/9740 [00:01<00:11, 778.20it/s] 11%|█████▍                                              | 1026/9740 [00:01<00:11, 781.57it/s] 11%|█████▉                                              | 1106/9740 [00:01<00:11, 784.59it/s] 12%|██████▎                                             | 1185/9740 [00:01<00:10, 784.16it/s] 13%|██████▋                                             | 1264/9740 [00:01<00:10, 783.94it/s] 14%|███████▏                                            | 1343/9740 [00:01<00:10, 783.08it/s] 15%|███████▌                                            | 1422/9740 [00:01<00:10, 782.92it/s] 15%|████████                                            | 1501/9740 [00:01<00:10, 778.83it/s] 16%|████████▍                                           | 1579/9740 [00:02<00:10, 777.64it/s] 17%|████████▊                                           | 1658/9740 [00:02<00:10, 780.02it/s] 18%|█████████▎                                          | 1737/9740 [00:02<00:10, 782.10it/s] 19%|█████████▋                                          | 1816/9740 [00:02<00:10, 762.17it/s] 19%|██████████                                          | 1896/9740 [00:02<00:10, 773.04it/s] 21%|██████████▊                                         | 2016/9740 [00:02<00:08, 895.99it/s] 22%|███████████▍                                        | 2135/9740 [00:02<00:07, 982.02it/s] 23%|███████████▊                                       | 2254/9740 [00:02<00:07, 1043.39it/s] 24%|████████████▍                                      | 2374/9740 [00:02<00:06, 1088.31it/s] 26%|█████████████                                      | 2494/9740 [00:02<00:06, 1121.10it/s] 27%|█████████████▋                                     | 2614/9740 [00:03<00:06, 1142.78it/s] 28%|██████████████▎                                    | 2731/9740 [00:03<00:06, 1148.10it/s] 29%|██████████████▉                                    | 2850/9740 [00:03<00:05, 1159.77it/s] 30%|███████████████▌                                   | 2969/9740 [00:03<00:05, 1167.41it/s] 32%|████████████████▏                                  | 3089/9740 [00:03<00:05, 1175.30it/s] 33%|████████████████▊                                  | 3208/9740 [00:03<00:05, 1178.44it/s] 34%|█████████████████▍                                 | 3328/9740 [00:03<00:05, 1183.28it/s] 35%|██████████████████                                 | 3447/9740 [00:03<00:05, 1184.75it/s] 37%|██████████████████▋                                | 3567/9740 [00:03<00:05, 1186.90it/s] 38%|███████████████████▎                               | 3686/9740 [00:03<00:05, 1185.31it/s] 39%|███████████████████▉                               | 3807/9740 [00:04<00:04, 1189.55it/s] 40%|████████████████████▌                              | 3926/9740 [00:04<00:04, 1189.58it/s] 42%|█████████████████████▏                             | 4046/9740 [00:04<00:04, 1191.28it/s] 43%|█████████████████████▊                             | 4166/9740 [00:04<00:04, 1189.12it/s] 44%|██████████████████████▍                            | 4285/9740 [00:04<00:04, 1180.72it/s] 45%|███████████████████████                            | 4404/9740 [00:04<00:04, 1178.53it/s] 46%|███████████████████████▋                           | 4522/9740 [00:04<00:04, 1124.14it/s] 48%|████████████████████████▎                          | 4642/9740 [00:04<00:04, 1144.46it/s] 49%|█████████████████████████▍                          | 4757/9740 [00:04<00:05, 873.90it/s] 50%|██████████████████████████                          | 4876/9740 [00:05<00:05, 949.62it/s] 51%|██████████████████████████▏                        | 4995/9740 [00:05<00:04, 1010.64it/s] 53%|██████████████████████████▊                        | 5115/9740 [00:05<00:04, 1059.88it/s] 54%|███████████████████████████▍                       | 5234/9740 [00:05<00:04, 1094.52it/s] 55%|████████████████████████████                       | 5353/9740 [00:05<00:03, 1120.86it/s] 56%|████████████████████████████▋                      | 5472/9740 [00:05<00:03, 1139.21it/s] 57%|█████████████████████████████▎                     | 5596/9740 [00:05<00:03, 1168.03it/s] 59%|█████████████████████████████▉                     | 5719/9740 [00:05<00:03, 1183.93it/s] 60%|██████████████████████████████▌                    | 5843/9740 [00:05<00:03, 1199.14it/s] 61%|███████████████████████████████▏                   | 5967/9740 [00:05<00:03, 1209.21it/s] 63%|███████████████████████████████▉                   | 6090/9740 [00:06<00:03, 1214.69it/s] 64%|████████████████████████████████▌                  | 6214/9740 [00:06<00:02, 1219.74it/s] 65%|█████████████████████████████████▏                 | 6337/9740 [00:06<00:02, 1220.16it/s] 66%|█████████████████████████████████▊                 | 6461/9740 [00:06<00:02, 1225.71it/s] 68%|██████████████████████████████████▍                | 6584/9740 [00:06<00:02, 1225.53it/s] 69%|███████████████████████████████████▏               | 6709/9740 [00:06<00:02, 1230.19it/s] 70%|███████████████████████████████████▊               | 6833/9740 [00:06<00:02, 1231.43it/s] 71%|████████████████████████████████████▍              | 6958/9740 [00:06<00:02, 1235.13it/s] 73%|█████████████████████████████████████              | 7082/9740 [00:06<00:02, 1234.47it/s] 74%|█████████████████████████████████████▋             | 7207/9740 [00:06<00:02, 1236.00it/s] 75%|██████████████████████████████████████▍            | 7331/9740 [00:07<00:01, 1234.02it/s] 77%|███████████████████████████████████████            | 7455/9740 [00:07<00:01, 1204.03it/s] 78%|███████████████████████████████████████▋           | 7579/9740 [00:07<00:01, 1211.90it/s] 79%|████████████████████████████████████████▎          | 7702/9740 [00:07<00:01, 1216.71it/s] 80%|████████████████████████████████████████▉          | 7825/9740 [00:07<00:01, 1219.33it/s] 82%|█████████████████████████████████████████▌         | 7948/9740 [00:07<00:01, 1174.22it/s] 83%|██████████████████████████████████████████▎        | 8072/9740 [00:07<00:01, 1191.94it/s] 84%|██████████████████████████████████████████▉        | 8196/9740 [00:07<00:01, 1205.37it/s] 85%|███████████████████████████████████████████▌       | 8319/9740 [00:07<00:01, 1211.06it/s] 87%|████████████████████████████████████████████▏      | 8443/9740 [00:08<00:01, 1218.43it/s] 88%|████████████████████████████████████████████▊      | 8567/9740 [00:08<00:00, 1223.13it/s] 89%|█████████████████████████████████████████████▌     | 8690/9740 [00:08<00:00, 1224.57it/s] 90%|██████████████████████████████████████████████▏    | 8813/9740 [00:08<00:00, 1224.88it/s] 92%|██████████████████████████████████████████████▊    | 8938/9740 [00:08<00:00, 1229.97it/s] 93%|███████████████████████████████████████████████▍   | 9062/9740 [00:08<00:00, 1229.49it/s] 94%|████████████████████████████████████████████████   | 9187/9740 [00:08<00:00, 1232.91it/s] 96%|████████████████████████████████████████████████▊  | 9311/9740 [00:08<00:00, 1230.96it/s] 97%|█████████████████████████████████████████████████▍ | 9435/9740 [00:08<00:00, 1232.12it/s] 98%|██████████████████████████████████████████████████ | 9559/9740 [00:08<00:00, 1231.03it/s] 99%|██████████████████████████████████████████████████▋| 9683/9740 [00:09<00:00, 1233.36it/s]100%|███████████████████████████████████████████████████| 9740/9740 [00:09<00:00, 1075.00it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.20s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.12s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.40s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.42s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.06s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.17s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:11<00:05,  5.52s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:11<00:05,  5.60s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.47s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.65s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.50s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.67s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.80s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.99s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  5.10s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  5.21s/it]
[2023-08-21 12:29:20,218] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
[2023-08-21 12:29:30,138] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-21 12:29:30,140] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-21 12:29:30,140] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-21 12:29:30,140] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-21 12:29:30,140] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-21 12:29:30,140] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fc7401c0f40>
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-21 12:29:30,141] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7fc71ac01dc0>
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-21 12:29:30,142] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-21 12:29:30,143] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.40443897247314453 seconds
Loading extension module utils...
Time to load utils op: 0.30432772636413574 seconds
Loading extension module utils...
Time to load utils op: 0.3046755790710449 seconds
Loading extension module utils...
Time to load utils op: 0.3043360710144043 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: 1. The question is asking where you could find some plumbing that would not be of use to you if you are thirsty.
2. We then consider each of the given options.
3. Option A: oil refineries. Even though there may be water available in oil refineries, it is not safe to drink as it may be contaminated with oil.
4. Option B: wall. In most cases, there may be water pipes inside walls of buildings that supplies water. Therefore, if you are thirsty, these pipes in the wall may be of use to you as they may contain drinkable water.
5. Option C: show. It doesn't specify what kind of "show" it is, but if it's a TV show, there could be no actual plumbing. If it's a trade show, you could find usable plumbing in display booths or restroom areas. Therefore, the possibility of getting drinkable water from a "show" depends largely on context and cannot be completely ruled out.
6. Option D: own home. This should not be the correct answer because in your own home, the plumbing serves you with fresh water, which you can drink when you're thirsty.
7. Option E: water fountain. Plumbing for a water fountain usually includes potable water that is treated and safe to drink.
8. After considering all the options, it is clear that option A, oil refineries, is the only one where you would not access potable water through the plumbing.
So the final answer is A: oil refineries

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i1-s1-rTrue
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:52<42:54, 52.55s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:43<41:21, 51.69s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [02:34<40:04, 51.16s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [03:24<39:00, 50.89s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [04:02<34:38, 46.19s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [04:53<34:59, 47.71s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [05:44<34:58, 48.81s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [06:35<34:42, 49.58s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [07:26<34:16, 50.15s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [08:17<33:34, 50.37s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [09:09<33:05, 50.90s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [10:01<32:21, 51.10s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [10:53<31:40, 51.36s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [11:45<30:55, 51.53s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [12:36<30:03, 51.53s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [13:28<29:14, 51.61s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [14:19<28:20, 51.53s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [15:11<27:30, 51.58s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [16:02<26:32, 51.39s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [16:53<25:40, 51.35s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [17:44<24:40, 51.07s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [18:34<23:46, 50.94s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [19:25<22:52, 50.85s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [20:16<22:00, 50.77s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [21:06<21:09, 50.78s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [21:58<20:21, 50.90s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [22:49<19:34, 51.08s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [23:40<18:40, 50.92s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [24:31<17:50, 50.96s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [25:22<16:58, 50.94s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [26:12<16:07, 50.93s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [27:04<15:20, 51.13s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [27:55<14:28, 51.07s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [28:46<13:37, 51.09s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [29:37<12:46, 51.08s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [30:29<11:58, 51.33s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [31:20<11:06, 51.26s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [32:11<10:13, 51.11s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [33:02<09:21, 51.08s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [33:53<08:30, 51.05s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [34:44<07:38, 50.99s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [35:35<06:47, 50.91s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [36:25<05:56, 50.86s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [37:16<05:05, 50.89s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [38:07<04:14, 50.80s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [38:57<03:23, 50.76s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [39:48<02:32, 50.67s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [40:39<01:41, 50.70s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [41:29<00:50, 50.63s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [42:20<00:00, 50.71s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [42:20<00:00, 50.81s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 1.8858} | lm_loss 8.0438 | avg. gen lenth: 389.872
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i2-s1-rTrue --seed 1 --max-prompt-length 2048 --rationales --num-in-domain 2
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-21 13:12:02,277] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i2-s1-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 2
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i2-s1-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9739 [00:00<?, ?it/s]  0%|▏                                                     | 45/9739 [00:00<00:21, 442.85it/s]  1%|▍                                                     | 90/9739 [00:00<00:21, 443.46it/s]  1%|▋                                                    | 135/9739 [00:00<00:21, 444.17it/s]  2%|▉                                                    | 180/9739 [00:00<00:21, 444.16it/s]  2%|█▏                                                   | 225/9739 [00:00<00:21, 442.05it/s]  3%|█▍                                                   | 270/9739 [00:00<00:21, 442.63it/s]  3%|█▋                                                   | 315/9739 [00:00<00:21, 443.54it/s]  4%|█▉                                                   | 360/9739 [00:00<00:21, 437.68it/s]  4%|██▏                                                  | 405/9739 [00:00<00:21, 439.51it/s]  5%|██▍                                                  | 449/9739 [00:01<00:21, 438.13it/s]  5%|██▋                                                  | 494/9739 [00:01<00:21, 439.46it/s]  6%|██▉                                                  | 539/9739 [00:01<00:20, 441.24it/s]  6%|███▏                                                 | 584/9739 [00:01<00:20, 442.07it/s]  6%|███▍                                                 | 629/9739 [00:01<00:20, 442.26it/s]  7%|███▋                                                 | 674/9739 [00:01<00:20, 441.32it/s]  7%|███▉                                                 | 719/9739 [00:01<00:20, 441.80it/s]  8%|████▏                                                | 764/9739 [00:01<00:20, 442.46it/s]  8%|████▍                                                | 809/9739 [00:01<00:20, 438.23it/s]  9%|████▋                                                | 854/9739 [00:01<00:20, 439.13it/s]  9%|████▉                                                | 898/9739 [00:02<00:20, 437.25it/s] 10%|█████▏                                               | 943/9739 [00:02<00:20, 438.46it/s] 10%|█████▍                                               | 988/9739 [00:02<00:19, 439.62it/s] 11%|█████▌                                              | 1033/9739 [00:02<00:19, 440.58it/s] 11%|█████▊                                              | 1078/9739 [00:02<00:19, 441.58it/s] 12%|██████                                              | 1138/9739 [00:02<00:17, 488.20it/s] 12%|██████▍                                             | 1205/9739 [00:02<00:15, 541.14it/s] 13%|██████▊                                             | 1272/9739 [00:02<00:14, 577.85it/s] 14%|███████▏                                            | 1338/9739 [00:02<00:13, 601.83it/s] 14%|███████▌                                            | 1405/9739 [00:02<00:13, 620.57it/s] 15%|███████▊                                            | 1472/9739 [00:03<00:13, 633.31it/s] 16%|████████▏                                           | 1539/9739 [00:03<00:12, 641.60it/s] 16%|████████▌                                           | 1605/9739 [00:03<00:12, 645.29it/s] 17%|████████▉                                           | 1672/9739 [00:03<00:12, 651.51it/s] 18%|█████████▎                                          | 1739/9739 [00:03<00:12, 654.93it/s] 19%|█████████▋                                          | 1805/9739 [00:03<00:12, 633.29it/s] 19%|█████████▉                                          | 1872/9739 [00:03<00:12, 641.76it/s] 20%|██████████▎                                         | 1939/9739 [00:03<00:12, 648.67it/s] 21%|██████████▋                                         | 2006/9739 [00:03<00:11, 653.65it/s] 21%|███████████                                         | 2072/9739 [00:03<00:11, 653.90it/s] 22%|███████████▍                                        | 2139/9739 [00:04<00:11, 655.81it/s] 23%|███████████▊                                        | 2206/9739 [00:04<00:11, 658.89it/s] 23%|████████████▏                                       | 2272/9739 [00:04<00:11, 657.95it/s] 24%|████████████▍                                       | 2339/9739 [00:04<00:11, 659.72it/s] 25%|████████████▊                                       | 2406/9739 [00:04<00:11, 661.25it/s] 25%|█████████████▏                                      | 2473/9739 [00:04<00:11, 660.45it/s] 26%|█████████████▌                                      | 2540/9739 [00:04<00:10, 660.49it/s] 27%|█████████████▉                                      | 2607/9739 [00:04<00:10, 662.01it/s] 27%|██████████████▎                                     | 2674/9739 [00:04<00:10, 662.19it/s] 28%|██████████████▋                                     | 2741/9739 [00:04<00:10, 659.68it/s] 29%|██████████████▉                                     | 2807/9739 [00:05<00:10, 659.59it/s] 29%|███████████████▎                                    | 2873/9739 [00:05<00:10, 659.45it/s] 30%|███████████████▋                                    | 2939/9739 [00:05<00:10, 658.46it/s] 31%|████████████████                                    | 3006/9739 [00:05<00:10, 659.74it/s] 32%|████████████████▍                                   | 3073/9739 [00:05<00:10, 659.83it/s] 32%|████████████████▊                                   | 3140/9739 [00:05<00:09, 660.79it/s] 33%|█████████████████                                   | 3207/9739 [00:05<00:09, 656.60it/s] 34%|█████████████████▍                                  | 3274/9739 [00:05<00:09, 658.01it/s] 34%|█████████████████▊                                  | 3341/9739 [00:05<00:09, 658.67it/s] 35%|██████████████████▏                                 | 3407/9739 [00:05<00:09, 657.14it/s] 36%|██████████████████▌                                 | 3474/9739 [00:06<00:09, 658.08it/s] 36%|██████████████████▉                                 | 3540/9739 [00:06<00:09, 658.31it/s] 37%|███████████████████▎                                | 3606/9739 [00:06<00:09, 657.27it/s] 38%|███████████████████▌                                | 3673/9739 [00:06<00:09, 658.77it/s] 38%|███████████████████▉                                | 3740/9739 [00:06<00:09, 659.62it/s] 39%|████████████████████▎                               | 3807/9739 [00:06<00:08, 660.38it/s] 40%|████████████████████▋                               | 3874/9739 [00:06<00:08, 659.15it/s] 40%|█████████████████████                               | 3941/9739 [00:06<00:08, 660.01it/s] 41%|█████████████████████▍                              | 4008/9739 [00:06<00:08, 660.85it/s] 42%|█████████████████████▊                              | 4075/9739 [00:07<00:08, 653.53it/s] 43%|██████████████████████                              | 4142/9739 [00:07<00:08, 655.71it/s] 43%|██████████████████████▍                             | 4208/9739 [00:07<00:08, 652.50it/s] 44%|██████████████████████▊                             | 4275/9739 [00:07<00:08, 656.18it/s] 45%|███████████████████████▏                            | 4341/9739 [00:07<00:08, 655.90it/s] 45%|███████████████████████▌                            | 4407/9739 [00:07<00:08, 653.88it/s] 46%|███████████████████████▉                            | 4473/9739 [00:07<00:08, 645.21it/s] 47%|████████████████████████▏                           | 4538/9739 [00:07<00:08, 619.58it/s] 47%|████████████████████████▌                           | 4605/9739 [00:07<00:08, 632.59it/s] 48%|████████████████████████▉                           | 4672/9739 [00:07<00:07, 642.08it/s] 49%|█████████████████████████▎                          | 4739/9739 [00:08<00:07, 649.09it/s] 49%|█████████████████████████▋                          | 4805/9739 [00:08<00:10, 476.13it/s] 50%|█████████████████████████▉                          | 4869/9739 [00:08<00:09, 514.58it/s] 51%|██████████████████████████▎                         | 4936/9739 [00:08<00:08, 551.91it/s] 51%|██████████████████████████▋                         | 5002/9739 [00:08<00:08, 579.21it/s] 52%|███████████████████████████                         | 5069/9739 [00:08<00:07, 601.98it/s] 53%|███████████████████████████▍                        | 5136/9739 [00:08<00:07, 619.21it/s] 53%|███████████████████████████▊                        | 5202/9739 [00:08<00:07, 629.46it/s] 54%|████████████████████████████▏                       | 5268/9739 [00:08<00:07, 638.03it/s] 55%|████████████████████████████▍                       | 5334/9739 [00:09<00:06, 644.14it/s] 55%|████████████████████████████▊                       | 5400/9739 [00:09<00:06, 646.67it/s] 56%|█████████████████████████████▏                      | 5467/9739 [00:09<00:06, 651.30it/s] 57%|█████████████████████████████▌                      | 5536/9739 [00:09<00:06, 661.37it/s] 58%|█████████████████████████████▉                      | 5605/9739 [00:09<00:06, 668.78it/s] 58%|██████████████████████████████▎                     | 5674/9739 [00:09<00:06, 672.40it/s] 59%|██████████████████████████████▋                     | 5742/9739 [00:09<00:05, 670.59it/s] 60%|███████████████████████████████                     | 5811/9739 [00:09<00:05, 675.11it/s] 60%|███████████████████████████████▍                    | 5879/9739 [00:09<00:05, 674.61it/s] 61%|███████████████████████████████▊                    | 5948/9739 [00:09<00:05, 678.86it/s] 62%|████████████████████████████████▏                   | 6018/9739 [00:10<00:05, 682.43it/s] 63%|████████████████████████████████▌                   | 6087/9739 [00:10<00:05, 682.11it/s] 63%|████████████████████████████████▊                   | 6156/9739 [00:10<00:05, 682.54it/s] 64%|█████████████████████████████████▏                  | 6225/9739 [00:10<00:05, 683.42it/s] 65%|█████████████████████████████████▌                  | 6294/9739 [00:10<00:05, 683.77it/s] 65%|█████████████████████████████████▉                  | 6363/9739 [00:10<00:04, 682.16it/s] 66%|██████████████████████████████████▎                 | 6432/9739 [00:10<00:04, 683.75it/s] 67%|██████████████████████████████████▋                 | 6501/9739 [00:10<00:04, 683.55it/s] 67%|███████████████████████████████████                 | 6570/9739 [00:10<00:04, 680.71it/s] 68%|███████████████████████████████████▍                | 6639/9739 [00:10<00:04, 680.85it/s] 69%|███████████████████████████████████▊                | 6708/9739 [00:11<00:04, 682.30it/s] 70%|████████████████████████████████████▏               | 6777/9739 [00:11<00:04, 681.87it/s] 70%|████████████████████████████████████▌               | 6846/9739 [00:11<00:04, 683.76it/s] 71%|████████████████████████████████████▉               | 6915/9739 [00:11<00:04, 683.32it/s] 72%|█████████████████████████████████████▎              | 6984/9739 [00:11<00:04, 683.94it/s] 72%|█████████████████████████████████████▋              | 7053/9739 [00:11<00:03, 681.52it/s] 73%|██████████████████████████████████████              | 7122/9739 [00:11<00:03, 683.43it/s] 74%|██████████████████████████████████████▍             | 7191/9739 [00:11<00:03, 684.20it/s] 75%|██████████████████████████████████████▊             | 7260/9739 [00:11<00:03, 682.47it/s] 75%|███████████████████████████████████████▏            | 7329/9739 [00:11<00:03, 683.07it/s] 76%|███████████████████████████████████████▌            | 7398/9739 [00:12<00:03, 683.38it/s] 77%|███████████████████████████████████████▊            | 7467/9739 [00:12<00:03, 641.80it/s] 77%|████████████████████████████████████████▏           | 7535/9739 [00:12<00:03, 652.60it/s] 78%|████████████████████████████████████████▌           | 7604/9739 [00:12<00:03, 661.87it/s] 79%|████████████████████████████████████████▉           | 7672/9739 [00:12<00:03, 664.66it/s] 79%|█████████████████████████████████████████▎          | 7741/9739 [00:12<00:02, 671.04it/s] 80%|█████████████████████████████████████████▋          | 7810/9739 [00:12<00:02, 674.95it/s] 81%|██████████████████████████████████████████          | 7879/9739 [00:12<00:02, 677.64it/s] 82%|██████████████████████████████████████████▍         | 7948/9739 [00:12<00:02, 678.51it/s] 82%|██████████████████████████████████████████▊         | 8017/9739 [00:13<00:02, 679.86it/s] 83%|███████████████████████████████████████████▏        | 8086/9739 [00:13<00:02, 680.22it/s] 84%|███████████████████████████████████████████▌        | 8155/9739 [00:13<00:02, 679.01it/s] 84%|███████████████████████████████████████████▉        | 8224/9739 [00:13<00:02, 680.17it/s] 85%|████████████████████████████████████████████▎       | 8293/9739 [00:13<00:02, 681.12it/s] 86%|████████████████████████████████████████████▋       | 8362/9739 [00:13<00:02, 678.42it/s] 87%|█████████████████████████████████████████████       | 8431/9739 [00:13<00:01, 680.33it/s] 87%|█████████████████████████████████████████████▍      | 8500/9739 [00:13<00:01, 682.15it/s] 88%|█████████████████████████████████████████████▊      | 8569/9739 [00:13<00:01, 682.31it/s] 89%|██████████████████████████████████████████████      | 8638/9739 [00:13<00:01, 677.37it/s] 89%|██████████████████████████████████████████████▍     | 8707/9739 [00:14<00:01, 678.43it/s] 90%|██████████████████████████████████████████████▊     | 8776/9739 [00:14<00:01, 679.55it/s] 91%|███████████████████████████████████████████████▏    | 8844/9739 [00:14<00:01, 677.18it/s] 92%|███████████████████████████████████████████████▌    | 8913/9739 [00:14<00:01, 678.29it/s] 92%|███████████████████████████████████████████████▉    | 8982/9739 [00:14<00:01, 680.05it/s] 93%|████████████████████████████████████████████████▎   | 9051/9739 [00:14<00:01, 677.30it/s] 94%|████████████████████████████████████████████████▋   | 9120/9739 [00:14<00:00, 678.84it/s] 94%|█████████████████████████████████████████████████   | 9189/9739 [00:14<00:00, 680.65it/s] 95%|█████████████████████████████████████████████████▍  | 9258/9739 [00:14<00:00, 679.89it/s] 96%|█████████████████████████████████████████████████▊  | 9327/9739 [00:14<00:00, 681.28it/s] 96%|██████████████████████████████████████████████████▏ | 9396/9739 [00:15<00:00, 681.47it/s] 97%|██████████████████████████████████████████████████▌ | 9465/9739 [00:15<00:00, 682.13it/s] 98%|██████████████████████████████████████████████████▉ | 9534/9739 [00:15<00:00, 680.15it/s] 99%|███████████████████████████████████████████████████▎| 9603/9739 [00:15<00:00, 678.05it/s] 99%|███████████████████████████████████████████████████▋| 9671/9739 [00:15<00:00, 677.70it/s]100%|████████████████████████████████████████████████████| 9739/9739 [00:15<00:00, 676.09it/s]100%|████████████████████████████████████████████████████| 9739/9739 [00:15<00:00, 625.70it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.22s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.06s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.14s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.34s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.14s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.09s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.18s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.24s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.47s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.66s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.42s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.60s/it]
[2023-08-21 13:13:09,037] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.50s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.68s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.65s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.82s/it]
[2023-08-21 13:13:16,848] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-21 13:13:16,849] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-21 13:13:16,849] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-21 13:13:16,849] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fa3c3ba9f40>
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-21 13:13:16,850] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7fa39b9bfdc0>
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-21 13:13:16,851] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-21 13:13:16,851] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.43611812591552734 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Loading extension module utils...
Time to load utils op: 0.4044969081878662 seconds
Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: 1. The question is asking for a place where plumbing exists but is not useful for someone who is thirsty. 
2. This means we are looking for a place where the plumbing doesn't carry potable water that one could drink to quench their thirst.
3. We can first eliminate choices that are obviously incorrect. The plumbing in your own home (D) and a water fountain (E) would undoubtedly be able to provide drinkable water. So these cannot be the correct options.
4. Considering option B, the wall, it could contain plumbing if, for example, it's a wall in a home with pipes for bathrooms or the kitchen running through it. Therefore, you could potentially get water from here if you're thirsty. We can rule this option out as well.
5. Looking at option C, the show, it's a bit unclear whether this is referring to a television show, a theatre show, or something else entirely. If we take it to mean a television or theatre show, then there certainly is no plumbing there that you could drink from. However, such shows typically don't have any plumbing to begin with, so this option is not a 'perfect' fit as per the exact wording of the question.
6. This leaves us with choice A, oil refineries. Oil refineries do have extensive plumbing for the transportation and processing of petroleum products. However, this plumbing system does not carry potable water, and definitely isn't something you could drink from if you're thirsty. 
7. Therefore the correct answer is A: oil refineries.
So the final answer is A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Output: 1. The question is about identifying what a person is not doing yet when they are beginning work.
2. Let's consider each answer choice:
    - A: working – This isn't the answer because when a person is beginning work, they are indeed working.
    - B: resting – This isn't applicable because not all people rest before they begin to work, and the process of beginning work is contradictory to resting. 
    - C: tiredness – This is not an action and therefore, it can't be the answer. 
    - D: accomplishing – In the context of this question, when a person is just beginning work, they haven't yet completed or accomplished any of the tasks they're setting out to do. Therefore, it's accurately describing what they aren't doing yet.
    - E: momentum – This isn't the correct answer either because one can have momentum as soon as they begin work.
3. With these considerations, the answer is D: accomplishing.
So the final answer is D: accomplishing

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i2-s1-rTrue
Loading extension module utils...
Time to load utils op: 0.4050166606903076 seconds
Loading extension module utils...
Time to load utils op: 0.4045989513397217 seconds
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:47<38:24, 47.03s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:33<37:22, 46.71s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [02:20<36:51, 47.06s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [03:07<35:55, 46.87s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [03:54<35:13, 46.97s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [04:41<34:25, 46.95s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [05:28<33:39, 46.96s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [06:15<32:50, 46.92s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [07:01<31:56, 46.74s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [07:48<31:10, 46.75s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [08:35<30:21, 46.71s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [09:21<29:33, 46.68s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [10:08<28:44, 46.61s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [10:55<28:09, 46.92s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [11:42<27:15, 46.74s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [12:28<26:27, 46.70s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [13:15<25:36, 46.55s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [14:02<24:53, 46.69s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [14:48<24:09, 46.76s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [15:35<23:23, 46.77s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [16:22<22:33, 46.66s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [17:09<21:49, 46.78s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [17:55<21:02, 46.77s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [18:42<20:17, 46.83s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [19:29<19:28, 46.76s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [20:16<18:41, 46.72s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [21:02<17:53, 46.69s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [21:49<17:09, 46.78s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [22:36<16:21, 46.72s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [23:23<15:35, 46.79s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [24:09<14:48, 46.75s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [24:56<13:59, 46.63s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [25:43<13:14, 46.74s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [26:29<12:25, 46.62s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [27:16<11:38, 46.56s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [28:02<10:51, 46.57s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [28:49<10:07, 46.72s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [29:37<09:23, 46.94s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [30:24<08:37, 47.08s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [31:11<07:50, 47.07s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [31:58<07:01, 46.88s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [32:44<06:13, 46.71s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [33:30<05:26, 46.66s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [34:17<04:40, 46.70s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [35:04<03:53, 46.73s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [35:51<03:06, 46.69s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [36:37<02:19, 46.61s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [37:24<01:33, 46.64s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [38:11<00:46, 46.70s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [38:58<00:00, 46.86s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [38:58<00:00, 46.77s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 1.7126} | lm_loss 8.1612 | avg. gen lenth: 414.716
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i3-s1-rTrue --seed 1 --max-prompt-length 2048 --rationales --num-in-domain 3
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date![nltk_data]   Package punkt is already up-to-date!

[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-21 13:52:26,177] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i3-s1-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 3
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i3-s1-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9738 [00:00<?, ?it/s]  0%|▏                                                     | 34/9738 [00:00<00:28, 339.34it/s]  1%|▍                                                     | 69/9738 [00:00<00:28, 341.10it/s]  1%|▌                                                    | 104/9738 [00:00<00:28, 342.24it/s]  1%|▊                                                    | 139/9738 [00:00<00:28, 342.41it/s]  2%|▉                                                    | 174/9738 [00:00<00:27, 342.74it/s]  2%|█▏                                                   | 209/9738 [00:00<00:28, 340.03it/s]  3%|█▎                                                   | 244/9738 [00:00<00:27, 340.18it/s]  3%|█▌                                                   | 279/9738 [00:00<00:28, 335.56it/s]  3%|█▋                                                   | 314/9738 [00:00<00:27, 337.36it/s]  4%|█▉                                                   | 349/9738 [00:01<00:27, 338.51it/s]  4%|██                                                   | 384/9738 [00:01<00:27, 339.68it/s]  4%|██▎                                                  | 419/9738 [00:01<00:27, 340.33it/s]  5%|██▍                                                  | 454/9738 [00:01<00:27, 338.96it/s]  5%|██▋                                                  | 489/9738 [00:01<00:27, 339.72it/s]  5%|██▊                                                  | 524/9738 [00:01<00:27, 340.42it/s]  6%|███                                                  | 559/9738 [00:01<00:26, 340.72it/s]  6%|███▏                                                 | 594/9738 [00:01<00:26, 339.28it/s]  6%|███▍                                                 | 629/9738 [00:01<00:26, 339.96it/s]  7%|███▌                                                 | 663/9738 [00:01<00:26, 338.85it/s]  7%|███▊                                                 | 698/9738 [00:02<00:26, 339.61it/s]  8%|███▉                                                 | 732/9738 [00:02<00:26, 339.51it/s]  8%|████▏                                                | 767/9738 [00:02<00:26, 339.81it/s]  8%|████▎                                                | 803/9738 [00:02<00:25, 344.97it/s]  9%|████▋                                                | 855/9738 [00:02<00:22, 396.23it/s]  9%|████▉                                                | 907/9738 [00:02<00:20, 430.67it/s] 10%|█████▏                                               | 959/9738 [00:02<00:19, 456.11it/s] 10%|█████▍                                              | 1011/9738 [00:02<00:18, 474.63it/s] 11%|█████▋                                              | 1063/9738 [00:02<00:17, 487.76it/s] 11%|█████▉                                              | 1115/9738 [00:02<00:17, 495.14it/s] 12%|██████▏                                             | 1166/9738 [00:03<00:17, 498.99it/s] 13%|██████▌                                             | 1218/9738 [00:03<00:16, 504.33it/s] 13%|██████▊                                             | 1270/9738 [00:03<00:16, 508.38it/s] 14%|███████                                             | 1322/9738 [00:03<00:16, 510.99it/s] 14%|███████▎                                            | 1374/9738 [00:03<00:16, 511.29it/s] 15%|███████▌                                            | 1426/9738 [00:03<00:16, 513.02it/s] 15%|███████▉                                            | 1478/9738 [00:03<00:16, 514.93it/s] 16%|████████▏                                           | 1530/9738 [00:03<00:15, 515.75it/s] 16%|████████▍                                           | 1582/9738 [00:03<00:15, 515.27it/s] 17%|████████▋                                           | 1634/9738 [00:03<00:15, 516.24it/s] 17%|█████████                                           | 1686/9738 [00:04<00:15, 516.89it/s] 18%|█████████▎                                          | 1738/9738 [00:04<00:15, 516.99it/s] 18%|█████████▌                                          | 1790/9738 [00:04<00:15, 497.18it/s] 19%|█████████▊                                          | 1840/9738 [00:04<00:15, 496.97it/s] 19%|██████████                                          | 1892/9738 [00:04<00:15, 502.78it/s] 20%|██████████▍                                         | 1944/9738 [00:04<00:15, 506.94it/s] 20%|██████████▋                                         | 1996/9738 [00:04<00:15, 510.27it/s] 21%|██████████▉                                         | 2048/9738 [00:04<00:15, 509.94it/s] 22%|███████████▏                                        | 2100/9738 [00:04<00:14, 511.59it/s] 22%|███████████▍                                        | 2152/9738 [00:04<00:14, 513.49it/s] 23%|███████████▊                                        | 2204/9738 [00:05<00:14, 514.26it/s] 23%|████████████                                        | 2256/9738 [00:05<00:14, 513.35it/s] 24%|████████████▎                                       | 2308/9738 [00:05<00:14, 514.30it/s] 24%|████████████▌                                       | 2360/9738 [00:05<00:14, 514.79it/s] 25%|████████████▉                                       | 2412/9738 [00:05<00:14, 515.91it/s] 25%|█████████████▏                                      | 2464/9738 [00:05<00:14, 516.57it/s] 26%|█████████████▍                                      | 2516/9738 [00:05<00:14, 513.92it/s] 26%|█████████████▋                                      | 2568/9738 [00:05<00:13, 514.70it/s] 27%|█████████████▉                                      | 2620/9738 [00:05<00:13, 516.09it/s] 27%|██████████████▎                                     | 2672/9738 [00:05<00:13, 516.21it/s] 28%|██████████████▌                                     | 2724/9738 [00:06<00:13, 513.78it/s] 29%|██████████████▊                                     | 2776/9738 [00:06<00:13, 514.25it/s] 29%|███████████████                                     | 2828/9738 [00:06<00:13, 514.45it/s] 30%|███████████████▍                                    | 2880/9738 [00:06<00:13, 515.34it/s] 30%|███████████████▋                                    | 2932/9738 [00:06<00:13, 513.16it/s] 31%|███████████████▉                                    | 2984/9738 [00:06<00:13, 513.49it/s] 31%|████████████████▏                                   | 3036/9738 [00:06<00:13, 514.29it/s] 32%|████████████████▍                                   | 3088/9738 [00:06<00:12, 514.43it/s] 32%|████████████████▊                                   | 3140/9738 [00:06<00:12, 515.27it/s] 33%|█████████████████                                   | 3192/9738 [00:07<00:12, 514.50it/s] 33%|█████████████████▎                                  | 3244/9738 [00:07<00:12, 515.33it/s] 34%|█████████████████▌                                  | 3296/9738 [00:07<00:12, 515.77it/s] 34%|█████████████████▉                                  | 3348/9738 [00:07<00:12, 515.92it/s] 35%|██████████████████▏                                 | 3400/9738 [00:07<00:12, 512.45it/s] 35%|██████████████████▍                                 | 3452/9738 [00:07<00:12, 513.35it/s] 36%|██████████████████▋                                 | 3504/9738 [00:07<00:12, 513.37it/s] 37%|██████████████████▉                                 | 3556/9738 [00:07<00:12, 514.14it/s] 37%|███████████████████▎                                | 3608/9738 [00:07<00:11, 512.52it/s] 38%|███████████████████▌                                | 3660/9738 [00:07<00:11, 513.32it/s] 38%|███████████████████▊                                | 3712/9738 [00:08<00:11, 514.44it/s] 39%|████████████████████                                | 3764/9738 [00:08<00:11, 513.70it/s] 39%|████████████████████▍                               | 3816/9738 [00:08<00:11, 514.92it/s] 40%|████████████████████▋                               | 3868/9738 [00:08<00:11, 513.95it/s] 40%|████████████████████▉                               | 3920/9738 [00:08<00:11, 515.69it/s] 41%|█████████████████████▏                              | 3972/9738 [00:08<00:11, 515.54it/s] 41%|█████████████████████▍                              | 4024/9738 [00:08<00:11, 515.77it/s] 42%|█████████████████████▊                              | 4076/9738 [00:08<00:11, 513.44it/s] 42%|██████████████████████                              | 4128/9738 [00:08<00:10, 513.98it/s] 43%|██████████████████████▎                             | 4180/9738 [00:08<00:10, 514.52it/s] 43%|██████████████████████▌                             | 4232/9738 [00:09<00:10, 515.24it/s] 44%|██████████████████████▉                             | 4284/9738 [00:09<00:10, 514.04it/s] 45%|███████████████████████▏                            | 4336/9738 [00:09<00:10, 513.01it/s] 45%|███████████████████████▍                            | 4388/9738 [00:09<00:10, 514.26it/s] 46%|███████████████████████▋                            | 4440/9738 [00:09<00:10, 515.01it/s] 46%|███████████████████████▉                            | 4492/9738 [00:09<00:10, 515.97it/s] 47%|████████████████████████▎                           | 4544/9738 [00:09<00:10, 488.82it/s] 47%|████████████████████████▌                           | 4596/9738 [00:09<00:10, 496.78it/s] 48%|████████████████████████▊                           | 4648/9738 [00:09<00:10, 502.59it/s] 48%|█████████████████████████                           | 4700/9738 [00:09<00:09, 506.60it/s] 49%|█████████████████████████▎                          | 4751/9738 [00:10<00:12, 395.70it/s] 49%|█████████████████████████▋                          | 4803/9738 [00:10<00:11, 425.30it/s] 50%|█████████████████████████▉                          | 4855/9738 [00:10<00:10, 448.79it/s] 50%|██████████████████████████▏                         | 4907/9738 [00:10<00:10, 466.88it/s] 51%|██████████████████████████▍                         | 4959/9738 [00:10<00:09, 479.24it/s] 51%|██████████████████████████▊                         | 5011/9738 [00:10<00:09, 490.08it/s] 52%|███████████████████████████                         | 5063/9738 [00:10<00:09, 497.89it/s] 53%|███████████████████████████▎                        | 5115/9738 [00:10<00:09, 503.02it/s] 53%|███████████████████████████▌                        | 5167/9738 [00:10<00:09, 507.24it/s] 54%|███████████████████████████▊                        | 5219/9738 [00:11<00:08, 508.06it/s] 54%|████████████████████████████▏                       | 5271/9738 [00:11<00:08, 510.78it/s] 55%|████████████████████████████▍                       | 5323/9738 [00:11<00:08, 511.90it/s] 55%|████████████████████████████▋                       | 5375/9738 [00:11<00:08, 513.17it/s] 56%|████████████████████████████▉                       | 5427/9738 [00:11<00:08, 511.87it/s] 56%|█████████████████████████████▎                      | 5479/9738 [00:11<00:08, 514.17it/s] 57%|█████████████████████████████▌                      | 5533/9738 [00:11<00:08, 520.52it/s] 57%|█████████████████████████████▊                      | 5587/9738 [00:11<00:07, 524.07it/s] 58%|██████████████████████████████                      | 5640/9738 [00:11<00:07, 524.59it/s] 58%|██████████████████████████████▍                     | 5694/9738 [00:11<00:07, 527.43it/s] 59%|██████████████████████████████▋                     | 5748/9738 [00:12<00:07, 529.65it/s] 60%|██████████████████████████████▉                     | 5802/9738 [00:12<00:07, 531.10it/s] 60%|███████████████████████████████▎                    | 5856/9738 [00:12<00:07, 529.86it/s] 61%|███████████████████████████████▌                    | 5910/9738 [00:12<00:07, 531.37it/s] 61%|███████████████████████████████▊                    | 5964/9738 [00:12<00:07, 527.69it/s] 62%|████████████████████████████████▏                   | 6018/9738 [00:12<00:07, 528.66it/s] 62%|████████████████████████████████▍                   | 6072/9738 [00:12<00:06, 530.30it/s] 63%|████████████████████████████████▋                   | 6126/9738 [00:12<00:06, 529.20it/s] 63%|█████████████████████████████████                   | 6180/9738 [00:12<00:06, 530.54it/s] 64%|█████████████████████████████████▎                  | 6234/9738 [00:12<00:06, 530.66it/s] 65%|█████████████████████████████████▌                  | 6288/9738 [00:13<00:06, 531.40it/s] 65%|█████████████████████████████████▊                  | 6342/9738 [00:13<00:06, 529.89it/s] 66%|██████████████████████████████████▏                 | 6396/9738 [00:13<00:06, 530.96it/s] 66%|██████████████████████████████████▍                 | 6450/9738 [00:13<00:06, 531.18it/s] 67%|██████████████████████████████████▋                 | 6504/9738 [00:13<00:06, 531.30it/s] 67%|███████████████████████████████████                 | 6558/9738 [00:13<00:06, 528.78it/s] 68%|███████████████████████████████████▎                | 6612/9738 [00:13<00:05, 529.65it/s] 68%|███████████████████████████████████▌                | 6666/9738 [00:13<00:05, 530.77it/s] 69%|███████████████████████████████████▉                | 6720/9738 [00:13<00:05, 531.77it/s] 70%|████████████████████████████████████▏               | 6774/9738 [00:14<00:05, 530.95it/s] 70%|████████████████████████████████████▍               | 6828/9738 [00:14<00:05, 531.49it/s] 71%|████████████████████████████████████▋               | 6882/9738 [00:14<00:05, 527.18it/s] 71%|█████████████████████████████████████               | 6936/9738 [00:14<00:05, 528.27it/s] 72%|█████████████████████████████████████▎              | 6989/9738 [00:14<00:05, 527.19it/s] 72%|█████████████████████████████████████▌              | 7043/9738 [00:14<00:05, 528.55it/s] 73%|█████████████████████████████████████▉              | 7097/9738 [00:14<00:04, 529.67it/s] 73%|██████████████████████████████████████▏             | 7151/9738 [00:14<00:04, 530.65it/s] 74%|██████████████████████████████████████▍             | 7205/9738 [00:14<00:04, 531.18it/s] 75%|██████████████████████████████████████▊             | 7259/9738 [00:14<00:04, 529.58it/s] 75%|███████████████████████████████████████             | 7313/9738 [00:15<00:04, 530.08it/s] 76%|███████████████████████████████████████▎            | 7367/9738 [00:15<00:04, 530.94it/s] 76%|███████████████████████████████████████▋            | 7421/9738 [00:15<00:04, 531.06it/s] 77%|███████████████████████████████████████▉            | 7475/9738 [00:15<00:04, 503.19it/s] 77%|████████████████████████████████████████▏           | 7528/9738 [00:15<00:04, 508.92it/s] 78%|████████████████████████████████████████▍           | 7581/9738 [00:15<00:04, 513.60it/s] 78%|████████████████████████████████████████▊           | 7634/9738 [00:15<00:04, 517.20it/s] 79%|█████████████████████████████████████████           | 7686/9738 [00:15<00:03, 516.82it/s] 79%|█████████████████████████████████████████▎          | 7738/9738 [00:15<00:03, 514.67it/s] 80%|█████████████████████████████████████████▌          | 7791/9738 [00:15<00:03, 516.65it/s] 81%|█████████████████████████████████████████▉          | 7844/9738 [00:16<00:03, 519.10it/s] 81%|██████████████████████████████████████████▏         | 7896/9738 [00:16<00:03, 518.58it/s] 82%|██████████████████████████████████████████▍         | 7949/9738 [00:16<00:03, 520.78it/s] 82%|██████████████████████████████████████████▋         | 8002/9738 [00:16<00:03, 521.52it/s] 83%|███████████████████████████████████████████         | 8055/9738 [00:16<00:03, 522.26it/s] 83%|███████████████████████████████████████████▎        | 8108/9738 [00:16<00:03, 523.44it/s] 84%|███████████████████████████████████████████▌        | 8161/9738 [00:16<00:03, 522.17it/s] 84%|███████████████████████████████████████████▊        | 8214/9738 [00:16<00:02, 522.19it/s] 85%|████████████████████████████████████████████▏       | 8267/9738 [00:16<00:02, 522.76it/s] 85%|████████████████████████████████████████████▍       | 8320/9738 [00:16<00:02, 522.94it/s] 86%|████████████████████████████████████████████▋       | 8373/9738 [00:17<00:02, 521.78it/s] 87%|████████████████████████████████████████████▉       | 8426/9738 [00:17<00:02, 522.88it/s] 87%|█████████████████████████████████████████████▎      | 8479/9738 [00:17<00:02, 523.50it/s] 88%|█████████████████████████████████████████████▌      | 8532/9738 [00:17<00:02, 523.52it/s] 88%|█████████████████████████████████████████████▊      | 8585/9738 [00:17<00:02, 521.13it/s] 89%|██████████████████████████████████████████████▏     | 8638/9738 [00:17<00:02, 518.25it/s] 89%|██████████████████████████████████████████████▍     | 8691/9738 [00:17<00:02, 519.36it/s] 90%|██████████████████████████████████████████████▋     | 8744/9738 [00:17<00:01, 520.67it/s] 90%|██████████████████████████████████████████████▉     | 8797/9738 [00:17<00:01, 520.86it/s] 91%|███████████████████████████████████████████████▎    | 8850/9738 [00:17<00:01, 519.50it/s] 91%|███████████████████████████████████████████████▌    | 8903/9738 [00:18<00:01, 521.01it/s] 92%|███████████████████████████████████████████████▊    | 8956/9738 [00:18<00:01, 522.23it/s] 93%|████████████████████████████████████████████████    | 9009/9738 [00:18<00:01, 522.66it/s] 93%|████████████████████████████████████████████████▍   | 9062/9738 [00:18<00:01, 520.20it/s] 94%|████████████████████████████████████████████████▋   | 9115/9738 [00:18<00:01, 521.07it/s] 94%|████████████████████████████████████████████████▉   | 9168/9738 [00:18<00:01, 521.62it/s] 95%|█████████████████████████████████████████████████▏  | 9221/9738 [00:18<00:00, 522.12it/s] 95%|█████████████████████████████████████████████████▌  | 9274/9738 [00:18<00:00, 520.93it/s] 96%|█████████████████████████████████████████████████▊  | 9327/9738 [00:18<00:00, 521.84it/s] 96%|██████████████████████████████████████████████████  | 9380/9738 [00:19<00:00, 521.95it/s] 97%|██████████████████████████████████████████████████▎ | 9433/9738 [00:19<00:00, 522.60it/s] 97%|██████████████████████████████████████████████████▋ | 9486/9738 [00:19<00:00, 521.04it/s] 98%|██████████████████████████████████████████████████▉ | 9539/9738 [00:19<00:00, 521.78it/s] 99%|███████████████████████████████████████████████████▏| 9592/9738 [00:19<00:00, 521.87it/s] 99%|███████████████████████████████████████████████████▌| 9645/9738 [00:19<00:00, 522.05it/s]100%|███████████████████████████████████████████████████▊| 9698/9738 [00:19<00:00, 522.08it/s]100%|████████████████████████████████████████████████████| 9738/9738 [00:19<00:00, 494.56it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.18s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.14s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.22s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.30s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.09s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.03s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.20s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.19s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.40s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.58s/it]
[2023-08-21 13:53:37,279] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.45s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.63s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.62s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.78s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.60s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.77s/it]
[2023-08-21 13:53:46,376] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-21 13:53:46,377] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-21 13:53:46,377] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-21 13:53:46,377] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-21 13:53:46,377] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-21 13:53:46,377] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-21 13:53:46,378] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-21 13:53:46,378] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-21 13:53:46,378] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-21 13:53:46,378] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-21 13:53:46,378] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-21 13:53:46,378] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f29ae59df40>
[2023-08-21 13:53:46,378] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-21 13:53:46,378] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-21 13:53:46,378] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-21 13:53:46,378] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-21 13:53:46,378] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-21 13:53:46,378] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-21 13:53:46,378] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-21 13:53:46,378] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-21 13:53:46,378] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-21 13:53:46,378] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-21 13:53:46,378] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-21 13:53:46,378] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-21 13:53:46,378] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-21 13:53:46,378] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f2984d3cdc0>
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-21 13:53:46,379] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-21 13:53:46,380] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-21 13:53:46,380] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-21 13:53:46,380] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-21 13:53:46,380] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-21 13:53:46,380] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-21 13:53:46,380] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-21 13:53:46,380] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.4832792282104492 seconds
Loading extension module utils...
Time to load utils op: 0.30419921875 seconds
Loading extension module utils...
Time to load utils op: 0.4059171676635742 seconds
Loading extension module utils...
Time to load utils op: 0.40446043014526367 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: 1. The question is asking about a location where there would be plumbing, but it wouldn't be of use to you if you were thirsty.
2. When we are thirsty, we need to drink water for hydration.
3. To understand the possibilities, let's investigate the options individually.
4. Option A: Oil refineries have plumbing to transport oil and various by-products. These pipelines do not contain drinking water.
5. Option B: Walls may have plumbing inside for residential water distribution, which contains water.
6. Option C: Shows represent an event place and they could also have some plumbing for firefighting or sanitary purposes, which again, contains water.
7. Option D: Own home obviously contains plenty of plumbing for water usage.
8. Option E: Water fountains have plumbing that contains water which is drinkable.
9. Comparing all the choices, the only one that doesn't have drinking water in its plumbing is the oil refinery.
10. Thus, the answer is A: Oil refineries.
So the final answer is A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Output: 1. Let's examine each answer choice closely. 
2. Choice A: working. This cannot be the answer because when a person is beginning work, they are working.
3. Choice B: resting. This also cannot be the answer because when a person is beginning work, they are inherently not resting.
4. Choice C: tiredness. Similarly, this cannot be the answer because this is a state that can occur both during and after work, but not necessarily when a person is beginning work. 
5. Choice E: momentum. This is not the answer because momentum refers to the drive or push for doing something, which would likely be present at the beginning of work.
6. Lastly, we look at Choice D: accomplishing. This is the correct answer because when a person is beginning work, they are in the process of attempting to accomplish something. Therefore, they aren't accomplishing something yet, as the task is merely just starting and there hasn't been enough time to complete anything meaningful.
So the final answer is D: accomplishing

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Output: 1. Begin by understanding what the question is asking. "Where might I find pens with a company logo?" The key here is "company logo". This implies a professional setting where a company will give out pens with their logo.
2. Let's eliminate the options that are not directly related to professional environments. "On a pencil" (B) is a place you wouldn't find a logoed pen because pens and pencils are different objects. "Write sentences on paper" (C) is not a place but an activity. 
3. Options "School" (D) and "Backpack" (E) could potentially have pens, but they are not the most direct answers. While a school or backpack might contain a logoed pen, they aren't places associated directly with companies. 
4. That leaves us with "Office" (A), which is a professional environment and the most likely place to find pens with a company logo. Companies often have pens with their logos in offices for employees to use or give to clients.
5. Therefore, the answer is A: Office.
So the final answer is A: office

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i3-s1-rTrue
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:46<37:39, 46.10s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:31<36:28, 45.60s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [02:16<35:36, 45.46s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [03:01<34:39, 45.21s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [03:46<33:53, 45.18s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [04:31<33:05, 45.12s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [05:16<32:21, 45.15s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [06:01<31:29, 44.98s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [06:46<30:47, 45.06s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [07:31<29:59, 44.98s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [08:16<29:14, 44.98s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [09:02<28:40, 45.26s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [09:47<27:50, 45.15s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [10:32<27:05, 45.15s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [11:17<26:19, 45.12s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [12:02<25:32, 45.08s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [12:47<24:48, 45.10s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [13:32<24:00, 45.00s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [14:16<23:10, 44.85s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [15:01<22:27, 44.92s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [15:46<21:43, 44.94s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [16:31<20:58, 44.94s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [17:17<20:15, 45.03s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [18:01<19:26, 44.88s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [18:47<18:47, 45.12s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [19:32<18:01, 45.06s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [20:17<17:15, 45.02s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [21:01<16:28, 44.94s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [21:46<15:43, 44.93s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [22:32<15:01, 45.05s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [23:17<14:18, 45.19s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [23:59<13:16, 44.27s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [24:44<12:36, 44.48s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [25:30<11:55, 44.74s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [26:14<11:11, 44.76s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [26:59<10:27, 44.81s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [27:45<09:44, 44.99s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [28:30<09:00, 45.02s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [29:15<08:15, 45.08s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [30:00<07:29, 44.99s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [30:45<06:45, 45.06s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [31:30<06:00, 45.05s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [32:15<05:15, 45.02s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [33:00<04:29, 44.90s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [33:44<03:44, 44.88s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [34:30<03:00, 45.13s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [35:15<02:15, 45.06s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [36:00<01:30, 45.10s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [36:45<00:45, 45.03s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [37:31<00:00, 45.22s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [37:31<00:00, 45.03s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 1.6918} | lm_loss 8.2776 | avg. gen lenth: 415.668
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i4-s1-rTrue --seed 1 --max-prompt-length 2048 --rationales --num-in-domain 4
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-21 14:31:24,459] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i4-s1-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 4
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i4-s1-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9737 [00:00<?, ?it/s]  0%|▏                                                     | 24/9737 [00:00<00:40, 238.60it/s]  0%|▎                                                     | 48/9737 [00:00<00:41, 231.58it/s]  1%|▍                                                     | 72/9737 [00:00<00:41, 234.38it/s]  1%|▌                                                     | 96/9737 [00:00<00:40, 235.78it/s]  1%|▋                                                    | 120/9737 [00:00<00:40, 236.44it/s]  1%|▊                                                    | 144/9737 [00:00<00:40, 236.79it/s]  2%|▉                                                    | 168/9737 [00:00<00:40, 237.23it/s]  2%|█                                                    | 192/9737 [00:00<00:40, 236.96it/s]  2%|█▏                                                   | 216/9737 [00:00<00:40, 235.47it/s]  2%|█▎                                                   | 240/9737 [00:01<00:40, 235.78it/s]  3%|█▍                                                   | 264/9737 [00:01<00:40, 235.24it/s]  3%|█▌                                                   | 288/9737 [00:01<00:40, 236.05it/s]  3%|█▋                                                   | 312/9737 [00:01<00:39, 236.81it/s]  3%|█▊                                                   | 336/9737 [00:01<00:39, 237.22it/s]  4%|█▉                                                   | 360/9737 [00:01<00:39, 237.73it/s]  4%|██                                                   | 384/9737 [00:01<00:39, 238.21it/s]  4%|██▏                                                  | 408/9737 [00:01<00:39, 238.45it/s]  4%|██▎                                                  | 432/9737 [00:01<00:39, 237.05it/s]  5%|██▍                                                  | 457/9737 [00:01<00:38, 238.03it/s]  5%|██▌                                                  | 481/9737 [00:02<00:38, 238.23it/s]  5%|██▋                                                  | 505/9737 [00:02<00:38, 238.32it/s]  5%|██▉                                                  | 529/9737 [00:02<00:38, 238.50it/s]  6%|███                                                  | 553/9737 [00:02<00:38, 238.55it/s]  6%|███▏                                                 | 577/9737 [00:02<00:38, 236.70it/s]  6%|███▎                                                 | 601/9737 [00:02<00:38, 236.96it/s]  6%|███▍                                                 | 625/9737 [00:02<00:38, 236.96it/s]  7%|███▌                                                 | 649/9737 [00:02<00:38, 237.38it/s]  7%|███▋                                                 | 676/9737 [00:02<00:36, 246.92it/s]  7%|███▉                                                 | 713/9737 [00:02<00:31, 282.08it/s]  8%|████                                                 | 750/9737 [00:03<00:29, 306.38it/s]  8%|████▎                                                | 787/9737 [00:03<00:27, 323.96it/s]  8%|████▍                                                | 824/9737 [00:03<00:26, 335.90it/s]  9%|████▋                                                | 861/9737 [00:03<00:25, 344.13it/s]  9%|████▉                                                | 897/9737 [00:03<00:25, 348.18it/s] 10%|█████                                                | 934/9737 [00:03<00:24, 352.43it/s] 10%|█████▎                                               | 971/9737 [00:03<00:24, 355.64it/s] 10%|█████▍                                              | 1007/9737 [00:03<00:24, 354.69it/s] 11%|█████▌                                              | 1044/9737 [00:03<00:24, 357.01it/s] 11%|█████▊                                              | 1081/9737 [00:03<00:24, 358.35it/s] 11%|█████▉                                              | 1117/9737 [00:04<00:24, 355.61it/s] 12%|██████▏                                             | 1154/9737 [00:04<00:24, 357.29it/s] 12%|██████▎                                             | 1191/9737 [00:04<00:23, 358.51it/s] 13%|██████▌                                             | 1228/9737 [00:04<00:23, 359.43it/s] 13%|██████▊                                             | 1265/9737 [00:04<00:23, 360.22it/s] 13%|██████▉                                             | 1302/9737 [00:04<00:23, 361.22it/s] 14%|███████▏                                            | 1339/9737 [00:04<00:23, 359.95it/s] 14%|███████▎                                            | 1376/9737 [00:04<00:23, 360.77it/s] 15%|███████▌                                            | 1413/9737 [00:04<00:23, 361.22it/s] 15%|███████▋                                            | 1450/9737 [00:04<00:22, 361.72it/s] 15%|███████▉                                            | 1487/9737 [00:05<00:22, 362.21it/s] 16%|████████▏                                           | 1524/9737 [00:05<00:22, 361.89it/s] 16%|████████▎                                           | 1561/9737 [00:05<00:22, 362.38it/s] 16%|████████▌                                           | 1598/9737 [00:05<00:22, 360.58it/s] 17%|████████▋                                           | 1635/9737 [00:05<00:22, 360.15it/s] 17%|████████▉                                           | 1672/9737 [00:05<00:22, 361.26it/s] 18%|█████████▏                                          | 1709/9737 [00:05<00:22, 361.81it/s] 18%|█████████▎                                          | 1746/9737 [00:05<00:22, 362.53it/s] 18%|█████████▌                                          | 1783/9737 [00:05<00:21, 362.68it/s] 19%|█████████▋                                          | 1820/9737 [00:06<00:23, 340.09it/s] 19%|█████████▉                                          | 1857/9737 [00:06<00:22, 346.38it/s] 19%|██████████                                          | 1894/9737 [00:06<00:22, 351.22it/s] 20%|██████████▎                                         | 1931/9737 [00:06<00:22, 354.46it/s] 20%|██████████▌                                         | 1968/9737 [00:06<00:21, 356.88it/s] 21%|██████████▋                                         | 2005/9737 [00:06<00:21, 359.07it/s] 21%|██████████▉                                         | 2041/9737 [00:06<00:21, 358.01it/s] 21%|███████████                                         | 2078/9737 [00:06<00:21, 359.21it/s] 22%|███████████▎                                        | 2115/9737 [00:06<00:21, 359.72it/s] 22%|███████████▍                                        | 2152/9737 [00:06<00:21, 360.38it/s] 22%|███████████▋                                        | 2189/9737 [00:07<00:20, 360.87it/s] 23%|███████████▉                                        | 2226/9737 [00:07<00:20, 360.22it/s] 23%|████████████                                        | 2263/9737 [00:07<00:20, 359.24it/s] 24%|████████████▎                                       | 2300/9737 [00:07<00:20, 360.40it/s] 24%|████████████▍                                       | 2337/9737 [00:07<00:20, 360.76it/s] 24%|████████████▋                                       | 2374/9737 [00:07<00:20, 361.66it/s] 25%|████████████▉                                       | 2411/9737 [00:07<00:20, 362.48it/s] 25%|█████████████                                       | 2448/9737 [00:07<00:20, 362.71it/s] 26%|█████████████▎                                      | 2485/9737 [00:07<00:20, 361.03it/s] 26%|█████████████▍                                      | 2522/9737 [00:07<00:19, 361.49it/s] 26%|█████████████▋                                      | 2559/9737 [00:08<00:19, 361.87it/s] 27%|█████████████▊                                      | 2596/9737 [00:08<00:19, 362.78it/s] 27%|██████████████                                      | 2633/9737 [00:08<00:19, 362.83it/s] 27%|██████████████▎                                     | 2670/9737 [00:08<00:19, 362.58it/s] 28%|██████████████▍                                     | 2707/9737 [00:08<00:19, 360.63it/s] 28%|██████████████▋                                     | 2744/9737 [00:08<00:19, 361.35it/s] 29%|██████████████▊                                     | 2781/9737 [00:08<00:19, 361.54it/s] 29%|███████████████                                     | 2818/9737 [00:08<00:19, 362.09it/s] 29%|███████████████▏                                    | 2855/9737 [00:08<00:19, 359.72it/s] 30%|███████████████▍                                    | 2892/9737 [00:08<00:18, 361.12it/s] 30%|███████████████▋                                    | 2929/9737 [00:09<00:18, 359.91it/s] 30%|███████████████▊                                    | 2966/9737 [00:09<00:18, 360.55it/s] 31%|████████████████                                    | 3003/9737 [00:09<00:18, 361.42it/s] 31%|████████████████▏                                   | 3040/9737 [00:09<00:18, 361.64it/s] 32%|████████████████▍                                   | 3077/9737 [00:09<00:18, 361.83it/s] 32%|████████████████▋                                   | 3114/9737 [00:09<00:18, 362.20it/s] 32%|████████████████▊                                   | 3151/9737 [00:09<00:18, 362.54it/s] 33%|█████████████████                                   | 3188/9737 [00:09<00:18, 361.00it/s] 33%|█████████████████▏                                  | 3225/9737 [00:09<00:18, 361.47it/s] 34%|█████████████████▍                                  | 3262/9737 [00:10<00:17, 361.78it/s] 34%|█████████████████▌                                  | 3299/9737 [00:10<00:17, 362.29it/s] 34%|█████████████████▊                                  | 3336/9737 [00:10<00:17, 362.08it/s] 35%|██████████████████                                  | 3373/9737 [00:10<00:17, 362.28it/s] 35%|██████████████████▏                                 | 3410/9737 [00:10<00:17, 360.78it/s] 35%|██████████████████▍                                 | 3447/9737 [00:10<00:17, 360.90it/s] 36%|██████████████████▌                                 | 3484/9737 [00:10<00:17, 361.44it/s] 36%|██████████████████▊                                 | 3521/9737 [00:10<00:17, 361.16it/s] 37%|███████████████████                                 | 3558/9737 [00:10<00:17, 361.70it/s] 37%|███████████████████▏                                | 3595/9737 [00:10<00:16, 361.74it/s] 37%|███████████████████▍                                | 3632/9737 [00:11<00:16, 360.45it/s] 38%|███████████████████▌                                | 3669/9737 [00:11<00:16, 360.87it/s] 38%|███████████████████▊                                | 3706/9737 [00:11<00:16, 361.58it/s] 38%|███████████████████▉                                | 3743/9737 [00:11<00:16, 361.81it/s] 39%|████████████████████▏                               | 3780/9737 [00:11<00:16, 362.09it/s] 39%|████████████████████▍                               | 3817/9737 [00:11<00:16, 361.93it/s] 40%|████████████████████▌                               | 3854/9737 [00:11<00:16, 360.46it/s] 40%|████████████████████▊                               | 3891/9737 [00:11<00:16, 361.40it/s] 40%|████████████████████▉                               | 3928/9737 [00:11<00:16, 361.86it/s] 41%|█████████████████████▏                              | 3965/9737 [00:11<00:15, 361.87it/s] 41%|█████████████████████▎                              | 4002/9737 [00:12<00:15, 362.24it/s] 41%|█████████████████████▌                              | 4039/9737 [00:12<00:15, 362.61it/s] 42%|█████████████████████▊                              | 4076/9737 [00:12<00:15, 357.69it/s] 42%|█████████████████████▉                              | 4113/9737 [00:12<00:15, 358.89it/s] 43%|██████████████████████▏                             | 4150/9737 [00:12<00:15, 359.59it/s] 43%|██████████████████████▎                             | 4187/9737 [00:12<00:15, 360.48it/s] 43%|██████████████████████▌                             | 4224/9737 [00:12<00:15, 361.12it/s] 44%|██████████████████████▊                             | 4261/9737 [00:12<00:15, 361.90it/s] 44%|██████████████████████▉                             | 4298/9737 [00:12<00:15, 360.69it/s] 45%|███████████████████████▏                            | 4335/9737 [00:12<00:14, 361.41it/s] 45%|███████████████████████▎                            | 4372/9737 [00:13<00:14, 361.97it/s] 45%|███████████████████████▌                            | 4409/9737 [00:13<00:14, 361.89it/s] 46%|███████████████████████▋                            | 4446/9737 [00:13<00:14, 361.65it/s] 46%|███████████████████████▉                            | 4483/9737 [00:13<00:14, 361.87it/s] 46%|████████████████████████▏                           | 4520/9737 [00:13<00:15, 335.53it/s] 47%|████████████████████████▎                           | 4557/9737 [00:13<00:15, 343.27it/s] 47%|████████████████████████▌                           | 4594/9737 [00:13<00:14, 349.10it/s] 48%|████████████████████████▋                           | 4631/9737 [00:13<00:14, 353.19it/s] 48%|████████████████████████▉                           | 4667/9737 [00:13<00:14, 353.59it/s] 48%|█████████████████████████                           | 4704/9737 [00:14<00:14, 356.27it/s] 49%|█████████████████████████▎                          | 4741/9737 [00:14<00:19, 256.21it/s] 49%|█████████████████████████▌                          | 4778/9737 [00:14<00:17, 280.65it/s] 49%|█████████████████████████▋                          | 4815/9737 [00:14<00:16, 301.19it/s] 50%|█████████████████████████▉                          | 4852/9737 [00:14<00:15, 316.92it/s] 50%|██████████████████████████                          | 4889/9737 [00:14<00:14, 329.20it/s] 51%|██████████████████████████▎                         | 4926/9737 [00:14<00:14, 338.73it/s] 51%|██████████████████████████▍                         | 4962/9737 [00:14<00:13, 344.05it/s] 51%|██████████████████████████▋                         | 4999/9737 [00:14<00:13, 348.99it/s] 52%|██████████████████████████▉                         | 5036/9737 [00:15<00:13, 353.11it/s] 52%|███████████████████████████                         | 5073/9737 [00:15<00:13, 355.41it/s] 52%|███████████████████████████▎                        | 5110/9737 [00:15<00:12, 357.57it/s] 53%|███████████████████████████▍                        | 5147/9737 [00:15<00:12, 359.27it/s] 53%|███████████████████████████▋                        | 5184/9737 [00:15<00:12, 358.74it/s] 54%|███████████████████████████▉                        | 5221/9737 [00:15<00:12, 360.17it/s] 54%|████████████████████████████                        | 5258/9737 [00:15<00:12, 357.67it/s] 54%|████████████████████████████▎                       | 5295/9737 [00:15<00:12, 359.21it/s] 55%|████████████████████████████▍                       | 5332/9737 [00:15<00:12, 359.83it/s] 55%|████████████████████████████▋                       | 5369/9737 [00:16<00:12, 360.81it/s] 56%|████████████████████████████▊                       | 5406/9737 [00:16<00:12, 359.36it/s] 56%|█████████████████████████████                       | 5443/9737 [00:16<00:11, 360.61it/s] 56%|█████████████████████████████▎                      | 5480/9737 [00:16<00:11, 362.25it/s] 57%|█████████████████████████████▍                      | 5518/9737 [00:16<00:11, 365.97it/s] 57%|█████████████████████████████▋                      | 5556/9737 [00:16<00:11, 368.44it/s] 57%|█████████████████████████████▊                      | 5594/9737 [00:16<00:11, 369.94it/s] 58%|██████████████████████████████                      | 5631/9737 [00:16<00:11, 369.18it/s] 58%|██████████████████████████████▎                     | 5669/9737 [00:16<00:10, 370.38it/s] 59%|██████████████████████████████▍                     | 5707/9737 [00:16<00:10, 371.33it/s] 59%|██████████████████████████████▋                     | 5745/9737 [00:17<00:10, 372.07it/s] 59%|██████████████████████████████▉                     | 5783/9737 [00:17<00:10, 372.63it/s] 60%|███████████████████████████████                     | 5821/9737 [00:17<00:10, 372.78it/s] 60%|███████████████████████████████▎                    | 5859/9737 [00:17<00:10, 370.73it/s] 61%|███████████████████████████████▍                    | 5897/9737 [00:17<00:10, 371.69it/s] 61%|███████████████████████████████▋                    | 5935/9737 [00:17<00:10, 372.42it/s] 61%|███████████████████████████████▉                    | 5973/9737 [00:17<00:10, 373.09it/s] 62%|████████████████████████████████                    | 6011/9737 [00:17<00:09, 373.11it/s] 62%|████████████████████████████████▎                   | 6049/9737 [00:17<00:09, 371.37it/s] 63%|████████████████████████████████▌                   | 6087/9737 [00:17<00:09, 369.92it/s] 63%|████████████████████████████████▋                   | 6125/9737 [00:18<00:09, 370.94it/s] 63%|████████████████████████████████▉                   | 6163/9737 [00:18<00:09, 371.79it/s] 64%|█████████████████████████████████                   | 6201/9737 [00:18<00:09, 372.30it/s] 64%|█████████████████████████████████▎                  | 6239/9737 [00:18<00:09, 372.38it/s] 64%|█████████████████████████████████▌                  | 6277/9737 [00:18<00:09, 372.84it/s] 65%|█████████████████████████████████▋                  | 6315/9737 [00:18<00:09, 370.96it/s] 65%|█████████████████████████████████▉                  | 6353/9737 [00:18<00:09, 371.31it/s] 66%|██████████████████████████████████▏                 | 6391/9737 [00:18<00:09, 371.73it/s] 66%|██████████████████████████████████▎                 | 6429/9737 [00:18<00:08, 372.30it/s] 66%|██████████████████████████████████▌                 | 6467/9737 [00:18<00:08, 372.24it/s] 67%|██████████████████████████████████▋                 | 6505/9737 [00:19<00:08, 372.86it/s] 67%|██████████████████████████████████▉                 | 6543/9737 [00:19<00:08, 371.30it/s] 68%|███████████████████████████████████▏                | 6581/9737 [00:19<00:08, 372.13it/s] 68%|███████████████████████████████████▎                | 6619/9737 [00:19<00:08, 372.55it/s] 68%|███████████████████████████████████▌                | 6657/9737 [00:19<00:08, 372.79it/s] 69%|███████████████████████████████████▊                | 6695/9737 [00:19<00:08, 372.56it/s] 69%|███████████████████████████████████▉                | 6733/9737 [00:19<00:08, 372.64it/s] 70%|████████████████████████████████████▏               | 6771/9737 [00:19<00:07, 370.77it/s] 70%|████████████████████████████████████▎               | 6809/9737 [00:19<00:07, 371.75it/s] 70%|████████████████████████████████████▌               | 6847/9737 [00:19<00:07, 371.85it/s] 71%|████████████████████████████████████▊               | 6885/9737 [00:20<00:07, 372.36it/s] 71%|████████████████████████████████████▉               | 6923/9737 [00:20<00:07, 372.84it/s] 71%|█████████████████████████████████████▏              | 6961/9737 [00:20<00:07, 373.12it/s] 72%|█████████████████████████████████████▍              | 6999/9737 [00:20<00:07, 370.83it/s] 72%|█████████████████████████████████████▌              | 7037/9737 [00:20<00:07, 371.23it/s] 73%|█████████████████████████████████████▊              | 7075/9737 [00:20<00:07, 371.78it/s] 73%|█████████████████████████████████████▉              | 7113/9737 [00:20<00:07, 372.25it/s] 73%|██████████████████████████████████████▏             | 7151/9737 [00:20<00:06, 372.43it/s] 74%|██████████████████████████████████████▍             | 7189/9737 [00:20<00:06, 372.87it/s] 74%|██████████████████████████████████████▌             | 7227/9737 [00:21<00:06, 371.17it/s] 75%|██████████████████████████████████████▊             | 7265/9737 [00:21<00:06, 371.81it/s] 75%|███████████████████████████████████████             | 7303/9737 [00:21<00:06, 372.07it/s] 75%|███████████████████████████████████████▏            | 7341/9737 [00:21<00:06, 371.86it/s] 76%|███████████████████████████████████████▍            | 7379/9737 [00:21<00:06, 372.15it/s] 76%|███████████████████████████████████████▌            | 7417/9737 [00:21<00:06, 372.23it/s] 77%|███████████████████████████████████████▊            | 7455/9737 [00:21<00:06, 349.97it/s] 77%|████████████████████████████████████████            | 7493/9737 [00:21<00:06, 356.60it/s] 77%|████████████████████████████████████████▏           | 7531/9737 [00:21<00:06, 361.05it/s] 78%|████████████████████████████████████████▍           | 7569/9737 [00:21<00:05, 364.58it/s] 78%|████████████████████████████████████████▌           | 7607/9737 [00:22<00:05, 366.87it/s] 79%|████████████████████████████████████████▊           | 7645/9737 [00:22<00:05, 368.26it/s] 79%|█████████████████████████████████████████           | 7682/9737 [00:22<00:05, 366.89it/s] 79%|█████████████████████████████████████████▏          | 7720/9737 [00:22<00:05, 368.91it/s] 80%|█████████████████████████████████████████▍          | 7758/9737 [00:22<00:05, 370.36it/s] 80%|█████████████████████████████████████████▋          | 7796/9737 [00:22<00:05, 371.17it/s] 80%|█████████████████████████████████████████▊          | 7834/9737 [00:22<00:05, 371.74it/s] 81%|██████████████████████████████████████████          | 7872/9737 [00:22<00:05, 372.06it/s] 81%|██████████████████████████████████████████▏         | 7910/9737 [00:22<00:04, 370.71it/s] 82%|██████████████████████████████████████████▍         | 7948/9737 [00:22<00:04, 370.86it/s] 82%|██████████████████████████████████████████▋         | 7986/9737 [00:23<00:04, 371.13it/s] 82%|██████████████████████████████████████████▊         | 8024/9737 [00:23<00:04, 371.60it/s] 83%|███████████████████████████████████████████         | 8062/9737 [00:23<00:04, 371.86it/s] 83%|███████████████████████████████████████████▎        | 8100/9737 [00:23<00:04, 372.49it/s] 84%|███████████████████████████████████████████▍        | 8138/9737 [00:23<00:04, 371.26it/s] 84%|███████████████████████████████████████████▋        | 8176/9737 [00:23<00:04, 371.72it/s] 84%|███████████████████████████████████████████▊        | 8214/9737 [00:23<00:04, 372.33it/s] 85%|████████████████████████████████████████████        | 8252/9737 [00:23<00:03, 372.31it/s] 85%|████████████████████████████████████████████▎       | 8290/9737 [00:23<00:03, 371.67it/s] 86%|████████████████████████████████████████████▍       | 8328/9737 [00:23<00:03, 371.57it/s] 86%|████████████████████████████████████████████▋       | 8366/9737 [00:24<00:03, 370.02it/s] 86%|████████████████████████████████████████████▉       | 8404/9737 [00:24<00:03, 370.73it/s] 87%|█████████████████████████████████████████████       | 8442/9737 [00:24<00:03, 371.66it/s] 87%|█████████████████████████████████████████████▎      | 8480/9737 [00:24<00:03, 371.86it/s] 87%|█████████████████████████████████████████████▍      | 8518/9737 [00:24<00:03, 371.73it/s] 88%|█████████████████████████████████████████████▋      | 8556/9737 [00:24<00:03, 371.84it/s] 88%|█████████████████████████████████████████████▉      | 8594/9737 [00:24<00:03, 369.12it/s] 89%|██████████████████████████████████████████████      | 8632/9737 [00:24<00:02, 369.46it/s] 89%|██████████████████████████████████████████████▎     | 8670/9737 [00:24<00:02, 370.04it/s] 89%|██████████████████████████████████████████████▌     | 8708/9737 [00:25<00:02, 369.91it/s] 90%|██████████████████████████████████████████████▋     | 8745/9737 [00:25<00:02, 369.25it/s] 90%|██████████████████████████████████████████████▉     | 8783/9737 [00:25<00:02, 370.18it/s] 91%|███████████████████████████████████████████████     | 8821/9737 [00:25<00:02, 369.01it/s] 91%|███████████████████████████████████████████████▎    | 8859/9737 [00:25<00:02, 369.89it/s] 91%|███████████████████████████████████████████████▌    | 8897/9737 [00:25<00:02, 370.13it/s] 92%|███████████████████████████████████████████████▋    | 8935/9737 [00:25<00:02, 370.76it/s] 92%|███████████████████████████████████████████████▉    | 8973/9737 [00:25<00:02, 371.19it/s] 93%|████████████████████████████████████████████████    | 9011/9737 [00:25<00:01, 371.49it/s] 93%|████████████████████████████████████████████████▎   | 9049/9737 [00:25<00:01, 370.00it/s] 93%|████████████████████████████████████████████████▌   | 9087/9737 [00:26<00:01, 370.89it/s] 94%|████████████████████████████████████████████████▋   | 9125/9737 [00:26<00:01, 371.46it/s] 94%|████████████████████████████████████████████████▉   | 9163/9737 [00:26<00:01, 371.62it/s] 94%|█████████████████████████████████████████████████▏  | 9201/9737 [00:26<00:01, 371.64it/s] 95%|█████████████████████████████████████████████████▎  | 9239/9737 [00:26<00:01, 371.23it/s] 95%|█████████████████████████████████████████████████▌  | 9277/9737 [00:26<00:01, 369.48it/s] 96%|█████████████████████████████████████████████████▋  | 9315/9737 [00:26<00:01, 369.97it/s] 96%|█████████████████████████████████████████████████▉  | 9353/9737 [00:26<00:01, 370.56it/s] 96%|██████████████████████████████████████████████████▏ | 9391/9737 [00:26<00:00, 371.39it/s] 97%|██████████████████████████████████████████████████▎ | 9429/9737 [00:26<00:00, 371.69it/s] 97%|██████████████████████████████████████████████████▌ | 9467/9737 [00:27<00:00, 371.61it/s] 98%|██████████████████████████████████████████████████▊ | 9505/9737 [00:27<00:00, 370.05it/s] 98%|██████████████████████████████████████████████████▉ | 9543/9737 [00:27<00:00, 370.48it/s] 98%|███████████████████████████████████████████████████▏| 9581/9737 [00:27<00:00, 370.66it/s] 99%|███████████████████████████████████████████████████▎| 9619/9737 [00:27<00:00, 370.75it/s] 99%|███████████████████████████████████████████████████▌| 9657/9737 [00:27<00:00, 370.79it/s]100%|███████████████████████████████████████████████████▊| 9695/9737 [00:27<00:00, 371.30it/s]100%|███████████████████████████████████████████████████▉| 9733/9737 [00:27<00:00, 369.90it/s]100%|████████████████████████████████████████████████████| 9737/9737 [00:27<00:00, 350.27it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.24s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.08s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.10s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.33s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.17s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.04s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:04,  5.00s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.23s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.61s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.77s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.46s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.62s/it]
[2023-08-21 14:32:44,113] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.47s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.62s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.62s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.80s/it]
[2023-08-21 14:32:51,720] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-21 14:32:51,721] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-21 14:32:51,722] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-21 14:32:51,722] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-21 14:32:51,722] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-21 14:32:51,722] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f8600ecaf40>
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-21 14:32:51,723] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f85d8179dc0>
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-21 14:32:51,724] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-21 14:32:51,725] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-21 14:32:51,725] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-21 14:32:51,725] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-21 14:32:51,725] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-21 14:32:51,725] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-21 14:32:51,725] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-21 14:32:51,725] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-21 14:32:51,725] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.4522836208343506 seconds
Loading extension module utils...
Time to load utils op: 0.4044163227081299 seconds
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.5047407150268555 seconds
Time to load utils op: 0.5047478675842285 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: 1. The question asks where you would find plumbing that is not useful to you when you are thirsty.
2. This means we're looking for a place with plumbing that does not contain potable, or drinkable, water.
3. The choices are: oil refineries, a wall, a show, your own home, and a water fountain.
4. You can eliminate "a wall" because generally, walls do not have plumbing.
5. You can also eliminate "a show" because it refers to a type of event rather than a place which could contain plumbing.
6. In your own home and at water fountains, you would generally expect the plumbing to supply clean, drinkable water. Therefore, these can also be eliminated.
7. That leaves "oil refineries." Oil refineries use complex systems of plumbing to transport and process oil.
8. You wouldn't want to or be able to drink the liquids (like oil or other chemicals) passing through an oil refinery's plumbing system. 
9. Therefore, the answer is A: oil refineries.
So the final answer is A: oil refineries.

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Output: 1. The question is asking for what a person isn't doing yet when they are beginning to work. 

2. Let's analyze each answer choice: 

   A: working - this suggests that the person is actually in action. But since they are just starting, they may not yet be fully engaged. However, they are still technically working. So, this isn't the right choice.
  
   B: resting - this implies that the person is not involved in any activities. If they are beginning to work, then they are definitely not resting. This answer can be eliminated as well.
   
   C: tiredness - this relates to a physical or mental state of exhaustion. It is possible that a person might feel tired at the beginning of work. However, it isn't necessarily true that they are not experiencing tiredness. So, this isn't the best choice.
   
   D: accomplishing - this refers to the act of achieving or completing something. If the person is just beginning to work, they have not completed or achieved their task yet. Thus, this could be a possible correct answer.
   
   E: momentum - this implies movement or progress. Since the person is just beginning work, they haven't started gaining momentum yet. It could be a close contender, but not as precise as choice D.

3. Therefore, the best answer is D: accomplishing, because when a person is just starting to work, they are not yet achieving or completing anything.
So the final answer is D: accomplishing.

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Output: Step 1: Understand the question, which is asking for a location where pens with a company logo might be found.
Step 2: Review each of the choices individually and analyze their relevance to the question.
Step 3: Look at choice A: "Office". This is a common setting where pens are used and many companies distribute logoed pens as promotional items to their employees or during meetings.
Step 4: Look at choice B: "On a pencil". This doesn't provide a location, rather a different object. This is not a logical answer to the question. 
Step 5: Look at choice C: "Write sentences on paper". This again is not a location so it cannot be the correct answer. 
Step 6: Look at choice D: "School". While this is a location and pens are used here, it's less usual to find pens with a company logo at a school as compared to an office.
Step 7: Look at choice E: "Backpack". Bags might hold pens, but it's not directly related to company logo pens, as these could be anywhere rather than specifically in a backpack.
Step 8: After reviewing all the choices, choice A "office" appears to be the most likely and logical location to find pens with a company logo.
So the final answer is A: office.

Input: Billy called out to John, and listened for what? Choices:  A: silence B: response C: communication D: hanging up E: whisper
Output: 1. The question is about what Billy is expecting after he calls out to John.
2. To understand what Billy is expecting, we have to understand the usual sequence of events in a conversation.
3. When one person calls out to another, typically they are doing so to elicit some sort of reaction.
4. This reaction can take on various forms but in the context of a conversation, this reaction is usually a response.
5. Among the answer choices provided, "response" is the one that suits best in this context.
6. Therefore, the answer is B: response.
So the final answer is B: response.

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i4-s1-rTrue
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:42<34:56, 42.79s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:25<33:59, 42.48s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [02:07<33:11, 42.37s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [02:49<32:24, 42.28s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [03:31<31:46, 42.37s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [04:14<31:03, 42.34s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [04:56<30:20, 42.34s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [05:39<29:39, 42.36s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [06:21<28:56, 42.34s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [07:03<28:13, 42.35s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [07:46<27:35, 42.44s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [08:28<26:52, 42.44s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [09:11<26:11, 42.47s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [09:53<25:26, 42.40s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [10:35<24:42, 42.35s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [11:17<23:57, 42.29s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [12:00<23:16, 42.31s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [12:42<22:36, 42.38s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [13:23<21:34, 41.76s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [14:05<20:57, 41.93s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [14:47<20:18, 42.02s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [15:29<19:36, 42.03s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [16:11<18:55, 42.06s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [16:54<18:15, 42.12s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [17:36<17:36, 42.24s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [18:19<16:57, 42.38s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [19:01<16:15, 42.43s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [19:44<15:32, 42.37s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [20:26<14:50, 42.41s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [21:09<14:09, 42.47s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [21:51<13:26, 42.43s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [22:33<12:42, 42.36s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [23:16<11:59, 42.35s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [23:58<11:17, 42.33s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [24:40<10:35, 42.37s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [25:23<09:53, 42.36s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [26:06<09:13, 42.56s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [26:48<08:28, 42.38s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [27:31<07:48, 42.59s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [28:13<07:05, 42.51s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [28:55<06:22, 42.48s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [29:38<05:39, 42.49s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [30:20<04:57, 42.44s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [31:03<04:14, 42.40s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [31:45<03:31, 42.37s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [32:27<02:49, 42.41s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [33:10<02:07, 42.40s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [33:52<01:24, 42.38s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [34:35<00:42, 42.48s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [35:17<00:00, 42.44s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [35:17<00:00, 42.35s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 1.7481} | lm_loss 8.1333 | avg. gen lenth: 398.764
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i5-s1-rTrue --seed 1 --max-prompt-length 2048 --rationales --num-in-domain 5
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-21 15:08:18,673] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i5-s1-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 5
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i5-s1-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9736 [00:00<?, ?it/s]  0%|                                                      | 19/9736 [00:00<00:51, 188.41it/s]  0%|▏                                                     | 38/9736 [00:00<00:51, 188.98it/s]  1%|▎                                                     | 58/9736 [00:00<00:51, 189.57it/s]  1%|▍                                                     | 78/9736 [00:00<00:50, 190.18it/s]  1%|▌                                                     | 98/9736 [00:00<00:50, 190.55it/s]  1%|▋                                                    | 118/9736 [00:00<00:51, 187.42it/s]  1%|▊                                                    | 138/9736 [00:00<00:50, 188.33it/s]  2%|▊                                                    | 158/9736 [00:00<00:50, 189.14it/s]  2%|▉                                                    | 178/9736 [00:00<00:50, 189.48it/s]  2%|█                                                    | 198/9736 [00:01<00:50, 189.78it/s]  2%|█▏                                                   | 217/9736 [00:01<00:50, 188.45it/s]  2%|█▎                                                   | 237/9736 [00:01<00:50, 189.11it/s]  3%|█▍                                                   | 262/9736 [00:01<00:45, 206.50it/s]  3%|█▌                                                   | 291/9736 [00:01<00:40, 230.93it/s]  3%|█▋                                                   | 320/9736 [00:01<00:37, 248.39it/s]  4%|█▉                                                   | 348/9736 [00:01<00:36, 257.05it/s]  4%|██                                                   | 377/9736 [00:01<00:35, 266.56it/s]  4%|██▏                                                  | 406/9736 [00:01<00:34, 273.50it/s]  4%|██▎                                                  | 434/9736 [00:01<00:33, 275.28it/s]  5%|██▌                                                  | 463/9736 [00:02<00:33, 278.84it/s]  5%|██▋                                                  | 492/9736 [00:02<00:32, 281.60it/s]  5%|██▊                                                  | 521/9736 [00:02<00:32, 283.95it/s]  6%|██▉                                                  | 550/9736 [00:02<00:32, 285.58it/s]  6%|███▏                                                 | 579/9736 [00:02<00:31, 286.66it/s]  6%|███▎                                                 | 608/9736 [00:02<00:31, 287.45it/s]  7%|███▍                                                 | 637/9736 [00:02<00:31, 287.58it/s]  7%|███▋                                                 | 666/9736 [00:02<00:31, 286.12it/s]  7%|███▊                                                 | 695/9736 [00:02<00:31, 287.04it/s]  7%|███▉                                                 | 724/9736 [00:02<00:32, 275.77it/s]  8%|████                                                 | 753/9736 [00:03<00:32, 279.64it/s]  8%|████▎                                                | 782/9736 [00:03<00:31, 282.22it/s]  8%|████▍                                                | 811/9736 [00:03<00:31, 284.03it/s]  9%|████▌                                                | 840/9736 [00:03<00:31, 285.40it/s]  9%|████▋                                                | 869/9736 [00:03<00:30, 286.44it/s]  9%|████▉                                                | 898/9736 [00:03<00:31, 285.03it/s] 10%|█████                                                | 927/9736 [00:03<00:30, 285.79it/s] 10%|█████▏                                               | 956/9736 [00:03<00:30, 286.50it/s] 10%|█████▎                                               | 985/9736 [00:03<00:30, 287.18it/s] 10%|█████▍                                              | 1014/9736 [00:03<00:30, 286.55it/s] 11%|█████▌                                              | 1043/9736 [00:04<00:30, 286.86it/s] 11%|█████▋                                              | 1072/9736 [00:04<00:30, 287.41it/s] 11%|█████▉                                              | 1101/9736 [00:04<00:29, 287.86it/s] 12%|██████                                              | 1130/9736 [00:04<00:30, 286.13it/s] 12%|██████▏                                             | 1159/9736 [00:04<00:29, 286.70it/s] 12%|██████▎                                             | 1188/9736 [00:04<00:29, 286.95it/s] 12%|██████▌                                             | 1217/9736 [00:04<00:29, 287.07it/s] 13%|██████▋                                             | 1246/9736 [00:04<00:29, 287.36it/s] 13%|██████▊                                             | 1275/9736 [00:04<00:29, 287.51it/s] 13%|██████▉                                             | 1304/9736 [00:04<00:29, 287.45it/s] 14%|███████                                             | 1333/9736 [00:05<00:29, 287.69it/s] 14%|███████▎                                            | 1362/9736 [00:05<00:29, 285.98it/s] 14%|███████▍                                            | 1391/9736 [00:05<00:29, 286.23it/s] 15%|███████▌                                            | 1420/9736 [00:05<00:29, 286.05it/s] 15%|███████▋                                            | 1449/9736 [00:05<00:28, 285.76it/s] 15%|███████▉                                            | 1478/9736 [00:05<00:28, 285.55it/s] 15%|████████                                            | 1507/9736 [00:05<00:28, 285.13it/s] 16%|████████▏                                           | 1536/9736 [00:05<00:28, 285.36it/s] 16%|████████▎                                           | 1565/9736 [00:05<00:28, 283.78it/s] 16%|████████▌                                           | 1594/9736 [00:06<00:28, 284.09it/s] 17%|████████▋                                           | 1623/9736 [00:06<00:28, 284.58it/s] 17%|████████▊                                           | 1652/9736 [00:06<00:28, 284.97it/s] 17%|████████▉                                           | 1681/9736 [00:06<00:28, 285.02it/s] 18%|█████████▏                                          | 1710/9736 [00:06<00:28, 285.20it/s] 18%|█████████▎                                          | 1739/9736 [00:06<00:28, 285.29it/s] 18%|█████████▍                                          | 1768/9736 [00:06<00:27, 285.35it/s] 18%|█████████▌                                          | 1797/9736 [00:06<00:29, 268.15it/s] 19%|█████████▊                                          | 1826/9736 [00:06<00:28, 273.00it/s] 19%|█████████▉                                          | 1855/9736 [00:06<00:28, 276.57it/s] 19%|██████████                                          | 1884/9736 [00:07<00:28, 278.49it/s] 20%|██████████▏                                         | 1913/9736 [00:07<00:27, 280.49it/s] 20%|██████████▎                                         | 1942/9736 [00:07<00:27, 281.80it/s] 20%|██████████▌                                         | 1971/9736 [00:07<00:27, 282.81it/s] 21%|██████████▋                                         | 2000/9736 [00:07<00:27, 283.64it/s] 21%|██████████▊                                         | 2029/9736 [00:07<00:27, 282.06it/s] 21%|██████████▉                                         | 2058/9736 [00:07<00:27, 282.74it/s] 21%|███████████▏                                        | 2087/9736 [00:07<00:27, 283.04it/s] 22%|███████████▎                                        | 2116/9736 [00:07<00:27, 281.48it/s] 22%|███████████▍                                        | 2145/9736 [00:07<00:26, 282.35it/s] 22%|███████████▌                                        | 2174/9736 [00:08<00:26, 283.30it/s] 23%|███████████▊                                        | 2203/9736 [00:08<00:26, 283.74it/s] 23%|███████████▉                                        | 2232/9736 [00:08<00:26, 284.22it/s] 23%|████████████                                        | 2261/9736 [00:08<00:26, 282.57it/s] 24%|████████████▏                                       | 2290/9736 [00:08<00:26, 283.28it/s] 24%|████████████▍                                       | 2319/9736 [00:08<00:26, 283.69it/s] 24%|████████████▌                                       | 2348/9736 [00:08<00:25, 284.24it/s] 24%|████████████▋                                       | 2377/9736 [00:08<00:25, 284.67it/s] 25%|████████████▊                                       | 2406/9736 [00:08<00:25, 284.97it/s] 25%|█████████████                                       | 2435/9736 [00:08<00:25, 284.92it/s] 25%|█████████████▏                                      | 2464/9736 [00:09<00:25, 285.00it/s] 26%|█████████████▎                                      | 2493/9736 [00:09<00:25, 280.43it/s] 26%|█████████████▍                                      | 2522/9736 [00:09<00:25, 281.62it/s] 26%|█████████████▌                                      | 2551/9736 [00:09<00:25, 282.36it/s] 26%|█████████████▊                                      | 2580/9736 [00:09<00:25, 283.28it/s] 27%|█████████████▉                                      | 2609/9736 [00:09<00:25, 283.84it/s] 27%|██████████████                                      | 2638/9736 [00:09<00:25, 283.84it/s] 27%|██████████████▏                                     | 2667/9736 [00:09<00:24, 284.17it/s] 28%|██████████████▍                                     | 2696/9736 [00:09<00:24, 283.97it/s] 28%|██████████████▌                                     | 2725/9736 [00:10<00:24, 281.91it/s] 28%|██████████████▋                                     | 2754/9736 [00:10<00:24, 282.77it/s] 29%|██████████████▊                                     | 2783/9736 [00:10<00:24, 283.07it/s] 29%|███████████████                                     | 2812/9736 [00:10<00:24, 283.33it/s] 29%|███████████████▏                                    | 2841/9736 [00:10<00:24, 283.87it/s] 29%|███████████████▎                                    | 2870/9736 [00:10<00:24, 284.13it/s] 30%|███████████████▍                                    | 2899/9736 [00:10<00:24, 284.13it/s] 30%|███████████████▋                                    | 2928/9736 [00:10<00:24, 282.54it/s] 30%|███████████████▊                                    | 2957/9736 [00:10<00:23, 282.91it/s] 31%|███████████████▉                                    | 2986/9736 [00:10<00:23, 283.43it/s] 31%|████████████████                                    | 3015/9736 [00:11<00:23, 283.46it/s] 31%|████████████████▎                                   | 3044/9736 [00:11<00:23, 283.75it/s] 32%|████████████████▍                                   | 3073/9736 [00:11<00:23, 283.87it/s] 32%|████████████████▌                                   | 3102/9736 [00:11<00:23, 284.07it/s] 32%|████████████████▋                                   | 3131/9736 [00:11<00:23, 284.06it/s] 32%|████████████████▉                                   | 3160/9736 [00:11<00:23, 282.21it/s] 33%|█████████████████                                   | 3189/9736 [00:11<00:23, 283.05it/s] 33%|█████████████████▏                                  | 3218/9736 [00:11<00:23, 283.31it/s] 33%|█████████████████▎                                  | 3247/9736 [00:11<00:22, 283.74it/s] 34%|█████████████████▍                                  | 3276/9736 [00:11<00:22, 283.79it/s] 34%|█████████████████▋                                  | 3305/9736 [00:12<00:22, 283.86it/s] 34%|█████████████████▊                                  | 3334/9736 [00:12<00:22, 283.78it/s] 35%|█████████████████▉                                  | 3363/9736 [00:12<00:22, 283.77it/s] 35%|██████████████████                                  | 3392/9736 [00:12<00:22, 281.85it/s] 35%|██████████████████▎                                 | 3421/9736 [00:12<00:22, 282.68it/s] 35%|██████████████████▍                                 | 3450/9736 [00:12<00:22, 282.95it/s] 36%|██████████████████▌                                 | 3479/9736 [00:12<00:22, 283.13it/s] 36%|██████████████████▋                                 | 3508/9736 [00:12<00:21, 283.10it/s] 36%|██████████████████▉                                 | 3537/9736 [00:12<00:21, 283.48it/s] 37%|███████████████████                                 | 3566/9736 [00:12<00:21, 283.60it/s] 37%|███████████████████▏                                | 3595/9736 [00:13<00:21, 281.21it/s] 37%|███████████████████▎                                | 3624/9736 [00:13<00:21, 280.29it/s] 38%|███████████████████▌                                | 3653/9736 [00:13<00:21, 281.52it/s] 38%|███████████████████▋                                | 3682/9736 [00:13<00:21, 282.32it/s] 38%|███████████████████▊                                | 3711/9736 [00:13<00:21, 282.89it/s] 38%|███████████████████▉                                | 3740/9736 [00:13<00:21, 283.38it/s] 39%|████████████████████▏                               | 3769/9736 [00:13<00:21, 283.70it/s] 39%|████████████████████▎                               | 3798/9736 [00:13<00:20, 283.96it/s] 39%|████████████████████▍                               | 3827/9736 [00:13<00:20, 284.17it/s] 40%|████████████████████▌                               | 3856/9736 [00:14<00:20, 282.25it/s] 40%|████████████████████▋                               | 3885/9736 [00:14<00:20, 282.89it/s] 40%|████████████████████▉                               | 3914/9736 [00:14<00:20, 283.34it/s] 40%|█████████████████████                               | 3943/9736 [00:14<00:20, 283.55it/s] 41%|█████████████████████▏                              | 3972/9736 [00:14<00:20, 281.18it/s] 41%|█████████████████████▎                              | 4001/9736 [00:14<00:20, 282.21it/s] 41%|█████████████████████▌                              | 4030/9736 [00:14<00:20, 282.76it/s] 42%|█████████████████████▋                              | 4059/9736 [00:14<00:20, 283.37it/s] 42%|█████████████████████▊                              | 4088/9736 [00:14<00:20, 281.97it/s] 42%|█████████████████████▉                              | 4117/9736 [00:14<00:19, 282.55it/s] 43%|██████████████████████▏                             | 4146/9736 [00:15<00:19, 282.75it/s] 43%|██████████████████████▎                             | 4175/9736 [00:15<00:19, 283.24it/s] 43%|██████████████████████▍                             | 4204/9736 [00:15<00:19, 283.47it/s] 43%|██████████████████████▌                             | 4233/9736 [00:15<00:19, 283.69it/s] 44%|██████████████████████▊                             | 4262/9736 [00:15<00:19, 284.06it/s] 44%|██████████████████████▉                             | 4291/9736 [00:15<00:19, 282.64it/s] 44%|███████████████████████                             | 4320/9736 [00:15<00:19, 280.79it/s] 45%|███████████████████████▏                            | 4349/9736 [00:15<00:19, 281.74it/s] 45%|███████████████████████▍                            | 4378/9736 [00:15<00:18, 282.47it/s] 45%|███████████████████████▌                            | 4407/9736 [00:15<00:18, 282.81it/s] 46%|███████████████████████▋                            | 4436/9736 [00:16<00:18, 283.03it/s] 46%|███████████████████████▊                            | 4465/9736 [00:16<00:18, 283.43it/s] 46%|████████████████████████                            | 4494/9736 [00:16<00:18, 283.77it/s] 46%|████████████████████████▏                           | 4523/9736 [00:16<00:21, 248.12it/s] 47%|████████████████████████▎                           | 4552/9736 [00:16<00:20, 258.07it/s] 47%|████████████████████████▍                           | 4581/9736 [00:16<00:19, 265.31it/s] 47%|████████████████████████▌                           | 4610/9736 [00:16<00:18, 270.85it/s] 48%|████████████████████████▊                           | 4639/9736 [00:16<00:18, 274.65it/s] 48%|████████████████████████▉                           | 4668/9736 [00:16<00:18, 277.36it/s] 48%|█████████████████████████                           | 4696/9736 [00:17<00:18, 277.09it/s] 49%|█████████████████████████▏                          | 4725/9736 [00:17<00:17, 278.46it/s] 49%|█████████████████████████▍                          | 4753/9736 [00:17<00:26, 186.15it/s] 49%|█████████████████████████▌                          | 4782/9736 [00:17<00:23, 207.87it/s] 49%|█████████████████████████▋                          | 4811/9736 [00:17<00:21, 226.24it/s] 50%|█████████████████████████▊                          | 4840/9736 [00:17<00:20, 241.03it/s] 50%|██████████████████████████                          | 4869/9736 [00:17<00:19, 252.35it/s] 50%|██████████████████████████▏                         | 4898/9736 [00:17<00:18, 261.18it/s] 51%|██████████████████████████▎                         | 4927/9736 [00:18<00:17, 267.64it/s] 51%|██████████████████████████▍                         | 4955/9736 [00:18<00:17, 270.98it/s] 51%|██████████████████████████▌                         | 4984/9736 [00:18<00:17, 275.01it/s] 51%|██████████████████████████▊                         | 5013/9736 [00:18<00:16, 277.86it/s] 52%|██████████████████████████▉                         | 5042/9736 [00:18<00:16, 280.34it/s] 52%|███████████████████████████                         | 5071/9736 [00:18<00:16, 282.02it/s] 52%|███████████████████████████▏                        | 5100/9736 [00:18<00:16, 283.08it/s] 53%|███████████████████████████▍                        | 5129/9736 [00:18<00:16, 282.48it/s] 53%|███████████████████████████▌                        | 5158/9736 [00:18<00:16, 283.65it/s] 53%|███████████████████████████▋                        | 5187/9736 [00:18<00:16, 282.39it/s] 54%|███████████████████████████▊                        | 5216/9736 [00:19<00:15, 283.33it/s] 54%|████████████████████████████                        | 5245/9736 [00:19<00:15, 283.78it/s] 54%|████████████████████████████▏                       | 5274/9736 [00:19<00:15, 284.35it/s] 54%|████████████████████████████▎                       | 5303/9736 [00:19<00:15, 284.97it/s] 55%|████████████████████████████▍                       | 5332/9736 [00:19<00:15, 284.88it/s] 55%|████████████████████████████▋                       | 5361/9736 [00:19<00:15, 285.22it/s] 55%|████████████████████████████▊                       | 5390/9736 [00:19<00:15, 285.29it/s] 56%|████████████████████████████▉                       | 5419/9736 [00:19<00:15, 283.47it/s] 56%|█████████████████████████████                       | 5448/9736 [00:19<00:15, 284.36it/s] 56%|█████████████████████████████▎                      | 5477/9736 [00:19<00:14, 285.17it/s] 57%|█████████████████████████████▍                      | 5507/9736 [00:20<00:14, 287.65it/s] 57%|█████████████████████████████▌                      | 5537/9736 [00:20<00:14, 289.45it/s] 57%|█████████████████████████████▋                      | 5567/9736 [00:20<00:14, 290.81it/s] 57%|█████████████████████████████▉                      | 5597/9736 [00:20<00:14, 291.40it/s] 58%|██████████████████████████████                      | 5627/9736 [00:20<00:14, 290.59it/s] 58%|██████████████████████████████▏                     | 5657/9736 [00:20<00:13, 291.60it/s] 58%|██████████████████████████████▎                     | 5687/9736 [00:20<00:13, 292.13it/s] 59%|██████████████████████████████▌                     | 5717/9736 [00:20<00:13, 292.17it/s] 59%|██████████████████████████████▋                     | 5747/9736 [00:20<00:13, 292.64it/s] 59%|██████████████████████████████▊                     | 5777/9736 [00:20<00:13, 293.05it/s] 60%|███████████████████████████████                     | 5807/9736 [00:21<00:13, 292.83it/s] 60%|███████████████████████████████▏                    | 5837/9736 [00:21<00:13, 292.78it/s] 60%|███████████████████████████████▎                    | 5867/9736 [00:21<00:13, 291.37it/s] 61%|███████████████████████████████▍                    | 5897/9736 [00:21<00:13, 292.05it/s] 61%|███████████████████████████████▋                    | 5927/9736 [00:21<00:13, 292.42it/s] 61%|███████████████████████████████▊                    | 5957/9736 [00:21<00:12, 292.93it/s] 61%|███████████████████████████████▉                    | 5987/9736 [00:21<00:12, 293.36it/s] 62%|████████████████████████████████▏                   | 6017/9736 [00:21<00:12, 293.48it/s] 62%|████████████████████████████████▎                   | 6047/9736 [00:21<00:12, 293.50it/s] 62%|████████████████████████████████▍                   | 6077/9736 [00:21<00:12, 293.43it/s] 63%|████████████████████████████████▌                   | 6107/9736 [00:22<00:12, 291.88it/s] 63%|████████████████████████████████▊                   | 6137/9736 [00:22<00:12, 292.14it/s] 63%|████████████████████████████████▉                   | 6167/9736 [00:22<00:12, 292.48it/s] 64%|█████████████████████████████████                   | 6197/9736 [00:22<00:12, 292.79it/s] 64%|█████████████████████████████████▎                  | 6227/9736 [00:22<00:11, 292.48it/s] 64%|█████████████████████████████████▍                  | 6257/9736 [00:22<00:11, 292.27it/s] 65%|█████████████████████████████████▌                  | 6287/9736 [00:22<00:11, 292.74it/s] 65%|█████████████████████████████████▋                  | 6317/9736 [00:22<00:11, 291.21it/s] 65%|█████████████████████████████████▉                  | 6347/9736 [00:22<00:11, 291.70it/s] 65%|██████████████████████████████████                  | 6377/9736 [00:23<00:11, 292.22it/s] 66%|██████████████████████████████████▏                 | 6407/9736 [00:23<00:11, 292.33it/s] 66%|██████████████████████████████████▍                 | 6437/9736 [00:23<00:11, 292.59it/s] 66%|██████████████████████████████████▌                 | 6467/9736 [00:23<00:11, 292.50it/s] 67%|██████████████████████████████████▋                 | 6497/9736 [00:23<00:11, 292.82it/s] 67%|██████████████████████████████████▊                 | 6527/9736 [00:23<00:10, 292.76it/s] 67%|███████████████████████████████████                 | 6557/9736 [00:23<00:10, 291.32it/s] 68%|███████████████████████████████████▏                | 6587/9736 [00:23<00:10, 291.46it/s] 68%|███████████████████████████████████▎                | 6617/9736 [00:23<00:10, 292.03it/s] 68%|███████████████████████████████████▌                | 6647/9736 [00:23<00:10, 292.63it/s] 69%|███████████████████████████████████▋                | 6677/9736 [00:24<00:10, 292.60it/s] 69%|███████████████████████████████████▊                | 6707/9736 [00:24<00:10, 292.57it/s] 69%|███████████████████████████████████▉                | 6737/9736 [00:24<00:10, 293.01it/s] 70%|████████████████████████████████████▏               | 6767/9736 [00:24<00:10, 291.82it/s] 70%|████████████████████████████████████▎               | 6797/9736 [00:24<00:10, 292.37it/s] 70%|████████████████████████████████████▍               | 6827/9736 [00:24<00:09, 292.88it/s] 70%|████████████████████████████████████▌               | 6857/9736 [00:24<00:09, 293.07it/s] 71%|████████████████████████████████████▊               | 6887/9736 [00:24<00:09, 293.41it/s] 71%|████████████████████████████████████▉               | 6917/9736 [00:24<00:09, 293.38it/s] 71%|█████████████████████████████████████               | 6947/9736 [00:24<00:09, 293.33it/s] 72%|█████████████████████████████████████▎              | 6977/9736 [00:25<00:09, 293.28it/s] 72%|█████████████████████████████████████▍              | 7007/9736 [00:25<00:09, 291.21it/s] 72%|█████████████████████████████████████▌              | 7037/9736 [00:25<00:09, 291.97it/s] 73%|█████████████████████████████████████▋              | 7067/9736 [00:25<00:09, 292.66it/s] 73%|█████████████████████████████████████▉              | 7097/9736 [00:25<00:09, 292.57it/s] 73%|██████████████████████████████████████              | 7127/9736 [00:25<00:08, 292.68it/s] 74%|██████████████████████████████████████▏             | 7157/9736 [00:25<00:08, 292.97it/s] 74%|██████████████████████████████████████▍             | 7187/9736 [00:25<00:08, 293.03it/s] 74%|██████████████████████████████████████▌             | 7217/9736 [00:25<00:08, 291.18it/s] 74%|██████████████████████████████████████▋             | 7247/9736 [00:26<00:08, 291.79it/s] 75%|██████████████████████████████████████▊             | 7277/9736 [00:26<00:08, 292.21it/s] 75%|███████████████████████████████████████             | 7307/9736 [00:26<00:08, 292.50it/s] 75%|███████████████████████████████████████▏            | 7337/9736 [00:26<00:08, 292.50it/s] 76%|███████████████████████████████████████▎            | 7367/9736 [00:26<00:08, 292.82it/s] 76%|███████████████████████████████████████▌            | 7397/9736 [00:26<00:07, 292.91it/s] 76%|███████████████████████████████████████▋            | 7427/9736 [00:26<00:07, 292.91it/s] 77%|███████████████████████████████████████▊            | 7457/9736 [00:26<00:08, 271.28it/s] 77%|███████████████████████████████████████▉            | 7487/9736 [00:26<00:08, 277.47it/s] 77%|████████████████████████████████████████▏           | 7517/9736 [00:26<00:07, 281.98it/s] 78%|████████████████████████████████████████▎           | 7547/9736 [00:27<00:07, 285.15it/s] 78%|████████████████████████████████████████▍           | 7576/9736 [00:27<00:07, 286.38it/s] 78%|████████████████████████████████████████▌           | 7606/9736 [00:27<00:07, 288.36it/s] 78%|████████████████████████████████████████▊           | 7636/9736 [00:27<00:07, 289.81it/s] 79%|████████████████████████████████████████▉           | 7666/9736 [00:27<00:07, 290.73it/s] 79%|█████████████████████████████████████████           | 7696/9736 [00:27<00:07, 289.77it/s] 79%|█████████████████████████████████████████▎          | 7726/9736 [00:27<00:06, 291.30it/s] 80%|█████████████████████████████████████████▍          | 7756/9736 [00:27<00:06, 291.97it/s] 80%|█████████████████████████████████████████▌          | 7786/9736 [00:27<00:06, 292.18it/s] 80%|█████████████████████████████████████████▋          | 7816/9736 [00:27<00:06, 292.36it/s] 81%|█████████████████████████████████████████▉          | 7846/9736 [00:28<00:06, 292.40it/s] 81%|██████████████████████████████████████████          | 7876/9736 [00:28<00:06, 292.45it/s] 81%|██████████████████████████████████████████▏         | 7906/9736 [00:28<00:06, 291.08it/s] 82%|██████████████████████████████████████████▍         | 7936/9736 [00:28<00:06, 291.79it/s] 82%|██████████████████████████████████████████▌         | 7966/9736 [00:28<00:06, 292.40it/s] 82%|██████████████████████████████████████████▋         | 7996/9736 [00:28<00:05, 292.87it/s] 82%|██████████████████████████████████████████▊         | 8026/9736 [00:28<00:05, 293.32it/s] 83%|███████████████████████████████████████████         | 8056/9736 [00:28<00:05, 293.51it/s] 83%|███████████████████████████████████████████▏        | 8086/9736 [00:28<00:05, 293.45it/s] 83%|███████████████████████████████████████████▎        | 8116/9736 [00:28<00:05, 294.15it/s] 84%|███████████████████████████████████████████▌        | 8146/9736 [00:29<00:05, 292.55it/s] 84%|███████████████████████████████████████████▋        | 8176/9736 [00:29<00:05, 292.45it/s] 84%|███████████████████████████████████████████▊        | 8206/9736 [00:29<00:05, 293.27it/s] 85%|███████████████████████████████████████████▉        | 8236/9736 [00:29<00:05, 293.88it/s] 85%|████████████████████████████████████████████▏       | 8266/9736 [00:29<00:05, 293.97it/s] 85%|████████████████████████████████████████████▎       | 8296/9736 [00:29<00:04, 293.89it/s] 86%|████████████████████████████████████████████▍       | 8326/9736 [00:29<00:04, 294.12it/s] 86%|████████████████████████████████████████████▋       | 8356/9736 [00:29<00:04, 292.59it/s] 86%|████████████████████████████████████████████▊       | 8386/9736 [00:29<00:04, 293.43it/s] 86%|████████████████████████████████████████████▉       | 8416/9736 [00:30<00:04, 293.98it/s] 87%|█████████████████████████████████████████████       | 8446/9736 [00:30<00:04, 294.30it/s] 87%|█████████████████████████████████████████████▎      | 8476/9736 [00:30<00:04, 294.50it/s] 87%|█████████████████████████████████████████████▍      | 8506/9736 [00:30<00:04, 294.85it/s] 88%|█████████████████████████████████████████████▌      | 8536/9736 [00:30<00:04, 294.32it/s] 88%|█████████████████████████████████████████████▊      | 8566/9736 [00:30<00:03, 293.30it/s] 88%|█████████████████████████████████████████████▉      | 8596/9736 [00:30<00:03, 291.88it/s] 89%|██████████████████████████████████████████████      | 8626/9736 [00:30<00:03, 292.67it/s] 89%|██████████████████████████████████████████████▏     | 8656/9736 [00:30<00:03, 293.29it/s] 89%|██████████████████████████████████████████████▍     | 8686/9736 [00:30<00:03, 293.83it/s] 90%|██████████████████████████████████████████████▌     | 8716/9736 [00:31<00:03, 294.20it/s] 90%|██████████████████████████████████████████████▋     | 8746/9736 [00:31<00:03, 294.10it/s] 90%|██████████████████████████████████████████████▊     | 8776/9736 [00:31<00:03, 293.33it/s] 90%|███████████████████████████████████████████████     | 8806/9736 [00:31<00:03, 291.79it/s] 91%|███████████████████████████████████████████████▏    | 8836/9736 [00:31<00:03, 292.49it/s] 91%|███████████████████████████████████████████████▎    | 8866/9736 [00:31<00:02, 293.15it/s] 91%|███████████████████████████████████████████████▌    | 8896/9736 [00:31<00:02, 293.68it/s] 92%|███████████████████████████████████████████████▋    | 8926/9736 [00:31<00:02, 294.29it/s] 92%|███████████████████████████████████████████████▊    | 8956/9736 [00:31<00:02, 294.17it/s] 92%|███████████████████████████████████████████████▉    | 8986/9736 [00:31<00:02, 294.12it/s] 93%|████████████████████████████████████████████████▏   | 9016/9736 [00:32<00:02, 294.08it/s] 93%|████████████████████████████████████████████████▎   | 9046/9736 [00:32<00:02, 292.40it/s] 93%|████████████████████████████████████████████████▍   | 9076/9736 [00:32<00:02, 290.55it/s] 94%|████████████████████████████████████████████████▋   | 9106/9736 [00:32<00:02, 291.59it/s] 94%|████████████████████████████████████████████████▊   | 9136/9736 [00:32<00:02, 292.64it/s] 94%|████████████████████████████████████████████████▉   | 9166/9736 [00:32<00:01, 293.28it/s] 94%|█████████████████████████████████████████████████   | 9196/9736 [00:32<00:01, 293.39it/s] 95%|█████████████████████████████████████████████████▎  | 9226/9736 [00:32<00:01, 292.79it/s] 95%|█████████████████████████████████████████████████▍  | 9256/9736 [00:32<00:01, 293.24it/s] 95%|█████████████████████████████████████████████████▌  | 9286/9736 [00:32<00:01, 291.79it/s] 96%|█████████████████████████████████████████████████▊  | 9316/9736 [00:33<00:01, 292.79it/s] 96%|█████████████████████████████████████████████████▉  | 9346/9736 [00:33<00:01, 292.97it/s] 96%|██████████████████████████████████████████████████  | 9376/9736 [00:33<00:01, 293.67it/s] 97%|██████████████████████████████████████████████████▏ | 9406/9736 [00:33<00:01, 293.66it/s] 97%|██████████████████████████████████████████████████▍ | 9436/9736 [00:33<00:01, 293.85it/s] 97%|██████████████████████████████████████████████████▌ | 9466/9736 [00:33<00:00, 293.95it/s] 98%|██████████████████████████████████████████████████▋ | 9496/9736 [00:33<00:00, 292.07it/s] 98%|██████████████████████████████████████████████████▉ | 9526/9736 [00:33<00:00, 292.95it/s] 98%|███████████████████████████████████████████████████ | 9556/9736 [00:33<00:00, 293.52it/s] 98%|███████████████████████████████████████████████████▏| 9586/9736 [00:34<00:00, 291.02it/s] 99%|███████████████████████████████████████████████████▎| 9616/9736 [00:34<00:00, 291.69it/s] 99%|███████████████████████████████████████████████████▌| 9646/9736 [00:34<00:00, 291.98it/s] 99%|███████████████████████████████████████████████████▋| 9676/9736 [00:34<00:00, 292.71it/s]100%|███████████████████████████████████████████████████▊| 9706/9736 [00:34<00:00, 293.07it/s]100%|████████████████████████████████████████████████████| 9736/9736 [00:34<00:00, 290.56it/s]100%|████████████████████████████████████████████████████| 9736/9736 [00:34<00:00, 281.99it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.30s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:04<00:09,  4.96s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.14s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.17s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.18s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.03s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.15s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.06s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.57s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.75s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.42s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.60s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.52s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.67s/it]
[2023-08-21 15:09:44,955] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.44s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.61s/it]
[2023-08-21 15:09:52,115] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-21 15:09:52,116] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-21 15:09:52,117] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-21 15:09:52,117] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-21 15:09:52,117] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-21 15:09:52,117] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-21 15:09:52,117] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-21 15:09:52,117] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-21 15:09:52,117] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-21 15:09:52,117] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-21 15:09:52,117] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-21 15:09:52,117] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fb78b754f40>
[2023-08-21 15:09:52,117] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-21 15:09:52,117] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-21 15:09:52,117] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-21 15:09:52,117] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-21 15:09:52,117] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-21 15:09:52,117] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-21 15:09:52,117] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-21 15:09:52,117] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-21 15:09:52,117] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-21 15:09:52,117] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-21 15:09:52,117] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7fb75c9dbdc0>
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-21 15:09:52,118] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-21 15:09:52,119] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-21 15:09:52,119] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-21 15:09:52,119] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-21 15:09:52,119] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-21 15:09:52,119] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-21 15:09:52,119] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-21 15:09:52,119] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-21 15:09:52,119] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.5663115978240967 seconds
Loading extension module utils...
Time to load utils op: 0.5046308040618896 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Loading extension module utils...
Time to load utils op: 0.5046541690826416 seconds
Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: 1. To be "of use when thirsty," the plumbing in question would need to convey water.
2. Starting from the answer choices given:
    A: Oil refineries: The primary function of an oil refinery is to process and refine crude oil. Any plumbing found in an oil refinery would therefore be used to transport oil, not water.
    B: Wall: While walls can contain plumbing, this plumbing could provide water, especially if it serves sinks, showers or other water-based utilities within a building.
    C: Show: This choice is vague, but if it refers to a show or performance, any plumbing might be for special effects or backstage utilities - which could still potentially provide water.
    D: Own home: The plumbing in your own home would certainly be useful if you were thirsty, as it provides taps, showers, and other water sources.
    E: Water fountain: A water fountain might be the most obvious source of drinakble water and would certainly be useful if you were thirsty.
3. Therefore, by process of elimination, you would only find plumbing that would not be "of use to you if you are thirsty" in an oil refinery, making `A: oil refineries` the correct answer.
So the final answer is A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Output: 1. The question is asking for the activity that a person is not immediately doing when they are beginning to work. 
2. To determine the correct response, we need to compare each option, while considering the immediate meaning of "beginning work".
3. In terms of immediate actions, "beginning to work" could also imply "working" (Option A), so it cannot be the correct answer.
4. Similarly, "momentum" (Option E) is a phenomenon that can start as soon as one begins to work, so it is also not the answer.
5. "Resting" (Option B) is an action contrary to working so it doesn't fit the context. They are not resting but working.
6. Option C: "Tiredness", associated with extensive effort or work, doesn't fit either. It's unlikely for a person to feel tired at the beginning.
7. The remaining option is "Accomplishing" (Option D). When a person is just beginning to work, they haven't had time to accomplish their tasks or goals yet. Hence, this must be the correct answer. 
8. So, the right answer is D: accomplishing.
So the final answer is D: accomplishing

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Output: 1. The question is asking for a place (location) where one may find pens containing a company logo. 
2. Look at each of the choices and consider whether it is a viable location for finding such pens.
3. Choice B: on a pencil - This is unlikely as pencils and pens are different types of writing instruments. They would not usually be found together as part of the same item.
4. Choice C: write sentences on paper - This is not a place or location, rather it's an activity involving using a pen or pencil.
5. Choice D: school - Though it is a location, it's less common to find pens with company logos in a school setting. Usually, pens in schools are for students who likely wouldn't have pens with company logos.
6. Choice E: backpack - It is a viable place to find pens but doesn't specify the type of pen like those with a company logo.
7. Choice A: office - This is the most likely place as promotional pens are often dispersed in such professional environments. Company logo pens are commonly used in offices as part of a company's stationery.
8. Hence, the answer is A: office, as it's the most probable location to find pens that have a company's logo.
So the final answer is A: office

Input: Billy called out to John, and listened for what? Choices:  A: silence B: response C: communication D: hanging up E: whisper
Output: 1. The question is about what Billy expected after he called out to John. 
2. When someone calls out to another person, it generally means they want to get their attention or want to communicate something to them. 
3. After calling out, the normal expectation is that the other person will acknowledge or respond in some way. 
4. The option 'A: silence' does not fit because it is the opposite of what should normally happen if Billy is calling out to John.
5. The option 'C: communication' might seem plausible but in the provided options, there is a more appropriate answer.
6. 'D: hanging up' and 'E: whisper' are not a probable outcome from calling out, unless mentioned beforehand.
7. Therefore, the most logical choice, considering the normally expected outcome of calling out to someone, is 'B: response'.
So the final answer is B: response

Input: The lizard frightened the hiker, it's movements made what rustle? Choices:  A: garden B: trees C: books D: rocks E: bushes
Output: 1. The question tells us that the "lizard frightened the hiker".
2. Following this, it specifies that the lizard caused a rustle movement.
3. We need to find out where this rustling movement happened - a place associated with both lizard's habitat and a hiker’s path.
4. Looking at the choices, we can eliminate 'garden' and 'books' as a lizard would not frequently be found rustling around in a garden or within books, especially in a context involving a hiker.
5. We can also eliminate 'rocks' as rocks can't rustle.
6. Out of 'trees' and 'bushes', a lizard is more likely to cause rustling in bushes than in trees as lizards are more commonly found on or near the ground.
7. Thus, the correct answer is E: bushes.
So the final answer is E: bushes

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i5-s1-rTrue
Loading extension module utils...
Time to load utils op: 0.6042706966400146 seconds
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:41<34:06, 41.76s/it]Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:46<38:07, 46.68s/it]
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 3272684 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 3272685 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 3272686 closing signal SIGTERM
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 3272683) of binary: /home/ylu130/.conda/envs/distllm/bin/python
Traceback (most recent call last):
  File "/home/ylu130/.conda/envs/distllm/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 345, in wrapper
    return f(*args, **kwargs)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 761, in main
    run(args)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 752, in run
    elastic_launch(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 131, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 245, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
/home/ylu130/workspace/in-context-generalization/inference.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2023-08-21_15:10:41
  host      : ia1.wse.jhu.edu
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 3272683)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i6-s1-rTrue --seed 1 --max-prompt-length 2048 --rationales --num-in-domain 6
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-21 15:10:45,540] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i6-s1-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 6
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i6-s1-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9735 [00:00<?, ?it/s]  0%|                                                      | 17/9735 [00:00<00:58, 166.54it/s]  0%|▏                                                     | 34/9735 [00:00<01:02, 155.58it/s]  1%|▎                                                     | 52/9735 [00:00<00:59, 163.86it/s]  1%|▍                                                     | 70/9735 [00:00<00:57, 167.81it/s]  1%|▍                                                     | 88/9735 [00:00<00:56, 170.12it/s]  1%|▌                                                    | 106/9735 [00:00<00:56, 171.70it/s]  1%|▋                                                    | 124/9735 [00:00<00:55, 172.43it/s]  1%|▊                                                    | 142/9735 [00:00<00:55, 173.07it/s]  2%|▊                                                    | 160/9735 [00:00<00:55, 173.61it/s]  2%|▉                                                    | 178/9735 [00:01<00:55, 173.74it/s]  2%|█                                                    | 196/9735 [00:01<00:56, 169.66it/s]  2%|█▏                                                   | 221/9735 [00:01<00:49, 191.96it/s]  3%|█▎                                                   | 248/9735 [00:01<00:44, 213.83it/s]  3%|█▍                                                   | 275/9735 [00:01<00:41, 229.48it/s]  3%|█▋                                                   | 302/9735 [00:01<00:39, 240.56it/s]  3%|█▊                                                   | 329/9735 [00:01<00:37, 248.43it/s]  4%|█▉                                                   | 356/9735 [00:01<00:36, 253.83it/s]  4%|██                                                   | 383/9735 [00:01<00:36, 257.64it/s]  4%|██▏                                                  | 410/9735 [00:01<00:35, 260.57it/s]  4%|██▍                                                  | 437/9735 [00:02<00:35, 260.97it/s]  5%|██▌                                                  | 464/9735 [00:02<00:35, 263.37it/s]  5%|██▋                                                  | 491/9735 [00:02<00:34, 264.55it/s]  5%|██▊                                                  | 518/9735 [00:02<00:34, 265.63it/s]  6%|██▉                                                  | 545/9735 [00:02<00:34, 266.42it/s]  6%|███                                                  | 572/9735 [00:02<00:34, 266.66it/s]  6%|███▎                                                 | 599/9735 [00:02<00:34, 266.86it/s]  6%|███▍                                                 | 626/9735 [00:02<00:34, 267.02it/s]  7%|███▌                                                 | 653/9735 [00:02<00:33, 267.43it/s]  7%|███▋                                                 | 680/9735 [00:02<00:34, 265.71it/s]  7%|███▊                                                 | 707/9735 [00:03<00:33, 266.25it/s]  8%|███▉                                                 | 734/9735 [00:03<00:33, 266.52it/s]  8%|████▏                                                | 761/9735 [00:03<00:33, 267.33it/s]  8%|████▎                                                | 788/9735 [00:03<00:33, 267.64it/s]  8%|████▍                                                | 815/9735 [00:03<00:33, 267.80it/s]  9%|████▌                                                | 842/9735 [00:03<00:33, 267.71it/s]  9%|████▋                                                | 869/9735 [00:03<00:33, 267.72it/s]  9%|████▉                                                | 896/9735 [00:03<00:33, 263.97it/s]  9%|█████                                                | 923/9735 [00:03<00:33, 264.42it/s] 10%|█████▏                                               | 950/9735 [00:03<00:33, 265.25it/s] 10%|█████▎                                               | 977/9735 [00:04<00:32, 265.87it/s] 10%|█████▎                                              | 1004/9735 [00:04<00:32, 266.25it/s] 11%|█████▌                                              | 1031/9735 [00:04<00:32, 266.74it/s] 11%|█████▋                                              | 1058/9735 [00:04<00:32, 264.71it/s] 11%|█████▊                                              | 1085/9735 [00:04<00:32, 265.45it/s] 11%|█████▉                                              | 1112/9735 [00:04<00:32, 262.53it/s] 12%|██████                                              | 1139/9735 [00:04<00:32, 263.41it/s] 12%|██████▏                                             | 1166/9735 [00:04<00:32, 264.46it/s] 12%|██████▎                                             | 1193/9735 [00:04<00:32, 265.20it/s] 13%|██████▌                                             | 1220/9735 [00:05<00:32, 265.66it/s] 13%|██████▋                                             | 1247/9735 [00:05<00:32, 264.60it/s] 13%|██████▊                                             | 1274/9735 [00:05<00:31, 265.23it/s] 13%|██████▉                                             | 1301/9735 [00:05<00:31, 265.81it/s] 14%|███████                                             | 1328/9735 [00:05<00:31, 266.00it/s] 14%|███████▏                                            | 1355/9735 [00:05<00:31, 264.08it/s] 14%|███████▍                                            | 1382/9735 [00:05<00:31, 264.67it/s] 14%|███████▌                                            | 1409/9735 [00:05<00:31, 265.35it/s] 15%|███████▋                                            | 1436/9735 [00:05<00:31, 265.74it/s] 15%|███████▊                                            | 1463/9735 [00:05<00:31, 265.27it/s] 15%|███████▉                                            | 1490/9735 [00:06<00:31, 265.63it/s] 16%|████████                                            | 1517/9735 [00:06<00:30, 265.77it/s] 16%|████████▏                                           | 1544/9735 [00:06<00:30, 266.05it/s] 16%|████████▍                                           | 1571/9735 [00:06<00:30, 264.36it/s] 16%|████████▌                                           | 1598/9735 [00:06<00:30, 265.02it/s] 17%|████████▋                                           | 1625/9735 [00:06<00:30, 265.75it/s] 17%|████████▊                                           | 1652/9735 [00:06<00:30, 266.30it/s] 17%|████████▉                                           | 1679/9735 [00:06<00:30, 266.08it/s] 18%|█████████                                           | 1706/9735 [00:06<00:30, 266.38it/s] 18%|█████████▎                                          | 1733/9735 [00:06<00:30, 266.66it/s] 18%|█████████▍                                          | 1760/9735 [00:07<00:29, 266.90it/s] 18%|█████████▌                                          | 1787/9735 [00:07<00:29, 266.87it/s] 19%|█████████▋                                          | 1814/9735 [00:07<00:32, 243.06it/s] 19%|█████████▊                                          | 1841/9735 [00:07<00:31, 249.52it/s] 19%|█████████▉                                          | 1868/9735 [00:07<00:30, 254.33it/s] 19%|██████████                                          | 1894/9735 [00:07<00:30, 255.85it/s] 20%|██████████▎                                         | 1921/9735 [00:07<00:30, 258.93it/s] 20%|██████████▍                                         | 1948/9735 [00:07<00:29, 261.11it/s] 20%|██████████▌                                         | 1975/9735 [00:07<00:29, 262.69it/s] 21%|██████████▋                                         | 2002/9735 [00:07<00:29, 263.92it/s] 21%|██████████▊                                         | 2029/9735 [00:08<00:29, 261.78it/s] 21%|██████████▉                                         | 2056/9735 [00:08<00:29, 263.06it/s] 21%|███████████▏                                        | 2083/9735 [00:08<00:28, 263.90it/s] 22%|███████████▎                                        | 2110/9735 [00:08<00:28, 264.63it/s] 22%|███████████▍                                        | 2137/9735 [00:08<00:28, 262.84it/s] 22%|███████████▌                                        | 2164/9735 [00:08<00:28, 264.26it/s] 23%|███████████▋                                        | 2191/9735 [00:08<00:28, 264.86it/s] 23%|███████████▊                                        | 2218/9735 [00:08<00:28, 265.38it/s] 23%|███████████▉                                        | 2245/9735 [00:08<00:28, 263.45it/s] 23%|████████████▏                                       | 2272/9735 [00:09<00:28, 264.23it/s] 24%|████████████▎                                       | 2299/9735 [00:09<00:28, 265.00it/s] 24%|████████████▍                                       | 2326/9735 [00:09<00:27, 265.38it/s] 24%|████████████▌                                       | 2353/9735 [00:09<00:27, 265.80it/s] 24%|████████████▋                                       | 2380/9735 [00:09<00:27, 266.14it/s] 25%|████████████▊                                       | 2407/9735 [00:09<00:27, 266.55it/s] 25%|█████████████                                       | 2434/9735 [00:09<00:27, 266.70it/s] 25%|█████████████▏                                      | 2461/9735 [00:09<00:27, 266.72it/s] 26%|█████████████▎                                      | 2488/9735 [00:09<00:27, 264.63it/s] 26%|█████████████▍                                      | 2515/9735 [00:09<00:27, 265.21it/s] 26%|█████████████▌                                      | 2542/9735 [00:10<00:27, 265.70it/s] 26%|█████████████▋                                      | 2569/9735 [00:10<00:26, 265.98it/s] 27%|█████████████▊                                      | 2596/9735 [00:10<00:26, 266.23it/s] 27%|██████████████                                      | 2623/9735 [00:10<00:26, 266.26it/s] 27%|██████████████▏                                     | 2650/9735 [00:10<00:26, 266.30it/s] 27%|██████████████▎                                     | 2677/9735 [00:10<00:26, 266.23it/s] 28%|██████████████▍                                     | 2704/9735 [00:10<00:26, 264.44it/s] 28%|██████████████▌                                     | 2731/9735 [00:10<00:26, 264.83it/s] 28%|██████████████▋                                     | 2758/9735 [00:10<00:26, 265.11it/s] 29%|██████████████▉                                     | 2785/9735 [00:10<00:26, 265.21it/s] 29%|███████████████                                     | 2812/9735 [00:11<00:26, 265.43it/s] 29%|███████████████▏                                    | 2839/9735 [00:11<00:25, 265.77it/s] 29%|███████████████▎                                    | 2866/9735 [00:11<00:25, 266.02it/s] 30%|███████████████▍                                    | 2893/9735 [00:11<00:25, 266.07it/s] 30%|███████████████▌                                    | 2920/9735 [00:11<00:25, 266.24it/s] 30%|███████████████▋                                    | 2947/9735 [00:11<00:25, 264.46it/s] 31%|███████████████▉                                    | 2974/9735 [00:11<00:25, 265.02it/s] 31%|████████████████                                    | 3001/9735 [00:11<00:25, 265.57it/s] 31%|████████████████▏                                   | 3028/9735 [00:11<00:25, 266.05it/s] 31%|████████████████▎                                   | 3055/9735 [00:11<00:25, 266.11it/s] 32%|████████████████▍                                   | 3082/9735 [00:12<00:24, 266.30it/s] 32%|████████████████▌                                   | 3109/9735 [00:12<00:24, 266.30it/s] 32%|████████████████▊                                   | 3136/9735 [00:12<00:24, 266.18it/s] 32%|████████████████▉                                   | 3163/9735 [00:12<00:24, 264.48it/s] 33%|█████████████████                                   | 3190/9735 [00:12<00:24, 265.32it/s] 33%|█████████████████▏                                  | 3217/9735 [00:12<00:24, 265.47it/s] 33%|█████████████████▎                                  | 3244/9735 [00:12<00:24, 265.94it/s] 34%|█████████████████▍                                  | 3271/9735 [00:12<00:24, 265.99it/s] 34%|█████████████████▌                                  | 3298/9735 [00:12<00:24, 265.19it/s] 34%|█████████████████▊                                  | 3325/9735 [00:12<00:24, 265.06it/s] 34%|█████████████████▉                                  | 3352/9735 [00:13<00:24, 265.80it/s] 35%|██████████████████                                  | 3379/9735 [00:13<00:24, 264.57it/s] 35%|██████████████████▏                                 | 3406/9735 [00:13<00:23, 265.16it/s] 35%|██████████████████▎                                 | 3433/9735 [00:13<00:23, 265.44it/s] 36%|██████████████████▍                                 | 3460/9735 [00:13<00:23, 265.66it/s] 36%|██████████████████▋                                 | 3487/9735 [00:13<00:23, 265.67it/s] 36%|██████████████████▊                                 | 3514/9735 [00:13<00:23, 265.41it/s] 36%|██████████████████▉                                 | 3541/9735 [00:13<00:23, 265.67it/s] 37%|███████████████████                                 | 3568/9735 [00:13<00:23, 265.31it/s] 37%|███████████████████▏                                | 3595/9735 [00:13<00:23, 264.88it/s] 37%|███████████████████▎                                | 3622/9735 [00:14<00:23, 263.40it/s] 37%|███████████████████▍                                | 3649/9735 [00:14<00:22, 264.65it/s] 38%|███████████████████▋                                | 3676/9735 [00:14<00:22, 264.86it/s] 38%|███████████████████▊                                | 3703/9735 [00:14<00:22, 265.33it/s] 38%|███████████████████▉                                | 3730/9735 [00:14<00:22, 265.77it/s] 39%|████████████████████                                | 3757/9735 [00:14<00:22, 265.89it/s] 39%|████████████████████▏                               | 3784/9735 [00:14<00:22, 265.92it/s] 39%|████████████████████▎                               | 3811/9735 [00:14<00:22, 265.86it/s] 39%|████████████████████▌                               | 3838/9735 [00:14<00:22, 263.91it/s] 40%|████████████████████▋                               | 3865/9735 [00:15<00:22, 264.53it/s] 40%|████████████████████▊                               | 3892/9735 [00:15<00:22, 264.54it/s] 40%|████████████████████▉                               | 3919/9735 [00:15<00:21, 264.93it/s] 41%|█████████████████████                               | 3946/9735 [00:15<00:21, 265.45it/s] 41%|█████████████████████▏                              | 3973/9735 [00:15<00:21, 265.58it/s] 41%|█████████████████████▎                              | 4000/9735 [00:15<00:21, 265.84it/s] 41%|█████████████████████▌                              | 4027/9735 [00:15<00:21, 265.98it/s] 42%|█████████████████████▋                              | 4054/9735 [00:15<00:21, 265.80it/s] 42%|█████████████████████▊                              | 4081/9735 [00:15<00:21, 263.83it/s] 42%|█████████████████████▉                              | 4108/9735 [00:15<00:21, 264.13it/s] 42%|██████████████████████                              | 4135/9735 [00:16<00:21, 264.65it/s] 43%|██████████████████████▏                             | 4162/9735 [00:16<00:21, 264.93it/s] 43%|██████████████████████▍                             | 4189/9735 [00:16<00:21, 263.29it/s] 43%|██████████████████████▌                             | 4216/9735 [00:16<00:20, 264.17it/s] 44%|██████████████████████▋                             | 4243/9735 [00:16<00:20, 265.15it/s] 44%|██████████████████████▊                             | 4270/9735 [00:16<00:20, 265.30it/s] 44%|██████████████████████▉                             | 4297/9735 [00:16<00:20, 263.65it/s] 44%|███████████████████████                             | 4324/9735 [00:16<00:20, 264.06it/s] 45%|███████████████████████▏                            | 4351/9735 [00:16<00:20, 264.44it/s] 45%|███████████████████████▍                            | 4378/9735 [00:16<00:20, 264.86it/s] 45%|███████████████████████▌                            | 4405/9735 [00:17<00:20, 265.03it/s] 46%|███████████████████████▋                            | 4432/9735 [00:17<00:19, 265.30it/s] 46%|███████████████████████▊                            | 4459/9735 [00:17<00:19, 265.52it/s] 46%|███████████████████████▉                            | 4486/9735 [00:17<00:19, 263.66it/s] 46%|████████████████████████                            | 4513/9735 [00:17<00:19, 264.32it/s] 47%|████████████████████████▎                           | 4540/9735 [00:17<00:21, 239.65it/s] 47%|████████████████████████▍                           | 4567/9735 [00:17<00:20, 246.81it/s] 47%|████████████████████████▌                           | 4594/9735 [00:17<00:20, 252.37it/s] 47%|████████████████████████▋                           | 4621/9735 [00:17<00:19, 256.58it/s] 48%|████████████████████████▊                           | 4648/9735 [00:17<00:19, 259.41it/s] 48%|████████████████████████▉                           | 4675/9735 [00:18<00:19, 261.27it/s] 48%|█████████████████████████                           | 4702/9735 [00:18<00:19, 262.76it/s] 49%|█████████████████████████▎                          | 4729/9735 [00:18<00:18, 263.76it/s] 49%|█████████████████████████▍                          | 4756/9735 [00:18<00:27, 177.83it/s] 49%|█████████████████████████▌                          | 4783/9735 [00:18<00:25, 197.31it/s] 49%|█████████████████████████▋                          | 4810/9735 [00:18<00:23, 213.86it/s] 50%|█████████████████████████▊                          | 4837/9735 [00:18<00:21, 227.13it/s] 50%|█████████████████████████▉                          | 4864/9735 [00:18<00:20, 237.10it/s] 50%|██████████████████████████▏                         | 4891/9735 [00:19<00:19, 245.00it/s] 51%|██████████████████████████▎                         | 4918/9735 [00:19<00:19, 250.73it/s] 51%|██████████████████████████▍                         | 4945/9735 [00:19<00:18, 253.54it/s] 51%|██████████████████████████▌                         | 4972/9735 [00:19<00:18, 256.98it/s] 51%|██████████████████████████▋                         | 4999/9735 [00:19<00:18, 257.69it/s] 52%|██████████████████████████▊                         | 5026/9735 [00:19<00:18, 260.32it/s] 52%|██████████████████████████▉                         | 5053/9735 [00:19<00:17, 262.27it/s] 52%|███████████████████████████▏                        | 5080/9735 [00:19<00:17, 263.25it/s] 52%|███████████████████████████▎                        | 5107/9735 [00:19<00:17, 264.25it/s] 53%|███████████████████████████▍                        | 5134/9735 [00:19<00:17, 264.92it/s] 53%|███████████████████████████▌                        | 5161/9735 [00:20<00:17, 265.11it/s] 53%|███████████████████████████▋                        | 5188/9735 [00:20<00:17, 262.57it/s] 54%|███████████████████████████▊                        | 5215/9735 [00:20<00:17, 263.27it/s] 54%|████████████████████████████                        | 5242/9735 [00:20<00:17, 263.90it/s] 54%|████████████████████████████▏                       | 5269/9735 [00:20<00:16, 264.22it/s] 54%|████████████████████████████▎                       | 5296/9735 [00:20<00:16, 262.45it/s] 55%|████████████████████████████▍                       | 5323/9735 [00:20<00:16, 263.23it/s] 55%|████████████████████████████▌                       | 5350/9735 [00:20<00:16, 263.77it/s] 55%|████████████████████████████▋                       | 5377/9735 [00:20<00:16, 264.16it/s] 56%|████████████████████████████▊                       | 5404/9735 [00:21<00:16, 262.42it/s] 56%|█████████████████████████████                       | 5431/9735 [00:21<00:16, 263.29it/s] 56%|█████████████████████████████▏                      | 5458/9735 [00:21<00:16, 263.89it/s] 56%|█████████████████████████████▎                      | 5485/9735 [00:21<00:16, 265.43it/s] 57%|█████████████████████████████▍                      | 5513/9735 [00:21<00:15, 267.77it/s] 57%|█████████████████████████████▌                      | 5541/9735 [00:21<00:15, 269.40it/s] 57%|█████████████████████████████▋                      | 5569/9735 [00:21<00:15, 270.60it/s] 57%|█████████████████████████████▉                      | 5597/9735 [00:21<00:15, 270.54it/s] 58%|██████████████████████████████                      | 5625/9735 [00:21<00:15, 269.57it/s] 58%|██████████████████████████████▏                     | 5652/9735 [00:21<00:15, 268.78it/s] 58%|██████████████████████████████▎                     | 5680/9735 [00:22<00:15, 269.93it/s] 59%|██████████████████████████████▍                     | 5708/9735 [00:22<00:14, 270.95it/s] 59%|██████████████████████████████▋                     | 5736/9735 [00:22<00:14, 271.75it/s] 59%|██████████████████████████████▊                     | 5764/9735 [00:22<00:14, 272.04it/s] 59%|██████████████████████████████▉                     | 5792/9735 [00:22<00:14, 272.32it/s] 60%|███████████████████████████████                     | 5820/9735 [00:22<00:14, 271.98it/s] 60%|███████████████████████████████▏                    | 5848/9735 [00:22<00:14, 271.81it/s] 60%|███████████████████████████████▍                    | 5876/9735 [00:22<00:14, 270.35it/s] 61%|███████████████████████████████▌                    | 5904/9735 [00:22<00:14, 271.11it/s] 61%|███████████████████████████████▋                    | 5932/9735 [00:22<00:14, 271.54it/s] 61%|███████████████████████████████▊                    | 5960/9735 [00:23<00:13, 272.13it/s] 62%|███████████████████████████████▉                    | 5988/9735 [00:23<00:13, 272.47it/s] 62%|████████████████████████████████▏                   | 6016/9735 [00:23<00:13, 272.29it/s] 62%|████████████████████████████████▎                   | 6044/9735 [00:23<00:13, 272.40it/s] 62%|████████████████████████████████▍                   | 6072/9735 [00:23<00:13, 272.36it/s] 63%|████████████████████████████████▌                   | 6100/9735 [00:23<00:13, 270.53it/s] 63%|████████████████████████████████▋                   | 6128/9735 [00:23<00:13, 271.01it/s] 63%|████████████████████████████████▉                   | 6156/9735 [00:23<00:13, 269.82it/s] 64%|█████████████████████████████████                   | 6184/9735 [00:23<00:13, 270.77it/s] 64%|█████████████████████████████████▏                  | 6212/9735 [00:24<00:12, 271.40it/s] 64%|█████████████████████████████████▎                  | 6240/9735 [00:24<00:12, 271.46it/s] 64%|█████████████████████████████████▍                  | 6268/9735 [00:24<00:12, 271.45it/s] 65%|█████████████████████████████████▋                  | 6296/9735 [00:24<00:12, 271.68it/s] 65%|█████████████████████████████████▊                  | 6324/9735 [00:24<00:12, 270.13it/s] 65%|█████████████████████████████████▉                  | 6352/9735 [00:24<00:12, 270.89it/s] 66%|██████████████████████████████████                  | 6380/9735 [00:24<00:12, 271.26it/s] 66%|██████████████████████████████████▏                 | 6408/9735 [00:24<00:12, 271.68it/s] 66%|██████████████████████████████████▍                 | 6436/9735 [00:24<00:12, 272.03it/s] 66%|██████████████████████████████████▌                 | 6464/9735 [00:24<00:12, 272.12it/s] 67%|██████████████████████████████████▋                 | 6492/9735 [00:25<00:11, 272.02it/s] 67%|██████████████████████████████████▊                 | 6520/9735 [00:25<00:11, 271.94it/s] 67%|██████████████████████████████████▉                 | 6548/9735 [00:25<00:11, 270.29it/s] 68%|███████████████████████████████████▏                | 6576/9735 [00:25<00:11, 270.88it/s] 68%|███████████████████████████████████▎                | 6604/9735 [00:25<00:11, 271.28it/s] 68%|███████████████████████████████████▍                | 6632/9735 [00:25<00:11, 271.88it/s] 68%|███████████████████████████████████▌                | 6660/9735 [00:25<00:11, 272.38it/s] 69%|███████████████████████████████████▋                | 6688/9735 [00:25<00:11, 272.41it/s] 69%|███████████████████████████████████▊                | 6716/9735 [00:25<00:11, 272.29it/s] 69%|████████████████████████████████████                | 6744/9735 [00:25<00:11, 271.76it/s] 70%|████████████████████████████████████▏               | 6772/9735 [00:26<00:10, 270.34it/s] 70%|████████████████████████████████████▎               | 6800/9735 [00:26<00:10, 271.00it/s] 70%|████████████████████████████████████▍               | 6828/9735 [00:26<00:10, 271.56it/s] 70%|████████████████████████████████████▌               | 6856/9735 [00:26<00:10, 272.01it/s] 71%|████████████████████████████████████▊               | 6884/9735 [00:26<00:10, 272.30it/s] 71%|████████████████████████████████████▉               | 6912/9735 [00:26<00:10, 272.07it/s] 71%|█████████████████████████████████████               | 6940/9735 [00:26<00:10, 272.22it/s] 72%|█████████████████████████████████████▏              | 6968/9735 [00:26<00:10, 272.00it/s] 72%|█████████████████████████████████████▎              | 6996/9735 [00:26<00:10, 270.48it/s] 72%|█████████████████████████████████████▌              | 7024/9735 [00:26<00:09, 271.19it/s] 72%|█████████████████████████████████████▋              | 7052/9735 [00:27<00:09, 271.84it/s] 73%|█████████████████████████████████████▊              | 7080/9735 [00:27<00:09, 272.29it/s] 73%|█████████████████████████████████████▉              | 7108/9735 [00:27<00:09, 272.29it/s] 73%|██████████████████████████████████████              | 7136/9735 [00:27<00:09, 272.38it/s] 74%|██████████████████████████████████████▎             | 7164/9735 [00:27<00:09, 272.16it/s] 74%|██████████████████████████████████████▍             | 7192/9735 [00:27<00:09, 272.27it/s] 74%|██████████████████████████████████████▌             | 7220/9735 [00:27<00:09, 270.47it/s] 74%|██████████████████████████████████████▋             | 7248/9735 [00:27<00:09, 271.10it/s] 75%|██████████████████████████████████████▊             | 7276/9735 [00:27<00:09, 271.56it/s] 75%|███████████████████████████████████████             | 7304/9735 [00:28<00:08, 271.97it/s] 75%|███████████████████████████████████████▏            | 7332/9735 [00:28<00:08, 272.15it/s] 76%|███████████████████████████████████████▎            | 7360/9735 [00:28<00:08, 272.26it/s] 76%|███████████████████████████████████████▍            | 7388/9735 [00:28<00:08, 272.26it/s] 76%|███████████████████████████████████████▌            | 7416/9735 [00:28<00:08, 272.22it/s] 76%|███████████████████████████████████████▊            | 7444/9735 [00:28<00:09, 248.98it/s] 77%|███████████████████████████████████████▉            | 7472/9735 [00:28<00:08, 255.59it/s] 77%|████████████████████████████████████████            | 7500/9735 [00:28<00:08, 260.47it/s] 77%|████████████████████████████████████████▏           | 7528/9735 [00:28<00:08, 263.76it/s] 78%|████████████████████████████████████████▎           | 7556/9735 [00:28<00:08, 266.01it/s] 78%|████████████████████████████████████████▌           | 7584/9735 [00:29<00:08, 267.65it/s] 78%|████████████████████████████████████████▋           | 7612/9735 [00:29<00:07, 268.95it/s] 78%|████████████████████████████████████████▊           | 7640/9735 [00:29<00:07, 269.75it/s] 79%|████████████████████████████████████████▉           | 7668/9735 [00:29<00:07, 268.77it/s] 79%|█████████████████████████████████████████           | 7696/9735 [00:29<00:07, 269.70it/s] 79%|█████████████████████████████████████████▎          | 7724/9735 [00:29<00:07, 270.70it/s] 80%|█████████████████████████████████████████▍          | 7752/9735 [00:29<00:07, 271.27it/s] 80%|█████████████████████████████████████████▌          | 7780/9735 [00:29<00:07, 271.33it/s] 80%|█████████████████████████████████████████▋          | 7808/9735 [00:29<00:07, 270.04it/s] 80%|█████████████████████████████████████████▊          | 7836/9735 [00:30<00:07, 270.50it/s] 81%|██████████████████████████████████████████          | 7864/9735 [00:30<00:06, 270.90it/s] 81%|██████████████████████████████████████████▏         | 7892/9735 [00:30<00:06, 271.48it/s] 81%|██████████████████████████████████████████▎         | 7920/9735 [00:30<00:06, 270.23it/s] 82%|██████████████████████████████████████████▍         | 7948/9735 [00:30<00:06, 270.76it/s] 82%|██████████████████████████████████████████▌         | 7976/9735 [00:30<00:06, 271.17it/s] 82%|██████████████████████████████████████████▊         | 8004/9735 [00:30<00:06, 271.55it/s] 83%|██████████████████████████████████████████▉         | 8032/9735 [00:30<00:06, 271.67it/s] 83%|███████████████████████████████████████████         | 8060/9735 [00:30<00:06, 271.64it/s] 83%|███████████████████████████████████████████▏        | 8088/9735 [00:30<00:06, 271.94it/s] 83%|███████████████████████████████████████████▎        | 8116/9735 [00:31<00:05, 272.36it/s] 84%|███████████████████████████████████████████▌        | 8144/9735 [00:31<00:05, 270.69it/s] 84%|███████████████████████████████████████████▋        | 8172/9735 [00:31<00:05, 269.42it/s] 84%|███████████████████████████████████████████▊        | 8200/9735 [00:31<00:05, 270.20it/s] 85%|███████████████████████████████████████████▉        | 8228/9735 [00:31<00:05, 270.70it/s] 85%|████████████████████████████████████████████        | 8256/9735 [00:31<00:05, 271.14it/s] 85%|████████████████████████████████████████████▏       | 8284/9735 [00:31<00:05, 271.19it/s] 85%|████████████████████████████████████████████▍       | 8312/9735 [00:31<00:05, 271.51it/s] 86%|████████████████████████████████████████████▌       | 8340/9735 [00:31<00:05, 271.90it/s] 86%|████████████████████████████████████████████▋       | 8368/9735 [00:31<00:05, 270.18it/s] 86%|████████████████████████████████████████████▊       | 8396/9735 [00:32<00:04, 270.47it/s] 87%|████████████████████████████████████████████▉       | 8424/9735 [00:32<00:04, 271.02it/s] 87%|█████████████████████████████████████████████▏      | 8452/9735 [00:32<00:04, 271.36it/s] 87%|█████████████████████████████████████████████▎      | 8480/9735 [00:32<00:04, 271.42it/s] 87%|█████████████████████████████████████████████▍      | 8508/9735 [00:32<00:04, 271.57it/s] 88%|█████████████████████████████████████████████▌      | 8536/9735 [00:32<00:04, 270.47it/s] 88%|█████████████████████████████████████████████▋      | 8564/9735 [00:32<00:04, 270.89it/s] 88%|█████████████████████████████████████████████▉      | 8592/9735 [00:32<00:04, 269.76it/s] 89%|██████████████████████████████████████████████      | 8620/9735 [00:32<00:04, 269.99it/s] 89%|██████████████████████████████████████████████▏     | 8648/9735 [00:33<00:04, 270.53it/s] 89%|██████████████████████████████████████████████▎     | 8676/9735 [00:33<00:03, 271.19it/s] 89%|██████████████████████████████████████████████▍     | 8704/9735 [00:33<00:03, 271.32it/s] 90%|██████████████████████████████████████████████▋     | 8732/9735 [00:33<00:03, 271.40it/s] 90%|██████████████████████████████████████████████▊     | 8760/9735 [00:33<00:03, 271.58it/s] 90%|██████████████████████████████████████████████▉     | 8788/9735 [00:33<00:03, 271.55it/s] 91%|███████████████████████████████████████████████     | 8816/9735 [00:33<00:03, 269.60it/s] 91%|███████████████████████████████████████████████▏    | 8844/9735 [00:33<00:03, 270.11it/s] 91%|███████████████████████████████████████████████▍    | 8872/9735 [00:33<00:03, 270.76it/s] 91%|███████████████████████████████████████████████▌    | 8900/9735 [00:33<00:03, 270.76it/s] 92%|███████████████████████████████████████████████▋    | 8928/9735 [00:34<00:02, 270.91it/s] 92%|███████████████████████████████████████████████▊    | 8956/9735 [00:34<00:02, 270.32it/s] 92%|███████████████████████████████████████████████▉    | 8984/9735 [00:34<00:02, 270.57it/s] 93%|████████████████████████████████████████████████▏   | 9012/9735 [00:34<00:02, 270.75it/s] 93%|████████████████████████████████████████████████▎   | 9040/9735 [00:34<00:02, 268.98it/s] 93%|████████████████████████████████████████████████▍   | 9068/9735 [00:34<00:02, 269.92it/s] 93%|████████████████████████████████████████████████▌   | 9096/9735 [00:34<00:02, 270.49it/s] 94%|████████████████████████████████████████████████▋   | 9124/9735 [00:34<00:02, 270.69it/s] 94%|████████████████████████████████████████████████▉   | 9152/9735 [00:34<00:02, 271.03it/s] 94%|█████████████████████████████████████████████████   | 9180/9735 [00:34<00:02, 271.35it/s] 95%|█████████████████████████████████████████████████▏  | 9208/9735 [00:35<00:01, 271.46it/s] 95%|█████████████████████████████████████████████████▎  | 9236/9735 [00:35<00:01, 271.55it/s] 95%|█████████████████████████████████████████████████▍  | 9264/9735 [00:35<00:01, 269.85it/s] 95%|█████████████████████████████████████████████████▋  | 9292/9735 [00:35<00:01, 270.44it/s] 96%|█████████████████████████████████████████████████▊  | 9320/9735 [00:35<00:01, 270.96it/s] 96%|█████████████████████████████████████████████████▉  | 9348/9735 [00:35<00:01, 271.20it/s] 96%|██████████████████████████████████████████████████  | 9376/9735 [00:35<00:01, 271.27it/s] 97%|██████████████████████████████████████████████████▏ | 9404/9735 [00:35<00:01, 271.14it/s] 97%|██████████████████████████████████████████████████▍ | 9432/9735 [00:35<00:01, 271.41it/s] 97%|██████████████████████████████████████████████████▌ | 9460/9735 [00:36<00:01, 263.57it/s] 97%|██████████████████████████████████████████████████▋ | 9487/9735 [00:36<00:00, 264.12it/s] 98%|██████████████████████████████████████████████████▊ | 9515/9735 [00:36<00:00, 266.39it/s] 98%|██████████████████████████████████████████████████▉ | 9543/9735 [00:36<00:00, 268.02it/s] 98%|███████████████████████████████████████████████████ | 9571/9735 [00:36<00:00, 269.17it/s] 99%|███████████████████████████████████████████████████▎| 9599/9735 [00:36<00:00, 269.70it/s] 99%|███████████████████████████████████████████████████▍| 9627/9735 [00:36<00:00, 270.38it/s] 99%|███████████████████████████████████████████████████▌| 9655/9735 [00:36<00:00, 270.82it/s] 99%|███████████████████████████████████████████████████▋| 9683/9735 [00:36<00:00, 271.09it/s]100%|███████████████████████████████████████████████████▊| 9711/9735 [00:36<00:00, 269.41it/s]100%|████████████████████████████████████████████████████| 9735/9735 [00:37<00:00, 262.83it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.15s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.28s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:11,  5.57s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:11,  5.84s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:04,  4.98s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.39s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:11<00:05,  5.51s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:11<00:05,  5.85s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.37s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.55s/it]
[2023-08-21 15:12:14,372] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.79s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.94s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  4.91s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  5.08s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:18<00:00,  6.11s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:18<00:00,  6.04s/it]
[2023-08-21 15:12:31,950] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-21 15:12:31,952] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-21 15:12:31,952] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-21 15:12:31,952] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-21 15:12:31,952] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-21 15:12:31,952] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fcdef971f40>
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-21 15:12:31,953] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7fce03796dc0>
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-21 15:12:31,954] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-21 15:12:31,955] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-21 15:12:31,955] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-21 15:12:31,955] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-21 15:12:31,955] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.6860218048095703 seconds
Loading extension module utils...
Time to load utils op: 0.5047280788421631 seconds
Loading extension module utils...
Time to load utils op: 0.7048795223236084 seconds
Loading extension module utils...
Time to load utils op: 0.7047910690307617 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: 1. First, let's understand the question which is asking where you can find some plumbing that would not be beneficial if you are thirsty. 
2. The plumbing system of interest here should be one that does not carry drinkable water.
3. We start to eliminate the options. Looking at choice E: water fountain, this obviously carries drinkable water so it can't be it.
4. Option D: own home, also carries drinkable water from faucets, so we eliminate this option too.
5. Option C: show and option B: wall do not seem to make sense in this context as they do not typically refer to places with a plumbing system.
6. This leaves us with option A: oil refineries. Oil refineries typically have pipelines for transporting oil, not water. So, the plumbing in oil refineries would not be of use if you are thirsty.
7. Therefore, the answer is A: oil refineries.
So the final answer is A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Output: 1. The question asks us to identify what a person is not doing when they are beginning work.
2. Let's look at each option individually: 
3. Option A: Working. This option is probable because when someone is beginning work, they are indeed working.
4. Option B: Resting. This is unlikely as someone can't be starting to work and resting at the same time.
5. Option C: Tiredness. This could be ruled out because it is a state of feeling, not an action. Although one might argue that someone could be tired from the onset of work, it doesn't make sense within the context of the question.
6. Option D: Accomplishing. This seems to be the most likely answer. When someone is beginning their work, they will most likely not have accomplished anything yet as they have just started.
7. Option E: Momentum. This could be ruled out because similar to tiredness, it is not an action one performs. Rather, it can be a result or a product of work over time.
8. Hence, the correct answer is D: Accomplishing.
So the final answer is D: accomplishing

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Output: Reasoning:
1. Pens with a company logo are often passed out or used in an office setting.
2. They could be given to employees to use, or to visitors as part of a promotional activity.
3. A pencil is a different stationery item, so it is not likely to find pens inscribed with logos on them.
4. Also, while pens are commonly used to write sentences on paper, the paper doesn't have anything to do with where you might discover logo-embossed pens.
5. Although students use pens at school, it is unusual for schools to distribute pens with company logos, so it is less likely you will find such pens there.
6. A backpack could hold a pen with a logo, but this choice is more about where someone might store such an item, it doesn't necessarily provide a good answer to where you might encounter one.
7. Therefore, considering all the options, 'office' makes the most sense as an answer.
So the final answer is A: office

Input: Billy called out to John, and listened for what? Choices:  A: silence B: response C: communication D: hanging up E: whisper
Output: 1. The question pertains to the reason why Billy called out to John.
2. Usually, when a person calls out to someone else, it's to attract their attention and generate some form of verbal or non-verbal acknowledgment or reply.
3. 'Silence' and 'hanging up' would not be what Billy would be waiting for after calling out to John.
4. 'Whisper' could be a type of response, but it is not the most direct answer. 'Communication' is more general and less direct than'response'.
5. Hence, the most appropriate choice is B:'response'. This indicates that Billy is waiting for John to reply or acknowledge him in some way.
So the final answer is B: response

Input: The lizard frightened the hiker, it's movements made what rustle? Choices:  A: garden B: trees C: books D: rocks E: bushes
Output: 1. This question calls for reasoning based on understanding of common contextual usage and behavior of lizards and hikers.
2. We start by eliminating irrelevant options: Lizards aren't usually found in gardens, nor do they frighten hikers there typically. Books are definitely out of question since lizards don't rustle books.
3. Between trees, rocks, and bushes, lizards can't make trees rustle because they are too small and light, and rocks don't rustle at all.
4. Therefore, by process of elimination, the answer has to be E: bushes. Lizards often inhabit areas with bushes and their movement through them can cause rustling sounds, which could frighten a hiker.
So the final answer is E: bushes

Input: The man spent big money and time maintaining his lawn, it was part of keeping up with the Joneses where? Choices:  A: front yard B: suburbia C: neighborhood D: back yard E: golf course
Output: 1. The phrase "keeping up with the Joneses" refers to the comparison to one's neighbors as a benchmark for social class or the accumulation of material goods. 
2. This means the context is most likely a residential area where there are neighbors to compare with.
3. Among the options, A: front yard, B: suburbia, C: neighborhood, D: back yard, E: golf course, the phrase could technically apply to the front yard, the suburbia, the neighborhood, or the back yard, but not the golf course. The golf course option can be eliminated as it's not a residential area. 
4. However, the phrase "keeping up with the Joneses" is often applied in a broader sense, on a community level.
5. Therefore, the front yard and the back yard can be eliminated. The phrase does not usually refer to individual properties but rather to an entire residential community.
6. This then narrows down the choice to either suburbia or neighborhood. 
7. The "man spent big money", which suggests the community is relatively affluent, characteristic of suburbia.
8. Therefore, the answer is B: suburbia.
So the final answer is B: suburbia

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i6-s1-rTrue
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Evaluating commonsenseqa :   0%|                                       | 0/50 [00:05<?, ?it/s]
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 3273979) of binary: /home/ylu130/.conda/envs/distllm/bin/python
Traceback (most recent call last):
  File "/home/ylu130/.conda/envs/distllm/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 345, in wrapper
    return f(*args, **kwargs)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 761, in main
    run(args)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 752, in run
    elastic_launch(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 131, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 245, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
/home/ylu130/workspace/in-context-generalization/inference.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2023-08-21_15:12:43
  host      : ia1.wse.jhu.edu
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 3273980)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2023-08-21_15:12:43
  host      : ia1.wse.jhu.edu
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 3273981)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2023-08-21_15:12:43
  host      : ia1.wse.jhu.edu
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 3273982)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2023-08-21_15:12:43
  host      : ia1.wse.jhu.edu
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 3273979)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i7-s1-rTrue --seed 1 --max-prompt-length 2048 --rationales --num-in-domain 7
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[nltk_data]   Package punkt is already up-to-date!
[2023-08-21 15:12:47,390] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i7-s1-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 7
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i7-s1-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9734 [00:00<?, ?it/s]  0%|                                                      | 13/9734 [00:00<01:19, 121.64it/s]  0%|▏                                                     | 26/9734 [00:00<01:19, 122.08it/s]  0%|▏                                                     | 39/9734 [00:00<01:19, 121.97it/s]  1%|▎                                                     | 52/9734 [00:00<01:19, 121.98it/s]  1%|▎                                                     | 65/9734 [00:00<01:19, 121.83it/s]  1%|▍                                                     | 78/9734 [00:00<01:19, 121.79it/s]  1%|▌                                                     | 91/9734 [00:00<01:20, 120.26it/s]  1%|▌                                                    | 104/9734 [00:00<01:19, 120.72it/s]  1%|▋                                                    | 117/9734 [00:00<01:19, 121.31it/s]  1%|▋                                                    | 130/9734 [00:01<01:18, 121.79it/s]  1%|▊                                                    | 143/9734 [00:01<01:18, 122.07it/s]  2%|▊                                                    | 156/9734 [00:01<01:18, 122.35it/s]  2%|▉                                                    | 169/9734 [00:01<01:18, 122.40it/s]  2%|▉                                                    | 182/9734 [00:01<01:17, 122.48it/s]  2%|█                                                    | 195/9734 [00:01<01:17, 122.49it/s]  2%|█▏                                                   | 208/9734 [00:01<01:19, 119.91it/s]  2%|█▏                                                   | 221/9734 [00:01<01:18, 120.66it/s]  2%|█▎                                                   | 234/9734 [00:01<01:18, 121.24it/s]  3%|█▎                                                   | 247/9734 [00:02<01:18, 121.59it/s]  3%|█▍                                                   | 260/9734 [00:02<01:17, 121.86it/s]  3%|█▍                                                   | 273/9734 [00:02<01:17, 122.09it/s]  3%|█▌                                                   | 286/9734 [00:02<01:16, 122.77it/s]  3%|█▋                                                   | 305/9734 [00:02<01:06, 141.48it/s]  3%|█▊                                                   | 324/9734 [00:02<01:00, 154.81it/s]  4%|█▊                                                   | 343/9734 [00:02<00:57, 164.46it/s]  4%|█▉                                                   | 362/9734 [00:02<00:54, 170.91it/s]  4%|██                                                   | 381/9734 [00:02<00:53, 175.70it/s]  4%|██▏                                                  | 400/9734 [00:02<00:52, 179.05it/s]  4%|██▎                                                  | 419/9734 [00:03<00:51, 181.30it/s]  4%|██▍                                                  | 438/9734 [00:03<00:51, 181.27it/s]  5%|██▍                                                  | 457/9734 [00:03<00:50, 183.06it/s]  5%|██▌                                                  | 476/9734 [00:03<00:50, 184.16it/s]  5%|██▋                                                  | 495/9734 [00:03<00:49, 185.01it/s]  5%|██▊                                                  | 514/9734 [00:03<00:49, 185.58it/s]  5%|██▉                                                  | 533/9734 [00:03<00:49, 185.70it/s]  6%|███                                                  | 552/9734 [00:03<00:49, 185.96it/s]  6%|███                                                  | 571/9734 [00:03<00:49, 185.80it/s]  6%|███▏                                                 | 590/9734 [00:03<00:49, 185.94it/s]  6%|███▎                                                 | 609/9734 [00:04<00:49, 185.66it/s]  6%|███▍                                                 | 628/9734 [00:04<00:49, 185.60it/s]  7%|███▌                                                 | 647/9734 [00:04<00:48, 185.76it/s]  7%|███▋                                                 | 666/9734 [00:04<00:49, 184.29it/s]  7%|███▋                                                 | 685/9734 [00:04<00:49, 184.66it/s]  7%|███▊                                                 | 704/9734 [00:04<00:48, 184.97it/s]  7%|███▉                                                 | 723/9734 [00:04<00:48, 185.12it/s]  8%|████                                                 | 742/9734 [00:04<00:48, 185.34it/s]  8%|████▏                                                | 761/9734 [00:04<00:48, 185.55it/s]  8%|████▏                                                | 780/9734 [00:05<00:48, 185.70it/s]  8%|████▎                                                | 799/9734 [00:05<00:48, 185.61it/s]  8%|████▍                                                | 818/9734 [00:05<00:48, 185.50it/s]  9%|████▌                                                | 837/9734 [00:05<00:48, 184.44it/s]  9%|████▋                                                | 856/9734 [00:05<00:48, 184.91it/s]  9%|████▊                                                | 875/9734 [00:05<00:47, 185.27it/s]  9%|████▊                                                | 894/9734 [00:05<00:48, 183.81it/s]  9%|████▉                                                | 913/9734 [00:05<00:47, 184.25it/s] 10%|█████                                                | 932/9734 [00:05<00:47, 184.39it/s] 10%|█████▏                                               | 951/9734 [00:05<00:47, 184.83it/s] 10%|█████▎                                               | 970/9734 [00:06<00:47, 185.04it/s] 10%|█████▍                                               | 989/9734 [00:06<00:47, 185.33it/s] 10%|█████▍                                              | 1008/9734 [00:06<00:47, 185.51it/s] 11%|█████▍                                              | 1027/9734 [00:06<00:46, 185.94it/s] 11%|█████▌                                              | 1046/9734 [00:06<00:46, 186.17it/s] 11%|█████▋                                              | 1065/9734 [00:06<00:46, 186.18it/s] 11%|█████▊                                              | 1084/9734 [00:06<00:46, 184.49it/s] 11%|█████▉                                              | 1103/9734 [00:06<00:46, 185.04it/s] 12%|█████▉                                              | 1122/9734 [00:06<00:47, 182.30it/s] 12%|██████                                              | 1141/9734 [00:06<00:46, 183.65it/s] 12%|██████▏                                             | 1160/9734 [00:07<00:46, 184.33it/s] 12%|██████▎                                             | 1179/9734 [00:07<00:46, 184.80it/s] 12%|██████▍                                             | 1198/9734 [00:07<00:46, 185.11it/s] 13%|██████▌                                             | 1217/9734 [00:07<00:45, 185.40it/s] 13%|██████▌                                             | 1236/9734 [00:07<00:45, 185.56it/s] 13%|██████▋                                             | 1255/9734 [00:07<00:45, 185.73it/s] 13%|██████▊                                             | 1274/9734 [00:07<00:45, 185.81it/s] 13%|██████▉                                             | 1293/9734 [00:07<00:45, 185.97it/s] 13%|███████                                             | 1312/9734 [00:07<00:45, 186.12it/s] 14%|███████                                             | 1331/9734 [00:07<00:45, 185.39it/s] 14%|███████▏                                            | 1350/9734 [00:08<00:45, 183.95it/s] 14%|███████▎                                            | 1369/9734 [00:08<00:45, 184.57it/s] 14%|███████▍                                            | 1388/9734 [00:08<00:45, 184.66it/s] 14%|███████▌                                            | 1407/9734 [00:08<00:45, 185.00it/s] 15%|███████▌                                            | 1426/9734 [00:08<00:44, 185.28it/s] 15%|███████▋                                            | 1445/9734 [00:08<00:44, 185.55it/s] 15%|███████▊                                            | 1464/9734 [00:08<00:44, 185.65it/s] 15%|███████▉                                            | 1483/9734 [00:08<00:44, 185.90it/s] 15%|████████                                            | 1502/9734 [00:08<00:44, 185.73it/s] 16%|████████▏                                           | 1521/9734 [00:09<00:44, 185.77it/s] 16%|████████▏                                           | 1540/9734 [00:09<00:44, 185.85it/s] 16%|████████▎                                           | 1559/9734 [00:09<00:43, 185.88it/s] 16%|████████▍                                           | 1578/9734 [00:09<00:44, 184.13it/s] 16%|████████▌                                           | 1597/9734 [00:09<00:44, 184.64it/s] 17%|████████▋                                           | 1616/9734 [00:09<00:43, 185.01it/s] 17%|████████▋                                           | 1635/9734 [00:09<00:43, 184.77it/s] 17%|████████▊                                           | 1654/9734 [00:09<00:43, 184.47it/s] 17%|████████▉                                           | 1673/9734 [00:09<00:43, 185.00it/s] 17%|█████████                                           | 1692/9734 [00:09<00:43, 185.26it/s] 18%|█████████▏                                          | 1711/9734 [00:10<00:43, 185.45it/s] 18%|█████████▏                                          | 1730/9734 [00:10<00:43, 185.61it/s] 18%|█████████▎                                          | 1749/9734 [00:10<00:42, 185.79it/s] 18%|█████████▍                                          | 1768/9734 [00:10<00:42, 185.88it/s] 18%|█████████▌                                          | 1787/9734 [00:10<00:42, 185.82it/s] 19%|█████████▋                                          | 1806/9734 [00:10<00:47, 167.23it/s] 19%|█████████▋                                          | 1825/9734 [00:10<00:45, 172.38it/s] 19%|█████████▊                                          | 1844/9734 [00:10<00:44, 175.94it/s] 19%|█████████▉                                          | 1863/9734 [00:10<00:44, 178.89it/s] 19%|██████████                                          | 1882/9734 [00:10<00:43, 180.80it/s] 20%|██████████▏                                         | 1901/9734 [00:11<00:42, 182.25it/s] 20%|██████████▎                                         | 1920/9734 [00:11<00:42, 183.18it/s] 20%|██████████▎                                         | 1939/9734 [00:11<00:42, 183.86it/s] 20%|██████████▍                                         | 1958/9734 [00:11<00:42, 184.39it/s] 20%|██████████▌                                         | 1977/9734 [00:11<00:41, 184.88it/s] 21%|██████████▋                                         | 1996/9734 [00:11<00:41, 185.22it/s] 21%|██████████▊                                         | 2015/9734 [00:11<00:41, 185.49it/s] 21%|██████████▊                                         | 2034/9734 [00:11<00:41, 183.63it/s] 21%|██████████▉                                         | 2053/9734 [00:11<00:41, 183.91it/s] 21%|███████████                                         | 2072/9734 [00:12<00:41, 184.13it/s] 21%|███████████▏                                        | 2091/9734 [00:12<00:41, 184.16it/s] 22%|███████████▎                                        | 2110/9734 [00:12<00:41, 184.54it/s] 22%|███████████▎                                        | 2129/9734 [00:12<00:41, 184.72it/s] 22%|███████████▍                                        | 2148/9734 [00:12<00:41, 184.99it/s] 22%|███████████▌                                        | 2167/9734 [00:12<00:40, 185.18it/s] 22%|███████████▋                                        | 2186/9734 [00:12<00:40, 185.23it/s] 23%|███████████▊                                        | 2205/9734 [00:12<00:40, 185.12it/s] 23%|███████████▉                                        | 2224/9734 [00:12<00:40, 185.24it/s] 23%|███████████▉                                        | 2243/9734 [00:12<00:40, 185.44it/s] 23%|████████████                                        | 2262/9734 [00:13<00:40, 183.48it/s] 23%|████████████▏                                       | 2281/9734 [00:13<00:40, 184.12it/s] 24%|████████████▎                                       | 2300/9734 [00:13<00:40, 184.56it/s] 24%|████████████▍                                       | 2319/9734 [00:13<00:40, 184.70it/s] 24%|████████████▍                                       | 2338/9734 [00:13<00:39, 184.90it/s] 24%|████████████▌                                       | 2357/9734 [00:13<00:39, 185.12it/s] 24%|████████████▋                                       | 2376/9734 [00:13<00:39, 185.45it/s] 25%|████████████▊                                       | 2395/9734 [00:13<00:39, 185.64it/s] 25%|████████████▉                                       | 2414/9734 [00:13<00:39, 185.72it/s] 25%|████████████▉                                       | 2433/9734 [00:13<00:39, 185.69it/s] 25%|█████████████                                       | 2452/9734 [00:14<00:39, 185.61it/s] 25%|█████████████▏                                      | 2471/9734 [00:14<00:39, 185.48it/s] 26%|█████████████▎                                      | 2490/9734 [00:14<00:39, 183.77it/s] 26%|█████████████▍                                      | 2509/9734 [00:14<00:39, 184.42it/s] 26%|█████████████▌                                      | 2528/9734 [00:14<00:39, 184.32it/s] 26%|█████████████▌                                      | 2547/9734 [00:14<00:38, 184.60it/s] 26%|█████████████▋                                      | 2566/9734 [00:14<00:38, 184.98it/s] 27%|█████████████▊                                      | 2585/9734 [00:14<00:38, 184.92it/s] 27%|█████████████▉                                      | 2604/9734 [00:14<00:38, 185.15it/s] 27%|██████████████                                      | 2623/9734 [00:15<00:38, 185.04it/s] 27%|██████████████                                      | 2642/9734 [00:15<00:38, 185.09it/s] 27%|██████████████▏                                     | 2661/9734 [00:15<00:38, 185.28it/s] 28%|██████████████▎                                     | 2680/9734 [00:15<00:38, 185.36it/s] 28%|██████████████▍                                     | 2699/9734 [00:15<00:38, 183.51it/s] 28%|██████████████▌                                     | 2718/9734 [00:15<00:38, 183.91it/s] 28%|██████████████▌                                     | 2737/9734 [00:15<00:37, 184.26it/s] 28%|██████████████▋                                     | 2756/9734 [00:15<00:37, 184.40it/s] 29%|██████████████▊                                     | 2775/9734 [00:15<00:37, 184.54it/s] 29%|██████████████▉                                     | 2794/9734 [00:15<00:37, 184.75it/s] 29%|███████████████                                     | 2813/9734 [00:16<00:37, 184.73it/s] 29%|███████████████▏                                    | 2832/9734 [00:16<00:37, 185.06it/s] 29%|███████████████▏                                    | 2851/9734 [00:16<00:37, 184.95it/s] 29%|███████████████▎                                    | 2870/9734 [00:16<00:37, 185.23it/s] 30%|███████████████▍                                    | 2889/9734 [00:16<00:37, 184.45it/s] 30%|███████████████▌                                    | 2908/9734 [00:16<00:36, 184.86it/s] 30%|███████████████▋                                    | 2927/9734 [00:16<00:37, 183.32it/s] 30%|███████████████▋                                    | 2946/9734 [00:16<00:36, 183.93it/s] 30%|███████████████▊                                    | 2965/9734 [00:16<00:36, 184.37it/s] 31%|███████████████▉                                    | 2984/9734 [00:16<00:36, 184.66it/s] 31%|████████████████                                    | 3003/9734 [00:17<00:36, 184.73it/s] 31%|████████████████▏                                   | 3022/9734 [00:17<00:36, 184.85it/s] 31%|████████████████▏                                   | 3041/9734 [00:17<00:36, 184.91it/s] 31%|████████████████▎                                   | 3060/9734 [00:17<00:36, 184.86it/s] 32%|████████████████▍                                   | 3079/9734 [00:17<00:36, 184.80it/s] 32%|████████████████▌                                   | 3098/9734 [00:17<00:35, 184.80it/s] 32%|████████████████▋                                   | 3117/9734 [00:17<00:35, 185.04it/s] 32%|████████████████▊                                   | 3136/9734 [00:17<00:35, 185.05it/s] 32%|████████████████▊                                   | 3155/9734 [00:17<00:35, 183.58it/s] 33%|████████████████▉                                   | 3174/9734 [00:17<00:35, 184.14it/s] 33%|█████████████████                                   | 3193/9734 [00:18<00:35, 184.51it/s] 33%|█████████████████▏                                  | 3212/9734 [00:18<00:35, 183.00it/s] 33%|█████████████████▎                                  | 3231/9734 [00:18<00:35, 183.81it/s] 33%|█████████████████▎                                  | 3250/9734 [00:18<00:35, 184.32it/s] 34%|█████████████████▍                                  | 3269/9734 [00:18<00:35, 184.58it/s] 34%|█████████████████▌                                  | 3288/9734 [00:18<00:34, 184.72it/s] 34%|█████████████████▋                                  | 3307/9734 [00:18<00:34, 184.95it/s] 34%|█████████████████▊                                  | 3326/9734 [00:18<00:34, 184.89it/s] 34%|█████████████████▊                                  | 3345/9734 [00:18<00:34, 185.21it/s] 35%|█████████████████▉                                  | 3364/9734 [00:19<00:34, 185.24it/s] 35%|██████████████████                                  | 3383/9734 [00:19<00:34, 183.75it/s] 35%|██████████████████▏                                 | 3402/9734 [00:19<00:34, 184.14it/s] 35%|██████████████████▎                                 | 3421/9734 [00:19<00:34, 184.44it/s] 35%|██████████████████▍                                 | 3440/9734 [00:19<00:34, 184.47it/s] 36%|██████████████████▍                                 | 3459/9734 [00:19<00:33, 184.60it/s] 36%|██████████████████▌                                 | 3478/9734 [00:19<00:33, 184.74it/s] 36%|██████████████████▋                                 | 3497/9734 [00:19<00:33, 184.72it/s] 36%|██████████████████▊                                 | 3516/9734 [00:19<00:33, 183.49it/s] 36%|██████████████████▉                                 | 3535/9734 [00:19<00:33, 183.77it/s] 37%|██████████████████▉                                 | 3554/9734 [00:20<00:33, 184.25it/s] 37%|███████████████████                                 | 3573/9734 [00:20<00:33, 184.54it/s] 37%|███████████████████▏                                | 3592/9734 [00:20<00:33, 184.73it/s] 37%|███████████████████▎                                | 3611/9734 [00:20<00:33, 183.33it/s] 37%|███████████████████▍                                | 3630/9734 [00:20<00:33, 183.97it/s] 37%|███████████████████▍                                | 3649/9734 [00:20<00:33, 184.24it/s] 38%|███████████████████▌                                | 3668/9734 [00:20<00:32, 184.31it/s] 38%|███████████████████▋                                | 3687/9734 [00:20<00:32, 184.60it/s] 38%|███████████████████▊                                | 3706/9734 [00:20<00:32, 184.68it/s] 38%|███████████████████▉                                | 3725/9734 [00:20<00:32, 184.89it/s] 38%|████████████████████                                | 3744/9734 [00:21<00:32, 184.98it/s] 39%|████████████████████                                | 3763/9734 [00:21<00:32, 185.04it/s] 39%|████████████████████▏                               | 3782/9734 [00:21<00:32, 185.05it/s] 39%|████████████████████▎                               | 3801/9734 [00:21<00:32, 185.08it/s] 39%|████████████████████▍                               | 3820/9734 [00:21<00:32, 183.61it/s] 39%|████████████████████▌                               | 3839/9734 [00:21<00:32, 182.25it/s] 40%|████████████████████▌                               | 3858/9734 [00:21<00:32, 181.88it/s] 40%|████████████████████▋                               | 3877/9734 [00:21<00:32, 182.76it/s] 40%|████████████████████▊                               | 3896/9734 [00:21<00:31, 183.46it/s] 40%|████████████████████▉                               | 3915/9734 [00:22<00:31, 183.91it/s] 40%|█████████████████████                               | 3934/9734 [00:22<00:31, 184.30it/s] 41%|█████████████████████                               | 3953/9734 [00:22<00:31, 184.60it/s] 41%|█████████████████████▏                              | 3972/9734 [00:22<00:31, 184.81it/s] 41%|█████████████████████▎                              | 3991/9734 [00:22<00:31, 185.08it/s] 41%|█████████████████████▍                              | 4010/9734 [00:22<00:30, 185.23it/s] 41%|█████████████████████▌                              | 4029/9734 [00:22<00:30, 184.97it/s] 42%|█████████████████████▌                              | 4048/9734 [00:22<00:30, 185.06it/s] 42%|█████████████████████▋                              | 4067/9734 [00:22<00:30, 183.45it/s] 42%|█████████████████████▊                              | 4086/9734 [00:22<00:30, 184.01it/s] 42%|█████████████████████▉                              | 4105/9734 [00:23<00:30, 184.25it/s] 42%|██████████████████████                              | 4124/9734 [00:23<00:30, 184.67it/s] 43%|██████████████████████▏                             | 4143/9734 [00:23<00:30, 183.37it/s] 43%|██████████████████████▏                             | 4162/9734 [00:23<00:30, 183.94it/s] 43%|██████████████████████▎                             | 4181/9734 [00:23<00:30, 184.08it/s] 43%|██████████████████████▍                             | 4200/9734 [00:23<00:30, 184.30it/s] 43%|██████████████████████▌                             | 4219/9734 [00:23<00:29, 184.59it/s] 44%|██████████████████████▋                             | 4238/9734 [00:23<00:29, 184.59it/s] 44%|██████████████████████▋                             | 4257/9734 [00:23<00:29, 184.81it/s] 44%|██████████████████████▊                             | 4276/9734 [00:23<00:29, 184.92it/s] 44%|██████████████████████▉                             | 4295/9734 [00:24<00:29, 183.45it/s] 44%|███████████████████████                             | 4314/9734 [00:24<00:29, 183.98it/s] 45%|███████████████████████▏                            | 4333/9734 [00:24<00:29, 184.08it/s] 45%|███████████████████████▏                            | 4352/9734 [00:24<00:29, 184.23it/s] 45%|███████████████████████▎                            | 4371/9734 [00:24<00:29, 184.58it/s] 45%|███████████████████████▍                            | 4390/9734 [00:24<00:28, 184.66it/s] 45%|███████████████████████▌                            | 4409/9734 [00:24<00:28, 184.60it/s] 45%|███████████████████████▋                            | 4428/9734 [00:24<00:28, 184.73it/s] 46%|███████████████████████▊                            | 4447/9734 [00:24<00:28, 183.39it/s] 46%|███████████████████████▊                            | 4466/9734 [00:24<00:28, 183.88it/s] 46%|███████████████████████▉                            | 4485/9734 [00:25<00:28, 184.17it/s] 46%|████████████████████████                            | 4504/9734 [00:25<00:28, 184.22it/s] 46%|████████████████████████▏                           | 4523/9734 [00:25<00:32, 159.83it/s] 47%|████████████████████████▎                           | 4542/9734 [00:25<00:31, 166.65it/s] 47%|████████████████████████▎                           | 4561/9734 [00:25<00:30, 170.54it/s] 47%|████████████████████████▍                           | 4580/9734 [00:25<00:29, 174.66it/s] 47%|████████████████████████▌                           | 4599/9734 [00:25<00:28, 177.79it/s] 47%|████████████████████████▋                           | 4618/9734 [00:25<00:28, 180.06it/s] 48%|████████████████████████▊                           | 4637/9734 [00:25<00:28, 181.63it/s] 48%|████████████████████████▊                           | 4656/9734 [00:26<00:27, 182.61it/s] 48%|████████████████████████▉                           | 4675/9734 [00:26<00:27, 183.43it/s] 48%|█████████████████████████                           | 4694/9734 [00:26<00:27, 184.05it/s] 48%|█████████████████████████▏                          | 4713/9734 [00:26<00:27, 184.11it/s] 49%|█████████████████████████▎                          | 4732/9734 [00:26<00:27, 184.63it/s] 49%|█████████████████████████▍                          | 4751/9734 [00:26<00:40, 123.48it/s] 49%|█████████████████████████▍                          | 4770/9734 [00:26<00:36, 136.67it/s] 49%|█████████████████████████▌                          | 4789/9734 [00:26<00:33, 147.87it/s] 49%|█████████████████████████▋                          | 4808/9734 [00:27<00:31, 157.43it/s] 50%|█████████████████████████▊                          | 4827/9734 [00:27<00:29, 164.81it/s] 50%|█████████████████████████▉                          | 4846/9734 [00:27<00:28, 170.25it/s] 50%|█████████████████████████▉                          | 4865/9734 [00:27<00:27, 174.39it/s] 50%|██████████████████████████                          | 4884/9734 [00:27<00:27, 177.55it/s] 50%|██████████████████████████▏                         | 4903/9734 [00:27<00:26, 179.83it/s] 51%|██████████████████████████▎                         | 4922/9734 [00:27<00:26, 181.42it/s] 51%|██████████████████████████▍                         | 4941/9734 [00:27<00:26, 182.60it/s] 51%|██████████████████████████▍                         | 4960/9734 [00:27<00:26, 181.96it/s] 51%|██████████████████████████▌                         | 4979/9734 [00:28<00:25, 182.91it/s] 51%|██████████████████████████▋                         | 4998/9734 [00:28<00:25, 183.32it/s] 52%|██████████████████████████▊                         | 5017/9734 [00:28<00:25, 183.78it/s] 52%|██████████████████████████▉                         | 5036/9734 [00:28<00:25, 183.33it/s] 52%|███████████████████████████                         | 5055/9734 [00:28<00:25, 183.72it/s] 52%|███████████████████████████                         | 5074/9734 [00:28<00:25, 184.12it/s] 52%|███████████████████████████▏                        | 5093/9734 [00:28<00:25, 184.31it/s] 53%|███████████████████████████▎                        | 5112/9734 [00:28<00:25, 184.38it/s] 53%|███████████████████████████▍                        | 5131/9734 [00:28<00:24, 184.48it/s] 53%|███████████████████████████▌                        | 5150/9734 [00:28<00:24, 184.77it/s] 53%|███████████████████████████▌                        | 5169/9734 [00:29<00:24, 184.80it/s] 53%|███████████████████████████▋                        | 5188/9734 [00:29<00:24, 183.27it/s] 53%|███████████████████████████▊                        | 5207/9734 [00:29<00:24, 183.80it/s] 54%|███████████████████████████▉                        | 5226/9734 [00:29<00:24, 184.13it/s] 54%|████████████████████████████                        | 5245/9734 [00:29<00:24, 184.48it/s] 54%|████████████████████████████                        | 5264/9734 [00:29<00:24, 184.43it/s] 54%|████████████████████████████▏                       | 5283/9734 [00:29<00:24, 184.35it/s] 54%|████████████████████████████▎                       | 5302/9734 [00:29<00:23, 184.67it/s] 55%|████████████████████████████▍                       | 5321/9734 [00:29<00:23, 184.65it/s] 55%|████████████████████████████▌                       | 5340/9734 [00:29<00:23, 184.75it/s] 55%|████████████████████████████▋                       | 5359/9734 [00:30<00:23, 184.69it/s] 55%|████████████████████████████▋                       | 5378/9734 [00:30<00:23, 184.72it/s] 55%|████████████████████████████▊                       | 5397/9734 [00:30<00:23, 184.73it/s] 56%|████████████████████████████▉                       | 5416/9734 [00:30<00:23, 183.17it/s] 56%|█████████████████████████████                       | 5435/9734 [00:30<00:23, 183.57it/s] 56%|█████████████████████████████▏                      | 5454/9734 [00:30<00:23, 183.01it/s] 56%|█████████████████████████████▏                      | 5473/9734 [00:30<00:23, 183.59it/s] 56%|█████████████████████████████▎                      | 5492/9734 [00:30<00:22, 185.33it/s] 57%|█████████████████████████████▍                      | 5512/9734 [00:30<00:22, 186.86it/s] 57%|█████████████████████████████▌                      | 5532/9734 [00:30<00:22, 187.90it/s] 57%|█████████████████████████████▋                      | 5552/9734 [00:31<00:22, 188.72it/s] 57%|█████████████████████████████▊                      | 5571/9734 [00:31<00:22, 188.87it/s] 57%|█████████████████████████████▊                      | 5590/9734 [00:31<00:21, 189.06it/s] 58%|█████████████████████████████▉                      | 5610/9734 [00:31<00:21, 189.41it/s] 58%|██████████████████████████████                      | 5629/9734 [00:31<00:21, 187.83it/s] 58%|██████████████████████████████▏                     | 5648/9734 [00:31<00:21, 188.24it/s] 58%|██████████████████████████████▎                     | 5667/9734 [00:31<00:21, 188.71it/s] 58%|██████████████████████████████▍                     | 5686/9734 [00:31<00:21, 189.07it/s] 59%|██████████████████████████████▍                     | 5706/9734 [00:31<00:21, 189.41it/s] 59%|██████████████████████████████▌                     | 5726/9734 [00:32<00:21, 189.68it/s] 59%|██████████████████████████████▋                     | 5746/9734 [00:32<00:21, 189.86it/s] 59%|██████████████████████████████▊                     | 5766/9734 [00:32<00:20, 189.96it/s] 59%|██████████████████████████████▉                     | 5786/9734 [00:32<00:20, 190.01it/s] 60%|███████████████████████████████                     | 5806/9734 [00:32<00:20, 189.84it/s] 60%|███████████████████████████████                     | 5825/9734 [00:32<00:20, 189.82it/s] 60%|███████████████████████████████▏                    | 5844/9734 [00:32<00:20, 189.81it/s] 60%|███████████████████████████████▎                    | 5863/9734 [00:32<00:20, 188.07it/s] 60%|███████████████████████████████▍                    | 5883/9734 [00:32<00:20, 188.69it/s] 61%|███████████████████████████████▌                    | 5902/9734 [00:32<00:20, 188.91it/s] 61%|███████████████████████████████▋                    | 5921/9734 [00:33<00:20, 189.18it/s] 61%|███████████████████████████████▋                    | 5941/9734 [00:33<00:20, 189.49it/s] 61%|███████████████████████████████▊                    | 5960/9734 [00:33<00:19, 189.63it/s] 61%|███████████████████████████████▉                    | 5979/9734 [00:33<00:19, 189.71it/s] 62%|████████████████████████████████                    | 5998/9734 [00:33<00:19, 189.74it/s] 62%|████████████████████████████████▏                   | 6017/9734 [00:33<00:19, 189.70it/s] 62%|████████████████████████████████▏                   | 6036/9734 [00:33<00:19, 189.70it/s] 62%|████████████████████████████████▎                   | 6056/9734 [00:33<00:19, 189.88it/s] 62%|████████████████████████████████▍                   | 6075/9734 [00:33<00:19, 189.89it/s] 63%|████████████████████████████████▌                   | 6094/9734 [00:33<00:19, 188.44it/s] 63%|████████████████████████████████▋                   | 6113/9734 [00:34<00:19, 188.77it/s] 63%|████████████████████████████████▊                   | 6132/9734 [00:34<00:19, 188.98it/s] 63%|████████████████████████████████▊                   | 6151/9734 [00:34<00:18, 189.20it/s] 63%|████████████████████████████████▉                   | 6171/9734 [00:34<00:18, 189.53it/s] 64%|█████████████████████████████████                   | 6191/9734 [00:34<00:18, 189.81it/s] 64%|█████████████████████████████████▏                  | 6211/9734 [00:34<00:18, 189.94it/s] 64%|█████████████████████████████████▎                  | 6230/9734 [00:34<00:18, 189.78it/s] 64%|█████████████████████████████████▍                  | 6249/9734 [00:34<00:18, 189.73it/s] 64%|█████████████████████████████████▍                  | 6268/9734 [00:34<00:18, 189.78it/s] 65%|█████████████████████████████████▌                  | 6287/9734 [00:34<00:18, 189.65it/s] 65%|█████████████████████████████████▋                  | 6306/9734 [00:35<00:18, 189.69it/s] 65%|█████████████████████████████████▊                  | 6325/9734 [00:35<00:18, 188.23it/s] 65%|█████████████████████████████████▉                  | 6344/9734 [00:35<00:17, 188.73it/s] 65%|█████████████████████████████████▉                  | 6363/9734 [00:35<00:17, 189.03it/s] 66%|██████████████████████████████████                  | 6383/9734 [00:35<00:17, 189.43it/s] 66%|██████████████████████████████████▏                 | 6402/9734 [00:35<00:17, 189.59it/s] 66%|██████████████████████████████████▎                 | 6421/9734 [00:35<00:17, 189.68it/s] 66%|██████████████████████████████████▍                 | 6440/9734 [00:35<00:17, 189.73it/s] 66%|██████████████████████████████████▌                 | 6459/9734 [00:35<00:17, 189.60it/s] 67%|██████████████████████████████████▌                 | 6479/9734 [00:35<00:17, 189.82it/s] 67%|██████████████████████████████████▋                 | 6499/9734 [00:36<00:17, 190.02it/s] 67%|██████████████████████████████████▊                 | 6519/9734 [00:36<00:16, 189.82it/s] 67%|██████████████████████████████████▉                 | 6538/9734 [00:36<00:16, 188.07it/s] 67%|███████████████████████████████████                 | 6557/9734 [00:36<00:16, 188.44it/s] 68%|███████████████████████████████████▏                | 6576/9734 [00:36<00:16, 188.70it/s] 68%|███████████████████████████████████▏                | 6595/9734 [00:36<00:16, 188.97it/s] 68%|███████████████████████████████████▎                | 6614/9734 [00:36<00:16, 189.26it/s] 68%|███████████████████████████████████▍                | 6634/9734 [00:36<00:16, 189.57it/s] 68%|███████████████████████████████████▌                | 6654/9734 [00:36<00:16, 189.84it/s] 69%|███████████████████████████████████▋                | 6674/9734 [00:37<00:16, 189.90it/s] 69%|███████████████████████████████████▊                | 6693/9734 [00:37<00:16, 189.66it/s] 69%|███████████████████████████████████▊                | 6712/9734 [00:37<00:15, 189.45it/s] 69%|███████████████████████████████████▉                | 6731/9734 [00:37<00:15, 189.60it/s] 69%|████████████████████████████████████                | 6751/9734 [00:37<00:15, 189.81it/s] 70%|████████████████████████████████████▏               | 6770/9734 [00:37<00:15, 188.31it/s] 70%|████████████████████████████████████▎               | 6789/9734 [00:37<00:15, 188.78it/s] 70%|████████████████████████████████████▎               | 6809/9734 [00:37<00:15, 189.18it/s] 70%|████████████████████████████████████▍               | 6829/9734 [00:37<00:15, 189.46it/s] 70%|████████████████████████████████████▌               | 6848/9734 [00:37<00:15, 189.59it/s] 71%|████████████████████████████████████▋               | 6867/9734 [00:38<00:15, 189.64it/s] 71%|████████████████████████████████████▊               | 6886/9734 [00:38<00:15, 189.50it/s] 71%|████████████████████████████████████▉               | 6905/9734 [00:38<00:14, 189.55it/s] 71%|████████████████████████████████████▉               | 6925/9734 [00:38<00:14, 189.78it/s] 71%|█████████████████████████████████████               | 6945/9734 [00:38<00:14, 189.92it/s] 72%|█████████████████████████████████████▏              | 6964/9734 [00:38<00:14, 189.86it/s] 72%|█████████████████████████████████████▎              | 6984/9734 [00:38<00:14, 189.94it/s] 72%|█████████████████████████████████████▍              | 7003/9734 [00:38<00:14, 187.87it/s] 72%|█████████████████████████████████████▌              | 7022/9734 [00:38<00:14, 188.33it/s] 72%|█████████████████████████████████████▌              | 7041/9734 [00:38<00:14, 188.55it/s] 73%|█████████████████████████████████████▋              | 7060/9734 [00:39<00:14, 188.96it/s] 73%|█████████████████████████████████████▊              | 7080/9734 [00:39<00:14, 189.31it/s] 73%|█████████████████████████████████████▉              | 7100/9734 [00:39<00:13, 189.55it/s] 73%|██████████████████████████████████████              | 7119/9734 [00:39<00:13, 189.48it/s] 73%|██████████████████████████████████████▏             | 7138/9734 [00:39<00:13, 189.51it/s] 74%|██████████████████████████████████████▏             | 7157/9734 [00:39<00:13, 189.58it/s] 74%|██████████████████████████████████████▎             | 7176/9734 [00:39<00:13, 189.63it/s] 74%|██████████████████████████████████████▍             | 7196/9734 [00:39<00:13, 189.76it/s] 74%|██████████████████████████████████████▌             | 7215/9734 [00:39<00:13, 187.92it/s] 74%|██████████████████████████████████████▋             | 7234/9734 [00:39<00:13, 188.41it/s] 75%|██████████████████████████████████████▋             | 7253/9734 [00:40<00:13, 188.66it/s] 75%|██████████████████████████████████████▊             | 7272/9734 [00:40<00:13, 188.96it/s] 75%|██████████████████████████████████████▉             | 7292/9734 [00:40<00:12, 189.33it/s] 75%|███████████████████████████████████████             | 7311/9734 [00:40<00:12, 189.26it/s] 75%|███████████████████████████████████████▏            | 7330/9734 [00:40<00:12, 189.47it/s] 75%|███████████████████████████████████████▎            | 7349/9734 [00:40<00:12, 189.60it/s] 76%|███████████████████████████████████████▎            | 7368/9734 [00:40<00:12, 189.70it/s] 76%|███████████████████████████████████████▍            | 7387/9734 [00:40<00:12, 189.74it/s] 76%|███████████████████████████████████████▌            | 7406/9734 [00:40<00:12, 189.80it/s] 76%|███████████████████████████████████████▋            | 7426/9734 [00:40<00:12, 189.86it/s] 76%|███████████████████████████████████████▊            | 7445/9734 [00:41<00:13, 170.78it/s] 77%|███████████████████████████████████████▊            | 7464/9734 [00:41<00:12, 176.01it/s] 77%|███████████████████████████████████████▉            | 7483/9734 [00:41<00:12, 179.42it/s] 77%|████████████████████████████████████████            | 7502/9734 [00:41<00:12, 182.26it/s] 77%|████████████████████████████████████████▏           | 7521/9734 [00:41<00:12, 184.06it/s] 77%|████████████████████████████████████████▎           | 7540/9734 [00:41<00:11, 185.42it/s] 78%|████████████████████████████████████████▍           | 7559/9734 [00:41<00:11, 186.72it/s] 78%|████████████████████████████████████████▍           | 7578/9734 [00:41<00:11, 187.60it/s] 78%|████████████████████████████████████████▌           | 7597/9734 [00:41<00:11, 188.15it/s] 78%|████████████████████████████████████████▋           | 7616/9734 [00:42<00:11, 188.64it/s] 78%|████████████████████████████████████████▊           | 7635/9734 [00:42<00:11, 188.99it/s] 79%|████████████████████████████████████████▉           | 7654/9734 [00:42<00:10, 189.13it/s] 79%|████████████████████████████████████████▉           | 7673/9734 [00:42<00:10, 187.69it/s] 79%|█████████████████████████████████████████           | 7692/9734 [00:42<00:10, 188.13it/s] 79%|█████████████████████████████████████████▏          | 7711/9734 [00:42<00:10, 188.62it/s] 79%|█████████████████████████████████████████▎          | 7730/9734 [00:42<00:10, 188.99it/s] 80%|█████████████████████████████████████████▍          | 7749/9734 [00:42<00:10, 189.10it/s] 80%|█████████████████████████████████████████▍          | 7768/9734 [00:42<00:10, 189.30it/s] 80%|█████████████████████████████████████████▌          | 7787/9734 [00:42<00:10, 189.42it/s] 80%|█████████████████████████████████████████▋          | 7807/9734 [00:43<00:10, 189.64it/s] 80%|█████████████████████████████████████████▊          | 7826/9734 [00:43<00:10, 189.74it/s] 81%|█████████████████████████████████████████▉          | 7845/9734 [00:43<00:09, 189.72it/s] 81%|██████████████████████████████████████████          | 7864/9734 [00:43<00:09, 189.57it/s] 81%|██████████████████████████████████████████          | 7883/9734 [00:43<00:09, 189.60it/s] 81%|██████████████████████████████████████████▏         | 7902/9734 [00:43<00:09, 188.00it/s] 81%|██████████████████████████████████████████▎         | 7921/9734 [00:43<00:09, 188.57it/s] 82%|██████████████████████████████████████████▍         | 7940/9734 [00:43<00:09, 188.64it/s] 82%|██████████████████████████████████████████▌         | 7959/9734 [00:43<00:09, 188.97it/s] 82%|██████████████████████████████████████████▌         | 7978/9734 [00:43<00:09, 188.62it/s] 82%|██████████████████████████████████████████▋         | 7998/9734 [00:44<00:09, 189.07it/s] 82%|██████████████████████████████████████████▊         | 8017/9734 [00:44<00:09, 189.19it/s] 83%|██████████████████████████████████████████▉         | 8036/9734 [00:44<00:08, 189.24it/s] 83%|███████████████████████████████████████████         | 8055/9734 [00:44<00:08, 189.19it/s] 83%|███████████████████████████████████████████▏        | 8074/9734 [00:44<00:08, 189.35it/s] 83%|███████████████████████████████████████████▏        | 8094/9734 [00:44<00:08, 189.61it/s] 83%|███████████████████████████████████████████▎        | 8114/9734 [00:44<00:08, 189.83it/s] 84%|███████████████████████████████████████████▍        | 8133/9734 [00:44<00:08, 188.25it/s] 84%|███████████████████████████████████████████▌        | 8152/9734 [00:44<00:08, 188.72it/s] 84%|███████████████████████████████████████████▋        | 8171/9734 [00:44<00:08, 188.93it/s] 84%|███████████████████████████████████████████▊        | 8190/9734 [00:45<00:08, 188.88it/s] 84%|███████████████████████████████████████████▊        | 8209/9734 [00:45<00:08, 189.08it/s] 85%|███████████████████████████████████████████▉        | 8228/9734 [00:45<00:07, 189.28it/s] 85%|████████████████████████████████████████████        | 8247/9734 [00:45<00:07, 189.45it/s] 85%|████████████████████████████████████████████▏       | 8266/9734 [00:45<00:07, 189.55it/s] 85%|████████████████████████████████████████████▎       | 8285/9734 [00:45<00:07, 189.51it/s] 85%|████████████████████████████████████████████▎       | 8304/9734 [00:45<00:07, 189.44it/s] 86%|████████████████████████████████████████████▍       | 8324/9734 [00:45<00:07, 189.65it/s] 86%|████████████████████████████████████████████▌       | 8343/9734 [00:45<00:07, 189.40it/s] 86%|████████████████████████████████████████████▋       | 8362/9734 [00:45<00:07, 187.33it/s] 86%|████████████████████████████████████████████▊       | 8381/9734 [00:46<00:07, 187.98it/s] 86%|████████████████████████████████████████████▊       | 8400/9734 [00:46<00:07, 188.39it/s] 87%|████████████████████████████████████████████▉       | 8420/9734 [00:46<00:06, 188.94it/s] 87%|█████████████████████████████████████████████       | 8440/9734 [00:46<00:06, 189.28it/s] 87%|█████████████████████████████████████████████▏      | 8459/9734 [00:46<00:06, 189.40it/s] 87%|█████████████████████████████████████████████▎      | 8478/9734 [00:46<00:06, 189.32it/s] 87%|█████████████████████████████████████████████▍      | 8497/9734 [00:46<00:06, 189.23it/s] 87%|█████████████████████████████████████████████▍      | 8516/9734 [00:46<00:06, 189.36it/s] 88%|█████████████████████████████████████████████▌      | 8535/9734 [00:46<00:06, 189.38it/s] 88%|█████████████████████████████████████████████▋      | 8554/9734 [00:46<00:06, 189.47it/s] 88%|█████████████████████████████████████████████▊      | 8573/9734 [00:47<00:06, 189.50it/s] 88%|█████████████████████████████████████████████▉      | 8592/9734 [00:47<00:06, 187.93it/s] 88%|██████████████████████████████████████████████      | 8611/9734 [00:47<00:05, 188.28it/s] 89%|██████████████████████████████████████████████      | 8630/9734 [00:47<00:05, 188.46it/s] 89%|██████████████████████████████████████████████▏     | 8649/9734 [00:47<00:05, 188.68it/s] 89%|██████████████████████████████████████████████▎     | 8668/9734 [00:47<00:05, 188.84it/s] 89%|██████████████████████████████████████████████▍     | 8687/9734 [00:47<00:05, 189.18it/s] 89%|██████████████████████████████████████████████▌     | 8706/9734 [00:47<00:05, 189.41it/s] 90%|██████████████████████████████████████████████▌     | 8725/9734 [00:47<00:05, 189.53it/s] 90%|██████████████████████████████████████████████▋     | 8744/9734 [00:48<00:05, 189.49it/s] 90%|██████████████████████████████████████████████▊     | 8763/9734 [00:48<00:05, 189.51it/s] 90%|██████████████████████████████████████████████▉     | 8782/9734 [00:48<00:05, 188.08it/s] 90%|███████████████████████████████████████████████     | 8801/9734 [00:48<00:04, 188.34it/s] 91%|███████████████████████████████████████████████     | 8820/9734 [00:48<00:04, 187.02it/s] 91%|███████████████████████████████████████████████▏    | 8839/9734 [00:48<00:04, 187.63it/s] 91%|███████████████████████████████████████████████▎    | 8858/9734 [00:48<00:04, 188.11it/s] 91%|███████████████████████████████████████████████▍    | 8877/9734 [00:48<00:04, 188.63it/s] 91%|███████████████████████████████████████████████▌    | 8896/9734 [00:48<00:04, 188.99it/s] 92%|███████████████████████████████████████████████▌    | 8915/9734 [00:48<00:04, 189.06it/s] 92%|███████████████████████████████████████████████▋    | 8934/9734 [00:49<00:04, 189.17it/s] 92%|███████████████████████████████████████████████▊    | 8953/9734 [00:49<00:04, 189.29it/s] 92%|███████████████████████████████████████████████▉    | 8972/9734 [00:49<00:04, 189.19it/s] 92%|████████████████████████████████████████████████    | 8991/9734 [00:49<00:03, 189.29it/s] 93%|████████████████████████████████████████████████▏   | 9010/9734 [00:49<00:03, 189.41it/s] 93%|████████████████████████████████████████████████▏   | 9029/9734 [00:49<00:03, 189.53it/s] 93%|████████████████████████████████████████████████▎   | 9048/9734 [00:49<00:03, 187.30it/s] 93%|████████████████████████████████████████████████▍   | 9067/9734 [00:49<00:03, 187.92it/s] 93%|████████████████████████████████████████████████▌   | 9086/9734 [00:49<00:03, 188.29it/s] 94%|████████████████████████████████████████████████▋   | 9105/9734 [00:49<00:03, 188.65it/s] 94%|████████████████████████████████████████████████▋   | 9124/9734 [00:50<00:03, 188.70it/s] 94%|████████████████████████████████████████████████▊   | 9143/9734 [00:50<00:03, 188.95it/s] 94%|████████████████████████████████████████████████▉   | 9162/9734 [00:50<00:03, 189.15it/s] 94%|█████████████████████████████████████████████████   | 9181/9734 [00:50<00:02, 189.36it/s] 95%|█████████████████████████████████████████████████▏  | 9200/9734 [00:50<00:02, 187.10it/s] 95%|█████████████████████████████████████████████████▏  | 9219/9734 [00:50<00:02, 187.69it/s] 95%|█████████████████████████████████████████████████▎  | 9238/9734 [00:50<00:02, 188.20it/s] 95%|█████████████████████████████████████████████████▍  | 9257/9734 [00:50<00:02, 188.49it/s] 95%|█████████████████████████████████████████████████▌  | 9276/9734 [00:50<00:02, 185.99it/s] 95%|█████████████████████████████████████████████████▋  | 9295/9734 [00:50<00:02, 186.81it/s] 96%|█████████████████████████████████████████████████▊  | 9314/9734 [00:51<00:02, 187.62it/s] 96%|█████████████████████████████████████████████████▊  | 9333/9734 [00:51<00:02, 188.19it/s] 96%|█████████████████████████████████████████████████▉  | 9352/9734 [00:51<00:02, 188.41it/s] 96%|██████████████████████████████████████████████████  | 9371/9734 [00:51<00:01, 188.79it/s] 96%|██████████████████████████████████████████████████▏ | 9390/9734 [00:51<00:01, 189.07it/s] 97%|██████████████████████████████████████████████████▎ | 9409/9734 [00:51<00:01, 189.23it/s] 97%|██████████████████████████████████████████████████▎ | 9428/9734 [00:51<00:01, 189.13it/s] 97%|██████████████████████████████████████████████████▍ | 9447/9734 [00:51<00:01, 189.25it/s] 97%|██████████████████████████████████████████████████▌ | 9466/9734 [00:51<00:01, 189.28it/s] 97%|██████████████████████████████████████████████████▋ | 9485/9734 [00:51<00:01, 187.62it/s] 98%|██████████████████████████████████████████████████▊ | 9504/9734 [00:52<00:01, 188.04it/s] 98%|██████████████████████████████████████████████████▊ | 9523/9734 [00:52<00:01, 188.50it/s] 98%|██████████████████████████████████████████████████▉ | 9542/9734 [00:52<00:01, 188.76it/s] 98%|███████████████████████████████████████████████████ | 9561/9734 [00:52<00:00, 188.99it/s] 98%|███████████████████████████████████████████████████▏| 9580/9734 [00:52<00:00, 188.94it/s] 99%|███████████████████████████████████████████████████▎| 9599/9734 [00:52<00:00, 187.86it/s] 99%|███████████████████████████████████████████████████▍| 9618/9734 [00:52<00:00, 188.40it/s] 99%|███████████████████████████████████████████████████▍| 9637/9734 [00:52<00:00, 188.56it/s] 99%|███████████████████████████████████████████████████▌| 9656/9734 [00:52<00:00, 188.76it/s] 99%|███████████████████████████████████████████████████▋| 9675/9734 [00:52<00:00, 189.03it/s]100%|███████████████████████████████████████████████████▊| 9694/9734 [00:53<00:00, 189.14it/s]100%|███████████████████████████████████████████████████▉| 9713/9734 [00:53<00:00, 187.61it/s]100%|███████████████████████████████████████████████████▉| 9732/9734 [00:53<00:00, 187.83it/s]100%|████████████████████████████████████████████████████| 9734/9734 [00:53<00:00, 182.77it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.24s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.21s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:11,  5.52s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:11,  5.58s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.32s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.44s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.41s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:12<00:06,  6.29s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.71s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.87s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.74s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.93s/it]
[2023-08-21 15:14:33,308] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.75s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.91s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:18<00:00,  6.21s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:18<00:00,  6.16s/it]
[2023-08-21 15:14:49,005] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-21 15:14:49,006] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-21 15:14:49,006] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-21 15:14:49,006] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-21 15:14:49,006] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f7891664fd0>
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-21 15:14:49,007] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f785dde8cd0>
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-21 15:14:49,008] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-21 15:14:49,008] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.6408486366271973 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: 1. The question asks where you could find plumbing that would not be useful to you if you were thirsty.
2. This means we need to identify an option among A: oil refineries, B: wall, C: show, D: own home, E: water fountain where the plumbing would not be capable of supplying drinkable water.
3. We know that plumbing in our own home (D) and at a water fountain (E) would provide water for thirst, so we eliminate these options.
4. The plumbing within a wall (B) could potentially supply water if it's connected to a suitable source, so we can also remove this option.
5. A show (C) is a vague answer and may or may not have plumbing. However, if it has a plumbing system, it would more likely be connected to drinkable water supply eliminating this option too.
6. This leaves us with A: oil refineries. Oil refineries, while having an extensive network of pipes and plumbing, these are designed to transport oil, not drinkable water.
7. Therefore, the answer is A: oil refineries as it's the only place where the plumbing would not be of use if you were thirsty.
So the final answer is A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Output: 1. The question is asking what a person is not doing when they are just starting to work. 
2. The first option "working" is not correct since the person is obviously just beginning to work or is in the process of working.
3. Similarly, the fifth option "momentum" cannot fit as it implies being under motion or making progress, which the person may well be doing while starting to work.
4. While it's possible for some to consider "tiredness," as a right option assuming that the person wouldn't be tired just starting to work, the keyword here is "doing." "Tiredness" isn't an action; instead, it's a state. So, "tiredness" can't be the right answer.
5. The third option "resting" is also incorrect because if a person is beginning to work it implies they're not at rest. 
6. Thus, the only remaining option is "accomplishing," which makes sense since when a person is just beginning work, they have not accomplished anything just yet. 
7. Therefore, the answer is D: accomplishing.
So the final answer is D: accomplishing

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Output: 1. Start with the given question which is asking where you can find pens with a company logo. 
2. Company logo pens are usually used in places of business or organizations, where they may be given out to employees, clients or customers. 
3. These places want to have their branding on items such as pens, which are seen and used by many people. 
4. With this in mind, let's evaluate each of the given options.
5. Option B: Pens aren't usually found on pencils, and pencils are not likely to carry a company logo.
6. Option C: Writing sentences on paper doesn't relate to the location where you can find pens with a company logo.
7. Option D: Schools are more likely to have pens with school logos, not company logos.
8. Option E: A backpack could theoretically hold a pen with a company logo, but it's not a place where you primarily find them.
9. However, option A: Office, is strongly associated with companies and businesses, and it’s mostly in the office space that a person would come across pens with a company logo.
10. Therefore, the answer is A: office.
So the final answer is A: office

Input: Billy called out to John, and listened for what? Choices:  A: silence B: response C: communication D: hanging up E: whisper
Output: Step 1: Understand the context of the question. It is about communication between two people, where one person (Billy) initiates the contact.
 
Step 2: Evaluate the options. It mentions that Billy 'called out' implying he is seeking attention or an answer. When you communicate or 'call out' to someone else, you typically await their reply.

Step 3: Options A and E, silence and whisper, don't fit the context as Billy would be expecting clear communication after he called out. Option D, hanging up, is not suitable because it refers to ending a call on a phone, not initiating a conversation.

Step 4: Option C, communication, is close but too broad. Communication can refer to any exchange or transfer of information between people, not specifically a return message from John.

Step 5: Option B, response, is the best answer. It correctly defines what Billy would be waiting for after he called out to John - a reply or return communication from John. 

In conclusion, the answer is B: response.
So the final answer is B: response

Input: The lizard frightened the hiker, it's movements made what rustle? Choices:  A: garden B: trees C: books D: rocks E: bushes
Output: 1. The primary information provided in the question is that the lizard frightened the hiker through its movements that made some rustle.
2. To find the right answer, we need to pinpoint what the lizard's movements could have rustled. We need something that can rustle or make a rustling sound.
3. Let's go through the options one by one. 
4. Option A is garden. However, a garden itself cannot rustle, various elements within it might, but it's not specific enough. This does not seem to fit the given situation.
5. Next is Option B, trees. Trees do make rustle-like noises when the wind blows through their leaves, but usually, they are not low enough to the ground for a lizard to rustle.
6. Then we have Option C, books. It is very unlikely for a lizard to rustle books as they are typically indoors and lizards are mostly found outside. So option C is out.
7. Option D, rocks, cannot rustle as they are solid and non-flexible objects.
8. Finally, Option E is bushes. Bushes contain leaves that could easily rustle with the slightest touch or when wind passes through them. And more importantly, a lizard, being a creature that usually stays on the ground, could easily create a rustle by moving through them.
9. Therefore, putting together all the information and reasoning, we find that the answer is E: bushes.
So the final answer is E: bushes

Input: The man spent big money and time maintaining his lawn, it was part of keeping up with the Joneses where? Choices:  A: front yard B: suburbia C: neighborhood D: back yard E: golf course
Output: 1. The phrase "keeping up with the Joneses" refers to the comparison to one's neighbor as a benchmark for social class or the accumulation of material goods.
2. This phrase is often used in the context of appearances and the social status related to where one lives.
3. Therefore, the answer should be a place where neighbors could see and compare such material displays.
4. Although options A, C, D, and E are all plausible locations for a lawn to be maintained, option B, the suburbia encompasses the whole neighborhood where 'keeping up with the Joneses' is an essential part.
5. This means that'suburbia' is the most appropriate answer, as it covers a greater area where this social comparison can occur.
6. Hence, the answer is B: suburbia.
So the final answer is B: suburbia

Input: What would a human do if they want to get to a store that he or she can see? Choices:  A: cross road B: see around C: drink coffee D: dream dreams E: think critically
Output: The question gives a scenario where a person can see the store they want to reach.

This implies a physical distance between the person and the store that needs to be covered.

Among the options provided, option B: seeing around, may be a part of the process, but it wouldn't necessarily help the person get closer to the store.

Option C: Drinking coffee, Option D: Dreaming dreams, and Option E: Thinking critically
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i7-s1-rTrue
Loading extension module utils...
Time to load utils op: 0.503293514251709 seconds
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.6038291454315186 seconds
Time to load utils op: 0.5048162937164307 seconds
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:41<34:16, 41.96s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:23<33:12, 41.50s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [02:04<32:24, 41.38s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [02:45<31:39, 41.28s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [03:26<30:59, 41.33s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [04:08<30:19, 41.35s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [04:49<29:38, 41.35s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [05:31<28:56, 41.35s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [06:12<28:15, 41.35s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [06:53<27:34, 41.35s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [07:35<26:54, 41.40s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [08:16<26:12, 41.37s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [08:58<25:31, 41.40s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [09:39<24:51, 41.43s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [10:20<24:07, 41.36s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [11:02<23:25, 41.35s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [11:43<22:44, 41.35s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [12:24<22:03, 41.35s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [13:05<21:21, 41.32s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [13:47<20:40, 41.34s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [14:28<19:58, 41.33s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [15:09<19:17, 41.32s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [15:51<18:35, 41.31s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [16:32<17:54, 41.33s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [17:14<17:15, 41.40s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [17:55<16:33, 41.38s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [18:36<15:52, 41.40s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [19:18<15:11, 41.44s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [20:00<14:31, 41.48s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [20:41<13:49, 41.46s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [21:22<13:06, 41.41s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [22:04<12:25, 41.40s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [22:45<11:44, 41.44s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [23:12<09:54, 37.14s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [23:32<07:58, 31.89s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [24:13<08:06, 34.71s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [24:55<07:57, 36.71s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [25:36<07:36, 38.07s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [26:17<07:09, 39.03s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [26:58<06:37, 39.70s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [27:40<06:01, 40.18s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [28:21<05:24, 40.52s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [29:02<04:45, 40.75s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [29:44<04:05, 40.91s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [30:25<03:24, 40.98s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [31:06<02:44, 41.06s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [31:47<02:03, 41.16s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [32:29<01:22, 41.22s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [33:10<00:41, 41.24s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [33:51<00:00, 41.25s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [33:51<00:00, 40.64s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 0.8013} | lm_loss 12.3303 | avg. gen lenth: 359.136
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i8-s1-rTrue --seed 1 --max-prompt-length 2048 --rationales --num-in-domain 8
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-21 15:49:21,251] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i8-s1-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 8
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i8-s1-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9733 [00:00<?, ?it/s]  0%|                                                      | 12/9733 [00:00<01:24, 114.85it/s]  0%|▏                                                     | 24/9733 [00:00<01:24, 115.21it/s]  0%|▏                                                     | 36/9733 [00:00<01:24, 115.36it/s]  0%|▎                                                     | 48/9733 [00:00<01:23, 115.54it/s]  1%|▎                                                     | 60/9733 [00:00<01:23, 115.84it/s]  1%|▍                                                     | 72/9733 [00:00<01:24, 113.90it/s]  1%|▍                                                     | 84/9733 [00:00<01:24, 114.67it/s]  1%|▌                                                     | 96/9733 [00:00<01:23, 115.23it/s]  1%|▌                                                    | 108/9733 [00:00<01:23, 115.51it/s]  1%|▋                                                    | 120/9733 [00:01<01:23, 115.78it/s]  1%|▋                                                    | 132/9733 [00:01<01:22, 116.12it/s]  1%|▊                                                    | 144/9733 [00:01<01:22, 116.25it/s]  2%|▊                                                    | 156/9733 [00:01<01:22, 116.55it/s]  2%|▉                                                    | 168/9733 [00:01<01:22, 116.47it/s]  2%|▉                                                    | 180/9733 [00:01<01:22, 116.34it/s]  2%|█                                                    | 192/9733 [00:01<01:23, 114.43it/s]  2%|█                                                    | 204/9733 [00:01<01:24, 112.73it/s]  2%|█▏                                                   | 216/9733 [00:01<01:23, 113.92it/s]  2%|█▏                                                   | 228/9733 [00:01<01:22, 114.85it/s]  2%|█▎                                                   | 240/9733 [00:02<01:22, 115.37it/s]  3%|█▎                                                   | 252/9733 [00:02<01:21, 115.63it/s]  3%|█▍                                                   | 265/9733 [00:02<01:20, 117.87it/s]  3%|█▌                                                   | 283/9733 [00:02<01:09, 135.56it/s]  3%|█▋                                                   | 301/9733 [00:02<01:03, 148.05it/s]  3%|█▋                                                   | 319/9733 [00:02<01:00, 156.56it/s]  3%|█▊                                                   | 337/9733 [00:02<00:57, 162.44it/s]  4%|█▉                                                   | 355/9733 [00:02<00:56, 167.04it/s]  4%|██                                                   | 373/9733 [00:02<00:54, 170.34it/s]  4%|██▏                                                  | 391/9733 [00:03<00:54, 172.69it/s]  4%|██▏                                                  | 409/9733 [00:03<00:53, 174.21it/s]  4%|██▎                                                  | 427/9733 [00:03<00:53, 175.26it/s]  5%|██▍                                                  | 445/9733 [00:03<00:53, 174.73it/s]  5%|██▌                                                  | 463/9733 [00:03<00:52, 175.80it/s]  5%|██▌                                                  | 481/9733 [00:03<00:52, 176.23it/s]  5%|██▋                                                  | 499/9733 [00:03<00:52, 176.66it/s]  5%|██▊                                                  | 517/9733 [00:03<00:52, 176.96it/s]  5%|██▉                                                  | 535/9733 [00:03<00:51, 177.00it/s]  6%|███                                                  | 553/9733 [00:03<00:51, 177.26it/s]  6%|███                                                  | 571/9733 [00:04<00:51, 177.16it/s]  6%|███▏                                                 | 589/9733 [00:04<00:51, 177.37it/s]  6%|███▎                                                 | 607/9733 [00:04<00:51, 177.14it/s]  6%|███▍                                                 | 625/9733 [00:04<00:51, 177.25it/s]  7%|███▌                                                 | 643/9733 [00:04<00:51, 177.44it/s]  7%|███▌                                                 | 661/9733 [00:04<00:51, 176.08it/s]  7%|███▋                                                 | 679/9733 [00:04<00:51, 176.28it/s]  7%|███▊                                                 | 697/9733 [00:04<00:51, 176.99it/s]  7%|███▉                                                 | 715/9733 [00:04<00:50, 177.01it/s]  8%|███▉                                                 | 733/9733 [00:04<00:50, 177.18it/s]  8%|████                                                 | 751/9733 [00:05<00:50, 177.30it/s]  8%|████▏                                                | 769/9733 [00:05<00:50, 177.45it/s]  8%|████▎                                                | 787/9733 [00:05<00:50, 177.71it/s]  8%|████▍                                                | 805/9733 [00:05<00:50, 177.67it/s]  8%|████▍                                                | 823/9733 [00:05<00:50, 177.67it/s]  9%|████▌                                                | 841/9733 [00:05<00:50, 176.57it/s]  9%|████▋                                                | 859/9733 [00:05<00:50, 176.53it/s]  9%|████▊                                                | 877/9733 [00:05<00:50, 176.88it/s]  9%|████▊                                                | 895/9733 [00:05<00:50, 175.59it/s]  9%|████▉                                                | 913/9733 [00:05<00:50, 176.12it/s] 10%|█████                                                | 931/9733 [00:06<00:49, 176.60it/s] 10%|█████▏                                               | 949/9733 [00:06<00:49, 176.89it/s] 10%|█████▎                                               | 967/9733 [00:06<00:49, 177.04it/s] 10%|█████▎                                               | 985/9733 [00:06<00:49, 177.26it/s] 10%|█████▎                                              | 1003/9733 [00:06<00:49, 177.25it/s] 10%|█████▍                                              | 1021/9733 [00:06<00:49, 177.26it/s] 11%|█████▌                                              | 1039/9733 [00:06<00:49, 177.40it/s] 11%|█████▋                                              | 1057/9733 [00:06<00:48, 177.41it/s] 11%|█████▋                                              | 1075/9733 [00:06<00:49, 175.79it/s] 11%|█████▊                                              | 1093/9733 [00:06<00:49, 176.11it/s] 11%|█████▉                                              | 1111/9733 [00:07<00:49, 173.67it/s] 12%|██████                                              | 1129/9733 [00:07<00:49, 174.69it/s] 12%|██████▏                                             | 1147/9733 [00:07<00:49, 174.76it/s] 12%|██████▏                                             | 1165/9733 [00:07<00:48, 175.22it/s] 12%|██████▎                                             | 1183/9733 [00:07<00:48, 175.72it/s] 12%|██████▍                                             | 1201/9733 [00:07<00:48, 175.49it/s] 13%|██████▌                                             | 1219/9733 [00:07<00:48, 175.21it/s] 13%|██████▌                                             | 1237/9733 [00:07<00:48, 175.90it/s] 13%|██████▋                                             | 1255/9733 [00:07<00:47, 176.64it/s] 13%|██████▊                                             | 1273/9733 [00:07<00:47, 176.93it/s] 13%|██████▉                                             | 1291/9733 [00:08<00:47, 176.92it/s] 13%|██████▉                                             | 1309/9733 [00:08<00:47, 176.98it/s] 14%|███████                                             | 1327/9733 [00:08<00:47, 177.07it/s] 14%|███████▏                                            | 1345/9733 [00:08<00:47, 175.50it/s] 14%|███████▎                                            | 1363/9733 [00:08<00:47, 175.82it/s] 14%|███████▍                                            | 1381/9733 [00:08<00:47, 175.85it/s] 14%|███████▍                                            | 1399/9733 [00:08<00:47, 176.34it/s] 15%|███████▌                                            | 1417/9733 [00:08<00:47, 176.72it/s] 15%|███████▋                                            | 1435/9733 [00:08<00:46, 176.97it/s] 15%|███████▊                                            | 1453/9733 [00:09<00:46, 177.35it/s] 15%|███████▊                                            | 1471/9733 [00:09<00:46, 177.17it/s] 15%|███████▉                                            | 1489/9733 [00:09<00:46, 177.26it/s] 15%|████████                                            | 1507/9733 [00:09<00:46, 176.96it/s] 16%|████████▏                                           | 1525/9733 [00:09<00:46, 177.04it/s] 16%|████████▏                                           | 1543/9733 [00:09<00:46, 177.16it/s] 16%|████████▎                                           | 1561/9733 [00:09<00:46, 177.45it/s] 16%|████████▍                                           | 1579/9733 [00:09<00:46, 175.76it/s] 16%|████████▌                                           | 1597/9733 [00:09<00:46, 176.23it/s] 17%|████████▋                                           | 1615/9733 [00:09<00:46, 176.42it/s] 17%|████████▋                                           | 1633/9733 [00:10<00:45, 176.78it/s] 17%|████████▊                                           | 1651/9733 [00:10<00:45, 177.13it/s] 17%|████████▉                                           | 1669/9733 [00:10<00:45, 177.23it/s] 17%|█████████                                           | 1687/9733 [00:10<00:47, 170.29it/s] 18%|█████████                                           | 1705/9733 [00:10<00:46, 172.55it/s] 18%|█████████▏                                          | 1723/9733 [00:10<00:46, 174.02it/s] 18%|█████████▎                                          | 1741/9733 [00:10<00:45, 175.08it/s] 18%|█████████▍                                          | 1759/9733 [00:10<00:45, 175.50it/s] 18%|█████████▍                                          | 1777/9733 [00:10<00:45, 175.78it/s] 18%|█████████▌                                          | 1795/9733 [00:10<00:50, 158.24it/s] 19%|█████████▋                                          | 1813/9733 [00:11<00:48, 163.38it/s] 19%|█████████▊                                          | 1831/9733 [00:11<00:47, 167.26it/s] 19%|█████████▉                                          | 1849/9733 [00:11<00:46, 169.97it/s] 19%|█████████▉                                          | 1867/9733 [00:11<00:45, 172.15it/s] 19%|██████████                                          | 1885/9733 [00:11<00:45, 173.24it/s] 20%|██████████▏                                         | 1903/9733 [00:11<00:44, 174.14it/s] 20%|██████████▎                                         | 1921/9733 [00:11<00:44, 174.76it/s] 20%|██████████▎                                         | 1939/9733 [00:11<00:44, 175.23it/s] 20%|██████████▍                                         | 1957/9733 [00:11<00:44, 175.73it/s] 20%|██████████▌                                         | 1975/9733 [00:12<00:44, 176.20it/s] 20%|██████████▋                                         | 1993/9733 [00:12<00:43, 176.65it/s] 21%|██████████▋                                         | 2011/9733 [00:12<00:43, 176.79it/s] 21%|██████████▊                                         | 2029/9733 [00:12<00:43, 175.17it/s] 21%|██████████▉                                         | 2047/9733 [00:12<00:43, 175.62it/s] 21%|███████████                                         | 2065/9733 [00:12<00:43, 176.00it/s] 21%|███████████▏                                        | 2083/9733 [00:12<00:43, 176.11it/s] 22%|███████████▏                                        | 2101/9733 [00:12<00:43, 176.38it/s] 22%|███████████▎                                        | 2119/9733 [00:12<00:43, 176.27it/s] 22%|███████████▍                                        | 2137/9733 [00:12<00:43, 176.29it/s] 22%|███████████▌                                        | 2155/9733 [00:13<00:43, 174.82it/s] 22%|███████████▌                                        | 2173/9733 [00:13<00:43, 174.86it/s] 23%|███████████▋                                        | 2191/9733 [00:13<00:43, 175.30it/s] 23%|███████████▊                                        | 2209/9733 [00:13<00:42, 175.82it/s] 23%|███████████▉                                        | 2227/9733 [00:13<00:42, 175.54it/s] 23%|███████████▉                                        | 2245/9733 [00:13<00:43, 173.13it/s] 23%|████████████                                        | 2263/9733 [00:13<00:43, 173.61it/s] 23%|████████████▏                                       | 2281/9733 [00:13<00:42, 173.67it/s] 24%|████████████▎                                       | 2299/9733 [00:13<00:42, 174.68it/s] 24%|████████████▍                                       | 2317/9733 [00:13<00:42, 175.04it/s] 24%|████████████▍                                       | 2335/9733 [00:14<00:42, 175.73it/s] 24%|████████████▌                                       | 2353/9733 [00:14<00:41, 176.10it/s] 24%|████████████▋                                       | 2371/9733 [00:14<00:41, 176.35it/s] 25%|████████████▊                                       | 2389/9733 [00:14<00:41, 176.48it/s] 25%|████████████▊                                       | 2407/9733 [00:14<00:41, 176.69it/s] 25%|████████████▉                                       | 2425/9733 [00:14<00:41, 176.54it/s] 25%|█████████████                                       | 2443/9733 [00:14<00:41, 175.57it/s] 25%|█████████████▏                                      | 2461/9733 [00:14<00:41, 175.28it/s] 25%|█████████████▏                                      | 2479/9733 [00:14<00:41, 174.16it/s] 26%|█████████████▎                                      | 2497/9733 [00:14<00:41, 174.89it/s] 26%|█████████████▍                                      | 2515/9733 [00:15<00:41, 175.44it/s] 26%|█████████████▌                                      | 2533/9733 [00:15<00:40, 175.91it/s] 26%|█████████████▋                                      | 2551/9733 [00:15<00:40, 176.09it/s] 26%|█████████████▋                                      | 2569/9733 [00:15<00:40, 176.24it/s] 27%|█████████████▊                                      | 2587/9733 [00:15<00:40, 176.68it/s] 27%|█████████████▉                                      | 2605/9733 [00:15<00:40, 176.64it/s] 27%|██████████████                                      | 2623/9733 [00:15<00:40, 176.34it/s] 27%|██████████████                                      | 2641/9733 [00:15<00:40, 176.12it/s] 27%|██████████████▏                                     | 2659/9733 [00:15<00:40, 176.14it/s] 28%|██████████████▎                                     | 2677/9733 [00:16<00:40, 176.02it/s] 28%|██████████████▍                                     | 2695/9733 [00:16<00:40, 175.46it/s] 28%|██████████████▍                                     | 2713/9733 [00:16<00:40, 173.73it/s] 28%|██████████████▌                                     | 2731/9733 [00:16<00:40, 174.56it/s] 28%|██████████████▋                                     | 2749/9733 [00:16<00:39, 175.34it/s] 28%|██████████████▊                                     | 2767/9733 [00:16<00:39, 175.90it/s] 29%|██████████████▉                                     | 2785/9733 [00:16<00:39, 176.21it/s] 29%|██████████████▉                                     | 2803/9733 [00:16<00:39, 176.46it/s] 29%|███████████████                                     | 2821/9733 [00:16<00:39, 176.42it/s] 29%|███████████████▏                                    | 2839/9733 [00:16<00:39, 176.49it/s] 29%|███████████████▎                                    | 2857/9733 [00:17<00:38, 176.54it/s] 30%|███████████████▎                                    | 2875/9733 [00:17<00:38, 176.55it/s] 30%|███████████████▍                                    | 2893/9733 [00:17<00:38, 176.51it/s] 30%|███████████████▌                                    | 2911/9733 [00:17<00:38, 176.46it/s] 30%|███████████████▋                                    | 2929/9733 [00:17<00:38, 174.82it/s] 30%|███████████████▋                                    | 2947/9733 [00:17<00:38, 175.18it/s] 30%|███████████████▊                                    | 2965/9733 [00:17<00:38, 174.92it/s] 31%|███████████████▉                                    | 2983/9733 [00:17<00:38, 174.11it/s] 31%|████████████████                                    | 3001/9733 [00:17<00:38, 174.18it/s] 31%|████████████████▏                                   | 3019/9733 [00:17<00:38, 174.83it/s] 31%|████████████████▏                                   | 3037/9733 [00:18<00:38, 175.07it/s] 31%|████████████████▎                                   | 3055/9733 [00:18<00:38, 175.39it/s] 32%|████████████████▍                                   | 3073/9733 [00:18<00:38, 174.63it/s] 32%|████████████████▌                                   | 3091/9733 [00:18<00:38, 174.36it/s] 32%|████████████████▌                                   | 3109/9733 [00:18<00:37, 174.94it/s] 32%|████████████████▋                                   | 3127/9733 [00:18<00:37, 175.07it/s] 32%|████████████████▊                                   | 3145/9733 [00:18<00:37, 174.22it/s] 32%|████████████████▉                                   | 3163/9733 [00:18<00:37, 173.01it/s] 33%|████████████████▉                                   | 3181/9733 [00:18<00:37, 173.31it/s] 33%|█████████████████                                   | 3199/9733 [00:18<00:37, 173.82it/s] 33%|█████████████████▏                                  | 3217/9733 [00:19<00:37, 174.05it/s] 33%|█████████████████▎                                  | 3235/9733 [00:19<00:37, 175.16it/s] 33%|█████████████████▍                                  | 3253/9733 [00:19<00:36, 175.86it/s] 34%|█████████████████▍                                  | 3271/9733 [00:19<00:36, 175.75it/s] 34%|█████████████████▌                                  | 3289/9733 [00:19<00:36, 175.45it/s] 34%|█████████████████▋                                  | 3307/9733 [00:19<00:36, 174.91it/s] 34%|█████████████████▊                                  | 3325/9733 [00:19<00:36, 173.84it/s] 34%|█████████████████▊                                  | 3343/9733 [00:19<00:36, 173.31it/s] 35%|█████████████████▉                                  | 3361/9733 [00:19<00:36, 172.92it/s] 35%|██████████████████                                  | 3379/9733 [00:20<00:36, 172.58it/s] 35%|██████████████████▏                                 | 3397/9733 [00:20<00:37, 171.03it/s] 35%|██████████████████▏                                 | 3415/9733 [00:20<00:36, 171.55it/s] 35%|██████████████████▎                                 | 3433/9733 [00:20<00:36, 172.62it/s] 35%|██████████████████▍                                 | 3451/9733 [00:20<00:36, 173.57it/s] 36%|██████████████████▌                                 | 3469/9733 [00:20<00:35, 174.36it/s] 36%|██████████████████▋                                 | 3487/9733 [00:20<00:35, 174.14it/s] 36%|██████████████████▋                                 | 3505/9733 [00:20<00:35, 174.72it/s] 36%|██████████████████▊                                 | 3523/9733 [00:20<00:35, 175.37it/s] 36%|██████████████████▉                                 | 3541/9733 [00:20<00:35, 175.64it/s] 37%|███████████████████                                 | 3559/9733 [00:21<00:35, 175.79it/s] 37%|███████████████████                                 | 3577/9733 [00:21<00:34, 176.10it/s] 37%|███████████████████▏                                | 3595/9733 [00:21<00:34, 176.15it/s] 37%|███████████████████▎                                | 3613/9733 [00:21<00:35, 174.64it/s] 37%|███████████████████▍                                | 3631/9733 [00:21<00:34, 175.20it/s] 37%|███████████████████▍                                | 3649/9733 [00:21<00:34, 175.45it/s] 38%|███████████████████▌                                | 3667/9733 [00:21<00:34, 175.60it/s] 38%|███████████████████▋                                | 3685/9733 [00:21<00:34, 176.02it/s] 38%|███████████████████▊                                | 3703/9733 [00:21<00:34, 176.36it/s] 38%|███████████████████▉                                | 3721/9733 [00:21<00:34, 176.42it/s] 38%|███████████████████▉                                | 3739/9733 [00:22<00:33, 176.48it/s] 39%|████████████████████                                | 3757/9733 [00:22<00:33, 176.38it/s] 39%|████████████████████▏                               | 3775/9733 [00:22<00:33, 175.45it/s] 39%|████████████████████▎                               | 3793/9733 [00:22<00:33, 175.71it/s] 39%|████████████████████▎                               | 3811/9733 [00:22<00:33, 175.68it/s] 39%|████████████████████▍                               | 3829/9733 [00:22<00:33, 175.97it/s] 40%|████████████████████▌                               | 3847/9733 [00:22<00:33, 174.68it/s] 40%|████████████████████▋                               | 3865/9733 [00:22<00:33, 175.13it/s] 40%|████████████████████▋                               | 3883/9733 [00:22<00:33, 175.21it/s] 40%|████████████████████▊                               | 3901/9733 [00:23<00:33, 175.39it/s] 40%|████████████████████▉                               | 3919/9733 [00:23<00:33, 175.35it/s] 40%|█████████████████████                               | 3937/9733 [00:23<00:33, 175.38it/s] 41%|█████████████████████▏                              | 3955/9733 [00:23<00:32, 175.32it/s] 41%|█████████████████████▏                              | 3973/9733 [00:23<00:32, 175.16it/s] 41%|█████████████████████▎                              | 3991/9733 [00:23<00:32, 175.17it/s] 41%|█████████████████████▍                              | 4009/9733 [00:23<00:32, 175.23it/s] 41%|█████████████████████▌                              | 4027/9733 [00:23<00:32, 174.98it/s] 42%|█████████████████████▌                              | 4045/9733 [00:23<00:32, 173.75it/s] 42%|█████████████████████▋                              | 4063/9733 [00:23<00:32, 172.58it/s] 42%|█████████████████████▊                              | 4081/9733 [00:24<00:32, 173.31it/s] 42%|█████████████████████▉                              | 4099/9733 [00:24<00:32, 173.83it/s] 42%|█████████████████████▉                              | 4117/9733 [00:24<00:32, 174.19it/s] 42%|██████████████████████                              | 4135/9733 [00:24<00:32, 174.77it/s] 43%|██████████████████████▏                             | 4153/9733 [00:24<00:31, 175.52it/s] 43%|██████████████████████▎                             | 4171/9733 [00:24<00:31, 175.95it/s] 43%|██████████████████████▍                             | 4189/9733 [00:24<00:31, 176.35it/s] 43%|██████████████████████▍                             | 4207/9733 [00:24<00:31, 176.57it/s] 43%|██████████████████████▌                             | 4225/9733 [00:24<00:31, 176.70it/s] 44%|██████████████████████▋                             | 4243/9733 [00:24<00:31, 176.83it/s] 44%|██████████████████████▊                             | 4261/9733 [00:25<00:30, 177.02it/s] 44%|██████████████████████▊                             | 4279/9733 [00:25<00:30, 177.13it/s] 44%|██████████████████████▉                             | 4297/9733 [00:25<00:30, 175.55it/s] 44%|███████████████████████                             | 4315/9733 [00:25<00:31, 174.76it/s] 45%|███████████████████████▏                            | 4333/9733 [00:25<00:30, 175.41it/s] 45%|███████████████████████▏                            | 4351/9733 [00:25<00:30, 175.74it/s] 45%|███████████████████████▎                            | 4369/9733 [00:25<00:30, 176.03it/s] 45%|███████████████████████▍                            | 4387/9733 [00:25<00:30, 176.28it/s] 45%|███████████████████████▌                            | 4405/9733 [00:25<00:30, 176.49it/s] 45%|███████████████████████▋                            | 4423/9733 [00:25<00:30, 176.59it/s] 46%|███████████████████████▋                            | 4441/9733 [00:26<00:29, 176.67it/s] 46%|███████████████████████▊                            | 4459/9733 [00:26<00:29, 176.82it/s] 46%|███████████████████████▉                            | 4477/9733 [00:26<00:29, 176.75it/s] 46%|████████████████████████                            | 4495/9733 [00:26<00:29, 176.81it/s] 46%|████████████████████████                            | 4513/9733 [00:26<00:29, 176.69it/s] 47%|████████████████████████▏                           | 4531/9733 [00:26<00:33, 156.52it/s] 47%|████████████████████████▎                           | 4549/9733 [00:26<00:31, 162.08it/s] 47%|████████████████████████▍                           | 4567/9733 [00:26<00:31, 166.13it/s] 47%|████████████████████████▍                           | 4585/9733 [00:26<00:30, 168.14it/s] 47%|████████████████████████▌                           | 4603/9733 [00:27<00:30, 170.71it/s] 47%|████████████████████████▋                           | 4621/9733 [00:27<00:29, 172.52it/s] 48%|████████████████████████▊                           | 4639/9733 [00:27<00:29, 173.84it/s] 48%|████████████████████████▉                           | 4657/9733 [00:27<00:29, 174.61it/s] 48%|████████████████████████▉                           | 4675/9733 [00:27<00:28, 175.36it/s] 48%|█████████████████████████                           | 4693/9733 [00:27<00:28, 175.79it/s] 48%|█████████████████████████▏                          | 4711/9733 [00:27<00:28, 175.88it/s] 49%|█████████████████████████▎                          | 4729/9733 [00:27<00:28, 175.69it/s] 49%|█████████████████████████▎                          | 4747/9733 [00:28<00:42, 117.82it/s] 49%|█████████████████████████▍                          | 4765/9733 [00:28<00:38, 130.41it/s] 49%|█████████████████████████▌                          | 4783/9733 [00:28<00:35, 141.35it/s] 49%|█████████████████████████▋                          | 4801/9733 [00:28<00:32, 150.25it/s] 50%|█████████████████████████▋                          | 4819/9733 [00:28<00:31, 157.16it/s] 50%|█████████████████████████▊                          | 4837/9733 [00:28<00:30, 161.41it/s] 50%|█████████████████████████▉                          | 4855/9733 [00:28<00:29, 165.57it/s] 50%|██████████████████████████                          | 4873/9733 [00:28<00:28, 168.43it/s] 50%|██████████████████████████▏                         | 4891/9733 [00:28<00:28, 170.77it/s] 50%|██████████████████████████▏                         | 4909/9733 [00:28<00:28, 172.17it/s] 51%|██████████████████████████▎                         | 4927/9733 [00:29<00:27, 173.39it/s] 51%|██████████████████████████▍                         | 4945/9733 [00:29<00:27, 174.19it/s] 51%|██████████████████████████▌                         | 4963/9733 [00:29<00:27, 173.49it/s] 51%|██████████████████████████▌                         | 4981/9733 [00:29<00:27, 174.24it/s] 51%|██████████████████████████▋                         | 4999/9733 [00:29<00:27, 174.90it/s] 52%|██████████████████████████▊                         | 5017/9733 [00:29<00:26, 175.29it/s] 52%|██████████████████████████▉                         | 5035/9733 [00:29<00:26, 175.73it/s] 52%|██████████████████████████▉                         | 5053/9733 [00:29<00:26, 175.85it/s] 52%|███████████████████████████                         | 5071/9733 [00:29<00:26, 176.02it/s] 52%|███████████████████████████▏                        | 5089/9733 [00:29<00:26, 176.01it/s] 52%|███████████████████████████▎                        | 5107/9733 [00:30<00:26, 174.95it/s] 53%|███████████████████████████▍                        | 5125/9733 [00:30<00:26, 175.26it/s] 53%|███████████████████████████▍                        | 5143/9733 [00:30<00:26, 175.50it/s] 53%|███████████████████████████▌                        | 5161/9733 [00:30<00:26, 175.48it/s] 53%|███████████████████████████▋                        | 5179/9733 [00:30<00:26, 173.17it/s] 53%|███████████████████████████▊                        | 5197/9733 [00:30<00:26, 173.80it/s] 54%|███████████████████████████▊                        | 5215/9733 [00:30<00:25, 174.47it/s] 54%|███████████████████████████▉                        | 5233/9733 [00:30<00:25, 174.94it/s] 54%|████████████████████████████                        | 5251/9733 [00:30<00:25, 175.45it/s] 54%|████████████████████████████▏                       | 5269/9733 [00:31<00:25, 175.64it/s] 54%|████████████████████████████▏                       | 5287/9733 [00:31<00:25, 175.79it/s] 55%|████████████████████████████▎                       | 5305/9733 [00:31<00:25, 175.90it/s] 55%|████████████████████████████▍                       | 5323/9733 [00:31<00:25, 176.00it/s] 55%|████████████████████████████▌                       | 5341/9733 [00:31<00:24, 175.87it/s] 55%|████████████████████████████▋                       | 5359/9733 [00:31<00:24, 175.75it/s] 55%|████████████████████████████▋                       | 5377/9733 [00:31<00:25, 174.19it/s] 55%|████████████████████████████▊                       | 5395/9733 [00:31<00:24, 174.70it/s] 56%|████████████████████████████▉                       | 5413/9733 [00:31<00:24, 173.75it/s] 56%|█████████████████████████████                       | 5431/9733 [00:31<00:24, 174.36it/s] 56%|█████████████████████████████                       | 5449/9733 [00:32<00:24, 174.80it/s] 56%|█████████████████████████████▏                      | 5467/9733 [00:32<00:24, 174.80it/s] 56%|█████████████████████████████▎                      | 5485/9733 [00:32<00:24, 175.83it/s] 57%|█████████████████████████████▍                      | 5503/9733 [00:32<00:23, 176.85it/s] 57%|█████████████████████████████▍                      | 5521/9733 [00:32<00:23, 177.63it/s] 57%|█████████████████████████████▌                      | 5539/9733 [00:32<00:23, 178.20it/s] 57%|█████████████████████████████▋                      | 5558/9733 [00:32<00:23, 178.85it/s] 57%|█████████████████████████████▊                      | 5576/9733 [00:32<00:23, 179.12it/s] 57%|█████████████████████████████▉                      | 5594/9733 [00:32<00:23, 179.27it/s] 58%|█████████████████████████████▉                      | 5612/9733 [00:32<00:22, 179.33it/s] 58%|██████████████████████████████                      | 5630/9733 [00:33<00:23, 177.82it/s] 58%|██████████████████████████████▏                     | 5648/9733 [00:33<00:22, 178.30it/s] 58%|██████████████████████████████▎                     | 5666/9733 [00:33<00:22, 177.89it/s] 58%|██████████████████████████████▎                     | 5684/9733 [00:33<00:22, 178.47it/s] 59%|██████████████████████████████▍                     | 5703/9733 [00:33<00:22, 179.08it/s] 59%|██████████████████████████████▌                     | 5722/9733 [00:33<00:22, 179.51it/s] 59%|██████████████████████████████▋                     | 5741/9733 [00:33<00:22, 179.77it/s] 59%|██████████████████████████████▊                     | 5760/9733 [00:33<00:22, 179.86it/s] 59%|██████████████████████████████▉                     | 5779/9733 [00:33<00:21, 179.98it/s] 60%|██████████████████████████████▉                     | 5798/9733 [00:33<00:21, 180.05it/s] 60%|███████████████████████████████                     | 5817/9733 [00:34<00:21, 180.14it/s] 60%|███████████████████████████████▏                    | 5836/9733 [00:34<00:21, 180.10it/s] 60%|███████████████████████████████▎                    | 5855/9733 [00:34<00:21, 178.81it/s] 60%|███████████████████████████████▍                    | 5874/9733 [00:34<00:21, 179.36it/s] 61%|███████████████████████████████▍                    | 5892/9733 [00:34<00:21, 179.52it/s] 61%|███████████████████████████████▌                    | 5911/9733 [00:34<00:21, 179.75it/s] 61%|███████████████████████████████▋                    | 5929/9733 [00:34<00:21, 179.82it/s] 61%|███████████████████████████████▊                    | 5947/9733 [00:34<00:21, 179.85it/s] 61%|███████████████████████████████▊                    | 5966/9733 [00:34<00:20, 179.91it/s] 61%|███████████████████████████████▉                    | 5984/9733 [00:35<00:20, 179.84it/s] 62%|████████████████████████████████                    | 6002/9733 [00:35<00:20, 178.92it/s] 62%|████████████████████████████████▏                   | 6020/9733 [00:35<00:20, 179.18it/s] 62%|████████████████████████████████▎                   | 6039/9733 [00:35<00:20, 179.44it/s] 62%|████████████████████████████████▎                   | 6057/9733 [00:35<00:20, 179.60it/s] 62%|████████████████████████████████▍                   | 6075/9733 [00:35<00:20, 179.49it/s] 63%|████████████████████████████████▌                   | 6093/9733 [00:35<00:20, 178.01it/s] 63%|████████████████████████████████▋                   | 6111/9733 [00:35<00:20, 178.45it/s] 63%|████████████████████████████████▋                   | 6129/9733 [00:35<00:20, 178.73it/s] 63%|████████████████████████████████▊                   | 6147/9733 [00:35<00:20, 178.99it/s] 63%|████████████████████████████████▉                   | 6165/9733 [00:36<00:19, 179.23it/s] 64%|█████████████████████████████████                   | 6183/9733 [00:36<00:19, 179.41it/s] 64%|█████████████████████████████████▏                  | 6201/9733 [00:36<00:19, 179.54it/s] 64%|█████████████████████████████████▏                  | 6219/9733 [00:36<00:19, 179.50it/s] 64%|█████████████████████████████████▎                  | 6237/9733 [00:36<00:19, 179.39it/s] 64%|█████████████████████████████████▍                  | 6255/9733 [00:36<00:19, 179.41it/s] 64%|█████████████████████████████████▌                  | 6273/9733 [00:36<00:19, 179.56it/s] 65%|█████████████████████████████████▌                  | 6291/9733 [00:36<00:19, 179.67it/s] 65%|█████████████████████████████████▋                  | 6309/9733 [00:36<00:19, 178.15it/s] 65%|█████████████████████████████████▊                  | 6327/9733 [00:36<00:19, 178.42it/s] 65%|█████████████████████████████████▉                  | 6345/9733 [00:37<00:18, 178.82it/s] 65%|██████████████████████████████████                  | 6364/9733 [00:37<00:18, 179.22it/s] 66%|██████████████████████████████████                  | 6383/9733 [00:37<00:18, 179.59it/s] 66%|██████████████████████████████████▏                 | 6402/9733 [00:37<00:18, 179.85it/s] 66%|██████████████████████████████████▎                 | 6421/9733 [00:37<00:18, 180.04it/s] 66%|██████████████████████████████████▍                 | 6440/9733 [00:37<00:18, 180.15it/s] 66%|██████████████████████████████████▌                 | 6459/9733 [00:37<00:18, 180.01it/s] 67%|██████████████████████████████████▌                 | 6478/9733 [00:37<00:18, 180.11it/s] 67%|██████████████████████████████████▋                 | 6497/9733 [00:37<00:17, 180.11it/s] 67%|██████████████████████████████████▊                 | 6516/9733 [00:37<00:17, 179.70it/s] 67%|██████████████████████████████████▉                 | 6534/9733 [00:38<00:17, 178.25it/s] 67%|███████████████████████████████████                 | 6552/9733 [00:38<00:17, 178.61it/s] 68%|███████████████████████████████████                 | 6570/9733 [00:38<00:17, 178.90it/s] 68%|███████████████████████████████████▏                | 6588/9733 [00:38<00:17, 179.12it/s] 68%|███████████████████████████████████▎                | 6606/9733 [00:38<00:17, 179.32it/s] 68%|███████████████████████████████████▍                | 6625/9733 [00:38<00:17, 179.61it/s] 68%|███████████████████████████████████▍                | 6644/9733 [00:38<00:17, 179.77it/s] 68%|███████████████████████████████████▌                | 6663/9733 [00:38<00:17, 179.92it/s] 69%|███████████████████████████████████▋                | 6681/9733 [00:38<00:16, 179.66it/s] 69%|███████████████████████████████████▊                | 6699/9733 [00:39<00:16, 179.51it/s] 69%|███████████████████████████████████▉                | 6718/9733 [00:39<00:16, 179.74it/s] 69%|███████████████████████████████████▉                | 6736/9733 [00:39<00:16, 179.79it/s] 69%|████████████████████████████████████                | 6755/9733 [00:39<00:16, 179.87it/s] 70%|████████████████████████████████████▏               | 6773/9733 [00:39<00:16, 178.38it/s] 70%|████████████████████████████████████▎               | 6792/9733 [00:39<00:16, 178.89it/s] 70%|████████████████████████████████████▍               | 6811/9733 [00:39<00:16, 179.28it/s] 70%|████████████████████████████████████▍               | 6830/9733 [00:39<00:16, 179.50it/s] 70%|████████████████████████████████████▌               | 6848/9733 [00:39<00:16, 179.55it/s] 71%|████████████████████████████████████▋               | 6867/9733 [00:39<00:15, 179.73it/s] 71%|████████████████████████████████████▊               | 6885/9733 [00:40<00:15, 179.69it/s] 71%|████████████████████████████████████▉               | 6903/9733 [00:40<00:15, 179.77it/s] 71%|████████████████████████████████████▉               | 6922/9733 [00:40<00:15, 179.93it/s] 71%|█████████████████████████████████████               | 6941/9733 [00:40<00:15, 179.96it/s] 72%|█████████████████████████████████████▏              | 6960/9733 [00:40<00:15, 180.01it/s] 72%|█████████████████████████████████████▎              | 6979/9733 [00:40<00:15, 179.99it/s] 72%|█████████████████████████████████████▍              | 6997/9733 [00:40<00:15, 178.30it/s] 72%|█████████████████████████████████████▍              | 7015/9733 [00:40<00:15, 178.64it/s] 72%|█████████████████████████████████████▌              | 7034/9733 [00:40<00:15, 179.11it/s] 72%|█████████████████████████████████████▋              | 7053/9733 [00:40<00:14, 179.44it/s] 73%|█████████████████████████████████████▊              | 7071/9733 [00:41<00:14, 179.56it/s] 73%|█████████████████████████████████████▊              | 7089/9733 [00:41<00:14, 179.68it/s] 73%|█████████████████████████████████████▉              | 7108/9733 [00:41<00:14, 179.80it/s] 73%|██████████████████████████████████████              | 7127/9733 [00:41<00:14, 179.89it/s] 73%|██████████████████████████████████████▏             | 7146/9733 [00:41<00:14, 179.91it/s] 74%|██████████████████████████████████████▎             | 7164/9733 [00:41<00:14, 179.85it/s] 74%|██████████████████████████████████████▎             | 7182/9733 [00:41<00:14, 179.89it/s] 74%|██████████████████████████████████████▍             | 7201/9733 [00:41<00:14, 179.93it/s] 74%|██████████████████████████████████████▌             | 7219/9733 [00:41<00:14, 178.50it/s] 74%|██████████████████████████████████████▋             | 7238/9733 [00:42<00:13, 179.08it/s] 75%|██████████████████████████████████████▊             | 7257/9733 [00:42<00:13, 179.57it/s] 75%|██████████████████████████████████████▊             | 7276/9733 [00:42<00:13, 179.84it/s] 75%|██████████████████████████████████████▉             | 7295/9733 [00:42<00:13, 180.10it/s] 75%|███████████████████████████████████████             | 7314/9733 [00:42<00:13, 180.12it/s] 75%|███████████████████████████████████████▏            | 7333/9733 [00:42<00:13, 180.21it/s] 76%|███████████████████████████████████████▎            | 7352/9733 [00:42<00:13, 180.38it/s] 76%|███████████████████████████████████████▍            | 7371/9733 [00:42<00:13, 180.52it/s] 76%|███████████████████████████████████████▍            | 7390/9733 [00:42<00:12, 180.50it/s] 76%|███████████████████████████████████████▌            | 7409/9733 [00:42<00:12, 180.45it/s] 76%|███████████████████████████████████████▋            | 7428/9733 [00:43<00:12, 180.47it/s] 77%|███████████████████████████████████████▊            | 7447/9733 [00:43<00:14, 162.13it/s] 77%|███████████████████████████████████████▉            | 7465/9733 [00:43<00:13, 166.89it/s] 77%|███████████████████████████████████████▉            | 7483/9733 [00:43<00:13, 170.36it/s] 77%|████████████████████████████████████████            | 7501/9733 [00:43<00:12, 172.91it/s] 77%|████████████████████████████████████████▏           | 7519/9733 [00:43<00:12, 174.87it/s] 77%|████████████████████████████████████████▎           | 7537/9733 [00:43<00:12, 176.29it/s] 78%|████████████████████████████████████████▎           | 7555/9733 [00:43<00:12, 177.35it/s] 78%|████████████████████████████████████████▍           | 7574/9733 [00:43<00:12, 178.17it/s] 78%|████████████████████████████████████████▌           | 7592/9733 [00:44<00:11, 178.64it/s] 78%|████████████████████████████████████████▋           | 7611/9733 [00:44<00:11, 179.09it/s] 78%|████████████████████████████████████████▊           | 7629/9733 [00:44<00:11, 179.19it/s] 79%|████████████████████████████████████████▊           | 7647/9733 [00:44<00:11, 179.29it/s] 79%|████████████████████████████████████████▉           | 7665/9733 [00:44<00:11, 179.40it/s] 79%|█████████████████████████████████████████           | 7683/9733 [00:44<00:11, 177.74it/s] 79%|█████████████████████████████████████████▏          | 7702/9733 [00:44<00:11, 178.45it/s] 79%|█████████████████████████████████████████▎          | 7721/9733 [00:44<00:11, 178.99it/s] 80%|█████████████████████████████████████████▎          | 7740/9733 [00:44<00:11, 179.40it/s] 80%|█████████████████████████████████████████▍          | 7758/9733 [00:44<00:11, 179.50it/s] 80%|█████████████████████████████████████████▌          | 7776/9733 [00:45<00:10, 179.53it/s] 80%|█████████████████████████████████████████▋          | 7794/9733 [00:45<00:10, 179.66it/s] 80%|█████████████████████████████████████████▋          | 7812/9733 [00:45<00:10, 179.74it/s] 80%|█████████████████████████████████████████▊          | 7831/9733 [00:45<00:10, 179.88it/s] 81%|█████████████████████████████████████████▉          | 7850/9733 [00:45<00:10, 179.97it/s] 81%|██████████████████████████████████████████          | 7869/9733 [00:45<00:10, 180.12it/s] 81%|██████████████████████████████████████████▏         | 7888/9733 [00:45<00:10, 180.27it/s] 81%|██████████████████████████████████████████▏         | 7907/9733 [00:45<00:10, 179.16it/s] 81%|██████████████████████████████████████████▎         | 7926/9733 [00:45<00:10, 179.44it/s] 82%|██████████████████████████████████████████▍         | 7945/9733 [00:45<00:09, 179.70it/s] 82%|██████████████████████████████████████████▌         | 7964/9733 [00:46<00:09, 179.98it/s] 82%|██████████████████████████████████████████▋         | 7983/9733 [00:46<00:09, 180.09it/s] 82%|██████████████████████████████████████████▊         | 8002/9733 [00:46<00:09, 180.16it/s] 82%|██████████████████████████████████████████▊         | 8021/9733 [00:46<00:09, 180.13it/s] 83%|██████████████████████████████████████████▉         | 8040/9733 [00:46<00:09, 180.20it/s] 83%|███████████████████████████████████████████         | 8059/9733 [00:46<00:09, 180.23it/s] 83%|███████████████████████████████████████████▏        | 8078/9733 [00:46<00:09, 180.30it/s] 83%|███████████████████████████████████████████▎        | 8097/9733 [00:46<00:09, 180.46it/s] 83%|███████████████████████████████████████████▎        | 8116/9733 [00:46<00:08, 180.67it/s] 84%|███████████████████████████████████████████▍        | 8135/9733 [00:47<00:08, 179.33it/s] 84%|███████████████████████████████████████████▌        | 8154/9733 [00:47<00:08, 179.66it/s] 84%|███████████████████████████████████████████▋        | 8173/9733 [00:47<00:08, 179.84it/s] 84%|███████████████████████████████████████████▊        | 8192/9733 [00:47<00:08, 180.10it/s] 84%|███████████████████████████████████████████▊        | 8211/9733 [00:47<00:08, 180.19it/s] 85%|███████████████████████████████████████████▉        | 8230/9733 [00:47<00:08, 179.12it/s] 85%|████████████████████████████████████████████        | 8249/9733 [00:47<00:08, 179.60it/s] 85%|████████████████████████████████████████████▏       | 8268/9733 [00:47<00:08, 179.81it/s] 85%|████████████████████████████████████████████▎       | 8287/9733 [00:47<00:08, 179.90it/s] 85%|████████████████████████████████████████████▍       | 8306/9733 [00:47<00:07, 180.10it/s] 86%|████████████████████████████████████████████▍       | 8325/9733 [00:48<00:07, 180.29it/s] 86%|████████████████████████████████████████████▌       | 8344/9733 [00:48<00:07, 180.11it/s] 86%|████████████████████████████████████████████▋       | 8363/9733 [00:48<00:07, 178.81it/s] 86%|████████████████████████████████████████████▊       | 8382/9733 [00:48<00:07, 179.32it/s] 86%|████████████████████████████████████████████▉       | 8401/9733 [00:48<00:07, 179.70it/s] 87%|████████████████████████████████████████████▉       | 8420/9733 [00:48<00:07, 180.04it/s] 87%|█████████████████████████████████████████████       | 8439/9733 [00:48<00:07, 180.23it/s] 87%|█████████████████████████████████████████████▏      | 8458/9733 [00:48<00:07, 180.25it/s] 87%|█████████████████████████████████████████████▎      | 8477/9733 [00:48<00:06, 180.21it/s] 87%|█████████████████████████████████████████████▍      | 8496/9733 [00:49<00:06, 180.29it/s] 87%|█████████████████████████████████████████████▍      | 8515/9733 [00:49<00:06, 180.30it/s] 88%|█████████████████████████████████████████████▌      | 8534/9733 [00:49<00:06, 180.27it/s] 88%|█████████████████████████████████████████████▋      | 8553/9733 [00:49<00:06, 180.28it/s] 88%|█████████████████████████████████████████████▊      | 8572/9733 [00:49<00:06, 180.32it/s] 88%|█████████████████████████████████████████████▉      | 8591/9733 [00:49<00:06, 179.11it/s] 88%|██████████████████████████████████████████████      | 8610/9733 [00:49<00:06, 179.42it/s] 89%|██████████████████████████████████████████████      | 8629/9733 [00:49<00:06, 179.75it/s] 89%|██████████████████████████████████████████████▏     | 8648/9733 [00:49<00:06, 179.82it/s] 89%|██████████████████████████████████████████████▎     | 8666/9733 [00:49<00:05, 179.83it/s] 89%|██████████████████████████████████████████████▍     | 8684/9733 [00:50<00:05, 179.83it/s] 89%|██████████████████████████████████████████████▍     | 8703/9733 [00:50<00:05, 179.98it/s] 90%|██████████████████████████████████████████████▌     | 8722/9733 [00:50<00:05, 180.10it/s] 90%|██████████████████████████████████████████████▋     | 8741/9733 [00:50<00:05, 180.15it/s] 90%|██████████████████████████████████████████████▊     | 8760/9733 [00:50<00:05, 180.10it/s] 90%|██████████████████████████████████████████████▉     | 8779/9733 [00:50<00:05, 180.14it/s] 90%|███████████████████████████████████████████████     | 8798/9733 [00:50<00:05, 180.11it/s] 91%|███████████████████████████████████████████████     | 8817/9733 [00:50<00:05, 178.56it/s] 91%|███████████████████████████████████████████████▏    | 8836/9733 [00:50<00:05, 179.00it/s] 91%|███████████████████████████████████████████████▎    | 8855/9733 [00:51<00:04, 179.37it/s] 91%|███████████████████████████████████████████████▍    | 8874/9733 [00:51<00:04, 179.73it/s] 91%|███████████████████████████████████████████████▌    | 8893/9733 [00:51<00:04, 179.94it/s] 92%|███████████████████████████████████████████████▌    | 8912/9733 [00:51<00:04, 180.16it/s] 92%|███████████████████████████████████████████████▋    | 8931/9733 [00:51<00:04, 180.12it/s] 92%|███████████████████████████████████████████████▊    | 8950/9733 [00:51<00:04, 180.16it/s] 92%|███████████████████████████████████████████████▉    | 8969/9733 [00:51<00:04, 180.10it/s] 92%|████████████████████████████████████████████████    | 8988/9733 [00:51<00:04, 180.18it/s] 93%|████████████████████████████████████████████████    | 9007/9733 [00:51<00:04, 180.21it/s] 93%|████████████████████████████████████████████████▏   | 9026/9733 [00:51<00:03, 180.00it/s] 93%|████████████████████████████████████████████████▎   | 9044/9733 [00:52<00:03, 178.61it/s] 93%|████████████████████████████████████████████████▍   | 9063/9733 [00:52<00:03, 179.19it/s] 93%|████████████████████████████████████████████████▌   | 9082/9733 [00:52<00:03, 179.47it/s] 94%|████████████████████████████████████████████████▌   | 9101/9733 [00:52<00:03, 179.76it/s] 94%|████████████████████████████████████████████████▋   | 9119/9733 [00:52<00:03, 179.81it/s] 94%|████████████████████████████████████████████████▊   | 9138/9733 [00:52<00:03, 179.99it/s] 94%|████████████████████████████████████████████████▉   | 9157/9733 [00:52<00:03, 180.01it/s] 94%|█████████████████████████████████████████████████   | 9176/9733 [00:52<00:03, 180.18it/s] 94%|█████████████████████████████████████████████████▏  | 9195/9733 [00:52<00:02, 180.25it/s] 95%|█████████████████████████████████████████████████▏  | 9214/9733 [00:53<00:02, 180.21it/s] 95%|█████████████████████████████████████████████████▎  | 9233/9733 [00:53<00:02, 180.27it/s] 95%|█████████████████████████████████████████████████▍  | 9252/9733 [00:53<00:02, 180.26it/s] 95%|█████████████████████████████████████████████████▌  | 9271/9733 [00:53<00:02, 178.69it/s] 95%|█████████████████████████████████████████████████▋  | 9290/9733 [00:53<00:02, 179.16it/s] 96%|█████████████████████████████████████████████████▋  | 9309/9733 [00:53<00:02, 179.55it/s] 96%|█████████████████████████████████████████████████▊  | 9328/9733 [00:53<00:02, 179.85it/s] 96%|█████████████████████████████████████████████████▉  | 9347/9733 [00:53<00:02, 179.93it/s] 96%|██████████████████████████████████████████████████  | 9365/9733 [00:53<00:02, 179.51it/s] 96%|██████████████████████████████████████████████████▏ | 9384/9733 [00:53<00:01, 179.70it/s] 97%|██████████████████████████████████████████████████▏ | 9403/9733 [00:54<00:01, 179.77it/s] 97%|██████████████████████████████████████████████████▎ | 9422/9733 [00:54<00:01, 179.90it/s] 97%|██████████████████████████████████████████████████▍ | 9440/9733 [00:54<00:01, 179.92it/s] 97%|██████████████████████████████████████████████████▌ | 9459/9733 [00:54<00:01, 180.04it/s] 97%|██████████████████████████████████████████████████▋ | 9478/9733 [00:54<00:01, 180.11it/s] 98%|██████████████████████████████████████████████████▋ | 9497/9733 [00:54<00:01, 178.63it/s] 98%|██████████████████████████████████████████████████▊ | 9516/9733 [00:54<00:01, 179.10it/s] 98%|██████████████████████████████████████████████████▉ | 9534/9733 [00:54<00:01, 179.28it/s] 98%|███████████████████████████████████████████████████ | 9552/9733 [00:54<00:01, 179.40it/s] 98%|███████████████████████████████████████████████████▏| 9570/9733 [00:55<00:00, 179.56it/s] 99%|███████████████████████████████████████████████████▏| 9588/9733 [00:55<00:00, 179.62it/s] 99%|███████████████████████████████████████████████████▎| 9607/9733 [00:55<00:00, 179.74it/s] 99%|███████████████████████████████████████████████████▍| 9625/9733 [00:55<00:00, 179.79it/s] 99%|███████████████████████████████████████████████████▌| 9643/9733 [00:55<00:00, 179.70it/s] 99%|███████████████████████████████████████████████████▌| 9662/9733 [00:55<00:00, 179.93it/s] 99%|███████████████████████████████████████████████████▋| 9681/9733 [00:55<00:00, 179.93it/s]100%|███████████████████████████████████████████████████▊| 9699/9733 [00:55<00:00, 178.53it/s]100%|███████████████████████████████████████████████████▉| 9717/9733 [00:55<00:00, 175.91it/s]100%|████████████████████████████████████████████████████| 9733/9733 [00:55<00:00, 174.01it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:04<00:09,  4.88s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:04<00:09,  4.97s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.42s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.37s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:09<00:04,  4.94s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.08s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.45s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.38s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.41s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.55s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.48s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.63s/it]
[2023-08-21 15:51:09,017] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.80s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.98s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.74s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.91s/it]
[2023-08-21 15:51:18,160] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-21 15:51:18,162] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-21 15:51:18,162] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-21 15:51:18,162] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-21 15:51:18,162] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-21 15:51:18,162] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-21 15:51:18,163] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-21 15:51:18,163] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-21 15:51:18,163] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-21 15:51:18,163] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-21 15:51:18,163] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-21 15:51:18,163] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f530e796fd0>
[2023-08-21 15:51:18,163] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-21 15:51:18,163] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-21 15:51:18,163] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-21 15:51:18,163] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-21 15:51:18,163] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-21 15:51:18,164] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f52da2e1cd0>
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-21 15:51:18,165] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-21 15:51:18,166] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.573643684387207 seconds
torch.Size([5, 2048])
torch.Size([5, 8])
torch.Size([5, 2055])
Loading extension module utils...
Time to load utils op: 0.40465211868286133 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: 1. The question is asking where you would find plumbing that would not be helpful if you were thirsty, meaning the plumbing would not provide drinkable water. 
2. Choice B - a wall wouldn't typically have any plumbing, so that choice doesn't make sense. 
3. Choice C - is not specific enough, as it doesn't even refer to a place, thus it can be eliminated.
4. Choice D - own home would likely have drinkable water, so that option doesn't make sense either.
5. Choice E - a water fountain is specifically designed to provide drinkable water, so this can't be the correct answer.
6. That leaves us with choice A - an oil refinery. This is a place where plumbing is used, but the pipelines carry oil, not water.
7. So, the correct response is A: oil refineries. This is a place where you could find plumbing (in the form of oil pipelines) but drinking the oil from these pipes when you're thirsty isn't possible or safe.
So the final answer is A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Output: 1. The question asks "What aren't they doing yet when a person is beginning work?"
2. Let's analyze each of the choices:

   - A: Working - incorrect, since the person is beginning work, so they are doing this.
 
   - B: Resting - incorrect, it's not related to starting work. One can rest before or after work.
   
   - C: Tiredness - incorrect, tiredness is a state and not an action. Plus it could happen during or after work.
   
   - D: Accomplishing - correct, as this is something which hasn't happened yet when a person is beginning to work. It's the result of completed work.
   
   - E: Momentum - incorrect, momentum implies motion or progress which can be a part of work process but not an outcome.

3. Therefore, the answer is D: Accomplishing.
So the final answer is D: accomplishing

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Output: 1. The question is asking where one might find pens with a company logo.
2. A company logo is typically seen on company property or items that represent a certain company. 
3. Option B: On a pencil is incorrect because pencils and pens are two different types of stationery and they are not a place to find anything.
4. Option C: Write sentences on paper is not a place, rather it's a process you could do with a pen.
5. Option D: School is plausible; however, pens with company logos are less likely to be found in Schools as schools typically use generic or school-branded pens.
6. Option E: Backpack can be a possible place but it doesn't directly imply the presence of company logo pens.
7. Option A: Is an office, typically, companies will have pens with their logo in their office for employees, visitors, or clients to use. This makes it the most probable place to find pens with a company logo.
8. Therefore, the answer is A: office.
So the final answer is A: office

Input: Billy called out to John, and listened for what? Choices:  A: silence B: response C: communication D: hanging up E: whisper
Output: 1. The question provides a scenario in which Billy is calling out to John.
2. The key here is to understand what Billy is expecting after he calls out.
3. When we call out to someone, it's generally implied that we are expecting an answer or a'response' from them. This is an interpretation based on common social conventions.
4. Checking the given options for what goes with this scenario, "response" seems to fit the context most appropriately as it signifies something in return to Billy's call out.
5. Option A, silence, would mean that Billy is expecting no return. This doesn't typically fit the context when someone calls out.
6. Option C, communication, although not entirely incorrect, it's important to note that the communication has already begun when Billy called out. He's now waiting for John's part.
7. Option D, hanging up, and option E, whisper, don't apply to the situation described, as they are more suited to phone call scenarios or situations requiring secrecy respectively.
8. Based on these reasonings, the most appropriate answer would be B: response.
So the final answer is B: response

Input: The lizard frightened the hiker, it's movements made what rustle? Choices:  A: garden B: trees C: books D: rocks E: bushes
Output: 1. The question is asking us to identify what a lizard, in its movement, would make rustle that could frighten a hiker.
2. We can eliminate choice A: garden, as it's too broad; a lizard can't make an entire garden rustle.
3. We also eliminate option C: books because typically, lizards and hikers would not be interacting in a place where books are present.
4. Consider choice D: rocks. Rocks do not rustle, hence it can't be the correct answer.
5. Looking at choice B: trees, this could be a plausible answer. However, lizards contain mostly ground-dwelling species and are likely too small and light to create a rustling sound in a tree.
6. We're left with choice E: bushes. Bushes could reasonably rustle with the movement of a lizard, especially if it was moving quickly.
7. Therefore, the most fitting answer is E: bushes.
So the final answer is E: bushes

Input: The man spent big money and time maintaining his lawn, it was part of keeping up with the Joneses where? Choices:  A: front yard B: suburbia C: neighborhood D: back yard E: golf course
Output: 1. The phrase "keeping up with the Joneses" is a figure of speech that originates from the suburbs. 
2. It is used to describe the phenomenon of using your neighbors as a standard for comparison and always trying to outdo or compete with them, especially in terms of material possessions. 
3. The context clues that help us in solving this question are "man spent big money and time maintaining his lawn" and "keeping up with the Joneses"; both are quite relevant to the suburban lifestyle and competition. 
4. Although options C 'neighborhood' and A 'front yard' might seem plausible, they could apply to urban or rural environments as well, not exclusively to suburban ones, therefore making them too broad. 
5. Option D 'back yard' doesn't accurately reflect the competition aspect of the expression as backyards are typically private venture, and E 'golf course' is not relevant to the scenario described. 
6. Therefore, the answer that best fits the question is B:'suburbia'.
So the final answer is B: suburbia

Input: What would a human do if they want to get to a store that he or she can see? Choices:  A: cross road B: see around C: drink coffee D: dream dreams E: think critically
Output: 1. The objective is for the person to reach a store he or she can already see.
2. Getting to the store involves some form of movement or action on the person's part.
3. Looking at the given choices, options B: see around, C: drink coffee, D: dream dreams, and E: think critically do not involve immediate physical movement towards the store.
4. The only choice that involves the person physically moving towards the store is A: cross road.
5. Therefore, the answer is A: cross road.
So the final answer is A: cross road

Input: Where would you grab an object contained by a doorway? Choices:  A: television B: control panel C: opening doors D: doorknob E: doorway
Output: 1. The question asks where you would grab an object contained by a doorway. 
2. This word 'contained by' implies that the object must be within the structure of the doorway instead of being an independent object that could be located elsewhere.
3. While a television (A), control panel (B), opening doors (C
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i8-s1-rTrue
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
Loading extension module utils...
Time to load utils op: 0.6050422191619873 seconds
Loading extension module utils...
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
Time to load utils op: 0.504812479019165 seconds
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 8])
torch.Size([5, 2055])
torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:41<34:10, 41.85s/it]torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:22<33:01, 41.29s/it]torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 8])
torch.Size([5, 2055])
torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
Evaluating commonsenseqa :   6%|█▊                             | 3/50 [02:03<32:12, 41.11s/it]torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
Evaluating commonsenseqa :   8%|██▍                            | 4/50 [02:44<31:28, 41.05s/it]torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
Evaluating commonsenseqa :  10%|███                            | 5/50 [03:25<30:48, 41.07s/it]torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
Evaluating commonsenseqa :  12%|███▋                           | 6/50 [04:06<30:07, 41.08s/it]torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
Evaluating commonsenseqa :  14%|████▎                          | 7/50 [04:41<28:02, 39.13s/it]torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 8])
torch.Size([5, 2055])
Evaluating commonsenseqa :  16%|████▉                          | 8/50 [05:23<27:50, 39.76s/it]torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [06:04<27:28, 40.20s/it]torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 8])
torch.Size([5, 2055])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
Evaluating commonsenseqa :  20%|██████                        | 10/50 [06:45<26:57, 40.45s/it]torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [07:26<26:26, 40.69s/it]torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [08:07<25:49, 40.78s/it]torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 8])
torch.Size([5, 2055])
torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [08:48<25:12, 40.87s/it]torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [09:29<24:34, 40.95s/it]torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
Evaluating commonsenseqa :  30%|█████████                     | 15/50 [10:10<23:52, 40.93s/it]torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [10:51<23:13, 40.98s/it]torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [11:32<22:31, 40.96s/it]torch.Size([5, 2048])
torch.Size([5, 8])
torch.Size([5, 2055])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 8])
torch.Size([5, 2055])
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [12:13<21:50, 40.97s/it]torch.Size([5, 2048])
torch.Size([5, 9])
torch.Size([5, 2056])
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [12:54<21:09, 40.95s/it]torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
torch.Size([5, 2048])
torch.Size([5, 8])
torch.Size([5, 2055])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
Evaluating commonsenseqa :  40%|████████████                  | 20/50 [13:35<20:30, 41.00s/it]torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [14:16<19:48, 40.99s/it]torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [14:57<19:06, 40.96s/it]torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [15:38<18:26, 40.97s/it]torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 9])
torch.Size([5, 2056])
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [16:19<17:45, 40.98s/it]torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
Evaluating commonsenseqa :  50%|███████████████               | 25/50 [17:00<17:06, 41.05s/it]torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [17:41<16:24, 41.01s/it]torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [18:22<15:44, 41.06s/it]torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [19:03<15:03, 41.06s/it]torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [19:44<14:22, 41.07s/it]torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [20:25<13:41, 41.09s/it]torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [21:07<13:01, 41.14s/it]torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [21:48<12:20, 41.13s/it]torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [22:29<11:38, 41.10s/it]torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [23:10<10:59, 41.23s/it]torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 8])
torch.Size([5, 2055])
torch.Size([5, 2048])
torch.Size([5, 8])
torch.Size([5, 2055])
Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [23:51<10:16, 41.12s/it]torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [24:32<09:35, 41.08s/it]torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [25:13<08:53, 41.07s/it]torch.Size([5, 2048])
torch.Size([5, 8])
torch.Size([5, 2055])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [25:54<08:12, 41.02s/it]torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [26:35<07:30, 40.99s/it]torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [27:16<06:49, 40.99s/it]torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [27:57<06:08, 40.96s/it]torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [28:38<05:27, 41.00s/it]torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [29:19<04:46, 40.98s/it]torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [30:00<04:05, 40.99s/it]torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [30:41<03:24, 40.98s/it]torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 9])
torch.Size([5, 2056])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [31:22<02:43, 40.95s/it]torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [32:03<02:03, 41.01s/it]torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [32:44<01:22, 41.00s/it]torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [33:25<00:41, 41.02s/it]torch.Size([5, 2048])
torch.Size([5, 5])
torch.Size([5, 2052])
torch.Size([5, 2048])
torch.Size([5, 7])
torch.Size([5, 2054])
torch.Size([5, 2048])
torch.Size([5, 6])
torch.Size([5, 2053])
Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [34:06<00:00, 41.05s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [34:06<00:00, 40.93s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 0.9344} | lm_loss 12.1214 | avg. gen lenth: 393.42
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i9-s1-rTrue --seed 1 --max-prompt-length 2048 --rationales --num-in-domain 9
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-21 16:25:34,817] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i9-s1-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 9
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i9-s1-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9732 [00:00<?, ?it/s]  0%|                                                       | 10/9732 [00:00<01:41, 95.59it/s]  0%|                                                       | 20/9732 [00:00<01:40, 96.19it/s]  0%|▏                                                      | 30/9732 [00:00<01:40, 96.10it/s]  0%|▏                                                      | 40/9732 [00:00<01:40, 96.16it/s]  1%|▎                                                      | 50/9732 [00:00<01:40, 96.28it/s]  1%|▎                                                      | 60/9732 [00:00<01:41, 95.16it/s]  1%|▍                                                      | 70/9732 [00:00<01:41, 95.53it/s]  1%|▍                                                      | 80/9732 [00:00<01:40, 95.80it/s]  1%|▌                                                      | 90/9732 [00:00<01:40, 95.85it/s]  1%|▌                                                     | 100/9732 [00:01<01:40, 96.08it/s]  1%|▌                                                     | 110/9732 [00:01<01:40, 95.90it/s]  1%|▋                                                     | 120/9732 [00:01<01:40, 95.68it/s]  1%|▋                                                     | 130/9732 [00:01<01:40, 95.91it/s]  1%|▊                                                     | 140/9732 [00:01<01:39, 96.06it/s]  2%|▊                                                     | 150/9732 [00:01<01:40, 95.10it/s]  2%|▉                                                     | 160/9732 [00:01<01:40, 95.46it/s]  2%|▉                                                     | 170/9732 [00:01<01:39, 95.72it/s]  2%|█                                                    | 185/9732 [00:01<01:26, 110.55it/s]  2%|█                                                    | 200/9732 [00:01<01:18, 121.40it/s]  2%|█▏                                                   | 214/9732 [00:02<01:15, 126.58it/s]  2%|█▏                                                   | 229/9732 [00:02<01:11, 132.81it/s]  3%|█▎                                                   | 244/9732 [00:02<01:09, 137.15it/s]  3%|█▍                                                   | 259/9732 [00:02<01:07, 140.22it/s]  3%|█▍                                                   | 274/9732 [00:02<01:06, 142.17it/s]  3%|█▌                                                   | 289/9732 [00:02<01:05, 143.57it/s]  3%|█▋                                                   | 304/9732 [00:02<01:05, 144.75it/s]  3%|█▋                                                   | 319/9732 [00:02<01:04, 145.38it/s]  3%|█▊                                                   | 334/9732 [00:02<01:04, 146.06it/s]  4%|█▉                                                   | 349/9732 [00:02<01:04, 146.52it/s]  4%|█▉                                                   | 364/9732 [00:03<01:03, 146.79it/s]  4%|██                                                   | 379/9732 [00:03<01:03, 147.07it/s]  4%|██▏                                                  | 394/9732 [00:03<01:03, 147.18it/s]  4%|██▏                                                  | 409/9732 [00:03<01:03, 147.20it/s]  4%|██▎                                                  | 424/9732 [00:03<01:03, 147.18it/s]  5%|██▍                                                  | 439/9732 [00:03<01:03, 145.81it/s]  5%|██▍                                                  | 454/9732 [00:03<01:03, 146.41it/s]  5%|██▌                                                  | 469/9732 [00:03<01:03, 146.60it/s]  5%|██▋                                                  | 484/9732 [00:03<01:03, 146.52it/s]  5%|██▋                                                  | 499/9732 [00:04<01:02, 146.64it/s]  5%|██▊                                                  | 514/9732 [00:04<01:02, 146.64it/s]  5%|██▉                                                  | 529/9732 [00:04<01:02, 146.85it/s]  6%|██▉                                                  | 544/9732 [00:04<01:02, 147.08it/s]  6%|███                                                  | 559/9732 [00:04<01:02, 146.77it/s]  6%|███▏                                                 | 574/9732 [00:04<01:02, 146.05it/s]  6%|███▏                                                 | 589/9732 [00:04<01:02, 146.44it/s]  6%|███▎                                                 | 604/9732 [00:04<01:02, 146.72it/s]  6%|███▎                                                 | 619/9732 [00:04<01:02, 146.65it/s]  7%|███▍                                                 | 634/9732 [00:04<01:01, 146.86it/s]  7%|███▌                                                 | 649/9732 [00:05<01:01, 146.80it/s]  7%|███▌                                                 | 664/9732 [00:05<01:02, 145.50it/s]  7%|███▋                                                 | 679/9732 [00:05<01:02, 145.00it/s]  7%|███▊                                                 | 694/9732 [00:05<01:02, 145.66it/s]  7%|███▊                                                 | 709/9732 [00:05<01:01, 145.96it/s]  7%|███▉                                                 | 724/9732 [00:05<01:01, 146.36it/s]  8%|████                                                 | 739/9732 [00:05<01:01, 146.67it/s]  8%|████                                                 | 754/9732 [00:05<01:01, 147.07it/s]  8%|████▏                                                | 769/9732 [00:05<01:00, 147.33it/s]  8%|████▎                                                | 784/9732 [00:05<01:00, 147.47it/s]  8%|████▎                                                | 799/9732 [00:06<01:00, 147.47it/s]  8%|████▍                                                | 814/9732 [00:06<01:00, 147.45it/s]  9%|████▌                                                | 829/9732 [00:06<01:00, 147.46it/s]  9%|████▌                                                | 844/9732 [00:06<01:00, 147.44it/s]  9%|████▋                                                | 859/9732 [00:06<01:00, 147.09it/s]  9%|████▊                                                | 874/9732 [00:06<01:00, 145.60it/s]  9%|████▊                                                | 889/9732 [00:06<01:01, 143.25it/s]  9%|████▉                                                | 904/9732 [00:06<01:01, 144.16it/s]  9%|█████                                                | 919/9732 [00:06<01:00, 144.64it/s] 10%|█████                                                | 934/9732 [00:06<01:00, 145.41it/s] 10%|█████▏                                               | 949/9732 [00:07<01:00, 146.04it/s] 10%|█████▏                                               | 964/9732 [00:07<00:59, 146.32it/s] 10%|█████▎                                               | 979/9732 [00:07<00:59, 146.59it/s] 10%|█████▍                                               | 994/9732 [00:07<00:59, 146.78it/s] 10%|█████▍                                              | 1009/9732 [00:07<00:59, 146.87it/s] 11%|█████▍                                              | 1024/9732 [00:07<00:59, 147.05it/s] 11%|█████▌                                              | 1039/9732 [00:07<00:59, 146.97it/s] 11%|█████▋                                              | 1054/9732 [00:07<00:59, 146.98it/s] 11%|█████▋                                              | 1069/9732 [00:07<00:58, 147.09it/s] 11%|█████▊                                              | 1084/9732 [00:08<00:58, 147.22it/s] 11%|█████▊                                              | 1099/9732 [00:08<00:58, 147.29it/s] 11%|█████▉                                              | 1114/9732 [00:08<00:59, 145.78it/s] 12%|██████                                              | 1129/9732 [00:08<00:58, 146.21it/s] 12%|██████                                              | 1144/9732 [00:08<00:58, 146.48it/s] 12%|██████▏                                             | 1159/9732 [00:08<00:58, 146.42it/s] 12%|██████▎                                             | 1174/9732 [00:08<00:58, 146.26it/s] 12%|██████▎                                             | 1189/9732 [00:08<00:58, 146.02it/s] 12%|██████▍                                             | 1204/9732 [00:08<00:58, 145.95it/s] 13%|██████▌                                             | 1219/9732 [00:08<00:58, 146.18it/s] 13%|██████▌                                             | 1234/9732 [00:09<00:58, 146.36it/s] 13%|██████▋                                             | 1249/9732 [00:09<00:57, 146.51it/s] 13%|██████▊                                             | 1264/9732 [00:09<00:57, 146.44it/s] 13%|██████▊                                             | 1279/9732 [00:09<00:57, 146.36it/s] 13%|██████▉                                             | 1294/9732 [00:09<00:57, 146.56it/s] 13%|██████▉                                             | 1309/9732 [00:09<00:57, 146.51it/s] 14%|███████                                             | 1324/9732 [00:09<00:57, 146.52it/s] 14%|███████▏                                            | 1339/9732 [00:09<00:57, 145.01it/s] 14%|███████▏                                            | 1354/9732 [00:09<00:57, 145.05it/s] 14%|███████▎                                            | 1369/9732 [00:09<00:57, 145.72it/s] 14%|███████▍                                            | 1384/9732 [00:10<00:57, 145.66it/s] 14%|███████▍                                            | 1399/9732 [00:10<00:57, 145.36it/s] 15%|███████▌                                            | 1414/9732 [00:10<00:57, 145.75it/s] 15%|███████▋                                            | 1429/9732 [00:10<00:56, 146.19it/s] 15%|███████▋                                            | 1444/9732 [00:10<00:56, 146.52it/s] 15%|███████▊                                            | 1459/9732 [00:10<00:56, 146.82it/s] 15%|███████▉                                            | 1474/9732 [00:10<00:56, 146.97it/s] 15%|███████▉                                            | 1489/9732 [00:10<00:56, 146.92it/s] 15%|████████                                            | 1504/9732 [00:10<00:56, 146.80it/s] 16%|████████                                            | 1519/9732 [00:10<00:55, 146.96it/s] 16%|████████▏                                           | 1534/9732 [00:11<00:55, 147.10it/s] 16%|████████▎                                           | 1549/9732 [00:11<00:55, 147.21it/s] 16%|████████▎                                           | 1564/9732 [00:11<00:56, 145.80it/s] 16%|████████▍                                           | 1579/9732 [00:11<00:55, 146.06it/s] 16%|████████▌                                           | 1594/9732 [00:11<00:55, 146.08it/s] 17%|████████▌                                           | 1609/9732 [00:11<00:55, 146.04it/s] 17%|████████▋                                           | 1624/9732 [00:11<00:55, 146.11it/s] 17%|████████▊                                           | 1639/9732 [00:11<00:55, 146.21it/s] 17%|████████▊                                           | 1654/9732 [00:11<00:55, 146.32it/s] 17%|████████▉                                           | 1669/9732 [00:12<00:55, 146.38it/s] 17%|████████▉                                           | 1684/9732 [00:12<00:55, 146.32it/s] 17%|█████████                                           | 1699/9732 [00:12<00:54, 146.36it/s] 18%|█████████▏                                          | 1714/9732 [00:12<00:54, 146.25it/s] 18%|█████████▏                                          | 1729/9732 [00:12<00:54, 146.17it/s] 18%|█████████▎                                          | 1744/9732 [00:12<00:54, 145.89it/s] 18%|█████████▍                                          | 1759/9732 [00:12<00:54, 146.03it/s] 18%|█████████▍                                          | 1774/9732 [00:12<00:54, 146.36it/s] 18%|█████████▌                                          | 1789/9732 [00:12<00:54, 146.55it/s] 19%|█████████▋                                          | 1804/9732 [00:12<01:00, 131.09it/s] 19%|█████████▋                                          | 1819/9732 [00:13<00:58, 135.54it/s] 19%|█████████▊                                          | 1834/9732 [00:13<00:56, 138.64it/s] 19%|█████████▉                                          | 1849/9732 [00:13<00:55, 141.05it/s] 19%|█████████▉                                          | 1864/9732 [00:13<00:55, 142.70it/s] 19%|██████████                                          | 1879/9732 [00:13<00:54, 143.84it/s] 19%|██████████                                          | 1894/9732 [00:13<00:54, 144.54it/s] 20%|██████████▏                                         | 1909/9732 [00:13<00:53, 145.28it/s] 20%|██████████▎                                         | 1924/9732 [00:13<00:53, 145.58it/s] 20%|██████████▎                                         | 1939/9732 [00:13<00:53, 146.06it/s] 20%|██████████▍                                         | 1954/9732 [00:13<00:53, 146.38it/s] 20%|██████████▌                                         | 1969/9732 [00:14<00:52, 146.53it/s] 20%|██████████▌                                         | 1984/9732 [00:14<00:52, 146.53it/s] 21%|██████████▋                                         | 1999/9732 [00:14<00:52, 146.86it/s] 21%|██████████▊                                         | 2014/9732 [00:14<00:52, 147.01it/s] 21%|██████████▊                                         | 2029/9732 [00:14<00:52, 145.47it/s] 21%|██████████▉                                         | 2044/9732 [00:14<00:52, 145.80it/s] 21%|███████████                                         | 2059/9732 [00:14<00:52, 145.98it/s] 21%|███████████                                         | 2074/9732 [00:14<00:52, 146.06it/s] 21%|███████████▏                                        | 2089/9732 [00:14<00:52, 145.93it/s] 22%|███████████▏                                        | 2104/9732 [00:15<00:52, 146.11it/s] 22%|███████████▎                                        | 2119/9732 [00:15<00:52, 146.34it/s] 22%|███████████▍                                        | 2134/9732 [00:15<00:51, 146.53it/s] 22%|███████████▍                                        | 2149/9732 [00:15<00:51, 145.92it/s] 22%|███████████▌                                        | 2164/9732 [00:15<00:51, 145.56it/s] 22%|███████████▋                                        | 2179/9732 [00:15<00:51, 146.06it/s] 23%|███████████▋                                        | 2194/9732 [00:15<00:51, 146.36it/s] 23%|███████████▊                                        | 2209/9732 [00:15<00:51, 146.33it/s] 23%|███████████▉                                        | 2224/9732 [00:15<00:51, 146.57it/s] 23%|███████████▉                                        | 2239/9732 [00:15<00:51, 146.03it/s] 23%|████████████                                        | 2254/9732 [00:16<00:51, 144.82it/s] 23%|████████████                                        | 2269/9732 [00:16<00:51, 145.58it/s] 23%|████████████▏                                       | 2284/9732 [00:16<00:50, 146.11it/s] 24%|████████████▎                                       | 2299/9732 [00:16<00:50, 146.39it/s] 24%|████████████▎                                       | 2314/9732 [00:16<00:50, 146.15it/s] 24%|████████████▍                                       | 2329/9732 [00:16<00:50, 146.43it/s] 24%|████████████▌                                       | 2344/9732 [00:16<00:50, 146.82it/s] 24%|████████████▌                                       | 2359/9732 [00:16<00:50, 147.10it/s] 24%|████████████▋                                       | 2374/9732 [00:16<00:50, 147.09it/s] 25%|████████████▊                                       | 2389/9732 [00:16<00:49, 147.17it/s] 25%|████████████▊                                       | 2404/9732 [00:17<00:49, 147.29it/s] 25%|████████████▉                                       | 2419/9732 [00:17<00:49, 146.88it/s] 25%|█████████████                                       | 2434/9732 [00:17<00:49, 146.39it/s] 25%|█████████████                                       | 2449/9732 [00:17<00:49, 146.54it/s] 25%|█████████████▏                                      | 2464/9732 [00:17<00:49, 146.77it/s] 25%|█████████████▏                                      | 2479/9732 [00:17<00:50, 144.00it/s] 26%|█████████████▎                                      | 2494/9732 [00:17<00:49, 144.88it/s] 26%|█████████████▍                                      | 2509/9732 [00:17<00:49, 145.59it/s] 26%|█████████████▍                                      | 2524/9732 [00:17<00:49, 145.88it/s] 26%|█████████████▌                                      | 2539/9732 [00:18<00:49, 145.79it/s] 26%|█████████████▋                                      | 2554/9732 [00:18<00:49, 145.98it/s] 26%|█████████████▋                                      | 2569/9732 [00:18<00:48, 146.43it/s] 27%|█████████████▊                                      | 2584/9732 [00:18<00:48, 146.67it/s] 27%|█████████████▉                                      | 2599/9732 [00:18<00:48, 146.84it/s] 27%|█████████████▉                                      | 2614/9732 [00:18<00:48, 146.94it/s] 27%|██████████████                                      | 2629/9732 [00:18<00:48, 146.72it/s] 27%|██████████████▏                                     | 2644/9732 [00:18<00:48, 146.70it/s] 27%|██████████████▏                                     | 2659/9732 [00:18<00:48, 146.63it/s] 27%|██████████████▎                                     | 2674/9732 [00:18<00:48, 146.71it/s] 28%|██████████████▎                                     | 2689/9732 [00:19<00:48, 146.62it/s] 28%|██████████████▍                                     | 2704/9732 [00:19<00:48, 145.01it/s] 28%|██████████████▌                                     | 2719/9732 [00:19<00:48, 145.09it/s] 28%|██████████████▌                                     | 2734/9732 [00:19<00:48, 144.34it/s] 28%|██████████████▋                                     | 2749/9732 [00:19<00:48, 145.24it/s] 28%|██████████████▊                                     | 2764/9732 [00:19<00:47, 145.66it/s] 29%|██████████████▊                                     | 2779/9732 [00:19<00:47, 146.08it/s] 29%|██████████████▉                                     | 2794/9732 [00:19<00:47, 146.33it/s] 29%|███████████████                                     | 2809/9732 [00:19<00:47, 146.41it/s] 29%|███████████████                                     | 2824/9732 [00:19<00:47, 146.63it/s] 29%|███████████████▏                                    | 2839/9732 [00:20<00:46, 146.72it/s] 29%|███████████████▏                                    | 2854/9732 [00:20<00:46, 146.83it/s] 29%|███████████████▎                                    | 2869/9732 [00:20<00:46, 146.99it/s] 30%|███████████████▍                                    | 2884/9732 [00:20<00:46, 146.60it/s] 30%|███████████████▍                                    | 2899/9732 [00:20<00:46, 146.39it/s] 30%|███████████████▌                                    | 2914/9732 [00:20<00:46, 146.51it/s] 30%|███████████████▋                                    | 2929/9732 [00:20<00:46, 145.10it/s] 30%|███████████████▋                                    | 2944/9732 [00:20<00:46, 145.65it/s] 30%|███████████████▊                                    | 2959/9732 [00:20<00:46, 145.95it/s] 31%|███████████████▉                                    | 2974/9732 [00:20<00:46, 146.11it/s] 31%|███████████████▉                                    | 2989/9732 [00:21<00:46, 145.27it/s] 31%|████████████████                                    | 3004/9732 [00:21<00:46, 145.85it/s] 31%|████████████████▏                                   | 3019/9732 [00:21<00:45, 146.12it/s] 31%|████████████████▏                                   | 3034/9732 [00:21<00:45, 146.23it/s] 31%|████████████████▎                                   | 3049/9732 [00:21<00:45, 146.34it/s] 31%|████████████████▎                                   | 3064/9732 [00:21<00:45, 146.48it/s] 32%|████████████████▍                                   | 3079/9732 [00:21<00:45, 146.64it/s] 32%|████████████████▌                                   | 3094/9732 [00:21<00:45, 146.61it/s] 32%|████████████████▌                                   | 3109/9732 [00:21<00:45, 146.70it/s] 32%|████████████████▋                                   | 3124/9732 [00:22<00:45, 146.78it/s] 32%|████████████████▊                                   | 3139/9732 [00:22<00:44, 146.63it/s] 32%|████████████████▊                                   | 3154/9732 [00:22<00:45, 145.06it/s] 33%|████████████████▉                                   | 3169/9732 [00:22<00:45, 145.61it/s] 33%|█████████████████                                   | 3184/9732 [00:22<00:44, 146.17it/s] 33%|█████████████████                                   | 3199/9732 [00:22<00:44, 146.45it/s] 33%|█████████████████▏                                  | 3214/9732 [00:22<00:44, 146.29it/s] 33%|█████████████████▎                                  | 3229/9732 [00:22<00:44, 145.29it/s] 33%|█████████████████▎                                  | 3244/9732 [00:22<00:44, 145.76it/s] 33%|█████████████████▍                                  | 3259/9732 [00:22<00:44, 145.86it/s] 34%|█████████████████▍                                  | 3274/9732 [00:23<00:44, 146.21it/s] 34%|█████████████████▌                                  | 3289/9732 [00:23<00:43, 146.47it/s] 34%|█████████████████▋                                  | 3304/9732 [00:23<00:43, 146.65it/s] 34%|█████████████████▋                                  | 3319/9732 [00:23<00:43, 146.68it/s] 34%|█████████████████▊                                  | 3334/9732 [00:23<00:43, 146.63it/s] 34%|█████████████████▉                                  | 3349/9732 [00:23<00:43, 146.80it/s] 35%|█████████████████▉                                  | 3364/9732 [00:23<00:43, 146.93it/s] 35%|██████████████████                                  | 3379/9732 [00:23<00:43, 147.14it/s] 35%|██████████████████▏                                 | 3394/9732 [00:23<00:43, 145.14it/s] 35%|██████████████████▏                                 | 3409/9732 [00:23<00:43, 145.44it/s] 35%|██████████████████▎                                 | 3424/9732 [00:24<00:43, 145.51it/s] 35%|██████████████████▍                                 | 3439/9732 [00:24<00:43, 145.66it/s] 35%|██████████████████▍                                 | 3454/9732 [00:24<00:43, 145.99it/s] 36%|██████████████████▌                                 | 3469/9732 [00:24<00:42, 146.25it/s] 36%|██████████████████▌                                 | 3484/9732 [00:24<00:43, 145.02it/s] 36%|██████████████████▋                                 | 3499/9732 [00:24<00:42, 145.39it/s] 36%|██████████████████▊                                 | 3514/9732 [00:24<00:42, 145.70it/s] 36%|██████████████████▊                                 | 3529/9732 [00:24<00:42, 145.96it/s] 36%|██████████████████▉                                 | 3544/9732 [00:24<00:42, 146.28it/s] 37%|███████████████████                                 | 3559/9732 [00:24<00:42, 146.47it/s] 37%|███████████████████                                 | 3574/9732 [00:25<00:42, 146.51it/s] 37%|███████████████████▏                                | 3589/9732 [00:25<00:41, 146.62it/s] 37%|███████████████████▎                                | 3604/9732 [00:25<00:41, 146.71it/s] 37%|███████████████████▎                                | 3619/9732 [00:25<00:42, 145.26it/s] 37%|███████████████████▍                                | 3634/9732 [00:25<00:41, 145.73it/s] 37%|███████████████████▍                                | 3649/9732 [00:25<00:41, 146.09it/s] 38%|███████████████████▌                                | 3664/9732 [00:25<00:41, 146.11it/s] 38%|███████████████████▋                                | 3679/9732 [00:25<00:41, 146.41it/s] 38%|███████████████████▋                                | 3694/9732 [00:25<00:41, 146.39it/s] 38%|███████████████████▊                                | 3709/9732 [00:26<00:41, 146.48it/s] 38%|███████████████████▉                                | 3724/9732 [00:26<00:41, 146.49it/s] 38%|███████████████████▉                                | 3739/9732 [00:26<00:40, 146.25it/s] 39%|████████████████████                                | 3754/9732 [00:26<00:40, 146.16it/s] 39%|████████████████████▏                               | 3769/9732 [00:26<00:40, 146.33it/s] 39%|████████████████████▏                               | 3784/9732 [00:26<00:40, 146.43it/s] 39%|████████████████████▎                               | 3799/9732 [00:26<00:40, 145.98it/s] 39%|████████████████████▍                               | 3814/9732 [00:26<00:40, 146.10it/s] 39%|████████████████████▍                               | 3829/9732 [00:26<00:40, 146.20it/s] 39%|████████████████████▌                               | 3844/9732 [00:26<00:40, 144.92it/s] 40%|████████████████████▌                               | 3859/9732 [00:27<00:40, 145.63it/s] 40%|████████████████████▋                               | 3874/9732 [00:27<00:40, 146.01it/s] 40%|████████████████████▊                               | 3889/9732 [00:27<00:39, 146.32it/s] 40%|████████████████████▊                               | 3904/9732 [00:27<00:39, 146.50it/s] 40%|████████████████████▉                               | 3919/9732 [00:27<00:39, 146.18it/s] 40%|█████████████████████                               | 3934/9732 [00:27<00:39, 146.31it/s] 41%|█████████████████████                               | 3949/9732 [00:27<00:39, 146.09it/s] 41%|█████████████████████▏                              | 3964/9732 [00:27<00:39, 145.80it/s] 41%|█████████████████████▎                              | 3979/9732 [00:27<00:39, 145.70it/s] 41%|█████████████████████▎                              | 3994/9732 [00:27<00:39, 145.70it/s] 41%|█████████████████████▍                              | 4009/9732 [00:28<00:39, 146.06it/s] 41%|█████████████████████▌                              | 4024/9732 [00:28<00:39, 146.06it/s] 42%|█████████████████████▌                              | 4039/9732 [00:28<00:38, 146.28it/s] 42%|█████████████████████▋                              | 4054/9732 [00:28<00:38, 146.23it/s] 42%|█████████████████████▋                              | 4069/9732 [00:28<00:39, 144.82it/s] 42%|█████████████████████▊                              | 4084/9732 [00:28<00:38, 145.17it/s] 42%|█████████████████████▉                              | 4099/9732 [00:28<00:38, 145.29it/s] 42%|█████████████████████▉                              | 4114/9732 [00:28<00:38, 145.70it/s] 42%|██████████████████████                              | 4129/9732 [00:28<00:38, 145.70it/s] 43%|██████████████████████▏                             | 4144/9732 [00:28<00:38, 145.66it/s] 43%|██████████████████████▏                             | 4159/9732 [00:29<00:38, 145.98it/s] 43%|██████████████████████▎                             | 4174/9732 [00:29<00:38, 146.17it/s] 43%|██████████████████████▍                             | 4189/9732 [00:29<00:37, 146.37it/s] 43%|██████████████████████▍                             | 4204/9732 [00:29<00:37, 146.58it/s] 43%|██████████████████████▌                             | 4219/9732 [00:29<00:37, 146.30it/s] 44%|██████████████████████▌                             | 4234/9732 [00:29<00:37, 146.47it/s] 44%|██████████████████████▋                             | 4249/9732 [00:29<00:37, 146.43it/s] 44%|██████████████████████▊                             | 4264/9732 [00:29<00:37, 145.79it/s] 44%|██████████████████████▊                             | 4279/9732 [00:29<00:37, 145.41it/s] 44%|██████████████████████▉                             | 4294/9732 [00:30<00:37, 143.84it/s] 44%|███████████████████████                             | 4309/9732 [00:30<00:37, 144.23it/s] 44%|███████████████████████                             | 4324/9732 [00:30<00:37, 144.50it/s] 45%|███████████████████████▏                            | 4339/9732 [00:30<00:37, 144.82it/s] 45%|███████████████████████▎                            | 4354/9732 [00:30<00:37, 145.06it/s] 45%|███████████████████████▎                            | 4369/9732 [00:30<00:36, 145.06it/s] 45%|███████████████████████▍                            | 4384/9732 [00:30<00:36, 145.02it/s] 45%|███████████████████████▌                            | 4399/9732 [00:30<00:36, 145.50it/s] 45%|███████████████████████▌                            | 4414/9732 [00:30<00:36, 145.67it/s] 46%|███████████████████████▋                            | 4429/9732 [00:30<00:36, 145.91it/s] 46%|███████████████████████▋                            | 4444/9732 [00:31<00:36, 146.04it/s] 46%|███████████████████████▊                            | 4459/9732 [00:31<00:36, 146.24it/s] 46%|███████████████████████▉                            | 4474/9732 [00:31<00:35, 146.24it/s] 46%|███████████████████████▉                            | 4489/9732 [00:31<00:35, 146.21it/s] 46%|████████████████████████                            | 4504/9732 [00:31<00:35, 146.16it/s] 46%|████████████████████████▏                           | 4519/9732 [00:31<00:42, 122.42it/s] 47%|████████████████████████▏                           | 4534/9732 [00:31<00:40, 128.65it/s] 47%|████████████████████████▎                           | 4549/9732 [00:31<00:38, 133.50it/s] 47%|████████████████████████▍                           | 4564/9732 [00:31<00:37, 136.55it/s] 47%|████████████████████████▍                           | 4579/9732 [00:32<00:37, 139.19it/s] 47%|████████████████████████▌                           | 4594/9732 [00:32<00:36, 141.07it/s] 47%|████████████████████████▋                           | 4609/9732 [00:32<00:35, 142.52it/s] 48%|████████████████████████▋                           | 4624/9732 [00:32<00:35, 143.57it/s] 48%|████████████████████████▊                           | 4639/9732 [00:32<00:35, 144.45it/s] 48%|████████████████████████▊                           | 4654/9732 [00:32<00:35, 144.53it/s] 48%|████████████████████████▉                           | 4669/9732 [00:32<00:34, 144.70it/s] 48%|█████████████████████████                           | 4684/9732 [00:32<00:34, 144.43it/s] 48%|█████████████████████████                           | 4699/9732 [00:32<00:34, 144.19it/s] 48%|█████████████████████████▏                          | 4714/9732 [00:32<00:34, 144.13it/s] 49%|█████████████████████████▎                          | 4729/9732 [00:33<00:34, 144.16it/s] 49%|█████████████████████████▊                           | 4744/9732 [00:33<00:50, 98.27it/s] 49%|█████████████████████████▍                          | 4759/9732 [00:33<00:45, 108.17it/s] 49%|█████████████████████████▌                          | 4774/9732 [00:33<00:42, 117.00it/s] 49%|█████████████████████████▌                          | 4789/9732 [00:33<00:39, 123.83it/s] 49%|█████████████████████████▋                          | 4804/9732 [00:33<00:38, 129.18it/s] 50%|█████████████████████████▋                          | 4819/9732 [00:33<00:36, 133.20it/s] 50%|█████████████████████████▊                          | 4834/9732 [00:33<00:35, 136.27it/s] 50%|█████████████████████████▉                          | 4849/9732 [00:34<00:35, 138.55it/s] 50%|█████████████████████████▉                          | 4864/9732 [00:34<00:34, 139.34it/s] 50%|██████████████████████████                          | 4879/9732 [00:34<00:34, 141.30it/s] 50%|██████████████████████████▏                         | 4894/9732 [00:34<00:33, 142.88it/s] 50%|██████████████████████████▏                         | 4909/9732 [00:34<00:33, 143.75it/s] 51%|██████████████████████████▎                         | 4924/9732 [00:34<00:33, 144.49it/s] 51%|██████████████████████████▍                         | 4939/9732 [00:34<00:32, 145.25it/s] 51%|██████████████████████████▍                         | 4954/9732 [00:34<00:33, 143.72it/s] 51%|██████████████████████████▌                         | 4969/9732 [00:34<00:32, 144.49it/s] 51%|██████████████████████████▋                         | 4984/9732 [00:35<00:32, 145.16it/s] 51%|██████████████████████████▋                         | 4999/9732 [00:35<00:32, 145.38it/s] 52%|██████████████████████████▊                         | 5014/9732 [00:35<00:32, 145.10it/s] 52%|██████████████████████████▊                         | 5029/9732 [00:35<00:32, 144.90it/s] 52%|██████████████████████████▉                         | 5044/9732 [00:35<00:32, 144.50it/s] 52%|███████████████████████████                         | 5059/9732 [00:35<00:32, 144.39it/s] 52%|███████████████████████████                         | 5074/9732 [00:35<00:32, 144.23it/s] 52%|███████████████████████████▏                        | 5089/9732 [00:35<00:32, 144.29it/s] 52%|███████████████████████████▎                        | 5104/9732 [00:35<00:31, 144.86it/s] 53%|███████████████████████████▎                        | 5119/9732 [00:35<00:31, 145.37it/s] 53%|███████████████████████████▍                        | 5134/9732 [00:36<00:31, 145.34it/s] 53%|███████████████████████████▌                        | 5149/9732 [00:36<00:31, 145.17it/s] 53%|███████████████████████████▌                        | 5164/9732 [00:36<00:31, 144.83it/s] 53%|███████████████████████████▋                        | 5179/9732 [00:36<00:31, 143.12it/s] 53%|███████████████████████████▊                        | 5194/9732 [00:36<00:31, 144.13it/s] 54%|███████████████████████████▊                        | 5209/9732 [00:36<00:31, 144.85it/s] 54%|███████████████████████████▉                        | 5224/9732 [00:36<00:31, 144.76it/s] 54%|███████████████████████████▉                        | 5239/9732 [00:36<00:31, 144.56it/s] 54%|████████████████████████████                        | 5254/9732 [00:36<00:30, 144.92it/s] 54%|████████████████████████████▏                       | 5269/9732 [00:36<00:30, 144.66it/s] 54%|████████████████████████████▏                       | 5284/9732 [00:37<00:30, 144.58it/s] 54%|████████████████████████████▎                       | 5299/9732 [00:37<00:30, 144.66it/s] 55%|████████████████████████████▍                       | 5314/9732 [00:37<00:30, 145.11it/s] 55%|████████████████████████████▍                       | 5329/9732 [00:37<00:30, 145.27it/s] 55%|████████████████████████████▌                       | 5344/9732 [00:37<00:30, 145.46it/s] 55%|████████████████████████████▋                       | 5359/9732 [00:37<00:30, 145.75it/s] 55%|████████████████████████████▋                       | 5374/9732 [00:37<00:29, 145.89it/s] 55%|████████████████████████████▊                       | 5389/9732 [00:37<00:29, 145.97it/s] 56%|████████████████████████████▊                       | 5404/9732 [00:37<00:29, 144.61it/s] 56%|████████████████████████████▉                       | 5419/9732 [00:38<00:29, 145.20it/s] 56%|█████████████████████████████                       | 5434/9732 [00:38<00:29, 145.70it/s] 56%|█████████████████████████████                       | 5449/9732 [00:38<00:29, 145.71it/s] 56%|█████████████████████████████▏                      | 5464/9732 [00:38<00:29, 146.03it/s] 56%|█████████████████████████████▎                      | 5479/9732 [00:38<00:28, 146.75it/s] 56%|█████████████████████████████▎                      | 5494/9732 [00:38<00:28, 147.19it/s] 57%|█████████████████████████████▍                      | 5509/9732 [00:38<00:28, 147.56it/s] 57%|█████████████████████████████▌                      | 5524/9732 [00:38<00:28, 147.80it/s] 57%|█████████████████████████████▌                      | 5539/9732 [00:38<00:28, 147.85it/s] 57%|█████████████████████████████▋                      | 5554/9732 [00:38<00:28, 148.06it/s] 57%|█████████████████████████████▊                      | 5569/9732 [00:39<00:28, 148.17it/s] 57%|█████████████████████████████▊                      | 5584/9732 [00:39<00:27, 148.17it/s] 58%|█████████████████████████████▉                      | 5599/9732 [00:39<00:27, 148.18it/s] 58%|█████████████████████████████▉                      | 5614/9732 [00:39<00:27, 148.28it/s] 58%|██████████████████████████████                      | 5629/9732 [00:39<00:27, 146.91it/s] 58%|██████████████████████████████▏                     | 5644/9732 [00:39<00:27, 147.13it/s] 58%|██████████████████████████████▏                     | 5659/9732 [00:39<00:27, 147.53it/s] 58%|██████████████████████████████▎                     | 5674/9732 [00:39<00:27, 147.79it/s] 58%|██████████████████████████████▍                     | 5689/9732 [00:39<00:27, 147.43it/s] 59%|██████████████████████████████▍                     | 5704/9732 [00:39<00:27, 147.76it/s] 59%|██████████████████████████████▌                     | 5719/9732 [00:40<00:27, 148.01it/s] 59%|██████████████████████████████▋                     | 5734/9732 [00:40<00:26, 148.22it/s] 59%|██████████████████████████████▋                     | 5749/9732 [00:40<00:26, 148.14it/s] 59%|██████████████████████████████▊                     | 5764/9732 [00:40<00:26, 148.14it/s] 59%|██████████████████████████████▉                     | 5779/9732 [00:40<00:26, 148.18it/s] 60%|██████████████████████████████▉                     | 5794/9732 [00:40<00:26, 148.26it/s] 60%|███████████████████████████████                     | 5809/9732 [00:40<00:26, 148.29it/s] 60%|███████████████████████████████                     | 5824/9732 [00:40<00:26, 147.45it/s] 60%|███████████████████████████████▏                    | 5839/9732 [00:40<00:26, 147.65it/s] 60%|███████████████████████████████▎                    | 5854/9732 [00:40<00:26, 146.19it/s] 60%|███████████████████████████████▎                    | 5869/9732 [00:41<00:26, 146.78it/s] 60%|███████████████████████████████▍                    | 5884/9732 [00:41<00:26, 147.25it/s] 61%|███████████████████████████████▌                    | 5899/9732 [00:41<00:25, 147.60it/s] 61%|███████████████████████████████▌                    | 5914/9732 [00:41<00:25, 147.85it/s] 61%|███████████████████████████████▋                    | 5929/9732 [00:41<00:25, 147.95it/s] 61%|███████████████████████████████▊                    | 5944/9732 [00:41<00:25, 148.06it/s] 61%|███████████████████████████████▊                    | 5959/9732 [00:41<00:25, 148.08it/s] 61%|███████████████████████████████▉                    | 5974/9732 [00:41<00:25, 148.10it/s] 62%|████████████████████████████████                    | 5989/9732 [00:41<00:25, 148.23it/s] 62%|████████████████████████████████                    | 6004/9732 [00:41<00:25, 148.27it/s] 62%|████████████████████████████████▏                   | 6019/9732 [00:42<00:25, 147.09it/s] 62%|████████████████████████████████▏                   | 6034/9732 [00:42<00:25, 147.48it/s] 62%|████████████████████████████████▎                   | 6049/9732 [00:42<00:24, 147.83it/s] 62%|████████████████████████████████▍                   | 6064/9732 [00:42<00:24, 148.01it/s] 62%|████████████████████████████████▍                   | 6079/9732 [00:42<00:24, 148.20it/s] 63%|████████████████████████████████▌                   | 6094/9732 [00:42<00:24, 146.85it/s] 63%|████████████████████████████████▋                   | 6109/9732 [00:42<00:24, 147.34it/s] 63%|████████████████████████████████▋                   | 6124/9732 [00:42<00:24, 147.57it/s] 63%|████████████████████████████████▊                   | 6139/9732 [00:42<00:24, 147.40it/s] 63%|████████████████████████████████▉                   | 6154/9732 [00:42<00:24, 147.63it/s] 63%|████████████████████████████████▉                   | 6169/9732 [00:43<00:24, 147.97it/s] 64%|█████████████████████████████████                   | 6184/9732 [00:43<00:23, 148.12it/s] 64%|█████████████████████████████████                   | 6199/9732 [00:43<00:23, 148.18it/s] 64%|█████████████████████████████████▏                  | 6214/9732 [00:43<00:23, 148.28it/s] 64%|█████████████████████████████████▎                  | 6229/9732 [00:43<00:23, 148.14it/s] 64%|█████████████████████████████████▎                  | 6244/9732 [00:43<00:23, 148.08it/s] 64%|█████████████████████████████████▍                  | 6259/9732 [00:43<00:23, 148.09it/s] 64%|█████████████████████████████████▌                  | 6274/9732 [00:43<00:23, 148.13it/s] 65%|█████████████████████████████████▌                  | 6289/9732 [00:43<00:23, 148.22it/s] 65%|█████████████████████████████████▋                  | 6304/9732 [00:43<00:23, 148.14it/s] 65%|█████████████████████████████████▊                  | 6319/9732 [00:44<00:23, 146.64it/s] 65%|█████████████████████████████████▊                  | 6334/9732 [00:44<00:23, 147.14it/s] 65%|█████████████████████████████████▉                  | 6349/9732 [00:44<00:23, 146.29it/s] 65%|██████████████████████████████████                  | 6364/9732 [00:44<00:22, 146.85it/s] 66%|██████████████████████████████████                  | 6379/9732 [00:44<00:22, 147.43it/s] 66%|██████████████████████████████████▏                 | 6394/9732 [00:44<00:22, 147.78it/s] 66%|██████████████████████████████████▏                 | 6409/9732 [00:44<00:22, 147.95it/s] 66%|██████████████████████████████████▎                 | 6424/9732 [00:44<00:22, 148.14it/s] 66%|██████████████████████████████████▍                 | 6439/9732 [00:44<00:22, 148.24it/s] 66%|██████████████████████████████████▍                 | 6454/9732 [00:45<00:22, 148.14it/s] 66%|██████████████████████████████████▌                 | 6469/9732 [00:45<00:22, 148.24it/s] 67%|██████████████████████████████████▋                 | 6484/9732 [00:45<00:21, 148.30it/s] 67%|██████████████████████████████████▋                 | 6499/9732 [00:45<00:21, 148.37it/s] 67%|██████████████████████████████████▊                 | 6514/9732 [00:45<00:21, 148.27it/s] 67%|██████████████████████████████████▉                 | 6529/9732 [00:45<00:21, 148.33it/s] 67%|██████████████████████████████████▉                 | 6544/9732 [00:45<00:21, 146.87it/s] 67%|███████████████████████████████████                 | 6559/9732 [00:45<00:21, 147.31it/s] 68%|███████████████████████████████████▏                | 6574/9732 [00:45<00:21, 147.67it/s] 68%|███████████████████████████████████▏                | 6589/9732 [00:45<00:21, 148.02it/s] 68%|███████████████████████████████████▎                | 6604/9732 [00:46<00:21, 148.20it/s] 68%|███████████████████████████████████▎                | 6619/9732 [00:46<00:20, 148.36it/s] 68%|███████████████████████████████████▍                | 6634/9732 [00:46<00:20, 148.58it/s] 68%|███████████████████████████████████▌                | 6649/9732 [00:46<00:20, 148.72it/s] 68%|███████████████████████████████████▌                | 6664/9732 [00:46<00:20, 147.56it/s] 69%|███████████████████████████████████▋                | 6679/9732 [00:46<00:20, 147.94it/s] 69%|███████████████████████████████████▊                | 6694/9732 [00:46<00:20, 148.21it/s] 69%|███████████████████████████████████▊                | 6709/9732 [00:46<00:20, 148.52it/s] 69%|███████████████████████████████████▉                | 6724/9732 [00:46<00:20, 148.63it/s] 69%|████████████████████████████████████                | 6739/9732 [00:46<00:20, 148.70it/s] 69%|████████████████████████████████████                | 6754/9732 [00:47<00:20, 148.85it/s] 70%|████████████████████████████████████▏               | 6769/9732 [00:47<00:20, 147.37it/s] 70%|████████████████████████████████████▏               | 6784/9732 [00:47<00:19, 147.78it/s] 70%|████████████████████████████████████▎               | 6799/9732 [00:47<00:19, 148.18it/s] 70%|████████████████████████████████████▍               | 6814/9732 [00:47<00:19, 148.39it/s] 70%|████████████████████████████████████▍               | 6829/9732 [00:47<00:19, 148.63it/s] 70%|████████████████████████████████████▌               | 6844/9732 [00:47<00:19, 148.69it/s] 70%|████████████████████████████████████▋               | 6859/9732 [00:47<00:19, 148.78it/s] 71%|████████████████████████████████████▋               | 6874/9732 [00:47<00:19, 148.75it/s] 71%|████████████████████████████████████▊               | 6889/9732 [00:47<00:19, 148.83it/s] 71%|████████████████████████████████████▉               | 6904/9732 [00:48<00:19, 148.81it/s] 71%|████████████████████████████████████▉               | 6919/9732 [00:48<00:18, 148.90it/s] 71%|█████████████████████████████████████               | 6934/9732 [00:48<00:18, 148.81it/s] 71%|█████████████████████████████████████▏              | 6949/9732 [00:48<00:18, 148.85it/s] 72%|█████████████████████████████████████▏              | 6964/9732 [00:48<00:18, 148.83it/s] 72%|█████████████████████████████████████▎              | 6979/9732 [00:48<00:18, 148.83it/s] 72%|█████████████████████████████████████▎              | 6994/9732 [00:48<00:18, 145.89it/s] 72%|█████████████████████████████████████▍              | 7009/9732 [00:48<00:18, 146.65it/s] 72%|█████████████████████████████████████▌              | 7024/9732 [00:48<00:18, 147.28it/s] 72%|█████████████████████████████████████▌              | 7039/9732 [00:48<00:18, 147.66it/s] 72%|█████████████████████████████████████▋              | 7054/9732 [00:49<00:18, 148.00it/s] 73%|█████████████████████████████████████▊              | 7069/9732 [00:49<00:17, 148.19it/s] 73%|█████████████████████████████████████▊              | 7084/9732 [00:49<00:17, 148.32it/s] 73%|█████████████████████████████████████▉              | 7099/9732 [00:49<00:17, 148.50it/s] 73%|██████████████████████████████████████              | 7114/9732 [00:49<00:17, 148.64it/s] 73%|██████████████████████████████████████              | 7129/9732 [00:49<00:17, 148.73it/s] 73%|██████████████████████████████████████▏             | 7144/9732 [00:49<00:17, 148.79it/s] 74%|██████████████████████████████████████▎             | 7159/9732 [00:49<00:17, 148.63it/s] 74%|██████████████████████████████████████▎             | 7174/9732 [00:49<00:17, 148.65it/s] 74%|██████████████████████████████████████▍             | 7189/9732 [00:49<00:17, 148.71it/s] 74%|██████████████████████████████████████▍             | 7204/9732 [00:50<00:17, 148.62it/s] 74%|██████████████████████████████████████▌             | 7219/9732 [00:50<00:17, 147.07it/s] 74%|██████████████████████████████████████▋             | 7234/9732 [00:50<00:16, 147.58it/s] 74%|██████████████████████████████████████▋             | 7249/9732 [00:50<00:16, 147.84it/s] 75%|██████████████████████████████████████▊             | 7264/9732 [00:50<00:16, 147.94it/s] 75%|██████████████████████████████████████▉             | 7279/9732 [00:50<00:16, 148.15it/s] 75%|██████████████████████████████████████▉             | 7294/9732 [00:50<00:16, 148.37it/s] 75%|███████████████████████████████████████             | 7309/9732 [00:50<00:16, 148.48it/s] 75%|███████████████████████████████████████▏            | 7324/9732 [00:50<00:16, 147.33it/s] 75%|███████████████████████████████████████▏            | 7339/9732 [00:50<00:16, 147.79it/s] 76%|███████████████████████████████████████▎            | 7354/9732 [00:51<00:16, 148.07it/s] 76%|███████████████████████████████████████▎            | 7369/9732 [00:51<00:15, 148.28it/s] 76%|███████████████████████████████████████▍            | 7384/9732 [00:51<00:15, 148.35it/s] 76%|███████████████████████████████████████▌            | 7399/9732 [00:51<00:15, 148.45it/s] 76%|███████████████████████████████████████▌            | 7414/9732 [00:51<00:15, 148.44it/s] 76%|███████████████████████████████████████▋            | 7429/9732 [00:51<00:15, 148.48it/s] 76%|███████████████████████████████████████▊            | 7444/9732 [00:51<00:19, 120.27it/s] 77%|███████████████████████████████████████▊            | 7459/9732 [00:51<00:17, 127.64it/s] 77%|███████████████████████████████████████▉            | 7474/9732 [00:51<00:16, 133.15it/s] 77%|████████████████████████████████████████            | 7489/9732 [00:52<00:16, 137.33it/s] 77%|████████████████████████████████████████            | 7504/9732 [00:52<00:15, 140.41it/s] 77%|████████████████████████████████████████▏           | 7519/9732 [00:52<00:15, 142.77it/s] 77%|████████████████████████████████████████▎           | 7534/9732 [00:52<00:15, 144.51it/s] 78%|████████████████████████████████████████▎           | 7549/9732 [00:52<00:14, 145.72it/s] 78%|████████████████████████████████████████▍           | 7564/9732 [00:52<00:14, 146.64it/s] 78%|████████████████████████████████████████▍           | 7579/9732 [00:52<00:14, 147.18it/s] 78%|████████████████████████████████████████▌           | 7594/9732 [00:52<00:14, 147.63it/s] 78%|████████████████████████████████████████▋           | 7609/9732 [00:52<00:14, 147.98it/s] 78%|████████████████████████████████████████▋           | 7624/9732 [00:52<00:14, 148.16it/s] 78%|████████████████████████████████████████▊           | 7639/9732 [00:53<00:14, 146.73it/s] 79%|████████████████████████████████████████▉           | 7654/9732 [00:53<00:14, 147.18it/s] 79%|████████████████████████████████████████▉           | 7669/9732 [00:53<00:14, 146.08it/s] 79%|█████████████████████████████████████████           | 7684/9732 [00:53<00:13, 146.68it/s] 79%|█████████████████████████████████████████▏          | 7699/9732 [00:53<00:13, 147.28it/s] 79%|█████████████████████████████████████████▏          | 7714/9732 [00:53<00:13, 147.73it/s] 79%|█████████████████████████████████████████▎          | 7729/9732 [00:53<00:13, 148.05it/s] 80%|█████████████████████████████████████████▍          | 7744/9732 [00:53<00:13, 148.17it/s] 80%|█████████████████████████████████████████▍          | 7759/9732 [00:53<00:13, 148.28it/s] 80%|█████████████████████████████████████████▌          | 7774/9732 [00:53<00:13, 148.31it/s] 80%|█████████████████████████████████████████▌          | 7789/9732 [00:54<00:13, 148.30it/s] 80%|█████████████████████████████████████████▋          | 7804/9732 [00:54<00:12, 148.44it/s] 80%|█████████████████████████████████████████▊          | 7819/9732 [00:54<00:12, 148.55it/s] 80%|█████████████████████████████████████████▊          | 7834/9732 [00:54<00:12, 148.62it/s] 81%|█████████████████████████████████████████▉          | 7849/9732 [00:54<00:12, 148.56it/s] 81%|██████████████████████████████████████████          | 7864/9732 [00:54<00:12, 148.58it/s] 81%|██████████████████████████████████████████          | 7879/9732 [00:54<00:12, 148.55it/s] 81%|██████████████████████████████████████████▏         | 7894/9732 [00:54<00:12, 148.47it/s] 81%|██████████████████████████████████████████▎         | 7909/9732 [00:54<00:12, 146.99it/s] 81%|██████████████████████████████████████████▎         | 7924/9732 [00:55<00:12, 147.41it/s] 82%|██████████████████████████████████████████▍         | 7939/9732 [00:55<00:12, 147.79it/s] 82%|██████████████████████████████████████████▍         | 7954/9732 [00:55<00:12, 147.98it/s] 82%|██████████████████████████████████████████▌         | 7969/9732 [00:55<00:11, 147.85it/s] 82%|██████████████████████████████████████████▋         | 7984/9732 [00:55<00:11, 147.99it/s] 82%|██████████████████████████████████████████▋         | 7999/9732 [00:55<00:11, 148.07it/s] 82%|██████████████████████████████████████████▊         | 8014/9732 [00:55<00:11, 148.23it/s] 83%|██████████████████████████████████████████▉         | 8029/9732 [00:55<00:11, 148.32it/s] 83%|██████████████████████████████████████████▉         | 8044/9732 [00:55<00:11, 148.30it/s] 83%|███████████████████████████████████████████         | 8059/9732 [00:55<00:11, 148.41it/s] 83%|███████████████████████████████████████████▏        | 8074/9732 [00:56<00:11, 148.47it/s] 83%|███████████████████████████████████████████▏        | 8089/9732 [00:56<00:11, 148.55it/s] 83%|███████████████████████████████████████████▎        | 8104/9732 [00:56<00:10, 148.52it/s] 83%|███████████████████████████████████████████▍        | 8119/9732 [00:56<00:10, 148.57it/s] 84%|███████████████████████████████████████████▍        | 8134/9732 [00:56<00:10, 147.10it/s] 84%|███████████████████████████████████████████▌        | 8149/9732 [00:56<00:10, 147.45it/s] 84%|███████████████████████████████████████████▌        | 8164/9732 [00:56<00:10, 147.76it/s] 84%|███████████████████████████████████████████▋        | 8179/9732 [00:56<00:10, 148.01it/s] 84%|███████████████████████████████████████████▊        | 8194/9732 [00:56<00:10, 148.04it/s] 84%|███████████████████████████████████████████▊        | 8209/9732 [00:56<00:10, 148.09it/s] 85%|███████████████████████████████████████████▉        | 8224/9732 [00:57<00:10, 148.16it/s] 85%|████████████████████████████████████████████        | 8239/9732 [00:57<00:10, 148.36it/s] 85%|████████████████████████████████████████████        | 8254/9732 [00:57<00:09, 148.43it/s] 85%|████████████████████████████████████████████▏       | 8269/9732 [00:57<00:09, 148.46it/s] 85%|████████████████████████████████████████████▎       | 8284/9732 [00:57<00:09, 148.52it/s] 85%|████████████████████████████████████████████▎       | 8299/9732 [00:57<00:09, 148.53it/s] 85%|████████████████████████████████████████████▍       | 8314/9732 [00:57<00:09, 148.57it/s] 86%|████████████████████████████████████████████▌       | 8329/9732 [00:57<00:09, 148.60it/s] 86%|████████████████████████████████████████████▌       | 8344/9732 [00:57<00:09, 148.66it/s] 86%|████████████████████████████████████████████▋       | 8359/9732 [00:57<00:09, 146.42it/s] 86%|████████████████████████████████████████████▋       | 8374/9732 [00:58<00:09, 147.09it/s] 86%|████████████████████████████████████████████▊       | 8389/9732 [00:58<00:09, 147.50it/s] 86%|████████████████████████████████████████████▉       | 8404/9732 [00:58<00:08, 147.93it/s] 87%|████████████████████████████████████████████▉       | 8419/9732 [00:58<00:08, 148.50it/s] 87%|█████████████████████████████████████████████       | 8434/9732 [00:58<00:08, 148.91it/s] 87%|█████████████████████████████████████████████▏      | 8449/9732 [00:58<00:08, 149.13it/s] 87%|█████████████████████████████████████████████▏      | 8464/9732 [00:58<00:08, 149.34it/s] 87%|█████████████████████████████████████████████▎      | 8479/9732 [00:58<00:08, 149.45it/s] 87%|█████████████████████████████████████████████▍      | 8494/9732 [00:58<00:08, 149.47it/s] 87%|█████████████████████████████████████████████▍      | 8509/9732 [00:58<00:08, 149.47it/s] 88%|█████████████████████████████████████████████▌      | 8524/9732 [00:59<00:08, 149.19it/s] 88%|█████████████████████████████████████████████▋      | 8539/9732 [00:59<00:07, 149.23it/s] 88%|█████████████████████████████████████████████▋      | 8554/9732 [00:59<00:07, 149.34it/s] 88%|█████████████████████████████████████████████▊      | 8569/9732 [00:59<00:07, 149.40it/s] 88%|█████████████████████████████████████████████▊      | 8584/9732 [00:59<00:07, 147.97it/s] 88%|█████████████████████████████████████████████▉      | 8599/9732 [00:59<00:07, 148.41it/s] 89%|██████████████████████████████████████████████      | 8614/9732 [00:59<00:07, 148.58it/s] 89%|██████████████████████████████████████████████      | 8629/9732 [00:59<00:07, 148.43it/s] 89%|██████████████████████████████████████████████▏     | 8644/9732 [00:59<00:07, 148.58it/s] 89%|██████████████████████████████████████████████▎     | 8659/9732 [00:59<00:07, 146.91it/s] 89%|██████████████████████████████████████████████▎     | 8674/9732 [01:00<00:07, 147.77it/s] 89%|██████████████████████████████████████████████▍     | 8689/9732 [01:00<00:07, 148.36it/s] 89%|██████████████████████████████████████████████▌     | 8704/9732 [01:00<00:06, 148.74it/s] 90%|██████████████████████████████████████████████▌     | 8719/9732 [01:00<00:06, 148.80it/s] 90%|██████████████████████████████████████████████▋     | 8734/9732 [01:00<00:06, 149.03it/s] 90%|██████████████████████████████████████████████▋     | 8749/9732 [01:00<00:06, 148.96it/s] 90%|██████████████████████████████████████████████▊     | 8764/9732 [01:00<00:06, 149.17it/s] 90%|██████████████████████████████████████████████▉     | 8779/9732 [01:00<00:06, 149.25it/s] 90%|██████████████████████████████████████████████▉     | 8794/9732 [01:00<00:06, 149.27it/s] 91%|███████████████████████████████████████████████     | 8809/9732 [01:00<00:06, 147.86it/s] 91%|███████████████████████████████████████████████▏    | 8824/9732 [01:01<00:06, 148.30it/s] 91%|███████████████████████████████████████████████▏    | 8839/9732 [01:01<00:06, 148.60it/s] 91%|███████████████████████████████████████████████▎    | 8854/9732 [01:01<00:05, 148.89it/s] 91%|███████████████████████████████████████████████▍    | 8869/9732 [01:01<00:05, 149.14it/s] 91%|███████████████████████████████████████████████▍    | 8884/9732 [01:01<00:05, 149.24it/s] 91%|███████████████████████████████████████████████▌    | 8899/9732 [01:01<00:05, 149.45it/s] 92%|███████████████████████████████████████████████▋    | 8914/9732 [01:01<00:05, 149.55it/s] 92%|███████████████████████████████████████████████▋    | 8929/9732 [01:01<00:05, 149.51it/s] 92%|███████████████████████████████████████████████▊    | 8944/9732 [01:01<00:05, 149.61it/s] 92%|███████████████████████████████████████████████▊    | 8959/9732 [01:01<00:05, 149.53it/s] 92%|███████████████████████████████████████████████▉    | 8974/9732 [01:02<00:05, 149.61it/s] 92%|████████████████████████████████████████████████    | 8989/9732 [01:02<00:04, 149.56it/s] 93%|████████████████████████████████████████████████    | 9004/9732 [01:02<00:04, 149.60it/s] 93%|████████████████████████████████████████████████▏   | 9019/9732 [01:02<00:04, 149.59it/s] 93%|████████████████████████████████████████████████▎   | 9034/9732 [01:02<00:04, 147.84it/s] 93%|████████████████████████████████████████████████▎   | 9049/9732 [01:02<00:04, 148.29it/s] 93%|████████████████████████████████████████████████▍   | 9064/9732 [01:02<00:04, 148.71it/s] 93%|████████████████████████████████████████████████▌   | 9079/9732 [01:02<00:04, 148.94it/s] 93%|████████████████████████████████████████████████▌   | 9094/9732 [01:02<00:04, 149.16it/s] 94%|████████████████████████████████████████████████▋   | 9109/9732 [01:02<00:04, 149.30it/s] 94%|████████████████████████████████████████████████▊   | 9124/9732 [01:03<00:04, 149.39it/s] 94%|████████████████████████████████████████████████▊   | 9139/9732 [01:03<00:03, 149.15it/s] 94%|████████████████████████████████████████████████▉   | 9154/9732 [01:03<00:03, 149.20it/s] 94%|████████████████████████████████████████████████▉   | 9169/9732 [01:03<00:03, 149.36it/s] 94%|█████████████████████████████████████████████████   | 9184/9732 [01:03<00:03, 149.36it/s] 95%|█████████████████████████████████████████████████▏  | 9199/9732 [01:03<00:03, 149.36it/s] 95%|█████████████████████████████████████████████████▏  | 9214/9732 [01:03<00:03, 149.42it/s] 95%|█████████████████████████████████████████████████▎  | 9229/9732 [01:03<00:03, 149.47it/s] 95%|█████████████████████████████████████████████████▍  | 9244/9732 [01:03<00:03, 149.41it/s] 95%|█████████████████████████████████████████████████▍  | 9259/9732 [01:03<00:03, 147.92it/s] 95%|█████████████████████████████████████████████████▌  | 9274/9732 [01:04<00:03, 148.40it/s] 95%|█████████████████████████████████████████████████▋  | 9289/9732 [01:04<00:02, 148.72it/s] 96%|█████████████████████████████████████████████████▋  | 9304/9732 [01:04<00:02, 149.03it/s] 96%|█████████████████████████████████████████████████▊  | 9319/9732 [01:04<00:02, 149.21it/s] 96%|█████████████████████████████████████████████████▊  | 9334/9732 [01:04<00:02, 149.23it/s] 96%|█████████████████████████████████████████████████▉  | 9349/9732 [01:04<00:02, 149.27it/s] 96%|██████████████████████████████████████████████████  | 9364/9732 [01:04<00:02, 149.36it/s] 96%|██████████████████████████████████████████████████  | 9379/9732 [01:04<00:02, 149.41it/s] 97%|██████████████████████████████████████████████████▏ | 9394/9732 [01:04<00:02, 149.38it/s] 97%|██████████████████████████████████████████████████▎ | 9409/9732 [01:04<00:02, 149.44it/s] 97%|██████████████████████████████████████████████████▎ | 9424/9732 [01:05<00:02, 149.39it/s] 97%|██████████████████████████████████████████████████▍ | 9439/9732 [01:05<00:01, 149.34it/s] 97%|██████████████████████████████████████████████████▌ | 9454/9732 [01:05<00:01, 149.38it/s] 97%|██████████████████████████████████████████████████▌ | 9469/9732 [01:05<00:01, 149.14it/s] 97%|██████████████████████████████████████████████████▋ | 9484/9732 [01:05<00:01, 149.00it/s] 98%|██████████████████████████████████████████████████▊ | 9499/9732 [01:05<00:01, 147.33it/s] 98%|██████████████████████████████████████████████████▊ | 9514/9732 [01:05<00:01, 147.68it/s] 98%|██████████████████████████████████████████████████▉ | 9529/9732 [01:05<00:01, 147.99it/s] 98%|██████████████████████████████████████████████████▉ | 9544/9732 [01:05<00:01, 147.84it/s] 98%|███████████████████████████████████████████████████ | 9559/9732 [01:06<00:01, 148.00it/s] 98%|███████████████████████████████████████████████████▏| 9574/9732 [01:06<00:01, 148.14it/s] 99%|███████████████████████████████████████████████████▏| 9589/9732 [01:06<00:00, 148.22it/s] 99%|███████████████████████████████████████████████████▎| 9604/9732 [01:06<00:00, 148.35it/s] 99%|███████████████████████████████████████████████████▍| 9619/9732 [01:06<00:00, 148.43it/s] 99%|███████████████████████████████████████████████████▍| 9634/9732 [01:06<00:00, 148.44it/s] 99%|███████████████████████████████████████████████████▌| 9649/9732 [01:06<00:00, 148.38it/s] 99%|███████████████████████████████████████████████████▋| 9664/9732 [01:06<00:00, 148.41it/s] 99%|███████████████████████████████████████████████████▋| 9679/9732 [01:06<00:00, 148.34it/s]100%|███████████████████████████████████████████████████▊| 9694/9732 [01:06<00:00, 148.20it/s]100%|███████████████████████████████████████████████████▉| 9709/9732 [01:07<00:00, 148.12it/s]100%|███████████████████████████████████████████████████▉| 9724/9732 [01:07<00:00, 146.76it/s]100%|████████████████████████████████████████████████████| 9732/9732 [01:07<00:00, 144.88it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:04<00:09,  4.96s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:04<00:09,  4.93s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.03s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.21s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.09s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:09<00:04,  4.99s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.11s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.28s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.38s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.54s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.50s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.65s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.52s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.67s/it]
[2023-08-21 16:27:34,104] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.65s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.81s/it]
[2023-08-21 16:27:41,869] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-21 16:27:41,869] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-21 16:27:41,869] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f5ec3fc3dc0>
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f5e89527280>
[2023-08-21 16:27:41,870] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-21 16:27:41,871] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-21 16:27:41,871] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-21 16:27:41,871] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-21 16:27:41,871] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-21 16:27:41,871] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-21 16:27:41,871] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-21 16:27:41,871] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-21 16:27:41,871] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-21 16:27:41,871] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-21 16:27:41,871] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-21 16:27:41,871] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-21 16:27:41,871] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-21 16:27:41,871] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-21 16:27:41,871] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-21 16:27:41,871] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-21 16:27:41,871] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-21 16:27:41,871] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-21 16:27:41,871] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-21 16:27:41,871] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-21 16:27:41,871] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-21 16:27:41,871] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-21 16:27:41,871] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.6951980590820312 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Loading extension module utils...
Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]Time to load utils op: 0.6050012111663818 seconds
############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: 1. The question asks where you can find plumbing that wouldn't help if you were thirsty.
2. This implies that you need to find a place with plumbing that does not transport drinkable water.
3. Option B, C, D, and E all have plumbing that can potentially access drinkable water.
4. Option B: the wall could refer to pipes running inside the wall, carrying clean water.
5. Option C: a show could imply a venue that has facilities, including water.
6. Option D: your own home definitely has usable plumbing for drinking water.
7. Option E: a water fountain also provides drinkable water.
8. Option A, oil refineries, are facilities for refining crude oil into usable materials such as gasoline and are not suitable for human water consumption.
9. Thus, the answer is A: oil refineries.
So the final answer is A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Output: 1. The question is asking what a person is not doing yet when they are in the beginning stages of work.
2. Option A: Working - This is not a correct answer because the person is in fact working. The question itself states that they are "beginning work."
3. Option B: Resting - This is not a correct option either. When somebody is beginning to work, they are not resting. Though it might be accurate to say they are not resting, the question is asking for what they are specifically not doing related to the work.
4. Option C: Tiredness - This option is irrelevant. Tiredness is a state of being, not an action. Therefore this can't be the correct answer. 
5. Option E: Momentum - This is also not the correct answer. Momentum refers to the process of working and keeping up a pace. It can be argued that at the beginning of work, momentum is being established.
6. Option D: Accomplishing - This is the correct answer. When a person is just beginning to work, they haven't accomplished anything yet. Accomplishment comes later, once the work is completed. So, at the beginning of the work, they are not yet accomplishing anything.
So the final answer is D: accomplishing

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Output: 1. Pens with a company logo would most likely be used for professional purposes rather than personal use.
2. Offices often use pens with the company logo on them for branding or marketing.
3. This means that they are probably not found on a pencil, which is a separate type of writing instrument and not likely to carry a company's logo.
4. While you indeed use pens to write sentences on paper, the statement does not suggest a specific location where you could find these pens.
5. Schools generally supply standard pens or pencils for their students or staff and would not typically have pens with a company logo.
6. You might carry a pen in a backpack, but it does not suggest where the pen, especially one with a company logo, would originate.
7. Therefore, the most logical place to find pens with a company logo is in an office.
So the final answer is A: office

Input: Billy called out to John, and listened for what? Choices:  A: silence B: response C: communication D: hanging up E: whisper
Output: 1. The question is about an interaction between Billy and John in which Billy calls out to John.
2. Calling out to someone traditionally assumes that a response is expected. 
3. The primary aim of Billy's action (calling out) in the context of the question would be to get a reaction or result, which in human interaction terms would be a'response'. 
4. Therefore, the correct answer is B: response.
So the final answer is B: response

Input: The lizard frightened the hiker, it's movements made what rustle? Choices:  A: garden B: trees C: books D: rocks E: bushes
Output: 1. The question is asking about the source of a sound, specifically, a rustling sound.
2. Rustling is typically associated with things that can move or be displaced in a subtle manner.
3. We look at the provided choices to pinpoint the source of the rustling. 
4. The choice 'garden' may be too broad, as a garden could encompass different elements, many of which may not make a rustling sound.
5. 'Trees' could rustle, but it would require a powerful force such as strong wind, unlikely to be caused by a lizard.
6. 'Books' can make a rustling noise, but it wouldn't make sense in this context as a lizard is an outdoors creature.
7. The choice 'rocks' is not suitable because rocks do not rustle.
8. The last choice is 'bushes', which can certainly rustle if something is moving around inside them, such as a lizard.
9. Given these considerations, the answer is E: 'bushes'.
So the final answer is E: bushes

Input: The man spent big money and time maintaining his lawn, it was part of keeping up with the Joneses where? Choices:  A: front yard B: suburbia C: neighborhood D: back yard E: golf course
Output: 1. The phrase "keeping up with the Joneses" is an idiom referring to the comparison to one's neighbor as a benchmark for social class or the accumulation of material goods.
2. The context of the question suggests the place should be related to where the man lives and where his efforts of maintaining his lawn would potentially be reciprocated.
3. The options "front yard" and "back yard" are specific parts of a property so they could not represent the surroundings where people are competing for appearances. 
4. The "golf course" also cannot be a correct answer as it is a place for sport, and not a residential area.
5. So, the correct answer among the given choices is "suburbia" as it refers to residential areas where people live and maintain their properties. Hence, this term most closely aligns with the concept of "keeping up with the Joneses".
So the final answer is B: suburbia

Input: What would a human do if they want to get to a store that he or she can see? Choices:  A: cross road B: see around C: drink coffee D: dream dreams E: think critically
Output: 1. The problem presents a situation where a human can see a store and presumably wants to get to that store.
2. We need to identify the best course of action from the given choices that will help the person reach the store.
3. Looking at choice A: crossing the road, it's a physical act of moving from one location to another which could possibly lead someone closer to their target location.
4. Examining choice B: see around, it's less direct and might only serve as a preparatory step for moving but not the actual movement.
5. Looking at choice C: drink coffee, is not relevant to the issue at hand because it doesn't involve any action that would bring someone closer to the store.
6. Choice D: dream dreams, involves a state of mind not connected to physical movement or orientation.
7. Looking at choice E: think critically, while useful in problem-solving scenarios, it's less direct in achieving the goal of getting to the store than choice A.
8. Therefore, from the given options, A: cross road appears to be the most likely action a person would take to get to a store they can see.
So the final answer is A: cross road

Input: Where would you grab an object contained by a doorway? Choices:  A: television B: control panel C: opening doors D: doorknob E: doorway
Output: 1. The question is asking for the place to grab an object that is contained by a doorway. 
2. To grab an object contained by a doorway means that you want to manipulate something that is part of the structure or system of the door itself. 
3. Your options are the television, control panel, opening doors, doorknob, and the doorway. 
4. The television and control panel are not part of the door's structure, so those options can be eliminated.
5. Open doors seem like a probable choice, yet it refers to the moving part of the doorway only, when the object
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i9-s1-rTrue
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.6052134037017822 seconds
Time to load utils op: 0.6047942638397217 seconds
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:39<32:11, 39.41s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:18<31:17, 39.11s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [01:56<30:27, 38.88s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [02:35<29:47, 38.87s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [03:14<29:11, 38.93s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [03:53<28:32, 38.91s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [04:32<27:52, 38.90s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [05:11<27:13, 38.89s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [05:50<26:34, 38.89s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [06:29<25:55, 38.90s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [07:07<25:15, 38.85s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [07:46<24:36, 38.85s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [08:25<23:56, 38.83s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [09:04<23:17, 38.82s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [09:43<22:38, 38.81s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [10:22<21:59, 38.81s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [11:00<21:22, 38.85s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [11:39<20:42, 38.83s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [12:18<20:02, 38.80s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [12:57<19:23, 38.80s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [13:36<18:45, 38.82s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [14:15<18:07, 38.84s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [14:54<17:31, 38.94s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [15:33<16:53, 38.99s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [16:12<16:16, 39.04s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [16:51<15:35, 38.99s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [17:30<14:56, 38.96s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [18:09<14:17, 38.96s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [18:48<13:38, 38.99s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [19:27<12:58, 38.95s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [20:06<12:19, 38.95s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [20:44<11:39, 38.87s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [21:21<10:50, 38.24s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [22:00<10:14, 38.39s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [22:39<09:38, 38.53s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [23:17<09:00, 38.64s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [23:56<08:22, 38.69s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [24:35<07:44, 38.74s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [25:14<07:05, 38.71s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [25:53<06:27, 38.74s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [26:31<05:48, 38.75s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [27:10<05:09, 38.75s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [27:49<04:31, 38.77s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [28:28<03:52, 38.76s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [29:06<03:13, 38.76s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [29:45<02:35, 38.79s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [30:24<01:56, 38.83s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [31:03<01:17, 38.85s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [31:42<00:38, 38.84s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [32:21<00:00, 38.92s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [32:21<00:00, 38.83s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 0.7203} | avg. gen lenth: 406.928
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i1-s1-rFalse --seed 1 --max-prompt-length 2048 --num-in-domain 1
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-21 17:00:13,256] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i1-s1-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 1
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i1-s1-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9740 [00:00<?, ?it/s]  3%|█▌                                                  | 285/9740 [00:00<00:03, 2846.36it/s]  6%|███                                                 | 575/9740 [00:00<00:03, 2876.85it/s]  9%|████▋                                               | 869/9740 [00:00<00:03, 2903.23it/s] 12%|██████                                             | 1164/9740 [00:00<00:02, 2919.22it/s] 15%|███████▋                                           | 1457/9740 [00:00<00:02, 2919.90it/s] 18%|█████████▏                                         | 1749/9740 [00:00<00:02, 2915.98it/s] 21%|██████████▋                                        | 2041/9740 [00:00<00:02, 2888.55it/s] 24%|████████████▏                                      | 2332/9740 [00:00<00:02, 2892.91it/s] 27%|█████████████▋                                     | 2622/9740 [00:00<00:02, 2854.94it/s] 30%|███████████████▏                                   | 2908/9740 [00:01<00:02, 2847.46it/s] 33%|████████████████▋                                  | 3196/9740 [00:01<00:02, 2854.78it/s] 36%|██████████████████▎                                | 3486/9740 [00:01<00:02, 2866.78it/s] 39%|███████████████████▊                               | 3777/9740 [00:01<00:02, 2877.27it/s] 42%|█████████████████████▎                             | 4069/9740 [00:01<00:01, 2889.89it/s] 45%|██████████████████████▊                            | 4361/9740 [00:01<00:01, 2895.76it/s] 48%|████████████████████████▎                          | 4651/9740 [00:01<00:01, 2867.23it/s] 51%|█████████████████████████▊                         | 4938/9740 [00:01<00:02, 2127.81it/s] 54%|███████████████████████████▎                       | 5223/9740 [00:01<00:01, 2300.01it/s] 57%|████████████████████████████▊                      | 5511/9740 [00:02<00:01, 2446.78it/s] 60%|██████████████████████████████▍                    | 5813/9740 [00:02<00:01, 2597.67it/s] 64%|████████████████████████████████▌                  | 6212/9740 [00:02<00:01, 2981.76it/s] 69%|██████████████████████████████████▉                | 6672/9740 [00:02<00:00, 3438.93it/s] 73%|█████████████████████████████████████▍             | 7142/9740 [00:02<00:00, 3800.85it/s] 78%|███████████████████████████████████████▋           | 7590/9740 [00:02<00:00, 3996.85it/s] 83%|██████████████████████████████████████████▏        | 8054/9740 [00:02<00:00, 4184.68it/s] 88%|████████████████████████████████████████████▋      | 8523/9740 [00:02<00:00, 4331.42it/s] 92%|███████████████████████████████████████████████    | 8989/9740 [00:02<00:00, 4426.73it/s] 97%|█████████████████████████████████████████████████▌ | 9456/9740 [00:02<00:00, 4497.20it/s]100%|███████████████████████████████████████████████████| 9740/9740 [00:02<00:00, 3252.72it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:04<00:09,  4.98s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.04s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.14s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.30s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.05s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.04s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.14s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.40s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.40s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.57s/it]
[2023-08-21 17:01:07,127] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.40s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.58s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.58s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.72s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.73s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.90s/it]
[2023-08-21 17:01:15,250] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-21 17:01:15,251] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-21 17:01:15,251] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-21 17:01:15,251] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-21 17:01:15,251] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-21 17:01:15,251] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-21 17:01:15,251] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-21 17:01:15,251] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-21 17:01:15,251] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-21 17:01:15,251] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-21 17:01:15,251] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f1a3db3afd0>
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f1a5d584220>
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-21 17:01:15,252] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-21 17:01:15,253] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-21 17:01:15,253] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-21 17:01:15,253] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-21 17:01:15,253] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.3190584182739258 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: A: oil refineries

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i1-s1-rFalse
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.20416903495788574 seconds
Time to load utils op: 0.20454883575439453 seconds
Loading extension module utils...
Time to load utils op: 0.3054530620574951 seconds
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:55<45:42, 55.97s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:51<44:30, 55.63s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [02:46<43:30, 55.55s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [03:41<42:21, 55.25s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [04:35<41:00, 54.69s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [05:22<38:21, 52.31s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [06:18<38:11, 53.29s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [07:13<37:47, 53.98s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [07:54<34:00, 49.76s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [08:49<34:12, 51.31s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [09:43<34:01, 52.35s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [10:39<33:43, 53.26s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [11:28<32:07, 52.10s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [12:22<31:36, 52.68s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [13:16<30:58, 53.09s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [14:11<30:28, 53.79s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [15:05<29:35, 53.81s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [16:00<28:54, 54.20s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [16:56<28:13, 54.61s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [17:42<26:01, 52.07s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [18:12<21:54, 45.34s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [19:07<22:29, 48.18s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [20:01<22:28, 49.94s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [20:55<22:13, 51.30s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [21:51<21:55, 52.62s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [22:46<21:18, 53.26s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [23:43<20:52, 54.44s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [24:39<20:10, 55.01s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [25:30<18:48, 53.74s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [26:25<18:03, 54.15s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [27:20<17:13, 54.41s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [28:16<16:26, 54.78s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [28:56<14:19, 50.55s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [29:50<13:45, 51.57s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [30:45<13:05, 52.38s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [31:40<12:25, 53.26s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [32:03<09:36, 44.32s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [32:58<09:30, 47.53s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [33:54<09:08, 49.89s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [34:49<08:35, 51.55s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [35:44<07:53, 52.60s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [36:38<07:04, 53.03s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [37:24<05:54, 50.71s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [38:19<05:12, 52.02s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [39:13<04:23, 52.71s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [39:55<03:17, 49.40s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [40:50<02:33, 51.20s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [41:45<01:44, 52.29s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [42:40<00:53, 53.20s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [43:35<00:00, 53.55s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [43:35<00:00, 52.30s/it]
name: commonsenseqa | {'exact_match': 0.8, 'rougeL': 3.5647} | avg. gen lenth: 288.272
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i2-s1-rFalse --seed 1 --max-prompt-length 2048 --num-in-domain 2
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-21 17:45:07,570] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i2-s1-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 2
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i2-s1-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9739 [00:00<?, ?it/s]  2%|█▏                                                  | 215/9739 [00:00<00:04, 2146.85it/s]  4%|██▎                                                 | 434/9739 [00:00<00:04, 2170.57it/s]  7%|███▍                                                | 654/9739 [00:00<00:04, 2178.63it/s]  9%|████▋                                               | 874/9739 [00:00<00:04, 2186.35it/s] 11%|█████▋                                             | 1095/9739 [00:00<00:03, 2192.29it/s] 14%|██████▉                                            | 1315/9739 [00:00<00:03, 2192.13it/s] 16%|████████                                           | 1535/9739 [00:00<00:03, 2191.30it/s] 18%|█████████▏                                         | 1756/9739 [00:00<00:03, 2196.29it/s] 20%|██████████▎                                        | 1976/9739 [00:00<00:03, 2132.77it/s] 23%|███████████▍                                       | 2192/9739 [00:01<00:03, 2138.29it/s] 25%|████████████▋                                      | 2411/9739 [00:01<00:03, 2152.34it/s] 27%|█████████████▊                                     | 2630/9739 [00:01<00:03, 2163.08it/s] 29%|██████████████▉                                    | 2847/9739 [00:01<00:03, 2164.96it/s] 31%|████████████████                                   | 3066/9739 [00:01<00:03, 2170.23it/s] 34%|█████████████████▏                                 | 3286/9739 [00:01<00:02, 2176.92it/s] 36%|██████████████████▎                                | 3504/9739 [00:01<00:02, 2175.17it/s] 38%|███████████████████▍                               | 3722/9739 [00:01<00:02, 2176.33it/s] 40%|████████████████████▋                              | 3942/9739 [00:01<00:02, 2182.37it/s] 43%|█████████████████████▊                             | 4161/9739 [00:01<00:02, 2176.82it/s] 45%|██████████████████████▉                            | 4379/9739 [00:02<00:02, 2171.97it/s] 47%|████████████████████████                           | 4597/9739 [00:02<00:02, 2144.45it/s] 49%|█████████████████████████▏                         | 4812/9739 [00:02<00:03, 1565.48it/s] 52%|██████████████████████████▎                        | 5031/9739 [00:02<00:02, 1711.95it/s] 54%|███████████████████████████▍                       | 5250/9739 [00:02<00:02, 1831.00it/s] 56%|████████████████████████████▋                      | 5469/9739 [00:02<00:02, 1924.69it/s] 59%|█████████████████████████████▉                     | 5728/9739 [00:02<00:01, 2106.84it/s] 62%|███████████████████████████████▊                   | 6079/9739 [00:02<00:01, 2500.29it/s] 66%|█████████████████████████████████▋                 | 6430/9739 [00:02<00:01, 2789.01it/s] 70%|███████████████████████████████████▌               | 6781/9739 [00:03<00:00, 2997.85it/s] 73%|█████████████████████████████████████▎             | 7136/9739 [00:03<00:00, 3159.07it/s] 77%|███████████████████████████████████████            | 7457/9739 [00:03<00:00, 3156.24it/s] 80%|████████████████████████████████████████▊          | 7805/9739 [00:03<00:00, 3249.49it/s] 84%|██████████████████████████████████████████▋        | 8156/9739 [00:03<00:00, 3325.69it/s] 87%|████████████████████████████████████████████▌      | 8508/9739 [00:03<00:00, 3382.78it/s] 91%|██████████████████████████████████████████████▍    | 8856/9739 [00:03<00:00, 3410.40it/s] 95%|████████████████████████████████████████████████▏  | 9208/9739 [00:03<00:00, 3441.12it/s] 98%|██████████████████████████████████████████████████ | 9559/9739 [00:03<00:00, 3461.38it/s]100%|███████████████████████████████████████████████████| 9739/9739 [00:03<00:00, 2496.10it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.03s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:04<00:09,  4.97s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.18s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.41s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.14s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.07s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.31s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.35s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.47s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.64s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.43s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.59s/it]
[2023-08-21 17:46:02,391] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.62s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.82s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.64s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.81s/it]
[2023-08-21 17:46:10,183] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-21 17:46:10,184] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-21 17:46:10,184] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-21 17:46:10,184] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-21 17:46:10,184] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-21 17:46:10,184] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fc822854fd0>
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7fc82547b220>
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-21 17:46:10,185] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-21 17:46:10,186] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-21 17:46:10,186] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-21 17:46:10,186] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-21 17:46:10,186] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-21 17:46:10,186] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-21 17:46:10,186] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-21 17:46:10,186] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-21 17:46:10,186] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-21 17:46:10,186] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-21 17:46:10,186] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-21 17:46:10,186] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-21 17:46:10,186] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-21 17:46:10,186] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-21 17:46:10,186] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-21 17:46:10,186] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.3527944087982178 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Output: D: accomplishing

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i2-s1-rFalse
Loading extension module utils...
Time to load utils op: 0.304354190826416 seconds
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.3043484687805176 seconds
Time to load utils op: 0.4045755863189697 seconds
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:56<45:47, 56.07s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:50<44:16, 55.34s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [02:44<42:43, 54.55s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [03:38<41:42, 54.40s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [04:33<40:53, 54.51s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [05:27<39:52, 54.37s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [06:22<39:07, 54.60s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [07:17<38:11, 54.55s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [08:10<37:07, 54.33s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [09:05<36:21, 54.54s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [10:01<35:40, 54.87s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [10:56<34:49, 54.98s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [11:50<33:46, 54.77s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [12:45<32:48, 54.67s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [13:40<31:52, 54.64s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [14:33<30:43, 54.23s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [15:23<29:13, 53.15s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [16:16<28:12, 52.90s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [17:11<27:38, 53.51s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [18:05<26:50, 53.68s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [18:59<26:06, 54.00s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [19:23<20:58, 44.96s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [20:17<21:24, 47.56s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [21:11<21:25, 49.44s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [22:05<21:13, 50.94s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [23:00<20:51, 52.16s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [23:55<20:15, 52.84s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [24:49<19:32, 53.31s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [25:43<18:42, 53.45s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [26:37<17:54, 53.73s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [27:32<17:04, 53.92s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [28:26<16:13, 54.10s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [28:59<13:30, 47.69s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [29:54<13:17, 49.87s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [30:48<12:49, 51.27s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [31:43<12:10, 52.18s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [32:19<10:17, 47.53s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [33:13<09:53, 49.46s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [34:08<09:21, 51.04s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [35:03<08:41, 52.14s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [35:27<06:32, 43.62s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [36:21<06:15, 46.89s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [37:15<05:43, 49.12s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [38:07<04:58, 49.78s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [38:55<04:06, 49.26s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [39:49<03:23, 50.80s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [40:43<02:35, 51.80s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [41:26<01:38, 49.06s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [42:21<00:50, 50.87s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [43:15<00:00, 51.82s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [43:15<00:00, 51.91s/it]
name: commonsenseqa | {'exact_match': 1.6, 'rougeL': 4.8188} | avg. gen lenth: 260.176
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i3-s1-rFalse --seed 1 --max-prompt-length 2048 --num-in-domain 3
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date![nltk_data]   Package punkt is already up-to-date!

[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-21 18:29:31,719] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i3-s1-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 3
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i3-s1-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9738 [00:00<?, ?it/s]  2%|▉                                                   | 179/9738 [00:00<00:05, 1781.19it/s]  4%|█▉                                                  | 359/9738 [00:00<00:05, 1788.33it/s]  6%|██▉                                                 | 540/9738 [00:00<00:05, 1796.93it/s]  7%|███▊                                                | 721/9738 [00:00<00:05, 1801.66it/s]  9%|████▊                                               | 903/9738 [00:00<00:04, 1805.60it/s] 11%|█████▋                                             | 1086/9738 [00:00<00:04, 1810.84it/s] 13%|██████▋                                            | 1268/9738 [00:00<00:04, 1809.72it/s] 15%|███████▌                                           | 1449/9738 [00:00<00:04, 1808.51it/s] 17%|████████▌                                          | 1630/9738 [00:00<00:04, 1764.43it/s] 19%|█████████▍                                         | 1807/9738 [00:01<00:04, 1739.76it/s] 20%|██████████▍                                        | 1987/9738 [00:01<00:04, 1757.08it/s] 22%|███████████▎                                       | 2167/9738 [00:01<00:04, 1769.70it/s] 24%|████████████▎                                      | 2348/9738 [00:01<00:04, 1780.81it/s] 26%|█████████████▏                                     | 2529/9738 [00:01<00:04, 1789.43it/s] 28%|██████████████▏                                    | 2709/9738 [00:01<00:03, 1776.23it/s] 30%|███████████████▏                                   | 2890/9738 [00:01<00:03, 1785.89it/s] 32%|████████████████                                   | 3070/9738 [00:01<00:03, 1789.34it/s] 33%|█████████████████                                  | 3252/9738 [00:01<00:03, 1797.66it/s] 35%|█████████████████▉                                 | 3432/9738 [00:01<00:03, 1792.45it/s] 37%|██████████████████▉                                | 3612/9738 [00:02<00:03, 1787.55it/s] 39%|███████████████████▊                               | 3794/9738 [00:02<00:03, 1794.83it/s] 41%|████████████████████▊                              | 3975/9738 [00:02<00:03, 1796.79it/s] 43%|█████████████████████▊                             | 4155/9738 [00:02<00:03, 1797.69it/s] 45%|██████████████████████▋                            | 4335/9738 [00:02<00:03, 1797.33it/s] 46%|███████████████████████▋                           | 4515/9738 [00:02<00:02, 1763.51it/s] 48%|████████████████████████▌                          | 4695/9738 [00:02<00:02, 1773.67it/s] 50%|█████████████████████████▌                         | 4873/9738 [00:02<00:03, 1279.42it/s] 52%|██████████████████████████▍                        | 5053/9738 [00:02<00:03, 1400.54it/s] 54%|███████████████████████████▍                       | 5233/9738 [00:03<00:03, 1500.15it/s] 56%|████████████████████████████▎                      | 5413/9738 [00:03<00:02, 1578.47it/s] 57%|█████████████████████████████▎                     | 5598/9738 [00:03<00:02, 1651.85it/s] 59%|██████████████████████████████▎                    | 5786/9738 [00:03<00:02, 1714.66it/s] 62%|███████████████████████████████▊                   | 6070/9738 [00:03<00:01, 2035.59it/s] 65%|█████████████████████████████████▎                 | 6356/9738 [00:03<00:01, 2272.52it/s] 68%|██████████████████████████████████▊                | 6643/9738 [00:03<00:01, 2445.90it/s] 71%|████████████████████████████████████▎              | 6930/9738 [00:03<00:01, 2569.81it/s] 74%|█████████████████████████████████████▊             | 7217/9738 [00:03<00:00, 2657.24it/s] 77%|███████████████████████████████████████▏           | 7488/9738 [00:03<00:00, 2671.15it/s] 80%|████████████████████████████████████████▋          | 7772/9738 [00:04<00:00, 2721.23it/s] 83%|██████████████████████████████████████████▏        | 8061/9738 [00:04<00:00, 2770.53it/s] 86%|███████████████████████████████████████████▋       | 8349/9738 [00:04<00:00, 2800.62it/s] 89%|█████████████████████████████████████████████▏     | 8632/9738 [00:04<00:00, 2807.80it/s] 92%|██████████████████████████████████████████████▋    | 8916/9738 [00:04<00:00, 2802.94it/s] 94%|████████████████████████████████████████████████▏  | 9199/9738 [00:04<00:00, 2810.86it/s] 97%|█████████████████████████████████████████████████▋ | 9485/9738 [00:04<00:00, 2819.75it/s]100%|███████████████████████████████████████████████████| 9738/9738 [00:04<00:00, 2048.07it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.48s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.20s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:11,  5.58s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:11,  5.58s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:04,  4.99s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.16s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.43s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.41s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.36s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.55s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.60s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.78s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.78s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.97s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.77s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.96s/it]
[2023-08-21 18:30:28,743] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
[2023-08-21 18:30:36,191] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-21 18:30:36,192] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-21 18:30:36,193] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-21 18:30:36,193] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-21 18:30:36,193] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-21 18:30:36,193] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-21 18:30:36,193] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-21 18:30:36,193] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-21 18:30:36,193] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-21 18:30:36,193] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-21 18:30:36,193] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-21 18:30:36,193] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f311c82ffd0>
[2023-08-21 18:30:36,193] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-21 18:30:36,193] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-21 18:30:36,193] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-21 18:30:36,193] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-21 18:30:36,193] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-21 18:30:36,193] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-21 18:30:36,193] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-21 18:30:36,193] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-21 18:30:36,193] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-21 18:30:36,193] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-21 18:30:36,193] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-21 18:30:36,193] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-21 18:30:36,193] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-21 18:30:36,193] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-21 18:30:36,193] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-21 18:30:36,193] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-21 18:30:36,193] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-21 18:30:36,193] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-21 18:30:36,193] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-21 18:30:36,193] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-21 18:30:36,193] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-21 18:30:36,194] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-21 18:30:36,194] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-21 18:30:36,194] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-21 18:30:36,194] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-21 18:30:36,194] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-21 18:30:36,194] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-21 18:30:36,194] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-21 18:30:36,194] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-21 18:30:36,194] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-21 18:30:36,194] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-21 18:30:36,194] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-21 18:30:36,194] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f311eaad220>
[2023-08-21 18:30:36,194] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-21 18:30:36,194] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-21 18:30:36,194] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-21 18:30:36,194] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-21 18:30:36,194] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-21 18:30:36,194] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-21 18:30:36,194] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-21 18:30:36,194] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-21 18:30:36,194] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-21 18:30:36,194] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-21 18:30:36,194] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-21 18:30:36,194] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-21 18:30:36,194] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-21 18:30:36,194] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-21 18:30:36,194] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-21 18:30:36,194] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-21 18:30:36,194] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-21 18:30:36,194] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-21 18:30:36,194] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-21 18:30:36,194] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-21 18:30:36,194] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-21 18:30:36,194] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-21 18:30:36,194] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.366959810256958 seconds
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.30445313453674316 seconds
Loading extension module utils...
Time to load utils op: 0.4044454097747803 seconds
Time to load utils op: 0.4044032096862793 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Output: D: accomplishing

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Output: A: office

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i3-s1-rFalse
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:50<40:54, 50.10s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:43<41:44, 52.18s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [02:36<41:08, 52.52s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [03:30<40:40, 53.05s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [04:23<39:45, 53.00s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [05:10<37:19, 50.89s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [06:04<37:10, 51.87s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [06:24<29:23, 41.99s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [07:18<31:08, 45.58s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [08:12<32:08, 48.21s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [09:05<32:13, 49.59s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [09:58<32:09, 50.78s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [10:45<30:28, 49.41s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [11:38<30:20, 50.58s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [12:31<30:02, 51.50s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [13:25<29:36, 52.26s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [14:19<28:59, 52.70s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [15:12<28:10, 52.83s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [15:57<26:03, 50.44s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [16:35<23:15, 46.50s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [17:28<23:30, 48.62s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [18:21<23:21, 50.04s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [19:15<22:58, 51.06s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [19:38<18:30, 42.72s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [20:32<19:10, 46.03s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [21:25<19:13, 48.08s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [22:16<18:51, 49.17s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [23:11<18:35, 50.71s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [24:05<18:04, 51.64s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [24:59<17:28, 52.44s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [25:52<16:40, 52.65s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [26:46<15:52, 52.90s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [27:39<15:04, 53.22s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [28:34<14:16, 53.51s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [28:58<11:12, 44.80s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [29:51<11:00, 47.21s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [30:46<10:43, 49.52s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [31:38<10:05, 50.45s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [32:32<09:23, 51.26s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [33:26<08:41, 52.17s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [33:42<06:13, 41.46s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [34:37<06:03, 45.38s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [34:55<04:20, 37.19s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [35:19<03:18, 33.17s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [36:12<03:16, 39.22s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [37:06<02:53, 43.49s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [37:59<02:19, 46.36s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [38:52<01:36, 48.46s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [39:47<00:50, 50.55s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [40:33<00:00, 49.09s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [40:33<00:00, 48.67s/it]
name: commonsenseqa | {'exact_match': 2.8, 'rougeL': 6.3862} | avg. gen lenth: 254.552
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i4-s1-rFalse --seed 1 --max-prompt-length 2048 --num-in-domain 4
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-21 19:12:25,768] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i4-s1-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 4
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i4-s1-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9737 [00:00<?, ?it/s]  2%|▊                                                   | 149/9737 [00:00<00:06, 1487.77it/s]  3%|█▌                                                  | 299/9737 [00:00<00:06, 1492.60it/s]  5%|██▍                                                 | 450/9737 [00:00<00:06, 1497.80it/s]  6%|███▏                                                | 601/9737 [00:00<00:06, 1502.51it/s]  8%|████                                                | 753/9737 [00:00<00:05, 1506.45it/s]  9%|████▊                                               | 905/9737 [00:00<00:05, 1510.91it/s] 11%|█████▌                                             | 1058/9737 [00:00<00:05, 1514.66it/s] 12%|██████▎                                            | 1210/9737 [00:00<00:05, 1483.19it/s] 14%|███████                                            | 1359/9737 [00:00<00:05, 1480.80it/s] 16%|███████▉                                           | 1510/9737 [00:01<00:05, 1487.64it/s] 17%|████████▋                                          | 1662/9737 [00:01<00:05, 1495.65it/s] 19%|█████████▍                                         | 1812/9737 [00:01<00:05, 1469.97it/s] 20%|██████████▎                                        | 1962/9737 [00:01<00:05, 1478.84it/s] 22%|███████████                                        | 2112/9737 [00:01<00:05, 1482.72it/s] 23%|███████████▊                                       | 2263/9737 [00:01<00:05, 1488.20it/s] 25%|████████████▋                                      | 2415/9737 [00:01<00:04, 1497.32it/s] 26%|█████████████▍                                     | 2565/9737 [00:01<00:04, 1497.27it/s] 28%|██████████████▍                                    | 2758/9737 [00:01<00:04, 1626.40it/s] 31%|███████████████▋                                   | 2986/9737 [00:01<00:03, 1820.70it/s] 33%|████████████████▊                                  | 3215/9737 [00:02<00:03, 1960.74it/s] 35%|██████████████████                                 | 3444/9737 [00:02<00:03, 2057.93it/s] 38%|███████████████████▏                               | 3673/9737 [00:02<00:02, 2126.07it/s] 40%|████████████████████▍                              | 3905/9737 [00:02<00:02, 2183.84it/s] 42%|█████████████████████▋                             | 4136/9737 [00:02<00:02, 2219.53it/s] 45%|██████████████████████▊                            | 4366/9737 [00:02<00:02, 2241.60it/s] 47%|████████████████████████                           | 4591/9737 [00:02<00:02, 2219.54it/s] 49%|█████████████████████████▏                         | 4814/9737 [00:02<00:02, 1751.39it/s] 52%|██████████████████████████▍                        | 5042/9737 [00:02<00:02, 1882.05it/s] 54%|███████████████████████████▌                       | 5270/9737 [00:03<00:02, 1986.32it/s] 56%|████████████████████████████▊                      | 5492/9737 [00:03<00:02, 2048.71it/s] 59%|██████████████████████████████                     | 5728/9737 [00:03<00:01, 2135.56it/s] 61%|███████████████████████████████▎                   | 5967/9737 [00:03<00:01, 2206.07it/s] 64%|████████████████████████████████▌                  | 6206/9737 [00:03<00:01, 2258.46it/s] 66%|█████████████████████████████████▊                 | 6445/9737 [00:03<00:01, 2294.19it/s] 69%|███████████████████████████████████                | 6683/9737 [00:03<00:01, 2318.93it/s] 71%|████████████████████████████████████▎              | 6924/9737 [00:03<00:01, 2343.91it/s] 74%|█████████████████████████████████████▌             | 7163/9737 [00:03<00:01, 2355.27it/s] 76%|██████████████████████████████████████▊            | 7403/9737 [00:03<00:00, 2366.49it/s] 78%|████████████████████████████████████████           | 7641/9737 [00:04<00:00, 2334.60it/s] 81%|█████████████████████████████████████████▎         | 7881/9737 [00:04<00:00, 2352.94it/s] 83%|██████████████████████████████████████████▌        | 8121/9737 [00:04<00:00, 2365.91it/s] 86%|███████████████████████████████████████████▊       | 8360/9737 [00:04<00:00, 2370.56it/s] 88%|█████████████████████████████████████████████      | 8598/9737 [00:04<00:00, 2350.79it/s] 91%|██████████████████████████████████████████████▎    | 8835/9737 [00:04<00:00, 2355.16it/s] 93%|███████████████████████████████████████████████▌   | 9074/9737 [00:04<00:00, 2363.46it/s] 96%|████████████████████████████████████████████████▊  | 9312/9737 [00:04<00:00, 2365.36it/s] 98%|██████████████████████████████████████████████████ | 9550/9737 [00:04<00:00, 2369.27it/s]100%|███████████████████████████████████████████████████| 9737/9737 [00:04<00:00, 1984.82it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.23s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.16s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.38s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:11,  5.51s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.35s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.27s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.27s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.48s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.55s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.73s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.62s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.80s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.78s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.97s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  5.20s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  5.23s/it]
[2023-08-21 19:13:23,505] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
[2023-08-21 19:13:33,102] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-21 19:13:33,103] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-21 19:13:33,103] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-21 19:13:33,103] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-21 19:13:33,103] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-21 19:13:33,103] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f215fd62fd0>
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f215f82d220>
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-21 19:13:33,104] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-21 19:13:33,105] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-21 19:13:33,105] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-21 19:13:33,105] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-21 19:13:33,105] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-21 19:13:33,105] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-21 19:13:33,105] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-21 19:13:33,105] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-21 19:13:33,105] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-21 19:13:33,105] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-21 19:13:33,105] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-21 19:13:33,105] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-21 19:13:33,105] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-21 19:13:33,105] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-21 19:13:33,105] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-21 19:13:33,105] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-21 19:13:33,105] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-21 19:13:33,105] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-21 19:13:33,105] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.3827197551727295 seconds
Loading extension module utils...
Time to load utils op: 0.30421018600463867 seconds
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.40418028831481934 seconds
Time to load utils op: 0.304502010345459 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Output: D: accomplishing

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Output: A: office

Input: Billy called out to John, and listened for what? Choices:  A: silence B: response C: communication D: hanging up E: whisper
Output: B: response

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i4-s1-rFalse
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:54<44:18, 54.25s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:46<42:38, 53.30s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [02:27<37:18, 47.64s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [03:21<38:15, 49.89s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [04:14<38:17, 51.05s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [04:57<35:24, 48.29s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [05:49<35:27, 49.48s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [06:41<35:10, 50.26s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [07:24<32:54, 48.16s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [08:16<32:56, 49.42s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [09:10<32:56, 50.67s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [10:03<32:37, 51.50s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [10:56<31:55, 51.77s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [11:26<27:09, 45.25s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [12:18<27:33, 47.25s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [13:11<27:46, 49.02s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [14:04<27:35, 50.17s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [14:56<27:06, 50.82s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [15:51<26:50, 51.95s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [16:42<25:56, 51.89s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [17:35<25:08, 52.03s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [18:28<24:26, 52.37s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [19:19<23:26, 52.08s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [20:11<22:30, 51.94s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [20:46<19:32, 46.90s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [21:38<19:24, 48.54s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [22:18<17:32, 45.77s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [22:42<14:26, 39.40s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [23:35<15:12, 43.48s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [24:26<15:14, 45.71s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [24:49<12:21, 39.00s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [25:43<13:00, 43.35s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [26:35<13:02, 46.00s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [27:27<12:43, 47.69s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [28:19<12:15, 49.02s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [29:10<11:36, 49.76s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [30:03<10:57, 50.57s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [30:54<10:08, 50.70s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [31:47<09:26, 51.50s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [32:40<08:39, 51.94s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [33:32<07:46, 51.89s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [34:09<06:20, 47.56s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [34:41<04:58, 42.62s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [35:33<04:33, 45.61s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [36:26<03:58, 47.75s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [37:19<03:17, 49.32s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [38:11<02:30, 50.09s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [39:03<01:41, 50.77s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [39:55<00:51, 51.25s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [40:38<00:00, 48.69s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [40:38<00:00, 48.77s/it]
name: commonsenseqa | {'exact_match': 3.2, 'rougeL': 6.0033} | avg. gen lenth: 275.34
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i5-s1-rFalse --seed 1 --max-prompt-length 2048 --num-in-domain 5
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-21 19:55:14,749] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i5-s1-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 5
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i5-s1-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9736 [00:00<?, ?it/s]  1%|▋                                                   | 128/9736 [00:00<00:07, 1278.19it/s]  3%|█▎                                                  | 256/9736 [00:00<00:07, 1279.12it/s]  4%|██                                                  | 386/9736 [00:00<00:07, 1286.88it/s]  5%|██▊                                                 | 515/9736 [00:00<00:07, 1287.65it/s]  7%|███▍                                                | 645/9736 [00:00<00:07, 1290.23it/s]  8%|████▏                                               | 775/9736 [00:00<00:06, 1291.77it/s]  9%|████▊                                               | 905/9736 [00:00<00:06, 1292.77it/s] 11%|█████▍                                             | 1035/9736 [00:00<00:06, 1292.14it/s] 12%|██████                                             | 1165/9736 [00:00<00:06, 1265.33it/s] 13%|██████▊                                            | 1294/9736 [00:01<00:06, 1270.98it/s] 15%|███████▍                                           | 1423/9736 [00:01<00:06, 1274.72it/s] 16%|████████▏                                          | 1553/9736 [00:01<00:06, 1279.87it/s] 17%|████████▊                                          | 1682/9736 [00:01<00:06, 1281.47it/s] 19%|█████████▍                                         | 1811/9736 [00:01<00:06, 1255.08it/s] 20%|██████████▏                                        | 1940/9736 [00:01<00:06, 1264.59it/s] 21%|██████████▊                                        | 2069/9736 [00:01<00:06, 1269.41it/s] 23%|███████████▌                                       | 2199/9736 [00:01<00:05, 1275.62it/s] 24%|████████████▏                                      | 2328/9736 [00:01<00:05, 1277.67it/s] 25%|████████████▊                                      | 2456/9736 [00:01<00:05, 1275.70it/s] 27%|█████████████▌                                     | 2584/9736 [00:02<00:05, 1272.48it/s] 28%|██████████████▏                                    | 2713/9736 [00:02<00:05, 1274.83it/s] 29%|██████████████▉                                    | 2842/9736 [00:02<00:05, 1277.70it/s] 31%|███████████████▌                                   | 2971/9736 [00:02<00:05, 1279.76it/s] 32%|████████████████▏                                  | 3100/9736 [00:02<00:05, 1281.91it/s] 33%|████████████████▉                                  | 3229/9736 [00:02<00:05, 1282.33it/s] 34%|█████████████████▌                                 | 3358/9736 [00:02<00:04, 1283.71it/s] 36%|██████████████████▎                                | 3506/9736 [00:02<00:04, 1340.51it/s] 38%|███████████████████▍                               | 3702/9736 [00:02<00:03, 1525.45it/s] 40%|████████████████████▍                              | 3899/9736 [00:02<00:03, 1656.75it/s] 42%|█████████████████████▍                             | 4095/9736 [00:03<00:03, 1747.01it/s] 44%|██████████████████████▍                            | 4290/9736 [00:03<00:03, 1807.33it/s] 46%|███████████████████████▍                           | 4480/9736 [00:03<00:02, 1832.82it/s] 48%|████████████████████████▍                          | 4664/9736 [00:03<00:02, 1818.77it/s] 50%|█████████████████████████▍                         | 4846/9736 [00:03<00:03, 1435.35it/s] 52%|██████████████████████████▍                        | 5042/9736 [00:03<00:02, 1566.02it/s] 54%|███████████████████████████▍                       | 5238/9736 [00:03<00:02, 1668.94it/s] 56%|████████████████████████████▍                      | 5433/9736 [00:03<00:02, 1744.44it/s] 58%|█████████████████████████████▌                     | 5635/9736 [00:03<00:02, 1821.62it/s] 60%|██████████████████████████████▌                    | 5841/9736 [00:04<00:02, 1887.69it/s] 62%|███████████████████████████████▋                   | 6047/9736 [00:04<00:01, 1935.14it/s] 64%|████████████████████████████████▋                  | 6251/9736 [00:04<00:01, 1964.39it/s] 66%|█████████████████████████████████▊                 | 6455/9736 [00:04<00:01, 1985.19it/s] 68%|██████████████████████████████████▊                | 6657/9736 [00:04<00:01, 1993.71it/s] 70%|███████████████████████████████████▉               | 6858/9736 [00:04<00:01, 1981.54it/s] 73%|████████████████████████████████████▉              | 7062/9736 [00:04<00:01, 1998.56it/s] 75%|██████████████████████████████████████             | 7266/9736 [00:04<00:01, 2010.65it/s] 77%|███████████████████████████████████████            | 7468/9736 [00:04<00:01, 1962.33it/s] 79%|████████████████████████████████████████▏          | 7671/9736 [00:04<00:01, 1981.11it/s] 81%|█████████████████████████████████████████▎         | 7876/9736 [00:05<00:00, 1998.58it/s] 83%|██████████████████████████████████████████▎        | 8081/9736 [00:05<00:00, 2011.77it/s] 85%|███████████████████████████████████████████▍       | 8287/9736 [00:05<00:00, 2023.87it/s] 87%|████████████████████████████████████████████▍      | 8492/9736 [00:05<00:00, 2031.40it/s] 89%|█████████████████████████████████████████████▌     | 8697/9736 [00:05<00:00, 2033.88it/s] 91%|██████████████████████████████████████████████▋    | 8901/9736 [00:05<00:00, 2031.82it/s] 94%|███████████████████████████████████████████████▋   | 9105/9736 [00:05<00:00, 2032.68it/s] 96%|████████████████████████████████████████████████▊  | 9309/9736 [00:05<00:00, 2034.20it/s] 98%|█████████████████████████████████████████████████▊ | 9513/9736 [00:05<00:00, 2032.04it/s]100%|██████████████████████████████████████████████████▉| 9717/9736 [00:05<00:00, 2028.91it/s]100%|███████████████████████████████████████████████████| 9736/9736 [00:05<00:00, 1636.56it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.41s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.43s/it]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.31s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.31s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:04<00:09,  4.99s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.19s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.70s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.87s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.71s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.88s/it]
Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:04,  5.00s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.09s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.37s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.56s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.41s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.58s/it]
[2023-08-21 19:56:18,496] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
[2023-08-21 19:56:25,335] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-21 19:56:25,336] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-21 19:56:25,336] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-21 19:56:25,336] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-21 19:56:25,336] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-21 19:56:25,336] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fe79da2bfd0>
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7fe77dc2f220>
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-21 19:56:25,337] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-21 19:56:25,338] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-21 19:56:25,338] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-21 19:56:25,338] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-21 19:56:25,338] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-21 19:56:25,338] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-21 19:56:25,338] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-21 19:56:25,338] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-21 19:56:25,338] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-21 19:56:25,338] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-21 19:56:25,338] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-21 19:56:25,338] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-21 19:56:25,338] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-21 19:56:25,338] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-21 19:56:25,338] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.34896063804626465 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Output: D: accomplishing

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Output: A: office

Input: Billy called out to John, and listened for what? Choices:  A: silence B: response C: communication D: hanging up E: whisper
Output: B: response

Input: The lizard frightened the hiker, it's movements made what rustle? Choices:  A: garden B: trees C: books D: rocks E: bushes
Output: E: bushes

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i5-s1-rFalse
Loading extension module utils...
Time to load utils op: 0.3044712543487549 seconds
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.3042330741882324 seconds
Time to load utils op: 0.4045383930206299 seconds
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:43<35:10, 43.08s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:09<26:39, 33.33s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [02:02<33:13, 42.40s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [02:54<35:24, 46.18s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [03:48<36:33, 48.74s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [04:39<36:30, 49.78s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [05:20<33:26, 46.67s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [06:11<33:47, 48.27s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [07:03<33:41, 49.30s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [07:55<33:28, 50.22s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [08:46<32:45, 50.39s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [09:37<32:04, 50.65s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [10:29<31:22, 50.88s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [10:58<26:37, 44.38s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [11:50<27:18, 46.82s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [12:43<27:32, 48.61s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [13:36<27:23, 49.79s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [14:22<25:59, 48.74s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [15:13<25:33, 49.46s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [16:04<25:00, 50.02s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [16:56<24:25, 50.55s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [17:49<23:51, 51.12s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [18:39<22:56, 51.00s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [19:31<22:07, 51.05s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [20:23<21:25, 51.44s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [21:14<20:35, 51.46s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [22:07<19:48, 51.66s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [22:58<18:53, 51.54s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [23:50<18:03, 51.61s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [24:42<17:14, 51.75s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [25:20<15:06, 47.69s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [25:43<12:06, 40.34s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [26:34<12:21, 43.63s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [27:26<12:18, 46.16s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [28:17<11:51, 47.42s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [29:08<11:18, 48.46s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [30:00<10:43, 49.52s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [30:52<10:03, 50.28s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [31:43<09:15, 50.47s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [32:35<08:29, 50.91s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [33:16<07:12, 48.09s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [33:34<05:12, 39.09s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [34:27<05:03, 43.32s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [35:18<04:33, 45.53s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [36:10<03:56, 47.40s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [36:58<03:11, 47.78s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [37:51<02:27, 49.32s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [38:43<01:40, 50.14s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [39:32<00:49, 49.55s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [40:23<00:00, 49.99s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [40:23<00:00, 48.46s/it]
name: commonsenseqa | {'exact_match': 2.8, 'rougeL': 5.7371} | avg. gen lenth: 270.784
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i6-s1-rFalse --seed 1 --max-prompt-length 2048 --num-in-domain 6
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-21 20:37:13,820] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i6-s1-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 6
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i6-s1-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9735 [00:00<?, ?it/s]  1%|▌                                                   | 109/9735 [00:00<00:08, 1082.96it/s]  2%|█▏                                                  | 218/9735 [00:00<00:08, 1084.78it/s]  3%|█▊                                                  | 328/9735 [00:00<00:08, 1088.73it/s]  4%|██▎                                                 | 437/9735 [00:00<00:08, 1087.19it/s]  6%|██▉                                                 | 547/9735 [00:00<00:08, 1089.80it/s]  7%|███▌                                                | 656/9735 [00:00<00:08, 1087.56it/s]  8%|████                                                | 766/9735 [00:00<00:08, 1090.86it/s]  9%|████▋                                               | 876/9735 [00:00<00:08, 1093.23it/s] 10%|█████▎                                              | 986/9735 [00:00<00:08, 1067.08it/s] 11%|█████▋                                             | 1096/9735 [00:01<00:08, 1075.70it/s] 12%|██████▎                                            | 1205/9735 [00:01<00:07, 1078.36it/s] 13%|██████▉                                            | 1314/9735 [00:01<00:07, 1080.11it/s] 15%|███████▍                                           | 1423/9735 [00:01<00:07, 1081.25it/s] 16%|████████                                           | 1533/9735 [00:01<00:07, 1084.12it/s] 17%|████████▌                                          | 1643/9735 [00:01<00:07, 1086.36it/s] 18%|█████████▏                                         | 1753/9735 [00:01<00:07, 1089.57it/s] 19%|█████████▊                                         | 1862/9735 [00:01<00:07, 1061.55it/s] 20%|██████████▎                                        | 1971/9735 [00:01<00:07, 1069.14it/s] 21%|██████████▉                                        | 2079/9735 [00:01<00:07, 1067.61it/s] 22%|███████████▍                                       | 2188/9735 [00:02<00:07, 1072.58it/s] 24%|████████████                                       | 2298/9735 [00:02<00:06, 1078.04it/s] 25%|████████████▊                                      | 2455/9735 [00:02<00:05, 1224.27it/s] 27%|█████████████▋                                     | 2621/9735 [00:02<00:05, 1354.02it/s] 29%|██████████████▌                                    | 2786/9735 [00:02<00:04, 1440.92it/s] 30%|███████████████▍                                   | 2953/9735 [00:02<00:04, 1507.66it/s] 32%|████████████████▎                                  | 3120/9735 [00:02<00:04, 1553.64it/s] 34%|█████████████████▏                                 | 3287/9735 [00:02<00:04, 1588.00it/s] 35%|██████████████████                                 | 3453/9735 [00:02<00:03, 1608.46it/s] 37%|██████████████████▉                                | 3619/9735 [00:02<00:03, 1621.05it/s] 39%|███████████████████▊                               | 3787/9735 [00:03<00:03, 1635.94it/s] 41%|████████████████████▋                              | 3954/9735 [00:03<00:03, 1643.60it/s] 42%|█████████████████████▌                             | 4119/9735 [00:03<00:03, 1635.39it/s] 44%|██████████████████████▍                            | 4286/9735 [00:03<00:03, 1644.78it/s] 46%|███████████████████████▎                           | 4453/9735 [00:03<00:03, 1649.49it/s] 47%|████████████████████████▏                          | 4618/9735 [00:03<00:03, 1612.84it/s] 49%|█████████████████████████                          | 4780/9735 [00:03<00:03, 1245.82it/s] 51%|█████████████████████████▉                         | 4946/9735 [00:03<00:03, 1344.92it/s] 53%|██████████████████████████▊                        | 5113/9735 [00:03<00:03, 1427.52it/s] 54%|███████████████████████████▋                       | 5279/9735 [00:04<00:02, 1490.05it/s] 56%|████████████████████████████▌                      | 5445/9735 [00:04<00:02, 1535.33it/s] 58%|█████████████████████████████▍                     | 5618/9735 [00:04<00:02, 1590.37it/s] 59%|██████████████████████████████▎                    | 5792/9735 [00:04<00:02, 1632.66it/s] 61%|███████████████████████████████▏                   | 5965/9735 [00:04<00:02, 1645.66it/s] 63%|████████████████████████████████▏                  | 6136/9735 [00:04<00:02, 1662.31it/s] 65%|█████████████████████████████████                  | 6308/9735 [00:04<00:02, 1673.82it/s] 67%|█████████████████████████████████▉                 | 6481/9735 [00:04<00:01, 1688.66it/s] 68%|██████████████████████████████████▊                | 6654/9735 [00:04<00:01, 1699.35it/s] 70%|███████████████████████████████████▊               | 6827/9735 [00:04<00:01, 1707.97it/s] 72%|████████████████████████████████████▋              | 7001/9735 [00:05<00:01, 1715.68it/s] 74%|█████████████████████████████████████▌             | 7175/9735 [00:05<00:01, 1721.52it/s] 75%|██████████████████████████████████████▌            | 7349/9735 [00:05<00:01, 1724.31it/s] 77%|███████████████████████████████████████▍           | 7522/9735 [00:05<00:01, 1679.00it/s] 79%|████████████████████████████████████████▎          | 7694/9735 [00:05<00:01, 1690.65it/s] 81%|█████████████████████████████████████████▏         | 7868/9735 [00:05<00:01, 1703.59it/s] 83%|██████████████████████████████████████████▏        | 8042/9735 [00:05<00:00, 1712.18it/s] 84%|███████████████████████████████████████████        | 8215/9735 [00:05<00:00, 1716.99it/s] 86%|███████████████████████████████████████████▉       | 8387/9735 [00:05<00:00, 1717.31it/s] 88%|████████████████████████████████████████████▊      | 8561/9735 [00:05<00:00, 1721.28it/s] 90%|█████████████████████████████████████████████▊     | 8734/9735 [00:06<00:00, 1722.14it/s] 91%|██████████████████████████████████████████████▋    | 8907/9735 [00:06<00:00, 1723.13it/s] 93%|███████████████████████████████████████████████▌   | 9080/9735 [00:06<00:00, 1721.84it/s] 95%|████████████████████████████████████████████████▍  | 9253/9735 [00:06<00:00, 1723.56it/s] 97%|█████████████████████████████████████████████████▍ | 9426/9735 [00:06<00:00, 1724.03it/s] 99%|██████████████████████████████████████████████████▎| 9599/9735 [00:06<00:00, 1723.54it/s]100%|███████████████████████████████████████████████████| 9735/9735 [00:06<00:00, 1465.21it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.02s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:11,  5.63s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:11,  5.67s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:06<00:13,  6.67s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.17s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:11<00:05,  5.69s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:11<00:05,  5.64s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:13<00:06,  6.72s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.56s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.71s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  5.15s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  5.29s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  5.07s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  5.23s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:18<00:00,  6.00s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:18<00:00,  6.19s/it]
[2023-08-21 20:38:16,431] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
[2023-08-21 20:38:33,439] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-21 20:38:33,440] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-21 20:38:33,440] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-21 20:38:33,440] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-21 20:38:33,440] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-21 20:38:33,441] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-21 20:38:33,441] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-21 20:38:33,441] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-21 20:38:33,441] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-21 20:38:33,441] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-21 20:38:33,441] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-21 20:38:33,441] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f94e5e18fd0>
[2023-08-21 20:38:33,441] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-21 20:38:33,441] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-21 20:38:33,441] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-21 20:38:33,441] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-21 20:38:33,441] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-21 20:38:33,441] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-21 20:38:33,441] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-21 20:38:33,441] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-21 20:38:33,441] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-21 20:38:33,441] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-21 20:38:33,441] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-21 20:38:33,441] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-21 20:38:33,441] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-21 20:38:33,441] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-21 20:38:33,441] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-21 20:38:33,441] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-21 20:38:33,441] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-21 20:38:33,441] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-21 20:38:33,441] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-21 20:38:33,441] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-21 20:38:33,441] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-21 20:38:33,441] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-21 20:38:33,441] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-21 20:38:33,441] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-21 20:38:33,441] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-21 20:38:33,441] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-21 20:38:33,441] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-21 20:38:33,442] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-21 20:38:33,442] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-21 20:38:33,442] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-21 20:38:33,442] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-21 20:38:33,442] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-21 20:38:33,442] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f94e58fb220>
[2023-08-21 20:38:33,442] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-21 20:38:33,442] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-21 20:38:33,442] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-21 20:38:33,442] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-21 20:38:33,442] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-21 20:38:33,442] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-21 20:38:33,442] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-21 20:38:33,442] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-21 20:38:33,442] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-21 20:38:33,442] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-21 20:38:33,442] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-21 20:38:33,442] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-21 20:38:33,442] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-21 20:38:33,442] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-21 20:38:33,442] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-21 20:38:33,442] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-21 20:38:33,442] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-21 20:38:33,442] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-21 20:38:33,442] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-21 20:38:33,442] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-21 20:38:33,442] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-21 20:38:33,442] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-21 20:38:33,442] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.4344470500946045 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Output: D: accomplishing

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Output: A: office

Input: Billy called out to John, and listened for what? Choices:  A: silence B: response C: communication D: hanging up E: whisper
Output: B: response

Input: The lizard frightened the hiker, it's movements made what rustle? Choices:  A: garden B: trees C: books D: rocks E: bushes
Output: E: bushes

Input: The man spent big money and time maintaining his lawn, it was part of keeping up with the Joneses where? Choices:  A: front yard B: suburbia C: neighborhood D: back yard E: golf course
Output: B: suburbia

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i6-s1-rFalse
Loading extension module utils...
Time to load utils op: 0.40474867820739746 seconds
Loading extension module utils...
Time to load utils op: 0.40476250648498535 seconds
Loading extension module utils...
Time to load utils op: 0.4048731327056885 seconds
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:52<43:13, 52.94s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:44<41:33, 51.94s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [02:34<40:01, 51.10s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [03:23<38:42, 50.49s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [04:15<38:11, 50.93s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [05:06<37:19, 50.89s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [05:57<36:30, 50.95s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [06:47<35:31, 50.76s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [07:37<34:30, 50.51s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [08:29<33:56, 50.91s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [09:20<33:09, 51.00s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [10:12<32:23, 51.14s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [10:39<27:02, 43.85s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [11:30<27:35, 46.00s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [12:21<27:42, 47.49s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [13:11<27:26, 48.42s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [14:03<27:06, 49.29s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [14:53<26:30, 49.70s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [15:33<24:07, 46.68s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [16:24<23:59, 47.97s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [17:15<23:42, 49.06s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [18:06<23:05, 49.50s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [18:57<22:26, 49.87s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [19:43<21:05, 48.67s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [20:34<20:35, 49.42s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [21:25<20:02, 50.09s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [22:17<19:24, 50.64s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [23:08<18:31, 50.52s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [23:58<17:42, 50.61s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [24:49<16:51, 50.55s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [25:40<16:02, 50.68s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [26:32<15:18, 51.02s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [27:23<14:27, 51.01s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [28:13<13:31, 50.72s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [28:47<11:28, 45.92s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [29:38<11:03, 47.42s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [30:29<10:29, 48.39s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [31:13<09:23, 47.00s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [32:03<08:47, 47.99s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [32:54<08:09, 48.92s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [33:46<07:28, 49.80s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [34:37<06:41, 50.20s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [35:27<05:49, 49.99s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [36:17<05:00, 50.10s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [37:08<04:11, 50.36s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [37:59<03:22, 50.52s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [38:50<02:32, 50.87s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [39:42<01:42, 51.02s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [40:31<00:50, 50.52s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [41:21<00:00, 50.31s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [41:21<00:00, 49.63s/it]
name: commonsenseqa | {'exact_match': 2.8, 'rougeL': 5.1581} | avg. gen lenth: 290.052
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i7-s1-rFalse --seed 1 --max-prompt-length 2048 --num-in-domain 7
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-21 21:20:02,827] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i7-s1-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 7
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i7-s1-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9734 [00:00<?, ?it/s]  1%|▊                                                   | 145/9734 [00:00<00:06, 1441.85it/s]  3%|█▌                                                  | 290/9734 [00:00<00:06, 1438.85it/s]  4%|██▎                                                 | 435/9734 [00:00<00:06, 1440.64it/s]  6%|███                                                 | 581/9734 [00:00<00:06, 1447.23it/s]  7%|███▉                                                | 726/9734 [00:00<00:06, 1440.90it/s]  9%|████▋                                               | 872/9734 [00:00<00:06, 1445.31it/s] 10%|█████▎                                             | 1017/9734 [00:00<00:06, 1444.01it/s] 12%|██████                                             | 1162/9734 [00:00<00:06, 1285.67it/s] 13%|██████▊                                            | 1294/9734 [00:00<00:07, 1155.93it/s] 15%|███████▍                                           | 1414/9734 [00:01<00:07, 1084.75it/s] 16%|███████▉                                           | 1526/9734 [00:01<00:07, 1044.41it/s] 17%|████████▌                                          | 1633/9734 [00:01<00:07, 1015.22it/s] 18%|█████████▎                                          | 1736/9734 [00:01<00:08, 996.35it/s] 19%|█████████▊                                          | 1837/9734 [00:01<00:08, 923.82it/s] 20%|██████████▎                                         | 1932/9734 [00:01<00:08, 929.49it/s] 21%|██████████▊                                         | 2026/9734 [00:01<00:08, 931.65it/s] 22%|███████████▎                                        | 2120/9734 [00:01<00:08, 930.88it/s] 23%|███████████▊                                        | 2216/9734 [00:01<00:08, 937.67it/s] 24%|████████████▎                                       | 2311/9734 [00:02<00:07, 937.66it/s] 25%|████████████▊                                       | 2407/9734 [00:02<00:07, 943.18it/s] 26%|█████████████▎                                      | 2502/9734 [00:02<00:07, 943.04it/s] 27%|█████████████▊                                      | 2597/9734 [00:02<00:07, 944.83it/s] 28%|██████████████▍                                     | 2692/9734 [00:02<00:07, 944.28it/s] 29%|██████████████▉                                     | 2787/9734 [00:02<00:07, 941.08it/s] 30%|███████████████▍                                    | 2883/9734 [00:02<00:07, 944.11it/s] 31%|███████████████▉                                    | 2987/9734 [00:02<00:06, 972.37it/s] 32%|████████████████▍                                  | 3132/9734 [00:02<00:05, 1112.80it/s] 34%|█████████████████▏                                 | 3277/9734 [00:02<00:05, 1211.19it/s] 35%|█████████████████▉                                 | 3421/9734 [00:03<00:04, 1279.19it/s] 37%|██████████████████▋                                | 3565/9734 [00:03<00:04, 1326.11it/s] 38%|███████████████████▍                               | 3709/9734 [00:03<00:04, 1358.82it/s] 40%|████████████████████▏                              | 3853/9734 [00:03<00:04, 1380.71it/s] 41%|████████████████████▉                              | 3998/9734 [00:03<00:04, 1399.40it/s] 43%|█████████████████████▋                             | 4142/9734 [00:03<00:03, 1411.25it/s] 44%|██████████████████████▍                            | 4287/9734 [00:03<00:03, 1421.44it/s] 46%|███████████████████████▏                           | 4430/9734 [00:03<00:03, 1423.67it/s] 47%|███████████████████████▉                           | 4573/9734 [00:03<00:03, 1391.81it/s] 48%|████████████████████████▋                          | 4717/9734 [00:04<00:03, 1404.81it/s] 50%|█████████████████████████▍                         | 4858/9734 [00:04<00:04, 1148.09it/s] 51%|██████████████████████████▏                        | 5001/9734 [00:04<00:03, 1219.69it/s] 53%|██████████████████████████▉                        | 5145/9734 [00:04<00:03, 1277.99it/s] 54%|███████████████████████████▋                       | 5284/9734 [00:04<00:03, 1308.33it/s] 56%|████████████████████████████▍                      | 5427/9734 [00:04<00:03, 1341.53it/s] 57%|█████████████████████████████▏                     | 5571/9734 [00:04<00:03, 1368.95it/s] 59%|█████████████████████████████▉                     | 5720/9734 [00:04<00:02, 1402.67it/s] 60%|██████████████████████████████▋                    | 5869/9734 [00:04<00:02, 1425.57it/s] 62%|███████████████████████████████▌                   | 6018/9734 [00:04<00:02, 1443.04it/s] 63%|████████████████████████████████▎                  | 6166/9734 [00:05<00:02, 1451.63it/s] 65%|█████████████████████████████████                  | 6315/9734 [00:05<00:02, 1460.35it/s] 66%|█████████████████████████████████▊                 | 6462/9734 [00:05<00:02, 1462.51it/s] 68%|██████████████████████████████████▋                | 6611/9734 [00:05<00:02, 1469.89it/s] 69%|███████████████████████████████████▍               | 6761/9734 [00:05<00:02, 1478.85it/s] 71%|████████████████████████████████████▏              | 6910/9734 [00:05<00:01, 1478.84it/s] 73%|████████████████████████████████████▉              | 7060/9734 [00:05<00:01, 1483.98it/s] 74%|█████████████████████████████████████▊             | 7209/9734 [00:05<00:01, 1470.46it/s] 76%|██████████████████████████████████████▌            | 7357/9734 [00:05<00:01, 1470.59it/s] 77%|███████████████████████████████████████▎           | 7505/9734 [00:06<00:01, 1416.59it/s] 79%|████████████████████████████████████████           | 7654/9734 [00:06<00:01, 1437.52it/s] 80%|████████████████████████████████████████▉          | 7802/9734 [00:06<00:01, 1449.37it/s] 82%|█████████████████████████████████████████▋         | 7952/9734 [00:06<00:01, 1463.35it/s] 83%|██████████████████████████████████████████▍        | 8103/9734 [00:06<00:01, 1476.20it/s] 85%|███████████████████████████████████████████▏       | 8252/9734 [00:06<00:01, 1477.56it/s] 86%|████████████████████████████████████████████       | 8401/9734 [00:06<00:00, 1478.88it/s] 88%|████████████████████████████████████████████▊      | 8549/9734 [00:06<00:00, 1475.46it/s] 89%|█████████████████████████████████████████████▌     | 8697/9734 [00:06<00:00, 1473.52it/s] 91%|██████████████████████████████████████████████▎    | 8847/9734 [00:06<00:00, 1481.08it/s] 92%|███████████████████████████████████████████████▏   | 8997/9734 [00:07<00:00, 1486.31it/s] 94%|███████████████████████████████████████████████▉   | 9146/9734 [00:07<00:00, 1471.86it/s] 96%|████████████████████████████████████████████████▋  | 9296/9734 [00:07<00:00, 1478.02it/s] 97%|█████████████████████████████████████████████████▍ | 9447/9734 [00:07<00:00, 1486.27it/s] 99%|██████████████████████████████████████████████████▎| 9596/9734 [00:07<00:00, 1480.91it/s]100%|███████████████████████████████████████████████████| 9734/9734 [00:07<00:00, 1296.68it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.14s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.08s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.16s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.41s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.05s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.05s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.23s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.43s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.36s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.55s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.47s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.64s/it]
[2023-08-21 21:21:01,616] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.78s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.89s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.82s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.98s/it]
[2023-08-21 21:21:10,909] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-21 21:21:10,910] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-21 21:21:10,911] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-21 21:21:10,911] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-21 21:21:10,911] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-21 21:21:10,911] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-21 21:21:10,911] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-21 21:21:10,911] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-21 21:21:10,911] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-21 21:21:10,911] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-21 21:21:10,911] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-21 21:21:10,911] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f3e9b9dffd0>
[2023-08-21 21:21:10,911] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-21 21:21:10,911] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-21 21:21:10,911] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-21 21:21:10,911] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-21 21:21:10,911] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-21 21:21:10,911] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-21 21:21:10,912] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-21 21:21:10,912] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-21 21:21:10,912] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-21 21:21:10,912] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-21 21:21:10,912] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-21 21:21:10,912] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-21 21:21:10,912] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-21 21:21:10,912] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-21 21:21:10,912] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-21 21:21:10,912] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-21 21:21:10,912] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-21 21:21:10,912] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-21 21:21:10,912] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-21 21:21:10,912] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-21 21:21:10,912] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-21 21:21:10,912] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-21 21:21:10,912] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-21 21:21:10,912] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-21 21:21:10,912] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-21 21:21:10,912] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-21 21:21:10,912] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-21 21:21:10,912] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-21 21:21:10,912] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-21 21:21:10,912] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-21 21:21:10,912] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-21 21:21:10,912] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-21 21:21:10,912] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f3e98a8a220>
[2023-08-21 21:21:10,912] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-21 21:21:10,912] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-21 21:21:10,912] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-21 21:21:10,912] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-21 21:21:10,912] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-21 21:21:10,912] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-21 21:21:10,912] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-21 21:21:10,912] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-21 21:21:10,912] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-21 21:21:10,913] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-21 21:21:10,913] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-21 21:21:10,913] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-21 21:21:10,913] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-21 21:21:10,913] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-21 21:21:10,913] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-21 21:21:10,913] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-21 21:21:10,913] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-21 21:21:10,913] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-21 21:21:10,913] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-21 21:21:10,913] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-21 21:21:10,913] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-21 21:21:10,913] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-21 21:21:10,913] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.39855051040649414 seconds
Time to load utils op: 0.30412936210632324 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Output: D: accomplishing

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Output: A: office

Input: Billy called out to John, and listened for what? Choices:  A: silence B: response C: communication D: hanging up E: whisper
Output: B: response

Input: The lizard frightened the hiker, it's movements made what rustle? Choices:  A: garden B: trees C: books D: rocks E: bushes
Output: E: bushes

Input: The man spent big money and time maintaining his lawn, it was part of keeping up with the Joneses where? Choices:  A: front yard B: suburbia C: neighborhood D: back yard E: golf course
Output: B: suburbia

Input: What would a human do if they want to get to a store that he or she can see? Choices:  A: cross road B: see around C: drink coffee D: dream dreams E: think critically
Output: A: cross road

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i7-s1-rFalse
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.404632568359375 seconds
Time to load utils op: 0.40460634231567383 seconds
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:51<41:50, 51.23s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:41<40:33, 50.69s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [02:31<39:35, 50.55s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [02:58<31:36, 41.23s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [03:44<31:59, 42.65s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [04:33<33:03, 45.08s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [05:23<33:27, 46.69s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [06:12<33:11, 47.41s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [07:01<32:43, 47.90s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [07:50<32:10, 48.25s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [08:40<31:41, 48.75s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [09:30<31:00, 48.97s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [10:19<30:20, 49.21s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [11:09<29:35, 49.32s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [11:59<28:52, 49.50s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [12:49<28:10, 49.73s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [13:39<27:25, 49.85s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [14:08<23:16, 43.65s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [14:58<23:25, 45.34s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [15:47<23:13, 46.46s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [16:35<22:45, 47.07s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [17:23<22:06, 47.39s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [18:12<21:31, 47.84s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [18:46<18:53, 43.61s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [19:37<19:06, 45.85s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [20:28<18:53, 47.25s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [21:17<18:19, 47.78s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [22:06<17:43, 48.33s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [22:48<16:12, 46.32s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [23:37<15:43, 47.15s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [24:27<15:09, 47.85s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [25:07<13:38, 45.50s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [25:56<13:13, 46.68s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [26:47<12:47, 47.95s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [27:36<12:02, 48.14s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [28:25<11:20, 48.63s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [29:15<10:36, 48.93s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [30:05<09:49, 49.13s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [30:54<09:02, 49.34s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [31:44<08:14, 49.46s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [32:33<07:24, 49.41s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [33:23<06:36, 49.52s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [34:13<05:46, 49.57s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [35:03<04:58, 49.73s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [35:53<04:08, 49.70s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [36:43<03:19, 49.87s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [37:32<02:28, 49.66s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [38:21<01:39, 49.51s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [39:10<00:49, 49.31s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [39:51<00:00, 46.97s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [39:51<00:00, 47.84s/it]
name: commonsenseqa | {'exact_match': 2.0, 'rougeL': 4.6633} | avg. gen lenth: 296.48
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i8-s1-rFalse --seed 1 --max-prompt-length 2048 --num-in-domain 8
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-21 22:01:51,766] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i8-s1-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 8
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i8-s1-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9733 [00:00<?, ?it/s]  1%|▍                                                     | 87/9733 [00:00<00:11, 861.80it/s]  2%|▉                                                    | 174/9733 [00:00<00:11, 863.90it/s]  3%|█▍                                                   | 261/9733 [00:00<00:11, 860.96it/s]  4%|█▉                                                   | 348/9733 [00:00<00:10, 862.95it/s]  4%|██▎                                                  | 435/9733 [00:00<00:10, 861.18it/s]  5%|██▊                                                  | 522/9733 [00:00<00:10, 862.85it/s]  6%|███▎                                                 | 609/9733 [00:00<00:10, 861.99it/s]  7%|███▊                                                 | 696/9733 [00:00<00:10, 840.81it/s]  8%|████▎                                                | 782/9733 [00:00<00:10, 845.84it/s]  9%|████▋                                                | 869/9733 [00:01<00:10, 851.35it/s] 10%|█████▏                                               | 955/9733 [00:01<00:10, 853.07it/s] 11%|█████▌                                              | 1042/9733 [00:01<00:10, 856.69it/s] 12%|██████                                              | 1128/9733 [00:01<00:10, 857.58it/s] 12%|██████▍                                             | 1215/9733 [00:01<00:09, 858.76it/s] 13%|██████▉                                             | 1302/9733 [00:01<00:09, 860.28it/s] 14%|███████▍                                            | 1389/9733 [00:01<00:09, 857.76it/s] 15%|███████▉                                            | 1476/9733 [00:01<00:09, 859.59it/s] 16%|████████▎                                           | 1562/9733 [00:01<00:09, 856.22it/s] 17%|████████▊                                           | 1648/9733 [00:01<00:09, 855.22it/s] 18%|█████████▎                                          | 1735/9733 [00:02<00:09, 858.00it/s] 19%|█████████▋                                          | 1821/9733 [00:02<00:09, 836.17it/s] 20%|██████████▏                                         | 1908/9733 [00:02<00:09, 844.24it/s] 21%|██████████▊                                         | 2031/9733 [00:02<00:08, 957.27it/s] 22%|███████████▎                                       | 2163/9733 [00:02<00:07, 1062.58it/s] 24%|████████████                                       | 2294/9733 [00:02<00:06, 1133.51it/s] 25%|████████████▋                                      | 2426/9733 [00:02<00:06, 1187.07it/s] 26%|█████████████▍                                     | 2557/9733 [00:02<00:05, 1221.65it/s] 28%|██████████████                                     | 2688/9733 [00:02<00:05, 1247.84it/s] 29%|██████████████▊                                    | 2818/9733 [00:02<00:05, 1262.17it/s] 30%|███████████████▍                                   | 2949/9733 [00:03<00:05, 1274.44it/s] 32%|████████████████                                   | 3077/9733 [00:03<00:05, 1273.80it/s] 33%|████████████████▊                                  | 3208/9733 [00:03<00:05, 1283.60it/s] 34%|█████████████████▌                                 | 3340/9733 [00:03<00:04, 1293.19it/s] 36%|██████████████████▏                                | 3470/9733 [00:03<00:04, 1294.15it/s] 37%|██████████████████▊                                | 3602/9733 [00:03<00:04, 1299.94it/s] 38%|███████████████████▌                               | 3733/9733 [00:03<00:04, 1301.52it/s] 40%|████████████████████▎                              | 3865/9733 [00:03<00:04, 1304.70it/s] 41%|████████████████████▉                              | 3997/9733 [00:03<00:04, 1308.36it/s] 42%|█████████████████████▋                             | 4128/9733 [00:03<00:04, 1306.65it/s] 44%|██████████████████████▎                            | 4260/9733 [00:04<00:04, 1309.76it/s] 45%|███████████████████████                            | 4391/9733 [00:04<00:04, 1309.57it/s] 46%|███████████████████████▋                           | 4522/9733 [00:04<00:04, 1271.55it/s] 48%|████████████████████████▍                          | 4654/9733 [00:04<00:03, 1284.67it/s] 49%|█████████████████████████▌                          | 4783/9733 [00:04<00:05, 942.26it/s] 50%|█████████████████████████▊                         | 4915/9733 [00:04<00:04, 1030.16it/s] 52%|██████████████████████████▍                        | 5046/9733 [00:04<00:04, 1099.32it/s] 53%|███████████████████████████▏                       | 5177/9733 [00:04<00:03, 1154.15it/s] 55%|███████████████████████████▊                       | 5308/9733 [00:04<00:03, 1196.76it/s] 56%|████████████████████████████▍                      | 5438/9733 [00:05<00:03, 1225.27it/s] 57%|█████████████████████████████▏                     | 5574/9733 [00:05<00:03, 1262.51it/s] 59%|█████████████████████████████▉                     | 5710/9733 [00:05<00:03, 1288.30it/s] 60%|██████████████████████████████▋                    | 5847/9733 [00:05<00:02, 1311.01it/s] 61%|███████████████████████████████▎                   | 5983/9733 [00:05<00:02, 1325.22it/s] 63%|████████████████████████████████                   | 6119/9733 [00:05<00:02, 1333.74it/s] 64%|████████████████████████████████▊                  | 6256/9733 [00:05<00:02, 1342.40it/s] 66%|█████████████████████████████████▍                 | 6391/9733 [00:05<00:02, 1337.22it/s] 67%|██████████████████████████████████▏                | 6527/9733 [00:05<00:02, 1341.94it/s] 68%|██████████████████████████████████▉                | 6662/9733 [00:05<00:02, 1344.07it/s] 70%|███████████████████████████████████▌               | 6798/9733 [00:06<00:02, 1347.24it/s] 71%|████████████████████████████████████▎              | 6935/9733 [00:06<00:02, 1353.70it/s] 73%|█████████████████████████████████████              | 7071/9733 [00:06<00:01, 1352.57it/s] 74%|█████████████████████████████████████▊             | 7208/9733 [00:06<00:01, 1357.08it/s] 75%|██████████████████████████████████████▍            | 7344/9733 [00:06<00:01, 1356.00it/s] 77%|███████████████████████████████████████▏           | 7480/9733 [00:06<00:01, 1322.00it/s] 78%|███████████████████████████████████████▉           | 7616/9733 [00:06<00:01, 1332.12it/s] 80%|████████████████████████████████████████▌          | 7752/9733 [00:06<00:01, 1338.08it/s] 81%|█████████████████████████████████████████▎         | 7889/9733 [00:06<00:01, 1345.52it/s] 82%|██████████████████████████████████████████         | 8024/9733 [00:06<00:01, 1345.33it/s] 84%|██████████████████████████████████████████▊        | 8160/9733 [00:07<00:01, 1347.04it/s] 85%|███████████████████████████████████████████▍       | 8296/9733 [00:07<00:01, 1350.04it/s] 87%|████████████████████████████████████████████▏      | 8432/9733 [00:07<00:00, 1352.38it/s] 88%|████████████████████████████████████████████▉      | 8568/9733 [00:07<00:00, 1348.34it/s] 89%|█████████████████████████████████████████████▌     | 8703/9733 [00:07<00:00, 1344.86it/s] 91%|██████████████████████████████████████████████▎    | 8838/9733 [00:07<00:00, 1344.13it/s] 92%|███████████████████████████████████████████████    | 8974/9733 [00:07<00:00, 1348.41it/s] 94%|███████████████████████████████████████████████▋   | 9109/9733 [00:07<00:00, 1346.99it/s] 95%|████████████████████████████████████████████████▍  | 9245/9733 [00:07<00:00, 1349.17it/s] 96%|█████████████████████████████████████████████████▏ | 9381/9733 [00:08<00:00, 1350.07it/s] 98%|█████████████████████████████████████████████████▊ | 9517/9733 [00:08<00:00, 1346.81it/s] 99%|██████████████████████████████████████████████████▌| 9653/9733 [00:08<00:00, 1348.49it/s]100%|███████████████████████████████████████████████████| 9733/9733 [00:08<00:00, 1177.90it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.36s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.23s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.18s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:11,  5.66s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.37s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.12s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.35s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.25s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.49s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.67s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.68s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.86s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.64s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.82s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.53s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.77s/it]
[2023-08-21 22:02:51,738] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
[2023-08-21 22:02:59,056] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-21 22:02:59,057] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-21 22:02:59,057] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-21 22:02:59,057] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-21 22:02:59,057] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-21 22:02:59,057] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f5e09275fd0>
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f5de7efb220>
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-21 22:02:59,058] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-21 22:02:59,059] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-21 22:02:59,059] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-21 22:02:59,059] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-21 22:02:59,059] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-21 22:02:59,059] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-21 22:02:59,059] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-21 22:02:59,059] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-21 22:02:59,059] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-21 22:02:59,059] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-21 22:02:59,059] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-21 22:02:59,059] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-21 22:02:59,059] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-21 22:02:59,059] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-21 22:02:59,059] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-21 22:02:59,059] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-21 22:02:59,059] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-21 22:02:59,059] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.36350393295288086 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Output: D: accomplishing

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Output: A: office

Input: Billy called out to John, and listened for what? Choices:  A: silence B: response C: communication D: hanging up E: whisper
Output: B: response

Input: The lizard frightened the hiker, it's movements made what rustle? Choices:  A: garden B: trees C: books D: rocks E: bushes
Output: E: bushes

Input: The man spent big money and time maintaining his lawn, it was part of keeping up with the Joneses where? Choices:  A: front yard B: suburbia C: neighborhood D: back yard E: golf course
Output: B: suburbia

Input: What would a human do if they want to get to a store that he or she can see? Choices:  A: cross road B: see around C: drink coffee D: dream dreams E: think critically
Output: A: cross road

Input: Where would you grab an object contained by a doorway? Choices:  A: television B: control panel C: opening doors D: doorknob E: doorway
Output: E: doorway

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i8-s1-rFalse
Loading extension module utils...
Time to load utils op: 0.4046595096588135 seconds
Loading extension module utils...
Time to load utils op: 0.4046170711517334 seconds
Loading extension module utils...
Time to load utils op: 0.3045666217803955 seconds
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:50<40:55, 50.12s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:39<39:36, 49.52s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [02:27<38:10, 48.74s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [03:12<36:28, 47.57s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [04:01<35:58, 47.97s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [04:50<35:26, 48.32s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [05:38<34:34, 48.24s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [06:27<33:52, 48.40s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [07:16<33:17, 48.71s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [08:05<32:32, 48.81s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [08:54<31:42, 48.79s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [09:43<31:01, 48.98s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [10:32<30:03, 48.73s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [11:20<29:07, 48.54s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [12:08<28:16, 48.49s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [12:57<27:36, 48.71s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [13:46<26:46, 48.68s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [14:35<26:06, 48.94s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [15:25<25:20, 49.05s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [16:14<24:31, 49.03s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [17:01<23:29, 48.62s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [17:51<22:45, 48.78s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [18:39<21:56, 48.75s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [19:13<19:10, 44.27s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [20:01<18:58, 45.53s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [20:48<18:23, 45.97s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [21:37<17:53, 46.69s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [22:25<17:14, 47.04s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [23:03<15:33, 44.45s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [23:52<15:16, 45.83s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [24:42<14:52, 46.96s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [25:31<14:19, 47.75s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [26:20<13:37, 48.07s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [27:09<12:52, 48.30s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [27:57<12:04, 48.28s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [28:46<11:16, 48.32s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [29:15<09:12, 42.52s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [30:05<08:57, 44.81s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [30:54<08:28, 46.26s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [31:43<07:50, 47.08s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [32:32<07:08, 47.57s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [33:22<06:25, 48.21s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [34:11<05:39, 48.48s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [35:00<04:51, 48.64s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [35:49<04:03, 48.80s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [36:38<03:15, 48.85s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [37:26<02:25, 48.62s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [38:16<01:38, 49.10s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [39:05<00:48, 48.93s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [39:53<00:00, 48.66s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [39:53<00:00, 47.87s/it]
name: commonsenseqa | {'exact_match': 1.6, 'rougeL': 4.6555} | avg. gen lenth: 280.696
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i9-s1-rFalse --seed 1 --max-prompt-length 2048 --num-in-domain 9
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-21 22:43:00,782] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i9-s1-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 9
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i9-s1-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9732 [00:00<?, ?it/s]  1%|▍                                                     | 75/9732 [00:00<00:12, 742.88it/s]  2%|▊                                                    | 151/9732 [00:00<00:12, 748.32it/s]  2%|█▏                                                   | 226/9732 [00:00<00:12, 746.95it/s]  3%|█▋                                                   | 301/9732 [00:00<00:12, 747.80it/s]  4%|██                                                   | 377/9732 [00:00<00:12, 748.82it/s]  5%|██▍                                                  | 452/9732 [00:00<00:12, 747.49it/s]  5%|██▉                                                  | 528/9732 [00:00<00:12, 748.71it/s]  6%|███▎                                                 | 603/9732 [00:00<00:12, 734.46it/s]  7%|███▋                                                 | 677/9732 [00:00<00:12, 732.18it/s]  8%|████                                                 | 752/9732 [00:01<00:12, 736.58it/s]  9%|████▌                                                | 828/9732 [00:01<00:12, 740.96it/s]  9%|████▉                                                | 903/9732 [00:01<00:11, 742.98it/s] 10%|█████▎                                               | 978/9732 [00:01<00:11, 744.94it/s] 11%|█████▋                                              | 1054/9732 [00:01<00:11, 747.07it/s] 12%|██████                                              | 1129/9732 [00:01<00:11, 747.52it/s] 12%|██████▍                                             | 1204/9732 [00:01<00:11, 748.20it/s] 13%|██████▊                                             | 1279/9732 [00:01<00:11, 748.25it/s] 14%|███████▏                                            | 1354/9732 [00:01<00:11, 743.23it/s] 15%|███████▋                                            | 1429/9732 [00:01<00:11, 743.32it/s] 15%|████████                                            | 1504/9732 [00:02<00:11, 744.58it/s] 16%|████████▍                                           | 1579/9732 [00:02<00:10, 744.45it/s] 17%|████████▊                                           | 1655/9732 [00:02<00:10, 747.47it/s] 18%|█████████▎                                          | 1747/9732 [00:02<00:10, 797.52it/s] 19%|█████████▉                                          | 1851/9732 [00:02<00:09, 869.66it/s] 20%|██████████▍                                         | 1965/9732 [00:02<00:08, 949.69it/s] 21%|██████████▉                                        | 2078/9732 [00:02<00:07, 1002.38it/s] 23%|███████████▍                                       | 2192/9732 [00:02<00:07, 1042.52it/s] 24%|████████████                                       | 2306/9732 [00:02<00:06, 1068.91it/s] 25%|████████████▋                                      | 2421/9732 [00:02<00:06, 1090.65it/s] 26%|█████████████▎                                     | 2534/9732 [00:03<00:06, 1101.77it/s] 27%|█████████████▊                                     | 2646/9732 [00:03<00:06, 1104.59it/s] 28%|██████████████▍                                    | 2759/9732 [00:03<00:06, 1109.48it/s] 30%|███████████████                                    | 2873/9732 [00:03<00:06, 1117.22it/s] 31%|███████████████▋                                   | 2986/9732 [00:03<00:06, 1120.80it/s] 32%|████████████████▏                                  | 3100/9732 [00:03<00:05, 1126.28it/s] 33%|████████████████▊                                  | 3213/9732 [00:03<00:05, 1126.84it/s] 34%|█████████████████▍                                 | 3327/9732 [00:03<00:05, 1130.32it/s] 35%|██████████████████                                 | 3441/9732 [00:03<00:05, 1129.29it/s] 37%|██████████████████▋                                | 3555/9732 [00:03<00:05, 1129.73it/s] 38%|███████████████████▏                               | 3668/9732 [00:04<00:05, 1128.01it/s] 39%|███████████████████▊                               | 3782/9732 [00:04<00:05, 1131.32it/s] 40%|████████████████████▍                              | 3896/9732 [00:04<00:05, 1131.62it/s] 41%|█████████████████████                              | 4010/9732 [00:04<00:05, 1134.06it/s] 42%|█████████████████████▌                             | 4124/9732 [00:04<00:05, 1118.14it/s] 44%|██████████████████████▏                            | 4237/9732 [00:04<00:04, 1120.15it/s] 45%|██████████████████████▊                            | 4350/9732 [00:04<00:04, 1122.18it/s] 46%|███████████████████████▍                           | 4464/9732 [00:04<00:04, 1125.34it/s] 47%|███████████████████████▉                           | 4577/9732 [00:04<00:04, 1066.09it/s] 48%|████████████████████████▌                          | 4691/9732 [00:04<00:04, 1087.26it/s] 49%|█████████████████████████▋                          | 4801/9732 [00:05<00:05, 824.51it/s] 51%|██████████████████████████▎                         | 4915/9732 [00:05<00:05, 898.65it/s] 52%|██████████████████████████▊                         | 5029/9732 [00:05<00:04, 958.55it/s] 53%|██████████████████████████▉                        | 5143/9732 [00:05<00:04, 1005.30it/s] 54%|███████████████████████████▌                       | 5255/9732 [00:05<00:04, 1035.59it/s] 55%|████████████████████████████▏                      | 5369/9732 [00:05<00:04, 1063.67it/s] 56%|████████████████████████████▋                      | 5480/9732 [00:05<00:03, 1076.68it/s] 58%|█████████████████████████████▎                     | 5598/9732 [00:05<00:03, 1105.03it/s] 59%|█████████████████████████████▉                     | 5716/9732 [00:05<00:03, 1124.45it/s] 60%|██████████████████████████████▌                    | 5834/9732 [00:06<00:03, 1139.30it/s] 61%|███████████████████████████████▏                   | 5949/9732 [00:06<00:03, 1113.11it/s] 62%|███████████████████████████████▊                   | 6067/9732 [00:06<00:03, 1132.35it/s] 64%|████████████████████████████████▍                  | 6185/9732 [00:06<00:03, 1143.42it/s] 65%|█████████████████████████████████                  | 6303/9732 [00:06<00:02, 1151.56it/s] 66%|█████████████████████████████████▋                 | 6421/9732 [00:06<00:02, 1157.61it/s] 67%|██████████████████████████████████▎                | 6538/9732 [00:06<00:02, 1159.61it/s] 68%|██████████████████████████████████▉                | 6656/9732 [00:06<00:02, 1162.95it/s] 70%|███████████████████████████████████▍               | 6773/9732 [00:06<00:02, 1164.66it/s] 71%|████████████████████████████████████               | 6892/9732 [00:06<00:02, 1169.90it/s] 72%|████████████████████████████████████▋              | 7010/9732 [00:07<00:02, 1169.32it/s] 73%|█████████████████████████████████████▎             | 7129/9732 [00:07<00:02, 1173.73it/s] 74%|█████████████████████████████████████▉             | 7247/9732 [00:07<00:02, 1172.51it/s] 76%|██████████████████████████████████████▌            | 7366/9732 [00:07<00:02, 1175.35it/s] 77%|███████████████████████████████████████▏           | 7484/9732 [00:07<00:01, 1135.99it/s] 78%|███████████████████████████████████████▊           | 7600/9732 [00:07<00:01, 1140.99it/s] 79%|████████████████████████████████████████▍          | 7716/9732 [00:07<00:01, 1145.22it/s] 80%|█████████████████████████████████████████          | 7834/9732 [00:07<00:01, 1153.54it/s] 82%|█████████████████████████████████████████▋         | 7952/9732 [00:07<00:01, 1158.85it/s] 83%|██████████████████████████████████████████▎        | 8070/9732 [00:08<00:01, 1163.33it/s] 84%|██████████████████████████████████████████▉        | 8188/9732 [00:08<00:01, 1166.60it/s] 85%|███████████████████████████████████████████▌       | 8305/9732 [00:08<00:01, 1165.83it/s] 87%|████████████████████████████████████████████▏      | 8422/9732 [00:08<00:01, 1163.26it/s] 88%|████████████████████████████████████████████▊      | 8540/9732 [00:08<00:01, 1165.52it/s] 89%|█████████████████████████████████████████████▎     | 8657/9732 [00:08<00:00, 1163.84it/s] 90%|█████████████████████████████████████████████▉     | 8775/9732 [00:08<00:00, 1166.30it/s] 91%|██████████████████████████████████████████████▌    | 8892/9732 [00:08<00:00, 1165.94it/s] 93%|███████████████████████████████████████████████▏   | 9009/9732 [00:08<00:00, 1156.93it/s] 94%|███████████████████████████████████████████████▊   | 9125/9732 [00:08<00:00, 1154.81it/s] 95%|████████████████████████████████████████████████▍  | 9242/9732 [00:09<00:00, 1158.96it/s] 96%|█████████████████████████████████████████████████  | 9358/9732 [00:09<00:00, 1154.50it/s] 97%|█████████████████████████████████████████████████▋ | 9475/9732 [00:09<00:00, 1158.47it/s] 99%|██████████████████████████████████████████████████▎| 9592/9732 [00:09<00:00, 1160.39it/s]100%|██████████████████████████████████████████████████▉| 9710/9732 [00:09<00:00, 1163.66it/s]100%|███████████████████████████████████████████████████| 9732/9732 [00:09<00:00, 1031.34it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.13s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:04<00:09,  4.93s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.16s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.41s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.04s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.26s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.20s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.34s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.39s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.55s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.65s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.80s/it]
[2023-08-21 22:44:01,945] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.53s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.71s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.75s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.91s/it]
[2023-08-21 22:44:10,552] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-21 22:44:10,552] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-21 22:44:10,553] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-21 22:44:10,553] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-21 22:44:10,553] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-21 22:44:10,553] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-21 22:44:10,553] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-21 22:44:10,553] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-21 22:44:10,553] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-21 22:44:10,553] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-21 22:44:10,553] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-21 22:44:10,553] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f372ba72fd0>
[2023-08-21 22:44:10,553] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-21 22:44:10,553] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-21 22:44:10,553] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-21 22:44:10,553] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-21 22:44:10,553] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-21 22:44:10,553] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-21 22:44:10,553] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-21 22:44:10,553] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-21 22:44:10,553] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-21 22:44:10,553] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-21 22:44:10,553] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-21 22:44:10,553] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-21 22:44:10,553] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-21 22:44:10,553] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-21 22:44:10,554] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-21 22:44:10,554] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-21 22:44:10,554] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-21 22:44:10,554] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-21 22:44:10,554] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-21 22:44:10,554] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-21 22:44:10,554] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-21 22:44:10,554] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-21 22:44:10,554] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-21 22:44:10,554] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-21 22:44:10,554] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-21 22:44:10,554] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-21 22:44:10,554] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-21 22:44:10,554] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-21 22:44:10,554] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-21 22:44:10,554] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-21 22:44:10,554] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-21 22:44:10,554] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-21 22:44:10,554] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f3750e22220>
[2023-08-21 22:44:10,554] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-21 22:44:10,554] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-21 22:44:10,554] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-21 22:44:10,554] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-21 22:44:10,554] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-21 22:44:10,554] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-21 22:44:10,554] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-21 22:44:10,554] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-21 22:44:10,554] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-21 22:44:10,554] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-21 22:44:10,554] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-21 22:44:10,554] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-21 22:44:10,554] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-21 22:44:10,554] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-21 22:44:10,554] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-21 22:44:10,554] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-21 22:44:10,554] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-21 22:44:10,554] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-21 22:44:10,554] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-21 22:44:10,554] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-21 22:44:10,554] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-21 22:44:10,554] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-21 22:44:10,554] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.3610110282897949 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: Where could you find some plumbing that would not be of use to you if you are thirsty? Choices:  A: oil refineries B: wall C: show D: own home E: water fountain
Output: A: oil refineries

Input: When a person is beginning work, what aren't they doing yet? Choices:  A: working B: resting C: tiredness D: accomplishing E: momentum
Output: D: accomplishing

Input: Where might I find pens with a company logo? Choices:  A: office B: on a pencil C: write sentences on paper D: school E: backpack
Output: A: office

Input: Billy called out to John, and listened for what? Choices:  A: silence B: response C: communication D: hanging up E: whisper
Output: B: response

Input: The lizard frightened the hiker, it's movements made what rustle? Choices:  A: garden B: trees C: books D: rocks E: bushes
Output: E: bushes

Input: The man spent big money and time maintaining his lawn, it was part of keeping up with the Joneses where? Choices:  A: front yard B: suburbia C: neighborhood D: back yard E: golf course
Output: B: suburbia

Input: What would a human do if they want to get to a store that he or she can see? Choices:  A: cross road B: see around C: drink coffee D: dream dreams E: think critically
Output: A: cross road

Input: Where would you grab an object contained by a doorway? Choices:  A: television B: control panel C: opening doors D: doorknob E: doorway
Output: E: doorway

Input: Sarah knew she was committing perjury, so there was a lot of what feeling between her and the prosecutor? Choices:  A: arrest B: tension C: shame D: attraction E: embarrassment
Output: B: tension

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i9-s1-rFalse
Loading extension module utils...
Time to load utils op: 0.3045163154602051 seconds
Loading extension module utils...
Time to load utils op: 0.4043748378753662 seconds
Loading extension module utils...
Time to load utils op: 0.30432724952697754 seconds
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:48<39:31, 48.39s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:35<38:14, 47.80s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [02:22<37:08, 47.42s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [03:10<36:30, 47.62s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [03:57<35:35, 47.45s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [04:46<35:00, 47.75s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [05:34<34:18, 47.88s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [06:20<33:14, 47.50s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [07:08<32:30, 47.57s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [07:57<31:58, 47.96s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [08:44<31:03, 47.78s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [09:33<30:29, 48.15s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [10:21<29:32, 47.91s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [11:10<28:59, 48.32s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [11:58<28:10, 48.29s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [12:46<27:20, 48.25s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [13:35<26:32, 48.26s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [14:24<25:50, 48.44s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [15:11<24:52, 48.14s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [15:59<24:01, 48.05s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [16:47<23:17, 48.20s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [17:36<22:29, 48.19s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [18:24<21:46, 48.40s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [19:06<20:02, 46.24s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [19:52<19:15, 46.24s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [20:40<18:41, 46.72s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [21:27<18:00, 46.99s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [22:15<17:16, 47.11s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [23:03<16:36, 47.45s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [23:40<14:44, 44.22s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [24:28<14:21, 45.32s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [25:16<13:53, 46.29s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [26:04<13:12, 46.64s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [26:51<12:30, 46.89s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [27:39<11:49, 47.29s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [28:27<11:04, 47.46s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [29:16<10:22, 47.88s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [30:04<09:33, 47.83s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [30:52<08:48, 48.02s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [31:40<07:58, 47.89s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [32:28<07:12, 48.06s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [33:16<06:24, 48.07s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [34:05<05:37, 48.21s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [34:52<04:48, 48.03s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [35:32<03:47, 45.45s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [36:20<03:04, 46.12s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [37:07<02:19, 46.40s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [37:40<01:24, 42.46s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [38:28<00:44, 44.13s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [39:15<00:00, 44.90s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [39:15<00:00, 47.10s/it]
name: commonsenseqa | {'exact_match': 4.0, 'rougeL': 6.8809} | avg. gen lenth: 292.048
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i1-s10-rTrue --seed 10 --max-prompt-length 2048 --rationales --num-in-domain 1
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-21 23:23:34,515] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i1-s10-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 1
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i1-s10-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 10
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9740 [00:00<?, ?it/s]  1%|▌                                                     | 96/9740 [00:00<00:10, 956.88it/s]  2%|█                                                    | 193/9740 [00:00<00:09, 961.25it/s]  3%|█▌                                                   | 290/9740 [00:00<00:09, 959.69it/s]  4%|██                                                   | 387/9740 [00:00<00:09, 963.37it/s]  5%|██▋                                                  | 484/9740 [00:00<00:09, 962.76it/s]  6%|███▏                                                 | 582/9740 [00:00<00:09, 965.37it/s]  7%|███▋                                                 | 679/9740 [00:00<00:09, 962.97it/s]  8%|████▏                                                | 777/9740 [00:00<00:09, 965.78it/s]  9%|████▊                                                | 874/9740 [00:00<00:09, 949.51it/s] 10%|█████▎                                               | 970/9740 [00:01<00:09, 949.19it/s] 11%|█████▋                                              | 1068/9740 [00:01<00:09, 957.04it/s] 12%|██████▏                                             | 1165/9740 [00:01<00:08, 959.74it/s] 13%|██████▋                                             | 1262/9740 [00:01<00:08, 961.33it/s] 14%|███████▎                                            | 1359/9740 [00:01<00:08, 961.17it/s] 15%|███████▊                                            | 1456/9740 [00:01<00:08, 962.80it/s] 16%|████████▎                                           | 1553/9740 [00:01<00:08, 963.64it/s] 17%|████████▊                                           | 1650/9740 [00:01<00:08, 963.60it/s] 18%|█████████▎                                          | 1747/9740 [00:01<00:08, 964.65it/s] 19%|█████████▊                                          | 1844/9740 [00:01<00:08, 937.64it/s] 20%|██████████▎                                         | 1941/9740 [00:02<00:08, 944.52it/s] 21%|██████████▉                                         | 2037/9740 [00:02<00:08, 947.39it/s] 22%|███████████▍                                        | 2134/9740 [00:02<00:07, 952.53it/s] 23%|███████████▉                                        | 2231/9740 [00:02<00:07, 955.95it/s] 24%|████████████▍                                       | 2327/9740 [00:02<00:07, 956.69it/s] 25%|████████████▉                                       | 2425/9740 [00:02<00:07, 960.97it/s] 26%|█████████████▍                                      | 2522/9740 [00:02<00:07, 959.95it/s] 27%|█████████████▊                                     | 2642/9740 [00:02<00:06, 1029.60it/s] 29%|██████████████▌                                    | 2788/9740 [00:02<00:06, 1157.27it/s] 30%|███████████████▎                                   | 2934/9740 [00:02<00:05, 1245.84it/s] 32%|████████████████▏                                  | 3081/9740 [00:03<00:05, 1310.90it/s] 33%|████████████████▉                                  | 3228/9740 [00:03<00:04, 1356.19it/s] 35%|█████████████████▋                                 | 3370/9740 [00:03<00:04, 1375.21it/s] 36%|██████████████████▍                                | 3515/9740 [00:03<00:04, 1395.56it/s] 38%|███████████████████▏                               | 3662/9740 [00:03<00:04, 1414.99it/s] 39%|███████████████████▉                               | 3810/9740 [00:03<00:04, 1433.24it/s] 41%|████████████████████▋                              | 3957/9740 [00:03<00:04, 1442.12it/s] 42%|█████████████████████▍                             | 4104/9740 [00:03<00:03, 1447.93it/s] 44%|██████████████████████▎                            | 4251/9740 [00:03<00:03, 1452.34it/s] 45%|███████████████████████                            | 4397/9740 [00:03<00:03, 1453.73it/s] 47%|███████████████████████▊                           | 4543/9740 [00:04<00:03, 1421.70it/s] 48%|████████████████████████▌                          | 4691/9740 [00:04<00:03, 1437.63it/s] 50%|█████████████████████████▎                         | 4835/9740 [00:04<00:04, 1145.96it/s] 51%|██████████████████████████                         | 4981/9740 [00:04<00:03, 1224.08it/s] 53%|██████████████████████████▊                        | 5121/9740 [00:04<00:03, 1269.17it/s] 54%|███████████████████████████▌                       | 5267/9740 [00:04<00:03, 1319.51it/s] 56%|████████████████████████████▎                      | 5414/9740 [00:04<00:03, 1359.36it/s] 57%|█████████████████████████████▏                     | 5566/9740 [00:04<00:02, 1404.06it/s] 59%|█████████████████████████████▉                     | 5720/9740 [00:04<00:02, 1441.85it/s] 60%|██████████████████████████████▊                    | 5874/9740 [00:05<00:02, 1468.03it/s] 62%|███████████████████████████████▌                   | 6027/9740 [00:05<00:02, 1486.01it/s] 63%|████████████████████████████████▎                  | 6180/9740 [00:05<00:02, 1497.44it/s] 65%|█████████████████████████████████▏                 | 6333/9740 [00:05<00:02, 1504.96it/s] 67%|█████████████████████████████████▉                 | 6487/9740 [00:05<00:02, 1513.75it/s] 68%|██████████████████████████████████▊                | 6640/9740 [00:05<00:02, 1516.99it/s] 70%|███████████████████████████████████▌               | 6793/9740 [00:05<00:01, 1519.93it/s] 71%|████████████████████████████████████▎              | 6946/9740 [00:05<00:01, 1522.55it/s] 73%|█████████████████████████████████████▏             | 7099/9740 [00:05<00:01, 1519.49it/s] 74%|█████████████████████████████████████▉             | 7252/9740 [00:05<00:01, 1521.80it/s] 76%|██████████████████████████████████████▊            | 7407/9740 [00:06<00:01, 1528.14it/s] 78%|███████████████████████████████████████▌           | 7560/9740 [00:06<00:01, 1489.45it/s] 79%|████████████████████████████████████████▍          | 7712/9740 [00:06<00:01, 1497.94it/s] 81%|█████████████████████████████████████████▏         | 7865/9740 [00:06<00:01, 1507.36it/s] 82%|█████████████████████████████████████████▉         | 8018/9740 [00:06<00:01, 1511.87it/s] 84%|██████████████████████████████████████████▊        | 8172/9740 [00:06<00:01, 1517.58it/s] 85%|███████████████████████████████████████████▌       | 8326/9740 [00:06<00:00, 1521.62it/s] 87%|████████████████████████████████████████████▍      | 8480/9740 [00:06<00:00, 1525.86it/s] 89%|█████████████████████████████████████████████▏     | 8633/9740 [00:06<00:00, 1524.16it/s] 90%|██████████████████████████████████████████████     | 8786/9740 [00:06<00:00, 1520.99it/s] 92%|██████████████████████████████████████████████▊    | 8939/9740 [00:07<00:00, 1520.49it/s] 93%|███████████████████████████████████████████████▌   | 9092/9740 [00:07<00:00, 1520.43it/s] 95%|████████████████████████████████████████████████▍  | 9245/9740 [00:07<00:00, 1522.57it/s] 96%|█████████████████████████████████████████████████▏ | 9398/9740 [00:07<00:00, 1523.37it/s] 98%|██████████████████████████████████████████████████ | 9551/9740 [00:07<00:00, 1523.51it/s]100%|██████████████████████████████████████████████████▊| 9704/9740 [00:07<00:00, 1515.15it/s]100%|███████████████████████████████████████████████████| 9740/9740 [00:07<00:00, 1284.69it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.02s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.21s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.45s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.41s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.28s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.39s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.31s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:11<00:05,  5.62s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.75s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.87s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.77s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.92s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.71s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.88s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  4.87s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  5.06s/it]
[2023-08-21 23:24:34,779] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
[2023-08-21 23:24:43,983] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-21 23:24:43,983] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-21 23:24:43,984] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-21 23:24:43,984] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-21 23:24:43,984] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-21 23:24:43,984] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-21 23:24:43,984] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-21 23:24:43,984] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-21 23:24:43,984] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-21 23:24:43,984] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-21 23:24:43,984] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-21 23:24:43,984] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f8fc6025fd0>
[2023-08-21 23:24:43,984] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-21 23:24:43,984] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-21 23:24:43,984] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-21 23:24:43,984] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-21 23:24:43,984] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f8fc5fb0220>
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-21 23:24:43,985] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-21 23:24:43,986] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.39600658416748047 seconds
Loading extension module utils...
Time to load utils op: 0.4043543338775635 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Loading extension module utils...
Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]Time to load utils op: 0.30412840843200684 seconds
############### Example ###############
Loading extension module utils...
### Instruction:Answer the following multiple choice question.

Input: Fabric is cut to order at what type of seller? Choices:  A: curtains B: tailor shop C: clothing store D: sewing room E: hardware store
Output: 1. Analyze the question: The question asks for a type of'seller' where fabric is cut to order.
2. Consider each option in relation to fabric being cut to order. 
3. Option A: Curtains - These are a type of product, not a place where fabric is cut to order.
4. Option B: Tailor shop - This location specializes in custom fitting and modifying garments, which would require cutting fabric to order in order for each piece to be customized to the specifications of the customer.
5. Option C: Clothing store - Most clothing stores sell ready-made clothes and do not typically provide a service to cut fabric to order.
6. Option D: Sewing room - This is not a seller, but rather a location where someone might cut fabric for personal use.
7. Option E: Hardware store - This is a store that typically sells tools and building materials, not fabric or clothing.
8. Therefore, the answer is B: tailor shop as it is the only seller in the provided options that cuts fabric specific to the customer's measurements.
So the final answer is B: tailor shop

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i1-s10-rTrue
Time to load utils op: 0.30447912216186523 seconds
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:40<33:18, 40.78s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:30<36:51, 46.07s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [02:21<37:39, 48.07s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [03:11<37:31, 48.96s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [03:54<35:09, 46.87s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [04:44<35:11, 47.99s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [05:35<35:01, 48.87s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [06:26<34:44, 49.64s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [07:16<33:59, 49.75s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [07:51<30:05, 45.15s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [08:42<30:32, 47.00s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [09:32<30:24, 48.02s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [10:23<30:03, 48.73s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [11:13<29:29, 49.14s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [12:04<29:03, 49.80s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [12:55<28:22, 50.09s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [13:45<27:31, 50.05s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [14:35<26:41, 50.04s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [15:25<25:54, 50.16s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [16:17<25:15, 50.51s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [17:06<24:15, 50.20s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [17:56<23:21, 50.05s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [18:47<22:39, 50.36s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [19:20<19:30, 45.02s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [20:10<19:28, 46.73s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [21:00<19:06, 47.75s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [21:45<17:56, 46.81s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [22:36<17:35, 47.99s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [23:26<17:04, 48.79s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [24:17<16:26, 49.34s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [25:07<15:43, 49.66s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [25:59<15:01, 50.07s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [26:48<14:08, 49.93s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [27:39<13:25, 50.32s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [28:29<12:31, 50.12s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [29:19<11:39, 49.94s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [30:09<10:50, 50.07s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [31:00<10:03, 50.31s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [31:50<09:12, 50.26s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [32:41<08:25, 50.50s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [33:31<07:33, 50.38s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [34:21<06:43, 50.38s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [35:12<05:52, 50.34s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [36:02<05:01, 50.30s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [36:52<04:11, 50.33s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [37:42<03:21, 50.25s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [38:33<02:30, 50.23s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [39:24<01:40, 50.48s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [40:14<00:50, 50.34s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [41:05<00:00, 50.59s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [41:05<00:00, 49.31s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 2.2455} | avg. gen lenth: 341.048
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i2-s10-rTrue --seed 10 --max-prompt-length 2048 --rationales --num-in-domain 2
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-22 00:06:03,602] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i2-s10-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 2
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i2-s10-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 10
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9739 [00:00<?, ?it/s]  1%|▎                                                     | 51/9739 [00:00<00:19, 500.88it/s]  1%|▌                                                    | 102/9739 [00:00<00:19, 503.93it/s]  2%|▊                                                    | 153/9739 [00:00<00:19, 504.27it/s]  2%|█                                                    | 204/9739 [00:00<00:18, 502.20it/s]  3%|█▍                                                   | 255/9739 [00:00<00:18, 502.33it/s]  3%|█▋                                                   | 306/9739 [00:00<00:18, 503.32it/s]  4%|█▉                                                   | 357/9739 [00:00<00:18, 502.97it/s]  4%|██▏                                                  | 408/9739 [00:00<00:18, 496.96it/s]  5%|██▍                                                  | 458/9739 [00:00<00:18, 494.63it/s]  5%|██▊                                                  | 509/9739 [00:01<00:18, 496.63it/s]  6%|███                                                  | 560/9739 [00:01<00:18, 498.18it/s]  6%|███▎                                                 | 611/9739 [00:01<00:18, 499.47it/s]  7%|███▌                                                 | 661/9739 [00:01<00:18, 498.87it/s]  7%|███▊                                                 | 712/9739 [00:01<00:18, 500.61it/s]  8%|████▏                                                | 763/9739 [00:01<00:17, 501.76it/s]  8%|████▍                                                | 814/9739 [00:01<00:17, 502.50it/s]  9%|████▋                                                | 865/9739 [00:01<00:17, 502.67it/s]  9%|████▉                                                | 916/9739 [00:01<00:17, 499.00it/s] 10%|█████▎                                               | 967/9739 [00:01<00:17, 500.27it/s] 10%|█████▍                                              | 1018/9739 [00:02<00:17, 501.09it/s] 11%|█████▋                                              | 1069/9739 [00:02<00:17, 502.16it/s] 12%|█████▉                                              | 1120/9739 [00:02<00:17, 501.38it/s] 12%|██████▎                                             | 1171/9739 [00:02<00:17, 502.08it/s] 13%|██████▌                                             | 1222/9739 [00:02<00:16, 502.56it/s] 13%|██████▊                                             | 1273/9739 [00:02<00:16, 502.86it/s] 14%|███████                                             | 1324/9739 [00:02<00:16, 502.91it/s] 14%|███████▍                                            | 1382/9739 [00:02<00:15, 523.92it/s] 15%|███████▊                                            | 1459/9739 [00:02<00:13, 595.61it/s] 16%|████████▏                                           | 1536/9739 [00:02<00:12, 645.56it/s] 17%|████████▌                                           | 1612/9739 [00:03<00:11, 678.57it/s] 17%|█████████                                           | 1687/9739 [00:03<00:11, 699.80it/s] 18%|█████████▍                                          | 1764/9739 [00:03<00:11, 718.13it/s] 19%|█████████▊                                          | 1836/9739 [00:03<00:11, 706.26it/s] 20%|██████████▏                                         | 1913/9739 [00:03<00:10, 723.35it/s] 20%|██████████▌                                         | 1989/9739 [00:03<00:10, 732.49it/s] 21%|███████████                                         | 2065/9739 [00:03<00:10, 738.77it/s] 22%|███████████▍                                        | 2142/9739 [00:03<00:10, 746.16it/s] 23%|███████████▊                                        | 2219/9739 [00:03<00:10, 750.98it/s] 24%|████████████▎                                       | 2295/9739 [00:03<00:09, 751.95it/s] 24%|████████████▋                                       | 2372/9739 [00:04<00:09, 755.09it/s] 25%|█████████████                                       | 2449/9739 [00:04<00:09, 758.15it/s] 26%|█████████████▍                                      | 2525/9739 [00:04<00:09, 756.84it/s] 27%|█████████████▉                                      | 2602/9739 [00:04<00:09, 758.50it/s] 27%|██████████████▎                                     | 2678/9739 [00:04<00:09, 750.85it/s] 28%|██████████████▋                                     | 2754/9739 [00:04<00:09, 748.52it/s] 29%|███████████████                                     | 2830/9739 [00:04<00:09, 751.58it/s] 30%|███████████████▌                                    | 2907/9739 [00:04<00:09, 756.14it/s] 31%|███████████████▉                                    | 2983/9739 [00:04<00:08, 755.51it/s] 31%|████████████████▎                                   | 3059/9739 [00:04<00:08, 756.53it/s] 32%|████████████████▋                                   | 3136/9739 [00:05<00:08, 758.00it/s] 33%|█████████████████▏                                  | 3212/9739 [00:05<00:08, 757.14it/s] 34%|█████████████████▌                                  | 3289/9739 [00:05<00:08, 759.28it/s] 35%|█████████████████▉                                  | 3365/9739 [00:05<00:08, 754.49it/s] 35%|██████████████████▎                                 | 3441/9739 [00:05<00:08, 754.58it/s] 36%|██████████████████▊                                 | 3517/9739 [00:05<00:08, 756.18it/s] 37%|███████████████████▏                                | 3594/9739 [00:05<00:08, 757.93it/s] 38%|███████████████████▌                                | 3670/9739 [00:05<00:08, 754.23it/s] 38%|████████████████████                                | 3747/9739 [00:05<00:07, 756.67it/s] 39%|████████████████████▍                               | 3824/9739 [00:05<00:07, 758.18it/s] 40%|████████████████████▊                               | 3900/9739 [00:06<00:07, 757.30it/s] 41%|█████████████████████▏                              | 3976/9739 [00:06<00:07, 757.53it/s] 42%|█████████████████████▋                              | 4053/9739 [00:06<00:07, 758.59it/s] 42%|██████████████████████                              | 4129/9739 [00:06<00:07, 757.11it/s] 43%|██████████████████████▍                             | 4205/9739 [00:06<00:07, 757.41it/s] 44%|██████████████████████▊                             | 4281/9739 [00:06<00:07, 758.14it/s] 45%|███████████████████████▎                            | 4357/9739 [00:06<00:07, 756.93it/s] 46%|███████████████████████▋                            | 4434/9739 [00:06<00:06, 757.97it/s] 46%|████████████████████████                            | 4511/9739 [00:06<00:06, 759.09it/s] 47%|████████████████████████▍                           | 4587/9739 [00:07<00:07, 722.83it/s] 48%|████████████████████████▉                           | 4664/9739 [00:07<00:06, 734.15it/s] 49%|█████████████████████████▎                          | 4740/9739 [00:07<00:08, 593.15it/s] 49%|█████████████████████████▋                          | 4816/9739 [00:07<00:07, 634.24it/s] 50%|██████████████████████████                          | 4891/9739 [00:07<00:07, 663.73it/s] 51%|██████████████████████████▌                         | 4967/9739 [00:07<00:06, 688.39it/s] 52%|██████████████████████████▉                         | 5044/9739 [00:07<00:06, 708.66it/s] 53%|███████████████████████████▎                        | 5119/9739 [00:07<00:06, 719.39it/s] 53%|███████████████████████████▋                        | 5194/9739 [00:07<00:06, 728.14it/s] 54%|████████████████████████████▏                       | 5270/9739 [00:07<00:06, 736.06it/s] 55%|████████████████████████████▌                       | 5346/9739 [00:08<00:05, 742.90it/s] 56%|████████████████████████████▉                       | 5422/9739 [00:08<00:05, 745.45it/s] 56%|█████████████████████████████▎                      | 5499/9739 [00:08<00:05, 751.19it/s] 57%|█████████████████████████████▊                      | 5578/9739 [00:08<00:05, 760.85it/s] 58%|██████████████████████████████▏                     | 5656/9739 [00:08<00:05, 765.73it/s] 59%|██████████████████████████████▋                     | 5736/9739 [00:08<00:05, 774.45it/s] 60%|███████████████████████████████                     | 5816/9739 [00:08<00:05, 781.21it/s] 61%|███████████████████████████████▍                    | 5895/9739 [00:08<00:04, 783.75it/s] 61%|███████████████████████████████▉                    | 5975/9739 [00:08<00:04, 788.00it/s] 62%|████████████████████████████████▎                   | 6055/9739 [00:08<00:04, 791.49it/s] 63%|████████████████████████████████▊                   | 6135/9739 [00:09<00:04, 788.69it/s] 64%|█████████████████████████████████▏                  | 6214/9739 [00:09<00:04, 785.37it/s] 65%|█████████████████████████████████▌                  | 6293/9739 [00:09<00:04, 784.94it/s] 65%|██████████████████████████████████                  | 6372/9739 [00:09<00:04, 782.58it/s] 66%|██████████████████████████████████▍                 | 6451/9739 [00:09<00:04, 783.95it/s] 67%|██████████████████████████████████▊                 | 6530/9739 [00:09<00:04, 783.79it/s] 68%|███████████████████████████████████▎                | 6609/9739 [00:09<00:04, 781.99it/s] 69%|███████████████████████████████████▋                | 6688/9739 [00:09<00:03, 783.62it/s] 69%|████████████████████████████████████▏               | 6767/9739 [00:09<00:03, 782.43it/s] 70%|████████████████████████████████████▌               | 6847/9739 [00:10<00:03, 785.11it/s] 71%|████████████████████████████████████▉               | 6927/9739 [00:10<00:03, 788.87it/s] 72%|█████████████████████████████████████▍              | 7007/9739 [00:10<00:03, 789.49it/s] 73%|█████████████████████████████████████▊              | 7087/9739 [00:10<00:03, 792.43it/s] 74%|██████████████████████████████████████▎             | 7167/9739 [00:10<00:03, 794.26it/s] 74%|██████████████████████████████████████▋             | 7247/9739 [00:10<00:03, 792.60it/s] 75%|███████████████████████████████████████             | 7327/9739 [00:10<00:03, 794.15it/s] 76%|███████████████████████████████████████▌            | 7407/9739 [00:10<00:02, 795.33it/s] 77%|███████████████████████████████████████▉            | 7487/9739 [00:10<00:02, 765.28it/s] 78%|████████████████████████████████████████▍           | 7567/9739 [00:10<00:02, 773.94it/s] 79%|████████████████████████████████████████▊           | 7647/9739 [00:11<00:02, 780.54it/s] 79%|█████████████████████████████████████████▎          | 7726/9739 [00:11<00:02, 781.16it/s] 80%|█████████████████████████████████████████▋          | 7806/9739 [00:11<00:02, 785.75it/s] 81%|██████████████████████████████████████████          | 7886/9739 [00:11<00:02, 789.01it/s] 82%|██████████████████████████████████████████▌         | 7965/9739 [00:11<00:02, 788.84it/s] 83%|██████████████████████████████████████████▉         | 8045/9739 [00:11<00:02, 791.37it/s] 83%|███████████████████████████████████████████▍        | 8125/9739 [00:11<00:02, 791.54it/s] 84%|███████████████████████████████████████████▊        | 8205/9739 [00:11<00:01, 793.34it/s] 85%|████████████████████████████████████████████▏       | 8285/9739 [00:11<00:01, 793.36it/s] 86%|████████████████████████████████████████████▋       | 8365/9739 [00:11<00:01, 791.53it/s] 87%|█████████████████████████████████████████████       | 8445/9739 [00:12<00:01, 793.38it/s] 88%|█████████████████████████████████████████████▌      | 8525/9739 [00:12<00:01, 794.13it/s] 88%|█████████████████████████████████████████████▉      | 8605/9739 [00:12<00:01, 790.98it/s] 89%|██████████████████████████████████████████████▎     | 8685/9739 [00:12<00:01, 790.74it/s] 90%|██████████████████████████████████████████████▊     | 8765/9739 [00:12<00:01, 791.60it/s] 91%|███████████████████████████████████████████████▏    | 8845/9739 [00:12<00:01, 782.06it/s] 92%|███████████████████████████████████████████████▋    | 8925/9739 [00:12<00:01, 785.94it/s] 92%|████████████████████████████████████████████████    | 9005/9739 [00:12<00:00, 788.36it/s] 93%|████████████████████████████████████████████████▌   | 9084/9739 [00:12<00:00, 787.86it/s] 94%|████████████████████████████████████████████████▉   | 9164/9739 [00:12<00:00, 789.76it/s] 95%|█████████████████████████████████████████████████▎  | 9244/9739 [00:13<00:00, 790.29it/s] 96%|█████████████████████████████████████████████████▊  | 9324/9739 [00:13<00:00, 788.75it/s] 97%|██████████████████████████████████████████████████▏ | 9404/9739 [00:13<00:00, 789.86it/s] 97%|██████████████████████████████████████████████████▋ | 9483/9739 [00:13<00:00, 787.80it/s] 98%|███████████████████████████████████████████████████ | 9563/9739 [00:13<00:00, 789.69it/s] 99%|███████████████████████████████████████████████████▍| 9643/9739 [00:13<00:00, 790.16it/s]100%|███████████████████████████████████████████████████▉| 9723/9739 [00:13<00:00, 787.28it/s]100%|████████████████████████████████████████████████████| 9739/9739 [00:13<00:00, 712.06it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.31s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.04s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.14s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.19s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.22s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:09<00:04,  4.94s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.03s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.17s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.33s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.51s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.70s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.85s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.41s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.59s/it]
[2023-08-22 00:07:08,566] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.58s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.74s/it]
[2023-08-22 00:07:15,840] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-22 00:07:15,841] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-22 00:07:15,841] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-22 00:07:15,841] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-22 00:07:15,841] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-22 00:07:15,841] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-22 00:07:15,841] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-22 00:07:15,841] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-22 00:07:15,841] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-22 00:07:15,841] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-22 00:07:15,841] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-22 00:07:15,841] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f79f3f6afd0>
[2023-08-22 00:07:15,841] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-22 00:07:15,841] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f79fb177220>
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-22 00:07:15,842] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-22 00:07:15,843] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-22 00:07:15,843] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-22 00:07:15,843] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.3915419578552246 seconds
Loading extension module utils...
Time to load utils op: 0.404435396194458 seconds
Loading extension module utils...
Time to load utils op: 0.3043038845062256 seconds
Loading extension module utils...
Time to load utils op: 0.4046437740325928 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: Fabric is cut to order at what type of seller? Choices:  A: curtains B: tailor shop C: clothing store D: sewing room E: hardware store
Output: 1. The question is asking where fabric is cut to order. This means looking for a place where fabric is used and customized based on specific measurements and requirements.
2. The first option, A: curtains, is not a place but a type of fabric product, so we can eliminate it.
3. The second option, B: tailor shop, is a place where fabric is indeed cut to order to make clothing. This stands as a plausible answer until we assess the other options.
4. The third option, C: clothing store, could initially seem like a potential answer, but it's important to remember that while clothing stores sell clothes, they don't usually cut fabric to order. They offer pre-made clothes, so we can eliminate this option.
5. The fourth option, D: sewing room, could potentially work as well. However, a sewing room is more of a general area where any form of sewing (including fabric cutting) might take place, rather than a commercial place where fabric is specifically cut to order.
6. The last option, E: hardware store, is not relevant since hardware stores sell tools and materials for household repairs, but not typically fabric or sewing related items.
7. After evaluating all the options, we see that B: tailor shop is the only one that fits the bill. Tailors indeed cut fabric to specific orders to tailor-make clothes. Thus, the correct answer is B: tailor shop.
So the final answer is B: tailor shop

Input: Where are you if your reading magazines while waiting for a vehicle on rails? Choices:  A: vegetables B: market C: doctor D: train station E: bookstore
Output: 1. The question asks about a place where one would wait for a vehicle on rails while reading magazines. 
2. The term'vehicle on rails' refers to a train. Trains travel on railways, hence the use of 'rails'. 
3. Hence, the location where one would most likely wait for a train is a train station. 
4. Even though one can read magazines in a market, doctor's office, or bookstore, these options do not involve waiting for a vehicle on rails. 
5. Vegetables is not a location and therefore, not a suitable option. 
6. Combining all the above information, the correct answer therefore is D: train station as it's the place where one waits for a train(returning to the question's hint'vehicle on rails') and can possibly read magazines while waiting.
So the final answer is D: train station

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i2-s10-rTrue
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:43<35:52, 43.92s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:28<35:38, 44.55s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [02:14<35:06, 44.81s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [02:59<34:34, 45.09s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [03:44<33:44, 44.99s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [04:29<33:07, 45.16s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [05:15<32:27, 45.28s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [06:00<31:40, 45.26s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [06:45<30:52, 45.19s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [07:30<30:09, 45.23s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [08:16<29:25, 45.28s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [09:02<28:50, 45.53s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [09:48<28:15, 45.83s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [10:34<27:26, 45.74s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [11:19<26:38, 45.67s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [11:51<23:26, 41.36s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [12:36<23:25, 42.60s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [13:22<23:09, 43.42s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [14:07<22:44, 44.01s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [14:52<22:08, 44.29s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [15:37<21:32, 44.58s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [16:23<20:54, 44.80s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [17:08<20:11, 44.87s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [17:53<19:31, 45.06s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [18:38<18:47, 45.12s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [19:24<18:07, 45.30s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [20:09<17:19, 45.20s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [20:54<16:35, 45.24s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [21:40<15:52, 45.36s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [22:26<15:08, 45.45s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [23:11<14:20, 45.28s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [23:56<13:33, 45.19s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [24:41<12:49, 45.28s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [25:26<12:02, 45.13s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [26:11<11:18, 45.21s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [26:56<10:33, 45.23s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [27:42<09:48, 45.24s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [28:22<08:45, 43.77s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [29:07<08:06, 44.24s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [29:53<07:25, 44.57s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [30:38<06:42, 44.73s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [31:23<05:58, 44.76s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [32:09<05:15, 45.10s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [32:54<04:31, 45.28s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [33:40<03:46, 45.37s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [34:25<03:01, 45.34s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [35:10<02:15, 45.30s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [35:56<01:30, 45.36s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [36:41<00:45, 45.22s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [37:26<00:00, 45.36s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [37:26<00:00, 44.94s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 1.9146} | avg. gen lenth: 379.828
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i3-s10-rTrue --seed 10 --max-prompt-length 2048 --rationales --num-in-domain 3
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-22 00:44:52,465] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i3-s10-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 3
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i3-s10-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 10
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9738 [00:00<?, ?it/s]  0%|▏                                                     | 35/9738 [00:00<00:28, 346.14it/s]  1%|▍                                                     | 70/9738 [00:00<00:27, 347.44it/s]  1%|▌                                                    | 106/9738 [00:00<00:27, 348.86it/s]  1%|▊                                                    | 141/9738 [00:00<00:27, 349.05it/s]  2%|▉                                                    | 176/9738 [00:00<00:27, 348.89it/s]  2%|█▏                                                   | 211/9738 [00:00<00:27, 347.00it/s]  3%|█▎                                                   | 246/9738 [00:00<00:27, 342.29it/s]  3%|█▌                                                   | 281/9738 [00:00<00:27, 343.81it/s]  3%|█▋                                                   | 316/9738 [00:00<00:27, 344.88it/s]  4%|█▉                                                   | 351/9738 [00:01<00:27, 345.47it/s]  4%|██                                                   | 386/9738 [00:01<00:27, 346.36it/s]  4%|██▎                                                  | 421/9738 [00:01<00:26, 346.74it/s]  5%|██▍                                                  | 456/9738 [00:01<00:26, 345.25it/s]  5%|██▋                                                  | 491/9738 [00:01<00:26, 346.30it/s]  6%|██▉                                                  | 544/9738 [00:01<00:23, 399.26it/s]  6%|███▏                                                 | 597/9738 [00:01<00:20, 437.38it/s]  7%|███▌                                                 | 649/9738 [00:01<00:19, 461.13it/s]  7%|███▊                                                 | 701/9738 [00:01<00:18, 478.53it/s]  8%|████                                                 | 754/9738 [00:01<00:18, 493.26it/s]  8%|████▍                                                | 807/9738 [00:02<00:17, 503.92it/s]  9%|████▋                                                | 860/9738 [00:02<00:17, 511.70it/s]  9%|████▉                                                | 913/9738 [00:02<00:17, 515.03it/s] 10%|█████▎                                               | 967/9738 [00:02<00:16, 519.64it/s] 10%|█████▍                                              | 1020/9738 [00:02<00:16, 521.95it/s] 11%|█████▋                                              | 1073/9738 [00:02<00:16, 522.58it/s] 12%|██████                                              | 1126/9738 [00:02<00:16, 522.32it/s] 12%|██████▎                                             | 1179/9738 [00:02<00:16, 523.94it/s] 13%|██████▌                                             | 1232/9738 [00:02<00:16, 524.38it/s] 13%|██████▊                                             | 1285/9738 [00:02<00:16, 525.62it/s] 14%|███████▏                                            | 1338/9738 [00:03<00:16, 524.03it/s] 14%|███████▍                                            | 1391/9738 [00:03<00:15, 524.98it/s] 15%|███████▋                                            | 1444/9738 [00:03<00:15, 525.78it/s] 15%|███████▉                                            | 1497/9738 [00:03<00:15, 525.83it/s] 16%|████████▎                                           | 1550/9738 [00:03<00:15, 526.14it/s] 16%|████████▌                                           | 1603/9738 [00:03<00:15, 524.28it/s] 17%|████████▊                                           | 1656/9738 [00:03<00:15, 525.25it/s] 18%|█████████▏                                          | 1709/9738 [00:03<00:15, 525.80it/s] 18%|█████████▍                                          | 1762/9738 [00:03<00:15, 525.96it/s] 19%|█████████▋                                          | 1815/9738 [00:03<00:15, 506.59it/s] 19%|█████████▉                                          | 1868/9738 [00:04<00:15, 512.24it/s] 20%|██████████▎                                         | 1921/9738 [00:04<00:15, 516.14it/s] 20%|██████████▌                                         | 1974/9738 [00:04<00:14, 518.69it/s] 21%|██████████▊                                         | 2026/9738 [00:04<00:14, 515.96it/s] 21%|███████████                                         | 2079/9738 [00:04<00:14, 518.35it/s] 22%|███████████▍                                        | 2132/9738 [00:04<00:14, 520.39it/s] 22%|███████████▋                                        | 2185/9738 [00:04<00:14, 522.29it/s] 23%|███████████▉                                        | 2238/9738 [00:04<00:14, 522.72it/s] 24%|████████████▏                                       | 2291/9738 [00:04<00:14, 521.95it/s] 24%|████████████▌                                       | 2344/9738 [00:04<00:14, 523.34it/s] 25%|████████████▊                                       | 2397/9738 [00:05<00:13, 524.83it/s] 25%|█████████████                                       | 2450/9738 [00:05<00:13, 525.71it/s] 26%|█████████████▎                                      | 2503/9738 [00:05<00:13, 523.93it/s] 26%|█████████████▋                                      | 2556/9738 [00:05<00:13, 524.12it/s] 27%|█████████████▉                                      | 2609/9738 [00:05<00:13, 525.36it/s] 27%|██████████████▏                                     | 2662/9738 [00:05<00:13, 525.60it/s] 28%|██████████████▍                                     | 2715/9738 [00:05<00:13, 517.95it/s] 28%|██████████████▊                                     | 2768/9738 [00:05<00:13, 519.54it/s] 29%|███████████████                                     | 2821/9738 [00:05<00:13, 521.38it/s] 30%|███████████████▎                                    | 2874/9738 [00:05<00:13, 523.74it/s] 30%|███████████████▋                                    | 2927/9738 [00:06<00:13, 522.61it/s] 31%|███████████████▉                                    | 2980/9738 [00:06<00:12, 523.65it/s] 31%|████████████████▏                                   | 3033/9738 [00:06<00:12, 524.64it/s] 32%|████████████████▍                                   | 3086/9738 [00:06<00:12, 524.90it/s] 32%|████████████████▊                                   | 3139/9738 [00:06<00:12, 524.93it/s] 33%|█████████████████                                   | 3192/9738 [00:06<00:12, 523.38it/s] 33%|█████████████████▎                                  | 3245/9738 [00:06<00:12, 523.55it/s] 34%|█████████████████▌                                  | 3298/9738 [00:06<00:12, 524.22it/s] 34%|█████████████████▉                                  | 3351/9738 [00:06<00:12, 524.41it/s] 35%|██████████████████▏                                 | 3404/9738 [00:06<00:12, 515.61it/s] 36%|██████████████████▍                                 | 3457/9738 [00:07<00:12, 518.31it/s] 36%|██████████████████▋                                 | 3510/9738 [00:07<00:11, 520.02it/s] 37%|███████████████████                                 | 3563/9738 [00:07<00:11, 521.71it/s] 37%|███████████████████▎                                | 3616/9738 [00:07<00:11, 520.44it/s] 38%|███████████████████▌                                | 3669/9738 [00:07<00:11, 521.61it/s] 38%|███████████████████▉                                | 3722/9738 [00:07<00:11, 522.62it/s] 39%|████████████████████▏                               | 3775/9738 [00:07<00:11, 522.60it/s] 39%|████████████████████▍                               | 3828/9738 [00:07<00:11, 523.19it/s] 40%|████████████████████▋                               | 3881/9738 [00:07<00:11, 521.26it/s] 40%|█████████████████████                               | 3934/9738 [00:08<00:11, 522.18it/s] 41%|█████████████████████▎                              | 3987/9738 [00:08<00:10, 522.83it/s] 41%|█████████████████████▌                              | 4040/9738 [00:08<00:10, 523.75it/s] 42%|█████████████████████▊                              | 4093/9738 [00:08<00:10, 519.94it/s] 43%|██████████████████████▏                             | 4146/9738 [00:08<00:10, 520.93it/s] 43%|██████████████████████▍                             | 4199/9738 [00:08<00:10, 521.69it/s] 44%|██████████████████████▋                             | 4252/9738 [00:08<00:10, 522.33it/s] 44%|██████████████████████▉                             | 4305/9738 [00:08<00:10, 520.83it/s] 45%|███████████████████████▎                            | 4358/9738 [00:08<00:10, 520.79it/s] 45%|███████████████████████▌                            | 4411/9738 [00:08<00:10, 522.17it/s] 46%|███████████████████████▊                            | 4464/9738 [00:09<00:10, 522.13it/s] 46%|████████████████████████                            | 4517/9738 [00:09<00:10, 485.36it/s] 47%|████████████████████████▍                           | 4570/9738 [00:09<00:10, 496.42it/s] 47%|████████████████████████▋                           | 4623/9738 [00:09<00:10, 504.87it/s] 48%|████████████████████████▉                           | 4676/9738 [00:09<00:09, 510.56it/s] 49%|█████████████████████████▎                          | 4729/9738 [00:09<00:09, 514.38it/s] 49%|█████████████████████████▌                          | 4781/9738 [00:09<00:13, 370.08it/s] 50%|█████████████████████████▊                          | 4834/9738 [00:09<00:12, 406.02it/s] 50%|██████████████████████████                          | 4887/9738 [00:09<00:11, 434.75it/s] 51%|██████████████████████████▍                         | 4940/9738 [00:10<00:10, 457.78it/s] 51%|██████████████████████████▋                         | 4992/9738 [00:10<00:10, 474.02it/s] 52%|██████████████████████████▉                         | 5045/9738 [00:10<00:09, 488.45it/s] 52%|███████████████████████████▏                        | 5098/9738 [00:10<00:09, 498.29it/s] 53%|███████████████████████████▌                        | 5151/9738 [00:10<00:09, 506.22it/s] 53%|███████████████████████████▊                        | 5203/9738 [00:10<00:08, 507.47it/s] 54%|████████████████████████████                        | 5256/9738 [00:10<00:08, 512.28it/s] 55%|████████████████████████████▎                       | 5309/9738 [00:10<00:08, 515.28it/s] 55%|████████████████████████████▋                       | 5362/9738 [00:10<00:08, 517.74it/s] 56%|████████████████████████████▉                       | 5415/9738 [00:11<00:08, 518.00it/s] 56%|█████████████████████████████▏                      | 5468/9738 [00:11<00:08, 519.95it/s] 57%|█████████████████████████████▍                      | 5522/9738 [00:11<00:08, 524.47it/s] 57%|█████████████████████████████▊                      | 5576/9738 [00:11<00:07, 527.83it/s] 58%|██████████████████████████████                      | 5630/9738 [00:11<00:07, 530.49it/s] 58%|██████████████████████████████▎                     | 5685/9738 [00:11<00:07, 534.38it/s] 59%|██████████████████████████████▋                     | 5740/9738 [00:11<00:07, 537.16it/s] 60%|██████████████████████████████▉                     | 5795/9738 [00:11<00:07, 538.46it/s] 60%|███████████████████████████████▏                    | 5850/9738 [00:11<00:07, 539.45it/s] 61%|███████████████████████████████▌                    | 5904/9738 [00:11<00:07, 538.88it/s] 61%|███████████████████████████████▊                    | 5959/9738 [00:12<00:06, 540.46it/s] 62%|████████████████████████████████                    | 6014/9738 [00:12<00:06, 541.61it/s] 62%|████████████████████████████████▍                   | 6069/9738 [00:12<00:06, 542.67it/s] 63%|████████████████████████████████▋                   | 6124/9738 [00:12<00:06, 540.41it/s] 63%|████████████████████████████████▉                   | 6179/9738 [00:12<00:06, 541.45it/s] 64%|█████████████████████████████████▎                  | 6234/9738 [00:12<00:06, 541.27it/s] 65%|█████████████████████████████████▌                  | 6289/9738 [00:12<00:06, 541.23it/s] 65%|█████████████████████████████████▉                  | 6344/9738 [00:12<00:06, 539.53it/s] 66%|██████████████████████████████████▏                 | 6399/9738 [00:12<00:06, 541.07it/s] 66%|██████████████████████████████████▍                 | 6454/9738 [00:12<00:06, 542.18it/s] 67%|██████████████████████████████████▊                 | 6509/9738 [00:13<00:05, 542.86it/s] 67%|███████████████████████████████████                 | 6564/9738 [00:13<00:05, 541.11it/s] 68%|███████████████████████████████████▎                | 6619/9738 [00:13<00:05, 541.97it/s] 69%|███████████████████████████████████▋                | 6674/9738 [00:13<00:05, 539.85it/s] 69%|███████████████████████████████████▉                | 6729/9738 [00:13<00:05, 540.77it/s] 70%|████████████████████████████████████▏               | 6784/9738 [00:13<00:05, 539.43it/s] 70%|████████████████████████████████████▌               | 6839/9738 [00:13<00:05, 540.77it/s] 71%|████████████████████████████████████▊               | 6894/9738 [00:13<00:05, 541.60it/s] 71%|█████████████████████████████████████               | 6949/9738 [00:13<00:05, 542.68it/s] 72%|█████████████████████████████████████▍              | 7004/9738 [00:13<00:05, 541.05it/s] 72%|█████████████████████████████████████▋              | 7059/9738 [00:14<00:04, 542.41it/s] 73%|█████████████████████████████████████▉              | 7114/9738 [00:14<00:04, 543.37it/s] 74%|██████████████████████████████████████▎             | 7169/9738 [00:14<00:04, 544.16it/s] 74%|██████████████████████████████████████▌             | 7224/9738 [00:14<00:04, 541.12it/s] 75%|██████████████████████████████████████▊             | 7279/9738 [00:14<00:04, 541.53it/s] 75%|███████████████████████████████████████▏            | 7334/9738 [00:14<00:04, 542.19it/s] 76%|███████████████████████████████████████▍            | 7389/9738 [00:14<00:04, 542.84it/s] 76%|███████████████████████████████████████▊            | 7444/9738 [00:14<00:04, 516.32it/s] 77%|████████████████████████████████████████            | 7499/9738 [00:14<00:04, 523.75it/s] 78%|████████████████████████████████████████▎           | 7553/9738 [00:14<00:04, 527.96it/s] 78%|████████████████████████████████████████▌           | 7607/9738 [00:15<00:04, 531.23it/s] 79%|████████████████████████████████████████▉           | 7662/9738 [00:15<00:03, 534.48it/s] 79%|█████████████████████████████████████████▏          | 7716/9738 [00:15<00:03, 535.18it/s] 80%|█████████████████████████████████████████▍          | 7771/9738 [00:15<00:03, 537.38it/s] 80%|█████████████████████████████████████████▊          | 7826/9738 [00:15<00:03, 538.98it/s] 81%|██████████████████████████████████████████          | 7881/9738 [00:15<00:03, 540.12it/s] 81%|██████████████████████████████████████████▍         | 7936/9738 [00:15<00:03, 539.35it/s] 82%|██████████████████████████████████████████▋         | 7991/9738 [00:15<00:03, 540.24it/s] 83%|██████████████████████████████████████████▉         | 8046/9738 [00:15<00:03, 541.05it/s] 83%|███████████████████████████████████████████▎        | 8101/9738 [00:15<00:03, 542.31it/s] 84%|███████████████████████████████████████████▌        | 8156/9738 [00:16<00:02, 541.01it/s] 84%|███████████████████████████████████████████▊        | 8211/9738 [00:16<00:02, 540.97it/s] 85%|████████████████████████████████████████████▏       | 8266/9738 [00:16<00:02, 541.50it/s] 85%|████████████████████████████████████████████▍       | 8321/9738 [00:16<00:02, 541.76it/s] 86%|████████████████████████████████████████████▋       | 8376/9738 [00:16<00:02, 540.49it/s] 87%|█████████████████████████████████████████████       | 8431/9738 [00:16<00:02, 541.02it/s] 87%|█████████████████████████████████████████████▎      | 8486/9738 [00:16<00:02, 541.13it/s] 88%|█████████████████████████████████████████████▌      | 8541/9738 [00:16<00:02, 539.06it/s] 88%|█████████████████████████████████████████████▉      | 8595/9738 [00:16<00:02, 538.13it/s] 89%|██████████████████████████████████████████████▏     | 8650/9738 [00:17<00:02, 539.06it/s] 89%|██████████████████████████████████████████████▍     | 8704/9738 [00:17<00:01, 536.49it/s] 90%|██████████████████████████████████████████████▊     | 8759/9738 [00:17<00:01, 538.14it/s] 91%|███████████████████████████████████████████████     | 8813/9738 [00:17<00:01, 537.19it/s] 91%|███████████████████████████████████████████████▎    | 8868/9738 [00:17<00:01, 538.89it/s] 92%|███████████████████████████████████████████████▋    | 8923/9738 [00:17<00:01, 540.48it/s] 92%|███████████████████████████████████████████████▉    | 8978/9738 [00:17<00:01, 541.36it/s] 93%|████████████████████████████████████████████████▏   | 9033/9738 [00:17<00:01, 539.06it/s] 93%|████████████████████████████████████████████████▌   | 9088/9738 [00:17<00:01, 539.78it/s] 94%|████████████████████████████████████████████████▊   | 9143/9738 [00:17<00:01, 540.52it/s] 94%|█████████████████████████████████████████████████   | 9198/9738 [00:18<00:00, 540.71it/s] 95%|█████████████████████████████████████████████████▍  | 9253/9738 [00:18<00:00, 541.10it/s] 96%|█████████████████████████████████████████████████▋  | 9308/9738 [00:18<00:00, 539.28it/s] 96%|█████████████████████████████████████████████████▉  | 9363/9738 [00:18<00:00, 540.37it/s] 97%|██████████████████████████████████████████████████▎ | 9418/9738 [00:18<00:00, 536.30it/s] 97%|██████████████████████████████████████████████████▌ | 9473/9738 [00:18<00:00, 537.98it/s] 98%|██████████████████████████████████████████████████▊ | 9527/9738 [00:18<00:00, 537.49it/s] 98%|███████████████████████████████████████████████████▏| 9582/9738 [00:18<00:00, 538.96it/s] 99%|███████████████████████████████████████████████████▍| 9636/9738 [00:18<00:00, 538.26it/s]100%|███████████████████████████████████████████████████▋| 9690/9738 [00:18<00:00, 538.75it/s]100%|████████████████████████████████████████████████████| 9738/9738 [00:19<00:00, 511.91it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:04<00:09,  4.93s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:04<00:09,  4.88s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.32s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.11s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:09<00:04,  4.92s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:09<00:04,  4.99s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.21s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.33s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.49s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.47s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.61s/it]
Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.06s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.61s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.78s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.42s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.60s/it]
[2023-08-22 00:46:06,641] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
[2023-08-22 00:46:13,503] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-22 00:46:13,504] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-22 00:46:13,505] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-22 00:46:13,505] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-22 00:46:13,505] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-22 00:46:13,505] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-22 00:46:13,505] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-22 00:46:13,505] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-22 00:46:13,505] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-22 00:46:13,505] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-22 00:46:13,505] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-22 00:46:13,505] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7efc85fd1fd0>
[2023-08-22 00:46:13,505] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-22 00:46:13,505] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-22 00:46:13,505] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-22 00:46:13,505] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-22 00:46:13,505] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-22 00:46:13,505] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-22 00:46:13,505] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-22 00:46:13,505] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-22 00:46:13,505] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-22 00:46:13,505] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-22 00:46:13,505] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-22 00:46:13,505] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-22 00:46:13,505] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-22 00:46:13,505] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-22 00:46:13,505] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-22 00:46:13,505] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-22 00:46:13,505] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-22 00:46:13,505] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-22 00:46:13,505] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-22 00:46:13,505] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-22 00:46:13,505] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-22 00:46:13,505] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-22 00:46:13,505] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-22 00:46:13,505] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-22 00:46:13,505] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-22 00:46:13,505] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-22 00:46:13,505] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-22 00:46:13,506] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-22 00:46:13,506] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-22 00:46:13,506] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-22 00:46:13,506] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-22 00:46:13,506] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-22 00:46:13,506] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7efc85b9e220>
[2023-08-22 00:46:13,506] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-22 00:46:13,506] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-22 00:46:13,506] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-22 00:46:13,506] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-22 00:46:13,506] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-22 00:46:13,506] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-22 00:46:13,506] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-22 00:46:13,506] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-22 00:46:13,506] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-22 00:46:13,506] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-22 00:46:13,506] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-22 00:46:13,506] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-22 00:46:13,506] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-22 00:46:13,506] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-22 00:46:13,506] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-22 00:46:13,506] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-22 00:46:13,506] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-22 00:46:13,506] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-22 00:46:13,506] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-22 00:46:13,506] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-22 00:46:13,506] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-22 00:46:13,506] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-22 00:46:13,506] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.46024417877197266 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: Fabric is cut to order at what type of seller? Choices:  A: curtains B: tailor shop C: clothing store D: sewing room E: hardware store
Output: 1. The question asks where fabric is cut to order, meaning where fabric is cut according to specific measurements given by the buyer. 
2. Option A, curtains, isn't a seller but rather a type of item that could be made from cut fabric.
3. Option C, clothing store, mainly sells ready-to-wear outfits and does not typically offer fabric cutting services.
4. Option D, a sewing room, often refers to a space within a home where sewing projects are done, not a commercial seller.
5. Option E, a hardware store, primarily sells tools and equipment for home improvement and doesn't deal with fabric. 
6. Therefore, the correct answer is option B, a tailor shop. A tailor shop performs alterations and custom clothing designs, which involves cutting fabric to a customer's specific measurements.
So the final answer is B: tailor shop

Input: Where are you if your reading magazines while waiting for a vehicle on rails? Choices:  A: vegetables B: market C: doctor D: train station E: bookstore
Output: 1. Evaluating each option is the best approach to find the correct answer.
2. The activity in the question is reading magazines while waiting for a vehicle on rails, which hints that the location should be somewhere trains are boarding.
3. Option A, vegetables, is not a location. Therefore, this is incorrect.
4. Option B, market, does not correspond to waiting for a vehicle on rails, so this is also ruled out.
5. Option C, doctor, isn't a plausible solution because doctors offices don't typically have vehicles on rails, making this option irrelevant.
6. Option D, train station, is a place where people wait for vehicles on rails which are trains, and it's possible to read magazines while waiting. This option matches with the given situation, so this might be the correct answer.
7. Option E, bookstore, may offer magazines to read, but it's not a place where you wait for a vehicle on rails. Therefore, this option can be ruled out.
8. Thus, the correct answer is D: train station.
So the final answer is D: train station

Input: What would need oil to be used? Choices:  A: ground B: human  body C: repair shop D: combustion engines E: service station
Output: Step 1: Consider each option individually and whether oil is needed for its operation or maintenance.
Step 2: The first option is "ground". While oil can sometimes be used in the soil for certain purposes, it's hardly a necessity.
Step 3: The second option is "human body", which does need certain types of oils (like fats) for nutrition, but it doesn't use the type of oil meant in the question.
Step 4: The third option is "repair shop", this place will indeed need oil to carry out certain services, but the shop itself doesn't need oil to function. 
Step 5: Analysis of the fourth option "combustion engine" shows it indeed needs oil to function. The oil in a combustion engine is used to cool, clean, seal and lubricate the engine's parts.
Step 6: The last option is "service station". Similar to "repair shop", a service station will need oil to carry out some services, but doesn't need oil itself to function.
Step 7: After comparing all options, it's clear that "combustion engine" is the option to which oil is most vital. Thus, Option D is the correct answer.
So the final answer is D: combustion engines

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i3-s10-rTrue
Loading extension module utils...
Time to load utils op: 0.4044816493988037 seconds
Loading extension module utils...
Time to load utils op: 0.4045090675354004 seconds
Loading extension module utils...
Time to load utils op: 0.504767894744873 seconds
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:43<35:31, 43.49s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:26<34:37, 43.28s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [02:09<33:43, 43.05s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [02:52<32:56, 42.97s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [03:34<32:01, 42.70s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [04:16<31:07, 42.44s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [04:58<30:24, 42.42s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [05:41<29:43, 42.47s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [06:23<28:58, 42.40s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [07:06<28:18, 42.45s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [07:49<27:40, 42.57s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [08:31<26:51, 42.42s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [09:14<26:15, 42.57s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [09:55<25:25, 42.38s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [10:38<24:41, 42.33s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [11:20<23:58, 42.31s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [12:03<23:19, 42.41s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [12:45<22:38, 42.46s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [13:27<21:55, 42.43s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [14:10<21:11, 42.40s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [14:52<20:25, 42.26s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [15:35<19:48, 42.43s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [16:17<19:06, 42.46s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [17:00<18:24, 42.49s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [17:42<17:41, 42.48s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [18:25<16:59, 42.49s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [19:07<16:15, 42.43s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [19:49<15:33, 42.44s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [20:32<14:50, 42.42s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [21:14<14:08, 42.40s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [21:56<13:25, 42.38s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [22:39<12:41, 42.33s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [23:21<11:58, 42.27s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [24:03<11:16, 42.27s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [24:45<10:34, 42.30s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [25:28<09:53, 42.40s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [26:10<09:10, 42.36s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [26:53<08:28, 42.40s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [27:35<07:46, 42.43s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [28:18<07:04, 42.44s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [29:00<06:22, 42.48s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [29:43<05:40, 42.62s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [30:26<04:58, 42.68s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [31:10<04:17, 42.88s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [31:52<03:33, 42.75s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [32:34<02:50, 42.53s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [33:17<02:08, 42.71s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [34:00<01:25, 42.70s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [34:42<00:42, 42.60s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [35:25<00:00, 42.53s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [35:25<00:00, 42.50s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 1.7961} | avg. gen lenth: 391.956
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i4-s10-rTrue --seed 10 --max-prompt-length 2048 --rationales --num-in-domain 4
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-22 01:21:51,136] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i4-s10-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 4
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i4-s10-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 10
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9737 [00:00<?, ?it/s]  0%|                                                      | 22/9737 [00:00<00:44, 216.09it/s]  0%|▏                                                     | 44/9737 [00:00<00:44, 216.50it/s]  1%|▎                                                     | 66/9737 [00:00<00:44, 216.91it/s]  1%|▍                                                     | 88/9737 [00:00<00:44, 217.19it/s]  1%|▌                                                    | 110/9737 [00:00<00:44, 217.66it/s]  1%|▋                                                    | 132/9737 [00:00<00:44, 214.47it/s]  2%|▊                                                    | 154/9737 [00:00<00:44, 215.12it/s]  2%|▉                                                    | 176/9737 [00:00<00:44, 215.77it/s]  2%|█                                                    | 198/9737 [00:00<00:44, 216.05it/s]  2%|█▏                                                   | 220/9737 [00:01<00:44, 214.76it/s]  2%|█▎                                                   | 242/9737 [00:01<00:44, 215.45it/s]  3%|█▍                                                   | 264/9737 [00:01<00:43, 215.99it/s]  3%|█▌                                                   | 286/9737 [00:01<00:43, 216.02it/s]  3%|█▋                                                   | 308/9737 [00:01<00:43, 216.40it/s]  3%|█▊                                                   | 330/9737 [00:01<00:43, 216.46it/s]  4%|█▉                                                   | 352/9737 [00:01<00:43, 214.03it/s]  4%|██                                                   | 374/9737 [00:01<00:43, 214.41it/s]  4%|██▏                                                  | 396/9737 [00:01<00:43, 215.21it/s]  4%|██▎                                                  | 418/9737 [00:01<00:43, 215.29it/s]  5%|██▍                                                  | 440/9737 [00:02<00:43, 213.17it/s]  5%|██▌                                                  | 462/9737 [00:02<00:43, 214.28it/s]  5%|██▋                                                  | 484/9737 [00:02<00:43, 214.89it/s]  5%|██▊                                                  | 513/9737 [00:02<00:38, 236.70it/s]  6%|██▉                                                  | 546/9737 [00:02<00:34, 263.62it/s]  6%|███▏                                                 | 579/9737 [00:02<00:32, 283.07it/s]  6%|███▎                                                 | 612/9737 [00:02<00:30, 296.39it/s]  7%|███▌                                                 | 645/9737 [00:02<00:29, 306.05it/s]  7%|███▋                                                 | 678/9737 [00:02<00:29, 311.32it/s]  7%|███▊                                                 | 711/9737 [00:02<00:28, 316.70it/s]  8%|████                                                 | 744/9737 [00:03<00:28, 320.48it/s]  8%|████▏                                                | 777/9737 [00:03<00:27, 323.23it/s]  8%|████▍                                                | 810/9737 [00:03<00:27, 325.24it/s]  9%|████▌                                                | 843/9737 [00:03<00:27, 326.54it/s]  9%|████▊                                                | 876/9737 [00:03<00:27, 327.39it/s]  9%|████▉                                                | 909/9737 [00:03<00:27, 326.26it/s] 10%|█████▏                                               | 942/9737 [00:03<00:26, 327.03it/s] 10%|█████▎                                               | 975/9737 [00:03<00:26, 327.48it/s] 10%|█████▍                                              | 1008/9737 [00:03<00:26, 327.66it/s] 11%|█████▌                                              | 1041/9737 [00:03<00:26, 327.45it/s] 11%|█████▋                                              | 1074/9737 [00:04<00:26, 327.85it/s] 11%|█████▉                                              | 1107/9737 [00:04<00:26, 327.84it/s] 12%|██████                                              | 1140/9737 [00:04<00:26, 326.10it/s] 12%|██████▎                                             | 1173/9737 [00:04<00:26, 326.70it/s] 12%|██████▍                                             | 1206/9737 [00:04<00:26, 326.97it/s] 13%|██████▌                                             | 1239/9737 [00:04<00:25, 327.31it/s] 13%|██████▊                                             | 1272/9737 [00:04<00:25, 327.91it/s] 13%|██████▉                                             | 1305/9737 [00:04<00:25, 328.30it/s] 14%|███████▏                                            | 1338/9737 [00:04<00:25, 326.32it/s] 14%|███████▎                                            | 1371/9737 [00:04<00:25, 326.85it/s] 14%|███████▍                                            | 1404/9737 [00:05<00:25, 327.36it/s] 15%|███████▋                                            | 1437/9737 [00:05<00:25, 327.63it/s] 15%|███████▊                                            | 1470/9737 [00:05<00:25, 325.35it/s] 15%|████████                                            | 1503/9737 [00:05<00:25, 325.84it/s] 16%|████████▏                                           | 1536/9737 [00:05<00:25, 326.70it/s] 16%|████████▍                                           | 1569/9737 [00:05<00:25, 325.67it/s] 16%|████████▌                                           | 1602/9737 [00:05<00:24, 326.16it/s] 17%|████████▋                                           | 1635/9737 [00:05<00:24, 327.23it/s] 17%|████████▉                                           | 1668/9737 [00:05<00:24, 327.49it/s] 17%|█████████                                           | 1701/9737 [00:05<00:24, 327.67it/s] 18%|█████████▎                                          | 1734/9737 [00:06<00:24, 327.84it/s] 18%|█████████▍                                          | 1767/9737 [00:06<00:24, 327.99it/s] 18%|█████████▌                                          | 1800/9737 [00:06<00:25, 309.21it/s] 19%|█████████▊                                          | 1833/9737 [00:06<00:25, 314.32it/s] 19%|█████████▉                                          | 1866/9737 [00:06<00:24, 318.23it/s] 19%|██████████▏                                         | 1898/9737 [00:06<00:24, 318.07it/s] 20%|██████████▎                                         | 1931/9737 [00:06<00:24, 320.55it/s] 20%|██████████▍                                         | 1964/9737 [00:06<00:24, 322.49it/s] 21%|██████████▋                                         | 1997/9737 [00:06<00:23, 323.70it/s] 21%|██████████▊                                         | 2030/9737 [00:07<00:23, 322.09it/s] 21%|███████████                                         | 2063/9737 [00:07<00:23, 323.67it/s] 22%|███████████▏                                        | 2096/9737 [00:07<00:23, 324.64it/s] 22%|███████████▎                                        | 2129/9737 [00:07<00:23, 325.62it/s] 22%|███████████▌                                        | 2162/9737 [00:07<00:23, 326.47it/s] 23%|███████████▋                                        | 2195/9737 [00:07<00:23, 326.85it/s] 23%|███████████▉                                        | 2228/9737 [00:07<00:22, 327.38it/s] 23%|████████████                                        | 2261/9737 [00:07<00:22, 325.68it/s] 24%|████████████▎                                       | 2294/9737 [00:07<00:22, 326.33it/s] 24%|████████████▍                                       | 2327/9737 [00:07<00:22, 324.95it/s] 24%|████████████▌                                       | 2360/9737 [00:08<00:22, 325.50it/s] 25%|████████████▊                                       | 2393/9737 [00:08<00:22, 325.60it/s] 25%|████████████▉                                       | 2426/9737 [00:08<00:22, 326.38it/s] 25%|█████████████▏                                      | 2459/9737 [00:08<00:22, 326.84it/s] 26%|█████████████▎                                      | 2492/9737 [00:08<00:22, 325.08it/s] 26%|█████████████▍                                      | 2525/9737 [00:08<00:22, 325.79it/s] 26%|█████████████▋                                      | 2558/9737 [00:08<00:21, 326.33it/s] 27%|█████████████▊                                      | 2591/9737 [00:08<00:21, 327.16it/s] 27%|██████████████                                      | 2624/9737 [00:08<00:21, 327.26it/s] 27%|██████████████▏                                     | 2657/9737 [00:08<00:21, 327.20it/s] 28%|██████████████▎                                     | 2690/9737 [00:09<00:21, 326.59it/s] 28%|██████████████▌                                     | 2723/9737 [00:09<00:21, 324.74it/s] 28%|██████████████▋                                     | 2756/9737 [00:09<00:21, 325.51it/s] 29%|██████████████▉                                     | 2789/9737 [00:09<00:21, 325.61it/s] 29%|███████████████                                     | 2822/9737 [00:09<00:21, 326.07it/s] 29%|███████████████▏                                    | 2855/9737 [00:09<00:21, 326.71it/s] 30%|███████████████▍                                    | 2888/9737 [00:09<00:21, 326.09it/s] 30%|███████████████▌                                    | 2921/9737 [00:09<00:20, 326.54it/s] 30%|███████████████▊                                    | 2954/9737 [00:09<00:20, 324.72it/s] 31%|███████████████▉                                    | 2987/9737 [00:09<00:20, 325.71it/s] 31%|████████████████▏                                   | 3020/9737 [00:10<00:20, 326.09it/s] 31%|████████████████▎                                   | 3053/9737 [00:10<00:20, 325.34it/s] 32%|████████████████▍                                   | 3086/9737 [00:10<00:20, 324.49it/s] 32%|████████████████▋                                   | 3119/9737 [00:10<00:20, 325.19it/s] 32%|████████████████▊                                   | 3152/9737 [00:10<00:20, 323.82it/s] 33%|█████████████████                                   | 3185/9737 [00:10<00:20, 324.66it/s] 33%|█████████████████▏                                  | 3218/9737 [00:10<00:20, 325.37it/s] 33%|█████████████████▎                                  | 3251/9737 [00:10<00:19, 326.23it/s] 34%|█████████████████▌                                  | 3284/9737 [00:10<00:19, 326.49it/s] 34%|█████████████████▋                                  | 3317/9737 [00:10<00:19, 326.81it/s] 34%|█████████████████▉                                  | 3350/9737 [00:11<00:19, 327.16it/s] 35%|██████████████████                                  | 3383/9737 [00:11<00:19, 325.46it/s] 35%|██████████████████▏                                 | 3416/9737 [00:11<00:19, 326.08it/s] 35%|██████████████████▍                                 | 3449/9737 [00:11<00:19, 326.51it/s] 36%|██████████████████▌                                 | 3482/9737 [00:11<00:19, 326.84it/s] 36%|██████████████████▊                                 | 3515/9737 [00:11<00:19, 326.84it/s] 36%|██████████████████▉                                 | 3548/9737 [00:11<00:18, 327.10it/s] 37%|███████████████████                                 | 3581/9737 [00:11<00:18, 327.08it/s] 37%|███████████████████▎                                | 3614/9737 [00:11<00:18, 325.17it/s] 37%|███████████████████▍                                | 3647/9737 [00:11<00:18, 325.93it/s] 38%|███████████████████▋                                | 3680/9737 [00:12<00:18, 326.45it/s] 38%|███████████████████▊                                | 3713/9737 [00:12<00:18, 327.00it/s] 38%|████████████████████                                | 3746/9737 [00:12<00:18, 327.19it/s] 39%|████████████████████▏                               | 3779/9737 [00:12<00:18, 327.06it/s] 39%|████████████████████▎                               | 3812/9737 [00:12<00:18, 327.21it/s] 39%|████████████████████▌                               | 3845/9737 [00:12<00:18, 325.75it/s] 40%|████████████████████▋                               | 3878/9737 [00:12<00:17, 326.18it/s] 40%|████████████████████▉                               | 3911/9737 [00:12<00:17, 326.71it/s] 41%|█████████████████████                               | 3944/9737 [00:12<00:17, 327.30it/s] 41%|█████████████████████▏                              | 3977/9737 [00:12<00:17, 326.46it/s] 41%|█████████████████████▍                              | 4010/9737 [00:13<00:17, 326.96it/s] 42%|█████████████████████▌                              | 4043/9737 [00:13<00:17, 327.30it/s] 42%|█████████████████████▊                              | 4076/9737 [00:13<00:17, 325.76it/s] 42%|█████████████████████▉                              | 4109/9737 [00:13<00:17, 326.04it/s] 43%|██████████████████████                              | 4142/9737 [00:13<00:17, 326.50it/s] 43%|██████████████████████▎                             | 4175/9737 [00:13<00:17, 326.84it/s] 43%|██████████████████████▍                             | 4208/9737 [00:13<00:16, 327.02it/s] 44%|██████████████████████▋                             | 4241/9737 [00:13<00:16, 327.32it/s] 44%|██████████████████████▊                             | 4274/9737 [00:13<00:16, 327.69it/s] 44%|███████████████████████                             | 4307/9737 [00:13<00:16, 326.18it/s] 45%|███████████████████████▏                            | 4340/9737 [00:14<00:16, 326.73it/s] 45%|███████████████████████▎                            | 4373/9737 [00:14<00:16, 327.02it/s] 45%|███████████████████████▌                            | 4406/9737 [00:14<00:16, 326.96it/s] 46%|███████████████████████▋                            | 4439/9737 [00:14<00:16, 326.81it/s] 46%|███████████████████████▉                            | 4472/9737 [00:14<00:16, 327.09it/s] 46%|████████████████████████                            | 4505/9737 [00:14<00:16, 326.99it/s] 47%|████████████████████████▏                           | 4538/9737 [00:14<00:17, 303.53it/s] 47%|████████████████████████▍                           | 4571/9737 [00:14<00:16, 310.25it/s] 47%|████████████████████████▌                           | 4604/9737 [00:14<00:16, 315.33it/s] 48%|████████████████████████▊                           | 4637/9737 [00:15<00:15, 319.09it/s] 48%|████████████████████████▉                           | 4670/9737 [00:15<00:15, 321.61it/s] 48%|█████████████████████████                           | 4703/9737 [00:15<00:15, 323.40it/s] 49%|█████████████████████████▎                          | 4736/9737 [00:15<00:15, 325.13it/s] 49%|█████████████████████████▍                          | 4769/9737 [00:15<00:21, 233.09it/s] 49%|█████████████████████████▋                          | 4802/9737 [00:15<00:19, 254.07it/s] 50%|█████████████████████████▊                          | 4835/9737 [00:15<00:18, 271.79it/s] 50%|█████████████████████████▉                          | 4868/9737 [00:15<00:17, 285.96it/s] 50%|██████████████████████████▏                         | 4901/9737 [00:15<00:16, 297.03it/s] 51%|██████████████████████████▎                         | 4934/9737 [00:16<00:15, 305.16it/s] 51%|██████████████████████████▌                         | 4966/9737 [00:16<00:15, 309.21it/s] 51%|██████████████████████████▋                         | 4999/9737 [00:16<00:15, 314.19it/s] 52%|██████████████████████████▊                         | 5031/9737 [00:16<00:14, 315.21it/s] 52%|███████████████████████████                         | 5064/9737 [00:16<00:14, 318.44it/s] 52%|███████████████████████████▏                        | 5097/9737 [00:16<00:14, 320.43it/s] 53%|███████████████████████████▍                        | 5130/9737 [00:16<00:14, 322.18it/s] 53%|███████████████████████████▌                        | 5163/9737 [00:16<00:14, 323.86it/s] 53%|███████████████████████████▋                        | 5196/9737 [00:16<00:14, 322.81it/s] 54%|███████████████████████████▉                        | 5229/9737 [00:16<00:13, 323.84it/s] 54%|████████████████████████████                        | 5262/9737 [00:17<00:13, 324.38it/s] 54%|████████████████████████████▎                       | 5295/9737 [00:17<00:13, 325.03it/s] 55%|████████████████████████████▍                       | 5328/9737 [00:17<00:13, 325.07it/s] 55%|████████████████████████████▋                       | 5361/9737 [00:17<00:13, 325.18it/s] 55%|████████████████████████████▊                       | 5394/9737 [00:17<00:13, 324.99it/s] 56%|████████████████████████████▉                       | 5427/9737 [00:17<00:13, 323.62it/s] 56%|█████████████████████████████▏                      | 5460/9737 [00:17<00:13, 324.23it/s] 56%|█████████████████████████████▎                      | 5494/9737 [00:17<00:12, 326.74it/s] 57%|█████████████████████████████▌                      | 5528/9737 [00:17<00:12, 327.86it/s] 57%|█████████████████████████████▋                      | 5562/9737 [00:17<00:12, 330.75it/s] 57%|█████████████████████████████▉                      | 5596/9737 [00:18<00:12, 329.65it/s] 58%|██████████████████████████████                      | 5630/9737 [00:18<00:12, 330.32it/s] 58%|██████████████████████████████▏                     | 5664/9737 [00:18<00:12, 332.26it/s] 59%|██████████████████████████████▍                     | 5698/9737 [00:18<00:12, 333.69it/s] 59%|██████████████████████████████▌                     | 5732/9737 [00:18<00:11, 334.98it/s] 59%|██████████████████████████████▊                     | 5766/9737 [00:18<00:11, 335.25it/s] 60%|██████████████████████████████▉                     | 5800/9737 [00:18<00:11, 335.33it/s] 60%|███████████████████████████████▏                    | 5834/9737 [00:18<00:11, 335.45it/s] 60%|███████████████████████████████▎                    | 5868/9737 [00:18<00:11, 334.00it/s] 61%|███████████████████████████████▌                    | 5902/9737 [00:19<00:11, 334.93it/s] 61%|███████████████████████████████▋                    | 5936/9737 [00:19<00:11, 332.34it/s] 61%|███████████████████████████████▉                    | 5970/9737 [00:19<00:11, 333.98it/s] 62%|████████████████████████████████                    | 6004/9737 [00:19<00:11, 334.86it/s] 62%|████████████████████████████████▏                   | 6038/9737 [00:19<00:11, 335.60it/s] 62%|████████████████████████████████▍                   | 6072/9737 [00:19<00:10, 336.04it/s] 63%|████████████████████████████████▌                   | 6106/9737 [00:19<00:10, 334.68it/s] 63%|████████████████████████████████▊                   | 6140/9737 [00:19<00:10, 335.20it/s] 63%|████████████████████████████████▉                   | 6174/9737 [00:19<00:10, 332.79it/s] 64%|█████████████████████████████████▏                  | 6208/9737 [00:19<00:10, 333.60it/s] 64%|█████████████████████████████████▎                  | 6242/9737 [00:20<00:10, 333.94it/s] 64%|█████████████████████████████████▌                  | 6276/9737 [00:20<00:10, 335.00it/s] 65%|█████████████████████████████████▋                  | 6310/9737 [00:20<00:10, 334.14it/s] 65%|█████████████████████████████████▉                  | 6344/9737 [00:20<00:10, 335.12it/s] 66%|██████████████████████████████████                  | 6378/9737 [00:20<00:10, 335.70it/s] 66%|██████████████████████████████████▏                 | 6412/9737 [00:20<00:09, 336.02it/s] 66%|██████████████████████████████████▍                 | 6446/9737 [00:20<00:09, 336.24it/s] 67%|██████████████████████████████████▌                 | 6480/9737 [00:20<00:09, 336.13it/s] 67%|██████████████████████████████████▊                 | 6514/9737 [00:20<00:09, 336.08it/s] 67%|██████████████████████████████████▉                 | 6548/9737 [00:20<00:09, 333.88it/s] 68%|███████████████████████████████████▏                | 6582/9737 [00:21<00:09, 334.38it/s] 68%|███████████████████████████████████▎                | 6616/9737 [00:21<00:09, 335.07it/s] 68%|███████████████████████████████████▌                | 6650/9737 [00:21<00:09, 335.52it/s] 69%|███████████████████████████████████▋                | 6684/9737 [00:21<00:09, 335.79it/s] 69%|███████████████████████████████████▉                | 6718/9737 [00:21<00:09, 333.45it/s] 69%|████████████████████████████████████                | 6752/9737 [00:21<00:08, 334.56it/s] 70%|████████████████████████████████████▏               | 6786/9737 [00:21<00:08, 332.13it/s] 70%|████████████████████████████████████▍               | 6820/9737 [00:21<00:08, 333.56it/s] 70%|████████████████████████████████████▌               | 6854/9737 [00:21<00:08, 334.20it/s] 71%|████████████████████████████████████▊               | 6888/9737 [00:21<00:08, 333.72it/s] 71%|████████████████████████████████████▉               | 6922/9737 [00:22<00:08, 334.49it/s] 71%|█████████████████████████████████████▏              | 6956/9737 [00:22<00:08, 335.28it/s] 72%|█████████████████████████████████████▎              | 6990/9737 [00:22<00:08, 334.17it/s] 72%|█████████████████████████████████████▌              | 7024/9737 [00:22<00:08, 334.85it/s] 72%|█████████████████████████████████████▋              | 7058/9737 [00:22<00:07, 335.32it/s] 73%|█████████████████████████████████████▊              | 7092/9737 [00:22<00:07, 335.45it/s] 73%|██████████████████████████████████████              | 7126/9737 [00:22<00:07, 335.70it/s] 74%|██████████████████████████████████████▏             | 7160/9737 [00:22<00:07, 335.68it/s] 74%|██████████████████████████████████████▍             | 7194/9737 [00:22<00:07, 335.49it/s] 74%|██████████████████████████████████████▌             | 7228/9737 [00:22<00:07, 333.61it/s] 75%|██████████████████████████████████████▊             | 7262/9737 [00:23<00:07, 334.48it/s] 75%|██████████████████████████████████████▉             | 7296/9737 [00:23<00:07, 332.06it/s] 75%|███████████████████████████████████████▏            | 7330/9737 [00:23<00:07, 333.30it/s] 76%|███████████████████████████████████████▎            | 7364/9737 [00:23<00:07, 334.44it/s] 76%|███████████████████████████████████████▌            | 7398/9737 [00:23<00:06, 335.01it/s] 76%|███████████████████████████████████████▋            | 7432/9737 [00:23<00:06, 335.16it/s] 77%|███████████████████████████████████████▊            | 7466/9737 [00:23<00:07, 300.69it/s] 77%|████████████████████████████████████████            | 7500/9737 [00:23<00:07, 310.45it/s] 77%|████████████████████████████████████████▏           | 7534/9737 [00:23<00:06, 317.49it/s] 78%|████████████████████████████████████████▍           | 7568/9737 [00:24<00:06, 323.05it/s] 78%|████████████████████████████████████████▌           | 7602/9737 [00:24<00:06, 326.92it/s] 78%|████████████████████████████████████████▊           | 7636/9737 [00:24<00:06, 329.76it/s] 79%|████████████████████████████████████████▉           | 7670/9737 [00:24<00:06, 329.54it/s] 79%|█████████████████████████████████████████▏          | 7704/9737 [00:24<00:06, 331.64it/s] 79%|█████████████████████████████████████████▎          | 7738/9737 [00:24<00:05, 333.20it/s] 80%|█████████████████████████████████████████▌          | 7772/9737 [00:24<00:05, 333.60it/s] 80%|█████████████████████████████████████████▋          | 7806/9737 [00:24<00:05, 334.31it/s] 81%|█████████████████████████████████████████▊          | 7840/9737 [00:24<00:05, 335.16it/s] 81%|██████████████████████████████████████████          | 7874/9737 [00:24<00:05, 335.50it/s] 81%|██████████████████████████████████████████▏         | 7908/9737 [00:25<00:05, 334.00it/s] 82%|██████████████████████████████████████████▍         | 7942/9737 [00:25<00:05, 334.41it/s] 82%|██████████████████████████████████████████▌         | 7976/9737 [00:25<00:05, 334.85it/s] 82%|██████████████████████████████████████████▊         | 8010/9737 [00:25<00:05, 333.41it/s] 83%|██████████████████████████████████████████▉         | 8044/9737 [00:25<00:05, 333.80it/s] 83%|███████████████████████████████████████████▏        | 8078/9737 [00:25<00:04, 334.48it/s] 83%|███████████████████████████████████████████▎        | 8112/9737 [00:25<00:04, 335.26it/s] 84%|███████████████████████████████████████████▌        | 8146/9737 [00:25<00:04, 334.01it/s] 84%|███████████████████████████████████████████▋        | 8180/9737 [00:25<00:04, 334.65it/s] 84%|███████████████████████████████████████████▊        | 8214/9737 [00:25<00:04, 335.13it/s] 85%|████████████████████████████████████████████        | 8248/9737 [00:26<00:04, 335.20it/s] 85%|████████████████████████████████████████████▏       | 8282/9737 [00:26<00:04, 335.20it/s] 85%|████████████████████████████████████████████▍       | 8316/9737 [00:26<00:04, 335.30it/s] 86%|████████████████████████████████████████████▌       | 8350/9737 [00:26<00:04, 333.50it/s] 86%|████████████████████████████████████████████▊       | 8384/9737 [00:26<00:04, 334.10it/s] 86%|████████████████████████████████████████████▉       | 8418/9737 [00:26<00:03, 334.87it/s] 87%|█████████████████████████████████████████████▏      | 8452/9737 [00:26<00:03, 335.20it/s] 87%|█████████████████████████████████████████████▎      | 8486/9737 [00:26<00:03, 335.11it/s] 88%|█████████████████████████████████████████████▌      | 8520/9737 [00:26<00:03, 334.64it/s] 88%|█████████████████████████████████████████████▋      | 8554/9737 [00:26<00:03, 333.66it/s] 88%|█████████████████████████████████████████████▊      | 8588/9737 [00:27<00:03, 331.47it/s] 89%|██████████████████████████████████████████████      | 8622/9737 [00:27<00:03, 331.35it/s] 89%|██████████████████████████████████████████████▏     | 8656/9737 [00:27<00:03, 331.28it/s] 89%|██████████████████████████████████████████████▍     | 8690/9737 [00:27<00:03, 331.55it/s] 90%|██████████████████████████████████████████████▌     | 8724/9737 [00:27<00:03, 331.64it/s] 90%|██████████████████████████████████████████████▊     | 8758/9737 [00:27<00:02, 331.17it/s] 90%|██████████████████████████████████████████████▉     | 8792/9737 [00:27<00:02, 330.96it/s] 91%|███████████████████████████████████████████████▏    | 8826/9737 [00:27<00:02, 329.33it/s] 91%|███████████████████████████████████████████████▎    | 8860/9737 [00:27<00:02, 329.87it/s] 91%|███████████████████████████████████████████████▍    | 8894/9737 [00:27<00:02, 330.76it/s] 92%|███████████████████████████████████████████████▋    | 8928/9737 [00:28<00:02, 331.45it/s] 92%|███████████████████████████████████████████████▊    | 8962/9737 [00:28<00:02, 331.24it/s] 92%|████████████████████████████████████████████████    | 8996/9737 [00:28<00:02, 332.26it/s] 93%|████████████████████████████████████████████████▏   | 9030/9737 [00:28<00:02, 331.30it/s] 93%|████████████████████████████████████████████████▍   | 9064/9737 [00:28<00:02, 332.43it/s] 93%|████████████████████████████████████████████████▌   | 9098/9737 [00:28<00:01, 333.46it/s] 94%|████████████████████████████████████████████████▊   | 9132/9737 [00:28<00:01, 334.16it/s] 94%|████████████████████████████████████████████████▉   | 9166/9737 [00:28<00:01, 334.48it/s] 94%|█████████████████████████████████████████████████▏  | 9200/9737 [00:28<00:01, 334.86it/s] 95%|█████████████████████████████████████████████████▎  | 9234/9737 [00:29<00:01, 334.97it/s] 95%|█████████████████████████████████████████████████▍  | 9268/9737 [00:29<00:01, 333.40it/s] 96%|█████████████████████████████████████████████████▋  | 9302/9737 [00:29<00:01, 333.98it/s] 96%|█████████████████████████████████████████████████▊  | 9336/9737 [00:29<00:01, 334.63it/s] 96%|██████████████████████████████████████████████████  | 9370/9737 [00:29<00:01, 334.72it/s] 97%|██████████████████████████████████████████████████▏ | 9404/9737 [00:29<00:00, 334.90it/s] 97%|██████████████████████████████████████████████████▍ | 9438/9737 [00:29<00:00, 335.32it/s] 97%|██████████████████████████████████████████████████▌ | 9472/9737 [00:29<00:00, 335.42it/s] 98%|██████████████████████████████████████████████████▊ | 9506/9737 [00:29<00:00, 333.46it/s] 98%|██████████████████████████████████████████████████▉ | 9540/9737 [00:29<00:00, 334.32it/s] 98%|███████████████████████████████████████████████████▏| 9574/9737 [00:30<00:00, 334.76it/s] 99%|███████████████████████████████████████████████████▎| 9608/9737 [00:30<00:00, 334.49it/s] 99%|███████████████████████████████████████████████████▍| 9642/9737 [00:30<00:00, 334.48it/s] 99%|███████████████████████████████████████████████████▋| 9676/9737 [00:30<00:00, 334.89it/s]100%|███████████████████████████████████████████████████▊| 9710/9737 [00:30<00:00, 335.10it/s]100%|████████████████████████████████████████████████████| 9737/9737 [00:30<00:00, 319.02it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.17s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.11s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.42s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:11,  5.80s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.07s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.03s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.33s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:12<00:06,  6.10s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.53s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.69s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.50s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.65s/it]
[2023-08-22 01:23:13,357] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.69s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.87s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:16<00:00,  5.37s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:16<00:00,  5.54s/it]
[2023-08-22 01:23:29,109] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-22 01:23:29,110] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-22 01:23:29,111] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-22 01:23:29,111] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-22 01:23:29,111] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-22 01:23:29,111] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-22 01:23:29,111] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-22 01:23:29,111] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-22 01:23:29,111] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-22 01:23:29,111] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-22 01:23:29,111] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-22 01:23:29,111] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f006cc8cfd0>
[2023-08-22 01:23:29,111] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-22 01:23:29,111] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-22 01:23:29,111] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-22 01:23:29,111] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-22 01:23:29,111] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-22 01:23:29,111] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-22 01:23:29,111] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-22 01:23:29,111] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-22 01:23:29,111] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-22 01:23:29,111] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-22 01:23:29,111] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-22 01:23:29,111] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-22 01:23:29,111] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-22 01:23:29,111] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-22 01:23:29,111] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-22 01:23:29,111] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-22 01:23:29,112] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-22 01:23:29,112] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-22 01:23:29,112] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-22 01:23:29,112] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-22 01:23:29,112] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-22 01:23:29,112] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-22 01:23:29,112] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-22 01:23:29,112] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-22 01:23:29,112] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-22 01:23:29,112] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-22 01:23:29,112] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-22 01:23:29,112] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-22 01:23:29,112] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-22 01:23:29,112] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-22 01:23:29,112] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-22 01:23:29,112] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-22 01:23:29,112] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f006c86e220>
[2023-08-22 01:23:29,112] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-22 01:23:29,112] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-22 01:23:29,112] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-22 01:23:29,112] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-22 01:23:29,112] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-22 01:23:29,112] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-22 01:23:29,112] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-22 01:23:29,112] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-22 01:23:29,112] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-22 01:23:29,112] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-22 01:23:29,112] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-22 01:23:29,112] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-22 01:23:29,112] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-22 01:23:29,112] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-22 01:23:29,112] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-22 01:23:29,112] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-22 01:23:29,112] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-22 01:23:29,112] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-22 01:23:29,112] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-22 01:23:29,112] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-22 01:23:29,112] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-22 01:23:29,112] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-22 01:23:29,112] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.5398778915405273 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: Fabric is cut to order at what type of seller? Choices:  A: curtains B: tailor shop C: clothing store D: sewing room E: hardware store
Output: 1. We first need to understand the question, which is asking us where fabric is cut according to a specific order.
2. Then, we examine each of the answer choices and think about which type of seller has the capability to cut fabric to order.
3. Choice A is curtains and while fabric is often used to make curtains, a curtain store would typically sell pre-made curtains, rather than cutting fabric.
4. Choice C is a clothing store. While clothing stores do sell products made from fabric, they usually are not involved in the cutting and tailoring process of the fabric itself.
5. Choice D is a sewing room. This is a broad term and could refer to many different scenarios. While fabric might be cut in a sewing room, it is not a "seller".
6. Choice E is a hardware store, which is commonly associated with tools and equipment for home and construction use, so it does not seem to match the requirement of the question.
7. Therefore, the most logical answer is choice B: tailor shop. Tailor shops are where clothes are tailored to a customer's specific measurement, which requires cutting fabric according to orders.
So the final answer is B: tailor shop

Input: Where are you if your reading magazines while waiting for a vehicle on rails? Choices:  A: vegetables B: market C: doctor D: train station E: bookstore
Output: 1. The question asked where you are if you're waiting for a vehicle on rails while reading magazines. 
2. First, we look at what types of vehicles use rails. The most common type of rail vehicle is a train. 
3. The places where you generally wait for a train are train stations. 
4. While reading magazines can technically be done anywhere, the phrase is included in the same sentence as waiting for a rail vehicle, implying that these two activities are occurring in the same location. 
5. Therefore, given the options available, the answer that makes most sense is D: train station, as that is the location where you would typically wait for a vehicle like a train and it is plausible to read magazines while waiting.
So the final answer is D: train station

Input: What would need oil to be used? Choices:  A: ground B: human  body C: repair shop D: combustion engines E: service station
Output: 1. The question asks for a situation or a thing that requires oil for operational use.
2. We begin by analyzing each of the provided options. 
3. The first option is "Ground". Ground or soil generally does not require the use of oil. There are some instances where oil is applied to soil, such as in the case of oil spill cleanups, but in general context, ground does not require oil to function.
4. The second option is "Human body". While our bodies do need fats and oils as part of a balanced diet for our general health, we do not use or consume 'oil' as it is made for machineries in general setting. Therefore, this option doesn't fit well.
5. The third option is "Repair shop". Repair shops may use oil for various purposes, particularly to lubricate machinery parts. However, the oil is not used 'by' the repair shop itself, instead it's used for the objects being repaired within the shop.
6. The fourth option is "Combustion engines". Combustion engines, which are prevalent in many cars and other vehicles, require oil as a lubricant to ensure the parts inside the engine operate smoothly and without excess heat. This fits the requirement perfectly.
7. The fifth option is "Service station". Similar to "Repair shop", Service stations themselves do not'require' oil but they do keep or sell oil for the vehicles which need it.
8. Thus, by analyzing each of the answer choices, we find that 'Combustion engines' is the best answer because it requires oil for its operation.
So the final answer is D: combustion engines

Input: What is person probably feeling that plans on stopping being married to their spouse? Choices:  A: detachment B: bankruptcy C: sad D: fights E: wrong
Output: 1. The question pertains to what a person is probably feeling if they are planning on stopping being married to their spouse. This means we need to find a choice that relates to emotions or feelings associated with ending a marriage.
2. Let’s evaluate the given choices: A: detachment B: bankruptcy C: sad D: fights E: wrong
3. Choice B: Bankruptcy, is more related to financial problems, not to feelings or emotions.
4. Choice C: Sad, could be a possible choice as it's an emotion but it might not necessarily be what someone plans on stopping being married is primarily feeling. 
5. Choice D: Fights, is a situation or event rather than a feeling so it doesn't quite fit.
6. Choice E: Wrong, though a feeling, it does not uniquely or specifically relate to the situation of planning to end a marriage.
7. Choice A: Detachment, it refers to a state of being disengaged or separated. In the context of marriage, it is often felt when someone plans on ending the relationship. It represents the emotional state of no longer feeling connected or committed to their spouse.
8. Hence, choice A: Detachment, is the most suitable answer to this situation.
So the final answer is A: detachment

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i4-s10-rTrue
Loading extension module utils...
Time to load utils op: 0.4051017761230469 seconds
Loading extension module utils...
Time to load utils op: 0.5046744346618652 seconds
Loading extension module utils...
Time to load utils op: 0.5047779083251953 seconds
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:40<32:47, 40.15s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:19<31:45, 39.69s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [01:58<30:52, 39.42s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [02:37<30:09, 39.34s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [03:17<29:30, 39.35s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [03:56<28:49, 39.32s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [04:35<28:13, 39.39s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [05:15<27:40, 39.54s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [05:55<27:04, 39.62s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [06:34<26:20, 39.52s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [07:14<25:41, 39.52s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [07:53<24:59, 39.45s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [08:33<24:19, 39.45s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [09:12<23:37, 39.38s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [09:51<22:56, 39.32s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [10:30<22:16, 39.30s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [11:10<21:37, 39.32s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [11:49<20:58, 39.33s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [12:28<20:17, 39.29s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [13:08<19:40, 39.35s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [13:47<19:01, 39.35s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [14:27<18:22, 39.38s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [15:06<17:43, 39.38s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [15:45<17:03, 39.36s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [16:25<16:23, 39.35s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [17:04<15:44, 39.35s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [17:43<15:03, 39.29s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [18:22<14:25, 39.32s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [19:02<13:45, 39.32s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [19:41<13:05, 39.30s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [20:20<12:26, 39.29s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [21:00<11:47, 39.28s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [21:39<11:07, 39.26s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [22:18<10:29, 39.32s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [22:58<09:49, 39.31s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [23:37<09:10, 39.32s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [24:16<08:31, 39.31s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [24:56<07:51, 39.33s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [25:35<07:12, 39.33s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [26:14<06:32, 39.29s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [26:54<05:54, 39.36s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [27:33<05:14, 39.32s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [28:12<04:35, 39.40s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [28:52<03:55, 39.33s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [29:31<03:16, 39.34s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [30:10<02:37, 39.29s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [30:50<01:57, 39.33s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [31:29<01:18, 39.33s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [32:08<00:39, 39.29s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [32:47<00:00, 39.26s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [32:47<00:00, 39.35s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 1.6458} | avg. gen lenth: 422.676
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i5-s10-rTrue --seed 10 --max-prompt-length 2048 --rationales --num-in-domain 5
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-22 01:56:24,749] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i5-s10-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 5
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i5-s10-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 10
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9736 [00:00<?, ?it/s]  0%|                                                      | 19/9736 [00:00<00:52, 186.14it/s]  0%|▏                                                     | 38/9736 [00:00<00:51, 186.95it/s]  1%|▎                                                     | 57/9736 [00:00<00:51, 187.34it/s]  1%|▍                                                     | 76/9736 [00:00<00:51, 187.68it/s]  1%|▌                                                     | 95/9736 [00:00<00:51, 187.70it/s]  1%|▌                                                    | 114/9736 [00:00<00:51, 187.86it/s]  1%|▋                                                    | 133/9736 [00:00<00:51, 185.20it/s]  2%|▊                                                    | 152/9736 [00:00<00:51, 186.03it/s]  2%|▉                                                    | 171/9736 [00:00<00:51, 186.68it/s]  2%|█                                                    | 190/9736 [00:01<00:51, 186.81it/s]  2%|█▏                                                   | 209/9736 [00:01<00:51, 185.66it/s]  2%|█▏                                                   | 228/9736 [00:01<00:51, 186.34it/s]  3%|█▎                                                   | 247/9736 [00:01<00:50, 186.80it/s]  3%|█▍                                                   | 266/9736 [00:01<00:50, 187.03it/s]  3%|█▌                                                   | 285/9736 [00:01<00:50, 187.10it/s]  3%|█▋                                                   | 304/9736 [00:01<00:50, 187.45it/s]  3%|█▊                                                   | 323/9736 [00:01<00:50, 185.38it/s]  4%|█▊                                                   | 342/9736 [00:01<00:50, 185.85it/s]  4%|█▉                                                   | 361/9736 [00:01<00:50, 186.38it/s]  4%|██                                                   | 380/9736 [00:02<00:50, 186.96it/s]  4%|██▏                                                  | 399/9736 [00:02<00:49, 187.31it/s]  4%|██▎                                                  | 426/9736 [00:02<00:44, 211.49it/s]  5%|██▍                                                  | 454/9736 [00:02<00:40, 231.36it/s]  5%|██▋                                                  | 483/9736 [00:02<00:37, 247.57it/s]  5%|██▊                                                  | 512/9736 [00:02<00:35, 259.04it/s]  6%|██▉                                                  | 541/9736 [00:02<00:34, 267.21it/s]  6%|███                                                  | 570/9736 [00:02<00:33, 272.45it/s]  6%|███▎                                                 | 599/9736 [00:02<00:33, 276.44it/s]  6%|███▍                                                 | 628/9736 [00:02<00:32, 279.21it/s]  7%|███▌                                                 | 656/9736 [00:03<00:32, 279.28it/s]  7%|███▋                                                 | 685/9736 [00:03<00:32, 281.36it/s]  7%|███▉                                                 | 714/9736 [00:03<00:31, 282.68it/s]  8%|████                                                 | 743/9736 [00:03<00:31, 283.53it/s]  8%|████▏                                                | 772/9736 [00:03<00:31, 284.23it/s]  8%|████▎                                                | 801/9736 [00:03<00:31, 284.73it/s]  9%|████▌                                                | 830/9736 [00:03<00:31, 284.88it/s]  9%|████▋                                                | 859/9736 [00:03<00:31, 285.29it/s]  9%|████▊                                                | 888/9736 [00:03<00:31, 283.62it/s]  9%|████▉                                                | 917/9736 [00:03<00:31, 284.29it/s] 10%|█████▏                                               | 946/9736 [00:04<00:30, 284.74it/s] 10%|█████▎                                               | 975/9736 [00:04<00:30, 284.96it/s] 10%|█████▎                                              | 1004/9736 [00:04<00:30, 283.95it/s] 11%|█████▌                                              | 1033/9736 [00:04<00:30, 284.27it/s] 11%|█████▋                                              | 1062/9736 [00:04<00:30, 284.49it/s] 11%|█████▊                                              | 1091/9736 [00:04<00:30, 285.01it/s] 12%|█████▉                                              | 1120/9736 [00:04<00:30, 283.15it/s] 12%|██████▏                                             | 1149/9736 [00:04<00:30, 283.50it/s] 12%|██████▎                                             | 1178/9736 [00:04<00:30, 283.86it/s] 12%|██████▍                                             | 1207/9736 [00:04<00:30, 283.94it/s] 13%|██████▌                                             | 1236/9736 [00:05<00:29, 283.94it/s] 13%|██████▊                                             | 1265/9736 [00:05<00:29, 284.03it/s] 13%|██████▉                                             | 1294/9736 [00:05<00:29, 284.20it/s] 14%|███████                                             | 1323/9736 [00:05<00:29, 284.09it/s] 14%|███████▏                                            | 1352/9736 [00:05<00:29, 282.35it/s] 14%|███████▍                                            | 1381/9736 [00:05<00:29, 280.36it/s] 14%|███████▌                                            | 1410/9736 [00:05<00:29, 281.44it/s] 15%|███████▋                                            | 1439/9736 [00:05<00:29, 282.08it/s] 15%|███████▊                                            | 1468/9736 [00:05<00:29, 282.74it/s] 15%|███████▉                                            | 1497/9736 [00:06<00:29, 283.17it/s] 16%|████████▏                                           | 1526/9736 [00:06<00:28, 283.37it/s] 16%|████████▎                                           | 1555/9736 [00:06<00:28, 283.52it/s] 16%|████████▍                                           | 1584/9736 [00:06<00:28, 281.63it/s] 17%|████████▌                                           | 1613/9736 [00:06<00:28, 282.15it/s] 17%|████████▊                                           | 1642/9736 [00:06<00:28, 282.84it/s] 17%|████████▉                                           | 1671/9736 [00:06<00:28, 283.36it/s] 17%|█████████                                           | 1700/9736 [00:06<00:28, 283.51it/s] 18%|█████████▏                                          | 1729/9736 [00:06<00:28, 283.32it/s] 18%|█████████▍                                          | 1758/9736 [00:06<00:28, 280.80it/s] 18%|█████████▌                                          | 1787/9736 [00:07<00:28, 281.56it/s] 19%|█████████▋                                          | 1816/9736 [00:07<00:31, 254.33it/s] 19%|█████████▊                                          | 1845/9736 [00:07<00:30, 262.31it/s] 19%|██████████                                          | 1874/9736 [00:07<00:29, 268.33it/s] 20%|██████████▏                                         | 1903/9736 [00:07<00:28, 272.91it/s] 20%|██████████▎                                         | 1932/9736 [00:07<00:28, 275.35it/s] 20%|██████████▍                                         | 1961/9736 [00:07<00:27, 277.81it/s] 20%|██████████▋                                         | 1990/9736 [00:07<00:27, 279.58it/s] 21%|██████████▊                                         | 2019/9736 [00:07<00:27, 279.11it/s] 21%|██████████▉                                         | 2048/9736 [00:07<00:27, 280.27it/s] 21%|███████████                                         | 2077/9736 [00:08<00:27, 281.01it/s] 22%|███████████▏                                        | 2106/9736 [00:08<00:27, 281.00it/s] 22%|███████████▍                                        | 2135/9736 [00:08<00:26, 281.58it/s] 22%|███████████▌                                        | 2164/9736 [00:08<00:26, 282.22it/s] 23%|███████████▋                                        | 2193/9736 [00:08<00:26, 282.68it/s] 23%|███████████▊                                        | 2222/9736 [00:08<00:26, 283.06it/s] 23%|████████████                                        | 2251/9736 [00:08<00:26, 281.27it/s] 23%|████████████▏                                       | 2280/9736 [00:08<00:26, 282.02it/s] 24%|████████████▎                                       | 2309/9736 [00:08<00:26, 282.51it/s] 24%|████████████▍                                       | 2338/9736 [00:09<00:26, 282.57it/s] 24%|████████████▋                                       | 2367/9736 [00:09<00:26, 282.59it/s] 25%|████████████▊                                       | 2396/9736 [00:09<00:25, 282.53it/s] 25%|████████████▉                                       | 2425/9736 [00:09<00:25, 282.86it/s] 25%|█████████████                                       | 2454/9736 [00:09<00:25, 282.97it/s] 26%|█████████████▎                                      | 2483/9736 [00:09<00:25, 280.98it/s] 26%|█████████████▍                                      | 2512/9736 [00:09<00:25, 281.65it/s] 26%|█████████████▌                                      | 2541/9736 [00:09<00:25, 281.87it/s] 26%|█████████████▋                                      | 2570/9736 [00:09<00:25, 282.35it/s] 27%|█████████████▉                                      | 2599/9736 [00:09<00:25, 282.82it/s] 27%|██████████████                                      | 2628/9736 [00:10<00:25, 281.18it/s] 27%|██████████████▏                                     | 2657/9736 [00:10<00:25, 280.21it/s] 28%|██████████████▎                                     | 2686/9736 [00:10<00:25, 279.92it/s] 28%|██████████████▍                                     | 2714/9736 [00:10<00:25, 278.95it/s] 28%|██████████████▋                                     | 2743/9736 [00:10<00:24, 280.09it/s] 28%|██████████████▊                                     | 2772/9736 [00:10<00:24, 280.82it/s] 29%|██████████████▉                                     | 2801/9736 [00:10<00:24, 281.37it/s] 29%|███████████████                                     | 2830/9736 [00:10<00:24, 281.73it/s] 29%|███████████████▎                                    | 2859/9736 [00:10<00:24, 282.04it/s] 30%|███████████████▍                                    | 2888/9736 [00:10<00:24, 282.30it/s] 30%|███████████████▌                                    | 2917/9736 [00:11<00:24, 282.06it/s] 30%|███████████████▋                                    | 2946/9736 [00:11<00:24, 280.00it/s] 31%|███████████████▉                                    | 2975/9736 [00:11<00:24, 280.90it/s] 31%|████████████████                                    | 3004/9736 [00:11<00:23, 281.67it/s] 31%|████████████████▏                                   | 3033/9736 [00:11<00:23, 282.01it/s] 31%|████████████████▎                                   | 3062/9736 [00:11<00:23, 282.15it/s] 32%|████████████████▌                                   | 3091/9736 [00:11<00:23, 282.41it/s] 32%|████████████████▋                                   | 3120/9736 [00:11<00:23, 282.55it/s] 32%|████████████████▊                                   | 3149/9736 [00:11<00:23, 282.43it/s] 33%|████████████████▉                                   | 3178/9736 [00:12<00:23, 280.82it/s] 33%|█████████████████▏                                  | 3207/9736 [00:12<00:23, 281.60it/s] 33%|█████████████████▎                                  | 3236/9736 [00:12<00:23, 281.86it/s] 34%|█████████████████▍                                  | 3265/9736 [00:12<00:22, 282.19it/s] 34%|█████████████████▌                                  | 3294/9736 [00:12<00:22, 282.14it/s] 34%|█████████████████▋                                  | 3323/9736 [00:12<00:22, 282.02it/s] 34%|█████████████████▉                                  | 3352/9736 [00:12<00:22, 282.14it/s] 35%|██████████████████                                  | 3381/9736 [00:12<00:22, 280.21it/s] 35%|██████████████████▏                                 | 3410/9736 [00:12<00:22, 280.92it/s] 35%|██████████████████▎                                 | 3439/9736 [00:12<00:22, 281.29it/s] 36%|██████████████████▌                                 | 3468/9736 [00:13<00:22, 281.56it/s] 36%|██████████████████▋                                 | 3497/9736 [00:13<00:22, 281.28it/s] 36%|██████████████████▊                                 | 3526/9736 [00:13<00:22, 281.32it/s] 37%|██████████████████▉                                 | 3555/9736 [00:13<00:22, 280.60it/s] 37%|███████████████████▏                                | 3584/9736 [00:13<00:21, 280.76it/s] 37%|███████████████████▎                                | 3613/9736 [00:13<00:21, 279.26it/s] 37%|███████████████████▍                                | 3642/9736 [00:13<00:21, 280.20it/s] 38%|███████████████████▌                                | 3671/9736 [00:13<00:21, 280.61it/s] 38%|███████████████████▊                                | 3700/9736 [00:13<00:21, 281.20it/s] 38%|███████████████████▉                                | 3729/9736 [00:13<00:21, 281.59it/s] 39%|████████████████████                                | 3758/9736 [00:14<00:21, 281.67it/s] 39%|████████████████████▏                               | 3787/9736 [00:14<00:21, 281.65it/s] 39%|████████████████████▍                               | 3816/9736 [00:14<00:21, 281.84it/s] 39%|████████████████████▌                               | 3845/9736 [00:14<00:21, 280.10it/s] 40%|████████████████████▋                               | 3874/9736 [00:14<00:20, 280.67it/s] 40%|████████████████████▊                               | 3903/9736 [00:14<00:20, 281.30it/s] 40%|█████████████████████                               | 3932/9736 [00:14<00:20, 281.47it/s] 41%|█████████████████████▏                              | 3961/9736 [00:14<00:20, 281.47it/s] 41%|█████████████████████▎                              | 3990/9736 [00:14<00:20, 280.92it/s] 41%|█████████████████████▍                              | 4019/9736 [00:15<00:20, 280.81it/s] 42%|█████████████████████▌                              | 4048/9736 [00:15<00:20, 280.41it/s] 42%|█████████████████████▊                              | 4077/9736 [00:15<00:20, 279.14it/s] 42%|█████████████████████▉                              | 4106/9736 [00:15<00:20, 280.02it/s] 42%|██████████████████████                              | 4135/9736 [00:15<00:19, 280.53it/s] 43%|██████████████████████▏                             | 4164/9736 [00:15<00:19, 281.02it/s] 43%|██████████████████████▍                             | 4193/9736 [00:15<00:19, 281.36it/s] 43%|██████████████████████▌                             | 4222/9736 [00:15<00:19, 281.60it/s] 44%|██████████████████████▋                             | 4251/9736 [00:15<00:19, 281.91it/s] 44%|██████████████████████▊                             | 4280/9736 [00:15<00:19, 282.01it/s] 44%|███████████████████████                             | 4309/9736 [00:16<00:19, 280.02it/s] 45%|███████████████████████▏                            | 4338/9736 [00:16<00:19, 280.62it/s] 45%|███████████████████████▎                            | 4367/9736 [00:16<00:19, 280.73it/s] 45%|███████████████████████▍                            | 4396/9736 [00:16<00:19, 280.33it/s] 45%|███████████████████████▋                            | 4425/9736 [00:16<00:18, 280.79it/s] 46%|███████████████████████▊                            | 4454/9736 [00:16<00:18, 281.29it/s] 46%|███████████████████████▉                            | 4483/9736 [00:16<00:18, 281.65it/s] 46%|████████████████████████                            | 4512/9736 [00:16<00:18, 280.37it/s] 47%|████████████████████████▎                           | 4541/9736 [00:16<00:20, 258.29it/s] 47%|████████████████████████▍                           | 4570/9736 [00:16<00:19, 264.84it/s] 47%|████████████████████████▌                           | 4599/9736 [00:17<00:19, 269.78it/s] 48%|████████████████████████▋                           | 4628/9736 [00:17<00:18, 273.31it/s] 48%|████████████████████████▊                           | 4657/9736 [00:17<00:18, 275.56it/s] 48%|█████████████████████████                           | 4686/9736 [00:17<00:18, 277.24it/s] 48%|█████████████████████████▏                          | 4715/9736 [00:17<00:18, 278.35it/s] 49%|█████████████████████████▎                          | 4743/9736 [00:17<00:25, 194.41it/s] 49%|█████████████████████████▍                          | 4772/9736 [00:17<00:23, 214.30it/s] 49%|█████████████████████████▋                          | 4801/9736 [00:17<00:21, 230.87it/s] 50%|█████████████████████████▊                          | 4830/9736 [00:18<00:20, 243.87it/s] 50%|█████████████████████████▉                          | 4859/9736 [00:18<00:19, 253.92it/s] 50%|██████████████████████████                          | 4888/9736 [00:18<00:18, 262.49it/s] 50%|██████████████████████████▎                         | 4916/9736 [00:18<00:18, 266.57it/s] 51%|██████████████████████████▍                         | 4945/9736 [00:18<00:17, 270.93it/s] 51%|██████████████████████████▌                         | 4974/9736 [00:18<00:17, 275.49it/s] 51%|██████████████████████████▋                         | 5003/9736 [00:18<00:16, 278.90it/s] 52%|██████████████████████████▉                         | 5032/9736 [00:18<00:16, 281.30it/s] 52%|███████████████████████████                         | 5061/9736 [00:18<00:16, 282.81it/s] 52%|███████████████████████████▏                        | 5090/9736 [00:18<00:16, 283.67it/s] 53%|███████████████████████████▎                        | 5119/9736 [00:19<00:16, 284.64it/s] 53%|███████████████████████████▍                        | 5148/9736 [00:19<00:16, 285.35it/s] 53%|███████████████████████████▋                        | 5177/9736 [00:19<00:16, 283.80it/s] 53%|███████████████████████████▊                        | 5206/9736 [00:19<00:15, 284.61it/s] 54%|███████████████████████████▉                        | 5235/9736 [00:19<00:15, 285.19it/s] 54%|████████████████████████████                        | 5264/9736 [00:19<00:15, 285.56it/s] 54%|████████████████████████████▎                       | 5293/9736 [00:19<00:15, 285.95it/s] 55%|████████████████████████████▍                       | 5322/9736 [00:19<00:15, 286.17it/s] 55%|████████████████████████████▌                       | 5351/9736 [00:19<00:15, 285.78it/s] 55%|████████████████████████████▋                       | 5380/9736 [00:19<00:15, 285.76it/s] 56%|████████████████████████████▉                       | 5409/9736 [00:20<00:15, 281.66it/s] 56%|█████████████████████████████                       | 5438/9736 [00:20<00:15, 283.21it/s] 56%|█████████████████████████████▏                      | 5467/9736 [00:20<00:15, 284.20it/s] 56%|█████████████████████████████▎                      | 5497/9736 [00:20<00:14, 286.98it/s] 57%|█████████████████████████████▌                      | 5527/9736 [00:20<00:14, 289.11it/s] 57%|█████████████████████████████▋                      | 5557/9736 [00:20<00:14, 290.81it/s] 57%|█████████████████████████████▊                      | 5587/9736 [00:20<00:14, 291.76it/s] 58%|██████████████████████████████                      | 5617/9736 [00:20<00:14, 292.24it/s] 58%|██████████████████████████████▏                     | 5647/9736 [00:20<00:14, 290.55it/s] 58%|██████████████████████████████▎                     | 5677/9736 [00:21<00:13, 291.89it/s] 59%|██████████████████████████████▍                     | 5707/9736 [00:21<00:13, 292.76it/s] 59%|██████████████████████████████▋                     | 5737/9736 [00:21<00:13, 293.61it/s] 59%|██████████████████████████████▊                     | 5767/9736 [00:21<00:13, 293.95it/s] 60%|██████████████████████████████▉                     | 5797/9736 [00:21<00:13, 294.32it/s] 60%|███████████████████████████████                     | 5827/9736 [00:21<00:13, 294.24it/s] 60%|███████████████████████████████▎                    | 5857/9736 [00:21<00:13, 291.66it/s] 60%|███████████████████████████████▍                    | 5887/9736 [00:21<00:13, 292.36it/s] 61%|███████████████████████████████▌                    | 5917/9736 [00:21<00:13, 290.12it/s] 61%|███████████████████████████████▊                    | 5947/9736 [00:21<00:13, 291.31it/s] 61%|███████████████████████████████▉                    | 5977/9736 [00:22<00:12, 292.33it/s] 62%|████████████████████████████████                    | 6007/9736 [00:22<00:12, 293.04it/s] 62%|████████████████████████████████▏                   | 6037/9736 [00:22<00:12, 293.54it/s] 62%|████████████████████████████████▍                   | 6067/9736 [00:22<00:12, 293.78it/s] 63%|████████████████████████████████▌                   | 6097/9736 [00:22<00:12, 292.22it/s] 63%|████████████████████████████████▋                   | 6127/9736 [00:22<00:12, 292.73it/s] 63%|████████████████████████████████▉                   | 6157/9736 [00:22<00:12, 292.63it/s] 64%|█████████████████████████████████                   | 6187/9736 [00:22<00:12, 293.08it/s] 64%|█████████████████████████████████▏                  | 6217/9736 [00:22<00:12, 292.51it/s] 64%|█████████████████████████████████▎                  | 6247/9736 [00:22<00:11, 292.56it/s] 64%|█████████████████████████████████▌                  | 6277/9736 [00:23<00:11, 293.16it/s] 65%|█████████████████████████████████▋                  | 6307/9736 [00:23<00:11, 291.68it/s] 65%|█████████████████████████████████▊                  | 6337/9736 [00:23<00:11, 292.62it/s] 65%|██████████████████████████████████                  | 6367/9736 [00:23<00:11, 293.26it/s] 66%|██████████████████████████████████▏                 | 6397/9736 [00:23<00:11, 291.23it/s] 66%|██████████████████████████████████▎                 | 6427/9736 [00:23<00:11, 291.87it/s] 66%|██████████████████████████████████▍                 | 6457/9736 [00:23<00:11, 292.44it/s] 67%|██████████████████████████████████▋                 | 6487/9736 [00:23<00:11, 292.38it/s] 67%|██████████████████████████████████▊                 | 6517/9736 [00:23<00:10, 292.68it/s] 67%|██████████████████████████████████▉                 | 6547/9736 [00:23<00:10, 290.96it/s] 68%|███████████████████████████████████▏                | 6577/9736 [00:24<00:10, 291.91it/s] 68%|███████████████████████████████████▎                | 6607/9736 [00:24<00:10, 292.56it/s] 68%|███████████████████████████████████▍                | 6637/9736 [00:24<00:10, 293.29it/s] 68%|███████████████████████████████████▌                | 6667/9736 [00:24<00:10, 293.69it/s] 69%|███████████████████████████████████▊                | 6697/9736 [00:24<00:10, 293.60it/s] 69%|███████████████████████████████████▉                | 6727/9736 [00:24<00:10, 293.85it/s] 69%|████████████████████████████████████                | 6757/9736 [00:24<00:10, 294.27it/s] 70%|████████████████████████████████████▏               | 6787/9736 [00:24<00:10, 291.27it/s] 70%|████████████████████████████████████▍               | 6817/9736 [00:24<00:10, 291.00it/s] 70%|████████████████████████████████████▌               | 6847/9736 [00:25<00:09, 291.69it/s] 71%|████████████████████████████████████▋               | 6877/9736 [00:25<00:09, 292.65it/s] 71%|████████████████████████████████████▉               | 6907/9736 [00:25<00:09, 290.22it/s] 71%|█████████████████████████████████████               | 6937/9736 [00:25<00:09, 291.43it/s] 72%|█████████████████████████████████████▏              | 6967/9736 [00:25<00:09, 292.35it/s] 72%|█████████████████████████████████████▎              | 6997/9736 [00:25<00:09, 290.99it/s] 72%|█████████████████████████████████████▌              | 7027/9736 [00:25<00:09, 291.96it/s] 72%|█████████████████████████████████████▋              | 7057/9736 [00:25<00:09, 292.89it/s] 73%|█████████████████████████████████████▊              | 7087/9736 [00:25<00:09, 293.50it/s] 73%|██████████████████████████████████████              | 7117/9736 [00:25<00:08, 293.84it/s] 73%|██████████████████████████████████████▏             | 7147/9736 [00:26<00:08, 294.25it/s] 74%|██████████████████████████████████████▎             | 7177/9736 [00:26<00:08, 294.39it/s] 74%|██████████████████████████████████████▍             | 7207/9736 [00:26<00:08, 294.39it/s] 74%|██████████████████████████████████████▋             | 7237/9736 [00:26<00:08, 292.58it/s] 75%|██████████████████████████████████████▊             | 7267/9736 [00:26<00:08, 293.12it/s] 75%|██████████████████████████████████████▉             | 7297/9736 [00:26<00:08, 292.86it/s] 75%|███████████████████████████████████████▏            | 7327/9736 [00:26<00:08, 293.47it/s] 76%|███████████████████████████████████████▎            | 7357/9736 [00:26<00:08, 293.82it/s] 76%|███████████████████████████████████████▍            | 7387/9736 [00:26<00:08, 293.49it/s] 76%|███████████████████████████████████████▌            | 7417/9736 [00:26<00:07, 293.24it/s] 76%|███████████████████████████████████████▊            | 7447/9736 [00:27<00:08, 260.18it/s] 77%|███████████████████████████████████████▉            | 7477/9736 [00:27<00:08, 269.40it/s] 77%|████████████████████████████████████████            | 7507/9736 [00:27<00:08, 276.29it/s] 77%|████████████████████████████████████████▎           | 7537/9736 [00:27<00:07, 281.33it/s] 78%|████████████████████████████████████████▍           | 7567/9736 [00:27<00:07, 285.08it/s] 78%|████████████████████████████████████████▌           | 7597/9736 [00:27<00:07, 287.61it/s] 78%|████████████████████████████████████████▋           | 7627/9736 [00:27<00:07, 289.41it/s] 79%|████████████████████████████████████████▉           | 7657/9736 [00:27<00:07, 290.50it/s] 79%|█████████████████████████████████████████           | 7687/9736 [00:27<00:07, 289.75it/s] 79%|█████████████████████████████████████████▏          | 7717/9736 [00:28<00:06, 291.25it/s] 80%|█████████████████████████████████████████▍          | 7747/9736 [00:28<00:06, 292.17it/s] 80%|█████████████████████████████████████████▌          | 7777/9736 [00:28<00:06, 292.53it/s] 80%|█████████████████████████████████████████▋          | 7807/9736 [00:28<00:06, 292.90it/s] 80%|█████████████████████████████████████████▊          | 7837/9736 [00:28<00:06, 293.30it/s] 81%|██████████████████████████████████████████          | 7867/9736 [00:28<00:06, 293.45it/s] 81%|██████████████████████████████████████████▏         | 7897/9736 [00:28<00:06, 292.00it/s] 81%|██████████████████████████████████████████▎         | 7927/9736 [00:28<00:06, 292.74it/s] 82%|██████████████████████████████████████████▍         | 7957/9736 [00:28<00:06, 292.83it/s] 82%|██████████████████████████████████████████▋         | 7987/9736 [00:28<00:05, 293.06it/s] 82%|██████████████████████████████████████████▊         | 8017/9736 [00:29<00:05, 291.67it/s] 83%|██████████████████████████████████████████▉         | 8047/9736 [00:29<00:05, 291.91it/s] 83%|███████████████████████████████████████████▏        | 8077/9736 [00:29<00:05, 292.51it/s] 83%|███████████████████████████████████████████▎        | 8107/9736 [00:29<00:05, 293.21it/s] 84%|███████████████████████████████████████████▍        | 8137/9736 [00:29<00:05, 291.42it/s] 84%|███████████████████████████████████████████▌        | 8167/9736 [00:29<00:05, 292.10it/s] 84%|███████████████████████████████████████████▊        | 8197/9736 [00:29<00:05, 292.67it/s] 85%|███████████████████████████████████████████▉        | 8227/9736 [00:29<00:05, 293.08it/s] 85%|████████████████████████████████████████████        | 8257/9736 [00:29<00:05, 293.22it/s] 85%|████████████████████████████████████████████▎       | 8287/9736 [00:29<00:04, 292.91it/s] 85%|████████████████████████████████████████████▍       | 8317/9736 [00:30<00:04, 293.09it/s] 86%|████████████████████████████████████████████▌       | 8347/9736 [00:30<00:04, 293.22it/s] 86%|████████████████████████████████████████████▋       | 8377/9736 [00:30<00:04, 291.83it/s] 86%|████████████████████████████████████████████▉       | 8407/9736 [00:30<00:04, 292.19it/s] 87%|█████████████████████████████████████████████       | 8437/9736 [00:30<00:04, 292.92it/s] 87%|█████████████████████████████████████████████▏      | 8467/9736 [00:30<00:04, 293.25it/s] 87%|█████████████████████████████████████████████▍      | 8497/9736 [00:30<00:04, 293.45it/s] 88%|█████████████████████████████████████████████▌      | 8527/9736 [00:30<00:04, 293.20it/s] 88%|█████████████████████████████████████████████▋      | 8557/9736 [00:30<00:04, 292.52it/s] 88%|█████████████████████████████████████████████▊      | 8587/9736 [00:31<00:03, 290.98it/s] 89%|██████████████████████████████████████████████      | 8617/9736 [00:31<00:03, 291.44it/s] 89%|██████████████████████████████████████████████▏     | 8647/9736 [00:31<00:03, 292.11it/s] 89%|██████████████████████████████████████████████▎     | 8677/9736 [00:31<00:03, 292.11it/s] 89%|██████████████████████████████████████████████▌     | 8707/9736 [00:31<00:03, 291.29it/s] 90%|██████████████████████████████████████████████▋     | 8737/9736 [00:31<00:03, 291.38it/s] 90%|██████████████████████████████████████████████▊     | 8767/9736 [00:31<00:03, 291.98it/s] 90%|██████████████████████████████████████████████▉     | 8797/9736 [00:31<00:03, 292.21it/s] 91%|███████████████████████████████████████████████▏    | 8827/9736 [00:31<00:03, 290.74it/s] 91%|███████████████████████████████████████████████▎    | 8857/9736 [00:31<00:03, 291.18it/s] 91%|███████████████████████████████████████████████▍    | 8887/9736 [00:32<00:02, 291.78it/s] 92%|███████████████████████████████████████████████▋    | 8917/9736 [00:32<00:02, 292.49it/s] 92%|███████████████████████████████████████████████▊    | 8947/9736 [00:32<00:02, 293.08it/s] 92%|███████████████████████████████████████████████▉    | 8977/9736 [00:32<00:02, 293.09it/s] 93%|████████████████████████████████████████████████    | 9007/9736 [00:32<00:02, 292.85it/s] 93%|████████████████████████████████████████████████▎   | 9037/9736 [00:32<00:02, 290.68it/s] 93%|████████████████████████████████████████████████▍   | 9067/9736 [00:32<00:02, 291.49it/s] 93%|████████████████████████████████████████████████▌   | 9097/9736 [00:32<00:02, 291.96it/s] 94%|████████████████████████████████████████████████▋   | 9127/9736 [00:32<00:02, 292.49it/s] 94%|████████████████████████████████████████████████▉   | 9157/9736 [00:32<00:01, 292.78it/s] 94%|█████████████████████████████████████████████████   | 9187/9736 [00:33<00:01, 293.12it/s] 95%|█████████████████████████████████████████████████▏  | 9217/9736 [00:33<00:01, 293.25it/s] 95%|█████████████████████████████████████████████████▍  | 9247/9736 [00:33<00:01, 293.61it/s] 95%|█████████████████████████████████████████████████▌  | 9277/9736 [00:33<00:01, 291.58it/s] 96%|█████████████████████████████████████████████████▋  | 9307/9736 [00:33<00:01, 292.06it/s] 96%|█████████████████████████████████████████████████▊  | 9337/9736 [00:33<00:01, 292.70it/s] 96%|██████████████████████████████████████████████████  | 9367/9736 [00:33<00:01, 293.21it/s] 97%|██████████████████████████████████████████████████▏ | 9397/9736 [00:33<00:01, 293.17it/s] 97%|██████████████████████████████████████████████████▎ | 9427/9736 [00:33<00:01, 293.08it/s] 97%|██████████████████████████████████████████████████▌ | 9457/9736 [00:33<00:00, 292.89it/s] 97%|██████████████████████████████████████████████████▋ | 9487/9736 [00:34<00:00, 291.11it/s] 98%|██████████████████████████████████████████████████▊ | 9517/9736 [00:34<00:00, 291.70it/s] 98%|██████████████████████████████████████████████████▉ | 9547/9736 [00:34<00:00, 292.10it/s] 98%|███████████████████████████████████████████████████▏| 9577/9736 [00:34<00:00, 292.45it/s] 99%|███████████████████████████████████████████████████▎| 9607/9736 [00:34<00:00, 292.44it/s] 99%|███████████████████████████████████████████████████▍| 9637/9736 [00:34<00:00, 292.33it/s] 99%|███████████████████████████████████████████████████▋| 9667/9736 [00:34<00:00, 291.37it/s]100%|███████████████████████████████████████████████████▊| 9697/9736 [00:34<00:00, 291.44it/s]100%|███████████████████████████████████████████████████▉| 9727/9736 [00:34<00:00, 289.84it/s]100%|████████████████████████████████████████████████████| 9736/9736 [00:34<00:00, 278.66it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:04<00:09,  4.96s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.36s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:11,  5.54s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.25s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.09s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.26s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.14s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.43s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.51s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.65s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.71s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.87s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.55s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.72s/it]
[2023-08-22 01:57:51,734] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  4.88s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  5.04s/it]
[2023-08-22 01:58:00,438] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-22 01:58:00,439] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-22 01:58:00,439] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-22 01:58:00,439] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-22 01:58:00,439] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-22 01:58:00,439] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-22 01:58:00,440] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-22 01:58:00,440] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-22 01:58:00,440] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-22 01:58:00,440] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-22 01:58:00,440] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-22 01:58:00,440] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fe531e55fd0>
[2023-08-22 01:58:00,440] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-22 01:58:00,440] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-22 01:58:00,440] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-22 01:58:00,440] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-22 01:58:00,440] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-22 01:58:00,440] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-22 01:58:00,440] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-22 01:58:00,440] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-22 01:58:00,440] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-22 01:58:00,440] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-22 01:58:00,440] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-22 01:58:00,440] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-22 01:58:00,440] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-22 01:58:00,440] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-22 01:58:00,440] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-22 01:58:00,440] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-22 01:58:00,440] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-22 01:58:00,440] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-22 01:58:00,440] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-22 01:58:00,440] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-22 01:58:00,440] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-22 01:58:00,440] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-22 01:58:00,440] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-22 01:58:00,440] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-22 01:58:00,440] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-22 01:58:00,440] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-22 01:58:00,440] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-22 01:58:00,440] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-22 01:58:00,440] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-22 01:58:00,440] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-22 01:58:00,440] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-22 01:58:00,440] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-22 01:58:00,440] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7fe530138220>
[2023-08-22 01:58:00,440] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-22 01:58:00,440] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-22 01:58:00,441] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-22 01:58:00,441] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-22 01:58:00,441] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-22 01:58:00,441] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-22 01:58:00,441] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-22 01:58:00,441] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-22 01:58:00,441] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-22 01:58:00,441] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-22 01:58:00,441] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-22 01:58:00,441] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-22 01:58:00,441] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-22 01:58:00,441] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-22 01:58:00,441] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-22 01:58:00,441] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-22 01:58:00,441] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-22 01:58:00,441] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-22 01:58:00,441] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-22 01:58:00,441] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-22 01:58:00,441] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-22 01:58:00,441] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-22 01:58:00,441] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.5789403915405273 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: Fabric is cut to order at what type of seller? Choices:  A: curtains B: tailor shop C: clothing store D: sewing room E: hardware store
Output: Step 1: Interpret the question. The question is asking where fabric is specifically cut to order. This would typically be a place that uses fabric for custom-made items. 
Step 2: Distinguish the choices. Evaluate each answer choice and what it typically is associated with.
A: Curtains - this choice is an item, not a seller, so it can be ruled out.
B: Tailor shop - This is a place where clothing is custom-made, therefore fabric would likely be cut to order here.
C: Clothing store - While fabric can be found here, it often already made into finished clothes not cut to order.
D: Sewing room - This is more of a location inside a home, not typically a seller.
E: Hardware store - These stores typically do not deal with fabric, so it can be ruled out.
Step 3: Conclude. The tailor shop is the type of seller where fabric is custom cut to order.
So the final answer is B: tailor shop

Input: Where are you if your reading magazines while waiting for a vehicle on rails? Choices:  A: vegetables B: market C: doctor D: train station E: bookstore
Output: 1. The question asks for a location where you could be waiting for a vehicle that moves on rails. 
2. This implies that the location must be some form of transportation hub or station, as these are the typical places where people wait for vehicles.
3. Out of all the choices given, options A, B, C and E, refer to places where people don't usually wait for vehicles that move on rails. 
4. A Train Station, choice D, is a place where people often wait for a vehicle which runs on rails - this vehicle being a train. 
5. Additionally, it is common for people to pass the time by reading magazines while waiting at a train station, which matches the content of the question.
6. Therefore, the correct answer is D: Train Station.
So the final answer is D: train station

Input: What would need oil to be used? Choices:  A: ground B: human  body C: repair shop D: combustion engines E: service station
Output: Step 1: Analyze each of the provided choices in relation to the need for oil.
Step 2: Choice A, the ground doesn't need oil to function or operate. Oil is usually extracted from the ground, not added to it.
Step 3: Choice B, human body doesn't typically require oil for any physiological processes. Although some oil-based products can be used for skincare or cooking, the human body itself does not require oil to function.
Step 4: Choices C and E, repair shop and service station, might use oil in the course of their operations, such as for oil changes, but they themselves don't require oil to exist or operate fundamentally.
Step 5: Choice D, combustion engines, require oil for proper lubrication and functioning. In the context of this question, 'what would need oil to be used', combustion engines is the most appropriate answer.
Step 6: Thus, the answer is D, combustion engines.
So the final answer is D: combustion engines

Input: What is person probably feeling that plans on stopping being married to their spouse? Choices:  A: detachment B: bankruptcy C: sad D: fights E: wrong
Output: 1. In answering this question, we need to consider the emotional state of someone who intends to end a marital relationship.
2. Choosing the option B: bankruptcy is not relevant because it pertains to financial situation, not the feelings of a person who plans on stopping their marriage.
3. Option C: Sad, could be a possible feeling, but it's not necessarily the predominant emotion someone intending to end a marriage might feel.
4. Option D: fights, describes a situation or occurrence rather than a person's emotional state.
5. Option E: wrong, also does not describe a person's emotional state correctly in the context of ending a marriage.
6. Hence, by process of elimination, we are left with option A: detachment.
7. Detachment probably best describes the feeling of emotional disconnection that a person planning to end their marriage is likely experiencing. They may have become unattached or withdrawn from their spouse, leading to the decision to end the marriage.
8. Therefore, the answer is A: Detachment.
So the final answer is A: detachment

Input: What could you use to store a clock? Choices:  A: shelf B: own bedroom C: desk D: wall E: car
Output: 1. In order to answer this question, we need to first understand the context. The question is requesting to name a place where a clock can be stored.
2. We then look at each of the options given to decide if it's appropriate for storing a clock.
3. Option A is'shelf'. It is common and practical to store or place a clock on a shelf. As it provides an adequate surface and visibility, a clock can function properly and can easily be seen when placed on a shelf.
4. Option B is 'own bedroom'. This is a large space that could contain a clock, but it's not specific about where inside the bedroom the clock would be stored. The clock would still need a specific surface or location within the bedroom and hence isn't the best answer.
5. Option C is 'desk'. A desk could also serve as a surface for placing a clock. However, it isn't generally the primary location for a clock and a desk already has many other objects like books, a computer, etc.
6. Option D is 'wall'. Although a wall is a typical place for wall clocks, the question does not specify what kind of clock is being discussed, making this choice less optimal.
7. Option E is 'car'. It is unusual to store or place a clock in a car, as most cars already have built-in clocks.
8. After reviewing all the given options, we can conclude that while a few options could be feasible, option A:'shelf' could be the best place to store a clock.
9. Therefore, the answer is A: shelf.
So the final answer is A: shelf

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i5-s10-rTrue
Loading extension module utils...
Time to load utils op: 0.6050567626953125 seconds
Loading extension module utils...
Time to load utils op: 0.5047047138214111 seconds
Loading extension module utils...
Time to load utils op: 0.5047707557678223 seconds
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:39<32:16, 39.52s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:18<31:13, 39.04s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [01:56<30:27, 38.88s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [02:35<29:46, 38.83s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [03:14<29:02, 38.72s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [03:53<28:25, 38.75s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [04:31<27:42, 38.66s/it]Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 126, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 123, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 107, in evaluate_main
    query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 89, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 3499777 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 3499778 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 3499779 closing signal SIGTERM
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 3 (pid: 3499780) of binary: /home/ylu130/.conda/envs/distllm/bin/python
Traceback (most recent call last):
  File "/home/ylu130/.conda/envs/distllm/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 345, in wrapper
    return f(*args, **kwargs)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 761, in main
    run(args)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 752, in run
    elastic_launch(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 131, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 245, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
/home/ylu130/workspace/in-context-generalization/inference.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2023-08-22_02:03:02
  host      : ia1.wse.jhu.edu
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 3499780)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i6-s10-rTrue --seed 10 --max-prompt-length 2048 --rationales --num-in-domain 6
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-22 02:03:07,008] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i6-s10-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 6
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i6-s10-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 10
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9735 [00:00<?, ?it/s]  0%|                                                      | 18/9735 [00:00<00:56, 172.10it/s]  0%|▏                                                     | 36/9735 [00:00<00:56, 172.22it/s]  1%|▎                                                     | 54/9735 [00:00<00:56, 172.61it/s]  1%|▍                                                     | 72/9735 [00:00<00:55, 172.70it/s]  1%|▍                                                     | 90/9735 [00:00<00:55, 172.80it/s]  1%|▌                                                    | 108/9735 [00:00<00:55, 172.99it/s]  1%|▋                                                    | 126/9735 [00:00<00:55, 172.92it/s]  1%|▊                                                    | 144/9735 [00:00<00:55, 172.93it/s]  2%|▉                                                    | 162/9735 [00:00<00:55, 173.00it/s]  2%|▉                                                    | 180/9735 [00:01<00:55, 171.00it/s]  2%|█                                                    | 198/9735 [00:01<00:55, 170.99it/s]  2%|█▏                                                   | 216/9735 [00:01<00:56, 169.84it/s]  2%|█▎                                                   | 234/9735 [00:01<00:55, 170.62it/s]  3%|█▎                                                   | 252/9735 [00:01<00:55, 171.08it/s]  3%|█▍                                                   | 270/9735 [00:01<00:55, 171.58it/s]  3%|█▌                                                   | 288/9735 [00:01<00:54, 171.89it/s]  3%|█▋                                                   | 306/9735 [00:01<00:54, 172.26it/s]  3%|█▊                                                   | 324/9735 [00:01<00:54, 172.28it/s]  4%|█▊                                                   | 342/9735 [00:01<00:54, 172.35it/s]  4%|█▉                                                   | 360/9735 [00:02<00:54, 170.87it/s]  4%|██                                                   | 378/9735 [00:02<00:54, 171.22it/s]  4%|██▏                                                  | 396/9735 [00:02<00:54, 171.62it/s]  4%|██▎                                                  | 414/9735 [00:02<00:54, 171.81it/s]  4%|██▎                                                  | 432/9735 [00:02<00:54, 169.89it/s]  5%|██▍                                                  | 450/9735 [00:02<00:54, 170.74it/s]  5%|██▌                                                  | 468/9735 [00:02<00:54, 171.20it/s]  5%|██▋                                                  | 487/9735 [00:02<00:52, 175.55it/s]  5%|██▊                                                  | 514/9735 [00:02<00:45, 201.63it/s]  6%|██▉                                                  | 541/9735 [00:03<00:41, 220.10it/s]  6%|███                                                  | 568/9735 [00:03<00:39, 232.81it/s]  6%|███▏                                                 | 595/9735 [00:03<00:37, 241.86it/s]  6%|███▍                                                 | 622/9735 [00:03<00:36, 248.10it/s]  7%|███▌                                                 | 649/9735 [00:03<00:35, 252.64it/s]  7%|███▋                                                 | 675/9735 [00:03<00:35, 254.05it/s]  7%|███▊                                                 | 702/9735 [00:03<00:35, 256.77it/s]  7%|███▉                                                 | 729/9735 [00:03<00:34, 258.25it/s]  8%|████                                                 | 756/9735 [00:03<00:34, 259.32it/s]  8%|████▎                                                | 783/9735 [00:03<00:34, 260.49it/s]  8%|████▍                                                | 810/9735 [00:04<00:34, 261.19it/s]  9%|████▌                                                | 837/9735 [00:04<00:34, 261.57it/s]  9%|████▋                                                | 864/9735 [00:04<00:33, 261.90it/s]  9%|████▊                                                | 891/9735 [00:04<00:34, 259.80it/s]  9%|████▉                                                | 918/9735 [00:04<00:33, 260.59it/s] 10%|█████▏                                               | 945/9735 [00:04<00:33, 261.20it/s] 10%|█████▎                                               | 972/9735 [00:04<00:33, 260.76it/s] 10%|█████▍                                               | 999/9735 [00:04<00:33, 261.28it/s] 11%|█████▍                                              | 1026/9735 [00:04<00:33, 261.69it/s] 11%|█████▌                                              | 1053/9735 [00:04<00:33, 261.99it/s] 11%|█████▊                                              | 1080/9735 [00:05<00:32, 262.28it/s] 11%|█████▉                                              | 1107/9735 [00:05<00:32, 262.31it/s] 12%|██████                                              | 1134/9735 [00:05<00:33, 260.52it/s] 12%|██████▏                                             | 1161/9735 [00:05<00:32, 260.89it/s] 12%|██████▎                                             | 1188/9735 [00:05<00:32, 261.34it/s] 12%|██████▍                                             | 1215/9735 [00:05<00:32, 261.51it/s] 13%|██████▋                                             | 1242/9735 [00:05<00:32, 261.71it/s] 13%|██████▊                                             | 1269/9735 [00:05<00:32, 261.91it/s] 13%|██████▉                                             | 1296/9735 [00:05<00:32, 262.01it/s] 14%|███████                                             | 1323/9735 [00:06<00:32, 259.76it/s] 14%|███████▏                                            | 1349/9735 [00:06<00:32, 258.76it/s] 14%|███████▎                                            | 1376/9735 [00:06<00:32, 259.81it/s] 14%|███████▍                                            | 1403/9735 [00:06<00:31, 260.39it/s] 15%|███████▋                                            | 1430/9735 [00:06<00:31, 260.76it/s] 15%|███████▊                                            | 1457/9735 [00:06<00:31, 261.05it/s] 15%|███████▉                                            | 1484/9735 [00:06<00:31, 261.30it/s] 16%|████████                                            | 1511/9735 [00:06<00:31, 261.04it/s] 16%|████████▏                                           | 1538/9735 [00:06<00:31, 260.90it/s] 16%|████████▎                                           | 1565/9735 [00:06<00:31, 259.22it/s] 16%|████████▌                                           | 1592/9735 [00:07<00:31, 259.74it/s] 17%|████████▋                                           | 1619/9735 [00:07<00:31, 260.30it/s] 17%|████████▊                                           | 1646/9735 [00:07<00:31, 260.80it/s] 17%|████████▉                                           | 1673/9735 [00:07<00:31, 258.45it/s] 17%|█████████                                           | 1700/9735 [00:07<00:30, 259.33it/s] 18%|█████████▏                                          | 1727/9735 [00:07<00:30, 259.90it/s] 18%|█████████▎                                          | 1754/9735 [00:07<00:30, 260.24it/s] 18%|█████████▌                                          | 1781/9735 [00:07<00:30, 260.38it/s] 19%|█████████▋                                          | 1808/9735 [00:07<00:33, 234.54it/s] 19%|█████████▊                                          | 1835/9735 [00:08<00:32, 241.91it/s] 19%|█████████▉                                          | 1862/9735 [00:08<00:31, 247.50it/s] 19%|██████████                                          | 1889/9735 [00:08<00:31, 251.47it/s] 20%|██████████▏                                         | 1916/9735 [00:08<00:30, 254.14it/s] 20%|██████████▍                                         | 1943/9735 [00:08<00:30, 256.09it/s] 20%|██████████▌                                         | 1970/9735 [00:08<00:30, 257.54it/s] 21%|██████████▋                                         | 1996/9735 [00:08<00:30, 257.87it/s] 21%|██████████▊                                         | 2022/9735 [00:08<00:30, 256.91it/s] 21%|██████████▉                                         | 2049/9735 [00:08<00:29, 257.83it/s] 21%|███████████                                         | 2076/9735 [00:08<00:29, 258.59it/s] 22%|███████████▏                                        | 2103/9735 [00:09<00:29, 259.05it/s] 22%|███████████▍                                        | 2130/9735 [00:09<00:29, 259.48it/s] 22%|███████████▌                                        | 2157/9735 [00:09<00:29, 259.97it/s] 22%|███████████▋                                        | 2184/9735 [00:09<00:29, 260.28it/s] 23%|███████████▊                                        | 2211/9735 [00:09<00:28, 260.46it/s] 23%|███████████▉                                        | 2238/9735 [00:09<00:28, 260.60it/s] 23%|████████████                                        | 2265/9735 [00:09<00:28, 258.98it/s] 24%|████████████▏                                       | 2291/9735 [00:09<00:28, 259.24it/s] 24%|████████████▍                                       | 2318/9735 [00:09<00:28, 259.55it/s] 24%|████████████▌                                       | 2345/9735 [00:09<00:28, 259.96it/s] 24%|████████████▋                                       | 2372/9735 [00:10<00:28, 260.30it/s] 25%|████████████▊                                       | 2399/9735 [00:10<00:28, 260.51it/s] 25%|████████████▉                                       | 2426/9735 [00:10<00:28, 260.89it/s] 25%|█████████████                                       | 2453/9735 [00:10<00:27, 261.02it/s] 25%|█████████████▏                                      | 2480/9735 [00:10<00:27, 259.30it/s] 26%|█████████████▍                                      | 2507/9735 [00:10<00:27, 259.80it/s] 26%|█████████████▌                                      | 2534/9735 [00:10<00:27, 260.05it/s] 26%|█████████████▋                                      | 2561/9735 [00:10<00:27, 260.17it/s] 27%|█████████████▊                                      | 2588/9735 [00:10<00:27, 260.42it/s] 27%|█████████████▉                                      | 2615/9735 [00:11<00:27, 260.41it/s] 27%|██████████████                                      | 2642/9735 [00:11<00:27, 260.28it/s] 27%|██████████████▎                                     | 2669/9735 [00:11<00:27, 260.44it/s] 28%|██████████████▍                                     | 2696/9735 [00:11<00:27, 260.36it/s] 28%|██████████████▌                                     | 2723/9735 [00:11<00:27, 258.59it/s] 28%|██████████████▋                                     | 2749/9735 [00:11<00:26, 258.99it/s] 29%|██████████████▊                                     | 2775/9735 [00:11<00:26, 259.07it/s] 29%|██████████████▉                                     | 2802/9735 [00:11<00:26, 259.49it/s] 29%|███████████████                                     | 2829/9735 [00:11<00:26, 259.82it/s] 29%|███████████████▎                                    | 2856/9735 [00:11<00:26, 260.16it/s] 30%|███████████████▍                                    | 2883/9735 [00:12<00:26, 258.53it/s] 30%|███████████████▌                                    | 2909/9735 [00:12<00:26, 258.41it/s] 30%|███████████████▋                                    | 2935/9735 [00:12<00:26, 257.45it/s] 30%|███████████████▊                                    | 2961/9735 [00:12<00:26, 257.88it/s] 31%|███████████████▉                                    | 2988/9735 [00:12<00:26, 258.76it/s] 31%|████████████████                                    | 3015/9735 [00:12<00:25, 259.23it/s] 31%|████████████████▏                                   | 3042/9735 [00:12<00:25, 259.60it/s] 32%|████████████████▍                                   | 3068/9735 [00:12<00:25, 259.59it/s] 32%|████████████████▌                                   | 3095/9735 [00:12<00:25, 259.75it/s] 32%|████████████████▋                                   | 3122/9735 [00:12<00:25, 260.06it/s] 32%|████████████████▊                                   | 3149/9735 [00:13<00:25, 260.05it/s] 33%|████████████████▉                                   | 3176/9735 [00:13<00:25, 258.17it/s] 33%|█████████████████                                   | 3203/9735 [00:13<00:25, 258.92it/s] 33%|█████████████████▎                                  | 3230/9735 [00:13<00:25, 259.36it/s] 33%|█████████████████▍                                  | 3257/9735 [00:13<00:24, 259.81it/s] 34%|█████████████████▌                                  | 3283/9735 [00:13<00:24, 259.81it/s] 34%|█████████████████▋                                  | 3309/9735 [00:13<00:24, 258.63it/s] 34%|█████████████████▊                                  | 3335/9735 [00:13<00:24, 258.68it/s] 35%|█████████████████▉                                  | 3362/9735 [00:13<00:24, 259.07it/s] 35%|██████████████████                                  | 3388/9735 [00:14<00:24, 257.75it/s] 35%|██████████████████▏                                 | 3414/9735 [00:14<00:24, 258.39it/s] 35%|██████████████████▎                                 | 3440/9735 [00:14<00:24, 258.70it/s] 36%|██████████████████▌                                 | 3466/9735 [00:14<00:24, 258.64it/s] 36%|██████████████████▋                                 | 3492/9735 [00:14<00:24, 258.91it/s] 36%|██████████████████▊                                 | 3518/9735 [00:14<00:24, 258.94it/s] 36%|██████████████████▉                                 | 3544/9735 [00:14<00:23, 258.67it/s] 37%|███████████████████                                 | 3570/9735 [00:14<00:23, 258.79it/s] 37%|███████████████████▏                                | 3596/9735 [00:14<00:23, 259.13it/s] 37%|███████████████████▎                                | 3622/9735 [00:14<00:23, 257.66it/s] 37%|███████████████████▍                                | 3649/9735 [00:15<00:23, 258.42it/s] 38%|███████████████████▋                                | 3675/9735 [00:15<00:23, 258.73it/s] 38%|███████████████████▊                                | 3702/9735 [00:15<00:23, 259.15it/s] 38%|███████████████████▉                                | 3728/9735 [00:15<00:23, 259.40it/s] 39%|████████████████████                                | 3754/9735 [00:15<00:23, 259.36it/s] 39%|████████████████████▏                               | 3780/9735 [00:15<00:22, 259.48it/s] 39%|████████████████████▎                               | 3806/9735 [00:15<00:22, 259.56it/s] 39%|████████████████████▍                               | 3833/9735 [00:15<00:22, 258.13it/s] 40%|████████████████████▌                               | 3860/9735 [00:15<00:22, 258.72it/s] 40%|████████████████████▊                               | 3886/9735 [00:15<00:22, 259.08it/s] 40%|████████████████████▉                               | 3912/9735 [00:16<00:22, 258.99it/s] 40%|█████████████████████                               | 3938/9735 [00:16<00:22, 259.23it/s] 41%|█████████████████████▏                              | 3964/9735 [00:16<00:22, 259.39it/s] 41%|█████████████████████▎                              | 3990/9735 [00:16<00:22, 259.40it/s] 41%|█████████████████████▍                              | 4017/9735 [00:16<00:22, 259.76it/s] 42%|█████████████████████▌                              | 4044/9735 [00:16<00:21, 259.85it/s] 42%|█████████████████████▋                              | 4070/9735 [00:16<00:21, 258.27it/s] 42%|█████████████████████▉                              | 4097/9735 [00:16<00:21, 258.82it/s] 42%|██████████████████████                              | 4123/9735 [00:16<00:21, 259.14it/s] 43%|██████████████████████▏                             | 4149/9735 [00:16<00:21, 259.29it/s] 43%|██████████████████████▎                             | 4175/9735 [00:17<00:21, 259.49it/s] 43%|██████████████████████▍                             | 4201/9735 [00:17<00:21, 258.41it/s] 43%|██████████████████████▌                             | 4227/9735 [00:17<00:21, 258.71it/s] 44%|██████████████████████▋                             | 4253/9735 [00:17<00:21, 259.02it/s] 44%|██████████████████████▊                             | 4279/9735 [00:17<00:21, 258.63it/s] 44%|██████████████████████▉                             | 4305/9735 [00:17<00:21, 257.22it/s] 44%|███████████████████████▏                            | 4331/9735 [00:17<00:20, 257.81it/s] 45%|███████████████████████▎                            | 4357/9735 [00:17<00:20, 258.36it/s] 45%|███████████████████████▍                            | 4383/9735 [00:17<00:20, 258.75it/s] 45%|███████████████████████▌                            | 4409/9735 [00:17<00:20, 259.04it/s] 46%|███████████████████████▋                            | 4435/9735 [00:18<00:20, 259.01it/s] 46%|███████████████████████▊                            | 4461/9735 [00:18<00:20, 259.21it/s] 46%|███████████████████████▉                            | 4487/9735 [00:18<00:20, 259.20it/s] 46%|████████████████████████                            | 4513/9735 [00:18<00:20, 259.26it/s] 47%|████████████████████████▏                           | 4539/9735 [00:18<00:21, 238.72it/s] 47%|████████████████████████▍                           | 4565/9735 [00:18<00:21, 244.57it/s] 47%|████████████████████████▌                           | 4592/9735 [00:18<00:20, 249.17it/s] 47%|████████████████████████▋                           | 4618/9735 [00:18<00:20, 250.28it/s] 48%|████████████████████████▊                           | 4644/9735 [00:18<00:20, 253.01it/s] 48%|████████████████████████▉                           | 4670/9735 [00:18<00:19, 254.96it/s] 48%|█████████████████████████                           | 4697/9735 [00:19<00:19, 256.55it/s] 49%|█████████████████████████▏                          | 4723/9735 [00:19<00:19, 257.32it/s] 49%|█████████████████████████▎                          | 4749/9735 [00:19<00:25, 194.36it/s] 49%|█████████████████████████▌                          | 4775/9735 [00:19<00:23, 210.17it/s] 49%|█████████████████████████▋                          | 4801/9735 [00:19<00:22, 222.87it/s] 50%|█████████████████████████▊                          | 4827/9735 [00:19<00:21, 232.52it/s] 50%|█████████████████████████▉                          | 4853/9735 [00:19<00:20, 239.91it/s] 50%|██████████████████████████                          | 4879/9735 [00:19<00:19, 245.32it/s] 50%|██████████████████████████▏                         | 4905/9735 [00:20<00:19, 249.51it/s] 51%|██████████████████████████▎                         | 4931/9735 [00:20<00:19, 252.45it/s] 51%|██████████████████████████▍                         | 4957/9735 [00:20<00:18, 253.17it/s] 51%|██████████████████████████▌                         | 4983/9735 [00:20<00:18, 255.00it/s] 51%|██████████████████████████▊                         | 5009/9735 [00:20<00:18, 255.70it/s] 52%|██████████████████████████▉                         | 5035/9735 [00:20<00:18, 255.00it/s] 52%|███████████████████████████                         | 5061/9735 [00:20<00:18, 256.36it/s] 52%|███████████████████████████▏                        | 5087/9735 [00:20<00:18, 257.17it/s] 53%|███████████████████████████▎                        | 5113/9735 [00:20<00:17, 257.93it/s] 53%|███████████████████████████▍                        | 5139/9735 [00:20<00:17, 258.36it/s] 53%|███████████████████████████▌                        | 5165/9735 [00:21<00:17, 258.81it/s] 53%|███████████████████████████▋                        | 5191/9735 [00:21<00:17, 257.26it/s] 54%|███████████████████████████▊                        | 5217/9735 [00:21<00:17, 257.87it/s] 54%|████████████████████████████                        | 5243/9735 [00:21<00:17, 258.31it/s] 54%|████████████████████████████▏                       | 5269/9735 [00:21<00:17, 258.54it/s] 54%|████████████████████████████▎                       | 5295/9735 [00:21<00:17, 258.82it/s] 55%|████████████████████████████▍                       | 5321/9735 [00:21<00:17, 258.99it/s] 55%|████████████████████████████▌                       | 5347/9735 [00:21<00:16, 258.72it/s] 55%|████████████████████████████▋                       | 5373/9735 [00:21<00:16, 258.76it/s] 55%|████████████████████████████▊                       | 5399/9735 [00:21<00:16, 257.02it/s] 56%|████████████████████████████▉                       | 5425/9735 [00:22<00:16, 257.52it/s] 56%|█████████████████████████████                       | 5451/9735 [00:22<00:16, 257.88it/s] 56%|█████████████████████████████▎                      | 5477/9735 [00:22<00:16, 256.80it/s] 57%|█████████████████████████████▍                      | 5504/9735 [00:22<00:16, 259.47it/s] 57%|█████████████████████████████▌                      | 5531/9735 [00:22<00:16, 261.40it/s] 57%|█████████████████████████████▋                      | 5558/9735 [00:22<00:15, 262.91it/s] 57%|█████████████████████████████▊                      | 5585/9735 [00:22<00:15, 263.65it/s] 58%|█████████████████████████████▉                      | 5612/9735 [00:22<00:15, 264.26it/s] 58%|██████████████████████████████                      | 5639/9735 [00:22<00:15, 263.04it/s] 58%|██████████████████████████████▎                     | 5666/9735 [00:22<00:15, 264.00it/s] 58%|██████████████████████████████▍                     | 5693/9735 [00:23<00:15, 264.62it/s] 59%|██████████████████████████████▌                     | 5720/9735 [00:23<00:15, 265.11it/s] 59%|██████████████████████████████▋                     | 5747/9735 [00:23<00:15, 265.39it/s] 59%|██████████████████████████████▊                     | 5774/9735 [00:23<00:14, 265.51it/s] 60%|██████████████████████████████▉                     | 5801/9735 [00:23<00:14, 265.56it/s] 60%|███████████████████████████████▏                    | 5828/9735 [00:23<00:14, 265.58it/s] 60%|███████████████████████████████▎                    | 5855/9735 [00:23<00:14, 263.80it/s] 60%|███████████████████████████████▍                    | 5882/9735 [00:23<00:14, 264.51it/s] 61%|███████████████████████████████▌                    | 5909/9735 [00:23<00:14, 262.87it/s] 61%|███████████████████████████████▋                    | 5936/9735 [00:23<00:14, 263.75it/s] 61%|███████████████████████████████▊                    | 5963/9735 [00:24<00:14, 264.53it/s] 62%|███████████████████████████████▉                    | 5990/9735 [00:24<00:14, 264.99it/s] 62%|████████████████████████████████▏                   | 6017/9735 [00:24<00:14, 265.30it/s] 62%|████████████████████████████████▎                   | 6044/9735 [00:24<00:13, 265.69it/s] 62%|████████████████████████████████▍                   | 6071/9735 [00:24<00:13, 265.80it/s] 63%|████████████████████████████████▌                   | 6098/9735 [00:24<00:13, 264.25it/s] 63%|████████████████████████████████▋                   | 6125/9735 [00:24<00:13, 264.53it/s] 63%|████████████████████████████████▊                   | 6152/9735 [00:24<00:13, 264.87it/s] 63%|█████████████████████████████████                   | 6179/9735 [00:24<00:13, 264.68it/s] 64%|█████████████████████████████████▏                  | 6206/9735 [00:24<00:13, 264.97it/s] 64%|█████████████████████████████████▎                  | 6233/9735 [00:25<00:13, 264.99it/s] 64%|█████████████████████████████████▍                  | 6260/9735 [00:25<00:13, 265.18it/s] 65%|█████████████████████████████████▌                  | 6287/9735 [00:25<00:12, 265.49it/s] 65%|█████████████████████████████████▋                  | 6314/9735 [00:25<00:12, 263.86it/s] 65%|█████████████████████████████████▊                  | 6341/9735 [00:25<00:12, 264.52it/s] 65%|██████████████████████████████████                  | 6368/9735 [00:25<00:12, 263.11it/s] 66%|██████████████████████████████████▏                 | 6395/9735 [00:25<00:12, 263.95it/s] 66%|██████████████████████████████████▎                 | 6422/9735 [00:25<00:12, 264.12it/s] 66%|██████████████████████████████████▍                 | 6449/9735 [00:25<00:12, 264.72it/s] 67%|██████████████████████████████████▌                 | 6476/9735 [00:25<00:12, 264.77it/s] 67%|██████████████████████████████████▋                 | 6503/9735 [00:26<00:12, 265.12it/s] 67%|██████████████████████████████████▉                 | 6530/9735 [00:26<00:12, 265.09it/s] 67%|███████████████████████████████████                 | 6557/9735 [00:26<00:12, 263.25it/s] 68%|███████████████████████████████████▏                | 6584/9735 [00:26<00:11, 263.91it/s] 68%|███████████████████████████████████▎                | 6611/9735 [00:26<00:11, 264.25it/s] 68%|███████████████████████████████████▍                | 6638/9735 [00:26<00:11, 264.75it/s] 68%|███████████████████████████████████▌                | 6665/9735 [00:26<00:11, 265.01it/s] 69%|███████████████████████████████████▋                | 6692/9735 [00:26<00:11, 265.08it/s] 69%|███████████████████████████████████▉                | 6719/9735 [00:26<00:11, 265.16it/s] 69%|████████████████████████████████████                | 6746/9735 [00:27<00:11, 265.48it/s] 70%|████████████████████████████████████▏               | 6773/9735 [00:27<00:11, 263.98it/s] 70%|████████████████████████████████████▎               | 6800/9735 [00:27<00:11, 264.46it/s] 70%|████████████████████████████████████▍               | 6827/9735 [00:27<00:11, 262.62it/s] 70%|████████████████████████████████████▌               | 6854/9735 [00:27<00:10, 263.48it/s] 71%|████████████████████████████████████▊               | 6881/9735 [00:27<00:10, 264.20it/s] 71%|████████████████████████████████████▉               | 6908/9735 [00:27<00:10, 264.61it/s] 71%|█████████████████████████████████████               | 6935/9735 [00:27<00:10, 265.00it/s] 72%|█████████████████████████████████████▏              | 6962/9735 [00:27<00:10, 265.15it/s] 72%|█████████████████████████████████████▎              | 6989/9735 [00:27<00:10, 263.06it/s] 72%|█████████████████████████████████████▍              | 7016/9735 [00:28<00:10, 263.62it/s] 72%|█████████████████████████████████████▌              | 7043/9735 [00:28<00:10, 264.36it/s] 73%|█████████████████████████████████████▊              | 7070/9735 [00:28<00:10, 264.92it/s] 73%|█████████████████████████████████████▉              | 7097/9735 [00:28<00:09, 265.17it/s] 73%|██████████████████████████████████████              | 7124/9735 [00:28<00:09, 264.76it/s] 73%|██████████████████████████████████████▏             | 7151/9735 [00:28<00:09, 265.12it/s] 74%|██████████████████████████████████████▎             | 7178/9735 [00:28<00:09, 265.31it/s] 74%|██████████████████████████████████████▍             | 7205/9735 [00:28<00:09, 265.38it/s] 74%|██████████████████████████████████████▋             | 7232/9735 [00:28<00:09, 263.79it/s] 75%|██████████████████████████████████████▊             | 7259/9735 [00:28<00:09, 264.00it/s] 75%|██████████████████████████████████████▉             | 7286/9735 [00:29<00:09, 264.30it/s] 75%|███████████████████████████████████████             | 7313/9735 [00:29<00:09, 264.56it/s] 75%|███████████████████████████████████████▏            | 7340/9735 [00:29<00:09, 264.94it/s] 76%|███████████████████████████████████████▎            | 7367/9735 [00:29<00:08, 265.35it/s] 76%|███████████████████████████████████████▍            | 7394/9735 [00:29<00:08, 263.93it/s] 76%|███████████████████████████████████████▋            | 7421/9735 [00:29<00:08, 264.19it/s] 77%|███████████████████████████████████████▊            | 7448/9735 [00:29<00:09, 235.32it/s] 77%|███████████████████████████████████████▉            | 7475/9735 [00:29<00:09, 243.65it/s] 77%|████████████████████████████████████████            | 7502/9735 [00:29<00:08, 249.75it/s] 77%|████████████████████████████████████████▏           | 7529/9735 [00:30<00:08, 253.73it/s] 78%|████████████████████████████████████████▎           | 7556/9735 [00:30<00:08, 256.92it/s] 78%|████████████████████████████████████████▌           | 7583/9735 [00:30<00:08, 259.38it/s] 78%|████████████████████████████████████████▋           | 7610/9735 [00:30<00:08, 261.27it/s] 78%|████████████████████████████████████████▊           | 7637/9735 [00:30<00:07, 262.44it/s] 79%|████████████████████████████████████████▉           | 7664/9735 [00:30<00:07, 263.12it/s] 79%|█████████████████████████████████████████           | 7691/9735 [00:30<00:07, 262.10it/s] 79%|█████████████████████████████████████████▏          | 7718/9735 [00:30<00:07, 263.32it/s] 80%|█████████████████████████████████████████▎          | 7745/9735 [00:30<00:07, 264.04it/s] 80%|█████████████████████████████████████████▌          | 7772/9735 [00:30<00:07, 264.39it/s] 80%|█████████████████████████████████████████▋          | 7799/9735 [00:31<00:07, 264.73it/s] 80%|█████████████████████████████████████████▊          | 7826/9735 [00:31<00:07, 264.92it/s] 81%|█████████████████████████████████████████▉          | 7853/9735 [00:31<00:07, 264.68it/s] 81%|██████████████████████████████████████████          | 7880/9735 [00:31<00:07, 264.79it/s] 81%|██████████████████████████████████████████▏         | 7907/9735 [00:31<00:06, 263.57it/s] 81%|██████████████████████████████████████████▍         | 7934/9735 [00:31<00:06, 264.09it/s] 82%|██████████████████████████████████████████▌         | 7961/9735 [00:31<00:06, 264.34it/s] 82%|██████████████████████████████████████████▋         | 7988/9735 [00:31<00:06, 264.63it/s] 82%|██████████████████████████████████████████▊         | 8015/9735 [00:31<00:06, 264.78it/s] 83%|██████████████████████████████████████████▉         | 8042/9735 [00:31<00:06, 264.71it/s] 83%|███████████████████████████████████████████         | 8069/9735 [00:32<00:06, 264.81it/s] 83%|███████████████████████████████████████████▏        | 8096/9735 [00:32<00:06, 265.19it/s] 83%|███████████████████████████████████████████▍        | 8123/9735 [00:32<00:06, 263.72it/s] 84%|███████████████████████████████████████████▌        | 8150/9735 [00:32<00:05, 264.26it/s] 84%|███████████████████████████████████████████▋        | 8177/9735 [00:32<00:05, 264.44it/s] 84%|███████████████████████████████████████████▊        | 8204/9735 [00:32<00:05, 264.78it/s] 85%|███████████████████████████████████████████▉        | 8231/9735 [00:32<00:05, 264.88it/s] 85%|████████████████████████████████████████████        | 8258/9735 [00:32<00:05, 265.12it/s] 85%|████████████████████████████████████████████▎       | 8285/9735 [00:32<00:05, 265.04it/s] 85%|████████████████████████████████████████████▍       | 8312/9735 [00:32<00:05, 265.01it/s] 86%|████████████████████████████████████████████▌       | 8339/9735 [00:33<00:05, 265.06it/s] 86%|████████████████████████████████████████████▋       | 8366/9735 [00:33<00:05, 263.54it/s] 86%|████████████████████████████████████████████▊       | 8393/9735 [00:33<00:05, 264.12it/s] 86%|████████████████████████████████████████████▉       | 8420/9735 [00:33<00:04, 264.82it/s] 87%|█████████████████████████████████████████████       | 8447/9735 [00:33<00:04, 265.03it/s] 87%|█████████████████████████████████████████████▎      | 8474/9735 [00:33<00:04, 265.16it/s] 87%|█████████████████████████████████████████████▍      | 8501/9735 [00:33<00:04, 265.43it/s] 88%|█████████████████████████████████████████████▌      | 8528/9735 [00:33<00:04, 265.00it/s] 88%|█████████████████████████████████████████████▋      | 8555/9735 [00:33<00:04, 264.63it/s] 88%|█████████████████████████████████████████████▊      | 8582/9735 [00:34<00:04, 263.11it/s] 88%|█████████████████████████████████████████████▉      | 8609/9735 [00:34<00:04, 263.66it/s] 89%|██████████████████████████████████████████████▏     | 8636/9735 [00:34<00:04, 264.15it/s] 89%|██████████████████████████████████████████████▎     | 8663/9735 [00:34<00:04, 264.48it/s] 89%|██████████████████████████████████████████████▍     | 8690/9735 [00:34<00:03, 264.73it/s] 90%|██████████████████████████████████████████████▌     | 8717/9735 [00:34<00:03, 264.41it/s] 90%|██████████████████████████████████████████████▋     | 8744/9735 [00:34<00:03, 264.38it/s] 90%|██████████████████████████████████████████████▊     | 8771/9735 [00:34<00:03, 264.64it/s] 90%|██████████████████████████████████████████████▉     | 8798/9735 [00:34<00:03, 264.66it/s] 91%|███████████████████████████████████████████████▏    | 8825/9735 [00:34<00:03, 263.33it/s] 91%|███████████████████████████████████████████████▎    | 8852/9735 [00:35<00:03, 263.85it/s] 91%|███████████████████████████████████████████████▍    | 8879/9735 [00:35<00:03, 263.69it/s] 91%|███████████████████████████████████████████████▌    | 8906/9735 [00:35<00:03, 264.27it/s] 92%|███████████████████████████████████████████████▋    | 8933/9735 [00:35<00:03, 264.74it/s] 92%|███████████████████████████████████████████████▊    | 8960/9735 [00:35<00:02, 264.92it/s] 92%|████████████████████████████████████████████████    | 8987/9735 [00:35<00:02, 265.09it/s] 93%|████████████████████████████████████████████████▏   | 9014/9735 [00:35<00:02, 265.11it/s] 93%|████████████████████████████████████████████████▎   | 9041/9735 [00:35<00:02, 263.44it/s] 93%|████████████████████████████████████████████████▍   | 9068/9735 [00:35<00:02, 263.98it/s] 93%|████████████████████████████████████████████████▌   | 9095/9735 [00:35<00:02, 264.30it/s] 94%|████████████████████████████████████████████████▋   | 9122/9735 [00:36<00:02, 264.26it/s] 94%|████████████████████████████████████████████████▊   | 9149/9735 [00:36<00:02, 264.17it/s] 94%|█████████████████████████████████████████████████   | 9176/9735 [00:36<00:02, 264.58it/s] 95%|█████████████████████████████████████████████████▏  | 9203/9735 [00:36<00:02, 264.75it/s] 95%|█████████████████████████████████████████████████▎  | 9230/9735 [00:36<00:01, 264.23it/s] 95%|█████████████████████████████████████████████████▍  | 9257/9735 [00:36<00:01, 262.94it/s] 95%|█████████████████████████████████████████████████▌  | 9284/9735 [00:36<00:01, 263.55it/s] 96%|█████████████████████████████████████████████████▋  | 9311/9735 [00:36<00:01, 264.05it/s] 96%|█████████████████████████████████████████████████▉  | 9338/9735 [00:36<00:01, 264.36it/s] 96%|██████████████████████████████████████████████████  | 9365/9735 [00:36<00:01, 264.72it/s] 96%|██████████████████████████████████████████████████▏ | 9392/9735 [00:37<00:01, 264.92it/s] 97%|██████████████████████████████████████████████████▎ | 9419/9735 [00:37<00:01, 265.08it/s] 97%|██████████████████████████████████████████████████▍ | 9446/9735 [00:37<00:01, 265.14it/s] 97%|██████████████████████████████████████████████████▌ | 9473/9735 [00:37<00:00, 265.10it/s] 98%|██████████████████████████████████████████████████▋ | 9500/9735 [00:37<00:00, 263.49it/s] 98%|██████████████████████████████████████████████████▉ | 9527/9735 [00:37<00:00, 263.93it/s] 98%|███████████████████████████████████████████████████ | 9554/9735 [00:37<00:00, 264.18it/s] 98%|███████████████████████████████████████████████████▏| 9581/9735 [00:37<00:00, 264.44it/s] 99%|███████████████████████████████████████████████████▎| 9608/9735 [00:37<00:00, 264.79it/s] 99%|███████████████████████████████████████████████████▍| 9635/9735 [00:37<00:00, 264.80it/s] 99%|███████████████████████████████████████████████████▌| 9662/9735 [00:38<00:00, 264.85it/s]100%|███████████████████████████████████████████████████▊| 9689/9735 [00:38<00:00, 264.89it/s]100%|███████████████████████████████████████████████████▉| 9716/9735 [00:38<00:00, 262.66it/s]100%|████████████████████████████████████████████████████| 9735/9735 [00:38<00:00, 253.74it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.06s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.32s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:07<00:14,  7.05s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:06<00:12,  6.32s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.02s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.38s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.47s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.62s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  4.89s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  5.02s/it]
Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:13<00:06,  6.62s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:15<00:08,  8.10s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:19<00:00,  6.43s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:19<00:00,  6.45s/it]
[2023-08-22 02:04:46,185] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:21<00:00,  7.15s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:21<00:00,  7.30s/it]
[2023-08-22 02:04:59,943] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-22 02:04:59,944] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-22 02:04:59,945] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-22 02:04:59,945] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-22 02:04:59,945] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-22 02:04:59,945] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-22 02:04:59,946] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-22 02:04:59,946] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-22 02:04:59,946] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-22 02:04:59,946] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-22 02:04:59,946] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-22 02:04:59,946] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fe59b2c5fd0>
[2023-08-22 02:04:59,946] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-22 02:04:59,946] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-22 02:04:59,946] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-22 02:04:59,946] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-22 02:04:59,946] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-22 02:04:59,946] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-22 02:04:59,946] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-22 02:04:59,946] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-22 02:04:59,946] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-22 02:04:59,946] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-22 02:04:59,946] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-22 02:04:59,946] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-22 02:04:59,946] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-22 02:04:59,946] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-22 02:04:59,946] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-22 02:04:59,946] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-22 02:04:59,946] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-22 02:04:59,946] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-22 02:04:59,946] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-22 02:04:59,946] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-22 02:04:59,946] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-22 02:04:59,946] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-22 02:04:59,946] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-22 02:04:59,946] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-22 02:04:59,946] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-22 02:04:59,946] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-22 02:04:59,946] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-22 02:04:59,946] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-22 02:04:59,946] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-22 02:04:59,946] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-22 02:04:59,946] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-22 02:04:59,946] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-22 02:04:59,946] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7fe59adf6220>
[2023-08-22 02:04:59,947] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-22 02:04:59,947] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-22 02:04:59,947] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-22 02:04:59,947] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-22 02:04:59,947] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-22 02:04:59,947] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-22 02:04:59,947] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-22 02:04:59,947] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-22 02:04:59,947] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-22 02:04:59,947] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-22 02:04:59,947] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-22 02:04:59,947] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-22 02:04:59,947] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-22 02:04:59,947] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-22 02:04:59,947] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-22 02:04:59,947] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-22 02:04:59,947] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-22 02:04:59,947] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-22 02:04:59,947] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-22 02:04:59,947] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-22 02:04:59,947] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-22 02:04:59,947] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-22 02:04:59,947] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.574500560760498 seconds
Loading extension module utils...
Time to load utils op: 0.6049771308898926 seconds
Loading extension module utils...
Time to load utils op: 0.604931116104126 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: Fabric is cut to order at what type of seller? Choices:  A: curtains B: tailor shop C: clothing store D: sewing room E: hardware store
Output: 1. The question asks for a type of seller where fabric is cut to order.
2. To answer this question, we need to understand what it means for fabric to be "cut to order". This term implies a certain degree of customization, likely related to a customer's specific needs, and not something manufactured or already made.
3. Now, let's examine each choice closely:
   - A: curtains - This normally does not require customization, plus curtains are usually a finished product, not a place where fabric is cut.
   - B: tailor shop - This is a place where clothes are custom made, and fabric would be cut according to specific measurements or customer requirements. This fits the description perfectly.
   - C: clothing store - Clothing stores usually sell ready-made clothing, not custom-cut fabric.
   - D: sewing room - This is more of a location within a household or a general place where any sewing can occur, not necessarily a type of seller.
   - E: hardware store - A hardware store sells products related to home improvement and construction; fabric is not typically among these products.
4. From the analysis, only a tailor shop corresponds to a seller that would cut fabric according to custom orders.
5. Therefore, the answer is B: tailor shop.
So the final answer is B: tailor shop

Input: Where are you if your reading magazines while waiting for a vehicle on rails? Choices:  A: vegetables B: market C: doctor D: train station E: bookstore
Output: 1. The question asks for a location where it's possible to read magazines while waiting for a vehicle on rails. This implies some type of public transportation.
2. The vehicle is specified as moving on rails which rules out options other than a train.
3. Both a train station or a bookstore have areas where one might read a magazine, so these are the most likely choices at first glance.
4. However, a bookstore doesn't make sense with the passage since one doesn't typically wait for transportation at a bookstore.
5. Hence, considering all the given clues, the correct choice is a train station where passengers read magazines while waiting for their train. Therefore, the answer is D: train station.
So the final answer is D: train station

Input: What would need oil to be used? Choices:  A: ground B: human  body C: repair shop D: combustion engines E: service station
Output: 1. The question is asking for contexts where oil might be needed to function.
2. Considering the options:
- For option A, grounds generally do not require oil for their functionality. They require water and nutrients to sustain plant and animal life, but not oil.
- For option B, the human body also does not use oil. It requires water, nutrients, and oxygen to function properly, but oil is not a biological requirement.
- For option C and E, a repair shop and service station could use oil in their operations, particularly when working on machines that require oil. However, the stations and shops themselves don't require oil to function, instead, the machinery and vehicles that come in might.
- For option D, combustion engines specifically require oil to function. The oil is used to lubricate the engine's parts, maintain their temperature, and to prevent rust.
3. Thus, the option that directly necessitates the use of oil is D: combustion engines.
So the final answer is D: combustion engines

Input: What is person probably feeling that plans on stopping being married to their spouse? Choices:  A: detachment B: bankruptcy C: sad D: fights E: wrong
Output: 1. The question asks about a person's probable emotional state who plans on ending their marriage. 
2. From the multiple choices given, we need to pick a choice that reflects an emotion or mindset related to ending a marriage.
3. Two answers, "sad" and "detachment," are related to emotions.
4. Although ending a marriage can be sad, the question specifically asks about someone who plans on stopping being married, implying the decision has already been made.
5. This suggests the person has emotionally prepared themselves to end the relationship, which indicates a state of emotional withdrawal or separation.
6. Therefore, the answer is A: detachment. This term best reflects the emotional distance someone would likely feel when deciding to no longer be married to their spouse.
So the final answer is A: detachment

Input: What could you use to store a clock? Choices:  A: shelf B: own bedroom C: desk D: wall E: car
Output: Step 1: The question is asking what could be used to store a clock.
Step 2: Analyze each possible answer.
A: shelf - A shelf could be used to store a clock on it.
B: own bedroom - A bedroom is not a storage device but a place where storage devices can be placed.
C: desk - While a desk can be used to keep a clock, it is not typically used for storage.
D: wall - A wall can be used for hanging a clock, but it does not store it.
E: car - A car is not a practical place to store a clock. 
Step 3: Based on the analysis, answer A (shelf) is the best answer.
So the final answer is A: shelf

Input: The person put on lotion, what did they want? Choices:  A: fresh smell B: good credit C: smooth skin D: fresh produce E: headache
Output: 1. The question is about discerning the reason behind the action of a person putting on lotion.
2. We must identify the result that commonly occurs from this action, among the options given.
3. Option A refers to a fresh smell, which could be a reason, but lotions are not primarily used for scent.
4. Option B refers to good credit, which is unrelated to the action of putting on lotion.
5. Option C refers to smooth skin, which is a common reason for people to put on lotion. Most lotions contain moisturizing agents that help retain skin's moisture, leading to smoother skin.
6. Option D refers to fresh produce, which is entirely not related to the action.
7. Option E suggests the person might want a headache, which is an adverse state anyone would usually want to avoid and also it is unrelated to applying lotion.
8. So, after examining all the options, we can determine that the person put on lotion to get smooth skin - making Option C the correct answer.
So the final answer is C: smooth skin

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i6-s10-rTrue
Loading extension module utils...
Time to load utils op: 0.6044840812683105 seconds
Evaluating commonsenseqa :   0%|                                       | 0/50 [00:03<?, ?it/s]
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 126, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 123, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 107, in evaluate_main
    query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 89, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 126, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 123, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 107, in evaluate_main
    query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 89, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 126, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 123, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 107, in evaluate_main
    query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 89, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 126, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 123, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 107, in evaluate_main
    query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 89, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 3502852 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 3502853 closing signal SIGTERM
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 3502851) of binary: /home/ylu130/.conda/envs/distllm/bin/python
Traceback (most recent call last):
  File "/home/ylu130/.conda/envs/distllm/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 345, in wrapper
    return f(*args, **kwargs)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 761, in main
    run(args)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 752, in run
    elastic_launch(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 131, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 245, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
/home/ylu130/workspace/in-context-generalization/inference.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2023-08-22_02:05:05
  host      : ia1.wse.jhu.edu
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 3502854)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2023-08-22_02:05:05
  host      : ia1.wse.jhu.edu
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 3502851)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i7-s10-rTrue --seed 10 --max-prompt-length 2048 --rationales --num-in-domain 7
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
using world size: 4
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date![nltk_data]   Package punkt is already up-to-date!

[2023-08-22 02:05:09,276] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i7-s10-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 7
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i7-s10-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 10
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9734 [00:00<?, ?it/s]  0%|                                                      | 14/9734 [00:00<01:12, 133.26it/s]  0%|▏                                                     | 28/9734 [00:00<01:12, 133.81it/s]  0%|▏                                                     | 42/9734 [00:00<01:12, 133.38it/s]  1%|▎                                                     | 56/9734 [00:00<01:12, 132.94it/s]  1%|▍                                                     | 70/9734 [00:00<01:12, 132.93it/s]  1%|▍                                                     | 84/9734 [00:00<01:13, 130.89it/s]  1%|▌                                                     | 98/9734 [00:00<01:12, 132.09it/s]  1%|▌                                                    | 112/9734 [00:00<01:12, 132.84it/s]  1%|▋                                                    | 126/9734 [00:00<01:11, 133.46it/s]  1%|▊                                                    | 140/9734 [00:01<01:11, 133.92it/s]  2%|▊                                                    | 154/9734 [00:01<01:11, 134.22it/s]  2%|▉                                                    | 168/9734 [00:01<01:11, 134.44it/s]  2%|▉                                                    | 182/9734 [00:01<01:11, 134.47it/s]  2%|█                                                    | 196/9734 [00:01<01:10, 134.46it/s]  2%|█▏                                                   | 210/9734 [00:01<01:11, 133.26it/s]  2%|█▏                                                   | 224/9734 [00:01<01:11, 132.18it/s]  2%|█▎                                                   | 238/9734 [00:01<01:11, 132.68it/s]  3%|█▎                                                   | 252/9734 [00:01<01:11, 133.19it/s]  3%|█▍                                                   | 266/9734 [00:01<01:10, 133.71it/s]  3%|█▌                                                   | 286/9734 [00:02<01:02, 152.26it/s]  3%|█▋                                                   | 307/9734 [00:02<00:56, 168.25it/s]  3%|█▊                                                   | 328/9734 [00:02<00:52, 179.40it/s]  4%|█▉                                                   | 349/9734 [00:02<00:50, 187.22it/s]  4%|██                                                   | 370/9734 [00:02<00:48, 192.73it/s]  4%|██▏                                                  | 391/9734 [00:02<00:47, 196.74it/s]  4%|██▏                                                  | 412/9734 [00:02<00:46, 199.39it/s]  4%|██▎                                                  | 432/9734 [00:02<00:46, 199.49it/s]  5%|██▍                                                  | 453/9734 [00:02<00:46, 201.59it/s]  5%|██▌                                                  | 474/9734 [00:03<00:45, 202.85it/s]  5%|██▋                                                  | 495/9734 [00:03<00:45, 203.31it/s]  5%|██▊                                                  | 516/9734 [00:03<00:45, 204.23it/s]  6%|██▉                                                  | 537/9734 [00:03<00:44, 204.66it/s]  6%|███                                                  | 558/9734 [00:03<00:44, 204.96it/s]  6%|███▏                                                 | 579/9734 [00:03<00:44, 205.27it/s]  6%|███▎                                                 | 600/9734 [00:03<00:44, 205.11it/s]  6%|███▍                                                 | 621/9734 [00:03<00:44, 203.47it/s]  7%|███▍                                                 | 642/9734 [00:03<00:44, 202.26it/s]  7%|███▌                                                 | 663/9734 [00:03<00:45, 200.28it/s]  7%|███▋                                                 | 684/9734 [00:04<00:45, 200.11it/s]  7%|███▊                                                 | 705/9734 [00:04<00:45, 199.95it/s]  7%|███▉                                                 | 725/9734 [00:04<00:45, 199.84it/s]  8%|████                                                 | 745/9734 [00:04<00:44, 199.85it/s]  8%|████▏                                                | 765/9734 [00:04<00:44, 199.87it/s]  8%|████▎                                                | 786/9734 [00:04<00:44, 200.42it/s]  8%|████▍                                                | 807/9734 [00:04<00:44, 200.60it/s]  9%|████▌                                                | 828/9734 [00:04<00:44, 200.69it/s]  9%|████▌                                                | 849/9734 [00:04<00:44, 200.74it/s]  9%|████▋                                                | 870/9734 [00:04<00:43, 201.62it/s]  9%|████▊                                                | 891/9734 [00:05<00:43, 201.11it/s]  9%|████▉                                                | 912/9734 [00:05<00:43, 201.13it/s] 10%|█████                                                | 933/9734 [00:05<00:43, 202.17it/s] 10%|█████▏                                               | 954/9734 [00:05<00:43, 203.08it/s] 10%|█████▎                                               | 975/9734 [00:05<00:43, 203.24it/s] 10%|█████▍                                               | 996/9734 [00:05<00:43, 202.16it/s] 10%|█████▍                                              | 1017/9734 [00:05<00:43, 201.96it/s] 11%|█████▌                                              | 1038/9734 [00:05<00:43, 202.05it/s] 11%|█████▋                                              | 1059/9734 [00:05<00:42, 203.01it/s] 11%|█████▊                                              | 1080/9734 [00:06<00:42, 204.04it/s] 11%|█████▉                                              | 1101/9734 [00:06<00:42, 204.52it/s] 12%|█████▉                                              | 1122/9734 [00:06<00:42, 203.24it/s] 12%|██████                                              | 1143/9734 [00:06<00:42, 203.92it/s] 12%|██████▏                                             | 1164/9734 [00:06<00:41, 204.23it/s] 12%|██████▎                                             | 1185/9734 [00:06<00:41, 204.58it/s] 12%|██████▍                                             | 1206/9734 [00:06<00:41, 203.94it/s] 13%|██████▌                                             | 1227/9734 [00:06<00:41, 204.09it/s] 13%|██████▋                                             | 1248/9734 [00:06<00:41, 203.68it/s] 13%|██████▊                                             | 1269/9734 [00:06<00:42, 201.06it/s] 13%|██████▉                                             | 1290/9734 [00:07<00:42, 200.78it/s] 13%|███████                                             | 1311/9734 [00:07<00:42, 200.24it/s] 14%|███████                                             | 1332/9734 [00:07<00:41, 200.09it/s] 14%|███████▏                                            | 1353/9734 [00:07<00:42, 199.22it/s] 14%|███████▎                                            | 1374/9734 [00:07<00:41, 200.04it/s] 14%|███████▍                                            | 1395/9734 [00:07<00:41, 201.59it/s] 15%|███████▌                                            | 1416/9734 [00:07<00:41, 202.74it/s] 15%|███████▋                                            | 1437/9734 [00:07<00:40, 202.79it/s] 15%|███████▊                                            | 1458/9734 [00:07<00:40, 201.88it/s] 15%|███████▉                                            | 1479/9734 [00:07<00:40, 201.38it/s] 15%|████████                                            | 1500/9734 [00:08<00:41, 200.71it/s] 16%|████████▏                                           | 1521/9734 [00:08<00:41, 199.32it/s] 16%|████████▏                                           | 1542/9734 [00:08<00:40, 200.48it/s] 16%|████████▎                                           | 1563/9734 [00:08<00:40, 201.74it/s] 16%|████████▍                                           | 1584/9734 [00:08<00:40, 199.63it/s] 16%|████████▌                                           | 1605/9734 [00:08<00:40, 199.79it/s] 17%|████████▋                                           | 1625/9734 [00:08<00:40, 199.66it/s] 17%|████████▊                                           | 1646/9734 [00:08<00:40, 200.10it/s] 17%|████████▉                                           | 1667/9734 [00:08<00:40, 200.96it/s] 17%|█████████                                           | 1688/9734 [00:09<00:39, 201.92it/s] 18%|█████████▏                                          | 1709/9734 [00:09<00:39, 202.45it/s] 18%|█████████▏                                          | 1730/9734 [00:09<00:39, 203.00it/s] 18%|█████████▎                                          | 1751/9734 [00:09<00:39, 201.85it/s] 18%|█████████▍                                          | 1772/9734 [00:09<00:39, 200.99it/s] 18%|█████████▌                                          | 1793/9734 [00:09<00:44, 179.13it/s] 19%|█████████▋                                          | 1813/9734 [00:09<00:42, 184.63it/s] 19%|█████████▊                                          | 1834/9734 [00:09<00:41, 190.09it/s] 19%|█████████▉                                          | 1855/9734 [00:09<00:40, 194.27it/s] 19%|██████████                                          | 1876/9734 [00:10<00:39, 196.74it/s] 19%|██████████▏                                         | 1897/9734 [00:10<00:39, 199.03it/s] 20%|██████████▏                                         | 1918/9734 [00:10<00:38, 200.59it/s] 20%|██████████▎                                         | 1939/9734 [00:10<00:38, 201.81it/s] 20%|██████████▍                                         | 1960/9734 [00:10<00:38, 202.42it/s] 20%|██████████▌                                         | 1981/9734 [00:10<00:38, 201.95it/s] 21%|██████████▋                                         | 2002/9734 [00:10<00:38, 201.61it/s] 21%|██████████▊                                         | 2023/9734 [00:10<00:38, 199.45it/s] 21%|██████████▉                                         | 2044/9734 [00:10<00:38, 200.56it/s] 21%|███████████                                         | 2065/9734 [00:10<00:38, 200.19it/s] 21%|███████████▏                                        | 2086/9734 [00:11<00:38, 198.97it/s] 22%|███████████▎                                        | 2106/9734 [00:11<00:38, 198.92it/s] 22%|███████████▎                                        | 2126/9734 [00:11<00:38, 198.88it/s] 22%|███████████▍                                        | 2147/9734 [00:11<00:38, 199.25it/s] 22%|███████████▌                                        | 2168/9734 [00:11<00:37, 199.69it/s] 22%|███████████▋                                        | 2189/9734 [00:11<00:37, 200.39it/s] 23%|███████████▊                                        | 2210/9734 [00:11<00:37, 200.67it/s] 23%|███████████▉                                        | 2231/9734 [00:11<00:37, 200.76it/s] 23%|████████████                                        | 2252/9734 [00:11<00:37, 199.06it/s] 23%|████████████▏                                       | 2273/9734 [00:11<00:37, 199.80it/s] 24%|████████████▎                                       | 2294/9734 [00:12<00:37, 200.57it/s] 24%|████████████▎                                       | 2315/9734 [00:12<00:37, 200.40it/s] 24%|████████████▍                                       | 2336/9734 [00:12<00:36, 200.40it/s] 24%|████████████▌                                       | 2357/9734 [00:12<00:36, 200.60it/s] 24%|████████████▋                                       | 2378/9734 [00:12<00:36, 200.84it/s] 25%|████████████▊                                       | 2399/9734 [00:12<00:36, 200.24it/s] 25%|████████████▉                                       | 2420/9734 [00:12<00:36, 200.45it/s] 25%|█████████████                                       | 2441/9734 [00:12<00:36, 200.46it/s] 25%|█████████████▏                                      | 2462/9734 [00:12<00:36, 200.09it/s] 26%|█████████████▎                                      | 2483/9734 [00:13<00:36, 199.83it/s] 26%|█████████████▍                                      | 2504/9734 [00:13<00:36, 200.21it/s] 26%|█████████████▍                                      | 2525/9734 [00:13<00:35, 200.56it/s] 26%|█████████████▌                                      | 2546/9734 [00:13<00:35, 201.11it/s] 26%|█████████████▋                                      | 2567/9734 [00:13<00:35, 200.96it/s] 27%|█████████████▊                                      | 2588/9734 [00:13<00:35, 200.60it/s] 27%|█████████████▉                                      | 2609/9734 [00:13<00:35, 200.88it/s] 27%|██████████████                                      | 2630/9734 [00:13<00:35, 200.73it/s] 27%|██████████████▏                                     | 2651/9734 [00:13<00:35, 200.60it/s] 27%|██████████████▎                                     | 2672/9734 [00:13<00:35, 200.71it/s] 28%|██████████████▍                                     | 2693/9734 [00:14<00:35, 199.70it/s] 28%|██████████████▍                                     | 2713/9734 [00:14<00:37, 188.58it/s] 28%|██████████████▌                                     | 2734/9734 [00:14<00:36, 192.59it/s] 28%|██████████████▋                                     | 2755/9734 [00:14<00:35, 195.41it/s] 29%|██████████████▊                                     | 2776/9734 [00:14<00:35, 197.05it/s] 29%|██████████████▉                                     | 2796/9734 [00:14<00:35, 195.41it/s] 29%|███████████████                                     | 2816/9734 [00:14<00:35, 193.76it/s] 29%|███████████████▏                                    | 2837/9734 [00:14<00:35, 197.02it/s] 29%|███████████████▎                                    | 2858/9734 [00:14<00:34, 199.47it/s] 30%|███████████████▎                                    | 2878/9734 [00:15<00:34, 199.29it/s] 30%|███████████████▍                                    | 2899/9734 [00:15<00:34, 201.00it/s] 30%|███████████████▌                                    | 2920/9734 [00:15<00:33, 201.66it/s] 30%|███████████████▋                                    | 2941/9734 [00:15<00:33, 199.95it/s] 30%|███████████████▊                                    | 2962/9734 [00:15<00:33, 200.03it/s] 31%|███████████████▉                                    | 2983/9734 [00:15<00:33, 200.85it/s] 31%|████████████████                                    | 3004/9734 [00:15<00:33, 201.64it/s] 31%|████████████████▏                                   | 3025/9734 [00:15<00:33, 201.26it/s] 31%|████████████████▎                                   | 3046/9734 [00:15<00:33, 201.31it/s] 32%|████████████████▍                                   | 3067/9734 [00:15<00:33, 201.99it/s] 32%|████████████████▍                                   | 3088/9734 [00:16<00:32, 202.70it/s] 32%|████████████████▌                                   | 3109/9734 [00:16<00:32, 202.60it/s] 32%|████████████████▋                                   | 3130/9734 [00:16<00:32, 201.41it/s] 32%|████████████████▊                                   | 3151/9734 [00:16<00:32, 201.07it/s] 33%|████████████████▉                                   | 3172/9734 [00:16<00:32, 199.57it/s] 33%|█████████████████                                   | 3192/9734 [00:16<00:32, 199.31it/s] 33%|█████████████████▏                                  | 3212/9734 [00:16<00:35, 184.59it/s] 33%|█████████████████▎                                  | 3232/9734 [00:16<00:34, 188.54it/s] 33%|█████████████████▍                                  | 3253/9734 [00:16<00:33, 193.30it/s] 34%|█████████████████▍                                  | 3274/9734 [00:17<00:32, 196.61it/s] 34%|█████████████████▌                                  | 3295/9734 [00:17<00:32, 198.80it/s] 34%|█████████████████▋                                  | 3316/9734 [00:17<00:32, 199.53it/s] 34%|█████████████████▊                                  | 3337/9734 [00:17<00:31, 201.00it/s] 34%|█████████████████▉                                  | 3358/9734 [00:17<00:31, 202.21it/s] 35%|██████████████████                                  | 3379/9734 [00:17<00:31, 202.84it/s] 35%|██████████████████▏                                 | 3400/9734 [00:17<00:31, 201.43it/s] 35%|██████████████████▎                                 | 3421/9734 [00:17<00:31, 201.81it/s] 35%|██████████████████▍                                 | 3442/9734 [00:17<00:31, 201.83it/s] 36%|██████████████████▍                                 | 3463/9734 [00:17<00:31, 199.25it/s] 36%|██████████████████▌                                 | 3484/9734 [00:18<00:31, 200.60it/s] 36%|██████████████████▋                                 | 3505/9734 [00:18<00:30, 201.47it/s] 36%|██████████████████▊                                 | 3526/9734 [00:18<00:30, 202.47it/s] 36%|██████████████████▉                                 | 3547/9734 [00:18<00:30, 202.18it/s] 37%|███████████████████                                 | 3568/9734 [00:18<00:30, 201.55it/s] 37%|███████████████████▏                                | 3589/9734 [00:18<00:30, 201.30it/s] 37%|███████████████████▎                                | 3610/9734 [00:18<00:30, 200.63it/s] 37%|███████████████████▍                                | 3631/9734 [00:18<00:30, 201.90it/s] 38%|███████████████████▌                                | 3652/9734 [00:18<00:30, 202.68it/s] 38%|███████████████████▌                                | 3673/9734 [00:18<00:29, 203.25it/s] 38%|███████████████████▋                                | 3694/9734 [00:19<00:29, 203.77it/s] 38%|███████████████████▊                                | 3715/9734 [00:19<00:29, 202.88it/s] 38%|███████████████████▉                                | 3736/9734 [00:19<00:29, 201.96it/s] 39%|████████████████████                                | 3757/9734 [00:19<00:29, 201.23it/s] 39%|████████████████████▏                               | 3778/9734 [00:19<00:29, 200.96it/s] 39%|████████████████████▎                               | 3799/9734 [00:19<00:29, 200.67it/s] 39%|████████████████████▍                               | 3820/9734 [00:19<00:29, 199.41it/s] 39%|████████████████████▌                               | 3840/9734 [00:19<00:29, 199.46it/s] 40%|████████████████████▋                               | 3861/9734 [00:19<00:29, 201.11it/s] 40%|████████████████████▋                               | 3882/9734 [00:20<00:28, 202.29it/s] 40%|████████████████████▊                               | 3903/9734 [00:20<00:28, 203.12it/s] 40%|████████████████████▉                               | 3924/9734 [00:20<00:28, 203.45it/s] 41%|█████████████████████                               | 3945/9734 [00:20<00:28, 203.92it/s] 41%|█████████████████████▏                              | 3966/9734 [00:20<00:28, 204.25it/s] 41%|█████████████████████▎                              | 3987/9734 [00:20<00:28, 204.29it/s] 41%|█████████████████████▍                              | 4008/9734 [00:20<00:27, 204.64it/s] 41%|█████████████████████▌                              | 4029/9734 [00:20<00:27, 204.67it/s] 42%|█████████████████████▋                              | 4050/9734 [00:20<00:27, 204.83it/s] 42%|█████████████████████▋                              | 4071/9734 [00:20<00:27, 203.13it/s] 42%|█████████████████████▊                              | 4092/9734 [00:21<00:27, 203.62it/s] 42%|█████████████████████▉                              | 4113/9734 [00:21<00:27, 203.69it/s] 42%|██████████████████████                              | 4134/9734 [00:21<00:27, 203.72it/s] 43%|██████████████████████▏                             | 4155/9734 [00:21<00:27, 202.40it/s] 43%|██████████████████████▎                             | 4176/9734 [00:21<00:27, 203.11it/s] 43%|██████████████████████▍                             | 4197/9734 [00:21<00:27, 203.51it/s] 43%|██████████████████████▌                             | 4218/9734 [00:21<00:27, 203.77it/s] 44%|██████████████████████▋                             | 4239/9734 [00:21<00:26, 203.95it/s] 44%|██████████████████████▊                             | 4260/9734 [00:21<00:26, 204.31it/s] 44%|██████████████████████▊                             | 4281/9734 [00:21<00:26, 204.51it/s] 44%|██████████████████████▉                             | 4302/9734 [00:22<00:26, 203.17it/s] 44%|███████████████████████                             | 4323/9734 [00:22<00:26, 203.58it/s] 45%|███████████████████████▏                            | 4344/9734 [00:22<00:26, 203.94it/s] 45%|███████████████████████▎                            | 4365/9734 [00:22<00:26, 204.06it/s] 45%|███████████████████████▍                            | 4386/9734 [00:22<00:26, 204.13it/s] 45%|███████████████████████▌                            | 4407/9734 [00:22<00:26, 203.45it/s] 45%|███████████████████████▋                            | 4428/9734 [00:22<00:26, 203.06it/s] 46%|███████████████████████▊                            | 4449/9734 [00:22<00:26, 203.26it/s] 46%|███████████████████████▉                            | 4470/9734 [00:22<00:25, 203.66it/s] 46%|███████████████████████▉                            | 4491/9734 [00:23<00:25, 203.74it/s] 46%|████████████████████████                            | 4512/9734 [00:23<00:25, 202.46it/s] 47%|████████████████████████▏                           | 4533/9734 [00:23<00:28, 180.89it/s] 47%|████████████████████████▎                           | 4554/9734 [00:23<00:27, 187.44it/s] 47%|████████████████████████▍                           | 4575/9734 [00:23<00:26, 192.15it/s] 47%|████████████████████████▌                           | 4596/9734 [00:23<00:26, 195.89it/s] 47%|████████████████████████▋                           | 4617/9734 [00:23<00:25, 198.34it/s] 48%|████████████████████████▊                           | 4638/9734 [00:23<00:25, 200.35it/s] 48%|████████████████████████▉                           | 4659/9734 [00:23<00:25, 201.67it/s] 48%|█████████████████████████                           | 4680/9734 [00:23<00:24, 202.74it/s] 48%|█████████████████████████                           | 4701/9734 [00:24<00:24, 203.15it/s] 49%|█████████████████████████▏                          | 4722/9734 [00:24<00:24, 203.46it/s] 49%|█████████████████████████▎                          | 4743/9734 [00:24<00:35, 140.89it/s] 49%|█████████████████████████▍                          | 4764/9734 [00:24<00:32, 155.05it/s] 49%|█████████████████████████▌                          | 4785/9734 [00:24<00:29, 167.06it/s] 49%|█████████████████████████▋                          | 4805/9734 [00:24<00:28, 175.18it/s] 50%|█████████████████████████▊                          | 4826/9734 [00:24<00:26, 182.97it/s] 50%|█████████████████████████▉                          | 4847/9734 [00:24<00:25, 188.82it/s] 50%|██████████████████████████                          | 4868/9734 [00:25<00:25, 193.03it/s] 50%|██████████████████████████                          | 4889/9734 [00:25<00:24, 195.99it/s] 50%|██████████████████████████▏                         | 4910/9734 [00:25<00:24, 197.99it/s] 51%|██████████████████████████▎                         | 4931/9734 [00:25<00:24, 199.49it/s] 51%|██████████████████████████▍                         | 4952/9734 [00:25<00:24, 198.75it/s] 51%|██████████████████████████▌                         | 4973/9734 [00:25<00:23, 200.05it/s] 51%|██████████████████████████▋                         | 4994/9734 [00:25<00:23, 200.64it/s] 52%|██████████████████████████▊                         | 5015/9734 [00:25<00:23, 201.32it/s] 52%|██████████████████████████▉                         | 5036/9734 [00:25<00:23, 201.87it/s] 52%|███████████████████████████                         | 5057/9734 [00:25<00:23, 201.87it/s] 52%|███████████████████████████▏                        | 5078/9734 [00:26<00:23, 201.52it/s] 52%|███████████████████████████▏                        | 5099/9734 [00:26<00:23, 201.21it/s] 53%|███████████████████████████▎                        | 5120/9734 [00:26<00:22, 201.24it/s] 53%|███████████████████████████▍                        | 5141/9734 [00:26<00:22, 200.99it/s] 53%|███████████████████████████▌                        | 5162/9734 [00:26<00:22, 199.86it/s] 53%|███████████████████████████▋                        | 5182/9734 [00:26<00:22, 198.91it/s] 53%|███████████████████████████▊                        | 5203/9734 [00:26<00:22, 199.94it/s] 54%|███████████████████████████▉                        | 5224/9734 [00:26<00:22, 200.85it/s] 54%|████████████████████████████                        | 5245/9734 [00:26<00:22, 201.43it/s] 54%|████████████████████████████▏                       | 5266/9734 [00:27<00:22, 201.73it/s] 54%|████████████████████████████▏                       | 5287/9734 [00:27<00:22, 201.92it/s] 55%|████████████████████████████▎                       | 5308/9734 [00:27<00:21, 201.96it/s] 55%|████████████████████████████▍                       | 5329/9734 [00:27<00:21, 201.89it/s] 55%|████████████████████████████▌                       | 5350/9734 [00:27<00:21, 202.35it/s] 55%|████████████████████████████▋                       | 5371/9734 [00:27<00:21, 202.77it/s] 55%|████████████████████████████▊                       | 5392/9734 [00:27<00:21, 202.83it/s] 56%|████████████████████████████▉                       | 5413/9734 [00:27<00:21, 201.43it/s] 56%|█████████████████████████████                       | 5434/9734 [00:27<00:21, 201.88it/s] 56%|█████████████████████████████▏                      | 5455/9734 [00:27<00:21, 202.29it/s] 56%|█████████████████████████████▎                      | 5476/9734 [00:28<00:20, 203.00it/s] 56%|█████████████████████████████▎                      | 5497/9734 [00:28<00:20, 204.64it/s] 57%|█████████████████████████████▍                      | 5518/9734 [00:28<00:20, 206.00it/s] 57%|█████████████████████████████▌                      | 5539/9734 [00:28<00:20, 206.91it/s] 57%|█████████████████████████████▋                      | 5560/9734 [00:28<00:20, 207.55it/s] 57%|█████████████████████████████▊                      | 5581/9734 [00:28<00:19, 207.81it/s] 58%|█████████████████████████████▉                      | 5602/9734 [00:28<00:19, 207.02it/s] 58%|██████████████████████████████                      | 5623/9734 [00:28<00:19, 207.48it/s] 58%|██████████████████████████████▏                     | 5644/9734 [00:28<00:19, 206.22it/s] 58%|██████████████████████████████▎                     | 5665/9734 [00:28<00:19, 207.09it/s] 58%|██████████████████████████████▍                     | 5686/9734 [00:29<00:19, 207.58it/s] 59%|██████████████████████████████▍                     | 5707/9734 [00:29<00:19, 207.98it/s] 59%|██████████████████████████████▌                     | 5728/9734 [00:29<00:19, 208.25it/s] 59%|██████████████████████████████▋                     | 5749/9734 [00:29<00:19, 207.88it/s] 59%|██████████████████████████████▊                     | 5770/9734 [00:29<00:19, 208.20it/s] 59%|██████████████████████████████▉                     | 5791/9734 [00:29<00:18, 208.44it/s] 60%|███████████████████████████████                     | 5812/9734 [00:29<00:18, 208.58it/s] 60%|███████████████████████████████▏                    | 5833/9734 [00:29<00:18, 208.56it/s] 60%|███████████████████████████████▎                    | 5854/9734 [00:29<00:18, 207.04it/s] 60%|███████████████████████████████▍                    | 5875/9734 [00:29<00:18, 207.65it/s] 61%|███████████████████████████████▍                    | 5896/9734 [00:30<00:18, 207.80it/s] 61%|███████████████████████████████▌                    | 5917/9734 [00:30<00:18, 207.83it/s] 61%|███████████████████████████████▋                    | 5938/9734 [00:30<00:18, 208.08it/s] 61%|███████████████████████████████▊                    | 5959/9734 [00:30<00:18, 208.37it/s] 61%|███████████████████████████████▉                    | 5980/9734 [00:30<00:18, 208.54it/s] 62%|████████████████████████████████                    | 6001/9734 [00:30<00:17, 208.61it/s] 62%|████████████████████████████████▏                   | 6022/9734 [00:30<00:17, 208.68it/s] 62%|████████████████████████████████▎                   | 6043/9734 [00:30<00:17, 208.82it/s] 62%|████████████████████████████████▍                   | 6064/9734 [00:30<00:17, 208.56it/s] 63%|████████████████████████████████▌                   | 6085/9734 [00:31<00:17, 207.06it/s] 63%|████████████████████████████████▌                   | 6106/9734 [00:31<00:17, 207.58it/s] 63%|████████████████████████████████▋                   | 6127/9734 [00:31<00:17, 207.56it/s] 63%|████████████████████████████████▊                   | 6148/9734 [00:31<00:17, 207.68it/s] 63%|████████████████████████████████▉                   | 6169/9734 [00:31<00:17, 207.67it/s] 64%|█████████████████████████████████                   | 6190/9734 [00:31<00:17, 208.07it/s] 64%|█████████████████████████████████▏                  | 6211/9734 [00:31<00:16, 208.29it/s] 64%|█████████████████████████████████▎                  | 6232/9734 [00:31<00:16, 208.20it/s] 64%|█████████████████████████████████▍                  | 6253/9734 [00:31<00:16, 208.34it/s] 64%|█████████████████████████████████▌                  | 6274/9734 [00:31<00:16, 208.50it/s] 65%|█████████████████████████████████▋                  | 6295/9734 [00:32<00:16, 208.48it/s] 65%|█████████████████████████████████▋                  | 6316/9734 [00:32<00:16, 206.90it/s] 65%|█████████████████████████████████▊                  | 6337/9734 [00:32<00:16, 207.40it/s] 65%|█████████████████████████████████▉                  | 6358/9734 [00:32<00:16, 207.74it/s] 66%|██████████████████████████████████                  | 6379/9734 [00:32<00:16, 207.97it/s] 66%|██████████████████████████████████▏                 | 6400/9734 [00:32<00:16, 208.27it/s] 66%|██████████████████████████████████▎                 | 6421/9734 [00:32<00:15, 208.38it/s] 66%|██████████████████████████████████▍                 | 6442/9734 [00:32<00:15, 208.50it/s] 66%|██████████████████████████████████▌                 | 6463/9734 [00:32<00:15, 208.33it/s] 67%|██████████████████████████████████▋                 | 6484/9734 [00:32<00:15, 208.26it/s] 67%|██████████████████████████████████▊                 | 6505/9734 [00:33<00:15, 208.31it/s] 67%|██████████████████████████████████▊                 | 6526/9734 [00:33<00:15, 207.98it/s] 67%|██████████████████████████████████▉                 | 6547/9734 [00:33<00:15, 206.53it/s] 67%|███████████████████████████████████                 | 6568/9734 [00:33<00:15, 206.70it/s] 68%|███████████████████████████████████▏                | 6589/9734 [00:33<00:15, 207.02it/s] 68%|███████████████████████████████████▎                | 6610/9734 [00:33<00:15, 207.51it/s] 68%|███████████████████████████████████▍                | 6631/9734 [00:33<00:14, 207.64it/s] 68%|███████████████████████████████████▌                | 6652/9734 [00:33<00:14, 208.02it/s] 69%|███████████████████████████████████▋                | 6673/9734 [00:33<00:14, 208.21it/s] 69%|███████████████████████████████████▊                | 6694/9734 [00:33<00:14, 208.35it/s] 69%|███████████████████████████████████▊                | 6715/9734 [00:34<00:14, 208.60it/s] 69%|███████████████████████████████████▉                | 6736/9734 [00:34<00:14, 208.79it/s] 69%|████████████████████████████████████                | 6757/9734 [00:34<00:14, 208.98it/s] 70%|████████████████████████████████████▏               | 6778/9734 [00:34<00:14, 207.47it/s] 70%|████████████████████████████████████▎               | 6799/9734 [00:34<00:14, 207.91it/s] 70%|████████████████████████████████████▍               | 6820/9734 [00:34<00:13, 208.28it/s] 70%|████████████████████████████████████▌               | 6841/9734 [00:34<00:13, 208.58it/s] 70%|████████████████████████████████████▋               | 6862/9734 [00:34<00:13, 208.58it/s] 71%|████████████████████████████████████▊               | 6883/9734 [00:34<00:13, 208.69it/s] 71%|████████████████████████████████████▉               | 6904/9734 [00:34<00:13, 208.71it/s] 71%|████████████████████████████████████▉               | 6925/9734 [00:35<00:13, 208.82it/s] 71%|█████████████████████████████████████               | 6946/9734 [00:35<00:13, 208.94it/s] 72%|█████████████████████████████████████▏              | 6967/9734 [00:35<00:13, 207.41it/s] 72%|█████████████████████████████████████▎              | 6988/9734 [00:35<00:13, 202.87it/s] 72%|█████████████████████████████████████▍              | 7009/9734 [00:35<00:13, 199.77it/s] 72%|█████████████████████████████████████▌              | 7030/9734 [00:35<00:13, 201.88it/s] 72%|█████████████████████████████████████▋              | 7051/9734 [00:35<00:13, 203.85it/s] 73%|█████████████████████████████████████▊              | 7072/9734 [00:35<00:12, 205.06it/s] 73%|█████████████████████████████████████▉              | 7093/9734 [00:35<00:12, 205.58it/s] 73%|██████████████████████████████████████              | 7114/9734 [00:35<00:12, 205.31it/s] 73%|██████████████████████████████████████              | 7135/9734 [00:36<00:12, 205.75it/s] 74%|██████████████████████████████████████▏             | 7156/9734 [00:36<00:12, 206.09it/s] 74%|██████████████████████████████████████▎             | 7177/9734 [00:36<00:12, 205.59it/s] 74%|██████████████████████████████████████▍             | 7198/9734 [00:36<00:12, 203.03it/s] 74%|██████████████████████████████████████▌             | 7219/9734 [00:36<00:12, 203.06it/s] 74%|██████████████████████████████████████▋             | 7240/9734 [00:36<00:12, 204.57it/s] 75%|██████████████████████████████████████▊             | 7261/9734 [00:36<00:12, 205.75it/s] 75%|██████████████████████████████████████▉             | 7282/9734 [00:36<00:11, 206.71it/s] 75%|███████████████████████████████████████             | 7303/9734 [00:36<00:11, 207.44it/s] 75%|███████████████████████████████████████▏            | 7324/9734 [00:36<00:11, 207.86it/s] 75%|███████████████████████████████████████▏            | 7345/9734 [00:37<00:11, 208.16it/s] 76%|███████████████████████████████████████▎            | 7366/9734 [00:37<00:11, 208.42it/s] 76%|███████████████████████████████████████▍            | 7387/9734 [00:37<00:11, 208.55it/s] 76%|███████████████████████████████████████▌            | 7408/9734 [00:37<00:11, 208.24it/s] 76%|███████████████████████████████████████▋            | 7429/9734 [00:37<00:11, 208.02it/s] 77%|███████████████████████████████████████▊            | 7450/9734 [00:37<00:12, 189.83it/s] 77%|███████████████████████████████████████▉            | 7471/9734 [00:37<00:11, 195.20it/s] 77%|████████████████████████████████████████            | 7492/9734 [00:37<00:11, 198.78it/s] 77%|████████████████████████████████████████▏           | 7513/9734 [00:37<00:11, 201.34it/s] 77%|████████████████████████████████████████▏           | 7534/9734 [00:38<00:10, 203.19it/s] 78%|████████████████████████████████████████▎           | 7555/9734 [00:38<00:10, 204.62it/s] 78%|████████████████████████████████████████▍           | 7576/9734 [00:38<00:10, 205.50it/s] 78%|████████████████████████████████████████▌           | 7597/9734 [00:38<00:10, 206.51it/s] 78%|████████████████████████████████████████▋           | 7618/9734 [00:38<00:10, 207.19it/s] 78%|████████████████████████████████████████▊           | 7639/9734 [00:38<00:10, 207.46it/s] 79%|████████████████████████████████████████▉           | 7660/9734 [00:38<00:09, 207.74it/s] 79%|█████████████████████████████████████████           | 7681/9734 [00:38<00:09, 206.34it/s] 79%|█████████████████████████████████████████▏          | 7702/9734 [00:38<00:09, 206.26it/s] 79%|█████████████████████████████████████████▎          | 7723/9734 [00:38<00:09, 207.05it/s] 80%|█████████████████████████████████████████▎          | 7744/9734 [00:39<00:09, 207.50it/s] 80%|█████████████████████████████████████████▍          | 7765/9734 [00:39<00:09, 207.76it/s] 80%|█████████████████████████████████████████▌          | 7786/9734 [00:39<00:09, 207.75it/s] 80%|█████████████████████████████████████████▋          | 7807/9734 [00:39<00:09, 207.54it/s] 80%|█████████████████████████████████████████▊          | 7828/9734 [00:39<00:09, 207.25it/s] 81%|█████████████████████████████████████████▉          | 7849/9734 [00:39<00:09, 207.44it/s] 81%|██████████████████████████████████████████          | 7870/9734 [00:39<00:08, 207.71it/s] 81%|██████████████████████████████████████████▏         | 7891/9734 [00:39<00:08, 207.73it/s] 81%|██████████████████████████████████████████▎         | 7912/9734 [00:39<00:08, 206.45it/s] 81%|██████████████████████████████████████████▍         | 7933/9734 [00:39<00:08, 207.08it/s] 82%|██████████████████████████████████████████▍         | 7954/9734 [00:40<00:08, 207.64it/s] 82%|██████████████████████████████████████████▌         | 7975/9734 [00:40<00:08, 208.03it/s] 82%|██████████████████████████████████████████▋         | 7996/9734 [00:40<00:08, 208.21it/s] 82%|██████████████████████████████████████████▊         | 8017/9734 [00:40<00:08, 208.40it/s] 83%|██████████████████████████████████████████▉         | 8038/9734 [00:40<00:08, 208.52it/s] 83%|███████████████████████████████████████████         | 8059/9734 [00:40<00:08, 208.52it/s] 83%|███████████████████████████████████████████▏        | 8080/9734 [00:40<00:07, 208.70it/s] 83%|███████████████████████████████████████████▎        | 8101/9734 [00:40<00:07, 209.06it/s] 83%|███████████████████████████████████████████▍        | 8122/9734 [00:40<00:07, 209.19it/s] 84%|███████████████████████████████████████████▌        | 8143/9734 [00:40<00:07, 207.64it/s] 84%|███████████████████████████████████████████▌        | 8164/9734 [00:41<00:07, 207.95it/s] 84%|███████████████████████████████████████████▋        | 8185/9734 [00:41<00:07, 208.10it/s] 84%|███████████████████████████████████████████▊        | 8206/9734 [00:41<00:07, 208.28it/s] 85%|███████████████████████████████████████████▉        | 8227/9734 [00:41<00:07, 208.45it/s] 85%|████████████████████████████████████████████        | 8248/9734 [00:41<00:07, 208.48it/s] 85%|████████████████████████████████████████████▏       | 8269/9734 [00:41<00:07, 208.58it/s] 85%|████████████████████████████████████████████▎       | 8290/9734 [00:41<00:06, 208.44it/s] 85%|████████████████████████████████████████████▍       | 8311/9734 [00:41<00:06, 208.60it/s] 86%|████████████████████████████████████████████▌       | 8332/9734 [00:41<00:06, 208.76it/s] 86%|████████████████████████████████████████████▌       | 8353/9734 [00:41<00:06, 206.63it/s] 86%|████████████████████████████████████████████▋       | 8374/9734 [00:42<00:06, 207.02it/s] 86%|████████████████████████████████████████████▊       | 8395/9734 [00:42<00:06, 207.41it/s] 86%|████████████████████████████████████████████▉       | 8416/9734 [00:42<00:06, 207.91it/s] 87%|█████████████████████████████████████████████       | 8437/9734 [00:42<00:06, 208.26it/s] 87%|█████████████████████████████████████████████▏      | 8458/9734 [00:42<00:06, 208.43it/s] 87%|█████████████████████████████████████████████▎      | 8479/9734 [00:42<00:06, 208.51it/s] 87%|█████████████████████████████████████████████▍      | 8500/9734 [00:42<00:05, 208.72it/s] 88%|█████████████████████████████████████████████▌      | 8521/9734 [00:42<00:05, 208.50it/s] 88%|█████████████████████████████████████████████▋      | 8542/9734 [00:42<00:05, 208.42it/s] 88%|█████████████████████████████████████████████▋      | 8563/9734 [00:42<00:05, 208.41it/s] 88%|█████████████████████████████████████████████▊      | 8584/9734 [00:43<00:05, 206.93it/s] 88%|█████████████████████████████████████████████▉      | 8605/9734 [00:43<00:05, 207.34it/s] 89%|██████████████████████████████████████████████      | 8626/9734 [00:43<00:05, 207.80it/s] 89%|██████████████████████████████████████████████▏     | 8647/9734 [00:43<00:05, 208.06it/s] 89%|██████████████████████████████████████████████▎     | 8668/9734 [00:43<00:05, 207.95it/s] 89%|██████████████████████████████████████████████▍     | 8689/9734 [00:43<00:05, 208.35it/s] 89%|██████████████████████████████████████████████▌     | 8710/9734 [00:43<00:04, 208.48it/s] 90%|██████████████████████████████████████████████▋     | 8731/9734 [00:43<00:04, 208.51it/s] 90%|██████████████████████████████████████████████▊     | 8752/9734 [00:43<00:04, 208.17it/s] 90%|██████████████████████████████████████████████▊     | 8773/9734 [00:43<00:04, 208.21it/s] 90%|██████████████████████████████████████████████▉     | 8794/9734 [00:44<00:04, 206.87it/s] 91%|███████████████████████████████████████████████     | 8815/9734 [00:44<00:04, 205.89it/s] 91%|███████████████████████████████████████████████▏    | 8836/9734 [00:44<00:04, 206.77it/s] 91%|███████████████████████████████████████████████▎    | 8857/9734 [00:44<00:04, 207.36it/s] 91%|███████████████████████████████████████████████▍    | 8878/9734 [00:44<00:04, 207.82it/s] 91%|███████████████████████████████████████████████▌    | 8899/9734 [00:44<00:04, 208.11it/s] 92%|███████████████████████████████████████████████▋    | 8920/9734 [00:44<00:03, 208.24it/s] 92%|███████████████████████████████████████████████▊    | 8941/9734 [00:44<00:03, 208.31it/s] 92%|███████████████████████████████████████████████▉    | 8962/9734 [00:44<00:03, 208.34it/s] 92%|███████████████████████████████████████████████▉    | 8983/9734 [00:44<00:03, 208.46it/s] 93%|████████████████████████████████████████████████    | 9004/9734 [00:45<00:03, 208.40it/s] 93%|████████████████████████████████████████████████▏   | 9025/9734 [00:45<00:03, 208.41it/s] 93%|████████████████████████████████████████████████▎   | 9046/9734 [00:45<00:03, 206.89it/s] 93%|████████████████████████████████████████████████▍   | 9067/9734 [00:45<00:03, 207.43it/s] 93%|████████████████████████████████████████████████▌   | 9088/9734 [00:45<00:03, 207.54it/s] 94%|████████████████████████████████████████████████▋   | 9109/9734 [00:45<00:03, 207.66it/s] 94%|████████████████████████████████████████████████▊   | 9130/9734 [00:45<00:02, 207.81it/s] 94%|████████████████████████████████████████████████▉   | 9151/9734 [00:45<00:02, 208.02it/s] 94%|████████████████████████████████████████████████▉   | 9172/9734 [00:45<00:02, 208.35it/s] 94%|█████████████████████████████████████████████████   | 9193/9734 [00:46<00:02, 208.36it/s] 95%|█████████████████████████████████████████████████▏  | 9214/9734 [00:46<00:02, 208.34it/s] 95%|█████████████████████████████████████████████████▎  | 9235/9734 [00:46<00:02, 207.97it/s] 95%|█████████████████████████████████████████████████▍  | 9256/9734 [00:46<00:02, 206.41it/s] 95%|█████████████████████████████████████████████████▌  | 9277/9734 [00:46<00:02, 203.88it/s] 96%|█████████████████████████████████████████████████▋  | 9298/9734 [00:46<00:02, 205.20it/s] 96%|█████████████████████████████████████████████████▊  | 9319/9734 [00:46<00:02, 206.21it/s] 96%|█████████████████████████████████████████████████▉  | 9340/9734 [00:46<00:01, 206.92it/s] 96%|██████████████████████████████████████████████████  | 9361/9734 [00:46<00:01, 207.39it/s] 96%|██████████████████████████████████████████████████  | 9382/9734 [00:46<00:01, 207.71it/s] 97%|██████████████████████████████████████████████████▏ | 9403/9734 [00:47<00:01, 207.95it/s] 97%|██████████████████████████████████████████████████▎ | 9424/9734 [00:47<00:01, 207.98it/s] 97%|██████████████████████████████████████████████████▍ | 9445/9734 [00:47<00:01, 207.92it/s] 97%|██████████████████████████████████████████████████▌ | 9466/9734 [00:47<00:01, 207.88it/s] 97%|██████████████████████████████████████████████████▋ | 9487/9734 [00:47<00:01, 206.52it/s] 98%|██████████████████████████████████████████████████▊ | 9508/9734 [00:47<00:01, 206.48it/s] 98%|██████████████████████████████████████████████████▉ | 9529/9734 [00:47<00:00, 207.04it/s] 98%|███████████████████████████████████████████████████ | 9550/9734 [00:47<00:00, 207.44it/s] 98%|███████████████████████████████████████████████████▏| 9571/9734 [00:47<00:00, 207.87it/s] 99%|███████████████████████████████████████████████████▏| 9592/9734 [00:47<00:00, 207.94it/s] 99%|███████████████████████████████████████████████████▎| 9613/9734 [00:48<00:00, 208.08it/s] 99%|███████████████████████████████████████████████████▍| 9634/9734 [00:48<00:00, 207.98it/s] 99%|███████████████████████████████████████████████████▌| 9655/9734 [00:48<00:00, 207.84it/s] 99%|███████████████████████████████████████████████████▋| 9676/9734 [00:48<00:00, 207.92it/s]100%|███████████████████████████████████████████████████▊| 9697/9734 [00:48<00:00, 207.89it/s]100%|███████████████████████████████████████████████████▉| 9718/9734 [00:48<00:00, 205.74it/s]100%|████████████████████████████████████████████████████| 9734/9734 [00:48<00:00, 200.21it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.33s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.36s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.31s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.30s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.40s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.38s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.42s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.37s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.74s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.91s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.74s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.91s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.81s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.97s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.83s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.97s/it]
[2023-08-22 02:06:53,553] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
[2023-08-22 02:07:02,809] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-22 02:07:02,810] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-22 02:07:02,810] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-22 02:07:02,811] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-22 02:07:02,811] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-22 02:07:02,811] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-22 02:07:02,811] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-22 02:07:02,811] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-22 02:07:02,811] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-22 02:07:02,811] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-22 02:07:02,811] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-22 02:07:02,811] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f5d50a4ffd0>
[2023-08-22 02:07:02,811] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-22 02:07:02,811] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-22 02:07:02,811] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-22 02:07:02,811] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-22 02:07:02,811] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-22 02:07:02,811] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-22 02:07:02,811] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-22 02:07:02,811] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-22 02:07:02,811] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-22 02:07:02,811] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-22 02:07:02,811] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-22 02:07:02,811] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-22 02:07:02,811] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-22 02:07:02,811] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-22 02:07:02,811] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-22 02:07:02,811] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-22 02:07:02,811] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-22 02:07:02,811] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-22 02:07:02,811] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-22 02:07:02,811] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-22 02:07:02,811] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-22 02:07:02,811] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-22 02:07:02,811] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-22 02:07:02,811] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-22 02:07:02,811] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-22 02:07:02,811] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-22 02:07:02,811] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-22 02:07:02,811] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-22 02:07:02,811] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-22 02:07:02,812] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-22 02:07:02,812] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-22 02:07:02,812] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-22 02:07:02,812] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f5d507e8280>
[2023-08-22 02:07:02,812] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-22 02:07:02,812] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-22 02:07:02,812] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-22 02:07:02,812] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-22 02:07:02,812] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-22 02:07:02,812] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-22 02:07:02,812] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-22 02:07:02,812] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-22 02:07:02,812] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-22 02:07:02,812] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-22 02:07:02,812] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-22 02:07:02,812] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-22 02:07:02,812] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-22 02:07:02,812] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-22 02:07:02,812] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-22 02:07:02,812] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-22 02:07:02,812] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-22 02:07:02,812] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-22 02:07:02,812] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-22 02:07:02,812] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-22 02:07:02,812] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-22 02:07:02,812] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-22 02:07:02,812] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.6047821044921875 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Loading extension module utils...
Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]Time to load utils op: 0.6044449806213379 seconds
############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: Fabric is cut to order at what type of seller? Choices:  A: curtains B: tailor shop C: clothing store D: sewing room E: hardware store
Output: 1. The question is asking where fabric is cut to order, which means a place where fabric is cut according to specific measurements given by the customer.
2. Looking at the choices, first we can eliminate E: hardware store as it usually deals with tools and materials related to construction, not fabric.
3. Next, we can eliminate A: curtains, because even though fabric is indeed used to make curtains, the question is asking where the fabric is cut to order, not what it is used for.
4. Then we eliminate C: clothing store. Even though clothing stores do sell fabric products, they generally do not cut fabric to order; rather, they sell finished garments.
5. D: Sewing room can also be eliminated because it is a place where someone might cut and sew fabric, but it is not typically a business where fabric is cut to order.
6. This leaves us with B: tailor shop. A tailor shop is a place where clothes are made and altered to fit specific individuals. Fabric is cut to order based on customers' measurements, making this the most sensible choice. So, the answer is B: tailor shop.
So the final answer is B: tailor shop

Input: Where are you if your reading magazines while waiting for a vehicle on rails? Choices:  A: vegetables B: market C: doctor D: train station E: bookstore
Output: 1. The question is asking about a location where someone could be waiting for a vehicle on rails while reading magazines.
2. "Vehicles on rails" refer to trains or trams. Vegetable, market, doctor, train station, and bookstore are the given choices. We need to identify which one of these is a place where trains or trams stop.
3. A vegetable is not a place but a type of food, so eliminate choice A. A doctor is a profession and not a place where trains stop, so eliminate choice C. A bookstore is a place, but trains do not usually stop there, so eliminate choice E.
4. A market is a place where people buy and sell goods. However, this is generally not a designated area for waiting for trains, so eliminate choice B.
5. The only option left is D: train station. In the context of the question, a train station is a place where trains or trams stop and where people could be waiting and likely have time to read magazines. 
6. Thus, the answer is D: train station.
So the final answer is D: train station

Input: What would need oil to be used? Choices:  A: ground B: human  body C: repair shop D: combustion engines E: service station
Output: Step 1: Understand the question which is asking to select an item from the choices that would definitely need oil for its operation or function. 
Step 2: Clarify what each choice could mean in the context of needing oil.
   A: Ground: We usually don't use oil for dirt or soil operation or behavior.
   B: Human body: Our body needs fats, not oil, for its operation.
   C: Repair Shop: This option seems plausible as oil is frequently used in a repair shop on various instruments. However, the shop itself does not need oil to function.
   D: Combustion Engines: A combustion engine indeed requires oil for lubrication and smooth operation.
   E: Service Station: Similar to repair shop, a service station will utilize oil, yet it isn't necessary for the function of the station itself.
Step 3: Evaluate the choices based upon the provided reasoning and choose the best one.
The combustion engine (choice D) is the option that directly needs oil for its operation. 
Therefore, the answer is D: combustion engines.
So the final answer is D: combustion engines

Input: What is person probably feeling that plans on stopping being married to their spouse? Choices:  A: detachment B: bankruptcy C: sad D: fights E: wrong
Output: 1. The question is about the probable feelings of a person who is planning to end their marriage.
2. Ending a marriage is usually a difficult decision that may invoke several emotional responses.
3. The given options are detachment, bankruptcy, sad, fights, and wrong.
4. We can eliminate 'bankruptcy' as it is a financial state, not an emotion.
5. 'Fights' can be a cause or consequence of ending a marriage, but it is not a feeling.
6. 'Wrong' here is ambiguous. It could refer to feeling like the decision is morally wrong, or feeling wronged by the spouse. But, without context to clarify this, it's not the best answer.
7. 'Sad' is a plausible option as many people feel sadness when ending a marriage. But the phrasing of the question implies a readiness and decision to end the marriage, which suggests a level of emotional distance, or detachment, has been achieved.
8. That leaves us with 'detachment,' which fits the situation most accurately as it indicates a sense of emotional disconnection that often precedes the decision to end a marriage.
9. Therefore, the answer is 'A: detachment.'
So the final answer is A: detachment

Input: What could you use to store a clock? Choices:  A: shelf B: own bedroom C: desk D: wall E: car
Output: 1. The question asks what you could use to store a clock. 
2. This eliminates B: own bedroom and E: car. Although a clock can exist in these locations, we wouldn't necessarily consider them as storage for a clock. 
3. Between A: shelf, C: desk, and D: wall, all could potentially store a clock due to their flat surfaces. 
4. However, while a clock may be placed or hung on a desk or wall, we would not typically consider these as places of storage rather than usage. 
5. Meanwhile, a shelf ideally serves as a storage place where we can place various objects, including a clock. Therefore, a clock can be stored there when not in use. 
6. Hence, the answer is A: shelf.
So the final answer is A: shelf

Input: The person put on lotion, what did they want? Choices:  A: fresh smell B: good credit C: smooth skin D: fresh produce E: headache
Output: 1. The question asks about the purpose of a person putting on lotion.
2. Consider all the options given. 
3. Option A suggests that the person might want a fresh smell. While it's true that some lotions do have fragrances, the primary purpose of lotion is not to give a fresh smell. Thus, this is not the most likely answer.
4. Option B suggests that the person might want good credit. This is not related to use of lotion at all, so this answer is not correct. 
5. Option C suggests that the person might want smooth skin. This aligns with a common purpose of applying lotion, which is to moisturize and smooth the skin. This is a plausible answer. 
6. Option D suggests they want fresh produce. This is not relevant to the use of lotion, so D is not the correct answer.
7. Option E suggests they might want a headache. This does not make sense because lotion is not associated with causing or relieving headaches.
8. Therefore, the most reasonable answer is C, the person put on lotion to have smooth skin.
So the final answer is C: smooth skin

Input: They burned the record, they were trying to do what to history? Choices:  A: compact disc B: tape C: rewrite D: play music E: erase
Output: 1. The question elaborates on a situation where a record is being burned.
2. A record, analogous to history here, contains information or data.
3. When a record is burned, the information it contains is destroyed or removed.
4. This is analogous to trying to erase some parts of history or forget about them.
5. Therefore, if they were trying to burn a record, they were trying to erase history.
6. Hence, the answer is E: erase.
So the final answer is E: erase

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i7-s10-rTrue
Loading extension module utils...
Time to load utils op: 0.6049461364746094 seconds
Loading extension module utils...
Time to load utils op: 0.5049026012420654 seconds
Evaluating commonsenseqa :   0%|                                       | 0/50 [00:03<?, ?it/s]
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 126, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 123, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 107, in evaluate_main
    query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 89, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 126, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 123, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 107, in evaluate_main
    query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 89, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 126, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 123, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 107, in evaluate_main
    query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 89, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 126, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 123, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 107, in evaluate_main
    query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 89, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 3504121) of binary: /home/ylu130/.conda/envs/distllm/bin/python
Traceback (most recent call last):
  File "/home/ylu130/.conda/envs/distllm/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 345, in wrapper
    return f(*args, **kwargs)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 761, in main
    run(args)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 752, in run
    elastic_launch(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 131, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 245, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
/home/ylu130/workspace/in-context-generalization/inference.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2023-08-22_02:07:12
  host      : ia1.wse.jhu.edu
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 3504122)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2023-08-22_02:07:12
  host      : ia1.wse.jhu.edu
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 3504123)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2023-08-22_02:07:12
  host      : ia1.wse.jhu.edu
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 3504124)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2023-08-22_02:07:12
  host      : ia1.wse.jhu.edu
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 3504121)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i8-s10-rTrue --seed 10 --max-prompt-length 2048 --rationales --num-in-domain 8
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...

[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-22 02:07:15,985] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i8-s10-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 8
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i8-s10-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 10
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9733 [00:00<?, ?it/s]  0%|                                                      | 12/9733 [00:00<01:23, 117.04it/s]  0%|▏                                                     | 24/9733 [00:00<01:22, 117.99it/s]  0%|▏                                                     | 36/9733 [00:00<01:22, 118.08it/s]  0%|▎                                                     | 48/9733 [00:00<01:21, 118.46it/s]  1%|▎                                                     | 60/9733 [00:00<01:21, 118.37it/s]  1%|▍                                                     | 72/9733 [00:00<01:23, 116.40it/s]  1%|▍                                                     | 84/9733 [00:00<01:22, 117.05it/s]  1%|▌                                                     | 96/9733 [00:00<01:21, 117.76it/s]  1%|▌                                                    | 108/9733 [00:00<01:21, 118.06it/s]  1%|▋                                                    | 120/9733 [00:01<01:21, 118.32it/s]  1%|▋                                                    | 132/9733 [00:01<01:21, 118.48it/s]  1%|▊                                                    | 144/9733 [00:01<01:20, 118.65it/s]  2%|▊                                                    | 156/9733 [00:01<01:20, 118.83it/s]  2%|▉                                                    | 168/9733 [00:01<01:20, 118.63it/s]  2%|▉                                                    | 180/9733 [00:01<01:20, 118.66it/s]  2%|█                                                    | 192/9733 [00:01<01:21, 117.03it/s]  2%|█                                                    | 204/9733 [00:01<01:22, 115.13it/s]  2%|█▏                                                   | 216/9733 [00:01<01:21, 116.07it/s]  2%|█▏                                                   | 229/9733 [00:01<01:20, 118.72it/s]  3%|█▎                                                   | 248/9733 [00:02<01:09, 137.44it/s]  3%|█▍                                                   | 267/9733 [00:02<01:02, 150.72it/s]  3%|█▌                                                   | 286/9733 [00:02<00:59, 159.87it/s]  3%|█▋                                                   | 305/9733 [00:02<00:56, 166.58it/s]  3%|█▊                                                   | 324/9733 [00:02<00:55, 171.04it/s]  4%|█▊                                                   | 343/9733 [00:02<00:54, 173.86it/s]  4%|█▉                                                   | 362/9733 [00:02<00:53, 176.08it/s]  4%|██                                                   | 381/9733 [00:02<00:52, 177.82it/s]  4%|██▏                                                  | 400/9733 [00:02<00:52, 178.83it/s]  4%|██▎                                                  | 418/9733 [00:02<00:52, 179.13it/s]  4%|██▎                                                  | 436/9733 [00:03<00:52, 178.06it/s]  5%|██▍                                                  | 455/9733 [00:03<00:51, 179.01it/s]  5%|██▌                                                  | 474/9733 [00:03<00:51, 179.41it/s]  5%|██▋                                                  | 493/9733 [00:03<00:51, 179.83it/s]  5%|██▊                                                  | 511/9733 [00:03<00:51, 179.86it/s]  5%|██▉                                                  | 530/9733 [00:03<00:51, 179.89it/s]  6%|██▉                                                  | 549/9733 [00:03<00:50, 180.42it/s]  6%|███                                                  | 568/9733 [00:03<00:50, 180.54it/s]  6%|███▏                                                 | 587/9733 [00:03<00:50, 180.62it/s]  6%|███▎                                                 | 606/9733 [00:04<00:50, 180.32it/s]  6%|███▍                                                 | 625/9733 [00:04<00:50, 179.92it/s]  7%|███▌                                                 | 643/9733 [00:04<00:50, 179.42it/s]  7%|███▌                                                 | 661/9733 [00:04<00:51, 177.74it/s]  7%|███▋                                                 | 679/9733 [00:04<00:50, 177.99it/s]  7%|███▊                                                 | 697/9733 [00:04<00:50, 178.46it/s]  7%|███▉                                                 | 715/9733 [00:04<00:50, 178.45it/s]  8%|███▉                                                 | 734/9733 [00:04<00:50, 179.04it/s]  8%|████                                                 | 753/9733 [00:04<00:49, 179.71it/s]  8%|████▏                                                | 772/9733 [00:04<00:49, 180.11it/s]  8%|████▎                                                | 791/9733 [00:05<00:49, 180.55it/s]  8%|████▍                                                | 810/9733 [00:05<00:49, 180.74it/s]  9%|████▌                                                | 829/9733 [00:05<00:49, 180.94it/s]  9%|████▌                                                | 848/9733 [00:05<00:49, 180.96it/s]  9%|████▋                                                | 867/9733 [00:05<00:49, 179.58it/s]  9%|████▊                                                | 885/9733 [00:05<00:49, 178.38it/s]  9%|████▉                                                | 904/9733 [00:05<00:49, 179.04it/s]  9%|█████                                                | 923/9733 [00:05<00:49, 179.74it/s] 10%|█████▏                                               | 942/9733 [00:05<00:48, 180.24it/s] 10%|█████▏                                               | 961/9733 [00:06<00:48, 180.41it/s] 10%|█████▎                                               | 980/9733 [00:06<00:48, 180.57it/s] 10%|█████▍                                               | 999/9733 [00:06<00:48, 180.79it/s] 10%|█████▍                                              | 1018/9733 [00:06<00:48, 180.78it/s] 11%|█████▌                                              | 1037/9733 [00:06<00:48, 180.89it/s] 11%|█████▋                                              | 1056/9733 [00:06<00:48, 180.73it/s] 11%|█████▋                                              | 1075/9733 [00:06<00:47, 180.82it/s] 11%|█████▊                                              | 1094/9733 [00:06<00:47, 180.81it/s] 11%|█████▉                                              | 1113/9733 [00:06<00:49, 175.63it/s] 12%|██████                                              | 1132/9733 [00:06<00:48, 176.95it/s] 12%|██████▏                                             | 1151/9733 [00:07<00:48, 177.86it/s] 12%|██████▎                                             | 1170/9733 [00:07<00:47, 178.53it/s] 12%|██████▎                                             | 1189/9733 [00:07<00:47, 179.06it/s] 12%|██████▍                                             | 1208/9733 [00:07<00:47, 179.36it/s] 13%|██████▌                                             | 1227/9733 [00:07<00:47, 179.65it/s] 13%|██████▋                                             | 1246/9733 [00:07<00:47, 180.08it/s] 13%|██████▊                                             | 1265/9733 [00:07<00:46, 180.20it/s] 13%|██████▊                                             | 1284/9733 [00:07<00:46, 180.19it/s] 13%|██████▉                                             | 1303/9733 [00:07<00:46, 180.48it/s] 14%|███████                                             | 1322/9733 [00:08<00:46, 180.52it/s] 14%|███████▏                                            | 1341/9733 [00:08<00:46, 178.72it/s] 14%|███████▎                                            | 1360/9733 [00:08<00:46, 179.36it/s] 14%|███████▎                                            | 1379/9733 [00:08<00:46, 179.85it/s] 14%|███████▍                                            | 1398/9733 [00:08<00:46, 180.21it/s] 15%|███████▌                                            | 1417/9733 [00:08<00:46, 180.12it/s] 15%|███████▋                                            | 1436/9733 [00:08<00:46, 180.33it/s] 15%|███████▊                                            | 1455/9733 [00:08<00:45, 180.61it/s] 15%|███████▉                                            | 1474/9733 [00:08<00:45, 180.47it/s] 15%|███████▉                                            | 1493/9733 [00:08<00:45, 180.43it/s] 16%|████████                                            | 1512/9733 [00:09<00:46, 177.04it/s] 16%|████████▏                                           | 1530/9733 [00:09<00:46, 175.62it/s] 16%|████████▎                                           | 1548/9733 [00:09<00:46, 176.72it/s] 16%|████████▎                                           | 1566/9733 [00:09<00:46, 175.98it/s] 16%|████████▍                                           | 1584/9733 [00:09<00:46, 176.93it/s] 16%|████████▌                                           | 1602/9733 [00:09<00:45, 177.80it/s] 17%|████████▋                                           | 1621/9733 [00:09<00:45, 178.69it/s] 17%|████████▊                                           | 1640/9733 [00:09<00:45, 179.21it/s] 17%|████████▊                                           | 1659/9733 [00:09<00:44, 179.66it/s] 17%|████████▉                                           | 1678/9733 [00:10<00:44, 179.87it/s] 17%|█████████                                           | 1697/9733 [00:10<00:44, 180.06it/s] 18%|█████████▏                                          | 1716/9733 [00:10<00:44, 180.09it/s] 18%|█████████▎                                          | 1735/9733 [00:10<00:44, 180.33it/s] 18%|█████████▎                                          | 1754/9733 [00:10<00:44, 180.50it/s] 18%|█████████▍                                          | 1773/9733 [00:10<00:44, 180.43it/s] 18%|█████████▌                                          | 1792/9733 [00:10<00:48, 162.31it/s] 19%|█████████▋                                          | 1811/9733 [00:10<00:47, 167.32it/s] 19%|█████████▊                                          | 1830/9733 [00:10<00:46, 171.17it/s] 19%|█████████▉                                          | 1849/9733 [00:10<00:45, 173.90it/s] 19%|█████████▉                                          | 1868/9733 [00:11<00:44, 175.82it/s] 19%|██████████                                          | 1887/9733 [00:11<00:44, 177.33it/s] 20%|██████████▏                                         | 1906/9733 [00:11<00:43, 178.30it/s] 20%|██████████▎                                         | 1924/9733 [00:11<00:43, 178.77it/s] 20%|██████████▍                                         | 1943/9733 [00:11<00:43, 179.43it/s] 20%|██████████▍                                         | 1961/9733 [00:11<00:43, 179.02it/s] 20%|██████████▌                                         | 1980/9733 [00:11<00:43, 179.52it/s] 21%|██████████▋                                         | 1999/9733 [00:11<00:43, 179.69it/s] 21%|██████████▊                                         | 2018/9733 [00:11<00:43, 178.42it/s] 21%|██████████▉                                         | 2037/9733 [00:12<00:42, 179.10it/s] 21%|██████████▉                                         | 2056/9733 [00:12<00:42, 179.54it/s] 21%|███████████                                         | 2075/9733 [00:12<00:42, 179.81it/s] 22%|███████████▏                                        | 2094/9733 [00:12<00:42, 180.13it/s] 22%|███████████▎                                        | 2113/9733 [00:12<00:42, 180.70it/s] 22%|███████████▍                                        | 2132/9733 [00:12<00:42, 180.60it/s] 22%|███████████▍                                        | 2151/9733 [00:12<00:42, 180.37it/s] 22%|███████████▌                                        | 2170/9733 [00:12<00:41, 180.37it/s] 22%|███████████▋                                        | 2189/9733 [00:12<00:41, 180.54it/s] 23%|███████████▊                                        | 2208/9733 [00:12<00:41, 180.81it/s] 23%|███████████▉                                        | 2227/9733 [00:13<00:41, 180.83it/s] 23%|███████████▉                                        | 2246/9733 [00:13<00:41, 178.94it/s] 23%|████████████                                        | 2265/9733 [00:13<00:41, 179.34it/s] 23%|████████████▏                                       | 2284/9733 [00:13<00:41, 179.71it/s] 24%|████████████▎                                       | 2303/9733 [00:13<00:41, 179.93it/s] 24%|████████████▍                                       | 2322/9733 [00:13<00:41, 180.08it/s] 24%|████████████▌                                       | 2341/9733 [00:13<00:40, 180.42it/s] 24%|████████████▌                                       | 2360/9733 [00:13<00:40, 180.72it/s] 24%|████████████▋                                       | 2379/9733 [00:13<00:40, 180.87it/s] 25%|████████████▊                                       | 2398/9733 [00:14<00:40, 180.97it/s] 25%|████████████▉                                       | 2417/9733 [00:14<00:40, 181.16it/s] 25%|█████████████                                       | 2436/9733 [00:14<00:40, 181.12it/s] 25%|█████████████                                       | 2455/9733 [00:14<00:40, 181.08it/s] 25%|█████████████▏                                      | 2474/9733 [00:14<00:40, 179.34it/s] 26%|█████████████▎                                      | 2493/9733 [00:14<00:40, 179.89it/s] 26%|█████████████▍                                      | 2512/9733 [00:14<00:40, 180.21it/s] 26%|█████████████▌                                      | 2531/9733 [00:14<00:40, 180.00it/s] 26%|█████████████▌                                      | 2550/9733 [00:14<00:39, 179.93it/s] 26%|█████████████▋                                      | 2569/9733 [00:14<00:39, 180.21it/s] 27%|█████████████▊                                      | 2588/9733 [00:15<00:39, 180.21it/s] 27%|█████████████▉                                      | 2607/9733 [00:15<00:39, 180.18it/s] 27%|██████████████                                      | 2626/9733 [00:15<00:39, 180.34it/s] 27%|██████████████▏                                     | 2645/9733 [00:15<00:39, 180.57it/s] 27%|██████████████▏                                     | 2664/9733 [00:15<00:39, 180.64it/s] 28%|██████████████▎                                     | 2683/9733 [00:15<00:39, 180.68it/s] 28%|██████████████▍                                     | 2702/9733 [00:15<00:39, 179.17it/s] 28%|██████████████▌                                     | 2721/9733 [00:15<00:39, 179.62it/s] 28%|██████████████▋                                     | 2740/9733 [00:15<00:38, 179.77it/s] 28%|██████████████▋                                     | 2758/9733 [00:16<00:38, 179.67it/s] 29%|██████████████▊                                     | 2776/9733 [00:16<00:38, 179.63it/s] 29%|██████████████▉                                     | 2794/9733 [00:16<00:38, 179.59it/s] 29%|███████████████                                     | 2812/9733 [00:16<00:38, 179.67it/s] 29%|███████████████▏                                    | 2831/9733 [00:16<00:38, 179.90it/s] 29%|███████████████▏                                    | 2849/9733 [00:16<00:38, 179.92it/s] 29%|███████████████▎                                    | 2867/9733 [00:16<00:38, 179.25it/s] 30%|███████████████▍                                    | 2886/9733 [00:16<00:38, 179.52it/s] 30%|███████████████▌                                    | 2904/9733 [00:16<00:38, 179.61it/s] 30%|███████████████▌                                    | 2922/9733 [00:16<00:37, 179.53it/s] 30%|███████████████▋                                    | 2940/9733 [00:17<00:38, 178.09it/s] 30%|███████████████▊                                    | 2959/9733 [00:17<00:37, 178.80it/s] 31%|███████████████▉                                    | 2978/9733 [00:17<00:37, 179.46it/s] 31%|████████████████                                    | 2996/9733 [00:17<00:37, 179.37it/s] 31%|████████████████                                    | 3014/9733 [00:17<00:37, 178.40it/s] 31%|████████████████▏                                   | 3033/9733 [00:17<00:37, 178.90it/s] 31%|████████████████▎                                   | 3051/9733 [00:17<00:37, 179.15it/s] 32%|████████████████▍                                   | 3069/9733 [00:17<00:37, 179.13it/s] 32%|████████████████▍                                   | 3088/9733 [00:17<00:37, 179.59it/s] 32%|████████████████▌                                   | 3107/9733 [00:17<00:36, 179.89it/s] 32%|████████████████▋                                   | 3126/9733 [00:18<00:36, 179.98it/s] 32%|████████████████▊                                   | 3144/9733 [00:18<00:36, 179.76it/s] 32%|████████████████▉                                   | 3162/9733 [00:18<00:37, 177.01it/s] 33%|████████████████▉                                   | 3181/9733 [00:18<00:36, 177.99it/s] 33%|█████████████████                                   | 3200/9733 [00:18<00:36, 178.66it/s] 33%|█████████████████▏                                  | 3218/9733 [00:18<00:36, 179.04it/s] 33%|█████████████████▎                                  | 3237/9733 [00:18<00:36, 179.68it/s] 33%|█████████████████▍                                  | 3256/9733 [00:18<00:35, 180.22it/s] 34%|█████████████████▍                                  | 3275/9733 [00:18<00:35, 180.48it/s] 34%|█████████████████▌                                  | 3294/9733 [00:19<00:35, 180.69it/s] 34%|█████████████████▋                                  | 3313/9733 [00:19<00:35, 180.79it/s] 34%|█████████████████▊                                  | 3332/9733 [00:19<00:35, 180.56it/s] 34%|█████████████████▉                                  | 3351/9733 [00:19<00:35, 180.44it/s] 35%|██████████████████                                  | 3370/9733 [00:19<00:35, 180.39it/s] 35%|██████████████████                                  | 3389/9733 [00:19<00:35, 178.56it/s] 35%|██████████████████▏                                 | 3407/9733 [00:19<00:35, 178.58it/s] 35%|██████████████████▎                                 | 3425/9733 [00:19<00:35, 178.85it/s] 35%|██████████████████▍                                 | 3443/9733 [00:19<00:35, 179.07it/s] 36%|██████████████████▍                                 | 3461/9733 [00:19<00:35, 177.84it/s] 36%|██████████████████▌                                 | 3479/9733 [00:20<00:35, 178.20it/s] 36%|██████████████████▋                                 | 3497/9733 [00:20<00:34, 178.42it/s] 36%|██████████████████▊                                 | 3515/9733 [00:20<00:34, 178.83it/s] 36%|██████████████████▉                                 | 3534/9733 [00:20<00:34, 179.30it/s] 37%|██████████████████▉                                 | 3553/9733 [00:20<00:34, 179.77it/s] 37%|███████████████████                                 | 3572/9733 [00:20<00:34, 179.87it/s] 37%|███████████████████▏                                | 3591/9733 [00:20<00:34, 179.99it/s] 37%|███████████████████▎                                | 3609/9733 [00:20<00:34, 178.50it/s] 37%|███████████████████▍                                | 3627/9733 [00:20<00:34, 178.81it/s] 37%|███████████████████▍                                | 3646/9733 [00:20<00:33, 179.21it/s] 38%|███████████████████▌                                | 3664/9733 [00:21<00:33, 179.26it/s] 38%|███████████████████▋                                | 3683/9733 [00:21<00:33, 179.69it/s] 38%|███████████████████▊                                | 3702/9733 [00:21<00:33, 180.12it/s] 38%|███████████████████▉                                | 3721/9733 [00:21<00:33, 180.23it/s] 38%|███████████████████▉                                | 3740/9733 [00:21<00:33, 180.43it/s] 39%|████████████████████                                | 3759/9733 [00:21<00:33, 180.13it/s] 39%|████████████████████▏                               | 3778/9733 [00:21<00:33, 178.50it/s] 39%|████████████████████▎                               | 3796/9733 [00:21<00:33, 178.86it/s] 39%|████████████████████▍                               | 3814/9733 [00:21<00:33, 179.02it/s] 39%|████████████████████▍                               | 3832/9733 [00:22<00:32, 179.04it/s] 40%|████████████████████▌                               | 3850/9733 [00:22<00:33, 177.55it/s] 40%|████████████████████▋                               | 3868/9733 [00:22<00:32, 177.98it/s] 40%|████████████████████▊                               | 3886/9733 [00:22<00:32, 178.27it/s] 40%|████████████████████▊                               | 3904/9733 [00:22<00:32, 178.28it/s] 40%|████████████████████▉                               | 3922/9733 [00:22<00:32, 177.87it/s] 40%|█████████████████████                               | 3940/9733 [00:22<00:32, 178.01it/s] 41%|█████████████████████▏                              | 3958/9733 [00:22<00:32, 177.58it/s] 41%|█████████████████████▏                              | 3976/9733 [00:22<00:32, 177.45it/s] 41%|█████████████████████▎                              | 3994/9733 [00:22<00:32, 177.66it/s] 41%|█████████████████████▍                              | 4012/9733 [00:23<00:32, 178.02it/s] 41%|█████████████████████▌                              | 4030/9733 [00:23<00:31, 178.28it/s] 42%|█████████████████████▋                              | 4048/9733 [00:23<00:31, 178.50it/s] 42%|█████████████████████▋                              | 4066/9733 [00:23<00:31, 177.12it/s] 42%|█████████████████████▊                              | 4084/9733 [00:23<00:32, 176.52it/s] 42%|█████████████████████▉                              | 4102/9733 [00:23<00:31, 177.05it/s] 42%|██████████████████████                              | 4120/9733 [00:23<00:31, 177.85it/s] 43%|██████████████████████                              | 4139/9733 [00:23<00:31, 178.59it/s] 43%|██████████████████████▏                             | 4157/9733 [00:23<00:31, 178.90it/s] 43%|██████████████████████▎                             | 4176/9733 [00:23<00:30, 179.31it/s] 43%|██████████████████████▍                             | 4194/9733 [00:24<00:30, 179.46it/s] 43%|██████████████████████▌                             | 4213/9733 [00:24<00:30, 179.71it/s] 43%|██████████████████████▌                             | 4231/9733 [00:24<00:30, 179.68it/s] 44%|██████████████████████▋                             | 4249/9733 [00:24<00:30, 179.58it/s] 44%|██████████████████████▊                             | 4267/9733 [00:24<00:30, 179.40it/s] 44%|██████████████████████▉                             | 4285/9733 [00:24<00:30, 179.43it/s] 44%|██████████████████████▉                             | 4303/9733 [00:24<00:30, 177.26it/s] 44%|███████████████████████                             | 4321/9733 [00:24<00:30, 177.18it/s] 45%|███████████████████████▏                            | 4339/9733 [00:24<00:30, 177.14it/s] 45%|███████████████████████▎                            | 4357/9733 [00:24<00:30, 176.93it/s] 45%|███████████████████████▎                            | 4375/9733 [00:25<00:30, 175.77it/s] 45%|███████████████████████▍                            | 4393/9733 [00:25<00:30, 176.46it/s] 45%|███████████████████████▌                            | 4411/9733 [00:25<00:30, 177.36it/s] 46%|███████████████████████▋                            | 4429/9733 [00:25<00:29, 177.67it/s] 46%|███████████████████████▊                            | 4448/9733 [00:25<00:29, 178.73it/s] 46%|███████████████████████▊                            | 4467/9733 [00:25<00:29, 179.45it/s] 46%|███████████████████████▉                            | 4486/9733 [00:25<00:29, 179.94it/s] 46%|████████████████████████                            | 4505/9733 [00:25<00:29, 180.16it/s] 46%|████████████████████████▏                           | 4524/9733 [00:25<00:34, 150.80it/s] 47%|████████████████████████▎                           | 4543/9733 [00:26<00:32, 158.91it/s] 47%|████████████████████████▎                           | 4562/9733 [00:26<00:31, 164.97it/s] 47%|████████████████████████▍                           | 4581/9733 [00:26<00:30, 169.56it/s] 47%|████████████████████████▌                           | 4600/9733 [00:26<00:29, 172.92it/s] 47%|████████████████████████▋                           | 4619/9733 [00:26<00:29, 175.25it/s] 48%|████████████████████████▊                           | 4638/9733 [00:26<00:28, 176.95it/s] 48%|████████████████████████▉                           | 4657/9733 [00:26<00:28, 178.12it/s] 48%|████████████████████████▉                           | 4675/9733 [00:26<00:28, 178.65it/s] 48%|█████████████████████████                           | 4694/9733 [00:26<00:28, 179.30it/s] 48%|█████████████████████████▏                          | 4713/9733 [00:27<00:27, 179.70it/s] 49%|█████████████████████████▎                          | 4732/9733 [00:27<00:27, 179.90it/s] 49%|█████████████████████████▍                          | 4751/9733 [00:27<00:39, 125.73it/s] 49%|█████████████████████████▍                          | 4770/9733 [00:27<00:35, 138.30it/s] 49%|█████████████████████████▌                          | 4788/9733 [00:27<00:33, 148.19it/s] 49%|█████████████████████████▋                          | 4807/9733 [00:27<00:31, 156.65it/s] 50%|█████████████████████████▊                          | 4825/9733 [00:27<00:30, 162.67it/s] 50%|█████████████████████████▉                          | 4844/9733 [00:27<00:29, 167.64it/s] 50%|█████████████████████████▉                          | 4863/9733 [00:28<00:28, 171.29it/s] 50%|██████████████████████████                          | 4882/9733 [00:28<00:27, 174.04it/s] 50%|██████████████████████████▏                         | 4900/9733 [00:28<00:27, 175.60it/s] 51%|██████████████████████████▎                         | 4919/9733 [00:28<00:27, 177.08it/s] 51%|██████████████████████████▍                         | 4938/9733 [00:28<00:26, 178.14it/s] 51%|██████████████████████████▍                         | 4956/9733 [00:28<00:26, 177.29it/s] 51%|██████████████████████████▌                         | 4975/9733 [00:28<00:26, 178.30it/s] 51%|██████████████████████████▋                         | 4994/9733 [00:28<00:26, 178.89it/s] 52%|██████████████████████████▊                         | 5013/9733 [00:28<00:26, 179.45it/s] 52%|██████████████████████████▉                         | 5032/9733 [00:28<00:26, 179.97it/s] 52%|██████████████████████████▉                         | 5051/9733 [00:29<00:25, 180.13it/s] 52%|███████████████████████████                         | 5070/9733 [00:29<00:25, 180.27it/s] 52%|███████████████████████████▏                        | 5089/9733 [00:29<00:25, 180.25it/s] 52%|███████████████████████████▎                        | 5108/9733 [00:29<00:25, 180.55it/s] 53%|███████████████████████████▍                        | 5127/9733 [00:29<00:25, 180.75it/s] 53%|███████████████████████████▍                        | 5146/9733 [00:29<00:25, 180.94it/s] 53%|███████████████████████████▌                        | 5165/9733 [00:29<00:25, 180.87it/s] 53%|███████████████████████████▋                        | 5184/9733 [00:29<00:25, 179.17it/s] 53%|███████████████████████████▊                        | 5203/9733 [00:29<00:25, 179.75it/s] 54%|███████████████████████████▉                        | 5222/9733 [00:29<00:25, 179.92it/s] 54%|███████████████████████████▉                        | 5240/9733 [00:30<00:24, 179.86it/s] 54%|████████████████████████████                        | 5258/9733 [00:30<00:25, 177.86it/s] 54%|████████████████████████████▏                       | 5276/9733 [00:30<00:24, 178.43it/s] 54%|████████████████████████████▎                       | 5294/9733 [00:30<00:24, 178.89it/s] 55%|████████████████████████████▍                       | 5313/9733 [00:30<00:24, 179.46it/s] 55%|████████████████████████████▍                       | 5332/9733 [00:30<00:24, 179.70it/s] 55%|████████████████████████████▌                       | 5350/9733 [00:30<00:24, 179.77it/s] 55%|████████████████████████████▋                       | 5369/9733 [00:30<00:24, 179.90it/s] 55%|████████████████████████████▊                       | 5387/9733 [00:30<00:24, 179.85it/s] 56%|████████████████████████████▉                       | 5405/9733 [00:31<00:24, 178.16it/s] 56%|████████████████████████████▉                       | 5423/9733 [00:31<00:24, 178.65it/s] 56%|█████████████████████████████                       | 5442/9733 [00:31<00:23, 179.20it/s] 56%|█████████████████████████████▏                      | 5461/9733 [00:31<00:23, 179.47it/s] 56%|█████████████████████████████▎                      | 5480/9733 [00:31<00:23, 180.35it/s] 56%|█████████████████████████████▍                      | 5499/9733 [00:31<00:23, 181.54it/s] 57%|█████████████████████████████▍                      | 5518/9733 [00:31<00:23, 182.47it/s] 57%|█████████████████████████████▌                      | 5537/9733 [00:31<00:22, 183.14it/s] 57%|█████████████████████████████▋                      | 5556/9733 [00:31<00:22, 183.85it/s] 57%|█████████████████████████████▊                      | 5575/9733 [00:31<00:22, 184.11it/s] 57%|█████████████████████████████▉                      | 5594/9733 [00:32<00:22, 184.13it/s] 58%|█████████████████████████████▉                      | 5613/9733 [00:32<00:22, 184.18it/s] 58%|██████████████████████████████                      | 5632/9733 [00:32<00:22, 182.72it/s] 58%|██████████████████████████████▏                     | 5651/9733 [00:32<00:22, 182.53it/s] 58%|██████████████████████████████▎                     | 5670/9733 [00:32<00:22, 183.28it/s] 58%|██████████████████████████████▍                     | 5689/9733 [00:32<00:22, 183.67it/s] 59%|██████████████████████████████▍                     | 5708/9733 [00:32<00:21, 183.90it/s] 59%|██████████████████████████████▌                     | 5727/9733 [00:32<00:21, 184.27it/s] 59%|██████████████████████████████▋                     | 5746/9733 [00:32<00:21, 184.41it/s] 59%|██████████████████████████████▊                     | 5765/9733 [00:32<00:21, 184.32it/s] 59%|██████████████████████████████▉                     | 5784/9733 [00:33<00:21, 184.48it/s] 60%|███████████████████████████████                     | 5803/9733 [00:33<00:21, 184.57it/s] 60%|███████████████████████████████                     | 5822/9733 [00:33<00:21, 184.60it/s] 60%|███████████████████████████████▏                    | 5841/9733 [00:33<00:21, 184.57it/s] 60%|███████████████████████████████▎                    | 5860/9733 [00:33<00:21, 182.88it/s] 60%|███████████████████████████████▍                    | 5879/9733 [00:33<00:21, 183.29it/s] 61%|███████████████████████████████▌                    | 5898/9733 [00:33<00:20, 183.72it/s] 61%|███████████████████████████████▌                    | 5917/9733 [00:33<00:20, 183.84it/s] 61%|███████████████████████████████▋                    | 5936/9733 [00:33<00:20, 184.14it/s] 61%|███████████████████████████████▊                    | 5955/9733 [00:34<00:20, 184.17it/s] 61%|███████████████████████████████▉                    | 5974/9733 [00:34<00:20, 184.34it/s] 62%|████████████████████████████████                    | 5993/9733 [00:34<00:20, 183.95it/s] 62%|████████████████████████████████                    | 6012/9733 [00:34<00:20, 183.74it/s] 62%|████████████████████████████████▏                   | 6031/9733 [00:34<00:20, 183.49it/s] 62%|████████████████████████████████▎                   | 6050/9733 [00:34<00:20, 183.43it/s] 62%|████████████████████████████████▍                   | 6069/9733 [00:34<00:20, 183.01it/s] 63%|████████████████████████████████▌                   | 6088/9733 [00:34<00:20, 181.08it/s] 63%|████████████████████████████████▋                   | 6107/9733 [00:34<00:19, 181.66it/s] 63%|████████████████████████████████▋                   | 6126/9733 [00:34<00:19, 181.82it/s] 63%|████████████████████████████████▊                   | 6145/9733 [00:35<00:19, 181.93it/s] 63%|████████████████████████████████▉                   | 6164/9733 [00:35<00:19, 182.07it/s] 64%|█████████████████████████████████                   | 6183/9733 [00:35<00:19, 182.03it/s] 64%|█████████████████████████████████▏                  | 6202/9733 [00:35<00:19, 181.98it/s] 64%|█████████████████████████████████▏                  | 6221/9733 [00:35<00:19, 181.83it/s] 64%|█████████████████████████████████▎                  | 6240/9733 [00:35<00:19, 181.40it/s] 64%|█████████████████████████████████▍                  | 6259/9733 [00:35<00:19, 181.34it/s] 65%|█████████████████████████████████▌                  | 6278/9733 [00:35<00:19, 181.59it/s] 65%|█████████████████████████████████▋                  | 6297/9733 [00:35<00:18, 181.74it/s] 65%|█████████████████████████████████▋                  | 6316/9733 [00:36<00:18, 180.20it/s] 65%|█████████████████████████████████▊                  | 6335/9733 [00:36<00:18, 180.86it/s] 65%|█████████████████████████████████▉                  | 6354/9733 [00:36<00:18, 181.15it/s] 65%|██████████████████████████████████                  | 6373/9733 [00:36<00:18, 181.47it/s] 66%|██████████████████████████████████▏                 | 6392/9733 [00:36<00:18, 181.81it/s] 66%|██████████████████████████████████▎                 | 6411/9733 [00:36<00:18, 181.83it/s] 66%|██████████████████████████████████▎                 | 6430/9733 [00:36<00:18, 181.89it/s] 66%|██████████████████████████████████▍                 | 6449/9733 [00:36<00:18, 181.94it/s] 66%|██████████████████████████████████▌                 | 6468/9733 [00:36<00:17, 181.56it/s] 67%|██████████████████████████████████▋                 | 6487/9733 [00:36<00:17, 181.93it/s] 67%|██████████████████████████████████▊                 | 6506/9733 [00:37<00:17, 181.88it/s] 67%|██████████████████████████████████▊                 | 6525/9733 [00:37<00:17, 181.70it/s] 67%|██████████████████████████████████▉                 | 6544/9733 [00:37<00:17, 180.29it/s] 67%|███████████████████████████████████                 | 6563/9733 [00:37<00:17, 180.82it/s] 68%|███████████████████████████████████▏                | 6582/9733 [00:37<00:17, 181.16it/s] 68%|███████████████████████████████████▎                | 6601/9733 [00:37<00:17, 181.29it/s] 68%|███████████████████████████████████▎                | 6620/9733 [00:37<00:17, 181.68it/s] 68%|███████████████████████████████████▍                | 6639/9733 [00:37<00:17, 181.93it/s] 68%|███████████████████████████████████▌                | 6658/9733 [00:37<00:16, 182.26it/s] 69%|███████████████████████████████████▋                | 6677/9733 [00:37<00:16, 182.17it/s] 69%|███████████████████████████████████▊                | 6696/9733 [00:38<00:16, 181.83it/s] 69%|███████████████████████████████████▉                | 6715/9733 [00:38<00:16, 182.11it/s] 69%|███████████████████████████████████▉                | 6734/9733 [00:38<00:16, 182.12it/s] 69%|████████████████████████████████████                | 6753/9733 [00:38<00:16, 182.26it/s] 70%|████████████████████████████████████▏               | 6772/9733 [00:38<00:16, 180.41it/s] 70%|████████████████████████████████████▎               | 6791/9733 [00:38<00:16, 181.02it/s] 70%|████████████████████████████████████▍               | 6810/9733 [00:38<00:16, 181.57it/s] 70%|████████████████████████████████████▍               | 6829/9733 [00:38<00:15, 181.75it/s] 70%|████████████████████████████████████▌               | 6848/9733 [00:38<00:15, 181.85it/s] 71%|████████████████████████████████████▋               | 6867/9733 [00:39<00:15, 181.89it/s] 71%|████████████████████████████████████▊               | 6886/9733 [00:39<00:15, 181.90it/s] 71%|████████████████████████████████████▉               | 6905/9733 [00:39<00:15, 182.07it/s] 71%|████████████████████████████████████▉               | 6924/9733 [00:39<00:15, 182.12it/s] 71%|█████████████████████████████████████               | 6943/9733 [00:39<00:15, 182.26it/s] 72%|█████████████████████████████████████▏              | 6962/9733 [00:39<00:15, 182.37it/s] 72%|█████████████████████████████████████▎              | 6981/9733 [00:39<00:15, 182.37it/s] 72%|█████████████████████████████████████▍              | 7000/9733 [00:39<00:15, 180.69it/s] 72%|█████████████████████████████████████▌              | 7019/9733 [00:39<00:14, 181.00it/s] 72%|█████████████████████████████████████▌              | 7038/9733 [00:39<00:14, 181.30it/s] 73%|█████████████████████████████████████▋              | 7057/9733 [00:40<00:14, 181.61it/s] 73%|█████████████████████████████████████▊              | 7076/9733 [00:40<00:14, 181.81it/s] 73%|█████████████████████████████████████▉              | 7095/9733 [00:40<00:14, 181.61it/s] 73%|██████████████████████████████████████              | 7114/9733 [00:40<00:14, 181.94it/s] 73%|██████████████████████████████████████              | 7133/9733 [00:40<00:14, 182.13it/s] 73%|██████████████████████████████████████▏             | 7152/9733 [00:40<00:14, 182.28it/s] 74%|██████████████████████████████████████▎             | 7171/9733 [00:40<00:14, 182.35it/s] 74%|██████████████████████████████████████▍             | 7190/9733 [00:40<00:13, 182.32it/s] 74%|██████████████████████████████████████▌             | 7209/9733 [00:40<00:13, 182.08it/s] 74%|██████████████████████████████████████▌             | 7228/9733 [00:41<00:13, 180.27it/s] 74%|██████████████████████████████████████▋             | 7247/9733 [00:41<00:13, 180.82it/s] 75%|██████████████████████████████████████▊             | 7266/9733 [00:41<00:13, 181.13it/s] 75%|██████████████████████████████████████▉             | 7285/9733 [00:41<00:13, 181.56it/s] 75%|███████████████████████████████████████             | 7304/9733 [00:41<00:13, 181.84it/s] 75%|███████████████████████████████████████             | 7323/9733 [00:41<00:13, 182.05it/s] 75%|███████████████████████████████████████▏            | 7342/9733 [00:41<00:13, 182.17it/s] 76%|███████████████████████████████████████▎            | 7361/9733 [00:41<00:13, 182.04it/s] 76%|███████████████████████████████████████▍            | 7380/9733 [00:41<00:12, 182.23it/s] 76%|███████████████████████████████████████▌            | 7399/9733 [00:41<00:12, 182.33it/s] 76%|███████████████████████████████████████▋            | 7418/9733 [00:42<00:12, 182.16it/s] 76%|███████████████████████████████████████▋            | 7437/9733 [00:42<00:12, 181.93it/s] 77%|███████████████████████████████████████▊            | 7456/9733 [00:42<00:13, 163.89it/s] 77%|███████████████████████████████████████▉            | 7475/9733 [00:42<00:13, 168.78it/s] 77%|████████████████████████████████████████            | 7494/9733 [00:42<00:12, 172.50it/s] 77%|████████████████████████████████████████▏           | 7513/9733 [00:42<00:12, 175.11it/s] 77%|████████████████████████████████████████▏           | 7532/9733 [00:42<00:12, 177.17it/s] 78%|████████████████████████████████████████▎           | 7551/9733 [00:42<00:12, 178.77it/s] 78%|████████████████████████████████████████▍           | 7570/9733 [00:42<00:12, 179.81it/s] 78%|████████████████████████████████████████▌           | 7589/9733 [00:43<00:11, 180.50it/s] 78%|████████████████████████████████████████▋           | 7608/9733 [00:43<00:11, 181.23it/s] 78%|████████████████████████████████████████▋           | 7627/9733 [00:43<00:11, 181.68it/s] 79%|████████████████████████████████████████▊           | 7646/9733 [00:43<00:11, 181.68it/s] 79%|████████████████████████████████████████▉           | 7665/9733 [00:43<00:11, 181.42it/s] 79%|█████████████████████████████████████████           | 7684/9733 [00:43<00:11, 179.22it/s] 79%|█████████████████████████████████████████▏          | 7703/9733 [00:43<00:11, 180.14it/s] 79%|█████████████████████████████████████████▎          | 7722/9733 [00:43<00:11, 180.83it/s] 80%|█████████████████████████████████████████▎          | 7741/9733 [00:43<00:10, 181.37it/s] 80%|█████████████████████████████████████████▍          | 7760/9733 [00:43<00:10, 181.65it/s] 80%|█████████████████████████████████████████▌          | 7779/9733 [00:44<00:10, 181.91it/s] 80%|█████████████████████████████████████████▋          | 7798/9733 [00:44<00:10, 181.90it/s] 80%|█████████████████████████████████████████▊          | 7817/9733 [00:44<00:10, 181.99it/s] 81%|█████████████████████████████████████████▊          | 7836/9733 [00:44<00:10, 182.20it/s] 81%|█████████████████████████████████████████▉          | 7855/9733 [00:44<00:10, 182.09it/s] 81%|██████████████████████████████████████████          | 7874/9733 [00:44<00:10, 181.57it/s] 81%|██████████████████████████████████████████▏         | 7893/9733 [00:44<00:10, 181.68it/s] 81%|██████████████████████████████████████████▎         | 7912/9733 [00:44<00:10, 180.22it/s] 81%|██████████████████████████████████████████▎         | 7931/9733 [00:44<00:09, 180.67it/s] 82%|██████████████████████████████████████████▍         | 7950/9733 [00:45<00:09, 181.08it/s] 82%|██████████████████████████████████████████▌         | 7969/9733 [00:45<00:09, 181.46it/s] 82%|██████████████████████████████████████████▋         | 7988/9733 [00:45<00:09, 181.75it/s] 82%|██████████████████████████████████████████▊         | 8007/9733 [00:45<00:09, 181.79it/s] 82%|██████████████████████████████████████████▉         | 8026/9733 [00:45<00:09, 181.75it/s] 83%|██████████████████████████████████████████▉         | 8045/9733 [00:45<00:09, 181.71it/s] 83%|███████████████████████████████████████████         | 8064/9733 [00:45<00:09, 181.73it/s] 83%|███████████████████████████████████████████▏        | 8083/9733 [00:45<00:09, 181.75it/s] 83%|███████████████████████████████████████████▎        | 8102/9733 [00:45<00:08, 181.85it/s] 83%|███████████████████████████████████████████▍        | 8121/9733 [00:45<00:08, 182.04it/s] 84%|███████████████████████████████████████████▍        | 8140/9733 [00:46<00:08, 180.38it/s] 84%|███████████████████████████████████████████▌        | 8159/9733 [00:46<00:08, 180.94it/s] 84%|███████████████████████████████████████████▋        | 8178/9733 [00:46<00:08, 181.21it/s] 84%|███████████████████████████████████████████▊        | 8197/9733 [00:46<00:08, 181.39it/s] 84%|███████████████████████████████████████████▉        | 8216/9733 [00:46<00:08, 181.66it/s] 85%|███████████████████████████████████████████▉        | 8235/9733 [00:46<00:08, 181.91it/s] 85%|████████████████████████████████████████████        | 8254/9733 [00:46<00:08, 181.89it/s] 85%|████████████████████████████████████████████▏       | 8273/9733 [00:46<00:08, 181.92it/s] 85%|████████████████████████████████████████████▎       | 8292/9733 [00:46<00:07, 181.82it/s] 85%|████████████████████████████████████████████▍       | 8311/9733 [00:47<00:07, 181.94it/s] 86%|████████████████████████████████████████████▌       | 8330/9733 [00:47<00:07, 181.98it/s] 86%|████████████████████████████████████████████▌       | 8349/9733 [00:47<00:07, 181.90it/s] 86%|████████████████████████████████████████████▋       | 8368/9733 [00:47<00:07, 180.46it/s] 86%|████████████████████████████████████████████▊       | 8387/9733 [00:47<00:07, 180.65it/s] 86%|████████████████████████████████████████████▉       | 8406/9733 [00:47<00:07, 181.17it/s] 87%|█████████████████████████████████████████████       | 8425/9733 [00:47<00:07, 181.60it/s] 87%|█████████████████████████████████████████████       | 8444/9733 [00:47<00:07, 181.84it/s] 87%|█████████████████████████████████████████████▏      | 8463/9733 [00:47<00:07, 181.24it/s] 87%|█████████████████████████████████████████████▎      | 8482/9733 [00:47<00:06, 180.94it/s] 87%|█████████████████████████████████████████████▍      | 8501/9733 [00:48<00:06, 181.20it/s] 88%|█████████████████████████████████████████████▌      | 8520/9733 [00:48<00:06, 181.27it/s] 88%|█████████████████████████████████████████████▌      | 8539/9733 [00:48<00:06, 181.49it/s] 88%|█████████████████████████████████████████████▋      | 8558/9733 [00:48<00:06, 181.34it/s] 88%|█████████████████████████████████████████████▊      | 8577/9733 [00:48<00:06, 180.03it/s] 88%|█████████████████████████████████████████████▉      | 8596/9733 [00:48<00:06, 180.64it/s] 89%|██████████████████████████████████████████████      | 8615/9733 [00:48<00:06, 181.06it/s] 89%|██████████████████████████████████████████████▏     | 8634/9733 [00:48<00:06, 181.50it/s] 89%|██████████████████████████████████████████████▏     | 8653/9733 [00:48<00:05, 181.63it/s] 89%|██████████████████████████████████████████████▎     | 8672/9733 [00:49<00:05, 181.50it/s] 89%|██████████████████████████████████████████████▍     | 8691/9733 [00:49<00:05, 181.59it/s] 89%|██████████████████████████████████████████████▌     | 8710/9733 [00:49<00:05, 181.77it/s] 90%|██████████████████████████████████████████████▋     | 8729/9733 [00:49<00:05, 181.75it/s] 90%|██████████████████████████████████████████████▋     | 8748/9733 [00:49<00:05, 181.73it/s] 90%|██████████████████████████████████████████████▊     | 8767/9733 [00:49<00:05, 181.89it/s] 90%|██████████████████████████████████████████████▉     | 8786/9733 [00:49<00:05, 181.83it/s] 90%|███████████████████████████████████████████████     | 8805/9733 [00:49<00:05, 180.33it/s] 91%|███████████████████████████████████████████████▏    | 8824/9733 [00:49<00:05, 180.93it/s] 91%|███████████████████████████████████████████████▏    | 8843/9733 [00:49<00:04, 180.90it/s] 91%|███████████████████████████████████████████████▎    | 8862/9733 [00:50<00:04, 179.83it/s] 91%|███████████████████████████████████████████████▍    | 8881/9733 [00:50<00:04, 180.58it/s] 91%|███████████████████████████████████████████████▌    | 8900/9733 [00:50<00:04, 181.04it/s] 92%|███████████████████████████████████████████████▋    | 8919/9733 [00:50<00:04, 181.44it/s] 92%|███████████████████████████████████████████████▊    | 8938/9733 [00:50<00:04, 181.74it/s] 92%|███████████████████████████████████████████████▊    | 8957/9733 [00:50<00:04, 181.65it/s] 92%|███████████████████████████████████████████████▉    | 8976/9733 [00:50<00:04, 181.71it/s] 92%|████████████████████████████████████████████████    | 8995/9733 [00:50<00:04, 181.75it/s] 93%|████████████████████████████████████████████████▏   | 9014/9733 [00:50<00:03, 181.91it/s] 93%|████████████████████████████████████████████████▎   | 9033/9733 [00:51<00:03, 180.39it/s] 93%|████████████████████████████████████████████████▎   | 9052/9733 [00:51<00:03, 180.96it/s] 93%|████████████████████████████████████████████████▍   | 9071/9733 [00:51<00:03, 180.66it/s] 93%|████████████████████████████████████████████████▌   | 9090/9733 [00:51<00:03, 180.70it/s] 94%|████████████████████████████████████████████████▋   | 9109/9733 [00:51<00:03, 181.13it/s] 94%|████████████████████████████████████████████████▊   | 9128/9733 [00:51<00:03, 181.41it/s] 94%|████████████████████████████████████████████████▊   | 9147/9733 [00:51<00:03, 181.65it/s] 94%|████████████████████████████████████████████████▉   | 9166/9733 [00:51<00:03, 181.93it/s] 94%|█████████████████████████████████████████████████   | 9185/9733 [00:51<00:03, 181.99it/s] 95%|█████████████████████████████████████████████████▏  | 9204/9733 [00:51<00:02, 182.05it/s] 95%|█████████████████████████████████████████████████▎  | 9223/9733 [00:52<00:02, 182.14it/s] 95%|█████████████████████████████████████████████████▍  | 9242/9733 [00:52<00:02, 182.10it/s] 95%|█████████████████████████████████████████████████▍  | 9261/9733 [00:52<00:02, 177.18it/s] 95%|█████████████████████████████████████████████████▌  | 9280/9733 [00:52<00:02, 178.55it/s] 96%|█████████████████████████████████████████████████▋  | 9299/9733 [00:52<00:02, 179.53it/s] 96%|█████████████████████████████████████████████████▊  | 9318/9733 [00:52<00:02, 180.36it/s] 96%|█████████████████████████████████████████████████▉  | 9337/9733 [00:52<00:02, 181.04it/s] 96%|█████████████████████████████████████████████████▉  | 9356/9733 [00:52<00:02, 181.42it/s] 96%|██████████████████████████████████████████████████  | 9375/9733 [00:52<00:01, 181.67it/s] 97%|██████████████████████████████████████████████████▏ | 9394/9733 [00:53<00:01, 181.81it/s] 97%|██████████████████████████████████████████████████▎ | 9413/9733 [00:53<00:01, 181.88it/s] 97%|██████████████████████████████████████████████████▍ | 9432/9733 [00:53<00:01, 181.91it/s] 97%|██████████████████████████████████████████████████▍ | 9451/9733 [00:53<00:01, 180.67it/s] 97%|██████████████████████████████████████████████████▌ | 9470/9733 [00:53<00:01, 181.16it/s] 97%|██████████████████████████████████████████████████▋ | 9489/9733 [00:53<00:01, 180.03it/s] 98%|██████████████████████████████████████████████████▊ | 9508/9733 [00:53<00:01, 180.78it/s] 98%|██████████████████████████████████████████████████▉ | 9527/9733 [00:53<00:01, 181.32it/s] 98%|███████████████████████████████████████████████████ | 9546/9733 [00:53<00:01, 181.47it/s] 98%|███████████████████████████████████████████████████ | 9565/9733 [00:53<00:00, 181.73it/s] 98%|███████████████████████████████████████████████████▏| 9584/9733 [00:54<00:00, 181.58it/s] 99%|███████████████████████████████████████████████████▎| 9603/9733 [00:54<00:00, 181.74it/s] 99%|███████████████████████████████████████████████████▍| 9622/9733 [00:54<00:00, 181.93it/s] 99%|███████████████████████████████████████████████████▌| 9641/9733 [00:54<00:00, 182.03it/s] 99%|███████████████████████████████████████████████████▌| 9660/9733 [00:54<00:00, 180.88it/s] 99%|███████████████████████████████████████████████████▋| 9679/9733 [00:54<00:00, 181.22it/s]100%|███████████████████████████████████████████████████▊| 9698/9733 [00:54<00:00, 181.31it/s]100%|███████████████████████████████████████████████████▉| 9717/9733 [00:54<00:00, 179.91it/s]100%|████████████████████████████████████████████████████| 9733/9733 [00:54<00:00, 177.37it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.01s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:04<00:09,  4.95s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.28s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:11,  5.56s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.02s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:09<00:04,  4.95s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.24s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.40s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.46s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.61s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.41s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.56s/it]
[2023-08-22 02:09:02,615] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.67s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.83s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.75s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.94s/it]
[2023-08-22 02:09:13,628] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-22 02:09:13,629] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-22 02:09:13,629] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-22 02:09:13,629] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-22 02:09:13,629] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-22 02:09:13,629] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-22 02:09:13,630] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-22 02:09:13,630] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-22 02:09:13,630] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-22 02:09:13,630] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-22 02:09:13,630] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-22 02:09:13,630] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f4d20476dc0>
[2023-08-22 02:09:13,630] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-22 02:09:13,630] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-22 02:09:13,630] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-22 02:09:13,630] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-22 02:09:13,630] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-22 02:09:13,630] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-22 02:09:13,630] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-22 02:09:13,630] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-22 02:09:13,630] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-22 02:09:13,630] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-22 02:09:13,630] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-22 02:09:13,630] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-22 02:09:13,630] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-22 02:09:13,630] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-22 02:09:13,630] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-22 02:09:13,630] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-22 02:09:13,630] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-22 02:09:13,630] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-22 02:09:13,630] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-22 02:09:13,630] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-22 02:09:13,630] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-22 02:09:13,630] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-22 02:09:13,630] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-22 02:09:13,630] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-22 02:09:13,630] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-22 02:09:13,630] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-22 02:09:13,630] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-22 02:09:13,630] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-22 02:09:13,630] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-22 02:09:13,630] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-22 02:09:13,630] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-22 02:09:13,630] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-22 02:09:13,630] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f4cebdca280>
[2023-08-22 02:09:13,630] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-22 02:09:13,630] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-22 02:09:13,630] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-22 02:09:13,631] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-22 02:09:13,631] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-22 02:09:13,631] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-22 02:09:13,631] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-22 02:09:13,631] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-22 02:09:13,631] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-22 02:09:13,631] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-22 02:09:13,631] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-22 02:09:13,631] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-22 02:09:13,631] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-22 02:09:13,631] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-22 02:09:13,631] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-22 02:09:13,631] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-22 02:09:13,631] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-22 02:09:13,631] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-22 02:09:13,631] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-22 02:09:13,631] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-22 02:09:13,631] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-22 02:09:13,631] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-22 02:09:13,631] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.591787576675415 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
Loading extension module utils...
### Instruction:Answer the following multiple choice question.

Input: Fabric is cut to order at what type of seller? Choices:  A: curtains B: tailor shop C: clothing store D: sewing room E: hardware store
Output: 1. The question asks where fabric is cut to order.
2. Cutting fabric to order means taking a specific measurement and then cutting the fabric according to the customer's requirement.
3. Looking at the given options, a tailor shop is the only place that deals with the custom cutting of fabric to fit a specific clothing design or customer's specifications.
4. Although curtains, clothing stores, sewing rooms, and hardware stores may have some relation to fabric, none of them uniquely involve the specified action of cutting fabric to order.
5. Therefore, the answer is B: tailor shop.
So the final answer is B: tailor shop

Input: Where are you if your reading magazines while waiting for a vehicle on rails? Choices:  A: vegetables B: market C: doctor D: train station E: bookstore
Output: 1. The question is essentially a scenario which asks for your location based on your activity.
2. The activity is "reading magazines while waiting for a vehicle on rails".
3. A "vehicle on rails" implies modes of transportation that moves on tracks such as trains, trams or subways. 
4. Out of the provided options; vegetables, market, doctor, train station, and bookstore, the place where one can wait for a vehicle on rails is the 'train station'. 
5. Therefore, if you're reading magazines while waiting for a train, the most probable place you can be is at a train station.
6. Hence, the answer is D: train station.
So the final answer is D: train station

Input: What would need oil to be used? Choices:  A: ground B: human  body C: repair shop D: combustion engines E: service station
Output: Step 1: Consider each option in relation to the practical use of oil.
Step 2: Oil is not typically used in association with ground (option A), so we can eliminate this option.
Step 3: While some oils are used for human body (option B) in terms of massage and skincare, the term "oil" in this context typically refers to a type of fuel or lubricant, which would not apply to the human body. So, we can eliminate this option.
Step 4: A repair shop (option C) might use oil as part of repairs on certain equipment or vehicles, but the shop itself doesn't need oil to operate. It further relies on a wide range of tools and materials other than oil. Therefore, we can eliminate this option.
Step 5: Combustion engines (option D) do indeed require oil for lubrication and cooling to operate effectively. This makes this a strong potential answer.
Step 6: A service station (option E) might sell oil, but the station itself does not require oil to function. The service station relies on many resources including electricity, water among others for its operation, and is not dependent on oil alone. Therefore, this option can be eliminated.
Step 7: Upon evaluating all options, combustion engines (option D) are the only choice that require oil as a necessary component to their function. Hence, the answer is D: combustion engines.
So the final answer is D: combustion engines

Input: What is person probably feeling that plans on stopping being married to their spouse? Choices:  A: detachment B: bankruptcy C: sad D: fights E: wrong
Output: 1. The question entails understanding the emotional state of a person who is contemplating ending their marriage.
2. The choices provided are: detachment, bankruptcy, sad, fights, and wrong. It's necessary to eliminate options which are not emotions, like "bankruptcy" and "fights".
3. "Wrong" is a feeling in some circumstances but in this context, it doesn't seem to fit as well as the remaining options, "detachment" and "sad".
4. While "sad" is indeed an emotion that could be associated with this situation, the act of deciding to end a marriage often comes with a feeling of emotional distance or disconnection from one's spouse, which is essentially what "detachment" means.
5. Therefore, the person is probably feeling "detachment", as they are planning to distance themselves from their spouse by divorcing them.
So the final answer is A: detachment

Input: What could you use to store a clock? Choices:  A: shelf B: own bedroom C: desk D: wall E: car
Output: 1. The question asks where you could place or store a clock.
2. The clue here is that we are looking for a place where you can place objects, and ideally such that the object could be viewed or used easily. 
3. Looking at the choices, all of them could realistically serve as a place to store a clock, but some options may not be suitable for all types of clocks.
4. "Own bedroom" is a broad term - it doesn't specify where in the bedroom one could place a clock. Therefore, this option is rather vague in this context.
5. "Car" could be a possible answer if one thinks of small, portable clocks. However, it's not an ideal place to store a clock in general considering the movement and vibration.
6. Similarly, using a "desk" to store a clock is possible, but it might take up useful space where you might be working.
7. A "wall" is a common place to hang or mount a wall clock. But not all types of clocks, especially table clocks, can be placed on a wall.
8. This brings us to the "shelf". A shelf is usually a place where objects are kept for display or easy access. It's a place where pretty much any kind of clock, be it desk clock, a small wall clock, or a grandfather clock, could possibly be kept.
9. Therefore, considering the mentioned points, the best answer is option A: shelf.
So the final answer is A: shelf

Input: The person put on lotion, what did they want? Choices:  A: fresh smell B: good credit C: smooth skin D: fresh produce E: headache
Output: 1. Firstly, we have to identify the purpose of putting on lotion. 
2. Creams, lotions and moisturizers are skincare products usually used for hydrating skin and improving its texture.
3. So, the person putting on lotion might want a positive effect on their skin. 
4. Looking at the options, 'fresh smell' could be a possibility because some lotions have a fragrant smell. However, the primary reason people use lotion is not for its smell. 
5. 'Good credit' is irrelevant. Lotion can't affect personal finance or credit report.
6. 'Fresh produce' is also unrelated to the context.
7. 'Headache' has no relationship with lotion application.
8. Therefore, the only remaining and most plausible answer is C: smooth skin.
So the final answer is C: smooth skin

Input: They burned the record, they were trying to do what to history? Choices:  A: compact disc B: tape C: rewrite D: play music E: erase
Output: 1. The question emphasizes that a record was burned, thus, removing any content that was on it. 
2. This can be interpreted as an action to destroy or annihilate that particular piece of history the record holds since burning a record will result in its total destruction.
3. To understand the question better one needs to relate this action to the choices given which pertains to 'history'. 
4. Choices A: "compact disc", B: "tape", and D: "play music" are related to the physical act of dealing with a record or music and aren't particularly related to "history".
5. Choice C: "rewrite" typically means to write something again with changes or improvements. But in this context, the action given was the destruction of the record and not creating something new from it.
6. This leaves us with Choice E: "erase" because when you burn a record, you essentially erase its content or history.
7. Therefore, the answer is E: erase.
So the final answer is E: erase

Input: She sure didn't have a green thumb, every time she thought she was making grow something it would what? Choices:  A: growth B: flowering C: ground D: die E: plants
Output: 1. The problem indicates that "she" allegedly does not have a "green thumb", which is a phrase used to refer to someone who is good at growing plants.
2. It also refers that every time she tries to make something grow, the opposite happensTime to load utils op: 0.5046501159667969 seconds

############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i8-s10-rTrue
Loading extension module utils...
Time to load utils op: 0.5046901702880859 seconds
Loading extension module utils...
Time to load utils op: 0.6087713241577148 seconds
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:39<32:06, 39.32s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:17<31:07, 38.91s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [01:56<30:22, 38.77s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [02:35<29:40, 38.70s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [03:13<28:57, 38.62s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [03:52<28:18, 38.61s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [04:30<27:38, 38.57s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [05:09<26:59, 38.56s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [05:47<26:21, 38.57s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [06:26<25:42, 38.57s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [07:05<25:05, 38.60s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [07:43<24:26, 38.60s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [08:22<23:47, 38.58s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [09:00<23:09, 38.59s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [09:39<22:30, 38.58s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [10:17<21:52, 38.59s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [10:56<21:12, 38.57s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [11:35<20:33, 38.56s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [12:13<19:55, 38.56s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [12:52<19:16, 38.56s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [13:30<18:38, 38.57s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [14:09<17:59, 38.56s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [14:48<17:22, 38.60s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [15:26<16:43, 38.58s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [16:05<16:05, 38.62s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [16:43<15:26, 38.61s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [17:22<14:47, 38.57s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [18:01<14:09, 38.60s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [18:39<13:29, 38.56s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [19:17<12:50, 38.54s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [19:56<12:12, 38.54s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [20:35<11:33, 38.55s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [21:13<10:55, 38.56s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [21:52<10:16, 38.55s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [22:30<09:38, 38.56s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [23:09<08:59, 38.56s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [23:47<08:20, 38.53s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [24:26<07:42, 38.54s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [25:04<07:03, 38.53s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [25:43<06:25, 38.53s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [26:21<05:46, 38.53s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [27:00<05:08, 38.57s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [27:39<04:29, 38.56s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [28:17<03:51, 38.55s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [28:56<03:12, 38.52s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [29:34<02:34, 38.58s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [30:13<01:55, 38.60s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [30:52<01:17, 38.69s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [31:30<00:38, 38.65s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [32:09<00:00, 38.67s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [32:09<00:00, 38.59s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 0.753} | avg. gen lenth: 436.616
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i9-s10-rTrue --seed 10 --max-prompt-length 2048 --rationales --num-in-domain 9
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-22 02:41:39,468] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i9-s10-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 9
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i9-s10-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 10
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9732 [00:00<?, ?it/s]  0%|                                                       | 10/9732 [00:00<01:38, 98.90it/s]  0%|                                                       | 21/9732 [00:00<01:37, 99.67it/s]  0%|▏                                                      | 31/9732 [00:00<01:37, 99.61it/s]  0%|▏                                                      | 41/9732 [00:00<01:37, 99.73it/s]  1%|▎                                                      | 51/9732 [00:00<01:38, 98.09it/s]  1%|▎                                                      | 61/9732 [00:00<01:38, 98.67it/s]  1%|▍                                                      | 71/9732 [00:00<01:37, 99.10it/s]  1%|▍                                                      | 81/9732 [00:00<01:37, 99.27it/s]  1%|▌                                                      | 91/9732 [00:00<01:36, 99.46it/s]  1%|▌                                                     | 101/9732 [00:01<01:36, 99.58it/s]  1%|▌                                                     | 111/9732 [00:01<01:36, 99.54it/s]  1%|▋                                                     | 121/9732 [00:01<01:36, 99.55it/s]  1%|▋                                                     | 131/9732 [00:01<01:36, 99.62it/s]  1%|▊                                                     | 141/9732 [00:01<01:36, 99.62it/s]  2%|▊                                                     | 151/9732 [00:01<01:37, 98.28it/s]  2%|▉                                                     | 161/9732 [00:01<01:37, 98.65it/s]  2%|▉                                                     | 172/9732 [00:01<01:36, 99.04it/s]  2%|█                                                     | 182/9732 [00:01<01:36, 99.13it/s]  2%|█                                                     | 192/9732 [00:01<01:36, 99.17it/s]  2%|█                                                    | 206/9732 [00:02<01:27, 109.45it/s]  2%|█▏                                                   | 222/9732 [00:02<01:17, 122.51it/s]  2%|█▎                                                   | 238/9732 [00:02<01:12, 131.38it/s]  3%|█▍                                                   | 254/9732 [00:02<01:08, 137.55it/s]  3%|█▍                                                   | 270/9732 [00:02<01:06, 141.94it/s]  3%|█▌                                                   | 285/9732 [00:02<01:05, 144.13it/s]  3%|█▋                                                   | 301/9732 [00:02<01:04, 146.35it/s]  3%|█▋                                                   | 317/9732 [00:02<01:03, 148.09it/s]  3%|█▊                                                   | 333/9732 [00:02<01:02, 149.28it/s]  4%|█▉                                                   | 349/9732 [00:02<01:02, 150.20it/s]  4%|█▉                                                   | 365/9732 [00:03<01:02, 150.67it/s]  4%|██                                                   | 381/9732 [00:03<01:01, 151.35it/s]  4%|██▏                                                  | 397/9732 [00:03<01:01, 151.60it/s]  4%|██▏                                                  | 413/9732 [00:03<01:01, 151.73it/s]  4%|██▎                                                  | 429/9732 [00:03<01:01, 151.91it/s]  5%|██▍                                                  | 445/9732 [00:03<01:01, 150.55it/s]  5%|██▌                                                  | 461/9732 [00:03<01:01, 151.18it/s]  5%|██▌                                                  | 477/9732 [00:03<01:01, 151.60it/s]  5%|██▋                                                  | 493/9732 [00:03<01:00, 151.71it/s]  5%|██▊                                                  | 509/9732 [00:04<01:00, 151.75it/s]  5%|██▊                                                  | 525/9732 [00:04<01:00, 151.81it/s]  6%|██▉                                                  | 541/9732 [00:04<01:00, 151.68it/s]  6%|███                                                  | 557/9732 [00:04<01:00, 151.35it/s]  6%|███                                                  | 573/9732 [00:04<01:00, 151.09it/s]  6%|███▏                                                 | 589/9732 [00:04<01:00, 151.01it/s]  6%|███▎                                                 | 605/9732 [00:04<01:00, 150.90it/s]  6%|███▍                                                 | 621/9732 [00:04<01:00, 150.79it/s]  7%|███▍                                                 | 637/9732 [00:04<01:00, 150.72it/s]  7%|███▌                                                 | 653/9732 [00:04<01:00, 150.74it/s]  7%|███▋                                                 | 669/9732 [00:05<01:00, 149.39it/s]  7%|███▋                                                 | 685/9732 [00:05<01:00, 149.79it/s]  7%|███▊                                                 | 701/9732 [00:05<01:00, 149.99it/s]  7%|███▉                                                 | 717/9732 [00:05<01:00, 150.12it/s]  8%|███▉                                                 | 733/9732 [00:05<00:59, 150.37it/s]  8%|████                                                 | 749/9732 [00:05<00:59, 150.45it/s]  8%|████▏                                                | 765/9732 [00:05<00:59, 150.54it/s]  8%|████▎                                                | 781/9732 [00:05<00:59, 150.73it/s]  8%|████▎                                                | 797/9732 [00:05<00:59, 150.74it/s]  8%|████▍                                                | 813/9732 [00:06<00:59, 150.87it/s]  9%|████▌                                                | 829/9732 [00:06<00:59, 150.80it/s]  9%|████▌                                                | 845/9732 [00:06<00:59, 150.52it/s]  9%|████▋                                                | 861/9732 [00:06<00:58, 150.65it/s]  9%|████▊                                                | 877/9732 [00:06<00:58, 150.54it/s]  9%|████▊                                                | 893/9732 [00:06<00:59, 148.88it/s]  9%|████▉                                                | 909/9732 [00:06<00:59, 149.32it/s] 10%|█████                                                | 925/9732 [00:06<00:58, 149.80it/s] 10%|█████                                                | 941/9732 [00:06<00:58, 150.01it/s] 10%|█████▏                                               | 957/9732 [00:07<00:58, 150.15it/s] 10%|█████▎                                               | 973/9732 [00:07<00:58, 150.25it/s] 10%|█████▍                                               | 989/9732 [00:07<00:58, 150.53it/s] 10%|█████▎                                              | 1005/9732 [00:07<00:57, 150.61it/s] 10%|█████▍                                              | 1021/9732 [00:07<00:57, 150.66it/s] 11%|█████▌                                              | 1037/9732 [00:07<00:57, 150.84it/s] 11%|█████▋                                              | 1053/9732 [00:07<00:57, 150.87it/s] 11%|█████▋                                              | 1069/9732 [00:07<00:57, 150.17it/s] 11%|█████▊                                              | 1085/9732 [00:07<00:57, 150.34it/s] 11%|█████▉                                              | 1101/9732 [00:07<00:57, 150.39it/s] 11%|█████▉                                              | 1117/9732 [00:08<00:57, 148.91it/s] 12%|██████                                              | 1133/9732 [00:08<00:57, 149.29it/s] 12%|██████▏                                             | 1149/9732 [00:08<00:57, 149.65it/s] 12%|██████▏                                             | 1165/9732 [00:08<00:57, 149.81it/s] 12%|██████▎                                             | 1181/9732 [00:08<00:57, 150.00it/s] 12%|██████▍                                             | 1197/9732 [00:08<00:56, 150.15it/s] 12%|██████▍                                             | 1213/9732 [00:08<00:56, 150.17it/s] 13%|██████▌                                             | 1229/9732 [00:08<00:56, 150.26it/s] 13%|██████▋                                             | 1245/9732 [00:08<00:56, 150.28it/s] 13%|██████▋                                             | 1261/9732 [00:09<00:56, 148.96it/s] 13%|██████▊                                             | 1276/9732 [00:09<00:56, 149.17it/s] 13%|██████▉                                             | 1292/9732 [00:09<00:56, 149.52it/s] 13%|██████▉                                             | 1308/9732 [00:09<00:56, 149.84it/s] 14%|███████                                             | 1324/9732 [00:09<00:56, 149.96it/s] 14%|███████▏                                            | 1339/9732 [00:09<00:56, 148.66it/s] 14%|███████▏                                            | 1355/9732 [00:09<00:56, 149.24it/s] 14%|███████▎                                            | 1371/9732 [00:09<00:55, 149.49it/s] 14%|███████▍                                            | 1386/9732 [00:09<00:55, 149.52it/s] 14%|███████▍                                            | 1402/9732 [00:09<00:55, 149.73it/s] 15%|███████▌                                            | 1417/9732 [00:10<00:55, 149.67it/s] 15%|███████▋                                            | 1432/9732 [00:10<00:55, 149.62it/s] 15%|███████▋                                            | 1448/9732 [00:10<00:55, 149.78it/s] 15%|███████▊                                            | 1463/9732 [00:10<00:55, 148.42it/s] 15%|███████▉                                            | 1478/9732 [00:10<00:57, 144.06it/s] 15%|███████▉                                            | 1493/9732 [00:10<00:56, 145.72it/s] 15%|████████                                            | 1508/9732 [00:10<00:55, 146.87it/s] 16%|████████▏                                           | 1523/9732 [00:10<00:55, 147.77it/s] 16%|████████▏                                           | 1539/9732 [00:10<00:55, 148.64it/s] 16%|████████▎                                           | 1555/9732 [00:11<00:54, 149.35it/s] 16%|████████▍                                           | 1570/9732 [00:11<00:55, 148.19it/s] 16%|████████▍                                           | 1586/9732 [00:11<00:54, 148.74it/s] 16%|████████▌                                           | 1601/9732 [00:11<00:54, 149.00it/s] 17%|████████▋                                           | 1617/9732 [00:11<00:54, 149.33it/s] 17%|████████▋                                           | 1633/9732 [00:11<00:54, 149.62it/s] 17%|████████▊                                           | 1648/9732 [00:11<00:54, 149.69it/s] 17%|████████▉                                           | 1664/9732 [00:11<00:53, 149.93it/s] 17%|████████▉                                           | 1679/9732 [00:11<00:53, 149.94it/s] 17%|█████████                                           | 1694/9732 [00:11<00:53, 149.92it/s] 18%|█████████▏                                          | 1710/9732 [00:12<00:53, 150.02it/s] 18%|█████████▏                                          | 1726/9732 [00:12<00:53, 150.00it/s] 18%|█████████▎                                          | 1742/9732 [00:12<00:53, 150.01it/s] 18%|█████████▍                                          | 1758/9732 [00:12<00:53, 149.80it/s] 18%|█████████▍                                          | 1773/9732 [00:12<00:53, 149.75it/s] 18%|█████████▌                                          | 1788/9732 [00:12<00:53, 149.65it/s] 19%|█████████▋                                          | 1803/9732 [00:12<00:58, 136.18it/s] 19%|█████████▋                                          | 1818/9732 [00:12<00:56, 139.93it/s] 19%|█████████▊                                          | 1833/9732 [00:12<00:55, 142.74it/s] 19%|█████████▊                                          | 1848/9732 [00:13<00:54, 143.45it/s] 19%|█████████▉                                          | 1864/9732 [00:13<00:54, 145.49it/s] 19%|██████████                                          | 1880/9732 [00:13<00:53, 146.98it/s] 19%|██████████▏                                         | 1895/9732 [00:13<00:53, 147.80it/s] 20%|██████████▏                                         | 1910/9732 [00:13<00:52, 148.32it/s] 20%|██████████▎                                         | 1925/9732 [00:13<00:52, 148.69it/s] 20%|██████████▎                                         | 1940/9732 [00:13<00:52, 148.89it/s] 20%|██████████▍                                         | 1956/9732 [00:13<00:52, 149.27it/s] 20%|██████████▌                                         | 1971/9732 [00:13<00:51, 149.42it/s] 20%|██████████▌                                         | 1987/9732 [00:13<00:51, 149.69it/s] 21%|██████████▋                                         | 2003/9732 [00:14<00:51, 149.75it/s] 21%|██████████▊                                         | 2018/9732 [00:14<00:51, 148.49it/s] 21%|██████████▊                                         | 2033/9732 [00:14<00:52, 147.53it/s] 21%|██████████▉                                         | 2049/9732 [00:14<00:51, 148.36it/s] 21%|███████████                                         | 2064/9732 [00:14<00:51, 148.77it/s] 21%|███████████                                         | 2079/9732 [00:14<00:51, 148.90it/s] 22%|███████████▏                                        | 2094/9732 [00:14<00:51, 149.01it/s] 22%|███████████▎                                        | 2109/9732 [00:14<00:51, 149.21it/s] 22%|███████████▎                                        | 2124/9732 [00:14<00:50, 149.23it/s] 22%|███████████▍                                        | 2139/9732 [00:14<00:50, 149.42it/s] 22%|███████████▌                                        | 2154/9732 [00:15<00:50, 149.34it/s] 22%|███████████▌                                        | 2170/9732 [00:15<00:50, 149.58it/s] 22%|███████████▋                                        | 2185/9732 [00:15<00:50, 149.69it/s] 23%|███████████▊                                        | 2200/9732 [00:15<00:50, 149.64it/s] 23%|███████████▊                                        | 2215/9732 [00:15<00:50, 149.64it/s] 23%|███████████▉                                        | 2230/9732 [00:15<00:50, 148.46it/s] 23%|███████████▉                                        | 2245/9732 [00:15<00:50, 146.94it/s] 23%|████████████                                        | 2260/9732 [00:15<00:50, 147.76it/s] 23%|████████████▏                                       | 2275/9732 [00:15<00:50, 148.35it/s] 24%|████████████▏                                       | 2290/9732 [00:15<00:50, 148.74it/s] 24%|████████████▎                                       | 2306/9732 [00:16<00:49, 149.42it/s] 24%|████████████▍                                       | 2322/9732 [00:16<00:49, 149.83it/s] 24%|████████████▍                                       | 2338/9732 [00:16<00:49, 150.52it/s] 24%|████████████▌                                       | 2354/9732 [00:16<00:48, 150.91it/s] 24%|████████████▋                                       | 2370/9732 [00:16<00:48, 151.15it/s] 25%|████████████▋                                       | 2386/9732 [00:16<00:48, 151.27it/s] 25%|████████████▊                                       | 2402/9732 [00:16<00:48, 151.23it/s] 25%|████████████▉                                       | 2418/9732 [00:16<00:48, 151.34it/s] 25%|█████████████                                       | 2434/9732 [00:16<00:48, 151.49it/s] 25%|█████████████                                       | 2450/9732 [00:17<00:48, 151.48it/s] 25%|█████████████▏                                      | 2466/9732 [00:17<00:47, 151.43it/s] 26%|█████████████▎                                      | 2482/9732 [00:17<00:48, 149.70it/s] 26%|█████████████▎                                      | 2498/9732 [00:17<00:48, 150.20it/s] 26%|█████████████▍                                      | 2514/9732 [00:17<00:47, 150.62it/s] 26%|█████████████▌                                      | 2530/9732 [00:17<00:47, 150.77it/s] 26%|█████████████▌                                      | 2546/9732 [00:17<00:47, 150.87it/s] 26%|█████████████▋                                      | 2562/9732 [00:17<00:47, 151.09it/s] 26%|█████████████▊                                      | 2578/9732 [00:17<00:47, 151.23it/s] 27%|█████████████▊                                      | 2594/9732 [00:17<00:47, 151.35it/s] 27%|█████████████▉                                      | 2610/9732 [00:18<00:47, 151.29it/s] 27%|██████████████                                      | 2626/9732 [00:18<00:46, 151.30it/s] 27%|██████████████                                      | 2642/9732 [00:18<00:46, 151.34it/s] 27%|██████████████▏                                     | 2658/9732 [00:18<00:46, 151.36it/s] 27%|██████████████▎                                     | 2674/9732 [00:18<00:46, 151.35it/s] 28%|██████████████▎                                     | 2690/9732 [00:18<00:46, 151.11it/s] 28%|██████████████▍                                     | 2706/9732 [00:18<00:46, 149.56it/s] 28%|██████████████▌                                     | 2722/9732 [00:18<00:46, 149.91it/s] 28%|██████████████▋                                     | 2738/9732 [00:18<00:46, 150.17it/s] 28%|██████████████▋                                     | 2754/9732 [00:19<00:46, 150.40it/s] 28%|██████████████▊                                     | 2770/9732 [00:19<00:46, 150.56it/s] 29%|██████████████▉                                     | 2786/9732 [00:19<00:46, 150.59it/s] 29%|██████████████▉                                     | 2802/9732 [00:19<00:45, 150.79it/s] 29%|███████████████                                     | 2818/9732 [00:19<00:45, 150.82it/s] 29%|███████████████▏                                    | 2834/9732 [00:19<00:45, 151.08it/s] 29%|███████████████▏                                    | 2850/9732 [00:19<00:45, 151.23it/s] 29%|███████████████▎                                    | 2866/9732 [00:19<00:45, 151.35it/s] 30%|███████████████▍                                    | 2882/9732 [00:19<00:45, 151.27it/s] 30%|███████████████▍                                    | 2898/9732 [00:20<00:45, 151.23it/s] 30%|███████████████▌                                    | 2914/9732 [00:20<00:45, 151.41it/s] 30%|███████████████▋                                    | 2930/9732 [00:20<00:45, 150.02it/s] 30%|███████████████▋                                    | 2946/9732 [00:20<00:45, 150.46it/s] 30%|███████████████▊                                    | 2962/9732 [00:20<00:44, 150.73it/s] 31%|███████████████▉                                    | 2978/9732 [00:20<00:44, 151.04it/s] 31%|███████████████▉                                    | 2994/9732 [00:20<00:44, 151.10it/s] 31%|████████████████                                    | 3010/9732 [00:20<00:44, 151.35it/s] 31%|████████████████▏                                   | 3026/9732 [00:20<00:44, 151.37it/s] 31%|████████████████▎                                   | 3042/9732 [00:20<00:44, 151.62it/s] 31%|████████████████▎                                   | 3058/9732 [00:21<00:44, 151.49it/s] 32%|████████████████▍                                   | 3074/9732 [00:21<00:43, 151.57it/s] 32%|████████████████▌                                   | 3090/9732 [00:21<00:43, 151.47it/s] 32%|████████████████▌                                   | 3106/9732 [00:21<00:43, 151.39it/s] 32%|████████████████▋                                   | 3122/9732 [00:21<00:43, 151.36it/s] 32%|████████████████▊                                   | 3138/9732 [00:21<00:43, 151.30it/s] 32%|████████████████▊                                   | 3154/9732 [00:21<00:43, 149.77it/s] 33%|████████████████▉                                   | 3170/9732 [00:21<00:43, 150.22it/s] 33%|█████████████████                                   | 3186/9732 [00:21<00:43, 150.72it/s] 33%|█████████████████                                   | 3202/9732 [00:22<00:43, 150.97it/s] 33%|█████████████████▏                                  | 3218/9732 [00:22<00:43, 151.01it/s] 33%|█████████████████▎                                  | 3234/9732 [00:22<00:42, 151.17it/s] 33%|█████████████████▎                                  | 3250/9732 [00:22<00:42, 151.38it/s] 34%|█████████████████▍                                  | 3266/9732 [00:22<00:42, 151.15it/s] 34%|█████████████████▌                                  | 3282/9732 [00:22<00:42, 151.12it/s] 34%|█████████████████▌                                  | 3298/9732 [00:22<00:42, 151.22it/s] 34%|█████████████████▋                                  | 3314/9732 [00:22<00:42, 151.30it/s] 34%|█████████████████▊                                  | 3330/9732 [00:22<00:42, 151.10it/s] 34%|█████████████████▉                                  | 3346/9732 [00:22<00:42, 151.23it/s] 35%|█████████████████▉                                  | 3362/9732 [00:23<00:42, 151.23it/s] 35%|██████████████████                                  | 3378/9732 [00:23<00:41, 151.38it/s] 35%|██████████████████▏                                 | 3394/9732 [00:23<00:42, 149.95it/s] 35%|██████████████████▏                                 | 3410/9732 [00:23<00:42, 150.38it/s] 35%|██████████████████▎                                 | 3426/9732 [00:23<00:41, 150.68it/s] 35%|██████████████████▍                                 | 3442/9732 [00:23<00:41, 150.85it/s] 36%|██████████████████▍                                 | 3458/9732 [00:23<00:41, 150.99it/s] 36%|██████████████████▌                                 | 3474/9732 [00:23<00:41, 150.98it/s] 36%|██████████████████▋                                 | 3490/9732 [00:23<00:41, 150.96it/s] 36%|██████████████████▋                                 | 3506/9732 [00:24<00:41, 150.94it/s] 36%|██████████████████▊                                 | 3522/9732 [00:24<00:41, 150.86it/s] 36%|██████████████████▉                                 | 3538/9732 [00:24<00:41, 150.98it/s] 37%|██████████████████▉                                 | 3554/9732 [00:24<00:40, 151.04it/s] 37%|███████████████████                                 | 3570/9732 [00:24<00:40, 151.08it/s] 37%|███████████████████▏                                | 3586/9732 [00:24<00:40, 151.12it/s] 37%|███████████████████▏                                | 3602/9732 [00:24<00:40, 151.28it/s] 37%|███████████████████▎                                | 3618/9732 [00:24<00:40, 149.78it/s] 37%|███████████████████▍                                | 3634/9732 [00:24<00:40, 150.10it/s] 38%|███████████████████▌                                | 3650/9732 [00:24<00:40, 150.40it/s] 38%|███████████████████▌                                | 3666/9732 [00:25<00:40, 150.48it/s] 38%|███████████████████▋                                | 3682/9732 [00:25<00:40, 150.75it/s] 38%|███████████████████▊                                | 3698/9732 [00:25<00:39, 150.99it/s] 38%|███████████████████▊                                | 3714/9732 [00:25<00:39, 151.16it/s] 38%|███████████████████▉                                | 3730/9732 [00:25<00:39, 151.35it/s] 38%|████████████████████                                | 3746/9732 [00:25<00:39, 151.23it/s] 39%|████████████████████                                | 3762/9732 [00:25<00:39, 151.23it/s] 39%|████████████████████▏                               | 3778/9732 [00:25<00:39, 150.13it/s] 39%|████████████████████▎                               | 3794/9732 [00:25<00:39, 150.32it/s] 39%|████████████████████▎                               | 3810/9732 [00:26<00:39, 150.57it/s] 39%|████████████████████▍                               | 3826/9732 [00:26<00:39, 150.91it/s] 39%|████████████████████▌                               | 3842/9732 [00:26<00:39, 149.41it/s] 40%|████████████████████▌                               | 3858/9732 [00:26<00:39, 149.90it/s] 40%|████████████████████▋                               | 3874/9732 [00:26<00:39, 150.15it/s] 40%|████████████████████▊                               | 3890/9732 [00:26<00:38, 150.51it/s] 40%|████████████████████▊                               | 3906/9732 [00:26<00:38, 150.70it/s] 40%|████████████████████▉                               | 3922/9732 [00:26<00:38, 150.86it/s] 40%|█████████████████████                               | 3938/9732 [00:26<00:38, 150.83it/s] 41%|█████████████████████▏                              | 3954/9732 [00:27<00:38, 150.86it/s] 41%|█████████████████████▏                              | 3970/9732 [00:27<00:38, 150.90it/s] 41%|█████████████████████▎                              | 3986/9732 [00:27<00:38, 150.87it/s] 41%|█████████████████████▍                              | 4002/9732 [00:27<00:37, 151.07it/s] 41%|█████████████████████▍                              | 4018/9732 [00:27<00:37, 150.84it/s] 41%|█████████████████████▌                              | 4034/9732 [00:27<00:38, 149.68it/s] 42%|█████████████████████▋                              | 4050/9732 [00:27<00:37, 150.07it/s] 42%|█████████████████████▋                              | 4066/9732 [00:27<00:38, 149.05it/s] 42%|█████████████████████▊                              | 4082/9732 [00:27<00:37, 149.69it/s] 42%|█████████████████████▉                              | 4098/9732 [00:27<00:37, 150.09it/s] 42%|█████████████████████▉                              | 4114/9732 [00:28<00:37, 150.30it/s] 42%|██████████████████████                              | 4130/9732 [00:28<00:37, 150.57it/s] 43%|██████████████████████▏                             | 4146/9732 [00:28<00:37, 150.55it/s] 43%|██████████████████████▏                             | 4162/9732 [00:28<00:36, 150.69it/s] 43%|██████████████████████▎                             | 4178/9732 [00:28<00:36, 150.86it/s] 43%|██████████████████████▍                             | 4194/9732 [00:28<00:36, 150.73it/s] 43%|██████████████████████▍                             | 4210/9732 [00:28<00:36, 150.83it/s] 43%|██████████████████████▌                             | 4226/9732 [00:28<00:36, 150.88it/s] 44%|██████████████████████▋                             | 4242/9732 [00:28<00:36, 150.90it/s] 44%|██████████████████████▊                             | 4258/9732 [00:29<00:36, 150.88it/s] 44%|██████████████████████▊                             | 4274/9732 [00:29<00:36, 149.80it/s] 44%|██████████████████████▉                             | 4289/9732 [00:29<00:36, 148.84it/s] 44%|███████████████████████                             | 4305/9732 [00:29<00:36, 149.52it/s] 44%|███████████████████████                             | 4321/9732 [00:29<00:36, 150.12it/s] 45%|███████████████████████▏                            | 4337/9732 [00:29<00:35, 150.15it/s] 45%|███████████████████████▎                            | 4353/9732 [00:29<00:35, 149.64it/s] 45%|███████████████████████▎                            | 4369/9732 [00:29<00:35, 150.34it/s] 45%|███████████████████████▍                            | 4385/9732 [00:29<00:35, 150.56it/s] 45%|███████████████████████▌                            | 4401/9732 [00:29<00:35, 150.81it/s] 45%|███████████████████████▌                            | 4417/9732 [00:30<00:35, 150.93it/s] 46%|███████████████████████▋                            | 4433/9732 [00:30<00:35, 150.84it/s] 46%|███████████████████████▊                            | 4449/9732 [00:30<00:35, 150.93it/s] 46%|███████████████████████▊                            | 4465/9732 [00:30<00:34, 150.94it/s] 46%|███████████████████████▉                            | 4481/9732 [00:30<00:35, 149.93it/s] 46%|████████████████████████                            | 4497/9732 [00:30<00:34, 150.33it/s] 46%|████████████████████████                            | 4513/9732 [00:30<00:34, 150.45it/s] 47%|████████████████████████▏                           | 4529/9732 [00:30<00:40, 130.04it/s] 47%|████████████████████████▎                           | 4545/9732 [00:30<00:38, 135.80it/s] 47%|████████████████████████▎                           | 4561/9732 [00:31<00:36, 139.98it/s] 47%|████████████████████████▍                           | 4577/9732 [00:31<00:36, 143.09it/s] 47%|████████████████████████▌                           | 4593/9732 [00:31<00:35, 145.34it/s] 47%|████████████████████████▋                           | 4609/9732 [00:31<00:34, 147.09it/s] 48%|████████████████████████▋                           | 4625/9732 [00:31<00:34, 148.21it/s] 48%|████████████████████████▊                           | 4641/9732 [00:31<00:34, 149.16it/s] 48%|████████████████████████▉                           | 4657/9732 [00:31<00:33, 149.67it/s] 48%|████████████████████████▉                           | 4673/9732 [00:31<00:33, 150.16it/s] 48%|█████████████████████████                           | 4689/9732 [00:31<00:33, 150.72it/s] 48%|█████████████████████████▏                          | 4705/9732 [00:32<00:33, 150.87it/s] 49%|█████████████████████████▏                          | 4721/9732 [00:32<00:33, 150.97it/s] 49%|█████████████████████████▎                          | 4737/9732 [00:32<00:33, 150.98it/s] 49%|█████████████████████████▉                           | 4753/9732 [00:32<00:51, 96.97it/s] 49%|█████████████████████████▍                          | 4769/9732 [00:32<00:45, 108.58it/s] 49%|█████████████████████████▌                          | 4785/9732 [00:32<00:41, 118.56it/s] 49%|█████████████████████████▋                          | 4801/9732 [00:32<00:38, 126.67it/s] 49%|█████████████████████████▋                          | 4817/9732 [00:32<00:36, 133.08it/s] 50%|█████████████████████████▊                          | 4833/9732 [00:33<00:35, 137.89it/s] 50%|█████████████████████████▉                          | 4849/9732 [00:33<00:34, 141.36it/s] 50%|█████████████████████████▉                          | 4865/9732 [00:33<00:33, 143.97it/s] 50%|██████████████████████████                          | 4881/9732 [00:33<00:33, 145.98it/s] 50%|██████████████████████████▏                         | 4897/9732 [00:33<00:32, 147.55it/s] 50%|██████████████████████████▎                         | 4913/9732 [00:33<00:32, 148.43it/s] 51%|██████████████████████████▎                         | 4929/9732 [00:33<00:32, 149.15it/s] 51%|██████████████████████████▍                         | 4945/9732 [00:33<00:31, 149.67it/s] 51%|██████████████████████████▌                         | 4961/9732 [00:33<00:32, 148.84it/s] 51%|██████████████████████████▌                         | 4977/9732 [00:34<00:31, 149.46it/s] 51%|██████████████████████████▋                         | 4993/9732 [00:34<00:31, 149.87it/s] 51%|██████████████████████████▊                         | 5009/9732 [00:34<00:31, 148.88it/s] 52%|██████████████████████████▊                         | 5025/9732 [00:34<00:31, 149.54it/s] 52%|██████████████████████████▉                         | 5041/9732 [00:34<00:31, 150.03it/s] 52%|███████████████████████████                         | 5057/9732 [00:34<00:31, 150.46it/s] 52%|███████████████████████████                         | 5073/9732 [00:34<00:30, 150.59it/s] 52%|███████████████████████████▏                        | 5089/9732 [00:34<00:30, 150.72it/s] 52%|███████████████████████████▎                        | 5105/9732 [00:34<00:30, 150.87it/s] 53%|███████████████████████████▎                        | 5121/9732 [00:35<00:30, 150.83it/s] 53%|███████████████████████████▍                        | 5137/9732 [00:35<00:30, 150.68it/s] 53%|███████████████████████████▌                        | 5153/9732 [00:35<00:30, 150.95it/s] 53%|███████████████████████████▌                        | 5169/9732 [00:35<00:30, 151.08it/s] 53%|███████████████████████████▋                        | 5185/9732 [00:35<00:30, 149.62it/s] 53%|███████████████████████████▊                        | 5201/9732 [00:35<00:30, 150.10it/s] 54%|███████████████████████████▉                        | 5217/9732 [00:35<00:30, 150.31it/s] 54%|███████████████████████████▉                        | 5233/9732 [00:35<00:29, 150.58it/s] 54%|████████████████████████████                        | 5249/9732 [00:35<00:29, 150.74it/s] 54%|████████████████████████████▏                       | 5265/9732 [00:35<00:29, 149.73it/s] 54%|████████████████████████████▏                       | 5281/9732 [00:36<00:29, 150.12it/s] 54%|████████████████████████████▎                       | 5297/9732 [00:36<00:29, 150.41it/s] 55%|████████████████████████████▍                       | 5313/9732 [00:36<00:29, 150.58it/s] 55%|████████████████████████████▍                       | 5329/9732 [00:36<00:29, 150.73it/s] 55%|████████████████████████████▌                       | 5345/9732 [00:36<00:29, 150.71it/s] 55%|████████████████████████████▋                       | 5361/9732 [00:36<00:28, 150.79it/s] 55%|████████████████████████████▋                       | 5377/9732 [00:36<00:28, 150.96it/s] 55%|████████████████████████████▊                       | 5393/9732 [00:36<00:28, 150.92it/s] 56%|████████████████████████████▉                       | 5409/9732 [00:36<00:28, 149.38it/s] 56%|████████████████████████████▉                       | 5425/9732 [00:37<00:28, 149.76it/s] 56%|█████████████████████████████                       | 5441/9732 [00:37<00:28, 150.26it/s] 56%|█████████████████████████████▏                      | 5457/9732 [00:37<00:28, 150.42it/s] 56%|█████████████████████████████▏                      | 5473/9732 [00:37<00:28, 150.80it/s] 56%|█████████████████████████████▎                      | 5489/9732 [00:37<00:27, 151.92it/s] 57%|█████████████████████████████▍                      | 5505/9732 [00:37<00:27, 152.70it/s] 57%|█████████████████████████████▍                      | 5521/9732 [00:37<00:27, 153.28it/s] 57%|█████████████████████████████▌                      | 5537/9732 [00:37<00:27, 153.67it/s] 57%|█████████████████████████████▋                      | 5553/9732 [00:37<00:27, 154.04it/s] 57%|█████████████████████████████▊                      | 5569/9732 [00:37<00:27, 153.33it/s] 57%|█████████████████████████████▊                      | 5585/9732 [00:38<00:26, 153.61it/s] 58%|█████████████████████████████▉                      | 5601/9732 [00:38<00:26, 153.84it/s] 58%|██████████████████████████████                      | 5617/9732 [00:38<00:26, 154.17it/s] 58%|██████████████████████████████                      | 5633/9732 [00:38<00:26, 152.92it/s] 58%|██████████████████████████████▏                     | 5649/9732 [00:38<00:26, 153.36it/s] 58%|██████████████████████████████▎                     | 5665/9732 [00:38<00:26, 153.72it/s] 58%|██████████████████████████████▎                     | 5681/9732 [00:38<00:26, 153.94it/s] 59%|██████████████████████████████▍                     | 5697/9732 [00:38<00:26, 154.10it/s] 59%|██████████████████████████████▌                     | 5713/9732 [00:38<00:26, 154.32it/s] 59%|██████████████████████████████▌                     | 5729/9732 [00:39<00:25, 154.50it/s] 59%|██████████████████████████████▋                     | 5745/9732 [00:39<00:25, 154.52it/s] 59%|██████████████████████████████▊                     | 5761/9732 [00:39<00:25, 154.53it/s] 59%|██████████████████████████████▊                     | 5777/9732 [00:39<00:25, 154.55it/s] 60%|██████████████████████████████▉                     | 5793/9732 [00:39<00:25, 154.61it/s] 60%|███████████████████████████████                     | 5809/9732 [00:39<00:25, 154.61it/s] 60%|███████████████████████████████                     | 5825/9732 [00:39<00:25, 154.43it/s] 60%|███████████████████████████████▏                    | 5841/9732 [00:39<00:25, 154.35it/s] 60%|███████████████████████████████▎                    | 5857/9732 [00:39<00:25, 152.93it/s] 60%|███████████████████████████████▍                    | 5873/9732 [00:39<00:25, 153.45it/s] 61%|███████████████████████████████▍                    | 5889/9732 [00:40<00:25, 153.46it/s] 61%|███████████████████████████████▌                    | 5905/9732 [00:40<00:24, 153.81it/s] 61%|███████████████████████████████▋                    | 5921/9732 [00:40<00:24, 154.00it/s] 61%|███████████████████████████████▋                    | 5937/9732 [00:40<00:24, 154.18it/s] 61%|███████████████████████████████▊                    | 5953/9732 [00:40<00:24, 154.28it/s] 61%|███████████████████████████████▉                    | 5969/9732 [00:40<00:24, 154.39it/s] 61%|███████████████████████████████▉                    | 5985/9732 [00:40<00:24, 154.44it/s] 62%|████████████████████████████████                    | 6001/9732 [00:40<00:24, 154.43it/s] 62%|████████████████████████████████▏                   | 6017/9732 [00:40<00:24, 154.50it/s] 62%|████████████████████████████████▏                   | 6033/9732 [00:40<00:23, 154.56it/s] 62%|████████████████████████████████▎                   | 6049/9732 [00:41<00:23, 154.57it/s] 62%|████████████████████████████████▍                   | 6065/9732 [00:41<00:23, 154.56it/s] 62%|████████████████████████████████▍                   | 6081/9732 [00:41<00:23, 152.96it/s] 63%|████████████████████████████████▌                   | 6097/9732 [00:41<00:23, 153.24it/s] 63%|████████████████████████████████▋                   | 6113/9732 [00:41<00:23, 153.61it/s] 63%|████████████████████████████████▋                   | 6129/9732 [00:41<00:23, 153.75it/s] 63%|████████████████████████████████▊                   | 6145/9732 [00:41<00:23, 153.92it/s] 63%|████████████████████████████████▉                   | 6161/9732 [00:41<00:23, 154.11it/s] 63%|█████████████████████████████████                   | 6177/9732 [00:41<00:23, 154.26it/s] 64%|█████████████████████████████████                   | 6193/9732 [00:42<00:22, 154.36it/s] 64%|█████████████████████████████████▏                  | 6209/9732 [00:42<00:22, 154.12it/s] 64%|█████████████████████████████████▎                  | 6225/9732 [00:42<00:22, 154.10it/s] 64%|█████████████████████████████████▎                  | 6241/9732 [00:42<00:22, 154.01it/s] 64%|█████████████████████████████████▍                  | 6257/9732 [00:42<00:22, 154.03it/s] 64%|█████████████████████████████████▌                  | 6273/9732 [00:42<00:22, 154.17it/s] 65%|█████████████████████████████████▌                  | 6289/9732 [00:42<00:22, 154.31it/s] 65%|█████████████████████████████████▋                  | 6305/9732 [00:42<00:22, 154.27it/s] 65%|█████████████████████████████████▊                  | 6321/9732 [00:42<00:22, 152.95it/s] 65%|█████████████████████████████████▊                  | 6337/9732 [00:42<00:22, 153.47it/s] 65%|█████████████████████████████████▉                  | 6353/9732 [00:43<00:21, 153.66it/s] 65%|██████████████████████████████████                  | 6369/9732 [00:43<00:21, 153.98it/s] 66%|██████████████████████████████████                  | 6385/9732 [00:43<00:21, 154.07it/s] 66%|██████████████████████████████████▏                 | 6401/9732 [00:43<00:21, 154.15it/s] 66%|██████████████████████████████████▎                 | 6417/9732 [00:43<00:21, 154.21it/s] 66%|██████████████████████████████████▎                 | 6433/9732 [00:43<00:21, 154.14it/s] 66%|██████████████████████████████████▍                 | 6449/9732 [00:43<00:21, 154.11it/s] 66%|██████████████████████████████████▌                 | 6465/9732 [00:43<00:21, 154.03it/s] 67%|██████████████████████████████████▋                 | 6481/9732 [00:43<00:21, 154.14it/s] 67%|██████████████████████████████████▋                 | 6497/9732 [00:43<00:20, 154.20it/s] 67%|██████████████████████████████████▊                 | 6513/9732 [00:44<00:20, 153.83it/s] 67%|██████████████████████████████████▉                 | 6529/9732 [00:44<00:20, 153.94it/s] 67%|██████████████████████████████████▉                 | 6545/9732 [00:44<00:20, 152.74it/s] 67%|███████████████████████████████████                 | 6561/9732 [00:44<00:20, 153.14it/s] 68%|███████████████████████████████████▏                | 6577/9732 [00:44<00:20, 153.50it/s] 68%|███████████████████████████████████▏                | 6593/9732 [00:44<00:20, 153.65it/s] 68%|███████████████████████████████████▎                | 6609/9732 [00:44<00:20, 153.88it/s] 68%|███████████████████████████████████▍                | 6625/9732 [00:44<00:20, 154.10it/s] 68%|███████████████████████████████████▍                | 6641/9732 [00:44<00:20, 154.23it/s] 68%|███████████████████████████████████▌                | 6657/9732 [00:45<00:19, 154.31it/s] 69%|███████████████████████████████████▋                | 6673/9732 [00:45<00:19, 154.34it/s] 69%|███████████████████████████████████▋                | 6689/9732 [00:45<00:19, 154.25it/s] 69%|███████████████████████████████████▊                | 6705/9732 [00:45<00:19, 154.29it/s] 69%|███████████████████████████████████▉                | 6721/9732 [00:45<00:19, 154.38it/s] 69%|███████████████████████████████████▉                | 6737/9732 [00:45<00:19, 154.44it/s] 69%|████████████████████████████████████                | 6753/9732 [00:45<00:19, 154.49it/s] 70%|████████████████████████████████████▏               | 6769/9732 [00:45<00:19, 153.11it/s] 70%|████████████████████████████████████▎               | 6785/9732 [00:45<00:19, 153.57it/s] 70%|████████████████████████████████████▎               | 6801/9732 [00:45<00:19, 153.80it/s] 70%|████████████████████████████████████▍               | 6817/9732 [00:46<00:18, 153.98it/s] 70%|████████████████████████████████████▌               | 6833/9732 [00:46<00:18, 153.99it/s] 70%|████████████████████████████████████▌               | 6849/9732 [00:46<00:18, 154.10it/s] 71%|████████████████████████████████████▋               | 6865/9732 [00:46<00:18, 154.20it/s] 71%|████████████████████████████████████▊               | 6881/9732 [00:46<00:18, 154.30it/s] 71%|████████████████████████████████████▊               | 6897/9732 [00:46<00:18, 154.33it/s] 71%|████████████████████████████████████▉               | 6913/9732 [00:46<00:18, 154.17it/s] 71%|█████████████████████████████████████               | 6929/9732 [00:46<00:18, 154.22it/s] 71%|█████████████████████████████████████               | 6945/9732 [00:46<00:18, 154.36it/s] 72%|█████████████████████████████████████▏              | 6961/9732 [00:47<00:17, 154.34it/s] 72%|█████████████████████████████████████▎              | 6977/9732 [00:47<00:17, 154.26it/s] 72%|█████████████████████████████████████▎              | 6993/9732 [00:47<00:17, 152.88it/s] 72%|█████████████████████████████████████▍              | 7009/9732 [00:47<00:17, 153.20it/s] 72%|█████████████████████████████████████▌              | 7025/9732 [00:47<00:17, 153.62it/s] 72%|█████████████████████████████████████▌              | 7041/9732 [00:47<00:17, 153.91it/s] 73%|█████████████████████████████████████▋              | 7057/9732 [00:47<00:17, 154.13it/s] 73%|█████████████████████████████████████▊              | 7073/9732 [00:47<00:17, 154.25it/s] 73%|█████████████████████████████████████▉              | 7089/9732 [00:47<00:17, 154.32it/s] 73%|█████████████████████████████████████▉              | 7105/9732 [00:47<00:17, 154.43it/s] 73%|██████████████████████████████████████              | 7121/9732 [00:48<00:16, 154.42it/s] 73%|██████████████████████████████████████▏             | 7137/9732 [00:48<00:16, 154.30it/s] 73%|██████████████████████████████████████▏             | 7153/9732 [00:48<00:16, 154.35it/s] 74%|██████████████████████████████████████▎             | 7169/9732 [00:48<00:16, 154.27it/s] 74%|██████████████████████████████████████▍             | 7185/9732 [00:48<00:16, 154.27it/s] 74%|██████████████████████████████████████▍             | 7201/9732 [00:48<00:16, 154.17it/s] 74%|██████████████████████████████████████▌             | 7217/9732 [00:48<00:16, 152.71it/s] 74%|██████████████████████████████████████▋             | 7233/9732 [00:48<00:16, 153.14it/s] 74%|██████████████████████████████████████▋             | 7249/9732 [00:48<00:16, 153.42it/s] 75%|██████████████████████████████████████▊             | 7265/9732 [00:48<00:16, 153.70it/s] 75%|██████████████████████████████████████▉             | 7281/9732 [00:49<00:15, 153.90it/s] 75%|██████████████████████████████████████▉             | 7297/9732 [00:49<00:15, 154.04it/s] 75%|███████████████████████████████████████             | 7313/9732 [00:49<00:15, 154.08it/s] 75%|███████████████████████████████████████▏            | 7329/9732 [00:49<00:15, 154.18it/s] 75%|███████████████████████████████████████▏            | 7345/9732 [00:49<00:15, 154.23it/s] 76%|███████████████████████████████████████▎            | 7361/9732 [00:49<00:15, 154.31it/s] 76%|███████████████████████████████████████▍            | 7377/9732 [00:49<00:15, 154.38it/s] 76%|███████████████████████████████████████▌            | 7393/9732 [00:49<00:15, 154.39it/s] 76%|███████████████████████████████████████▌            | 7409/9732 [00:49<00:15, 154.15it/s] 76%|███████████████████████████████████████▋            | 7425/9732 [00:50<00:14, 154.20it/s] 76%|███████████████████████████████████████▊            | 7441/9732 [00:50<00:14, 154.05it/s] 77%|███████████████████████████████████████▊            | 7457/9732 [00:50<00:16, 137.57it/s] 77%|███████████████████████████████████████▉            | 7473/9732 [00:50<00:15, 142.10it/s] 77%|████████████████████████████████████████            | 7489/9732 [00:50<00:15, 145.52it/s] 77%|████████████████████████████████████████            | 7505/9732 [00:50<00:15, 147.89it/s] 77%|████████████████████████████████████████▏           | 7521/9732 [00:50<00:14, 149.71it/s] 77%|████████████████████████████████████████▎           | 7537/9732 [00:50<00:14, 151.04it/s] 78%|████████████████████████████████████████▎           | 7553/9732 [00:50<00:14, 152.02it/s] 78%|████████████████████████████████████████▍           | 7569/9732 [00:50<00:14, 152.75it/s] 78%|████████████████████████████████████████▌           | 7585/9732 [00:51<00:14, 153.10it/s] 78%|████████████████████████████████████████▌           | 7601/9732 [00:51<00:13, 153.51it/s] 78%|████████████████████████████████████████▋           | 7617/9732 [00:51<00:13, 153.76it/s] 78%|████████████████████████████████████████▊           | 7633/9732 [00:51<00:13, 153.82it/s] 79%|████████████████████████████████████████▊           | 7649/9732 [00:51<00:13, 153.87it/s] 79%|████████████████████████████████████████▉           | 7665/9732 [00:51<00:13, 153.96it/s] 79%|█████████████████████████████████████████           | 7681/9732 [00:51<00:13, 152.64it/s] 79%|█████████████████████████████████████████▏          | 7697/9732 [00:51<00:13, 153.04it/s] 79%|█████████████████████████████████████████▏          | 7713/9732 [00:51<00:13, 153.42it/s] 79%|█████████████████████████████████████████▎          | 7729/9732 [00:52<00:13, 153.74it/s] 80%|█████████████████████████████████████████▍          | 7745/9732 [00:52<00:12, 153.83it/s] 80%|█████████████████████████████████████████▍          | 7761/9732 [00:52<00:12, 153.75it/s] 80%|█████████████████████████████████████████▌          | 7777/9732 [00:52<00:12, 153.78it/s] 80%|█████████████████████████████████████████▋          | 7793/9732 [00:52<00:12, 153.91it/s] 80%|█████████████████████████████████████████▋          | 7809/9732 [00:52<00:12, 153.92it/s] 80%|█████████████████████████████████████████▊          | 7825/9732 [00:52<00:12, 154.06it/s] 81%|█████████████████████████████████████████▉          | 7841/9732 [00:52<00:12, 154.08it/s] 81%|█████████████████████████████████████████▉          | 7857/9732 [00:52<00:12, 154.07it/s] 81%|██████████████████████████████████████████          | 7873/9732 [00:52<00:12, 153.94it/s] 81%|██████████████████████████████████████████▏         | 7889/9732 [00:53<00:11, 154.01it/s] 81%|██████████████████████████████████████████▏         | 7905/9732 [00:53<00:11, 152.72it/s] 81%|██████████████████████████████████████████▎         | 7921/9732 [00:53<00:11, 153.08it/s] 82%|██████████████████████████████████████████▍         | 7937/9732 [00:53<00:11, 153.36it/s] 82%|██████████████████████████████████████████▍         | 7953/9732 [00:53<00:11, 153.60it/s] 82%|██████████████████████████████████████████▌         | 7969/9732 [00:53<00:11, 153.71it/s] 82%|██████████████████████████████████████████▋         | 7985/9732 [00:53<00:11, 153.83it/s] 82%|██████████████████████████████████████████▊         | 8001/9732 [00:53<00:11, 153.90it/s] 82%|██████████████████████████████████████████▊         | 8017/9732 [00:53<00:11, 154.06it/s] 83%|██████████████████████████████████████████▉         | 8033/9732 [00:54<00:11, 154.02it/s] 83%|███████████████████████████████████████████         | 8049/9732 [00:54<00:10, 153.87it/s] 83%|███████████████████████████████████████████         | 8065/9732 [00:54<00:10, 154.00it/s] 83%|███████████████████████████████████████████▏        | 8081/9732 [00:54<00:10, 153.80it/s] 83%|███████████████████████████████████████████▎        | 8097/9732 [00:54<00:10, 153.98it/s] 83%|███████████████████████████████████████████▎        | 8113/9732 [00:54<00:10, 154.11it/s] 84%|███████████████████████████████████████████▍        | 8129/9732 [00:54<00:10, 152.74it/s] 84%|███████████████████████████████████████████▌        | 8145/9732 [00:54<00:10, 153.28it/s] 84%|███████████████████████████████████████████▌        | 8161/9732 [00:54<00:10, 153.51it/s] 84%|███████████████████████████████████████████▋        | 8177/9732 [00:54<00:10, 153.67it/s] 84%|███████████████████████████████████████████▊        | 8193/9732 [00:55<00:10, 153.71it/s] 84%|███████████████████████████████████████████▊        | 8209/9732 [00:55<00:09, 153.75it/s] 85%|███████████████████████████████████████████▉        | 8225/9732 [00:55<00:09, 153.85it/s] 85%|████████████████████████████████████████████        | 8241/9732 [00:55<00:09, 153.99it/s] 85%|████████████████████████████████████████████        | 8257/9732 [00:55<00:09, 154.10it/s] 85%|████████████████████████████████████████████▏       | 8273/9732 [00:55<00:09, 154.13it/s] 85%|████████████████████████████████████████████▎       | 8289/9732 [00:55<00:09, 153.99it/s] 85%|████████████████████████████████████████████▍       | 8305/9732 [00:55<00:09, 154.07it/s] 86%|████████████████████████████████████████████▍       | 8321/9732 [00:55<00:09, 154.17it/s] 86%|████████████████████████████████████████████▌       | 8337/9732 [00:55<00:09, 154.05it/s] 86%|████████████████████████████████████████████▋       | 8353/9732 [00:56<00:09, 152.57it/s] 86%|████████████████████████████████████████████▋       | 8369/9732 [00:56<00:08, 153.05it/s] 86%|████████████████████████████████████████████▊       | 8385/9732 [00:56<00:08, 152.76it/s] 86%|████████████████████████████████████████████▉       | 8401/9732 [00:56<00:08, 153.10it/s] 86%|████████████████████████████████████████████▉       | 8417/9732 [00:56<00:08, 153.42it/s] 87%|█████████████████████████████████████████████       | 8433/9732 [00:56<00:08, 153.64it/s] 87%|█████████████████████████████████████████████▏      | 8449/9732 [00:56<00:08, 153.71it/s] 87%|█████████████████████████████████████████████▏      | 8465/9732 [00:56<00:08, 153.84it/s] 87%|█████████████████████████████████████████████▎      | 8481/9732 [00:56<00:08, 153.89it/s] 87%|█████████████████████████████████████████████▍      | 8497/9732 [00:57<00:08, 154.01it/s] 87%|█████████████████████████████████████████████▍      | 8513/9732 [00:57<00:07, 154.00it/s] 88%|█████████████████████████████████████████████▌      | 8529/9732 [00:57<00:07, 153.83it/s] 88%|█████████████████████████████████████████████▋      | 8545/9732 [00:57<00:07, 153.75it/s] 88%|█████████████████████████████████████████████▋      | 8561/9732 [00:57<00:07, 153.74it/s] 88%|█████████████████████████████████████████████▊      | 8577/9732 [00:57<00:07, 152.34it/s] 88%|█████████████████████████████████████████████▉      | 8593/9732 [00:57<00:07, 152.77it/s] 88%|█████████████████████████████████████████████▉      | 8609/9732 [00:57<00:07, 153.04it/s] 89%|██████████████████████████████████████████████      | 8625/9732 [00:57<00:07, 153.32it/s] 89%|██████████████████████████████████████████████▏     | 8641/9732 [00:57<00:07, 153.54it/s] 89%|██████████████████████████████████████████████▎     | 8657/9732 [00:58<00:06, 153.59it/s] 89%|██████████████████████████████████████████████▎     | 8673/9732 [00:58<00:06, 153.77it/s] 89%|██████████████████████████████████████████████▍     | 8689/9732 [00:58<00:06, 153.91it/s] 89%|██████████████████████████████████████████████▌     | 8705/9732 [00:58<00:06, 152.70it/s] 90%|██████████████████████████████████████████████▌     | 8721/9732 [00:58<00:06, 153.06it/s] 90%|██████████████████████████████████████████████▋     | 8737/9732 [00:58<00:06, 153.36it/s] 90%|██████████████████████████████████████████████▊     | 8753/9732 [00:58<00:06, 153.28it/s] 90%|██████████████████████████████████████████████▊     | 8769/9732 [00:58<00:06, 153.40it/s] 90%|██████████████████████████████████████████████▉     | 8785/9732 [00:58<00:06, 153.46it/s] 90%|███████████████████████████████████████████████     | 8801/9732 [00:59<00:06, 153.58it/s] 91%|███████████████████████████████████████████████     | 8817/9732 [00:59<00:06, 152.25it/s] 91%|███████████████████████████████████████████████▏    | 8833/9732 [00:59<00:05, 152.67it/s] 91%|███████████████████████████████████████████████▎    | 8849/9732 [00:59<00:05, 153.06it/s] 91%|███████████████████████████████████████████████▎    | 8865/9732 [00:59<00:05, 153.37it/s] 91%|███████████████████████████████████████████████▍    | 8881/9732 [00:59<00:05, 153.46it/s] 91%|███████████████████████████████████████████████▌    | 8897/9732 [00:59<00:05, 153.64it/s] 92%|███████████████████████████████████████████████▌    | 8913/9732 [00:59<00:05, 153.80it/s] 92%|███████████████████████████████████████████████▋    | 8929/9732 [00:59<00:05, 153.84it/s] 92%|███████████████████████████████████████████████▊    | 8945/9732 [00:59<00:05, 153.90it/s] 92%|███████████████████████████████████████████████▉    | 8961/9732 [01:00<00:05, 153.66it/s] 92%|███████████████████████████████████████████████▉    | 8977/9732 [01:00<00:04, 153.72it/s] 92%|████████████████████████████████████████████████    | 8993/9732 [01:00<00:04, 153.71it/s] 93%|████████████████████████████████████████████████▏   | 9009/9732 [01:00<00:04, 152.30it/s] 93%|████████████████████████████████████████████████▏   | 9025/9732 [01:00<00:04, 152.65it/s] 93%|████████████████████████████████████████████████▎   | 9041/9732 [01:00<00:04, 150.32it/s] 93%|████████████████████████████████████████████████▍   | 9057/9732 [01:00<00:04, 151.36it/s] 93%|████████████████████████████████████████████████▍   | 9073/9732 [01:00<00:04, 152.08it/s] 93%|████████████████████████████████████████████████▌   | 9089/9732 [01:00<00:04, 152.61it/s] 94%|████████████████████████████████████████████████▋   | 9105/9732 [01:01<00:04, 152.96it/s] 94%|████████████████████████████████████████████████▋   | 9121/9732 [01:01<00:03, 153.18it/s] 94%|████████████████████████████████████████████████▊   | 9137/9732 [01:01<00:03, 153.33it/s] 94%|████████████████████████████████████████████████▉   | 9153/9732 [01:01<00:03, 153.37it/s] 94%|████████████████████████████████████████████████▉   | 9169/9732 [01:01<00:03, 153.49it/s] 94%|█████████████████████████████████████████████████   | 9185/9732 [01:01<00:03, 153.61it/s] 95%|█████████████████████████████████████████████████▏  | 9201/9732 [01:01<00:03, 153.57it/s] 95%|█████████████████████████████████████████████████▏  | 9217/9732 [01:01<00:03, 153.57it/s] 95%|█████████████████████████████████████████████████▎  | 9233/9732 [01:01<00:03, 153.64it/s] 95%|█████████████████████████████████████████████████▍  | 9249/9732 [01:01<00:03, 153.75it/s] 95%|█████████████████████████████████████████████████▌  | 9265/9732 [01:02<00:03, 152.40it/s] 95%|█████████████████████████████████████████████████▌  | 9281/9732 [01:02<00:02, 152.79it/s] 96%|█████████████████████████████████████████████████▋  | 9297/9732 [01:02<00:02, 153.07it/s] 96%|█████████████████████████████████████████████████▊  | 9313/9732 [01:02<00:02, 153.27it/s] 96%|█████████████████████████████████████████████████▊  | 9329/9732 [01:02<00:02, 152.84it/s] 96%|█████████████████████████████████████████████████▉  | 9345/9732 [01:02<00:02, 153.03it/s] 96%|██████████████████████████████████████████████████  | 9361/9732 [01:02<00:02, 153.28it/s] 96%|██████████████████████████████████████████████████  | 9377/9732 [01:02<00:02, 153.49it/s] 97%|██████████████████████████████████████████████████▏ | 9393/9732 [01:02<00:02, 153.55it/s] 97%|██████████████████████████████████████████████████▎ | 9409/9732 [01:02<00:02, 153.66it/s] 97%|██████████████████████████████████████████████████▎ | 9425/9732 [01:03<00:01, 153.70it/s] 97%|██████████████████████████████████████████████████▍ | 9441/9732 [01:03<00:01, 153.71it/s] 97%|██████████████████████████████████████████████████▌ | 9457/9732 [01:03<00:01, 153.71it/s] 97%|██████████████████████████████████████████████████▌ | 9473/9732 [01:03<00:01, 153.80it/s] 98%|██████████████████████████████████████████████████▋ | 9489/9732 [01:03<00:01, 152.06it/s] 98%|██████████████████████████████████████████████████▊ | 9505/9732 [01:03<00:01, 152.47it/s] 98%|██████████████████████████████████████████████████▊ | 9521/9732 [01:03<00:01, 152.89it/s] 98%|██████████████████████████████████████████████████▉ | 9537/9732 [01:03<00:01, 153.11it/s] 98%|███████████████████████████████████████████████████ | 9553/9732 [01:03<00:01, 153.32it/s] 98%|███████████████████████████████████████████████████▏| 9569/9732 [01:04<00:01, 153.50it/s] 98%|███████████████████████████████████████████████████▏| 9585/9732 [01:04<00:00, 153.50it/s] 99%|███████████████████████████████████████████████████▎| 9601/9732 [01:04<00:00, 153.57it/s] 99%|███████████████████████████████████████████████████▍| 9617/9732 [01:04<00:00, 153.61it/s] 99%|███████████████████████████████████████████████████▍| 9633/9732 [01:04<00:00, 153.28it/s] 99%|███████████████████████████████████████████████████▌| 9649/9732 [01:04<00:00, 153.33it/s] 99%|███████████████████████████████████████████████████▋| 9665/9732 [01:04<00:00, 153.38it/s] 99%|███████████████████████████████████████████████████▋| 9681/9732 [01:04<00:00, 153.01it/s]100%|███████████████████████████████████████████████████▊| 9697/9732 [01:04<00:00, 153.11it/s]100%|███████████████████████████████████████████████████▉| 9713/9732 [01:04<00:00, 151.72it/s]100%|███████████████████████████████████████████████████▉| 9729/9732 [01:05<00:00, 152.16it/s]100%|████████████████████████████████████████████████████| 9732/9732 [01:05<00:00, 149.49it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:04<00:09,  4.90s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:04<00:09,  4.90s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.32s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.31s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:09<00:04,  4.97s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:09<00:04,  4.90s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.41s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.38s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.35s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.51s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.36s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.51s/it]
[2023-08-22 02:43:36,247] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.80s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.96s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.86s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.99s/it]
[2023-08-22 02:43:52,482] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-22 02:43:52,483] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-22 02:43:52,483] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-22 02:43:52,483] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-22 02:43:52,483] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-22 02:43:52,484] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-22 02:43:52,484] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-22 02:43:52,484] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-22 02:43:52,484] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-22 02:43:52,484] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-22 02:43:52,484] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-22 02:43:52,484] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f309d1fddc0>
[2023-08-22 02:43:52,484] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-22 02:43:52,484] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-22 02:43:52,484] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-22 02:43:52,484] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-22 02:43:52,484] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-22 02:43:52,484] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-22 02:43:52,484] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-22 02:43:52,484] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-22 02:43:52,484] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-22 02:43:52,484] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-22 02:43:52,484] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-22 02:43:52,484] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-22 02:43:52,485] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-22 02:43:52,485] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-22 02:43:52,485] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-22 02:43:52,485] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-22 02:43:52,485] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-22 02:43:52,485] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-22 02:43:52,485] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-22 02:43:52,485] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-22 02:43:52,485] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-22 02:43:52,485] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-22 02:43:52,485] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-22 02:43:52,485] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-22 02:43:52,485] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-22 02:43:52,485] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-22 02:43:52,485] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-22 02:43:52,485] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-22 02:43:52,485] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-22 02:43:52,485] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-22 02:43:52,485] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-22 02:43:52,485] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-22 02:43:52,485] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f308c7f5280>
[2023-08-22 02:43:52,485] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-22 02:43:52,485] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-22 02:43:52,485] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-22 02:43:52,485] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-22 02:43:52,485] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-22 02:43:52,485] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-22 02:43:52,485] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-22 02:43:52,485] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-22 02:43:52,485] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-22 02:43:52,485] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-22 02:43:52,485] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-22 02:43:52,485] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-22 02:43:52,485] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-22 02:43:52,485] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-22 02:43:52,485] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-22 02:43:52,486] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-22 02:43:52,486] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-22 02:43:52,486] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-22 02:43:52,486] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-22 02:43:52,486] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-22 02:43:52,486] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-22 02:43:52,486] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-22 02:43:52,486] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.7905809879302979 seconds
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.8052029609680176 seconds
Time to load utils op: 0.7049670219421387 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: Fabric is cut to order at what type of seller? Choices:  A: curtains B: tailor shop C: clothing store D: sewing room E: hardware store
Output: 1. Since we are discussing fabric cutting to order, it seems logical to cross out the options that do not typically involve selling fabric or making custom fabric items. This includes the options E: hardware store as it deals more with tools and home improvement goods and A: curtains, as this is a product rather than a type of seller.
2. Although options C: clothing store and D: sewing room might initially seem plausible, upon further consideration, both are not the most suitable options. Clothing stores usually sell ready-made clothes, not fabric that is cut to order. A sewing room, on the other hand, is more of a place in a home or business where sewing is done rather than a type of seller.
3. This leaves us with option B: tailor shop. Tailors often provide fabric and cut it to order for making custom clothes. Therefore, the best answer is B: Tailor shop, where fabric is cut to your personal requirements.
So the final answer is B: tailor shop

Input: Where are you if your reading magazines while waiting for a vehicle on rails? Choices:  A: vegetables B: market C: doctor D: train station E: bookstore
Output: 1. The question gives us the context that you're waiting for a vehicle on rails. 
2. We can eliminate options A, B, and C since it's unlikely to wait for a vehicle on rails at a place that sells vegetables, a general market, or a doctor's clinic.
3. Option E, a bookstore, seems unlikely because, even though you can read magazines there, it's not a usual place to wait for a vehicle on rails too.
4. Therefore, the most logical place to be waiting for a vehicle on rails would be at a station specified for such vehicles.
5. In considering the available options, option D, a train station, fits the given description the best — you can read magazines while you wait, and it's a place where you typically wait for a vehicle on rails, i.e., a train.
6. Therefore, the answer is D: train station.
So the final answer is D: train station

Input: What would need oil to be used? Choices:  A: ground B: human  body C: repair shop D: combustion engines E: service station
Output: 1. Start by analyzing each choice and determine its relationship with oil.
2. Choice A is the ground. Generally, oil isn't applied to the ground in most instances. Therefore A cannot be the answer.
3. Choice B is the human body. Although there are body oils formulated for use on the skin, this is entirely different from the oil used in industries or machinery. Therefore B is not the correct answer.
4. Choice C is a repair shop. However, this is rather generic. A repair shop might use oil but it is not necessary. Therefore, C cannot be the answer.
5. Choice D is combustion engines. These types of engines require oil as a lubricant for their numerous parts, hence allowing the process of combustion to occur in an efficient and smooth manner. Therefore, it can be said that oil is indeed necessary for combustion engines.
6. Lastly, choice E-service station. A service station may handle oil but isn't necessarily reliant on oil for any particular function.
7. Based on these analyses, the correct answer is D: combustion engines.
So the final answer is D: combustion engines

Input: What is person probably feeling that plans on stopping being married to their spouse? Choices:  A: detachment B: bankruptcy C: sad D: fights E: wrong
Output: 1. The question asks for the emotion or state a person likely feels when planning to end their marriage.
2. This is likely a complex emotional situation, and all of the choices could potentially be relevant to different aspects of a divorce. 
3. However, 'bankruptcy', 'fights', and 'wrong' are specific conditions or actions, not feelings.
4. Out of 'detachment' and'sad', both could be feelings experienced during a divorce. 
5. However, considering the fact that this person is planning on ending the marriage, it implies they have already emotionally distanced themselves from their spouse.
6. Taking all these points into account, the most probable answer then is A: detachment.
So the final answer is A: detachment

Input: What could you use to store a clock? Choices:  A: shelf B: own bedroom C: desk D: wall E: car
Output: 1. The question asks where one could store a clock.
2. We can eliminate choice B: own bedroom, because it's not specific enough. A bedroom is a space that contains various objects and not a specific place to store a clock.
3. We can also eliminate choice E: car, as a car is also not the ideal place to store a clock since we generally don't keep clocks in cars.
4. Choice D: wall, is not completely illogical but we typically hang a clock on a wall and not store it there.
5. Choice C: desk, is possible since people often have desk clocks. However, the desk is not only for storing the clock. It serves mainly other purposes like reading, writing, working on a computer, etc.
6. This leaves us with choice A: shelf. A shelf is a surface in a home or office where items can be stored or displayed. A clock could certainly be stored on a shelf. So, the answer is A: shelf.
So the final answer is A: shelf

Input: The person put on lotion, what did they want? Choices:  A: fresh smell B: good credit C: smooth skin D: fresh produce E: headache
Output: 1. The question tells us that the person put on lotion.
2. People typically use lotion for its moisturizing effects. 
3. Lotion is designed to improve the feel of your skin, making it smoother to touch.
4. Accordingly, fresh smell (option A) might be a welcome secondary effect of applying lotion, but it is not the primary reason. 
5. Good credit (option B) has no connection to applying lotion, so we can exclude this option.
6. Fresh produce (option D) is also unrelated to the application of skin products.
7. A headache (option E) is not connected to or the result of using lotion.
8. Thus, the most logical reason someone would use lotion is to improve the texture of their skin, making it smooth (option C).
So the final answer is C: smooth skin

Input: They burned the record, they were trying to do what to history? Choices:  A: compact disc B: tape C: rewrite D: play music E: erase
Output: 1. The question is asking what these people were trying to do to history by burning the record.
2. Burning a record is equivalent to destroying evidence or eradicating information.
3. Therefore, the act may indicate an intention to remove or get rid of that part of data, information, or history.
4. If we look at the choices, only "erase" fits the context of eliminating something.
5. Other choices like compact disc, tape, rewrite and play music don't fit into the context of obliterating or removing information.
6. "Rewrite" may sound plausible but it implies changing or modifying already existing information, not destroying it.
7.We can therefore conclude from this that they were trying to "erase" history. Thus, the answer is E: erase.
So the final answer is E: erase

Input: She sure didn't have a green thumb, every time she thought she was making grow something it would what? Choices:  A: growth B: flowering C: ground D: die E: plants
Output: 1. The question is about the expression "have a green thumb", which is often used to describe someone's ability to cultivate and grow plants successfully.
2. From the statement "She sure didn't have a green thumb", we understand this lady was unsuccessful in growing plants. 
3. Then the text says "every time she thought she was making grow something it would...". This implies some negative outcome because of the previous statement that she was unsuccessful in growing plants.
4. Going through the options, 'growth' and 'flowering' are positive outcomes, so they can be ruled out. The option 'ground' doesn't make sense in this context.
5. 'Plants' can be ruled out because it doesn't make sense to say "every time she thought she was making grow something it would plants".
6. So, the
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i9-s10-rTrue
Loading extension module utils...
Time to load utils op: 0.8044281005859375 seconds
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:39<32:29, 39.79s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:18<31:23, 39.24s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [01:57<30:32, 38.99s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [02:36<29:50, 38.92s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [03:15<29:10, 38.90s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [03:53<28:30, 38.88s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [04:32<27:51, 38.88s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [05:11<27:10, 38.83s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [05:50<26:31, 38.83s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [06:29<25:52, 38.81s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [07:07<25:13, 38.82s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [07:46<24:37, 38.88s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [08:25<23:59, 38.89s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [09:04<23:18, 38.84s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [09:43<22:37, 38.79s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [10:21<21:58, 38.77s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [11:00<21:18, 38.74s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [11:19<17:24, 32.64s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [11:57<17:48, 34.46s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [12:36<17:52, 35.75s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [13:15<17:42, 36.63s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [13:53<17:23, 37.27s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [14:32<16:58, 37.73s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [15:11<16:28, 38.04s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [15:50<15:57, 38.29s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [16:29<15:22, 38.42s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [17:07<14:45, 38.52s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [17:46<14:08, 38.59s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [18:25<13:32, 38.71s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [19:04<12:54, 38.73s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [19:43<12:15, 38.74s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [20:22<11:38, 38.81s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [21:00<10:59, 38.77s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [21:39<10:20, 38.78s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [22:18<09:41, 38.77s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [22:57<09:03, 38.80s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [23:32<08:09, 37.68s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [24:11<07:36, 38.00s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [24:49<07:00, 38.23s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [25:28<06:23, 38.37s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [26:07<05:46, 38.54s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [26:46<05:08, 38.62s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [27:25<04:30, 38.67s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [28:03<03:52, 38.68s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [28:42<03:13, 38.76s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [29:21<02:35, 38.82s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [30:00<01:56, 38.85s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [30:39<01:17, 38.95s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [31:18<00:38, 38.97s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [31:57<00:00, 38.91s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [31:57<00:00, 38.35s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 0.9354} | avg. gen lenth: 364.1
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i1-s10-rFalse --seed 10 --max-prompt-length 2048 --num-in-domain 1
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-22 03:16:23,019] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i1-s10-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 1
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i1-s10-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 10
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9740 [00:00<?, ?it/s]  5%|██▍                                                 | 462/9740 [00:00<00:02, 4612.72it/s] 10%|████▉                                               | 930/9740 [00:00<00:01, 4647.03it/s] 14%|███████▎                                           | 1404/9740 [00:00<00:01, 4686.13it/s] 19%|█████████▊                                         | 1873/9740 [00:00<00:01, 4675.35it/s] 24%|████████████▎                                      | 2344/9740 [00:00<00:01, 4686.83it/s] 29%|██████████████▋                                    | 2815/9740 [00:00<00:01, 4692.26it/s] 34%|█████████████████▏                                 | 3290/9740 [00:00<00:01, 4709.25it/s] 39%|███████████████████▋                               | 3761/9740 [00:00<00:01, 4708.01it/s] 43%|██████████████████████▏                            | 4232/9740 [00:00<00:01, 4629.02it/s] 48%|████████████████████████▌                          | 4696/9740 [00:01<00:01, 4572.47it/s] 53%|██████████████████████████▉                        | 5154/9740 [00:01<00:01, 3843.55it/s] 58%|█████████████████████████████▍                     | 5629/9740 [00:01<00:01, 4082.42it/s] 63%|████████████████████████████████                   | 6123/9740 [00:01<00:00, 4317.63it/s] 68%|██████████████████████████████████▋                | 6614/9740 [00:01<00:00, 4482.35it/s] 73%|█████████████████████████████████████▏             | 7113/9740 [00:01<00:00, 4627.52it/s] 78%|███████████████████████████████████████▊           | 7594/9740 [00:01<00:00, 4679.81it/s] 83%|██████████████████████████████████████████▎        | 8083/9740 [00:01<00:00, 4739.36it/s] 88%|████████████████████████████████████████████▊      | 8563/9740 [00:01<00:00, 4753.50it/s] 93%|███████████████████████████████████████████████▍   | 9057/9740 [00:01<00:00, 4806.13it/s] 98%|██████████████████████████████████████████████████ | 9556/9740 [00:02<00:00, 4857.97it/s]100%|███████████████████████████████████████████████████| 9740/9740 [00:02<00:00, 4608.88it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.50s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.31s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.20s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.50s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:04,  5.00s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.27s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.31s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:11<00:06,  6.05s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.38s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.57s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.62s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.80s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.66s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.85s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:16<00:00,  5.49s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:16<00:00,  5.59s/it]
[2023-08-22 03:17:19,325] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
[2023-08-22 03:17:34,264] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-22 03:17:34,264] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-22 03:17:34,265] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-22 03:17:34,265] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-22 03:17:34,265] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-22 03:17:34,265] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-22 03:17:34,265] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-22 03:17:34,265] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-22 03:17:34,265] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-22 03:17:34,265] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-22 03:17:34,265] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-22 03:17:34,265] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f627c3aafd0>
[2023-08-22 03:17:34,265] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f627d5cf220>
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-22 03:17:34,266] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-22 03:17:34,267] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-22 03:17:34,267] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-22 03:17:34,267] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-22 03:17:34,267] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.4029722213745117 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Loading extension module utils...
Time to load utils op: 0.30428147315979004 seconds
Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: Fabric is cut to order at what type of seller? Choices:  A: curtains B: tailor shop C: clothing store D: sewing room E: hardware store
Output: B: tailor shop

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i1-s10-rFalse
Loading extension module utils...
Time to load utils op: 0.4047410488128662 seconds
Loading extension module utils...
Time to load utils op: 0.40463876724243164 seconds
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:55<45:13, 55.38s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:51<44:42, 55.89s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [02:47<43:45, 55.86s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [03:42<42:38, 55.63s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [04:38<41:42, 55.62s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [05:09<34:45, 47.39s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [06:04<35:45, 49.90s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [07:00<36:09, 51.66s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [07:29<30:27, 44.58s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [08:23<31:44, 47.61s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [09:20<32:45, 50.40s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [10:17<33:14, 52.49s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [11:12<32:52, 53.32s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [12:09<32:38, 54.40s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [13:05<31:53, 54.67s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [14:00<31:10, 55.03s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [14:55<30:15, 55.01s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [15:41<27:54, 52.31s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [16:38<27:39, 53.52s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [17:33<26:58, 53.94s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [18:28<26:18, 54.42s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [19:24<25:38, 54.93s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [20:18<24:32, 54.52s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [21:13<23:38, 54.55s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [21:50<20:38, 49.55s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [22:46<20:31, 51.32s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [23:42<20:15, 52.87s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [24:37<19:36, 53.47s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [25:32<18:51, 53.89s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [26:27<18:05, 54.25s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [27:22<17:13, 54.41s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [28:17<16:21, 54.55s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [29:12<15:28, 54.61s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [29:30<11:40, 43.79s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [30:21<11:28, 45.93s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [31:17<11:25, 49.00s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [32:12<10:59, 50.75s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [33:07<10:23, 51.99s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [33:57<09:25, 51.37s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [34:52<08:45, 52.51s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [35:43<07:49, 52.12s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [36:38<07:03, 52.96s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [37:34<06:16, 53.76s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [38:28<05:23, 53.93s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [39:24<04:32, 54.48s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [40:19<03:38, 54.55s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [41:14<02:44, 54.82s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [42:07<01:48, 54.16s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [43:03<00:54, 54.76s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [43:58<00:00, 54.94s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [43:58<00:00, 52.77s/it]
name: commonsenseqa | {'exact_match': 2.4, 'rougeL': 6.1482} | avg. gen lenth: 277.368
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i2-s10-rFalse --seed 10 --max-prompt-length 2048 --num-in-domain 2
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-22 04:02:22,339] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i2-s10-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 2
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i2-s10-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 10
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9739 [00:00<?, ?it/s]  2%|█▏                                                  | 220/9739 [00:00<00:04, 2191.22it/s]  5%|██▎                                                 | 442/9739 [00:00<00:04, 2206.83it/s]  7%|███▌                                                | 665/9739 [00:00<00:04, 2215.71it/s]  9%|████▊                                               | 890/9739 [00:00<00:03, 2227.83it/s] 11%|█████▊                                             | 1114/9739 [00:00<00:03, 2230.57it/s] 14%|███████                                            | 1338/9739 [00:00<00:03, 2228.80it/s] 16%|████████▏                                          | 1562/9739 [00:00<00:03, 2228.41it/s] 18%|█████████▎                                         | 1785/9739 [00:00<00:03, 2228.05it/s] 21%|██████████▌                                        | 2008/9739 [00:00<00:03, 2161.91it/s] 23%|███████████▋                                       | 2226/9739 [00:01<00:03, 2167.22it/s] 25%|████████████▊                                      | 2450/9739 [00:01<00:03, 2185.96it/s] 27%|█████████████▉                                     | 2671/9739 [00:01<00:03, 2191.62it/s] 30%|███████████████▏                                   | 2892/9739 [00:01<00:03, 2194.83it/s] 32%|████████████████▎                                  | 3114/9739 [00:01<00:03, 2202.33it/s] 34%|█████████████████▍                                 | 3337/9739 [00:01<00:02, 2208.11it/s] 37%|██████████████████▋                                | 3558/9739 [00:01<00:02, 2206.53it/s] 39%|███████████████████▊                               | 3781/9739 [00:01<00:02, 2212.56it/s] 41%|████████████████████▉                              | 4005/9739 [00:01<00:02, 2219.73it/s] 43%|██████████████████████▏                            | 4227/9739 [00:01<00:02, 2214.26it/s] 46%|███████████████████████▎                           | 4449/9739 [00:02<00:02, 2212.41it/s] 48%|████████████████████████▍                          | 4671/9739 [00:02<00:02, 2184.06it/s] 50%|█████████████████████████▌                         | 4890/9739 [00:02<00:03, 1608.78it/s] 54%|███████████████████████████▎                       | 5225/9739 [00:02<00:02, 2021.86it/s] 57%|█████████████████████████████▏                     | 5568/9739 [00:02<00:01, 2378.44it/s] 61%|███████████████████████████████                    | 5923/9739 [00:02<00:01, 2688.44it/s] 64%|████████████████████████████████▊                  | 6277/9739 [00:02<00:01, 2920.90it/s] 68%|██████████████████████████████████▋                | 6631/9739 [00:02<00:01, 3092.99it/s] 72%|████████████████████████████████████▌              | 6988/9739 [00:02<00:00, 3229.42it/s] 75%|██████████████████████████████████████▍            | 7345/9739 [00:03<00:00, 3327.77it/s] 79%|████████████████████████████████████████▎          | 7688/9739 [00:03<00:00, 3356.39it/s] 82%|██████████████████████████████████████████         | 8033/9739 [00:03<00:00, 3383.59it/s] 86%|███████████████████████████████████████████▉       | 8385/9739 [00:03<00:00, 3421.52it/s] 90%|█████████████████████████████████████████████▋     | 8730/9739 [00:03<00:00, 3429.19it/s] 93%|███████████████████████████████████████████████▌   | 9080/9739 [00:03<00:00, 3449.63it/s] 97%|█████████████████████████████████████████████████▍ | 9432/9739 [00:03<00:00, 3470.57it/s]100%|███████████████████████████████████████████████████| 9739/9739 [00:03<00:00, 2609.53it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.28s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:11,  5.50s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:11,  5.66s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:11,  5.77s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.43s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:11<00:05,  5.52s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.47s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:11<00:05,  5.56s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.74s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.91s/it]
[2023-08-22 04:03:18,332] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  4.86s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  5.05s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  4.83s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  5.01s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  4.91s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  5.11s/it]
[2023-08-22 04:03:30,940] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-22 04:03:30,941] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-22 04:03:30,941] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-22 04:03:30,941] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-22 04:03:30,942] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-22 04:03:30,942] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-22 04:03:30,942] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-22 04:03:30,942] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-22 04:03:30,942] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-22 04:03:30,942] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-22 04:03:30,942] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-22 04:03:30,942] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f0227f5cfd0>
[2023-08-22 04:03:30,942] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-22 04:03:30,942] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-22 04:03:30,942] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-22 04:03:30,942] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-22 04:03:30,942] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-22 04:03:30,942] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-22 04:03:30,942] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-22 04:03:30,942] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-22 04:03:30,942] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-22 04:03:30,942] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-22 04:03:30,942] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-22 04:03:30,942] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-22 04:03:30,942] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-22 04:03:30,942] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-22 04:03:30,942] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-22 04:03:30,943] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-22 04:03:30,943] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-22 04:03:30,943] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-22 04:03:30,943] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-22 04:03:30,943] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-22 04:03:30,943] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-22 04:03:30,943] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-22 04:03:30,943] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-22 04:03:30,943] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-22 04:03:30,943] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-22 04:03:30,943] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-22 04:03:30,943] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-22 04:03:30,943] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-22 04:03:30,943] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-22 04:03:30,943] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-22 04:03:30,943] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-22 04:03:30,943] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-22 04:03:30,943] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f024c46f220>
[2023-08-22 04:03:30,943] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-22 04:03:30,943] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-22 04:03:30,943] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-22 04:03:30,943] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-22 04:03:30,943] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-22 04:03:30,943] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-22 04:03:30,943] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-22 04:03:30,943] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-22 04:03:30,943] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-22 04:03:30,943] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-22 04:03:30,943] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-22 04:03:30,943] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-22 04:03:30,943] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-22 04:03:30,943] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-22 04:03:30,943] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-22 04:03:30,943] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-22 04:03:30,943] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-22 04:03:30,943] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-22 04:03:30,943] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-22 04:03:30,944] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-22 04:03:30,944] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-22 04:03:30,944] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-22 04:03:30,944] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.3917229175567627 seconds
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.30423688888549805 seconds
Time to load utils op: 0.30424928665161133 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: Fabric is cut to order at what type of seller? Choices:  A: curtains B: tailor shop C: clothing store D: sewing room E: hardware store
Output: B: tailor shop

Input: Where are you if your reading magazines while waiting for a vehicle on rails? Choices:  A: vegetables B: market C: doctor D: train station E: bookstore
Output: D: train station

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i2-s10-rFalse
Loading extension module utils...
Time to load utils op: 0.20475053787231445 seconds
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:11<09:23, 11.50s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:05<29:19, 36.65s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [02:00<35:15, 45.02s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [02:55<37:30, 48.92s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [03:50<38:15, 51.00s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [04:43<38:02, 51.87s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [05:34<36:47, 51.34s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [06:28<36:37, 52.33s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [07:24<36:32, 53.47s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [08:18<35:47, 53.69s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [09:11<34:45, 53.48s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [09:45<30:03, 47.45s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [10:08<24:39, 40.00s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [11:03<26:40, 44.45s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [11:57<27:37, 47.35s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [12:51<28:06, 49.60s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [13:22<24:10, 43.95s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [14:18<25:16, 47.38s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [15:12<25:35, 49.54s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [16:07<25:32, 51.09s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [17:01<25:06, 51.95s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [17:55<24:35, 52.70s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [18:50<23:57, 53.22s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [19:45<23:17, 53.74s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [20:40<22:32, 54.10s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [21:23<20:24, 51.03s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [22:18<19:57, 52.05s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [23:09<18:56, 51.65s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [24:03<18:23, 52.55s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [24:57<17:39, 52.97s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [25:51<16:50, 53.19s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [26:28<14:31, 48.42s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [27:24<14:21, 50.67s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [28:20<13:53, 52.08s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [29:15<13:14, 52.97s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [30:10<12:30, 53.59s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [30:47<10:34, 48.84s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [31:41<10:04, 50.40s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [32:16<08:21, 45.55s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [33:11<08:04, 48.40s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [33:44<06:35, 43.99s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [34:38<06:14, 46.83s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [35:32<05:42, 48.96s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [36:27<05:04, 50.74s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [37:21<04:18, 51.74s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [38:15<03:30, 52.53s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [39:11<02:40, 53.46s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [39:58<01:43, 51.62s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [40:48<00:51, 51.15s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [41:42<00:00, 52.02s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [41:42<00:00, 50.05s/it]
name: commonsenseqa | {'exact_match': 1.2, 'rougeL': 4.3658} | avg. gen lenth: 248.064
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i3-s10-rFalse --seed 10 --max-prompt-length 2048 --num-in-domain 3
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date![nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!

[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-22 04:46:41,537] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i3-s10-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 3
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i3-s10-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 10
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9738 [00:00<?, ?it/s]  2%|▉                                                   | 180/9738 [00:00<00:05, 1795.33it/s]  4%|█▉                                                  | 360/9738 [00:00<00:05, 1793.64it/s]  6%|██▉                                                 | 541/9738 [00:00<00:05, 1800.95it/s]  7%|███▊                                                | 722/9738 [00:00<00:05, 1802.20it/s]  9%|████▊                                               | 905/9738 [00:00<00:04, 1810.57it/s] 11%|█████▋                                             | 1087/9738 [00:00<00:04, 1789.26it/s] 13%|██████▋                                            | 1267/9738 [00:00<00:04, 1790.74it/s] 15%|███████▌                                           | 1448/9738 [00:00<00:04, 1796.39it/s] 17%|████████▌                                          | 1628/9738 [00:00<00:04, 1764.13it/s] 19%|█████████▍                                         | 1805/9738 [00:01<00:04, 1743.49it/s] 20%|██████████▍                                        | 1986/9738 [00:01<00:04, 1763.05it/s] 22%|███████████▎                                       | 2167/9738 [00:01<00:04, 1775.35it/s] 24%|████████████▎                                      | 2349/9738 [00:01<00:04, 1787.31it/s] 26%|█████████████▎                                     | 2530/9738 [00:01<00:04, 1793.81it/s] 28%|██████████████▏                                    | 2711/9738 [00:01<00:03, 1797.30it/s] 30%|███████████████▏                                   | 2893/9738 [00:01<00:03, 1801.80it/s] 32%|████████████████                                   | 3075/9738 [00:01<00:03, 1804.74it/s] 33%|█████████████████                                  | 3258/9738 [00:01<00:03, 1812.15it/s] 35%|██████████████████                                 | 3440/9738 [00:01<00:03, 1802.41it/s] 37%|██████████████████▉                                | 3621/9738 [00:02<00:03, 1796.82it/s] 39%|███████████████████▉                               | 3804/9738 [00:02<00:03, 1804.27it/s] 41%|████████████████████▉                              | 3986/9738 [00:02<00:03, 1806.88it/s] 43%|█████████████████████▊                             | 4168/9738 [00:02<00:03, 1809.85it/s] 45%|██████████████████████▊                            | 4351/9738 [00:02<00:02, 1813.41it/s] 47%|███████████████████████▋                           | 4533/9738 [00:02<00:02, 1784.57it/s] 49%|████████████████████████▊                          | 4741/9738 [00:02<00:03, 1430.91it/s] 51%|██████████████████████████▎                        | 5014/9738 [00:02<00:02, 1747.34it/s] 54%|███████████████████████████▋                       | 5290/9738 [00:02<00:02, 2007.65it/s] 57%|█████████████████████████████▏                     | 5572/9738 [00:03<00:01, 2224.82it/s] 60%|██████████████████████████████▋                    | 5859/9738 [00:03<00:01, 2402.75it/s] 63%|████████████████████████████████▏                  | 6140/9738 [00:03<00:01, 2517.94it/s] 66%|█████████████████████████████████▋                 | 6430/9738 [00:03<00:01, 2627.73it/s] 69%|███████████████████████████████████▏               | 6718/9738 [00:03<00:01, 2699.08it/s] 72%|████████████████████████████████████▋              | 7006/9738 [00:03<00:00, 2751.54it/s] 75%|██████████████████████████████████████▏            | 7297/9738 [00:03<00:00, 2796.15it/s] 78%|███████████████████████████████████████▋           | 7579/9738 [00:03<00:00, 2781.89it/s] 81%|█████████████████████████████████████████▏         | 7859/9738 [00:03<00:00, 2781.38it/s] 84%|██████████████████████████████████████████▋        | 8150/9738 [00:03<00:00, 2817.19it/s] 87%|████████████████████████████████████████████▏      | 8438/9738 [00:04<00:00, 2833.31it/s] 90%|█████████████████████████████████████████████▋     | 8728/9738 [00:04<00:00, 2851.59it/s] 93%|███████████████████████████████████████████████▏   | 9016/9738 [00:04<00:00, 2858.76it/s] 96%|████████████████████████████████████████████████▋  | 9304/9738 [00:04<00:00, 2862.41it/s] 99%|██████████████████████████████████████████████████▎| 9596/9738 [00:04<00:00, 2876.97it/s]100%|███████████████████████████████████████████████████| 9738/9738 [00:04<00:00, 2167.65it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.33s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.28s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.28s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.30s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.20s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.17s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.20s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.48s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.57s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.75s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.65s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.80s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.69s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.84s/it]
[2023-08-22 04:47:37,872] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.82s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.98s/it]
[2023-08-22 04:47:50,463] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-22 04:47:50,464] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-22 04:47:50,465] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-22 04:47:50,465] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-22 04:47:50,465] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-22 04:47:50,465] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-22 04:47:50,465] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-22 04:47:50,465] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-22 04:47:50,465] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-22 04:47:50,465] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-22 04:47:50,465] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-22 04:47:50,465] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7efca7676fd0>
[2023-08-22 04:47:50,465] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-22 04:47:50,465] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-22 04:47:50,465] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-22 04:47:50,465] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-22 04:47:50,465] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-22 04:47:50,465] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-22 04:47:50,465] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-22 04:47:50,465] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-22 04:47:50,465] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-22 04:47:50,465] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-22 04:47:50,465] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-22 04:47:50,465] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-22 04:47:50,465] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-22 04:47:50,465] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-22 04:47:50,465] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-22 04:47:50,465] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-22 04:47:50,465] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-22 04:47:50,465] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-22 04:47:50,465] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-22 04:47:50,466] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-22 04:47:50,466] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-22 04:47:50,466] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-22 04:47:50,466] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-22 04:47:50,466] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-22 04:47:50,466] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-22 04:47:50,466] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-22 04:47:50,466] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-22 04:47:50,466] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-22 04:47:50,466] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-22 04:47:50,466] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-22 04:47:50,466] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-22 04:47:50,466] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-22 04:47:50,466] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7efcad7f3220>
[2023-08-22 04:47:50,466] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-22 04:47:50,466] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-22 04:47:50,466] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-22 04:47:50,466] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-22 04:47:50,466] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-22 04:47:50,466] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-22 04:47:50,466] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-22 04:47:50,466] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-22 04:47:50,466] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-22 04:47:50,466] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-22 04:47:50,466] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-22 04:47:50,466] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-22 04:47:50,466] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-22 04:47:50,466] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-22 04:47:50,466] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-22 04:47:50,466] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-22 04:47:50,466] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-22 04:47:50,466] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-22 04:47:50,466] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-22 04:47:50,466] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-22 04:47:50,466] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-22 04:47:50,466] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-22 04:47:50,466] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.400343656539917 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Loading extension module utils...
Time to load utils op: 0.4046182632446289 seconds
Loading extension module utils...
Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]Time to load utils op: 0.30420899391174316 seconds
############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: Fabric is cut to order at what type of seller? Choices:  A: curtains B: tailor shop C: clothing store D: sewing room E: hardware store
Output: B: tailor shop

Input: Where are you if your reading magazines while waiting for a vehicle on rails? Choices:  A: vegetables B: market C: doctor D: train station E: bookstore
Output: D: train station

Input: What would need oil to be used? Choices:  A: ground B: human  body C: repair shop D: combustion engines E: service station
Output: D: combustion engines

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i3-s10-rFalse
Loading extension module utils...
Time to load utils op: 0.3047811985015869 seconds
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:32<26:13, 32.11s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:25<35:42, 44.63s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [02:20<38:35, 49.26s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [02:49<31:47, 41.47s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [03:42<34:01, 45.37s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [04:15<30:11, 41.18s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [05:09<32:39, 45.57s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [06:04<33:55, 48.45s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [06:32<28:48, 42.16s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [07:27<30:37, 45.94s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [08:21<31:32, 48.53s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [09:15<31:46, 50.16s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [09:46<27:19, 44.30s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [10:40<28:24, 47.35s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [11:02<23:04, 39.55s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [11:55<24:51, 43.85s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [12:49<25:47, 46.90s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [13:23<22:51, 42.87s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [13:57<20:46, 40.22s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [14:51<22:07, 44.23s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [15:44<22:47, 47.15s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [16:40<23:11, 49.70s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [17:35<23:04, 51.29s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [18:29<22:30, 51.94s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [19:22<21:46, 52.26s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [20:13<20:48, 52.04s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [20:55<18:47, 49.03s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [21:49<18:33, 50.59s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [22:15<15:07, 43.23s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [23:10<15:34, 46.74s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [24:04<15:28, 48.88s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [24:54<14:46, 49.27s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [25:48<14:17, 50.46s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [26:41<13:43, 51.45s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [27:35<13:01, 52.10s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [27:59<10:12, 43.72s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [28:53<10:08, 46.81s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [29:23<08:18, 41.57s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [30:11<07:58, 43.51s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [31:04<07:43, 46.38s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [31:57<07:16, 48.51s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [32:51<06:39, 49.99s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [33:16<04:57, 42.56s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [34:10<04:35, 45.92s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [34:57<03:52, 46.52s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [35:52<03:15, 48.77s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [36:46<02:31, 50.42s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [37:40<01:42, 51.44s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [38:19<00:47, 47.73s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [39:13<00:00, 49.69s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [39:13<00:00, 47.07s/it]
name: commonsenseqa | {'exact_match': 0.8, 'rougeL': 4.6593} | avg. gen lenth: 222.624
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i4-s10-rFalse --seed 10 --max-prompt-length 2048 --num-in-domain 4
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-22 05:29:50,002] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i4-s10-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 4
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i4-s10-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 10
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9737 [00:00<?, ?it/s]  2%|█▏                                                  | 222/9737 [00:00<00:04, 2213.34it/s]  5%|██▍                                                 | 447/9737 [00:00<00:04, 2231.00it/s]  7%|███▌                                                | 673/9737 [00:00<00:04, 2242.04it/s]  9%|████▊                                               | 900/9737 [00:00<00:03, 2250.22it/s] 12%|█████▉                                             | 1127/9737 [00:00<00:03, 2257.06it/s] 14%|███████                                            | 1353/9737 [00:00<00:03, 2255.69it/s] 16%|████████▎                                          | 1579/9737 [00:00<00:03, 2252.26it/s] 19%|█████████▍                                         | 1805/9737 [00:00<00:03, 2232.92it/s] 21%|██████████▋                                        | 2030/9737 [00:00<00:03, 2235.27it/s] 23%|███████████▊                                       | 2254/9737 [00:01<00:03, 2223.74it/s] 25%|████████████▉                                      | 2479/9737 [00:01<00:03, 2229.69it/s] 28%|██████████████▏                                    | 2703/9737 [00:01<00:03, 2230.14it/s] 30%|███████████████▎                                   | 2927/9737 [00:01<00:03, 2206.44it/s] 32%|████████████████▌                                  | 3151/9737 [00:01<00:02, 2214.68it/s] 35%|█████████████████▋                                 | 3375/9737 [00:01<00:02, 2221.43it/s] 37%|██████████████████▊                                | 3598/9737 [00:01<00:02, 2222.05it/s] 39%|████████████████████                               | 3822/9737 [00:01<00:02, 2226.90it/s] 42%|█████████████████████▏                             | 4047/9737 [00:01<00:02, 2232.48it/s] 44%|██████████████████████▎                            | 4271/9737 [00:01<00:02, 2231.98it/s] 46%|███████████████████████▌                           | 4495/9737 [00:02<00:02, 2233.70it/s] 48%|████████████████████████▋                          | 4719/9737 [00:02<00:02, 2185.89it/s] 51%|█████████████████████████▊                         | 4938/9737 [00:02<00:02, 1893.78it/s] 53%|███████████████████████████                        | 5157/9737 [00:02<00:02, 1970.92it/s] 55%|████████████████████████████▏                      | 5379/9737 [00:02<00:02, 2038.00it/s] 58%|█████████████████████████████▎                     | 5607/9737 [00:02<00:01, 2105.50it/s] 60%|██████████████████████████████▌                    | 5840/9737 [00:02<00:01, 2168.51it/s] 62%|███████████████████████████████▊                   | 6073/9737 [00:02<00:01, 2214.65it/s] 65%|█████████████████████████████████                  | 6304/9737 [00:02<00:01, 2240.66it/s] 67%|██████████████████████████████████▏                | 6535/9737 [00:02<00:01, 2260.46it/s] 70%|███████████████████████████████████▍               | 6768/9737 [00:03<00:01, 2278.99it/s] 72%|████████████████████████████████████▋              | 6997/9737 [00:03<00:01, 2276.47it/s] 74%|█████████████████████████████████████▊             | 7230/9737 [00:03<00:01, 2289.83it/s] 77%|███████████████████████████████████████            | 7460/9737 [00:03<00:01, 2269.84it/s] 79%|████████████████████████████████████████▎          | 7692/9737 [00:03<00:00, 2281.84it/s] 81%|█████████████████████████████████████████▌         | 7926/9737 [00:03<00:00, 2298.51it/s] 84%|██████████████████████████████████████████▋        | 8160/9737 [00:03<00:00, 2309.85it/s] 86%|███████████████████████████████████████████▉       | 8394/9737 [00:03<00:00, 2315.98it/s] 89%|█████████████████████████████████████████████▏     | 8626/9737 [00:03<00:00, 2316.70it/s] 91%|██████████████████████████████████████████████▍    | 8858/9737 [00:03<00:00, 2314.76it/s] 93%|███████████████████████████████████████████████▌   | 9091/9737 [00:04<00:00, 2316.15it/s] 96%|████████████████████████████████████████████████▊  | 9325/9737 [00:04<00:00, 2320.52it/s] 98%|██████████████████████████████████████████████████ | 9558/9737 [00:04<00:00, 2308.31it/s]100%|███████████████████████████████████████████████████| 9737/9737 [00:04<00:00, 2231.98it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:11,  5.55s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:11,  5.55s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:11,  5.62s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.25s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.46s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.45s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.46s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.08s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.75s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.95s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.75s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.95s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  4.85s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  5.03s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.43s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.62s/it]
[2023-08-22 05:30:49,564] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
[2023-08-22 05:30:56,533] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-22 05:30:56,534] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-22 05:30:56,534] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-22 05:30:56,534] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-22 05:30:56,534] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-22 05:30:56,535] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-22 05:30:56,535] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-22 05:30:56,535] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-22 05:30:56,535] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-22 05:30:56,535] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-22 05:30:56,535] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-22 05:30:56,535] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f93bc569fd0>
[2023-08-22 05:30:56,535] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-22 05:30:56,535] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-22 05:30:56,535] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-22 05:30:56,535] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-22 05:30:56,535] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-22 05:30:56,535] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-22 05:30:56,535] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-22 05:30:56,535] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-22 05:30:56,535] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-22 05:30:56,535] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-22 05:30:56,535] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-22 05:30:56,535] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-22 05:30:56,535] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-22 05:30:56,535] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-22 05:30:56,535] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-22 05:30:56,535] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-22 05:30:56,535] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-22 05:30:56,535] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-22 05:30:56,535] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-22 05:30:56,535] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-22 05:30:56,535] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-22 05:30:56,535] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-22 05:30:56,535] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-22 05:30:56,535] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-22 05:30:56,535] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-22 05:30:56,535] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-22 05:30:56,535] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-22 05:30:56,535] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-22 05:30:56,535] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-22 05:30:56,535] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-22 05:30:56,535] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-22 05:30:56,535] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-22 05:30:56,536] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f93bc434220>
[2023-08-22 05:30:56,536] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-22 05:30:56,536] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-22 05:30:56,536] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-22 05:30:56,536] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-22 05:30:56,536] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-22 05:30:56,536] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-22 05:30:56,536] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-22 05:30:56,536] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-22 05:30:56,536] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-22 05:30:56,536] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-22 05:30:56,536] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-22 05:30:56,536] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-22 05:30:56,536] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-22 05:30:56,536] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-22 05:30:56,536] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-22 05:30:56,536] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-22 05:30:56,536] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-22 05:30:56,536] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-22 05:30:56,536] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-22 05:30:56,536] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-22 05:30:56,536] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-22 05:30:56,536] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-22 05:30:56,536] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.3764321804046631 seconds
Loading extension module utils...
Time to load utils op: 0.40445828437805176 seconds
Loading extension module utils...
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Time to load utils op: 0.4045286178588867 seconds
Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]Loading extension module utils...
############### Example ###############
Time to load utils op: 0.4026377201080322 seconds
### Instruction:Answer the following multiple choice question.

Input: Fabric is cut to order at what type of seller? Choices:  A: curtains B: tailor shop C: clothing store D: sewing room E: hardware store
Output: B: tailor shop

Input: Where are you if your reading magazines while waiting for a vehicle on rails? Choices:  A: vegetables B: market C: doctor D: train station E: bookstore
Output: D: train station

Input: What would need oil to be used? Choices:  A: ground B: human  body C: repair shop D: combustion engines E: service station
Output: D: combustion engines

Input: What is person probably feeling that plans on stopping being married to their spouse? Choices:  A: detachment B: bankruptcy C: sad D: fights E: wrong
Output: A: detachment

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i4-s10-rFalse
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:43<35:15, 43.17s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:35<39:01, 48.78s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [02:09<32:44, 41.81s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [03:01<35:11, 45.90s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [03:50<35:10, 46.91s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [04:42<35:42, 48.70s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [05:36<36:05, 50.35s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [06:27<35:32, 50.78s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [07:22<35:31, 51.98s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [08:15<34:51, 52.29s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [08:36<27:47, 42.75s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [09:05<24:24, 38.55s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [09:58<26:26, 42.88s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [10:51<27:36, 46.00s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [11:39<27:11, 46.63s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [12:31<27:21, 48.28s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [13:22<27:02, 49.15s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [14:16<26:55, 50.50s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [15:09<26:29, 51.29s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [16:01<25:45, 51.52s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [16:33<22:03, 45.63s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [17:26<22:18, 47.80s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [17:35<16:14, 36.09s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [18:27<17:43, 40.89s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [19:18<18:22, 44.09s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [19:33<14:03, 35.16s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [20:26<15:34, 40.63s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [21:19<16:12, 44.21s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [22:12<16:24, 46.89s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [23:04<16:09, 48.45s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [23:56<15:38, 49.42s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [24:36<14:03, 46.84s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [25:19<12:54, 45.58s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [25:59<11:43, 43.96s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [26:51<11:35, 46.39s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [27:37<10:46, 46.17s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [28:30<10:25, 48.13s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [29:23<09:56, 49.69s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [30:16<09:18, 50.81s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [30:36<06:54, 41.47s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [31:06<05:40, 37.89s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [31:50<05:18, 39.76s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [32:42<05:03, 43.40s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [33:31<04:31, 45.19s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [34:00<03:20, 40.20s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [34:53<02:56, 44.16s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [35:22<01:58, 39.63s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [36:15<01:27, 43.65s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [36:57<00:43, 43.03s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [37:08<00:00, 33.53s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [37:08<00:00, 44.57s/it]
name: commonsenseqa | {'exact_match': 5.6, 'rougeL': 8.7457} | avg. gen lenth: 216.672
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i5-s10-rFalse --seed 10 --max-prompt-length 2048 --num-in-domain 5
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-22 06:11:39,481] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i5-s10-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 5
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i5-s10-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 10
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9736 [00:00<?, ?it/s]  1%|▋                                                   | 130/9736 [00:00<00:07, 1291.63it/s]  3%|█▍                                                  | 260/9736 [00:00<00:07, 1295.08it/s]  4%|██                                                  | 392/9736 [00:00<00:07, 1303.13it/s]  5%|██▊                                                 | 523/9736 [00:00<00:07, 1304.91it/s]  7%|███▍                                                | 654/9736 [00:00<00:06, 1300.20it/s]  8%|████▏                                               | 786/9736 [00:00<00:06, 1304.73it/s]  9%|████▉                                               | 918/9736 [00:00<00:06, 1307.73it/s] 11%|█████▌                                             | 1051/9736 [00:00<00:06, 1312.15it/s] 12%|██████▏                                            | 1183/9736 [00:00<00:06, 1286.41it/s] 13%|██████▉                                            | 1314/9736 [00:01<00:06, 1291.00it/s] 15%|███████▌                                           | 1445/9736 [00:01<00:06, 1294.30it/s] 16%|████████▎                                          | 1576/9736 [00:01<00:06, 1298.28it/s] 18%|████████▉                                          | 1708/9736 [00:01<00:06, 1303.84it/s] 19%|█████████▋                                         | 1839/9736 [00:01<00:06, 1274.89it/s] 20%|██████████▎                                        | 1970/9736 [00:01<00:06, 1283.61it/s] 22%|███████████                                        | 2100/9736 [00:01<00:05, 1287.09it/s] 23%|███████████▋                                       | 2232/9736 [00:01<00:05, 1295.13it/s] 24%|████████████▍                                      | 2363/9736 [00:01<00:05, 1296.70it/s] 26%|█████████████                                      | 2493/9736 [00:01<00:05, 1294.56it/s] 27%|█████████████▋                                     | 2624/9736 [00:02<00:05, 1298.23it/s] 28%|██████████████▍                                    | 2754/9736 [00:02<00:05, 1298.50it/s] 30%|███████████████                                    | 2885/9736 [00:02<00:05, 1301.24it/s] 31%|███████████████▊                                   | 3016/9736 [00:02<00:05, 1303.09it/s] 32%|████████████████▍                                  | 3147/9736 [00:02<00:05, 1304.00it/s] 34%|█████████████████▏                                 | 3278/9736 [00:02<00:04, 1304.56it/s] 35%|██████████████████                                 | 3444/9736 [00:02<00:04, 1409.06it/s] 37%|███████████████████                                | 3642/9736 [00:02<00:03, 1579.50it/s] 39%|████████████████████                               | 3839/9736 [00:02<00:03, 1695.79it/s] 41%|█████████████████████▏                             | 4035/9736 [00:02<00:03, 1773.55it/s] 43%|██████████████████████▏                            | 4233/9736 [00:03<00:03, 1833.38it/s] 46%|███████████████████████▏                           | 4431/9736 [00:03<00:02, 1874.73it/s] 47%|████████████████████████▏                          | 4619/9736 [00:03<00:02, 1869.03it/s] 49%|█████████████████████████▏                         | 4806/9736 [00:03<00:03, 1424.04it/s] 51%|██████████████████████████▏                        | 5004/9736 [00:03<00:03, 1559.44it/s] 53%|███████████████████████████▎                       | 5203/9736 [00:03<00:02, 1669.29it/s] 55%|████████████████████████████▎                      | 5401/9736 [00:03<00:02, 1752.16it/s] 58%|█████████████████████████████▎                     | 5606/9736 [00:03<00:02, 1834.28it/s] 60%|██████████████████████████████▍                    | 5813/9736 [00:03<00:02, 1900.90it/s] 62%|███████████████████████████████▌                   | 6021/9736 [00:04<00:01, 1950.86it/s] 64%|████████████████████████████████▌                  | 6228/9736 [00:04<00:01, 1983.95it/s] 66%|█████████████████████████████████▋                 | 6435/9736 [00:04<00:01, 2007.88it/s] 68%|██████████████████████████████████▊                | 6641/9736 [00:04<00:01, 2023.03it/s] 70%|███████████████████████████████████▉               | 6850/9736 [00:04<00:01, 2039.97it/s] 72%|████████████████████████████████████▉              | 7057/9736 [00:04<00:01, 2047.67it/s] 75%|██████████████████████████████████████             | 7265/9736 [00:04<00:01, 2054.96it/s] 77%|███████████████████████████████████████▏           | 7471/9736 [00:04<00:01, 2024.22it/s] 79%|████████████████████████████████████████▏          | 7675/9736 [00:04<00:01, 2028.09it/s] 81%|█████████████████████████████████████████▎         | 7883/9736 [00:04<00:00, 2042.00it/s] 83%|██████████████████████████████████████████▍        | 8090/9736 [00:05<00:00, 2049.93it/s] 85%|███████████████████████████████████████████▍       | 8298/9736 [00:05<00:00, 2058.02it/s] 87%|████████████████████████████████████████████▌      | 8506/9736 [00:05<00:00, 2063.47it/s] 89%|█████████████████████████████████████████████▋     | 8713/9736 [00:05<00:00, 2064.46it/s] 92%|██████████████████████████████████████████████▋    | 8920/9736 [00:05<00:00, 2064.87it/s] 94%|███████████████████████████████████████████████▊   | 9128/9736 [00:05<00:00, 2066.61it/s] 96%|████████████████████████████████████████████████▉  | 9335/9736 [00:05<00:00, 2066.43it/s] 98%|█████████████████████████████████████████████████▉ | 9542/9736 [00:05<00:00, 2065.63it/s]100%|███████████████████████████████████████████████████| 9736/9736 [00:05<00:00, 1666.80it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:04<00:09,  4.94s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.19s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.41s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:11,  5.53s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:09<00:04,  4.98s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.32s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.35s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.47s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.32s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.50s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.75s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.89s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.71s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.90s/it]
[2023-08-22 06:12:37,362] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.77s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.95s/it]
[2023-08-22 06:12:44,992] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-22 06:12:44,993] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-22 06:12:44,993] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-22 06:12:44,993] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-22 06:12:44,993] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-22 06:12:44,993] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-22 06:12:44,993] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-22 06:12:44,993] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-22 06:12:44,993] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-22 06:12:44,993] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-22 06:12:44,993] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-22 06:12:44,993] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7ff6e07b2fd0>
[2023-08-22 06:12:44,993] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7ff6e738e220>
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-22 06:12:44,994] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-22 06:12:44,995] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-22 06:12:44,995] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-22 06:12:44,995] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-22 06:12:44,995] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.33099365234375 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: Fabric is cut to order at what type of seller? Choices:  A: curtains B: tailor shop C: clothing store D: sewing room E: hardware store
Output: B: tailor shop

Input: Where are you if your reading magazines while waiting for a vehicle on rails? Choices:  A: vegetables B: market C: doctor D: train station E: bookstore
Output: D: train station

Input: What would need oil to be used? Choices:  A: ground B: human  body C: repair shop D: combustion engines E: service station
Output: D: combustion engines

Input: What is person probably feeling that plans on stopping being married to their spouse? Choices:  A: detachment B: bankruptcy C: sad D: fights E: wrong
Output: A: detachment

Input: What could you use to store a clock? Choices:  A: shelf B: own bedroom C: desk D: wall E: car
Output: A: shelf

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i5-s10-rFalse
Loading extension module utils...
Time to load utils op: 0.3042633533477783 seconds
Loading extension module utils...
Time to load utils op: 0.4046494960784912 seconds
Loading extension module utils...
Time to load utils op: 0.3043532371520996 seconds
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:51<42:24, 51.93s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:42<41:05, 51.37s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [02:25<37:16, 47.58s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [03:18<38:00, 49.57s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [03:38<29:01, 38.70s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [04:31<32:07, 43.80s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [05:23<33:17, 46.46s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [06:14<33:29, 47.86s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [07:06<33:35, 49.15s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [07:57<33:11, 49.78s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [08:38<30:38, 47.15s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [09:31<30:51, 48.71s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [10:25<31:06, 50.45s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [10:43<24:17, 40.49s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [11:35<25:42, 44.08s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [12:26<26:11, 46.21s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [13:19<26:27, 48.09s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [14:11<26:16, 49.28s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [15:02<25:48, 49.96s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [15:55<25:24, 50.80s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [16:45<24:25, 50.53s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [17:39<24:01, 51.49s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [18:31<23:19, 51.84s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [19:23<22:26, 51.80s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [20:00<19:46, 47.45s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [20:52<19:32, 48.87s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [21:44<18:59, 49.56s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [22:35<18:24, 50.19s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [23:28<17:47, 50.83s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [23:45<13:36, 40.84s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [24:37<14:00, 44.23s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [25:29<13:57, 46.52s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [26:22<13:44, 48.50s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [27:13<13:08, 49.29s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [28:06<12:34, 50.27s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [28:57<11:47, 50.53s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [29:49<11:03, 51.06s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [30:42<10:17, 51.47s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [31:33<09:25, 51.42s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [32:24<08:33, 51.30s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [33:17<07:45, 51.69s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [34:09<06:54, 51.85s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [35:00<06:00, 51.55s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [35:52<05:10, 51.82s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [36:41<04:14, 51.00s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [37:34<03:25, 51.49s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [38:12<02:22, 47.44s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [39:03<01:37, 48.65s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [39:56<00:49, 49.76s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [40:48<00:00, 50.37s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [40:48<00:00, 48.96s/it]
name: commonsenseqa | {'exact_match': 3.2, 'rougeL': 6.9994} | avg. gen lenth: 269.956
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i6-s10-rFalse --seed 10 --max-prompt-length 2048 --num-in-domain 6
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date![nltk_data]   Package punkt is already up-to-date!

[nltk_data]   Package punkt is already up-to-date![nltk_data]   Package punkt is already up-to-date!

using world size: 4
[2023-08-22 06:53:43,497] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i6-s10-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 6
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i6-s10-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 10
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9735 [00:00<?, ?it/s]  1%|▌                                                   | 114/9735 [00:00<00:08, 1138.22it/s]  2%|█▏                                                  | 229/9735 [00:00<00:08, 1140.99it/s]  4%|█▊                                                  | 345/9735 [00:00<00:08, 1146.79it/s]  5%|██▍                                                 | 461/9735 [00:00<00:08, 1148.21it/s]  6%|███                                                 | 576/9735 [00:00<00:07, 1148.66it/s]  7%|███▋                                                | 692/9735 [00:00<00:07, 1150.56it/s]  8%|████▎                                               | 808/9735 [00:00<00:07, 1153.33it/s]  9%|████▉                                               | 924/9735 [00:00<00:07, 1132.11it/s] 11%|█████▍                                             | 1040/9735 [00:00<00:07, 1138.37it/s] 12%|██████                                             | 1156/9735 [00:01<00:07, 1143.82it/s] 13%|██████▋                                            | 1271/9735 [00:01<00:07, 1145.45it/s] 14%|███████▎                                           | 1386/9735 [00:01<00:07, 1143.84it/s] 15%|███████▊                                           | 1501/9735 [00:01<00:07, 1145.60it/s] 17%|████████▍                                          | 1616/9735 [00:01<00:07, 1146.10it/s] 18%|█████████                                          | 1732/9735 [00:01<00:06, 1149.68it/s] 19%|█████████▋                                         | 1847/9735 [00:01<00:07, 1122.34it/s] 20%|██████████▎                                        | 1962/9735 [00:01<00:06, 1130.17it/s] 21%|██████████▉                                        | 2076/9735 [00:01<00:06, 1129.90it/s] 23%|███████████▍                                       | 2191/9735 [00:01<00:06, 1135.42it/s] 24%|████████████                                       | 2307/9735 [00:02<00:06, 1140.13it/s] 25%|████████████▊                                      | 2448/9735 [00:02<00:05, 1220.06it/s] 27%|█████████████▋                                     | 2624/9735 [00:02<00:05, 1379.30it/s] 29%|██████████████▋                                    | 2797/9735 [00:02<00:04, 1483.88it/s] 31%|███████████████▌                                   | 2972/9735 [00:02<00:04, 1562.44it/s] 32%|████████████████▍                                  | 3148/9735 [00:02<00:04, 1619.94it/s] 34%|█████████████████▍                                 | 3324/9735 [00:02<00:03, 1661.58it/s] 36%|██████████████████▎                                | 3500/9735 [00:02<00:03, 1689.52it/s] 38%|███████████████████▎                               | 3676/9735 [00:02<00:03, 1708.43it/s] 40%|████████████████████▏                              | 3851/9735 [00:02<00:03, 1719.25it/s] 41%|█████████████████████                              | 4028/9735 [00:03<00:03, 1734.04it/s] 43%|██████████████████████                             | 4202/9735 [00:03<00:03, 1728.71it/s] 45%|██████████████████████▉                            | 4377/9735 [00:03<00:03, 1734.33it/s] 47%|███████████████████████▊                           | 4551/9735 [00:03<00:03, 1687.51it/s] 49%|████████████████████████▊                          | 4726/9735 [00:03<00:02, 1703.17it/s] 50%|█████████████████████████▋                         | 4897/9735 [00:03<00:03, 1312.78it/s] 52%|██████████████████████████▌                        | 5072/9735 [00:03<00:03, 1419.02it/s] 54%|███████████████████████████▍                       | 5247/9735 [00:03<00:02, 1503.58it/s] 56%|████████████████████████████▍                      | 5423/9735 [00:03<00:02, 1570.74it/s] 58%|█████████████████████████████▎                     | 5605/9735 [00:04<00:02, 1637.67it/s] 59%|██████████████████████████████▎                    | 5789/9735 [00:04<00:02, 1693.40it/s] 61%|███████████████████████████████▎                   | 5973/9735 [00:04<00:02, 1733.57it/s] 63%|████████████████████████████████▏                  | 6155/9735 [00:04<00:02, 1757.76it/s] 65%|█████████████████████████████████▏                 | 6334/9735 [00:04<00:01, 1749.20it/s] 67%|██████████████████████████████████▏                | 6516/9735 [00:04<00:01, 1768.49it/s] 69%|███████████████████████████████████                | 6696/9735 [00:04<00:01, 1777.61it/s] 71%|████████████████████████████████████               | 6880/9735 [00:04<00:01, 1795.39it/s] 73%|█████████████████████████████████████              | 7064/9735 [00:04<00:01, 1807.73it/s] 74%|█████████████████████████████████████▉             | 7247/9735 [00:04<00:01, 1811.37it/s] 76%|██████████████████████████████████████▉            | 7432/9735 [00:05<00:01, 1820.01it/s] 78%|███████████████████████████████████████▉           | 7615/9735 [00:05<00:01, 1772.50it/s] 80%|████████████████████████████████████████▊          | 7798/9735 [00:05<00:01, 1788.47it/s] 82%|█████████████████████████████████████████▊         | 7981/9735 [00:05<00:00, 1800.59it/s] 84%|██████████████████████████████████████████▊        | 8165/9735 [00:05<00:00, 1810.32it/s] 86%|███████████████████████████████████████████▋       | 8349/9735 [00:05<00:00, 1818.63it/s] 88%|████████████████████████████████████████████▋      | 8532/9735 [00:05<00:00, 1821.45it/s] 90%|█████████████████████████████████████████████▋     | 8715/9735 [00:05<00:00, 1806.41it/s] 91%|██████████████████████████████████████████████▌    | 8896/9735 [00:05<00:00, 1799.11it/s] 93%|███████████████████████████████████████████████▌   | 9077/9735 [00:05<00:00, 1801.50it/s] 95%|████████████████████████████████████████████████▌  | 9261/9735 [00:06<00:00, 1811.15it/s] 97%|█████████████████████████████████████████████████▍ | 9445/9735 [00:06<00:00, 1819.03it/s] 99%|██████████████████████████████████████████████████▍| 9627/9735 [00:06<00:00, 1818.24it/s]100%|███████████████████████████████████████████████████| 9735/9735 [00:06<00:00, 1540.12it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.33s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:11,  5.56s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.45s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.27s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.02s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.45s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.25s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.48s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.44s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.62s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.74s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.92s/it]
[2023-08-22 06:54:41,828] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.78s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.97s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.75s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.91s/it]
[2023-08-22 06:54:50,830] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-22 06:54:50,831] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-22 06:54:50,832] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-22 06:54:50,832] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-22 06:54:50,832] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-22 06:54:50,832] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-22 06:54:50,832] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-22 06:54:50,832] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-22 06:54:50,832] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-22 06:54:50,832] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-22 06:54:50,833] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-22 06:54:50,833] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f742e87bfd0>
[2023-08-22 06:54:50,833] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-22 06:54:50,833] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-22 06:54:50,833] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-22 06:54:50,833] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-22 06:54:50,833] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-22 06:54:50,833] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-22 06:54:50,833] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-22 06:54:50,833] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-22 06:54:50,833] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-22 06:54:50,833] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-22 06:54:50,833] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-22 06:54:50,833] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-22 06:54:50,833] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-22 06:54:50,833] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-22 06:54:50,833] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-22 06:54:50,833] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-22 06:54:50,833] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-22 06:54:50,833] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-22 06:54:50,833] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-22 06:54:50,833] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-22 06:54:50,833] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-22 06:54:50,833] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-22 06:54:50,833] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-22 06:54:50,833] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-22 06:54:50,833] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-22 06:54:50,833] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-22 06:54:50,833] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-22 06:54:50,833] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-22 06:54:50,833] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-22 06:54:50,833] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-22 06:54:50,833] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-22 06:54:50,833] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-22 06:54:50,833] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f740e3de220>
[2023-08-22 06:54:50,834] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-22 06:54:50,834] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-22 06:54:50,834] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-22 06:54:50,834] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-22 06:54:50,834] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-22 06:54:50,834] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-22 06:54:50,834] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-22 06:54:50,834] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-22 06:54:50,834] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-22 06:54:50,834] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-22 06:54:50,834] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-22 06:54:50,834] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-22 06:54:50,834] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-22 06:54:50,834] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-22 06:54:50,834] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-22 06:54:50,834] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-22 06:54:50,834] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-22 06:54:50,834] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-22 06:54:50,834] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-22 06:54:50,834] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-22 06:54:50,834] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-22 06:54:50,834] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-22 06:54:50,834] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.3988316059112549 seconds
Loading extension module utils...
Time to load utils op: 0.40461111068725586 seconds
Loading extension module utils...
Time to load utils op: 0.4046642780303955 seconds
Loading extension module utils...
Time to load utils op: 0.304398775100708 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: Fabric is cut to order at what type of seller? Choices:  A: curtains B: tailor shop C: clothing store D: sewing room E: hardware store
Output: B: tailor shop

Input: Where are you if your reading magazines while waiting for a vehicle on rails? Choices:  A: vegetables B: market C: doctor D: train station E: bookstore
Output: D: train station

Input: What would need oil to be used? Choices:  A: ground B: human  body C: repair shop D: combustion engines E: service station
Output: D: combustion engines

Input: What is person probably feeling that plans on stopping being married to their spouse? Choices:  A: detachment B: bankruptcy C: sad D: fights E: wrong
Output: A: detachment

Input: What could you use to store a clock? Choices:  A: shelf B: own bedroom C: desk D: wall E: car
Output: A: shelf

Input: The person put on lotion, what did they want? Choices:  A: fresh smell B: good credit C: smooth skin D: fresh produce E: headache
Output: C: smooth skin

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i6-s10-rFalse
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:52<43:13, 52.93s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:39<39:31, 49.42s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [02:14<33:33, 42.85s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [03:04<35:00, 45.66s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [03:54<35:24, 47.21s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [04:44<35:21, 48.21s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [05:36<35:21, 49.33s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [06:27<34:50, 49.77s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [07:18<34:20, 50.25s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [07:50<29:44, 44.61s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [08:42<30:21, 46.70s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [09:31<30:08, 47.60s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [10:21<29:50, 48.40s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [11:03<27:51, 46.42s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [11:54<27:46, 47.62s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [12:44<27:27, 48.47s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [13:35<27:04, 49.22s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [14:26<26:33, 49.78s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [15:17<25:57, 50.23s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [16:09<25:19, 50.66s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [17:00<24:34, 50.85s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [17:52<23:49, 51.05s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [18:21<19:57, 44.36s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [19:12<20:07, 46.46s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [20:03<19:52, 47.68s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [20:53<19:24, 48.51s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [21:44<18:51, 49.19s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [22:35<18:18, 49.92s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [23:18<16:40, 47.64s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [24:08<16:06, 48.34s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [25:00<15:39, 49.42s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [25:52<15:04, 50.25s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [26:42<14:14, 50.27s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [27:33<13:25, 50.33s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [28:11<11:40, 46.68s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [29:01<11:09, 47.82s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [29:22<08:34, 39.57s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [30:13<08:36, 43.06s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [31:04<08:21, 45.56s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [31:54<07:49, 46.93s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [32:45<07:11, 48.00s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [33:37<06:34, 49.31s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [34:28<05:48, 49.74s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [35:18<04:58, 49.81s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [36:09<04:10, 50.07s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [36:47<03:06, 46.63s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [37:38<02:23, 47.99s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [38:29<01:37, 48.76s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [39:19<00:49, 49.18s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [40:10<00:00, 49.73s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [40:10<00:00, 48.21s/it]
name: commonsenseqa | {'exact_match': 1.2, 'rougeL': 3.9824} | avg. gen lenth: 292.528
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i7-s10-rFalse --seed 10 --max-prompt-length 2048 --num-in-domain 7
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-22 07:35:57,510] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i7-s10-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 7
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i7-s10-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 10
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9734 [00:00<?, ?it/s]  1%|▌                                                   | 102/9734 [00:00<00:09, 1017.59it/s]  2%|█                                                   | 205/9734 [00:00<00:09, 1019.11it/s]  3%|█▋                                                  | 308/9734 [00:00<00:09, 1023.06it/s]  4%|██▏                                                 | 412/9734 [00:00<00:09, 1026.29it/s]  5%|██▊                                                 | 515/9734 [00:00<00:08, 1026.48it/s]  6%|███▎                                                | 618/9734 [00:00<00:08, 1027.48it/s]  7%|███▊                                                | 721/9734 [00:00<00:08, 1027.45it/s]  8%|████▍                                               | 824/9734 [00:00<00:08, 1011.59it/s] 10%|████▉                                               | 926/9734 [00:00<00:08, 1008.48it/s] 11%|█████▍                                             | 1030/9734 [00:01<00:08, 1015.70it/s] 12%|█████▉                                             | 1133/9734 [00:01<00:08, 1019.85it/s] 13%|██████▍                                            | 1236/9734 [00:01<00:08, 1021.39it/s] 14%|███████                                            | 1339/9734 [00:01<00:08, 1023.41it/s] 15%|███████▌                                           | 1443/9734 [00:01<00:08, 1025.44it/s] 16%|████████                                           | 1547/9734 [00:01<00:07, 1027.70it/s] 17%|████████▋                                          | 1651/9734 [00:01<00:07, 1028.46it/s] 18%|█████████▏                                         | 1755/9734 [00:01<00:07, 1029.56it/s] 19%|█████████▉                                          | 1858/9734 [00:01<00:07, 999.61it/s] 20%|██████████▎                                        | 1961/9734 [00:01<00:07, 1005.97it/s] 21%|██████████▊                                        | 2071/9734 [00:02<00:07, 1032.71it/s] 23%|███████████▋                                       | 2229/9734 [00:02<00:06, 1192.31it/s] 24%|████████████▍                                      | 2384/9734 [00:02<00:05, 1296.84it/s] 26%|█████████████▎                                     | 2541/9734 [00:02<00:05, 1377.23it/s] 28%|██████████████▏                                    | 2699/9734 [00:02<00:04, 1435.99it/s] 29%|██████████████▉                                    | 2857/9734 [00:02<00:04, 1476.42it/s] 31%|███████████████▊                                   | 3014/9734 [00:02<00:04, 1503.01it/s] 33%|████████████████▌                                  | 3171/9734 [00:02<00:04, 1522.17it/s] 34%|█████████████████▍                                 | 3329/9734 [00:02<00:04, 1537.66it/s] 36%|██████████████████▎                                | 3486/9734 [00:02<00:04, 1545.51it/s] 37%|███████████████████                                | 3642/9734 [00:03<00:03, 1547.21it/s] 39%|███████████████████▉                               | 3800/9734 [00:03<00:03, 1555.81it/s] 41%|████████████████████▋                              | 3958/9734 [00:03<00:03, 1560.33it/s] 42%|█████████████████████▌                             | 4115/9734 [00:03<00:03, 1562.11it/s] 44%|██████████████████████▍                            | 4273/9734 [00:03<00:03, 1565.69it/s] 46%|███████████████████████▏                           | 4430/9734 [00:03<00:03, 1566.17it/s] 47%|████████████████████████                           | 4587/9734 [00:03<00:03, 1532.43it/s] 49%|████████████████████████▊                          | 4742/9734 [00:03<00:04, 1181.77it/s] 50%|█████████████████████████▋                         | 4897/9734 [00:03<00:03, 1271.59it/s] 52%|██████████████████████████▍                        | 5052/9734 [00:04<00:03, 1343.62it/s] 54%|███████████████████████████▎                       | 5209/9734 [00:04<00:03, 1403.24it/s] 55%|████████████████████████████                       | 5367/9734 [00:04<00:03, 1449.97it/s] 57%|████████████████████████████▉                      | 5524/9734 [00:04<00:02, 1482.72it/s] 58%|█████████████████████████████▋                     | 5677/9734 [00:04<00:02, 1493.86it/s] 60%|██████████████████████████████▌                    | 5837/9734 [00:04<00:02, 1524.47it/s] 62%|███████████████████████████████▍                   | 5999/9734 [00:04<00:02, 1550.48it/s] 63%|████████████████████████████████▎                  | 6161/9734 [00:04<00:02, 1569.24it/s] 65%|█████████████████████████████████                  | 6321/9734 [00:04<00:02, 1577.27it/s] 67%|█████████████████████████████████▉                 | 6484/9734 [00:04<00:02, 1591.32it/s] 68%|██████████████████████████████████▊                | 6647/9734 [00:05<00:01, 1601.35it/s] 70%|███████████████████████████████████▋               | 6811/9734 [00:05<00:01, 1612.31it/s] 72%|████████████████████████████████████▌              | 6976/9734 [00:05<00:01, 1622.19it/s] 73%|█████████████████████████████████████▍             | 7140/9734 [00:05<00:01, 1627.30it/s] 75%|██████████████████████████████████████▎            | 7304/9734 [00:05<00:01, 1628.84it/s] 77%|███████████████████████████████████████            | 7467/9734 [00:05<00:01, 1589.00it/s] 78%|███████████████████████████████████████▉           | 7627/9734 [00:05<00:01, 1592.07it/s] 80%|████████████████████████████████████████▊          | 7787/9734 [00:05<00:01, 1581.59it/s] 82%|█████████████████████████████████████████▋         | 7951/9734 [00:05<00:01, 1596.75it/s] 83%|██████████████████████████████████████████▌        | 8116/9734 [00:05<00:01, 1610.51it/s] 85%|███████████████████████████████████████████▍       | 8280/9734 [00:06<00:00, 1616.58it/s] 87%|████████████████████████████████████████████▏      | 8443/9734 [00:06<00:00, 1620.27it/s] 88%|█████████████████████████████████████████████      | 8606/9734 [00:06<00:00, 1622.79it/s] 90%|█████████████████████████████████████████████▉     | 8770/9734 [00:06<00:00, 1627.12it/s] 92%|██████████████████████████████████████████████▊    | 8933/9734 [00:06<00:00, 1624.51it/s] 93%|███████████████████████████████████████████████▋   | 9096/9734 [00:06<00:00, 1608.74it/s] 95%|████████████████████████████████████████████████▌  | 9258/9734 [00:06<00:00, 1609.91it/s] 97%|█████████████████████████████████████████████████▎ | 9421/9734 [00:06<00:00, 1614.52it/s] 98%|██████████████████████████████████████████████████▏| 9584/9734 [00:06<00:00, 1617.40it/s]100%|███████████████████████████████████████████████████| 9734/9734 [00:06<00:00, 1399.17it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.37s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.23s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.36s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:11,  5.80s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.20s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.23s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.48s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:11<00:05,  5.87s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.68s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.84s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.79s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.91s/it]
[2023-08-22 07:36:56,620] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.84s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  5.00s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:17<00:00,  5.80s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:17<00:00,  5.81s/it]
[2023-08-22 07:37:10,681] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-22 07:37:10,682] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-22 07:37:10,683] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-22 07:37:10,683] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-22 07:37:10,683] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-22 07:37:10,683] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-22 07:37:10,683] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-22 07:37:10,683] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-22 07:37:10,684] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-22 07:37:10,684] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-22 07:37:10,684] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-22 07:37:10,684] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f0cd3df2fd0>
[2023-08-22 07:37:10,684] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-22 07:37:10,684] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-22 07:37:10,684] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-22 07:37:10,684] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-22 07:37:10,684] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-22 07:37:10,684] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-22 07:37:10,684] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-22 07:37:10,684] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-22 07:37:10,684] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-22 07:37:10,684] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-22 07:37:10,684] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-22 07:37:10,684] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-22 07:37:10,684] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-22 07:37:10,684] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-22 07:37:10,684] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-22 07:37:10,684] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-22 07:37:10,684] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-22 07:37:10,684] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-22 07:37:10,684] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-22 07:37:10,684] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-22 07:37:10,684] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-22 07:37:10,684] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-22 07:37:10,684] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-22 07:37:10,684] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-22 07:37:10,684] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-22 07:37:10,684] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-22 07:37:10,684] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-22 07:37:10,684] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-22 07:37:10,684] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-22 07:37:10,684] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-22 07:37:10,684] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-22 07:37:10,684] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-22 07:37:10,685] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f0cdc256070>
[2023-08-22 07:37:10,685] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-22 07:37:10,685] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-22 07:37:10,685] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-22 07:37:10,685] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-22 07:37:10,685] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-22 07:37:10,685] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-22 07:37:10,685] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-22 07:37:10,685] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-22 07:37:10,685] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-22 07:37:10,685] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-22 07:37:10,685] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-22 07:37:10,685] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-22 07:37:10,685] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-22 07:37:10,685] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-22 07:37:10,685] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-22 07:37:10,685] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-22 07:37:10,685] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-22 07:37:10,685] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-22 07:37:10,685] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-22 07:37:10,685] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-22 07:37:10,685] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-22 07:37:10,685] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-22 07:37:10,685] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.40895724296569824 seconds
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.3043351173400879 seconds
Time to load utils op: 0.30434608459472656 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: Fabric is cut to order at what type of seller? Choices:  A: curtains B: tailor shop C: clothing store D: sewing room E: hardware store
Output: B: tailor shop

Input: Where are you if your reading magazines while waiting for a vehicle on rails? Choices:  A: vegetables B: market C: doctor D: train station E: bookstore
Output: D: train station

Input: What would need oil to be used? Choices:  A: ground B: human  body C: repair shop D: combustion engines E: service station
Output: D: combustion engines

Input: What is person probably feeling that plans on stopping being married to their spouse? Choices:  A: detachment B: bankruptcy C: sad D: fights E: wrong
Output: A: detachment

Input: What could you use to store a clock? Choices:  A: shelf B: own bedroom C: desk D: wall E: car
Output: A: shelf

Input: The person put on lotion, what did they want? Choices:  A: fresh smell B: good credit C: smooth skin D: fresh produce E: headache
Output: C: smooth skin

Input: They burned the record, they were trying to do what to history? Choices:  A: compact disc B: tape C: rewrite D: play music E: erase
Output: E: erase

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i7-s10-rFalse
Loading extension module utils...
Time to load utils op: 0.30429863929748535 seconds
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:51<41:56, 51.36s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:40<40:02, 50.05s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [02:30<39:22, 50.26s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [03:06<33:55, 44.24s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [03:56<34:57, 46.60s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [04:47<35:08, 47.92s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [05:36<34:44, 48.47s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [06:26<34:08, 48.76s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [07:16<33:44, 49.37s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [08:07<33:07, 49.68s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [08:58<32:35, 50.15s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [09:48<31:38, 49.97s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [10:15<26:34, 43.10s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [11:05<27:05, 45.15s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [11:55<27:16, 46.75s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [12:45<26:58, 47.62s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [13:35<26:39, 48.48s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [14:27<26:19, 49.35s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [15:18<25:45, 49.87s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [15:58<23:30, 47.02s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [16:48<23:07, 47.86s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [17:38<22:41, 48.63s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [18:28<22:01, 48.93s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [19:18<21:19, 49.23s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [20:08<20:34, 49.37s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [20:44<18:08, 45.35s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [21:34<17:53, 46.69s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [22:24<17:33, 47.89s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [22:53<14:48, 42.30s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [23:44<14:57, 44.87s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [24:34<14:39, 46.31s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [25:24<14:15, 47.51s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [26:15<13:42, 48.41s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [27:05<13:02, 48.92s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [27:50<11:57, 47.81s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [28:13<09:25, 40.38s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [28:41<07:57, 36.69s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [29:16<07:12, 36.08s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [29:47<06:19, 34.48s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [30:37<06:32, 39.24s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [31:29<06:26, 42.96s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [32:19<06:02, 45.29s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [33:11<05:31, 47.30s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [34:01<04:48, 48.09s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [34:52<04:04, 48.82s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [35:43<03:18, 49.61s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [36:34<02:29, 49.83s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [37:24<01:40, 50.07s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [38:14<00:49, 49.99s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [39:04<00:00, 50.05s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [39:04<00:00, 46.90s/it]
name: commonsenseqa | {'exact_match': 2.0, 'rougeL': 5.156} | avg. gen lenth: 271.592
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i8-s10-rFalse --seed 10 --max-prompt-length 2048 --num-in-domain 8
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-22 08:16:21,475] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i8-s10-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 8
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i8-s10-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 10
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9733 [00:00<?, ?it/s]  1%|▌                                                     | 91/9733 [00:00<00:10, 901.41it/s]  2%|▉                                                    | 182/9733 [00:00<00:10, 904.34it/s]  3%|█▍                                                   | 273/9733 [00:00<00:10, 901.77it/s]  4%|█▉                                                   | 364/9733 [00:00<00:10, 898.10it/s]  5%|██▍                                                  | 455/9733 [00:00<00:10, 899.70it/s]  6%|██▉                                                  | 546/9733 [00:00<00:10, 902.22it/s]  7%|███▍                                                 | 637/9733 [00:00<00:10, 903.22it/s]  7%|███▉                                                 | 728/9733 [00:00<00:09, 903.43it/s]  8%|████▍                                                | 819/9733 [00:00<00:10, 889.17it/s]  9%|████▉                                                | 909/9733 [00:01<00:09, 891.15it/s] 10%|█████▎                                              | 1000/9733 [00:01<00:09, 896.20it/s] 11%|█████▊                                              | 1092/9733 [00:01<00:09, 900.93it/s] 12%|██████▎                                             | 1183/9733 [00:01<00:09, 901.52it/s] 13%|██████▊                                             | 1274/9733 [00:01<00:09, 884.57it/s] 14%|███████▎                                            | 1365/9733 [00:01<00:09, 889.81it/s] 15%|███████▊                                            | 1456/9733 [00:01<00:09, 895.07it/s] 16%|████████▎                                           | 1547/9733 [00:01<00:09, 898.30it/s] 17%|████████▋                                           | 1637/9733 [00:01<00:09, 898.41it/s] 18%|█████████▏                                          | 1727/9733 [00:01<00:08, 896.90it/s] 19%|█████████▋                                          | 1817/9733 [00:02<00:09, 873.33it/s] 20%|██████████▏                                         | 1908/9733 [00:02<00:08, 881.78it/s] 21%|██████████▋                                         | 1999/9733 [00:02<00:08, 888.66it/s] 22%|███████████▎                                        | 2116/9733 [00:02<00:07, 970.60it/s] 23%|███████████▊                                       | 2255/9733 [00:02<00:06, 1092.97it/s] 25%|████████████▌                                      | 2393/9733 [00:02<00:06, 1177.92it/s] 26%|█████████████▎                                     | 2531/9733 [00:02<00:05, 1235.88it/s] 27%|█████████████▉                                     | 2670/9733 [00:02<00:05, 1280.40it/s] 29%|██████████████▋                                    | 2806/9733 [00:02<00:05, 1302.27it/s] 30%|███████████████▍                                   | 2944/9733 [00:02<00:05, 1323.38it/s] 32%|████████████████▏                                  | 3082/9733 [00:03<00:04, 1338.46it/s] 33%|████████████████▊                                  | 3220/9733 [00:03<00:04, 1348.46it/s] 34%|█████████████████▌                                 | 3356/9733 [00:03<00:04, 1350.11it/s] 36%|██████████████████▎                                | 3493/9733 [00:03<00:04, 1355.64it/s] 37%|███████████████████                                | 3631/9733 [00:03<00:04, 1361.43it/s] 39%|███████████████████▊                               | 3770/9733 [00:03<00:04, 1369.46it/s] 40%|████████████████████▍                              | 3908/9733 [00:03<00:04, 1369.72it/s] 42%|█████████████████████▏                             | 4048/9733 [00:03<00:04, 1375.83it/s] 43%|█████████████████████▉                             | 4186/9733 [00:03<00:04, 1373.12it/s] 44%|██████████████████████▋                            | 4324/9733 [00:03<00:03, 1354.04it/s] 46%|███████████████████████▍                           | 4462/9733 [00:04<00:03, 1360.60it/s] 47%|████████████████████████                           | 4599/9733 [00:04<00:03, 1329.85it/s] 49%|████████████████████████▊                          | 4738/9733 [00:04<00:03, 1345.98it/s] 50%|█████████████████████████▌                         | 4873/9733 [00:04<00:04, 1019.37it/s] 51%|██████████████████████████▏                        | 5009/9733 [00:04<00:04, 1101.17it/s] 53%|██████████████████████████▉                        | 5148/9733 [00:04<00:03, 1173.92it/s] 54%|███████████████████████████▋                       | 5284/9733 [00:04<00:03, 1223.71it/s] 56%|████████████████████████████▍                      | 5421/9733 [00:04<00:03, 1264.13it/s] 57%|█████████████████████████████▏                     | 5563/9733 [00:04<00:03, 1308.06it/s] 59%|█████████████████████████████▉                     | 5706/9733 [00:05<00:03, 1341.87it/s] 60%|██████████████████████████████▋                    | 5849/9733 [00:05<00:02, 1365.85it/s] 62%|███████████████████████████████▍                   | 5992/9733 [00:05<00:02, 1384.22it/s] 63%|████████████████████████████████▏                  | 6135/9733 [00:05<00:02, 1394.94it/s] 65%|████████████████████████████████▉                  | 6278/9733 [00:05<00:02, 1405.23it/s] 66%|█████████████████████████████████▋                 | 6420/9733 [00:05<00:02, 1407.94it/s] 67%|██████████████████████████████████▍                | 6562/9733 [00:05<00:02, 1410.77it/s] 69%|███████████████████████████████████▏               | 6704/9733 [00:05<00:02, 1407.97it/s] 70%|███████████████████████████████████▉               | 6847/9733 [00:05<00:02, 1412.01it/s] 72%|████████████████████████████████████▋              | 6990/9733 [00:05<00:01, 1413.41it/s] 73%|█████████████████████████████████████▍             | 7133/9733 [00:06<00:01, 1417.58it/s] 75%|██████████████████████████████████████             | 7275/9733 [00:06<00:01, 1416.11it/s] 76%|██████████████████████████████████████▊            | 7418/9733 [00:06<00:01, 1418.90it/s] 78%|███████████████████████████████████████▌           | 7560/9733 [00:06<00:01, 1380.72it/s] 79%|████████████████████████████████████████▎          | 7702/9733 [00:06<00:01, 1391.82it/s] 81%|█████████████████████████████████████████          | 7846/9733 [00:06<00:01, 1404.46it/s] 82%|█████████████████████████████████████████▊         | 7989/9733 [00:06<00:01, 1410.85it/s] 84%|██████████████████████████████████████████▌        | 8132/9733 [00:06<00:01, 1415.65it/s] 85%|███████████████████████████████████████████▎       | 8275/9733 [00:06<00:01, 1417.76it/s] 86%|████████████████████████████████████████████       | 8417/9733 [00:06<00:00, 1417.00it/s] 88%|████████████████████████████████████████████▊      | 8559/9733 [00:07<00:00, 1394.01it/s] 89%|█████████████████████████████████████████████▌     | 8701/9733 [00:07<00:00, 1400.49it/s] 91%|██████████████████████████████████████████████▎    | 8843/9733 [00:07<00:00, 1405.53it/s] 92%|███████████████████████████████████████████████    | 8986/9733 [00:07<00:00, 1412.77it/s] 94%|███████████████████████████████████████████████▊   | 9128/9733 [00:07<00:00, 1404.43it/s] 95%|████████████████████████████████████████████████▌  | 9270/9733 [00:07<00:00, 1407.47it/s] 97%|█████████████████████████████████████████████████▎ | 9413/9733 [00:07<00:00, 1412.35it/s] 98%|██████████████████████████████████████████████████ | 9555/9733 [00:07<00:00, 1409.28it/s]100%|██████████████████████████████████████████████████▊| 9696/9733 [00:07<00:00, 1407.73it/s]100%|███████████████████████████████████████████████████| 9733/9733 [00:07<00:00, 1228.36it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:11,  5.99s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:11,  5.86s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:11,  5.90s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:06<00:12,  6.11s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:11<00:05,  5.78s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:11<00:05,  5.79s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:11<00:05,  5.86s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:12<00:06,  6.07s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  5.07s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  5.27s/it]
[2023-08-22 08:17:22,723] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  5.13s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  5.33s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:16<00:00,  5.36s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:16<00:00,  5.56s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:19<00:00,  6.79s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:19<00:00,  6.54s/it]
[2023-08-22 08:17:38,706] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-22 08:17:38,707] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-22 08:17:38,708] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-22 08:17:38,708] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-22 08:17:38,708] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-22 08:17:38,708] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-22 08:17:38,708] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-22 08:17:38,708] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-22 08:17:38,708] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-22 08:17:38,708] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-22 08:17:38,709] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-22 08:17:38,709] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f21ae30a430>
[2023-08-22 08:17:38,709] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-22 08:17:38,709] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-22 08:17:38,709] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-22 08:17:38,709] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-22 08:17:38,709] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-22 08:17:38,709] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-22 08:17:38,709] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-22 08:17:38,709] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-22 08:17:38,709] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-22 08:17:38,709] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-22 08:17:38,709] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-22 08:17:38,709] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-22 08:17:38,709] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-22 08:17:38,709] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-22 08:17:38,709] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-22 08:17:38,709] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-22 08:17:38,709] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-22 08:17:38,709] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-22 08:17:38,709] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-22 08:17:38,709] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-22 08:17:38,709] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-22 08:17:38,709] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-22 08:17:38,709] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-22 08:17:38,709] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-22 08:17:38,709] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-22 08:17:38,709] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-22 08:17:38,709] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-22 08:17:38,709] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-22 08:17:38,709] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-22 08:17:38,709] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-22 08:17:38,709] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-22 08:17:38,709] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-22 08:17:38,709] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f218d0e0220>
[2023-08-22 08:17:38,710] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-22 08:17:38,710] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-22 08:17:38,710] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-22 08:17:38,710] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-22 08:17:38,710] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-22 08:17:38,710] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-22 08:17:38,710] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-22 08:17:38,710] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-22 08:17:38,710] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-22 08:17:38,710] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-22 08:17:38,710] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-22 08:17:38,710] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-22 08:17:38,710] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-22 08:17:38,710] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-22 08:17:38,710] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-22 08:17:38,710] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-22 08:17:38,710] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-22 08:17:38,710] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-22 08:17:38,710] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-22 08:17:38,710] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-22 08:17:38,710] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-22 08:17:38,710] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-22 08:17:38,710] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.4165158271789551 seconds
Time to load utils op: 0.40520572662353516 seconds
Loading extension module utils...
Time to load utils op: 0.40479588508605957 seconds
Loading extension module utils...
Time to load utils op: 0.40465545654296875 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: Fabric is cut to order at what type of seller? Choices:  A: curtains B: tailor shop C: clothing store D: sewing room E: hardware store
Output: B: tailor shop

Input: Where are you if your reading magazines while waiting for a vehicle on rails? Choices:  A: vegetables B: market C: doctor D: train station E: bookstore
Output: D: train station

Input: What would need oil to be used? Choices:  A: ground B: human  body C: repair shop D: combustion engines E: service station
Output: D: combustion engines

Input: What is person probably feeling that plans on stopping being married to their spouse? Choices:  A: detachment B: bankruptcy C: sad D: fights E: wrong
Output: A: detachment

Input: What could you use to store a clock? Choices:  A: shelf B: own bedroom C: desk D: wall E: car
Output: A: shelf

Input: The person put on lotion, what did they want? Choices:  A: fresh smell B: good credit C: smooth skin D: fresh produce E: headache
Output: C: smooth skin

Input: They burned the record, they were trying to do what to history? Choices:  A: compact disc B: tape C: rewrite D: play music E: erase
Output: E: erase

Input: She sure didn't have a green thumb, every time she thought she was making grow something it would what? Choices:  A: growth B: flowering C: ground D: die E: plants
Output: D: die

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i8-s10-rFalse
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:50<41:11, 50.43s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:38<39:24, 49.26s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [02:06<31:00, 39.58s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [02:55<33:03, 43.11s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [03:44<33:53, 45.18s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [04:33<34:06, 46.52s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [05:22<33:53, 47.29s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [06:11<33:32, 47.91s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [07:01<33:06, 48.46s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [07:50<32:24, 48.61s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [08:35<30:52, 47.50s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [09:23<30:16, 47.80s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [10:12<29:44, 48.24s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [11:01<29:03, 48.43s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [11:50<28:22, 48.64s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [12:40<27:43, 48.94s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [13:30<27:04, 49.23s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [14:19<26:16, 49.28s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [15:09<25:31, 49.40s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [15:58<24:39, 49.31s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [16:46<23:41, 49.01s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [17:35<22:52, 49.03s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [18:25<22:05, 49.09s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [19:13<21:10, 48.85s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [20:04<20:33, 49.35s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [20:53<19:45, 49.41s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [21:44<19:04, 49.74s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [22:34<18:16, 49.82s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [23:23<17:21, 49.61s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [24:13<16:34, 49.74s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [25:02<15:43, 49.64s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [25:51<14:49, 49.42s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [26:41<14:01, 49.48s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [27:30<13:13, 49.57s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [28:00<10:54, 43.61s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [28:49<10:32, 45.20s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [29:01<07:39, 35.36s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [29:52<07:57, 39.77s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [30:19<06:36, 36.02s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [31:07<06:35, 39.57s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [31:56<06:21, 42.39s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [32:44<05:54, 44.31s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [33:34<05:21, 45.99s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [34:24<04:43, 47.20s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [35:14<03:59, 47.81s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [35:36<02:40, 40.16s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [36:26<02:09, 43.01s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [37:15<01:29, 45.00s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [38:05<00:46, 46.31s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [38:53<00:00, 47.05s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [38:53<00:00, 46.68s/it]
name: commonsenseqa | {'exact_match': 2.0, 'rougeL': 4.9188} | avg. gen lenth: 289.064
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i9-s10-rFalse --seed 10 --max-prompt-length 2048 --num-in-domain 9
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-22 08:56:40,399] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i9-s10-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 9
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i9-s10-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 10
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9732 [00:00<?, ?it/s]  1%|▍                                                     | 79/9732 [00:00<00:12, 787.77it/s]  2%|▊                                                    | 159/9732 [00:00<00:12, 792.42it/s]  2%|█▎                                                   | 239/9732 [00:00<00:12, 788.12it/s]  3%|█▋                                                   | 319/9732 [00:00<00:11, 790.78it/s]  4%|██▏                                                  | 399/9732 [00:00<00:12, 773.05it/s]  5%|██▌                                                  | 477/9732 [00:00<00:12, 759.06it/s]  6%|███                                                  | 557/9732 [00:00<00:11, 771.01it/s]  7%|███▍                                                 | 635/9732 [00:00<00:11, 766.15it/s]  7%|███▉                                                 | 713/9732 [00:00<00:11, 767.54it/s]  8%|████▎                                                | 793/9732 [00:01<00:11, 776.13it/s]  9%|████▊                                                | 873/9732 [00:01<00:11, 781.66it/s] 10%|█████▏                                               | 952/9732 [00:01<00:11, 783.43it/s] 11%|█████▌                                              | 1032/9732 [00:01<00:11, 788.11it/s] 11%|█████▉                                              | 1112/9732 [00:01<00:10, 789.62it/s] 12%|██████▎                                             | 1191/9732 [00:01<00:10, 783.66it/s] 13%|██████▊                                             | 1270/9732 [00:01<00:10, 776.83it/s] 14%|███████▏                                            | 1349/9732 [00:01<00:10, 780.44it/s] 15%|███████▋                                            | 1428/9732 [00:01<00:10, 778.84it/s] 15%|████████                                            | 1507/9732 [00:01<00:10, 780.65it/s] 16%|████████▍                                           | 1587/9732 [00:02<00:10, 783.50it/s] 17%|████████▉                                           | 1667/9732 [00:02<00:10, 787.90it/s] 18%|█████████▍                                          | 1760/9732 [00:02<00:09, 829.19it/s] 19%|█████████▉                                          | 1870/9732 [00:02<00:08, 908.16it/s] 20%|██████████▋                                         | 1990/9732 [00:02<00:07, 995.10it/s] 22%|███████████                                        | 2109/9732 [00:02<00:07, 1053.21it/s] 23%|███████████▋                                       | 2231/9732 [00:02<00:06, 1100.44it/s] 24%|████████████▎                                      | 2351/9732 [00:02<00:06, 1129.86it/s] 25%|████████████▉                                      | 2473/9732 [00:02<00:06, 1151.75it/s] 27%|█████████████▌                                     | 2594/9732 [00:02<00:06, 1166.65it/s] 28%|██████████████▏                                    | 2713/9732 [00:03<00:05, 1172.69it/s] 29%|██████████████▊                                    | 2833/9732 [00:03<00:05, 1178.88it/s] 30%|███████████████▍                                   | 2953/9732 [00:03<00:05, 1182.42it/s] 32%|████████████████                                   | 3074/9732 [00:03<00:05, 1188.41it/s] 33%|████████████████▋                                  | 3193/9732 [00:03<00:05, 1174.12it/s] 34%|█████████████████▎                                 | 3311/9732 [00:03<00:05, 1165.84it/s] 35%|█████████████████▉                                 | 3430/9732 [00:03<00:05, 1172.90it/s] 36%|██████████████████▌                                | 3550/9732 [00:03<00:05, 1178.43it/s] 38%|███████████████████▏                               | 3669/9732 [00:03<00:05, 1181.77it/s] 39%|███████████████████▊                               | 3790/9732 [00:03<00:04, 1188.80it/s] 40%|████████████████████▍                              | 3910/9732 [00:04<00:04, 1191.53it/s] 41%|█████████████████████                              | 4031/9732 [00:04<00:04, 1195.11it/s] 43%|█████████████████████▊                             | 4151/9732 [00:04<00:04, 1195.43it/s] 44%|██████████████████████▍                            | 4272/9732 [00:04<00:04, 1197.73it/s] 45%|███████████████████████                            | 4392/9732 [00:04<00:04, 1195.76it/s] 46%|███████████████████████▋                           | 4513/9732 [00:04<00:04, 1197.93it/s] 48%|████████████████████████▎                          | 4633/9732 [00:04<00:04, 1162.96it/s] 49%|█████████████████████████▍                          | 4750/9732 [00:04<00:05, 895.40it/s] 50%|██████████████████████████                          | 4869/9732 [00:04<00:05, 966.20it/s] 51%|██████████████████████████▏                        | 4989/9732 [00:05<00:04, 1025.13it/s] 52%|██████████████████████████▊                        | 5109/9732 [00:05<00:04, 1071.97it/s] 54%|███████████████████████████▍                       | 5229/9732 [00:05<00:04, 1105.88it/s] 55%|████████████████████████████                       | 5349/9732 [00:05<00:03, 1131.20it/s] 56%|████████████████████████████▋                      | 5469/9732 [00:05<00:03, 1149.28it/s] 57%|█████████████████████████████▎                     | 5594/9732 [00:05<00:03, 1177.92it/s] 59%|█████████████████████████████▉                     | 5719/9732 [00:05<00:03, 1197.01it/s] 60%|██████████████████████████████▌                    | 5841/9732 [00:05<00:03, 1201.70it/s] 61%|███████████████████████████████▎                   | 5965/9732 [00:05<00:03, 1210.82it/s] 63%|███████████████████████████████▉                   | 6087/9732 [00:05<00:03, 1177.75it/s] 64%|████████████████████████████████▌                  | 6211/9732 [00:06<00:02, 1195.83it/s] 65%|█████████████████████████████████▏                 | 6334/9732 [00:06<00:02, 1205.44it/s] 66%|█████████████████████████████████▊                 | 6459/9732 [00:06<00:02, 1218.03it/s] 68%|██████████████████████████████████▍                | 6583/9732 [00:06<00:02, 1222.16it/s] 69%|███████████████████████████████████▏               | 6707/9732 [00:06<00:02, 1226.52it/s] 70%|███████████████████████████████████▊               | 6832/9732 [00:06<00:02, 1231.66it/s] 71%|████████████████████████████████████▍              | 6957/9732 [00:06<00:02, 1234.21it/s] 73%|█████████████████████████████████████              | 7081/9732 [00:06<00:02, 1234.93it/s] 74%|█████████████████████████████████████▊             | 7206/9732 [00:06<00:02, 1238.29it/s] 75%|██████████████████████████████████████▍            | 7331/9732 [00:06<00:01, 1239.44it/s] 77%|███████████████████████████████████████            | 7455/9732 [00:07<00:01, 1194.53it/s] 78%|███████████████████████████████████████▋           | 7578/9732 [00:07<00:01, 1202.56it/s] 79%|████████████████████████████████████████▎          | 7701/9732 [00:07<00:01, 1208.80it/s] 80%|█████████████████████████████████████████          | 7826/9732 [00:07<00:01, 1219.90it/s] 82%|█████████████████████████████████████████▋         | 7950/9732 [00:07<00:01, 1223.20it/s] 83%|██████████████████████████████████████████▎        | 8075/9732 [00:07<00:01, 1229.58it/s] 84%|██████████████████████████████████████████▉        | 8199/9732 [00:07<00:01, 1221.05it/s] 86%|███████████████████████████████████████████▌       | 8322/9732 [00:07<00:01, 1221.38it/s] 87%|████████████████████████████████████████████▎      | 8446/9732 [00:07<00:01, 1224.30it/s] 88%|████████████████████████████████████████████▉      | 8570/9732 [00:08<00:00, 1228.85it/s] 89%|█████████████████████████████████████████████▌     | 8693/9732 [00:08<00:00, 1226.25it/s] 91%|██████████████████████████████████████████████▏    | 8816/9732 [00:08<00:00, 1226.09it/s] 92%|██████████████████████████████████████████████▊    | 8941/9732 [00:08<00:00, 1231.07it/s] 93%|███████████████████████████████████████████████▌   | 9065/9732 [00:08<00:00, 1210.10it/s] 94%|████████████████████████████████████████████████▏  | 9189/9732 [00:08<00:00, 1218.88it/s] 96%|████████████████████████████████████████████████▊  | 9313/9732 [00:08<00:00, 1222.40it/s] 97%|█████████████████████████████████████████████████▍ | 9437/9732 [00:08<00:00, 1226.02it/s] 98%|██████████████████████████████████████████████████ | 9560/9732 [00:08<00:00, 1226.01it/s]100%|██████████████████████████████████████████████████▋| 9684/9732 [00:08<00:00, 1228.53it/s]100%|███████████████████████████████████████████████████| 9732/9732 [00:08<00:00, 1086.79it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.28s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.33s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.34s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.49s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.18s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.26s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.24s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:11<00:05,  5.54s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.54s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.72s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.62s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.80s/it]
[2023-08-22 08:57:41,260] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.69s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.85s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  4.82s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  5.01s/it]
[2023-08-22 08:57:53,872] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-22 08:57:53,872] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-22 08:57:53,873] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-22 08:57:53,873] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-22 08:57:53,873] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-22 08:57:53,873] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-22 08:57:53,873] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-22 08:57:53,873] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-22 08:57:53,873] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-22 08:57:53,873] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-22 08:57:53,873] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-22 08:57:53,873] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fbd0cd0afd0>
[2023-08-22 08:57:53,873] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-22 08:57:53,873] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-22 08:57:53,873] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-22 08:57:53,873] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7fbce7338220>
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-22 08:57:53,874] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-22 08:57:53,875] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.4137296676635742 seconds
Loading extension module utils...
Time to load utils op: 0.5045478343963623 seconds
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.5048019886016846 seconds
Time to load utils op: 0.4044489860534668 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: Fabric is cut to order at what type of seller? Choices:  A: curtains B: tailor shop C: clothing store D: sewing room E: hardware store
Output: B: tailor shop

Input: Where are you if your reading magazines while waiting for a vehicle on rails? Choices:  A: vegetables B: market C: doctor D: train station E: bookstore
Output: D: train station

Input: What would need oil to be used? Choices:  A: ground B: human  body C: repair shop D: combustion engines E: service station
Output: D: combustion engines

Input: What is person probably feeling that plans on stopping being married to their spouse? Choices:  A: detachment B: bankruptcy C: sad D: fights E: wrong
Output: A: detachment

Input: What could you use to store a clock? Choices:  A: shelf B: own bedroom C: desk D: wall E: car
Output: A: shelf

Input: The person put on lotion, what did they want? Choices:  A: fresh smell B: good credit C: smooth skin D: fresh produce E: headache
Output: C: smooth skin

Input: They burned the record, they were trying to do what to history? Choices:  A: compact disc B: tape C: rewrite D: play music E: erase
Output: E: erase

Input: She sure didn't have a green thumb, every time she thought she was making grow something it would what? Choices:  A: growth B: flowering C: ground D: die E: plants
Output: D: die

Input: After a long night out the drunken man lost consciousness, he showed a sign of sickness right before passing out, what was it? Choices:  A: dream B: vomiting C: panic D: cancer E: blurred vision
Output: B: vomiting

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i9-s10-rFalse
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:17<14:05, 17.25s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:04<28:03, 35.08s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [01:33<25:03, 31.99s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [02:21<29:31, 38.50s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [03:10<31:35, 42.11s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [03:58<32:19, 44.09s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [04:33<29:30, 41.16s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [05:22<30:33, 43.66s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [06:11<31:07, 45.55s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [06:38<26:22, 39.57s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [07:25<27:21, 42.09s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [08:14<27:56, 44.11s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [08:57<27:02, 43.85s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [09:45<26:59, 44.99s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [10:32<26:38, 45.67s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [11:20<26:14, 46.30s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [12:09<25:50, 46.99s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [12:23<19:53, 37.28s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [12:44<16:39, 32.26s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [13:33<18:39, 37.31s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [14:21<19:32, 40.42s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [15:08<19:50, 42.51s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [15:57<19:59, 44.41s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [16:45<19:47, 45.68s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [17:33<19:12, 46.11s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [18:21<18:43, 46.81s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [19:08<17:58, 46.90s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [19:57<17:23, 47.45s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [20:45<16:38, 47.55s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [21:32<15:51, 47.57s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [22:21<15:08, 47.83s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [23:09<14:23, 47.96s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [23:58<13:42, 48.40s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [24:47<12:55, 48.49s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [25:34<12:00, 48.06s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [26:23<11:17, 48.43s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [27:12<10:29, 48.42s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [28:00<09:41, 48.44s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [28:49<08:54, 48.55s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [29:38<08:05, 48.52s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [30:27<07:17, 48.67s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [31:15<06:28, 48.50s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [32:03<05:39, 48.45s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [32:51<04:50, 48.34s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [33:39<04:01, 48.32s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [34:28<03:13, 48.38s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [35:16<02:25, 48.38s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [36:04<01:36, 48.29s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [36:52<00:48, 48.16s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [37:41<00:00, 48.32s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [37:41<00:00, 45.23s/it]
name: commonsenseqa | {'exact_match': 2.0, 'rougeL': 4.5779} | avg. gen lenth: 278.312
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i1-s20-rTrue --seed 20 --max-prompt-length 2048 --rationales --num-in-domain 1
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-22 09:36:59,305] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i1-s20-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 1
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i1-s20-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 20
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9740 [00:00<?, ?it/s]  1%|▋                                                   | 126/9740 [00:00<00:07, 1251.04it/s]  3%|█▎                                                  | 252/9740 [00:00<00:07, 1248.54it/s]  4%|██                                                  | 378/9740 [00:00<00:07, 1252.73it/s]  5%|██▋                                                 | 504/9740 [00:00<00:07, 1254.72it/s]  6%|███▎                                                | 630/9740 [00:00<00:07, 1255.82it/s]  8%|████                                                | 756/9740 [00:00<00:07, 1255.41it/s]  9%|████▋                                               | 883/9740 [00:00<00:07, 1259.96it/s] 10%|█████▎                                             | 1011/9740 [00:00<00:06, 1264.12it/s] 12%|█████▉                                             | 1138/9740 [00:00<00:07, 1207.55it/s] 13%|██████▌                                            | 1265/9740 [00:01<00:06, 1223.46it/s] 14%|███████▎                                           | 1391/9740 [00:01<00:06, 1233.29it/s] 16%|███████▉                                           | 1518/9740 [00:01<00:06, 1243.29it/s] 17%|████████▌                                          | 1643/9740 [00:01<00:06, 1244.53it/s] 18%|█████████▎                                         | 1770/9740 [00:01<00:06, 1251.69it/s] 19%|█████████▉                                         | 1896/9740 [00:01<00:06, 1227.79it/s] 21%|██████████▌                                        | 2022/9740 [00:01<00:06, 1235.44it/s] 22%|███████████▎                                       | 2149/9740 [00:01<00:06, 1242.98it/s] 23%|███████████▉                                       | 2275/9740 [00:01<00:05, 1247.16it/s] 25%|████████████▌                                      | 2400/9740 [00:01<00:05, 1241.67it/s] 26%|█████████████▏                                     | 2525/9740 [00:02<00:05, 1242.65it/s] 27%|█████████████▉                                     | 2651/9740 [00:02<00:05, 1245.72it/s] 29%|██████████████▌                                    | 2776/9740 [00:02<00:05, 1244.66it/s] 30%|███████████████▏                                   | 2902/9740 [00:02<00:05, 1248.29it/s] 31%|███████████████▊                                   | 3027/9740 [00:02<00:05, 1246.04it/s] 32%|████████████████▌                                  | 3152/9740 [00:02<00:05, 1244.66it/s] 34%|█████████████████▏                                 | 3278/9740 [00:02<00:05, 1247.87it/s] 35%|█████████████████▊                                 | 3403/9740 [00:02<00:05, 1248.04it/s] 36%|██████████████████▍                                | 3528/9740 [00:02<00:04, 1247.91it/s] 38%|███████████████████▏                               | 3653/9740 [00:02<00:04, 1247.31it/s] 39%|███████████████████▊                               | 3779/9740 [00:03<00:04, 1249.70it/s] 40%|████████████████████▍                              | 3904/9740 [00:03<00:04, 1249.07it/s] 41%|█████████████████████                              | 4029/9740 [00:03<00:04, 1242.55it/s] 43%|█████████████████████▊                             | 4154/9740 [00:03<00:04, 1242.75it/s] 44%|██████████████████████▍                            | 4280/9740 [00:03<00:04, 1245.68it/s] 45%|███████████████████████                            | 4405/9740 [00:03<00:04, 1244.02it/s] 47%|███████████████████████▋                           | 4530/9740 [00:03<00:04, 1212.38it/s] 48%|████████████████████████▍                          | 4656/9740 [00:03<00:04, 1225.11it/s] 49%|█████████████████████████▌                          | 4779/9740 [00:03<00:05, 927.92it/s] 50%|█████████████████████████▋                         | 4904/9740 [00:04<00:04, 1005.39it/s] 52%|██████████████████████████▎                        | 5029/9740 [00:04<00:04, 1067.07it/s] 53%|██████████████████████████▉                        | 5155/9740 [00:04<00:04, 1118.09it/s] 54%|███████████████████████████▋                       | 5280/9740 [00:04<00:03, 1153.49it/s] 55%|████████████████████████████▎                      | 5400/9740 [00:04<00:03, 1164.16it/s] 57%|████████████████████████████▉                      | 5527/9740 [00:04<00:03, 1193.60it/s] 58%|█████████████████████████████▌                     | 5656/9740 [00:04<00:03, 1221.49it/s] 59%|██████████████████████████████▎                    | 5787/9740 [00:04<00:03, 1245.36it/s] 61%|██████████████████████████████▉                    | 5916/9740 [00:04<00:03, 1256.26it/s] 62%|███████████████████████████████▋                   | 6047/9740 [00:04<00:02, 1272.00it/s] 63%|████████████████████████████████▎                  | 6176/9740 [00:05<00:02, 1276.83it/s] 65%|█████████████████████████████████                  | 6306/9740 [00:05<00:02, 1278.94it/s] 66%|█████████████████████████████████▋                 | 6438/9740 [00:05<00:02, 1288.70it/s] 67%|██████████████████████████████████▍                | 6568/9740 [00:05<00:02, 1291.95it/s] 69%|███████████████████████████████████                | 6699/9740 [00:05<00:02, 1297.28it/s] 70%|███████████████████████████████████▊               | 6829/9740 [00:05<00:02, 1297.78it/s] 71%|████████████████████████████████████▍              | 6960/9740 [00:05<00:02, 1301.11it/s] 73%|█████████████████████████████████████▏             | 7091/9740 [00:05<00:02, 1290.99it/s] 74%|█████████████████████████████████████▊             | 7221/9740 [00:05<00:01, 1288.84it/s] 75%|██████████████████████████████████████▌            | 7353/9740 [00:05<00:01, 1295.61it/s] 77%|███████████████████████████████████████▏           | 7483/9740 [00:06<00:01, 1264.64it/s] 78%|███████████████████████████████████████▊           | 7614/9740 [00:06<00:01, 1276.79it/s] 80%|████████████████████████████████████████▌          | 7744/9740 [00:06<00:01, 1283.08it/s] 81%|█████████████████████████████████████████▏         | 7875/9740 [00:06<00:01, 1289.50it/s] 82%|█████████████████████████████████████████▉         | 8005/9740 [00:06<00:01, 1291.37it/s] 84%|██████████████████████████████████████████▌        | 8135/9740 [00:06<00:01, 1290.46it/s] 85%|███████████████████████████████████████████▎       | 8266/9740 [00:06<00:01, 1296.20it/s] 86%|███████████████████████████████████████████▉       | 8396/9740 [00:06<00:01, 1296.68it/s] 88%|████████████████████████████████████████████▋      | 8527/9740 [00:06<00:00, 1299.27it/s] 89%|█████████████████████████████████████████████▎     | 8657/9740 [00:06<00:00, 1296.05it/s] 90%|██████████████████████████████████████████████     | 8788/9740 [00:07<00:00, 1299.18it/s] 92%|██████████████████████████████████████████████▋    | 8919/9740 [00:07<00:00, 1300.18it/s] 93%|███████████████████████████████████████████████▍   | 9050/9740 [00:07<00:00, 1296.65it/s] 94%|████████████████████████████████████████████████   | 9181/9740 [00:07<00:00, 1300.09it/s] 96%|████████████████████████████████████████████████▊  | 9312/9740 [00:07<00:00, 1293.37it/s] 97%|█████████████████████████████████████████████████▍ | 9443/9740 [00:07<00:00, 1296.40it/s] 98%|██████████████████████████████████████████████████▏| 9573/9740 [00:07<00:00, 1295.80it/s]100%|██████████████████████████████████████████████████▊| 9703/9740 [00:07<00:00, 1297.00it/s]100%|███████████████████████████████████████████████████| 9740/9740 [00:07<00:00, 1246.07it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.41s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:04<00:09,  4.99s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:11,  5.58s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:11,  5.88s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.05s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.49s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:11<00:05,  5.63s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:11<00:05,  5.55s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.37s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.55s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  4.95s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  5.09s/it]
[2023-08-22 09:37:59,777] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  4.96s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  5.13s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  4.95s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  5.14s/it]
[2023-08-22 09:38:13,775] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-22 09:38:13,776] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-22 09:38:13,777] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-22 09:38:13,777] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-22 09:38:13,777] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-22 09:38:13,777] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-22 09:38:13,778] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-22 09:38:13,778] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-22 09:38:13,778] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-22 09:38:13,778] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-22 09:38:13,778] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-22 09:38:13,778] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fb6fe8e4fd0>
[2023-08-22 09:38:13,778] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-22 09:38:13,778] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-22 09:38:13,778] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-22 09:38:13,778] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-22 09:38:13,778] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-22 09:38:13,778] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-22 09:38:13,778] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-22 09:38:13,778] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-22 09:38:13,778] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-22 09:38:13,778] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-22 09:38:13,778] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-22 09:38:13,778] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-22 09:38:13,778] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-22 09:38:13,778] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-22 09:38:13,778] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-22 09:38:13,778] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-22 09:38:13,778] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-22 09:38:13,778] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-22 09:38:13,778] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-22 09:38:13,778] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-22 09:38:13,778] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-22 09:38:13,778] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-22 09:38:13,778] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-22 09:38:13,779] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-22 09:38:13,779] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-22 09:38:13,779] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-22 09:38:13,779] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-22 09:38:13,779] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-22 09:38:13,779] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-22 09:38:13,779] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-22 09:38:13,779] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-22 09:38:13,779] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-22 09:38:13,779] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7fb70717a220>
[2023-08-22 09:38:13,779] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-22 09:38:13,779] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-22 09:38:13,779] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-22 09:38:13,779] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-22 09:38:13,779] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-22 09:38:13,779] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-22 09:38:13,779] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-22 09:38:13,779] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-22 09:38:13,779] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-22 09:38:13,779] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-22 09:38:13,779] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-22 09:38:13,779] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-22 09:38:13,779] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-22 09:38:13,779] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-22 09:38:13,779] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-22 09:38:13,779] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-22 09:38:13,779] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-22 09:38:13,779] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-22 09:38:13,779] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-22 09:38:13,779] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-22 09:38:13,779] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-22 09:38:13,779] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-22 09:38:13,780] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.4645073413848877 seconds
Loading extension module utils...
Time to load utils op: 0.40450096130371094 seconds
Loading extension module utils...
Time to load utils op: 0.30785417556762695 seconds
Loading extension module utils...
Time to load utils op: 0.40461158752441406 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: The machine was very intricate, it was quite an what? Choices:  A: box B: apparatus C: appliance D: wash dishes E: implement
Output: 1. Let's analyze each answer choice in the context of the sentence.
2. The sentence says that the machine was'very intricate'. It means the machine has complex and detailed features.
3. First, see Option A: 'box'. A box is a simple container and it does not convey the intricate mechanisms or complexity of a machine.
4. Option D: 'wash dishes' does not fit the context as it's related to a very specific function and does not effectively describe the complexity of a machine.
5. Option C: 'appliance'. This usually refers to a device, like a refrigerator or a toaster, doing practical work, but the level of intricacy or complexity in the usual sense of the term 'appliance' is not as high as the context demands.
6. Option E: 'implement'. An implement is a tool or instrument, which might be intricate, but this word is typically used for hand-held things and wouldn't usually describe a complex machine.
7. Option B: 'apparatus'. An apparatus is often used to refer to a complex instrument or machine with a particular purpose. 
8. Therefore, considering all the option meanings and their contextual relevance, we can conclude that the best choice to complete the sentence is B: 'apparatus' as it signifies the necessary complexity and intricacy the sentence demands.
So the final answer is B: apparatus

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i1-s20-rTrue
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:50<40:55, 50.11s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:39<39:40, 49.60s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [02:28<38:48, 49.55s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [03:17<37:52, 49.39s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [04:07<36:58, 49.30s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [04:56<36:04, 49.20s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [05:45<35:17, 49.25s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [06:35<34:34, 49.39s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [07:23<33:36, 49.19s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [08:14<32:59, 49.49s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [09:03<32:13, 49.57s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [09:52<31:17, 49.39s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [10:25<27:21, 44.36s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [11:15<27:33, 45.93s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [12:03<27:16, 46.77s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [12:54<27:10, 47.96s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [13:43<26:33, 48.28s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [14:33<25:58, 48.69s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [15:22<25:12, 48.80s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [16:12<24:33, 49.11s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [17:02<23:53, 49.42s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [17:51<22:57, 49.21s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [18:39<22:06, 49.12s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [19:28<21:15, 49.07s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [20:17<20:25, 49.02s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [21:07<19:38, 49.12s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [21:56<18:48, 49.07s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [22:45<18:01, 49.18s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [23:34<17:09, 49.03s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [23:57<13:48, 41.43s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [24:47<13:54, 43.91s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [25:36<13:36, 45.38s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [26:25<13:12, 46.62s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [27:15<12:38, 47.41s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [28:04<12:00, 48.06s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [28:53<11:15, 48.23s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [29:43<10:35, 48.87s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [30:32<09:46, 48.91s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [31:22<09:00, 49.16s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [32:12<08:15, 49.50s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [33:05<07:33, 50.35s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [33:54<06:39, 50.00s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [34:43<05:49, 49.87s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [35:32<04:57, 49.53s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [36:21<04:06, 49.36s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [37:10<03:17, 49.34s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [37:59<02:27, 49.26s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [38:48<01:38, 49.12s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [39:37<00:49, 49.08s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [40:28<00:00, 49.49s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [40:28<00:00, 48.56s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 1.9137} | avg. gen lenth: 385.248
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i2-s20-rTrue --seed 20 --max-prompt-length 2048 --rationales --num-in-domain 2
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-22 10:19:18,331] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i2-s20-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 2
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i2-s20-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 20
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9739 [00:00<?, ?it/s]  1%|▎                                                     | 52/9739 [00:00<00:18, 512.30it/s]  1%|▌                                                    | 104/9739 [00:00<00:18, 514.72it/s]  2%|▊                                                    | 156/9739 [00:00<00:18, 515.64it/s]  2%|█▏                                                   | 208/9739 [00:00<00:18, 513.19it/s]  3%|█▍                                                   | 260/9739 [00:00<00:18, 514.23it/s]  3%|█▋                                                   | 312/9739 [00:00<00:18, 515.34it/s]  4%|█▉                                                   | 364/9739 [00:00<00:18, 515.21it/s]  4%|██▎                                                  | 416/9739 [00:00<00:18, 507.11it/s]  5%|██▌                                                  | 467/9739 [00:00<00:18, 504.75it/s]  5%|██▊                                                  | 519/9739 [00:01<00:18, 507.97it/s]  6%|███                                                  | 571/9739 [00:01<00:17, 509.37it/s]  6%|███▍                                                 | 623/9739 [00:01<00:17, 511.11it/s]  7%|███▋                                                 | 675/9739 [00:01<00:17, 510.69it/s]  7%|███▉                                                 | 727/9739 [00:01<00:17, 511.94it/s]  8%|████▏                                                | 779/9739 [00:01<00:17, 507.60it/s]  9%|████▌                                                | 831/9739 [00:01<00:17, 510.22it/s]  9%|████▊                                                | 883/9739 [00:01<00:17, 510.66it/s] 10%|█████                                                | 935/9739 [00:01<00:17, 507.91it/s] 10%|█████▎                                               | 987/9739 [00:01<00:17, 509.47it/s] 11%|█████▌                                              | 1039/9739 [00:02<00:17, 511.38it/s] 11%|█████▊                                              | 1091/9739 [00:02<00:16, 513.06it/s] 12%|██████                                              | 1143/9739 [00:02<00:16, 512.11it/s] 12%|██████▍                                             | 1195/9739 [00:02<00:16, 512.71it/s] 13%|██████▋                                             | 1247/9739 [00:02<00:16, 512.99it/s] 13%|██████▉                                             | 1299/9739 [00:02<00:16, 513.72it/s] 14%|███████▏                                            | 1351/9739 [00:02<00:16, 512.25it/s] 14%|███████▍                                            | 1403/9739 [00:02<00:16, 512.77it/s] 15%|███████▊                                            | 1455/9739 [00:02<00:16, 513.12it/s] 15%|████████                                            | 1507/9739 [00:02<00:16, 513.12it/s] 16%|████████▎                                           | 1559/9739 [00:03<00:15, 514.18it/s] 17%|████████▌                                           | 1611/9739 [00:03<00:15, 508.69it/s] 17%|████████▉                                           | 1663/9739 [00:03<00:15, 510.98it/s] 18%|█████████▏                                          | 1715/9739 [00:03<00:15, 512.19it/s] 18%|█████████▌                                          | 1783/9739 [00:03<00:14, 560.33it/s] 19%|█████████▉                                          | 1853/9739 [00:03<00:13, 600.00it/s] 20%|██████████▎                                         | 1932/9739 [00:03<00:11, 654.87it/s] 21%|██████████▋                                         | 2011/9739 [00:03<00:11, 694.00it/s] 21%|███████████▏                                        | 2089/9739 [00:03<00:10, 717.83it/s] 22%|███████████▌                                        | 2168/9739 [00:03<00:10, 737.47it/s] 23%|███████████▉                                        | 2246/9739 [00:04<00:09, 749.31it/s] 24%|████████████▍                                       | 2325/9739 [00:04<00:09, 759.87it/s] 25%|████████████▊                                       | 2404/9739 [00:04<00:09, 767.45it/s] 25%|█████████████▎                                      | 2482/9739 [00:04<00:09, 770.74it/s] 26%|█████████████▋                                      | 2560/9739 [00:04<00:09, 766.50it/s] 27%|██████████████                                      | 2639/9739 [00:04<00:09, 771.95it/s] 28%|██████████████▌                                     | 2717/9739 [00:04<00:09, 772.52it/s] 29%|██████████████▉                                     | 2796/9739 [00:04<00:08, 775.12it/s] 30%|███████████████▎                                    | 2875/9739 [00:04<00:08, 777.90it/s] 30%|███████████████▊                                    | 2953/9739 [00:04<00:08, 777.66it/s] 31%|████████████████▏                                   | 3032/9739 [00:05<00:08, 780.22it/s] 32%|████████████████▌                                   | 3111/9739 [00:05<00:08, 781.06it/s] 33%|█████████████████                                   | 3190/9739 [00:05<00:08, 780.23it/s] 34%|█████████████████▍                                  | 3269/9739 [00:05<00:08, 781.97it/s] 34%|█████████████████▉                                  | 3348/9739 [00:05<00:08, 781.92it/s] 35%|██████████████████▎                                 | 3427/9739 [00:05<00:08, 779.60it/s] 36%|██████████████████▋                                 | 3506/9739 [00:05<00:07, 780.06it/s] 37%|███████████████████▏                                | 3585/9739 [00:05<00:07, 779.40it/s] 38%|███████████████████▌                                | 3663/9739 [00:05<00:07, 777.97it/s] 38%|███████████████████▉                                | 3742/9739 [00:05<00:07, 780.28it/s] 39%|████████████████████▍                               | 3821/9739 [00:06<00:07, 781.10it/s] 40%|████████████████████▊                               | 3900/9739 [00:06<00:07, 780.00it/s] 41%|█████████████████████▏                              | 3979/9739 [00:06<00:07, 780.83it/s] 42%|█████████████████████▋                              | 4058/9739 [00:06<00:07, 781.53it/s] 42%|██████████████████████                              | 4137/9739 [00:06<00:07, 779.89it/s] 43%|██████████████████████▌                             | 4216/9739 [00:06<00:07, 780.41it/s] 44%|██████████████████████▉                             | 4295/9739 [00:06<00:06, 779.01it/s] 45%|███████████████████████▎                            | 4374/9739 [00:06<00:06, 779.93it/s] 46%|███████████████████████▊                            | 4453/9739 [00:06<00:06, 780.91it/s] 47%|████████████████████████▏                           | 4532/9739 [00:07<00:07, 743.53it/s] 47%|████████████████████████▌                           | 4611/9739 [00:07<00:06, 755.61it/s] 48%|█████████████████████████                           | 4690/9739 [00:07<00:06, 763.86it/s] 49%|█████████████████████████▍                          | 4767/9739 [00:07<00:08, 561.89it/s] 50%|█████████████████████████▊                          | 4845/9739 [00:07<00:07, 613.07it/s] 51%|██████████████████████████▎                         | 4923/9739 [00:07<00:07, 653.79it/s] 51%|██████████████████████████▋                         | 5001/9739 [00:07<00:06, 686.45it/s] 52%|███████████████████████████                         | 5080/9739 [00:07<00:06, 712.99it/s] 53%|███████████████████████████▌                        | 5159/9739 [00:07<00:06, 733.01it/s] 54%|███████████████████████████▉                        | 5237/9739 [00:08<00:06, 745.06it/s] 55%|████████████████████████████▍                       | 5316/9739 [00:08<00:05, 755.95it/s] 55%|████████████████████████████▊                       | 5395/9739 [00:08<00:05, 763.65it/s] 56%|█████████████████████████████▏                      | 5473/9739 [00:08<00:05, 767.57it/s] 57%|█████████████████████████████▋                      | 5555/9739 [00:08<00:05, 781.97it/s] 58%|██████████████████████████████                      | 5636/9739 [00:08<00:05, 789.51it/s] 59%|██████████████████████████████▌                     | 5719/9739 [00:08<00:05, 798.67it/s] 60%|██████████████████████████████▉                     | 5801/9739 [00:08<00:04, 803.98it/s] 60%|███████████████████████████████▍                    | 5882/9739 [00:08<00:04, 805.07it/s] 61%|███████████████████████████████▊                    | 5964/9739 [00:08<00:04, 809.28it/s] 62%|████████████████████████████████▎                   | 6046/9739 [00:09<00:04, 811.07it/s] 63%|████████████████████████████████▋                   | 6128/9739 [00:09<00:04, 806.28it/s] 64%|█████████████████████████████████▏                  | 6210/9739 [00:09<00:04, 809.24it/s] 65%|█████████████████████████████████▌                  | 6292/9739 [00:09<00:04, 810.61it/s] 65%|██████████████████████████████████                  | 6374/9739 [00:09<00:04, 809.71it/s] 66%|██████████████████████████████████▍                 | 6456/9739 [00:09<00:04, 811.63it/s] 67%|██████████████████████████████████▉                 | 6538/9739 [00:09<00:03, 809.27it/s] 68%|███████████████████████████████████▎                | 6620/9739 [00:09<00:03, 810.87it/s] 69%|███████████████████████████████████▊                | 6702/9739 [00:09<00:03, 812.80it/s] 70%|████████████████████████████████████▏               | 6784/9739 [00:09<00:03, 812.79it/s] 71%|████████████████████████████████████▋               | 6866/9739 [00:10<00:03, 813.21it/s] 71%|█████████████████████████████████████               | 6949/9739 [00:10<00:03, 815.38it/s] 72%|█████████████████████████████████████▌              | 7031/9739 [00:10<00:03, 813.47it/s] 73%|█████████████████████████████████████▉              | 7113/9739 [00:10<00:03, 815.37it/s] 74%|██████████████████████████████████████▍             | 7195/9739 [00:10<00:03, 816.34it/s] 75%|██████████████████████████████████████▊             | 7277/9739 [00:10<00:03, 814.12it/s] 76%|███████████████████████████████████████▎            | 7359/9739 [00:10<00:02, 815.82it/s] 76%|███████████████████████████████████████▋            | 7441/9739 [00:10<00:02, 788.02it/s] 77%|████████████████████████████████████████▏           | 7523/9739 [00:10<00:02, 795.65it/s] 78%|████████████████████████████████████████▌           | 7605/9739 [00:10<00:02, 802.23it/s] 79%|█████████████████████████████████████████           | 7686/9739 [00:11<00:02, 803.86it/s] 80%|█████████████████████████████████████████▍          | 7769/9739 [00:11<00:02, 808.77it/s] 81%|█████████████████████████████████████████▉          | 7851/9739 [00:11<00:02, 811.01it/s] 81%|██████████████████████████████████████████▎         | 7933/9739 [00:11<00:02, 810.65it/s] 82%|██████████████████████████████████████████▊         | 8015/9739 [00:11<00:02, 813.06it/s] 83%|███████████████████████████████████████████▏        | 8097/9739 [00:11<00:02, 814.23it/s] 84%|███████████████████████████████████████████▋        | 8179/9739 [00:11<00:01, 810.82it/s] 85%|████████████████████████████████████████████        | 8261/9739 [00:11<00:01, 813.03it/s] 86%|████████████████████████████████████████████▌       | 8343/9739 [00:11<00:01, 813.43it/s] 87%|████████████████████████████████████████████▉       | 8425/9739 [00:11<00:01, 812.11it/s] 87%|█████████████████████████████████████████████▍      | 8507/9739 [00:12<00:01, 813.77it/s] 88%|█████████████████████████████████████████████▊      | 8589/9739 [00:12<00:01, 811.48it/s] 89%|██████████████████████████████████████████████▎     | 8671/9739 [00:12<00:01, 812.36it/s] 90%|██████████████████████████████████████████████▋     | 8753/9739 [00:12<00:01, 813.35it/s] 91%|███████████████████████████████████████████████▏    | 8835/9739 [00:12<00:01, 811.38it/s] 92%|███████████████████████████████████████████████▌    | 8917/9739 [00:12<00:01, 806.80it/s] 92%|████████████████████████████████████████████████    | 8999/9739 [00:12<00:00, 809.36it/s] 93%|████████████████████████████████████████████████▍   | 9080/9739 [00:12<00:00, 808.45it/s] 94%|████████████████████████████████████████████████▉   | 9162/9739 [00:12<00:00, 810.25it/s] 95%|█████████████████████████████████████████████████▎  | 9244/9739 [00:12<00:00, 811.54it/s] 96%|█████████████████████████████████████████████████▊  | 9326/9739 [00:13<00:00, 809.36it/s] 97%|██████████████████████████████████████████████████▏ | 9408/9739 [00:13<00:00, 810.49it/s] 97%|██████████████████████████████████████████████████▋ | 9490/9739 [00:13<00:00, 808.16it/s] 98%|███████████████████████████████████████████████████ | 9572/9739 [00:13<00:00, 809.66it/s] 99%|███████████████████████████████████████████████████▌| 9653/9739 [00:13<00:00, 809.24it/s]100%|███████████████████████████████████████████████████▉| 9734/9739 [00:13<00:00, 805.89it/s]100%|████████████████████████████████████████████████████| 9739/9739 [00:13<00:00, 716.03it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.44s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:11,  5.68s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:11,  5.52s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:11,  5.57s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:11<00:05,  5.60s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.47s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:11<00:05,  5.66s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.47s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.81s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  5.00s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  4.98s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  5.15s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  5.08s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  5.21s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  4.93s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  5.09s/it]
[2023-08-22 10:20:24,617] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
[2023-08-22 10:20:38,419] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-22 10:20:38,422] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-22 10:20:38,423] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-22 10:20:38,423] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-22 10:20:38,424] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-22 10:20:38,424] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-22 10:20:38,425] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-22 10:20:38,425] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-22 10:20:38,425] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-22 10:20:38,425] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-22 10:20:38,425] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-22 10:20:38,425] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fa42e6e7fd0>
[2023-08-22 10:20:38,425] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-22 10:20:38,425] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-22 10:20:38,425] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-22 10:20:38,425] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-22 10:20:38,425] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-22 10:20:38,425] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-22 10:20:38,425] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-22 10:20:38,425] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-22 10:20:38,425] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-22 10:20:38,425] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-22 10:20:38,425] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-22 10:20:38,425] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-22 10:20:38,425] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-22 10:20:38,425] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-22 10:20:38,425] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-22 10:20:38,425] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-22 10:20:38,425] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-22 10:20:38,425] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-22 10:20:38,425] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-22 10:20:38,426] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-22 10:20:38,426] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-22 10:20:38,426] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-22 10:20:38,426] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-22 10:20:38,426] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-22 10:20:38,426] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-22 10:20:38,426] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-22 10:20:38,426] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-22 10:20:38,426] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-22 10:20:38,426] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-22 10:20:38,426] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-22 10:20:38,426] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-22 10:20:38,426] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-22 10:20:38,426] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7fa42e638220>
[2023-08-22 10:20:38,426] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-22 10:20:38,426] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-22 10:20:38,426] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-22 10:20:38,426] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-22 10:20:38,426] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-22 10:20:38,426] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-22 10:20:38,426] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-22 10:20:38,426] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-22 10:20:38,426] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-22 10:20:38,426] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-22 10:20:38,426] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-22 10:20:38,426] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-22 10:20:38,426] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-22 10:20:38,426] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-22 10:20:38,426] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-22 10:20:38,426] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-22 10:20:38,426] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-22 10:20:38,426] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-22 10:20:38,426] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-22 10:20:38,427] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-22 10:20:38,427] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-22 10:20:38,427] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-22 10:20:38,427] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.45183491706848145 seconds
Loading extension module utils...
Time to load utils op: 0.5048167705535889 seconds
Loading extension module utils...
Time to load utils op: 0.5053484439849854 seconds
Loading extension module utils...
Time to load utils op: 0.3046913146972656 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: The machine was very intricate, it was quite an what? Choices:  A: box B: apparatus C: appliance D: wash dishes E: implement
Output: 1. The key to answering this question correctly is understanding the context and meaning of the question. The sentence is describing a machine that is said to be very intricate.
2. "Intricate" means that something is complicated or detailed. So, the word that follows should reasonably describe a detailed or complex machine.
3. We can now evaluate each of the multiple-choice options in light of this reasoning. In this case, the options are A: box, B: apparatus, C: appliance, D: wash dishes, and E: implement.
4. Option A, box, is unlikely because a box is a simple, generally not intricate item.
5. Option C, appliance, generally refers to devices for particular uses in the home, like a dishwasher. However, appliances aren't necessarily intricate or complex.
6. Option D, wash dishes, is not correct because it is not a noun but a verb phrase and doesn't follow grammatically after "an."
7. Option E, implement, usually refers to a tool or piece of equipment, but doesn't inherently suggest something intricate.
8. This leaves us with option B: apparatus, which is a technical term for a complex device or piece of equipment. It fits best with the description of the machine being intricate.

Therefore, the correct answer is B: apparatus.
So the final answer is B: apparatus

Input: Where do you get petrol? Choices:  A: burn hot B: fuel tank C: burn hot D: car E: gas station
Output: Step 1: Identify the question and understand what it's asking. The question is "Where do you get petrol?"
Step 2: Consider the context of the question. It's asking for a location, so we can exclude any answers that are not places.
Step 3: Eliminate answer choice A (burn hot) because it isn't a place where you can get petrol
Step 4: Eliminate answer choice B (fuel tank) because while petrol can be stored there, it's not the place where you obtain it from.
Step 5: Eliminate answer choice C (burn hot) again because it isn't a place where you can get petrol.
Step 6: Eliminate answer choice D (car) because similar to a fuel tank, a car may store petrol but it's not the place where you get it from.
Step 7: By process of elimination, you're left with answer E (gas station) which is indeed a place where you can get petrol. 
Step 8: So, the answer is E: gas station.
So the final answer is E: gas station

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i2-s20-rTrue
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:46<37:54, 46.42s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:31<36:31, 45.66s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [02:16<35:26, 45.25s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [03:01<34:33, 45.08s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [03:46<33:48, 45.09s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [04:34<33:55, 46.26s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [05:22<33:36, 46.89s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [06:16<34:12, 48.88s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [07:01<32:45, 47.95s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [07:47<31:24, 47.12s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [08:32<30:17, 46.60s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [09:18<29:21, 46.35s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [10:03<28:21, 45.98s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [10:49<27:29, 45.81s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [11:34<26:36, 45.60s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [12:19<25:46, 45.50s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [13:04<25:01, 45.50s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [13:50<24:15, 45.47s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [14:35<23:26, 45.38s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [15:20<22:37, 45.24s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [16:05<21:51, 45.23s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [16:50<21:05, 45.18s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [17:36<20:21, 45.25s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [18:21<19:40, 45.42s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [19:08<19:03, 45.72s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [19:53<18:11, 45.49s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [20:38<17:24, 45.39s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [21:23<16:34, 45.20s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [22:08<15:52, 45.37s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [22:54<15:07, 45.36s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [23:39<14:20, 45.30s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [24:24<13:36, 45.34s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [25:09<12:49, 45.26s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [25:54<12:02, 45.13s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [26:40<11:18, 45.21s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [27:25<10:35, 45.38s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [28:11<09:49, 45.36s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [28:56<09:03, 45.32s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [29:41<08:18, 45.35s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [30:27<07:33, 45.37s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [31:12<06:47, 45.29s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [31:58<06:03, 45.44s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [32:43<05:17, 45.39s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [33:29<04:34, 45.67s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [34:15<03:47, 45.55s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [35:00<03:01, 45.39s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [35:45<02:16, 45.37s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [36:30<01:30, 45.30s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [37:16<00:45, 45.38s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [38:00<00:00, 45.21s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [38:00<00:00, 45.62s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 1.9759} | avg. gen lenth: 387.96
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i3-s20-rTrue --seed 20 --max-prompt-length 2048 --rationales --num-in-domain 3
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date![nltk_data]   Package punkt is already up-to-date!

using world size: 4
[2023-08-22 10:58:57,034] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i3-s20-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 3
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i3-s20-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 20
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9738 [00:00<?, ?it/s]  0%|▏                                                     | 41/9738 [00:00<00:24, 401.24it/s]  1%|▍                                                     | 82/9738 [00:00<00:23, 402.36it/s]  1%|▋                                                    | 123/9738 [00:00<00:23, 403.64it/s]  2%|▉                                                    | 164/9738 [00:00<00:23, 403.83it/s]  2%|█                                                    | 205/9738 [00:00<00:23, 401.22it/s]  3%|█▎                                                   | 246/9738 [00:00<00:23, 402.18it/s]  3%|█▌                                                   | 287/9738 [00:00<00:23, 402.83it/s]  3%|█▊                                                   | 328/9738 [00:00<00:23, 397.31it/s]  4%|██                                                   | 369/9738 [00:00<00:23, 398.28it/s]  4%|██▏                                                  | 410/9738 [00:01<00:23, 399.77it/s]  5%|██▍                                                  | 450/9738 [00:01<00:23, 397.90it/s]  5%|██▋                                                  | 491/9738 [00:01<00:23, 401.17it/s]  6%|███                                                  | 552/9738 [00:01<00:19, 463.26it/s]  6%|███▎                                                 | 613/9738 [00:01<00:18, 506.04it/s]  7%|███▋                                                 | 673/9738 [00:01<00:16, 533.71it/s]  8%|███▉                                                 | 734/9738 [00:01<00:16, 555.81it/s]  8%|████▎                                                | 795/9738 [00:01<00:15, 571.67it/s]  9%|████▋                                                | 855/9738 [00:01<00:15, 580.02it/s]  9%|████▉                                                | 916/9738 [00:01<00:15, 586.19it/s] 10%|█████▎                                               | 977/9738 [00:02<00:14, 592.45it/s] 11%|█████▌                                              | 1038/9738 [00:02<00:14, 597.36it/s] 11%|█████▊                                              | 1099/9738 [00:02<00:14, 600.64it/s] 12%|██████▏                                             | 1160/9738 [00:02<00:14, 598.87it/s] 13%|██████▌                                             | 1221/9738 [00:02<00:14, 599.91it/s] 13%|██████▊                                             | 1282/9738 [00:02<00:14, 601.42it/s] 14%|███████▏                                            | 1343/9738 [00:02<00:13, 600.62it/s] 14%|███████▍                                            | 1404/9738 [00:02<00:13, 602.76it/s] 15%|███████▊                                            | 1465/9738 [00:02<00:13, 604.82it/s] 16%|████████▏                                           | 1526/9738 [00:02<00:13, 605.44it/s] 16%|████████▍                                           | 1587/9738 [00:03<00:13, 602.98it/s] 17%|████████▊                                           | 1648/9738 [00:03<00:13, 601.70it/s] 18%|█████████▏                                          | 1709/9738 [00:03<00:13, 603.63it/s] 18%|█████████▍                                          | 1770/9738 [00:03<00:13, 604.86it/s] 19%|█████████▊                                          | 1831/9738 [00:03<00:13, 582.27it/s] 19%|██████████                                          | 1892/9738 [00:03<00:13, 589.82it/s] 20%|██████████▍                                         | 1953/9738 [00:03<00:13, 595.04it/s] 21%|██████████▊                                         | 2014/9738 [00:03<00:12, 598.70it/s] 21%|███████████                                         | 2074/9738 [00:03<00:12, 598.00it/s] 22%|███████████▍                                        | 2135/9738 [00:03<00:12, 600.44it/s] 23%|███████████▋                                        | 2196/9738 [00:04<00:12, 601.52it/s] 23%|████████████                                        | 2257/9738 [00:04<00:12, 600.89it/s] 24%|████████████▍                                       | 2318/9738 [00:04<00:12, 602.85it/s] 24%|████████████▋                                       | 2379/9738 [00:04<00:12, 604.09it/s] 25%|█████████████                                       | 2440/9738 [00:04<00:12, 600.11it/s] 26%|█████████████▎                                      | 2501/9738 [00:04<00:12, 597.71it/s] 26%|█████████████▋                                      | 2562/9738 [00:04<00:11, 600.09it/s] 27%|██████████████                                      | 2623/9738 [00:04<00:11, 602.58it/s] 28%|██████████████▎                                     | 2684/9738 [00:04<00:11, 602.94it/s] 28%|██████████████▋                                     | 2745/9738 [00:04<00:11, 601.99it/s] 29%|██████████████▉                                     | 2806/9738 [00:05<00:11, 602.11it/s] 29%|███████████████▎                                    | 2867/9738 [00:05<00:11, 603.56it/s] 30%|███████████████▋                                    | 2928/9738 [00:05<00:11, 602.29it/s] 31%|███████████████▉                                    | 2989/9738 [00:05<00:11, 603.11it/s] 31%|████████████████▎                                   | 3050/9738 [00:05<00:11, 603.93it/s] 32%|████████████████▌                                   | 3111/9738 [00:05<00:10, 604.27it/s] 33%|████████████████▉                                   | 3172/9738 [00:05<00:10, 602.91it/s] 33%|█████████████████▎                                  | 3233/9738 [00:05<00:10, 599.57it/s] 34%|█████████████████▌                                  | 3294/9738 [00:05<00:10, 601.16it/s] 34%|█████████████████▉                                  | 3355/9738 [00:05<00:10, 602.32it/s] 35%|██████████████████▏                                 | 3416/9738 [00:06<00:10, 601.67it/s] 36%|██████████████████▌                                 | 3477/9738 [00:06<00:10, 603.31it/s] 36%|██████████████████▉                                 | 3538/9738 [00:06<00:10, 603.72it/s] 37%|███████████████████▏                                | 3599/9738 [00:06<00:10, 604.53it/s] 38%|███████████████████▌                                | 3660/9738 [00:06<00:10, 602.20it/s] 38%|███████████████████▊                                | 3721/9738 [00:06<00:09, 602.90it/s] 39%|████████████████████▏                               | 3782/9738 [00:06<00:09, 603.93it/s] 39%|████████████████████▌                               | 3843/9738 [00:06<00:09, 602.04it/s] 40%|████████████████████▊                               | 3904/9738 [00:06<00:09, 601.12it/s] 41%|█████████████████████▏                              | 3965/9738 [00:06<00:09, 601.03it/s] 41%|█████████████████████▍                              | 4026/9738 [00:07<00:09, 602.66it/s] 42%|█████████████████████▊                              | 4087/9738 [00:07<00:09, 600.70it/s] 43%|██████████████████████▏                             | 4148/9738 [00:07<00:09, 601.39it/s] 43%|██████████████████████▍                             | 4209/9738 [00:07<00:09, 602.77it/s] 44%|██████████████████████▊                             | 4270/9738 [00:07<00:09, 601.87it/s] 44%|███████████████████████▏                            | 4331/9738 [00:07<00:09, 600.63it/s] 45%|███████████████████████▍                            | 4392/9738 [00:07<00:08, 602.45it/s] 46%|███████████████████████▊                            | 4453/9738 [00:07<00:08, 603.50it/s] 46%|████████████████████████                            | 4514/9738 [00:07<00:09, 571.60it/s] 47%|████████████████████████▍                           | 4574/9738 [00:08<00:08, 579.39it/s] 48%|████████████████████████▊                           | 4635/9738 [00:08<00:08, 586.82it/s] 48%|█████████████████████████                           | 4696/9738 [00:08<00:08, 592.74it/s] 49%|█████████████████████████▍                          | 4756/9738 [00:08<00:10, 469.65it/s] 49%|█████████████████████████▋                          | 4817/9738 [00:08<00:09, 503.58it/s] 50%|██████████████████████████                          | 4877/9738 [00:08<00:09, 528.11it/s] 51%|██████████████████████████▎                         | 4938/9738 [00:08<00:08, 548.37it/s] 51%|██████████████████████████▋                         | 4998/9738 [00:08<00:08, 561.45it/s] 52%|███████████████████████████                         | 5059/9738 [00:08<00:08, 573.62it/s] 53%|███████████████████████████▎                        | 5119/9738 [00:09<00:07, 580.93it/s] 53%|███████████████████████████▋                        | 5178/9738 [00:09<00:07, 583.49it/s] 54%|███████████████████████████▉                        | 5239/9738 [00:09<00:07, 588.89it/s] 54%|████████████████████████████▎                       | 5300/9738 [00:09<00:07, 593.77it/s] 55%|████████████████████████████▋                       | 5361/9738 [00:09<00:07, 596.57it/s] 56%|████████████████████████████▉                       | 5421/9738 [00:09<00:07, 596.50it/s] 56%|█████████████████████████████▎                      | 5482/9738 [00:09<00:07, 600.17it/s] 57%|█████████████████████████████▌                      | 5545/9738 [00:09<00:06, 608.28it/s] 58%|█████████████████████████████▉                      | 5608/9738 [00:09<00:06, 613.09it/s] 58%|██████████████████████████████▎                     | 5670/9738 [00:09<00:06, 614.39it/s] 59%|██████████████████████████████▌                     | 5733/9738 [00:10<00:06, 617.46it/s] 60%|██████████████████████████████▉                     | 5796/9738 [00:10<00:06, 619.27it/s] 60%|███████████████████████████████▎                    | 5858/9738 [00:10<00:06, 616.76it/s] 61%|███████████████████████████████▌                    | 5921/9738 [00:10<00:06, 618.96it/s] 61%|███████████████████████████████▉                    | 5984/9738 [00:10<00:06, 621.65it/s] 62%|████████████████████████████████▎                   | 6047/9738 [00:10<00:05, 622.58it/s] 63%|████████████████████████████████▋                   | 6110/9738 [00:10<00:05, 620.32it/s] 63%|████████████████████████████████▉                   | 6173/9738 [00:10<00:05, 621.05it/s] 64%|█████████████████████████████████▎                  | 6236/9738 [00:10<00:05, 621.23it/s] 65%|█████████████████████████████████▋                  | 6299/9738 [00:10<00:05, 622.05it/s] 65%|█████████████████████████████████▉                  | 6362/9738 [00:11<00:05, 620.47it/s] 66%|██████████████████████████████████▎                 | 6425/9738 [00:11<00:05, 621.83it/s] 67%|██████████████████████████████████▋                 | 6488/9738 [00:11<00:05, 622.22it/s] 67%|██████████████████████████████████▉                 | 6551/9738 [00:11<00:05, 619.58it/s] 68%|███████████████████████████████████▎                | 6614/9738 [00:11<00:05, 620.31it/s] 69%|███████████████████████████████████▋                | 6677/9738 [00:11<00:04, 621.35it/s] 69%|███████████████████████████████████▉                | 6740/9738 [00:11<00:04, 622.07it/s] 70%|████████████████████████████████████▎               | 6803/9738 [00:11<00:04, 621.09it/s] 71%|████████████████████████████████████▋               | 6866/9738 [00:11<00:04, 621.70it/s] 71%|█████████████████████████████████████               | 6929/9738 [00:11<00:04, 622.39it/s] 72%|█████████████████████████████████████▎              | 6992/9738 [00:12<00:04, 620.33it/s] 72%|█████████████████████████████████████▋              | 7055/9738 [00:12<00:04, 621.05it/s] 73%|██████████████████████████████████████              | 7118/9738 [00:12<00:04, 621.82it/s] 74%|██████████████████████████████████████▎             | 7181/9738 [00:12<00:04, 622.72it/s] 74%|██████████████████████████████████████▋             | 7244/9738 [00:12<00:04, 615.90it/s] 75%|███████████████████████████████████████             | 7306/9738 [00:12<00:03, 614.09it/s] 76%|███████████████████████████████████████▎            | 7369/9738 [00:12<00:03, 616.74it/s] 76%|███████████████████████████████████████▋            | 7432/9738 [00:12<00:03, 618.93it/s] 77%|████████████████████████████████████████            | 7494/9738 [00:12<00:03, 592.68it/s] 78%|████████████████████████████████████████▎           | 7557/9738 [00:12<00:03, 603.05it/s] 78%|████████████████████████████████████████▋           | 7621/9738 [00:13<00:03, 611.62it/s] 79%|█████████████████████████████████████████           | 7684/9738 [00:13<00:03, 614.26it/s] 80%|█████████████████████████████████████████▎          | 7748/9738 [00:13<00:03, 619.26it/s] 80%|█████████████████████████████████████████▋          | 7811/9738 [00:13<00:03, 621.28it/s] 81%|██████████████████████████████████████████          | 7874/9738 [00:13<00:02, 623.25it/s] 82%|██████████████████████████████████████████▍         | 7937/9738 [00:13<00:02, 623.77it/s] 82%|██████████████████████████████████████████▋         | 8001/9738 [00:13<00:02, 626.26it/s] 83%|███████████████████████████████████████████         | 8064/9738 [00:13<00:02, 626.73it/s] 83%|███████████████████████████████████████████▍        | 8127/9738 [00:13<00:02, 625.95it/s] 84%|███████████████████████████████████████████▋        | 8191/9738 [00:13<00:02, 627.60it/s] 85%|████████████████████████████████████████████        | 8255/9738 [00:14<00:02, 628.76it/s] 85%|████████████████████████████████████████████▍       | 8318/9738 [00:14<00:02, 623.67it/s] 86%|████████████████████████████████████████████▊       | 8381/9738 [00:14<00:02, 621.02it/s] 87%|█████████████████████████████████████████████       | 8444/9738 [00:14<00:02, 623.31it/s] 87%|█████████████████████████████████████████████▍      | 8507/9738 [00:14<00:01, 624.64it/s] 88%|█████████████████████████████████████████████▊      | 8570/9738 [00:14<00:01, 625.18it/s] 89%|██████████████████████████████████████████████      | 8633/9738 [00:14<00:01, 623.50it/s] 89%|██████████████████████████████████████████████▍     | 8696/9738 [00:14<00:01, 625.38it/s] 90%|██████████████████████████████████████████████▊     | 8759/9738 [00:14<00:01, 626.49it/s] 91%|███████████████████████████████████████████████     | 8822/9738 [00:15<00:01, 624.91it/s] 91%|███████████████████████████████████████████████▍    | 8885/9738 [00:15<00:01, 624.95it/s] 92%|███████████████████████████████████████████████▊    | 8949/9738 [00:15<00:01, 626.68it/s] 93%|████████████████████████████████████████████████    | 9012/9738 [00:15<00:01, 626.99it/s] 93%|████████████████████████████████████████████████▍   | 9075/9738 [00:15<00:01, 624.60it/s] 94%|████████████████████████████████████████████████▊   | 9138/9738 [00:15<00:00, 625.13it/s] 94%|█████████████████████████████████████████████████▏  | 9201/9738 [00:15<00:00, 626.45it/s] 95%|█████████████████████████████████████████████████▍  | 9264/9738 [00:15<00:00, 625.08it/s] 96%|█████████████████████████████████████████████████▊  | 9327/9738 [00:15<00:00, 625.23it/s] 96%|██████████████████████████████████████████████████▏ | 9390/9738 [00:15<00:00, 619.42it/s] 97%|██████████████████████████████████████████████████▍ | 9453/9738 [00:16<00:00, 620.91it/s] 98%|██████████████████████████████████████████████████▊ | 9516/9738 [00:16<00:00, 621.12it/s] 98%|███████████████████████████████████████████████████▏| 9580/9738 [00:16<00:00, 623.77it/s] 99%|███████████████████████████████████████████████████▍| 9643/9738 [00:16<00:00, 625.33it/s]100%|███████████████████████████████████████████████████▊| 9707/9738 [00:16<00:00, 627.09it/s]100%|████████████████████████████████████████████████████| 9738/9738 [00:16<00:00, 591.19it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.19s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.07s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:11,  5.55s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:11,  5.64s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.12s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.15s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:11<00:05,  5.65s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:11<00:05,  5.77s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.53s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.70s/it]
[2023-08-22 11:00:05,333] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.53s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.69s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  4.96s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  5.14s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:16<00:00,  5.34s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:16<00:00,  5.44s/it]
[2023-08-22 11:00:15,343] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-22 11:00:15,345] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-22 11:00:15,345] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-22 11:00:15,345] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-22 11:00:15,345] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-22 11:00:15,345] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-22 11:00:15,346] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-22 11:00:15,346] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-22 11:00:15,346] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-22 11:00:15,346] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-22 11:00:15,346] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-22 11:00:15,346] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fc547393fd0>
[2023-08-22 11:00:15,346] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-22 11:00:15,346] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-22 11:00:15,346] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-22 11:00:15,346] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-22 11:00:15,346] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-22 11:00:15,346] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-22 11:00:15,346] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-22 11:00:15,346] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-22 11:00:15,346] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-22 11:00:15,346] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-22 11:00:15,346] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-22 11:00:15,346] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-22 11:00:15,346] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-22 11:00:15,346] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-22 11:00:15,346] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-22 11:00:15,346] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-22 11:00:15,346] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-22 11:00:15,347] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-22 11:00:15,347] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-22 11:00:15,347] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-22 11:00:15,347] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-22 11:00:15,347] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-22 11:00:15,347] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-22 11:00:15,347] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-22 11:00:15,347] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-22 11:00:15,347] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-22 11:00:15,347] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-22 11:00:15,347] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-22 11:00:15,347] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-22 11:00:15,347] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-22 11:00:15,347] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-22 11:00:15,347] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-22 11:00:15,347] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7fc5470b2220>
[2023-08-22 11:00:15,347] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-22 11:00:15,347] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-22 11:00:15,347] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-22 11:00:15,347] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-22 11:00:15,347] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-22 11:00:15,347] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-22 11:00:15,347] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-22 11:00:15,347] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-22 11:00:15,347] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-22 11:00:15,347] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-22 11:00:15,347] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-22 11:00:15,347] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-22 11:00:15,347] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-22 11:00:15,347] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-22 11:00:15,347] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-22 11:00:15,347] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-22 11:00:15,347] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-22 11:00:15,347] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-22 11:00:15,347] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-22 11:00:15,348] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-22 11:00:15,348] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-22 11:00:15,348] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-22 11:00:15,348] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.4449782371520996 seconds
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.40488481521606445 seconds
Time to load utils op: 0.4068472385406494 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Loading extension module utils...
Time to load utils op: 0.5045492649078369 seconds
Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: The machine was very intricate, it was quite an what? Choices:  A: box B: apparatus C: appliance D: wash dishes E: implement
Output: 1. To answer this question, it is necessary to understand the context of a complex, detailed machine. 
2. Equally important is to know the meanings of the provided choices, which are: a box, an apparatus, an appliance, washing dishes, and an implement.
3. Let's go through the choices by their definition:
   - A box is simply a container, which doesn't describe something intricate.
   - An apparatus encompasses a set of machines or equipment designed for a particular function, which could be intricate.
   - An appliance refers to a device or piece of equipment designed to perform a specific task, typically a household task. The definition does not imply intricacy.
   - "Wash dishes" is an action, not a descriptor for a complex machine.
   - An implement is a tool, utensil, or other piece of equipment, which usually refers to simpler tools, not intricate machines.
4. Keeping the given context and definitions in mind, it is clear that the word 'apparatus' best fits the description of a machine that is'very intricate'.
5. Therefore, the correct answer is B: apparatus.
So the final answer is B: apparatus

Input: Where do you get petrol? Choices:  A: burn hot B: fuel tank C: burn hot D: car E: gas station
Output: 1. The question asks for the location where you typically obtain petrol.
2. Petrol is a type of fuel used to run cars and other automobiles.
3. Choices A and C, "burn hot," are incorrect because they are not locations nor related to obtaining petrol.
4. Choice B, "fuel tank," is the part of the car where petrol is stored and not the place where it is procured.
5. Choice D, "car," is also incorrect because we don't get petrol from the car itself; instead, we add petrol to the car.
6. Therefore, the correct answer is choice E, "gas station," because this is the location where you can buy and get petrol for your car.
So the final answer is E: gas station

Input: Where might a television used at night be? Choices:  A: cabinet B: house C: apartment D: bedroom E: woods
Output: 1. First, we consider the fact that a television is a piece of technology that needs to be plugged into an electricity source to be used.
2. A television is also typically used indoors due to the need to protect it from weather and theft.
3. With this in mind, we can eliminate option A: 'cabinet' because it is unlikely to be used there, and 'woods' because a television is typically not used outdoors.
4. We are left with 'house', 'apartment' and 'bedroom'. All these places can have electricity and are inside a building.
5. However, considering the word 'night' in the question suggests the location is likely to be a place used during the night.
6. While 'house' and 'apartment' could be correct, they are not specific enough  as they consist of many rooms.
7. 'Bedroom' is the most likely answer because it is common to watch television in a bedroom at night. Hence, the answer is D: bedroom.
So the final answer is D: bedroom

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i3-s20-rTrue
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:44<36:42, 44.95s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:28<35:10, 43.98s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [02:12<34:22, 43.88s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [02:55<33:30, 43.71s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [03:39<32:48, 43.75s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [04:22<32:03, 43.71s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [05:06<31:18, 43.69s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [05:49<30:29, 43.56s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [06:33<29:43, 43.49s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [07:16<28:56, 43.40s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [08:00<28:16, 43.49s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [08:44<27:39, 43.68s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [09:27<26:57, 43.72s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [10:11<26:13, 43.72s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [10:54<25:24, 43.54s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [11:38<24:45, 43.68s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [12:22<24:00, 43.66s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [13:05<23:12, 43.52s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [13:49<22:30, 43.57s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [14:33<21:50, 43.68s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [15:16<21:04, 43.62s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [15:59<20:17, 43.48s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [16:42<19:30, 43.35s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [17:24<18:30, 42.71s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [18:07<17:50, 42.82s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [18:50<17:11, 42.97s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [19:34<16:32, 43.14s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [20:17<15:49, 43.18s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [21:01<15:09, 43.32s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [21:44<14:26, 43.35s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [22:27<13:41, 43.25s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [23:10<12:58, 43.27s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [23:54<12:16, 43.32s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [24:37<11:34, 43.43s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [25:21<10:51, 43.41s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [26:04<10:06, 43.31s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [26:47<09:23, 43.38s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [27:31<08:40, 43.36s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [28:15<08:00, 43.64s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [28:58<07:14, 43.49s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [29:41<06:29, 43.30s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [30:24<05:46, 43.32s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [31:08<05:03, 43.30s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [31:46<04:11, 41.90s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [32:29<03:30, 42.05s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [33:12<02:49, 42.49s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [33:55<02:07, 42.51s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [34:38<01:25, 42.69s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [35:21<00:42, 42.78s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [36:04<00:00, 43.04s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [36:04<00:00, 43.30s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 1.7853} | avg. gen lenth: 397.284
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i4-s20-rTrue --seed 20 --max-prompt-length 2048 --rationales --num-in-domain 4
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-22 11:36:30,654] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i4-s20-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 4
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i4-s20-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 20
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9737 [00:00<?, ?it/s]  0%|▏                                                     | 27/9737 [00:00<00:36, 268.57it/s]  1%|▎                                                     | 55/9737 [00:00<00:35, 269.34it/s]  1%|▍                                                     | 83/9737 [00:00<00:35, 270.65it/s]  1%|▌                                                    | 111/9737 [00:00<00:35, 271.32it/s]  1%|▊                                                    | 139/9737 [00:00<00:35, 271.41it/s]  2%|▉                                                    | 167/9737 [00:00<00:35, 271.47it/s]  2%|█                                                    | 195/9737 [00:00<00:35, 271.28it/s]  2%|█▏                                                   | 223/9737 [00:00<00:35, 266.58it/s]  3%|█▎                                                   | 250/9737 [00:00<00:35, 267.39it/s]  3%|█▌                                                   | 278/9737 [00:01<00:35, 268.36it/s]  3%|█▋                                                   | 306/9737 [00:01<00:35, 269.27it/s]  3%|█▊                                                   | 334/9737 [00:01<00:34, 269.63it/s]  4%|█▉                                                   | 362/9737 [00:01<00:34, 269.96it/s]  4%|██                                                   | 390/9737 [00:01<00:34, 270.24it/s]  4%|██▎                                                  | 418/9737 [00:01<00:34, 270.29it/s]  5%|██▍                                                  | 446/9737 [00:01<00:34, 269.01it/s]  5%|██▌                                                  | 474/9737 [00:01<00:34, 269.58it/s]  5%|██▋                                                  | 501/9737 [00:01<00:34, 267.09it/s]  5%|██▊                                                  | 528/9737 [00:01<00:34, 267.54it/s]  6%|███                                                  | 556/9737 [00:02<00:34, 268.67it/s]  6%|███▏                                                 | 585/9737 [00:02<00:33, 274.09it/s]  6%|███▍                                                 | 627/9737 [00:02<00:28, 315.49it/s]  7%|███▋                                                 | 668/9737 [00:02<00:26, 342.68it/s]  7%|███▊                                                 | 710/9737 [00:02<00:24, 363.66it/s]  8%|████                                                 | 752/9737 [00:02<00:23, 378.03it/s]  8%|████▎                                                | 794/9737 [00:02<00:23, 388.62it/s]  9%|████▌                                                | 836/9737 [00:02<00:22, 396.21it/s]  9%|████▊                                                | 878/9737 [00:02<00:22, 401.47it/s]  9%|█████                                                | 919/9737 [00:02<00:21, 402.65it/s] 10%|█████▏                                               | 961/9737 [00:03<00:21, 405.56it/s] 10%|█████▎                                              | 1003/9737 [00:03<00:21, 407.34it/s] 11%|█████▌                                              | 1044/9737 [00:03<00:21, 407.26it/s] 11%|█████▊                                              | 1086/9737 [00:03<00:21, 408.69it/s] 12%|██████                                              | 1127/9737 [00:03<00:21, 407.71it/s] 12%|██████▏                                             | 1168/9737 [00:03<00:21, 407.49it/s] 12%|██████▍                                             | 1210/9737 [00:03<00:20, 408.21it/s] 13%|██████▋                                             | 1251/9737 [00:03<00:20, 408.61it/s] 13%|██████▉                                             | 1292/9737 [00:03<00:20, 408.00it/s] 14%|███████                                             | 1334/9737 [00:03<00:20, 409.06it/s] 14%|███████▎                                            | 1375/9737 [00:04<00:20, 406.11it/s] 15%|███████▌                                            | 1417/9737 [00:04<00:20, 407.36it/s] 15%|███████▊                                            | 1459/9737 [00:04<00:20, 408.44it/s] 15%|████████                                            | 1501/9737 [00:04<00:20, 408.98it/s] 16%|████████▏                                           | 1543/9737 [00:04<00:19, 409.85it/s] 16%|████████▍                                           | 1584/9737 [00:04<00:19, 408.57it/s] 17%|████████▋                                           | 1626/9737 [00:04<00:19, 409.44it/s] 17%|████████▉                                           | 1668/9737 [00:04<00:19, 410.21it/s] 18%|█████████▏                                          | 1710/9737 [00:04<00:19, 410.60it/s] 18%|█████████▎                                          | 1752/9737 [00:05<00:19, 410.76it/s] 18%|█████████▌                                          | 1794/9737 [00:05<00:20, 391.73it/s] 19%|█████████▊                                          | 1835/9737 [00:05<00:19, 396.92it/s] 19%|██████████                                          | 1877/9737 [00:05<00:19, 401.05it/s] 20%|██████████▏                                         | 1919/9737 [00:05<00:19, 403.85it/s] 20%|██████████▍                                         | 1961/9737 [00:05<00:19, 405.80it/s] 21%|██████████▋                                         | 2002/9737 [00:05<00:19, 406.98it/s] 21%|██████████▉                                         | 2043/9737 [00:05<00:19, 404.26it/s] 21%|███████████▏                                        | 2084/9737 [00:05<00:18, 405.40it/s] 22%|███████████▎                                        | 2126/9737 [00:05<00:18, 406.91it/s] 22%|███████████▌                                        | 2168/9737 [00:06<00:18, 408.22it/s] 23%|███████████▊                                        | 2209/9737 [00:06<00:18, 408.53it/s] 23%|████████████                                        | 2250/9737 [00:06<00:18, 407.48it/s] 24%|████████████▏                                       | 2292/9737 [00:06<00:18, 408.62it/s] 24%|████████████▍                                       | 2334/9737 [00:06<00:18, 409.25it/s] 24%|████████████▋                                       | 2376/9737 [00:06<00:17, 409.68it/s] 25%|████████████▉                                       | 2418/9737 [00:06<00:17, 410.17it/s] 25%|█████████████▏                                      | 2460/9737 [00:06<00:17, 410.11it/s] 26%|█████████████▎                                      | 2502/9737 [00:06<00:17, 407.69it/s] 26%|█████████████▌                                      | 2543/9737 [00:06<00:17, 408.02it/s] 27%|█████████████▊                                      | 2584/9737 [00:07<00:17, 405.21it/s] 27%|██████████████                                      | 2626/9737 [00:07<00:17, 406.66it/s] 27%|██████████████▏                                     | 2668/9737 [00:07<00:17, 407.81it/s] 28%|██████████████▍                                     | 2709/9737 [00:07<00:17, 406.02it/s] 28%|██████████████▋                                     | 2750/9737 [00:07<00:17, 407.12it/s] 29%|██████████████▉                                     | 2791/9737 [00:07<00:17, 407.60it/s] 29%|███████████████                                     | 2832/9737 [00:07<00:16, 408.29it/s] 30%|███████████████▎                                    | 2874/9737 [00:07<00:16, 409.14it/s] 30%|███████████████▌                                    | 2915/9737 [00:07<00:16, 409.37it/s] 30%|███████████████▊                                    | 2956/9737 [00:07<00:16, 407.71it/s] 31%|████████████████                                    | 2998/9737 [00:08<00:16, 408.58it/s] 31%|████████████████▏                                   | 3039/9737 [00:08<00:16, 408.99it/s] 32%|████████████████▍                                   | 3080/9737 [00:08<00:16, 408.95it/s] 32%|████████████████▋                                   | 3121/9737 [00:08<00:16, 405.53it/s] 32%|████████████████▉                                   | 3162/9737 [00:08<00:16, 403.90it/s] 33%|█████████████████                                   | 3204/9737 [00:08<00:16, 406.04it/s] 33%|█████████████████▎                                  | 3246/9737 [00:08<00:15, 407.43it/s] 34%|█████████████████▌                                  | 3288/9737 [00:08<00:15, 408.25it/s] 34%|█████████████████▊                                  | 3330/9737 [00:08<00:15, 409.05it/s] 35%|██████████████████                                  | 3372/9737 [00:08<00:15, 409.71it/s] 35%|██████████████████▏                                 | 3413/9737 [00:09<00:15, 408.50it/s] 35%|██████████████████▍                                 | 3455/9737 [00:09<00:15, 409.22it/s] 36%|██████████████████▋                                 | 3496/9737 [00:09<00:15, 409.30it/s] 36%|██████████████████▉                                 | 3537/9737 [00:09<00:15, 409.35it/s] 37%|███████████████████                                 | 3579/9737 [00:09<00:15, 409.58it/s] 37%|███████████████████▎                                | 3620/9737 [00:09<00:14, 408.17it/s] 38%|███████████████████▌                                | 3661/9737 [00:09<00:15, 404.39it/s] 38%|███████████████████▊                                | 3703/9737 [00:09<00:14, 406.74it/s] 38%|████████████████████                                | 3745/9737 [00:09<00:14, 407.99it/s] 39%|████████████████████▏                               | 3786/9737 [00:10<00:14, 407.60it/s] 39%|████████████████████▍                               | 3828/9737 [00:10<00:14, 408.74it/s] 40%|████████████████████▋                               | 3869/9737 [00:10<00:14, 407.39it/s] 40%|████████████████████▉                               | 3910/9737 [00:10<00:14, 408.02it/s] 41%|█████████████████████                               | 3951/9737 [00:10<00:14, 408.25it/s] 41%|█████████████████████▎                              | 3992/9737 [00:10<00:14, 408.71it/s] 41%|█████████████████████▌                              | 4034/9737 [00:10<00:13, 409.33it/s] 42%|█████████████████████▊                              | 4075/9737 [00:10<00:13, 407.58it/s] 42%|█████████████████████▉                              | 4116/9737 [00:10<00:13, 407.87it/s] 43%|██████████████████████▏                             | 4157/9737 [00:10<00:13, 408.15it/s] 43%|██████████████████████▍                             | 4198/9737 [00:11<00:13, 408.68it/s] 44%|██████████████████████▋                             | 4239/9737 [00:11<00:13, 408.78it/s] 44%|██████████████████████▊                             | 4281/9737 [00:11<00:13, 409.29it/s] 44%|███████████████████████                             | 4322/9737 [00:11<00:13, 407.47it/s] 45%|███████████████████████▎                            | 4363/9737 [00:11<00:13, 408.13it/s] 45%|███████████████████████▌                            | 4404/9737 [00:11<00:13, 408.27it/s] 46%|███████████████████████▋                            | 4445/9737 [00:11<00:12, 408.71it/s] 46%|███████████████████████▉                            | 4486/9737 [00:11<00:12, 408.81it/s] 46%|████████████████████████▏                           | 4527/9737 [00:11<00:14, 370.32it/s] 47%|████████████████████████▍                           | 4568/9737 [00:11<00:13, 381.27it/s] 47%|████████████████████████▌                           | 4610/9737 [00:12<00:13, 389.65it/s] 48%|████████████████████████▊                           | 4651/9737 [00:12<00:12, 395.20it/s] 48%|█████████████████████████                           | 4692/9737 [00:12<00:12, 398.79it/s] 49%|█████████████████████████▎                          | 4733/9737 [00:12<00:12, 401.68it/s] 49%|█████████████████████████▍                          | 4774/9737 [00:12<00:17, 286.93it/s] 49%|█████████████████████████▋                          | 4815/9737 [00:12<00:15, 315.10it/s] 50%|█████████████████████████▉                          | 4856/9737 [00:12<00:14, 338.02it/s] 50%|██████████████████████████▏                         | 4897/9737 [00:12<00:13, 356.58it/s] 51%|██████████████████████████▍                         | 4939/9737 [00:13<00:12, 371.35it/s] 51%|██████████████████████████▌                         | 4980/9737 [00:13<00:12, 380.59it/s] 52%|██████████████████████████▊                         | 5021/9737 [00:13<00:12, 388.63it/s] 52%|███████████████████████████                         | 5062/9737 [00:13<00:11, 394.58it/s] 52%|███████████████████████████▎                        | 5103/9737 [00:13<00:11, 398.90it/s] 53%|███████████████████████████▍                        | 5144/9737 [00:13<00:11, 401.80it/s] 53%|███████████████████████████▋                        | 5185/9737 [00:13<00:11, 402.34it/s] 54%|███████████████████████████▉                        | 5226/9737 [00:13<00:11, 404.36it/s] 54%|████████████████████████████▏                       | 5267/9737 [00:13<00:11, 405.54it/s] 55%|████████████████████████████▎                       | 5309/9737 [00:13<00:10, 406.96it/s] 55%|████████████████████████████▌                       | 5350/9737 [00:14<00:10, 404.94it/s] 55%|████████████████████████████▊                       | 5391/9737 [00:14<00:10, 406.07it/s] 56%|█████████████████████████████                       | 5432/9737 [00:14<00:10, 405.43it/s] 56%|█████████████████████████████▏                      | 5474/9737 [00:14<00:10, 406.96it/s] 57%|█████████████████████████████▍                      | 5517/9737 [00:14<00:10, 412.09it/s] 57%|█████████████████████████████▋                      | 5560/9737 [00:14<00:10, 415.75it/s] 58%|█████████████████████████████▉                      | 5603/9737 [00:14<00:09, 417.83it/s] 58%|██████████████████████████████▏                     | 5645/9737 [00:14<00:09, 418.08it/s] 58%|██████████████████████████████▍                     | 5688/9737 [00:14<00:09, 420.19it/s] 59%|██████████████████████████████▌                     | 5731/9737 [00:14<00:09, 421.40it/s] 59%|██████████████████████████████▊                     | 5774/9737 [00:15<00:09, 422.15it/s] 60%|███████████████████████████████                     | 5817/9737 [00:15<00:09, 422.81it/s] 60%|███████████████████████████████▎                    | 5860/9737 [00:15<00:09, 421.38it/s] 61%|███████████████████████████████▌                    | 5903/9737 [00:15<00:09, 422.00it/s] 61%|███████████████████████████████▊                    | 5946/9737 [00:15<00:08, 422.76it/s] 62%|███████████████████████████████▉                    | 5989/9737 [00:15<00:08, 423.32it/s] 62%|████████████████████████████████▏                   | 6032/9737 [00:15<00:08, 422.94it/s] 62%|████████████████████████████████▍                   | 6075/9737 [00:15<00:08, 423.15it/s] 63%|████████████████████████████████▋                   | 6118/9737 [00:15<00:08, 421.55it/s] 63%|████████████████████████████████▉                   | 6161/9737 [00:15<00:08, 421.92it/s] 64%|█████████████████████████████████▏                  | 6204/9737 [00:16<00:08, 422.38it/s] 64%|█████████████████████████████████▎                  | 6247/9737 [00:16<00:08, 421.98it/s] 65%|█████████████████████████████████▌                  | 6290/9737 [00:16<00:08, 422.75it/s] 65%|█████████████████████████████████▊                  | 6333/9737 [00:16<00:08, 421.16it/s] 65%|██████████████████████████████████                  | 6376/9737 [00:16<00:07, 421.86it/s] 66%|██████████████████████████████████▎                 | 6419/9737 [00:16<00:07, 422.25it/s] 66%|██████████████████████████████████▌                 | 6462/9737 [00:16<00:07, 422.46it/s] 67%|██████████████████████████████████▋                 | 6505/9737 [00:16<00:07, 422.61it/s] 67%|██████████████████████████████████▉                 | 6548/9737 [00:16<00:07, 420.99it/s] 68%|███████████████████████████████████▏                | 6591/9737 [00:16<00:07, 421.49it/s] 68%|███████████████████████████████████▍                | 6634/9737 [00:17<00:07, 422.19it/s] 69%|███████████████████████████████████▋                | 6677/9737 [00:17<00:07, 422.67it/s] 69%|███████████████████████████████████▉                | 6720/9737 [00:17<00:07, 422.98it/s] 69%|████████████████████████████████████                | 6763/9737 [00:17<00:07, 421.02it/s] 70%|████████████████████████████████████▎               | 6806/9737 [00:17<00:06, 421.49it/s] 70%|████████████████████████████████████▌               | 6849/9737 [00:17<00:06, 421.98it/s] 71%|████████████████████████████████████▊               | 6892/9737 [00:17<00:06, 422.44it/s] 71%|█████████████████████████████████████               | 6935/9737 [00:17<00:06, 422.84it/s] 72%|█████████████████████████████████████▎              | 6978/9737 [00:17<00:06, 423.04it/s] 72%|█████████████████████████████████████▍              | 7021/9737 [00:17<00:06, 421.46it/s] 73%|█████████████████████████████████████▋              | 7064/9737 [00:18<00:06, 422.35it/s] 73%|█████████████████████████████████████▉              | 7107/9737 [00:18<00:06, 422.95it/s] 73%|██████████████████████████████████████▏             | 7150/9737 [00:18<00:06, 423.43it/s] 74%|██████████████████████████████████████▍             | 7193/9737 [00:18<00:06, 423.55it/s] 74%|██████████████████████████████████████▋             | 7236/9737 [00:18<00:05, 421.91it/s] 75%|██████████████████████████████████████▊             | 7279/9737 [00:18<00:05, 422.50it/s] 75%|███████████████████████████████████████             | 7322/9737 [00:18<00:05, 422.88it/s] 76%|███████████████████████████████████████▎            | 7365/9737 [00:18<00:05, 423.40it/s] 76%|███████████████████████████████████████▌            | 7408/9737 [00:18<00:05, 422.98it/s] 77%|███████████████████████████████████████▊            | 7451/9737 [00:19<00:05, 397.09it/s] 77%|████████████████████████████████████████            | 7494/9737 [00:19<00:05, 404.26it/s] 77%|████████████████████████████████████████▎           | 7537/9737 [00:19<00:05, 408.93it/s] 78%|████████████████████████████████████████▍           | 7580/9737 [00:19<00:05, 412.79it/s] 78%|████████████████████████████████████████▋           | 7623/9737 [00:19<00:05, 415.89it/s] 79%|████████████████████████████████████████▉           | 7666/9737 [00:19<00:04, 417.72it/s] 79%|█████████████████████████████████████████▏          | 7708/9737 [00:19<00:04, 417.73it/s] 80%|█████████████████████████████████████████▍          | 7751/9737 [00:19<00:04, 419.36it/s] 80%|█████████████████████████████████████████▌          | 7794/9737 [00:19<00:04, 420.62it/s] 80%|█████████████████████████████████████████▊          | 7837/9737 [00:19<00:04, 421.80it/s] 81%|██████████████████████████████████████████          | 7880/9737 [00:20<00:04, 422.16it/s] 81%|██████████████████████████████████████████▎         | 7923/9737 [00:20<00:04, 421.31it/s] 82%|██████████████████████████████████████████▌         | 7966/9737 [00:20<00:04, 421.84it/s] 82%|██████████████████████████████████████████▊         | 8009/9737 [00:20<00:04, 422.13it/s] 83%|███████████████████████████████████████████         | 8052/9737 [00:20<00:03, 422.26it/s] 83%|███████████████████████████████████████████▏        | 8095/9737 [00:20<00:03, 422.98it/s] 84%|███████████████████████████████████████████▍        | 8138/9737 [00:20<00:03, 421.76it/s] 84%|███████████████████████████████████████████▋        | 8181/9737 [00:20<00:03, 418.38it/s] 84%|███████████████████████████████████████████▉        | 8224/9737 [00:20<00:03, 419.93it/s] 85%|████████████████████████████████████████████▏       | 8267/9737 [00:20<00:03, 420.96it/s] 85%|████████████████████████████████████████████▍       | 8310/9737 [00:21<00:03, 421.46it/s] 86%|████████████████████████████████████████████▌       | 8353/9737 [00:21<00:03, 420.18it/s] 86%|████████████████████████████████████████████▊       | 8396/9737 [00:21<00:03, 421.19it/s] 87%|█████████████████████████████████████████████       | 8439/9737 [00:21<00:03, 422.26it/s] 87%|█████████████████████████████████████████████▎      | 8482/9737 [00:21<00:02, 422.47it/s] 88%|█████████████████████████████████████████████▌      | 8525/9737 [00:21<00:02, 422.62it/s] 88%|█████████████████████████████████████████████▊      | 8568/9737 [00:21<00:02, 422.28it/s] 88%|█████████████████████████████████████████████▉      | 8611/9737 [00:21<00:02, 420.41it/s] 89%|██████████████████████████████████████████████▏     | 8654/9737 [00:21<00:02, 421.21it/s] 89%|██████████████████████████████████████████████▍     | 8697/9737 [00:21<00:02, 421.84it/s] 90%|██████████████████████████████████████████████▋     | 8740/9737 [00:22<00:02, 422.12it/s] 90%|██████████████████████████████████████████████▉     | 8783/9737 [00:22<00:02, 422.29it/s] 91%|███████████████████████████████████████████████▏    | 8826/9737 [00:22<00:02, 420.81it/s] 91%|███████████████████████████████████████████████▎    | 8869/9737 [00:22<00:02, 421.30it/s] 92%|███████████████████████████████████████████████▌    | 8912/9737 [00:22<00:01, 418.37it/s] 92%|███████████████████████████████████████████████▊    | 8955/9737 [00:22<00:01, 419.66it/s] 92%|████████████████████████████████████████████████    | 8998/9737 [00:22<00:01, 420.43it/s] 93%|████████████████████████████████████████████████▎   | 9041/9737 [00:22<00:01, 419.42it/s] 93%|████████████████████████████████████████████████▌   | 9084/9737 [00:22<00:01, 420.27it/s] 94%|████████████████████████████████████████████████▋   | 9127/9737 [00:22<00:01, 420.62it/s] 94%|████████████████████████████████████████████████▉   | 9170/9737 [00:23<00:01, 421.28it/s] 95%|█████████████████████████████████████████████████▏  | 9213/9737 [00:23<00:01, 421.64it/s] 95%|█████████████████████████████████████████████████▍  | 9256/9737 [00:23<00:01, 421.96it/s] 96%|█████████████████████████████████████████████████▋  | 9299/9737 [00:23<00:01, 420.41it/s] 96%|█████████████████████████████████████████████████▉  | 9342/9737 [00:23<00:00, 421.34it/s] 96%|██████████████████████████████████████████████████  | 9385/9737 [00:23<00:00, 421.65it/s] 97%|██████████████████████████████████████████████████▎ | 9428/9737 [00:23<00:00, 421.85it/s] 97%|██████████████████████████████████████████████████▌ | 9471/9737 [00:23<00:00, 422.06it/s] 98%|██████████████████████████████████████████████████▊ | 9514/9737 [00:23<00:00, 420.68it/s] 98%|███████████████████████████████████████████████████ | 9557/9737 [00:24<00:00, 421.07it/s] 99%|███████████████████████████████████████████████████▎| 9600/9737 [00:24<00:00, 419.20it/s] 99%|███████████████████████████████████████████████████▍| 9643/9737 [00:24<00:00, 419.73it/s] 99%|███████████████████████████████████████████████████▋| 9685/9737 [00:24<00:00, 419.77it/s]100%|███████████████████████████████████████████████████▉| 9727/9737 [00:24<00:00, 418.08it/s]100%|████████████████████████████████████████████████████| 9737/9737 [00:24<00:00, 398.23it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.06s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.16s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.36s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.42s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.02s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.07s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.32s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.38s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.44s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.60s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.49s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.66s/it]
[2023-08-22 11:37:46,783] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.73s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.90s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.80s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.96s/it]
[2023-08-22 11:37:56,389] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-22 11:37:56,390] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-22 11:37:56,391] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-22 11:37:56,391] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-22 11:37:56,391] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-22 11:37:56,391] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-22 11:37:56,392] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-22 11:37:56,392] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-22 11:37:56,392] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-22 11:37:56,392] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-22 11:37:56,392] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-22 11:37:56,392] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f875627dfd0>
[2023-08-22 11:37:56,392] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-22 11:37:56,392] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-22 11:37:56,392] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-22 11:37:56,392] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-22 11:37:56,392] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-22 11:37:56,392] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-22 11:37:56,392] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-22 11:37:56,392] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-22 11:37:56,392] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-22 11:37:56,392] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-22 11:37:56,392] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-22 11:37:56,392] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-22 11:37:56,392] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-22 11:37:56,392] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-22 11:37:56,392] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-22 11:37:56,392] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-22 11:37:56,392] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-22 11:37:56,392] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-22 11:37:56,392] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-22 11:37:56,392] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-22 11:37:56,392] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-22 11:37:56,392] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-22 11:37:56,392] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-22 11:37:56,392] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-22 11:37:56,392] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-22 11:37:56,392] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-22 11:37:56,392] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-22 11:37:56,393] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-22 11:37:56,393] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-22 11:37:56,393] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-22 11:37:56,393] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-22 11:37:56,393] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-22 11:37:56,393] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f872b50c220>
[2023-08-22 11:37:56,393] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-22 11:37:56,393] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-22 11:37:56,393] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-22 11:37:56,393] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-22 11:37:56,393] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-22 11:37:56,393] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-22 11:37:56,393] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-22 11:37:56,393] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-22 11:37:56,393] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-22 11:37:56,393] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-22 11:37:56,393] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-22 11:37:56,393] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-22 11:37:56,393] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-22 11:37:56,393] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-22 11:37:56,393] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-22 11:37:56,393] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-22 11:37:56,393] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-22 11:37:56,393] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-22 11:37:56,393] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-22 11:37:56,393] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-22 11:37:56,393] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-22 11:37:56,393] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-22 11:37:56,393] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.45355963706970215 seconds
Loading extension module utils...
Time to load utils op: 0.5055437088012695 seconds
Loading extension module utils...
Time to load utils op: 0.4047126770019531 seconds
Loading extension module utils...
Time to load utils op: 0.4046440124511719 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: The machine was very intricate, it was quite an what? Choices:  A: box B: apparatus C: appliance D: wash dishes E: implement
Output: 1. In this question, you need to identify the best word to complete the sentence.
2. The sentence is talking about an intricate machine, which means it is complex or complicated.
3. Now, look at the options given - A: box, B: apparatus, C: appliance, D: wash dishes, E: implement. 
4. The word "box" usually refers to a simple container, not something intricate or complex.
5. "Apparatus" refers to a complex machine or device, which fits with the description in the question.
6. "Appliance" refers to a device or piece of equipment designed to perform a specific task, usually a domestic one. The context of the sentence does not suggest a domestic usage.
7. "Wash dishes" is a verb phrase, not a noun, therefore it can't be the answer because we are describing a noun. 
8. "Implement" would imply a tool or instrument for a specific task, which does not necessarily need to be intricate or complex.
9. Therefore, the best fit from the given options to complete the sentence is B: apparatus.
So the final answer is B: apparatus

Input: Where do you get petrol? Choices:  A: burn hot B: fuel tank C: burn hot D: car E: gas station
Output: 1. The question is asking about the location where one can obtain petrol. 
2. Petrol is a type of fuel that is used to run engines.
3. By going over the options given, we can eliminate options that do not fit the context of the question.
4. Options A and C, "burn hot," are incorrect because this response suggests a state of matter, not a location.
5. Option B, "fuel tank", while related to petrol, is where the petrol is stored in a car, not where it is originally obtained.
6. Option D, "car", is incorrect because cars use petrol, they do not provide it.
7. This leaves us with the last option, E, "gas station".
8. A gas station is a location where fuel, including petrol, is sold and distributed to customers for their vehicles. 
9. Therefore, the answer is E: gas station.
So the final answer is E: gas station

Input: Where might a television used at night be? Choices:  A: cabinet B: house C: apartment D: bedroom E: woods
Output: 1. A television is usually used in places where people live or work, as this tool is typically used for entertainment or informative purposes.
2. The options provided in the question are cabinet, house, apartment, bedroom, and woods. 
3. A cabinet is not a suitable location for using a television as it is a storage unit and does not usually provide enough space to watch television comfortably.
4. The woods is also not a good option as it typically lacks the necessary resources such as electricity and proper protective shielding for the television.
5. The remaining options are house, apartment, and bedroom. The question indicates that the television is used at night, suggesting the place should be somewhere people often reside at night.
6. Although people reside both in houses and apartments, they are too broad and do not specify a particular area within them where a television might be used at night. A television can be in many rooms within a house or an apartment.
7. Considering all this, the most suitable answer among the provided options would be a bedroom as it specifies a location within a residential structure where people commonly use televisions at night. Hence, the answer is D: bedroom.
So the final answer is D: bedroom

Input: The knowledge was expensive to get, where was it being gained? Choices:  A: university B: book C: field D: meeting E: class
Output: 1. The question asks about the location of getting knowledge which is described as being "expensive."
2. If we consider the options, gaining knowledge from a book, field, meeting, or class doesn't typically have a high financial cost associated with it.
3. However, attending a university typically involves substantial financial expenses in terms of tuition, living expenses, etc.
4. The term "expensive" is a key term in this question because it differentiates university from the other options.
5. So, by considering the distinctive "expensive" feature, we can conclude that the location is the university. Hence, the answer is A: university.
So the final answer is A: university

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i4-s20-rTrue
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:41<34:03, 41.70s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:22<32:50, 41.05s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [02:02<32:00, 40.87s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [02:43<31:11, 40.68s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [03:24<30:33, 40.76s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [04:04<29:52, 40.73s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [04:45<29:11, 40.74s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [05:26<28:32, 40.78s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [06:07<27:51, 40.77s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [06:47<27:07, 40.69s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [07:28<26:29, 40.75s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [08:09<25:46, 40.71s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [08:49<25:03, 40.63s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [09:30<24:25, 40.70s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [10:11<23:44, 40.70s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [10:52<23:05, 40.74s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [11:33<22:25, 40.78s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [12:13<21:44, 40.77s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [12:54<21:02, 40.72s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [13:35<20:25, 40.85s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [14:16<19:43, 40.80s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [14:57<19:05, 40.91s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [15:38<18:24, 40.91s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [16:18<17:41, 40.84s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [16:59<16:59, 40.76s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [17:40<16:16, 40.70s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [18:20<15:34, 40.63s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [18:55<14:16, 38.93s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [19:36<13:49, 39.48s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [20:17<13:17, 39.87s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [20:57<12:43, 40.18s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [21:38<12:05, 40.30s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [22:19<11:27, 40.43s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [22:59<10:48, 40.50s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [23:40<10:09, 40.61s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [24:21<09:30, 40.74s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [25:02<08:49, 40.75s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [25:39<07:54, 39.58s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [26:20<07:20, 40.02s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [27:01<06:42, 40.29s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [27:43<06:06, 40.74s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [28:23<05:25, 40.75s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [29:04<04:45, 40.80s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [29:46<04:06, 41.12s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [30:27<03:25, 41.00s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [31:09<02:44, 41.17s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [31:49<02:03, 41.05s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [32:31<01:22, 41.18s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [33:12<00:41, 41.19s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [33:53<00:00, 41.02s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [33:53<00:00, 40.66s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 1.5986} | avg. gen lenth: 407.012
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i5-s20-rTrue --seed 20 --max-prompt-length 2048 --rationales --num-in-domain 5
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-22 12:12:24,355] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i5-s20-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 5
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i5-s20-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 20
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9736 [00:00<?, ?it/s]  0%|                                                      | 19/9736 [00:00<00:51, 188.29it/s]  0%|▏                                                     | 38/9736 [00:00<00:51, 189.00it/s]  1%|▎                                                     | 57/9736 [00:00<00:51, 189.27it/s]  1%|▍                                                     | 77/9736 [00:00<00:50, 189.68it/s]  1%|▌                                                     | 97/9736 [00:00<00:50, 189.85it/s]  1%|▋                                                    | 117/9736 [00:00<00:50, 190.01it/s]  1%|▋                                                    | 137/9736 [00:00<00:50, 188.43it/s]  2%|▊                                                    | 156/9736 [00:00<00:50, 188.81it/s]  2%|▉                                                    | 175/9736 [00:00<00:50, 189.08it/s]  2%|█                                                    | 194/9736 [00:01<00:50, 189.22it/s]  2%|█▏                                                   | 213/9736 [00:01<00:50, 187.98it/s]  2%|█▎                                                   | 233/9736 [00:01<00:50, 188.73it/s]  3%|█▍                                                   | 255/9736 [00:01<00:48, 196.48it/s]  3%|█▌                                                   | 285/9736 [00:01<00:42, 224.84it/s]  3%|█▋                                                   | 314/9736 [00:01<00:38, 243.96it/s]  4%|█▊                                                   | 343/9736 [00:01<00:36, 257.55it/s]  4%|██                                                   | 372/9736 [00:01<00:35, 265.42it/s]  4%|██▏                                                  | 401/9736 [00:01<00:34, 272.54it/s]  4%|██▎                                                  | 429/9736 [00:01<00:33, 274.53it/s]  5%|██▍                                                  | 458/9736 [00:02<00:33, 279.06it/s]  5%|██▋                                                  | 487/9736 [00:02<00:32, 281.72it/s]  5%|██▊                                                  | 516/9736 [00:02<00:32, 283.64it/s]  6%|██▉                                                  | 545/9736 [00:02<00:32, 284.92it/s]  6%|███                                                  | 574/9736 [00:02<00:32, 285.68it/s]  6%|███▎                                                 | 603/9736 [00:02<00:31, 286.57it/s]  6%|███▍                                                 | 632/9736 [00:02<00:31, 286.96it/s]  7%|███▌                                                 | 661/9736 [00:02<00:31, 286.00it/s]  7%|███▊                                                 | 690/9736 [00:02<00:31, 286.78it/s]  7%|███▉                                                 | 719/9736 [00:02<00:31, 287.13it/s]  8%|████                                                 | 748/9736 [00:03<00:31, 287.47it/s]  8%|████▏                                                | 777/9736 [00:03<00:31, 287.74it/s]  8%|████▍                                                | 806/9736 [00:03<00:31, 287.73it/s]  9%|████▌                                                | 835/9736 [00:03<00:30, 287.89it/s]  9%|████▋                                                | 864/9736 [00:03<00:30, 288.19it/s]  9%|████▊                                                | 893/9736 [00:03<00:30, 286.61it/s]  9%|█████                                                | 922/9736 [00:03<00:30, 287.00it/s] 10%|█████▏                                               | 951/9736 [00:03<00:30, 287.31it/s] 10%|█████▎                                               | 980/9736 [00:03<00:30, 287.25it/s] 10%|█████▍                                              | 1009/9736 [00:03<00:30, 287.45it/s] 11%|█████▌                                              | 1038/9736 [00:04<00:30, 287.79it/s] 11%|█████▋                                              | 1067/9736 [00:04<00:30, 287.94it/s] 11%|█████▊                                              | 1096/9736 [00:04<00:30, 287.63it/s] 12%|██████                                              | 1125/9736 [00:04<00:30, 285.97it/s] 12%|██████▏                                             | 1154/9736 [00:04<00:29, 286.69it/s] 12%|██████▎                                             | 1183/9736 [00:04<00:29, 286.98it/s] 12%|██████▍                                             | 1212/9736 [00:04<00:29, 287.04it/s] 13%|██████▋                                             | 1241/9736 [00:04<00:29, 287.11it/s] 13%|██████▊                                             | 1270/9736 [00:04<00:29, 287.33it/s] 13%|██████▉                                             | 1299/9736 [00:04<00:29, 287.58it/s] 14%|███████                                             | 1328/9736 [00:05<00:29, 287.61it/s] 14%|███████▏                                            | 1357/9736 [00:05<00:29, 285.93it/s] 14%|███████▍                                            | 1386/9736 [00:05<00:29, 286.23it/s] 15%|███████▌                                            | 1415/9736 [00:05<00:29, 286.57it/s] 15%|███████▋                                            | 1444/9736 [00:05<00:28, 286.16it/s] 15%|███████▊                                            | 1473/9736 [00:05<00:28, 286.25it/s] 15%|████████                                            | 1502/9736 [00:05<00:28, 285.09it/s] 16%|████████▏                                           | 1531/9736 [00:05<00:28, 285.61it/s] 16%|████████▎                                           | 1560/9736 [00:05<00:28, 286.28it/s] 16%|████████▍                                           | 1589/9736 [00:05<00:28, 284.82it/s] 17%|████████▋                                           | 1618/9736 [00:06<00:28, 285.40it/s] 17%|████████▊                                           | 1647/9736 [00:06<00:28, 286.00it/s] 17%|████████▉                                           | 1676/9736 [00:06<00:28, 286.28it/s] 18%|█████████                                           | 1705/9736 [00:06<00:28, 286.37it/s] 18%|█████████▎                                          | 1734/9736 [00:06<00:27, 286.24it/s] 18%|█████████▍                                          | 1763/9736 [00:06<00:27, 286.47it/s] 18%|█████████▌                                          | 1792/9736 [00:06<00:29, 271.41it/s] 19%|█████████▋                                          | 1821/9736 [00:06<00:28, 275.69it/s] 19%|█████████▉                                          | 1850/9736 [00:06<00:28, 278.62it/s] 19%|██████████                                          | 1879/9736 [00:07<00:28, 279.26it/s] 20%|██████████▏                                         | 1908/9736 [00:07<00:27, 281.42it/s] 20%|██████████▎                                         | 1937/9736 [00:07<00:27, 282.93it/s] 20%|██████████▌                                         | 1966/9736 [00:07<00:27, 283.92it/s] 20%|██████████▋                                         | 1995/9736 [00:07<00:27, 284.84it/s] 21%|██████████▊                                         | 2024/9736 [00:07<00:27, 283.75it/s] 21%|██████████▉                                         | 2053/9736 [00:07<00:27, 284.50it/s] 21%|███████████                                         | 2082/9736 [00:07<00:26, 284.90it/s] 22%|███████████▎                                        | 2111/9736 [00:07<00:26, 285.50it/s] 22%|███████████▍                                        | 2140/9736 [00:07<00:26, 285.72it/s] 22%|███████████▌                                        | 2169/9736 [00:08<00:26, 285.91it/s] 23%|███████████▋                                        | 2198/9736 [00:08<00:26, 286.11it/s] 23%|███████████▉                                        | 2227/9736 [00:08<00:26, 286.27it/s] 23%|████████████                                        | 2256/9736 [00:08<00:26, 282.95it/s] 23%|████████████▏                                       | 2285/9736 [00:08<00:26, 284.04it/s] 24%|████████████▎                                       | 2314/9736 [00:08<00:26, 284.77it/s] 24%|████████████▌                                       | 2343/9736 [00:08<00:25, 285.20it/s] 24%|████████████▋                                       | 2372/9736 [00:08<00:25, 285.47it/s] 25%|████████████▊                                       | 2401/9736 [00:08<00:25, 285.78it/s] 25%|████████████▉                                       | 2430/9736 [00:08<00:25, 286.17it/s] 25%|█████████████▏                                      | 2459/9736 [00:09<00:25, 286.37it/s] 26%|█████████████▎                                      | 2488/9736 [00:09<00:25, 284.72it/s] 26%|█████████████▍                                      | 2517/9736 [00:09<00:25, 285.19it/s] 26%|█████████████▌                                      | 2546/9736 [00:09<00:25, 285.39it/s] 26%|█████████████▊                                      | 2575/9736 [00:09<00:25, 285.86it/s] 27%|█████████████▉                                      | 2604/9736 [00:09<00:24, 286.23it/s] 27%|██████████████                                      | 2633/9736 [00:09<00:25, 283.90it/s] 27%|██████████████▏                                     | 2662/9736 [00:09<00:24, 284.63it/s] 28%|██████████████▎                                     | 2691/9736 [00:09<00:24, 284.84it/s] 28%|██████████████▌                                     | 2720/9736 [00:09<00:24, 282.55it/s] 28%|██████████████▋                                     | 2749/9736 [00:10<00:24, 283.44it/s] 29%|██████████████▊                                     | 2778/9736 [00:10<00:24, 284.21it/s] 29%|██████████████▉                                     | 2807/9736 [00:10<00:24, 284.40it/s] 29%|███████████████▏                                    | 2836/9736 [00:10<00:24, 284.92it/s] 29%|███████████████▎                                    | 2865/9736 [00:10<00:24, 285.44it/s] 30%|███████████████▍                                    | 2894/9736 [00:10<00:23, 285.67it/s] 30%|███████████████▌                                    | 2923/9736 [00:10<00:23, 286.07it/s] 30%|███████████████▊                                    | 2952/9736 [00:10<00:23, 284.28it/s] 31%|███████████████▉                                    | 2981/9736 [00:10<00:23, 284.91it/s] 31%|████████████████                                    | 3010/9736 [00:10<00:23, 285.26it/s] 31%|████████████████▏                                   | 3039/9736 [00:11<00:23, 285.46it/s] 32%|████████████████▍                                   | 3068/9736 [00:11<00:23, 285.50it/s] 32%|████████████████▌                                   | 3097/9736 [00:11<00:23, 285.80it/s] 32%|████████████████▋                                   | 3126/9736 [00:11<00:23, 286.07it/s] 32%|████████████████▊                                   | 3155/9736 [00:11<00:23, 284.54it/s] 33%|█████████████████                                   | 3184/9736 [00:11<00:22, 285.38it/s] 33%|█████████████████▏                                  | 3213/9736 [00:11<00:22, 285.69it/s] 33%|█████████████████▎                                  | 3242/9736 [00:11<00:22, 286.07it/s] 34%|█████████████████▍                                  | 3271/9736 [00:11<00:22, 286.29it/s] 34%|█████████████████▋                                  | 3300/9736 [00:11<00:22, 286.21it/s] 34%|█████████████████▊                                  | 3329/9736 [00:12<00:22, 285.94it/s] 34%|█████████████████▉                                  | 3358/9736 [00:12<00:22, 285.39it/s] 35%|██████████████████                                  | 3387/9736 [00:12<00:22, 283.88it/s] 35%|██████████████████▏                                 | 3416/9736 [00:12<00:22, 284.64it/s] 35%|██████████████████▍                                 | 3445/9736 [00:12<00:22, 284.93it/s] 36%|██████████████████▌                                 | 3474/9736 [00:12<00:21, 285.30it/s] 36%|██████████████████▋                                 | 3503/9736 [00:12<00:21, 285.27it/s] 36%|██████████████████▊                                 | 3532/9736 [00:12<00:21, 285.54it/s] 37%|███████████████████                                 | 3561/9736 [00:12<00:21, 285.90it/s] 37%|███████████████████▏                                | 3590/9736 [00:13<00:21, 285.90it/s] 37%|███████████████████▎                                | 3619/9736 [00:13<00:21, 284.40it/s] 37%|███████████████████▍                                | 3648/9736 [00:13<00:21, 285.01it/s] 38%|███████████████████▋                                | 3677/9736 [00:13<00:21, 285.14it/s] 38%|███████████████████▊                                | 3706/9736 [00:13<00:21, 285.23it/s] 38%|███████████████████▉                                | 3735/9736 [00:13<00:21, 285.61it/s] 39%|████████████████████                                | 3764/9736 [00:13<00:20, 285.75it/s] 39%|████████████████████▎                               | 3793/9736 [00:13<00:20, 285.84it/s] 39%|████████████████████▍                               | 3822/9736 [00:13<00:20, 286.09it/s] 40%|████████████████████▌                               | 3851/9736 [00:13<00:20, 283.59it/s] 40%|████████████████████▋                               | 3880/9736 [00:14<00:20, 284.42it/s] 40%|████████████████████▉                               | 3909/9736 [00:14<00:20, 284.88it/s] 40%|█████████████████████                               | 3938/9736 [00:14<00:20, 284.98it/s] 41%|█████████████████████▏                              | 3967/9736 [00:14<00:20, 285.21it/s] 41%|█████████████████████▎                              | 3996/9736 [00:14<00:20, 285.30it/s] 41%|█████████████████████▍                              | 4025/9736 [00:14<00:19, 285.68it/s] 42%|█████████████████████▋                              | 4054/9736 [00:14<00:19, 285.77it/s] 42%|█████████████████████▊                              | 4083/9736 [00:14<00:19, 283.94it/s] 42%|█████████████████████▉                              | 4112/9736 [00:14<00:19, 284.51it/s] 43%|██████████████████████                              | 4141/9736 [00:14<00:19, 285.00it/s] 43%|██████████████████████▎                             | 4170/9736 [00:15<00:19, 285.33it/s] 43%|██████████████████████▍                             | 4199/9736 [00:15<00:19, 285.42it/s] 43%|██████████████████████▌                             | 4228/9736 [00:15<00:19, 285.53it/s] 44%|██████████████████████▋                             | 4257/9736 [00:15<00:19, 285.58it/s] 44%|██████████████████████▉                             | 4286/9736 [00:15<00:19, 285.61it/s] 44%|███████████████████████                             | 4315/9736 [00:15<00:19, 283.84it/s] 45%|███████████████████████▏                            | 4344/9736 [00:15<00:18, 284.23it/s] 45%|███████████████████████▎                            | 4373/9736 [00:15<00:18, 284.64it/s] 45%|███████████████████████▌                            | 4402/9736 [00:15<00:18, 284.85it/s] 46%|███████████████████████▋                            | 4431/9736 [00:15<00:18, 284.95it/s] 46%|███████████████████████▊                            | 4460/9736 [00:16<00:18, 285.06it/s] 46%|███████████████████████▉                            | 4489/9736 [00:16<00:18, 285.41it/s] 46%|████████████████████████▏                           | 4518/9736 [00:16<00:19, 261.04it/s] 47%|████████████████████████▎                           | 4547/9736 [00:16<00:19, 267.87it/s] 47%|████████████████████████▍                           | 4576/9736 [00:16<00:18, 272.95it/s] 47%|████████████████████████▌                           | 4605/9736 [00:16<00:18, 276.68it/s] 48%|████████████████████████▊                           | 4634/9736 [00:16<00:18, 279.45it/s] 48%|████████████████████████▉                           | 4663/9736 [00:16<00:18, 281.25it/s] 48%|█████████████████████████                           | 4692/9736 [00:16<00:17, 282.64it/s] 48%|█████████████████████████▏                          | 4721/9736 [00:17<00:17, 283.49it/s] 49%|█████████████████████████▎                          | 4750/9736 [00:17<00:23, 214.08it/s] 49%|█████████████████████████▌                          | 4779/9736 [00:17<00:21, 230.92it/s] 49%|█████████████████████████▋                          | 4808/9736 [00:17<00:20, 244.75it/s] 50%|█████████████████████████▊                          | 4837/9736 [00:17<00:19, 255.36it/s] 50%|█████████████████████████▉                          | 4866/9736 [00:17<00:18, 263.29it/s] 50%|██████████████████████████▏                         | 4895/9736 [00:17<00:17, 269.35it/s] 51%|██████████████████████████▎                         | 4924/9736 [00:17<00:17, 273.75it/s] 51%|██████████████████████████▍                         | 4952/9736 [00:17<00:17, 275.50it/s] 51%|██████████████████████████▌                         | 4981/9736 [00:18<00:17, 278.47it/s] 51%|██████████████████████████▊                         | 5010/9736 [00:18<00:16, 280.38it/s] 52%|██████████████████████████▉                         | 5039/9736 [00:18<00:16, 282.08it/s] 52%|███████████████████████████                         | 5068/9736 [00:18<00:16, 283.00it/s] 52%|███████████████████████████▏                        | 5097/9736 [00:18<00:16, 283.93it/s] 53%|███████████████████████████▍                        | 5126/9736 [00:18<00:16, 284.21it/s] 53%|███████████████████████████▌                        | 5155/9736 [00:18<00:16, 284.72it/s] 53%|███████████████████████████▋                        | 5184/9736 [00:18<00:16, 283.34it/s] 54%|███████████████████████████▊                        | 5213/9736 [00:18<00:15, 283.98it/s] 54%|███████████████████████████▉                        | 5242/9736 [00:18<00:15, 284.25it/s] 54%|████████████████████████████▏                       | 5271/9736 [00:19<00:15, 283.44it/s] 54%|████████████████████████████▎                       | 5300/9736 [00:19<00:15, 284.18it/s] 55%|████████████████████████████▍                       | 5329/9736 [00:19<00:15, 284.57it/s] 55%|████████████████████████████▌                       | 5358/9736 [00:19<00:15, 284.68it/s] 55%|████████████████████████████▊                       | 5387/9736 [00:19<00:15, 284.86it/s] 56%|████████████████████████████▉                       | 5416/9736 [00:19<00:15, 283.41it/s] 56%|█████████████████████████████                       | 5445/9736 [00:19<00:15, 284.11it/s] 56%|█████████████████████████████▏                      | 5474/9736 [00:19<00:14, 284.56it/s] 57%|█████████████████████████████▍                      | 5504/9736 [00:19<00:14, 287.17it/s] 57%|█████████████████████████████▌                      | 5534/9736 [00:19<00:14, 289.22it/s] 57%|█████████████████████████████▋                      | 5564/9736 [00:20<00:14, 290.67it/s] 57%|█████████████████████████████▉                      | 5594/9736 [00:20<00:14, 291.25it/s] 58%|██████████████████████████████                      | 5624/9736 [00:20<00:14, 291.98it/s] 58%|██████████████████████████████▏                     | 5654/9736 [00:20<00:14, 291.04it/s] 58%|██████████████████████████████▎                     | 5684/9736 [00:20<00:13, 291.95it/s] 59%|██████████████████████████████▌                     | 5714/9736 [00:20<00:13, 292.57it/s] 59%|██████████████████████████████▋                     | 5744/9736 [00:20<00:13, 291.17it/s] 59%|██████████████████████████████▊                     | 5774/9736 [00:20<00:13, 291.64it/s] 60%|██████████████████████████████▉                     | 5804/9736 [00:20<00:13, 292.22it/s] 60%|███████████████████████████████▏                    | 5834/9736 [00:21<00:13, 292.35it/s] 60%|███████████████████████████████▎                    | 5864/9736 [00:21<00:13, 291.14it/s] 61%|███████████████████████████████▍                    | 5894/9736 [00:21<00:13, 291.94it/s] 61%|███████████████████████████████▋                    | 5924/9736 [00:21<00:13, 292.48it/s] 61%|███████████████████████████████▊                    | 5954/9736 [00:21<00:12, 293.03it/s] 61%|███████████████████████████████▉                    | 5984/9736 [00:21<00:12, 293.35it/s] 62%|████████████████████████████████                    | 6014/9736 [00:21<00:12, 293.28it/s] 62%|████████████████████████████████▎                   | 6044/9736 [00:21<00:12, 293.40it/s] 62%|████████████████████████████████▍                   | 6074/9736 [00:21<00:12, 293.41it/s] 63%|████████████████████████████████▌                   | 6104/9736 [00:21<00:12, 292.21it/s] 63%|████████████████████████████████▊                   | 6134/9736 [00:22<00:12, 292.35it/s] 63%|████████████████████████████████▉                   | 6164/9736 [00:22<00:12, 292.59it/s] 64%|█████████████████████████████████                   | 6194/9736 [00:22<00:12, 292.84it/s] 64%|█████████████████████████████████▏                  | 6224/9736 [00:22<00:11, 292.79it/s] 64%|█████████████████████████████████▍                  | 6254/9736 [00:22<00:11, 290.56it/s] 65%|█████████████████████████████████▌                  | 6284/9736 [00:22<00:11, 291.22it/s] 65%|█████████████████████████████████▋                  | 6314/9736 [00:22<00:11, 289.73it/s] 65%|█████████████████████████████████▉                  | 6344/9736 [00:22<00:11, 290.72it/s] 65%|██████████████████████████████████                  | 6374/9736 [00:22<00:11, 291.25it/s] 66%|██████████████████████████████████▏                 | 6404/9736 [00:22<00:11, 291.90it/s] 66%|██████████████████████████████████▎                 | 6434/9736 [00:23<00:11, 292.26it/s] 66%|██████████████████████████████████▌                 | 6464/9736 [00:23<00:11, 292.27it/s] 67%|██████████████████████████████████▋                 | 6494/9736 [00:23<00:11, 292.60it/s] 67%|██████████████████████████████████▊                 | 6524/9736 [00:23<00:10, 292.64it/s] 67%|███████████████████████████████████                 | 6554/9736 [00:23<00:10, 291.41it/s] 68%|███████████████████████████████████▏                | 6584/9736 [00:23<00:10, 291.90it/s] 68%|███████████████████████████████████▎                | 6614/9736 [00:23<00:10, 292.24it/s] 68%|███████████████████████████████████▍                | 6644/9736 [00:23<00:10, 292.55it/s] 69%|███████████████████████████████████▋                | 6674/9736 [00:23<00:10, 292.76it/s] 69%|███████████████████████████████████▊                | 6704/9736 [00:23<00:10, 292.89it/s] 69%|███████████████████████████████████▉                | 6734/9736 [00:24<00:10, 291.07it/s] 69%|████████████████████████████████████▏               | 6764/9736 [00:24<00:10, 289.14it/s] 70%|████████████████████████████████████▎               | 6794/9736 [00:24<00:10, 290.15it/s] 70%|████████████████████████████████████▍               | 6824/9736 [00:24<00:10, 290.83it/s] 70%|████████████████████████████████████▌               | 6854/9736 [00:24<00:09, 291.26it/s] 71%|████████████████████████████████████▊               | 6884/9736 [00:24<00:09, 291.25it/s] 71%|████████████████████████████████████▉               | 6914/9736 [00:24<00:09, 291.58it/s] 71%|█████████████████████████████████████               | 6944/9736 [00:24<00:09, 291.90it/s] 72%|█████████████████████████████████████▏              | 6974/9736 [00:24<00:09, 292.01it/s] 72%|█████████████████████████████████████▍              | 7004/9736 [00:25<00:09, 290.73it/s] 72%|█████████████████████████████████████▌              | 7034/9736 [00:25<00:09, 291.40it/s] 73%|█████████████████████████████████████▋              | 7064/9736 [00:25<00:09, 291.88it/s] 73%|█████████████████████████████████████▉              | 7094/9736 [00:25<00:09, 292.07it/s] 73%|██████████████████████████████████████              | 7124/9736 [00:25<00:08, 292.33it/s] 73%|██████████████████████████████████████▏             | 7154/9736 [00:25<00:08, 292.78it/s] 74%|██████████████████████████████████████▎             | 7184/9736 [00:25<00:08, 292.81it/s] 74%|██████████████████████████████████████▌             | 7214/9736 [00:25<00:08, 291.33it/s] 74%|██████████████████████████████████████▋             | 7244/9736 [00:25<00:08, 289.33it/s] 75%|██████████████████████████████████████▊             | 7274/9736 [00:25<00:08, 290.09it/s] 75%|███████████████████████████████████████             | 7304/9736 [00:26<00:08, 290.78it/s] 75%|███████████████████████████████████████▏            | 7334/9736 [00:26<00:08, 291.27it/s] 76%|███████████████████████████████████████▎            | 7364/9736 [00:26<00:08, 291.86it/s] 76%|███████████████████████████████████████▍            | 7394/9736 [00:26<00:08, 292.23it/s] 76%|███████████████████████████████████████▋            | 7424/9736 [00:26<00:07, 292.20it/s] 77%|███████████████████████████████████████▊            | 7454/9736 [00:26<00:08, 260.75it/s] 77%|███████████████████████████████████████▉            | 7484/9736 [00:26<00:08, 269.29it/s] 77%|████████████████████████████████████████▏           | 7514/9736 [00:26<00:08, 275.63it/s] 77%|████████████████████████████████████████▎           | 7544/9736 [00:26<00:07, 280.36it/s] 78%|████████████████████████████████████████▍           | 7574/9736 [00:27<00:07, 283.96it/s] 78%|████████████████████████████████████████▌           | 7604/9736 [00:27<00:07, 286.51it/s] 78%|████████████████████████████████████████▊           | 7634/9736 [00:27<00:07, 288.29it/s] 79%|████████████████████████████████████████▉           | 7664/9736 [00:27<00:07, 289.52it/s] 79%|█████████████████████████████████████████           | 7694/9736 [00:27<00:07, 288.91it/s] 79%|█████████████████████████████████████████▎          | 7724/9736 [00:27<00:06, 289.66it/s] 80%|█████████████████████████████████████████▍          | 7754/9736 [00:27<00:06, 290.53it/s] 80%|█████████████████████████████████████████▌          | 7784/9736 [00:27<00:06, 290.99it/s] 80%|█████████████████████████████████████████▋          | 7814/9736 [00:27<00:06, 291.42it/s] 81%|█████████████████████████████████████████▉          | 7844/9736 [00:27<00:06, 291.59it/s] 81%|██████████████████████████████████████████          | 7874/9736 [00:28<00:06, 291.69it/s] 81%|██████████████████████████████████████████▏         | 7904/9736 [00:28<00:06, 290.45it/s] 81%|██████████████████████████████████████████▍         | 7934/9736 [00:28<00:06, 290.91it/s] 82%|██████████████████████████████████████████▌         | 7964/9736 [00:28<00:06, 291.42it/s] 82%|██████████████████████████████████████████▋         | 7994/9736 [00:28<00:05, 291.62it/s] 82%|██████████████████████████████████████████▊         | 8024/9736 [00:28<00:05, 291.79it/s] 83%|███████████████████████████████████████████         | 8054/9736 [00:28<00:05, 291.79it/s] 83%|███████████████████████████████████████████▏        | 8084/9736 [00:28<00:05, 292.11it/s] 83%|███████████████████████████████████████████▎        | 8114/9736 [00:28<00:05, 291.94it/s] 84%|███████████████████████████████████████████▍        | 8144/9736 [00:28<00:05, 290.37it/s] 84%|███████████████████████████████████████████▋        | 8174/9736 [00:29<00:05, 290.87it/s] 84%|███████████████████████████████████████████▊        | 8204/9736 [00:29<00:05, 291.13it/s] 85%|███████████████████████████████████████████▉        | 8234/9736 [00:29<00:05, 291.47it/s] 85%|████████████████████████████████████████████▏       | 8264/9736 [00:29<00:05, 291.59it/s] 85%|████████████████████████████████████████████▎       | 8294/9736 [00:29<00:04, 291.55it/s] 85%|████████████████████████████████████████████▍       | 8324/9736 [00:29<00:04, 290.18it/s] 86%|████████████████████████████████████████████▌       | 8354/9736 [00:29<00:04, 289.01it/s] 86%|████████████████████████████████████████████▊       | 8384/9736 [00:29<00:04, 289.86it/s] 86%|████████████████████████████████████████████▉       | 8414/9736 [00:29<00:04, 290.60it/s] 87%|█████████████████████████████████████████████       | 8444/9736 [00:29<00:04, 291.08it/s] 87%|█████████████████████████████████████████████▎      | 8474/9736 [00:30<00:04, 291.20it/s] 87%|█████████████████████████████████████████████▍      | 8504/9736 [00:30<00:04, 291.63it/s] 88%|█████████████████████████████████████████████▌      | 8534/9736 [00:30<00:04, 291.57it/s] 88%|█████████████████████████████████████████████▋      | 8564/9736 [00:30<00:04, 291.61it/s] 88%|█████████████████████████████████████████████▉      | 8594/9736 [00:30<00:03, 290.37it/s] 89%|██████████████████████████████████████████████      | 8624/9736 [00:30<00:03, 290.63it/s] 89%|██████████████████████████████████████████████▏     | 8654/9736 [00:30<00:03, 290.81it/s] 89%|██████████████████████████████████████████████▍     | 8684/9736 [00:30<00:03, 290.91it/s] 90%|██████████████████████████████████████████████▌     | 8714/9736 [00:30<00:03, 291.15it/s] 90%|██████████████████████████████████████████████▋     | 8744/9736 [00:31<00:03, 291.25it/s] 90%|██████████████████████████████████████████████▊     | 8774/9736 [00:31<00:03, 291.29it/s] 90%|███████████████████████████████████████████████     | 8804/9736 [00:31<00:03, 289.68it/s] 91%|███████████████████████████████████████████████▏    | 8834/9736 [00:31<00:03, 290.12it/s] 91%|███████████████████████████████████████████████▎    | 8864/9736 [00:31<00:03, 290.44it/s] 91%|███████████████████████████████████████████████▌    | 8894/9736 [00:31<00:02, 290.50it/s] 92%|███████████████████████████████████████████████▋    | 8924/9736 [00:31<00:02, 290.87it/s] 92%|███████████████████████████████████████████████▊    | 8954/9736 [00:31<00:02, 291.13it/s] 92%|███████████████████████████████████████████████▉    | 8984/9736 [00:31<00:02, 291.28it/s] 93%|████████████████████████████████████████████████▏   | 9014/9736 [00:31<00:02, 291.22it/s] 93%|████████████████████████████████████████████████▎   | 9044/9736 [00:32<00:02, 289.80it/s] 93%|████████████████████████████████████████████████▍   | 9074/9736 [00:32<00:02, 290.40it/s] 94%|████████████████████████████████████████████████▌   | 9104/9736 [00:32<00:02, 290.70it/s] 94%|████████████████████████████████████████████████▊   | 9134/9736 [00:32<00:02, 291.11it/s] 94%|████████████████████████████████████████████████▉   | 9164/9736 [00:32<00:01, 291.10it/s] 94%|█████████████████████████████████████████████████   | 9194/9736 [00:32<00:01, 291.19it/s] 95%|█████████████████████████████████████████████████▎  | 9224/9736 [00:32<00:01, 291.13it/s] 95%|█████████████████████████████████████████████████▍  | 9254/9736 [00:32<00:01, 291.38it/s] 95%|█████████████████████████████████████████████████▌  | 9284/9736 [00:32<00:01, 289.91it/s] 96%|█████████████████████████████████████████████████▋  | 9314/9736 [00:32<00:01, 290.50it/s] 96%|█████████████████████████████████████████████████▉  | 9344/9736 [00:33<00:01, 290.76it/s] 96%|██████████████████████████████████████████████████  | 9374/9736 [00:33<00:01, 291.16it/s] 97%|██████████████████████████████████████████████████▏ | 9404/9736 [00:33<00:01, 291.02it/s] 97%|██████████████████████████████████████████████████▍ | 9434/9736 [00:33<00:01, 291.03it/s] 97%|██████████████████████████████████████████████████▌ | 9464/9736 [00:33<00:00, 290.81it/s] 98%|██████████████████████████████████████████████████▋ | 9494/9736 [00:33<00:00, 289.43it/s] 98%|██████████████████████████████████████████████████▊ | 9524/9736 [00:33<00:00, 290.06it/s] 98%|███████████████████████████████████████████████████ | 9554/9736 [00:33<00:00, 290.37it/s] 98%|███████████████████████████████████████████████████▏| 9584/9736 [00:33<00:00, 290.63it/s] 99%|███████████████████████████████████████████████████▎| 9614/9736 [00:34<00:00, 290.97it/s] 99%|███████████████████████████████████████████████████▌| 9644/9736 [00:34<00:00, 291.20it/s] 99%|███████████████████████████████████████████████████▋| 9674/9736 [00:34<00:00, 291.37it/s]100%|███████████████████████████████████████████████████▊| 9704/9736 [00:34<00:00, 291.35it/s]100%|███████████████████████████████████████████████████▉| 9734/9736 [00:34<00:00, 289.78it/s]100%|████████████████████████████████████████████████████| 9736/9736 [00:34<00:00, 282.72it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:04<00:09,  4.95s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.31s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.38s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:11,  5.54s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:09<00:04,  4.82s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.30s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.48s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:11<00:05,  5.63s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.23s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.40s/it]
[2023-08-22 12:13:49,651] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.73s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.89s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  4.90s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  5.05s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  4.99s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  5.15s/it]
[2023-08-22 12:14:00,084] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-22 12:14:00,086] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-22 12:14:00,086] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-22 12:14:00,087] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-22 12:14:00,087] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-22 12:14:00,087] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-22 12:14:00,087] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-22 12:14:00,087] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-22 12:14:00,087] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-22 12:14:00,087] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-22 12:14:00,087] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-22 12:14:00,087] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fc4da4eafd0>
[2023-08-22 12:14:00,087] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-22 12:14:00,088] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-22 12:14:00,088] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-22 12:14:00,088] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-22 12:14:00,088] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-22 12:14:00,088] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-22 12:14:00,088] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-22 12:14:00,088] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-22 12:14:00,088] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-22 12:14:00,088] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-22 12:14:00,088] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-22 12:14:00,088] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-22 12:14:00,088] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-22 12:14:00,088] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-22 12:14:00,088] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-22 12:14:00,088] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-22 12:14:00,088] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-22 12:14:00,088] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-22 12:14:00,088] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-22 12:14:00,088] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-22 12:14:00,088] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-22 12:14:00,088] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-22 12:14:00,088] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-22 12:14:00,088] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-22 12:14:00,089] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-22 12:14:00,089] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-22 12:14:00,089] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-22 12:14:00,089] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-22 12:14:00,089] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-22 12:14:00,089] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-22 12:14:00,089] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-22 12:14:00,089] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-22 12:14:00,089] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7fc4d9c37220>
[2023-08-22 12:14:00,089] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-22 12:14:00,089] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-22 12:14:00,089] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-22 12:14:00,089] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-22 12:14:00,089] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-22 12:14:00,089] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-22 12:14:00,089] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-22 12:14:00,089] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-22 12:14:00,089] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-22 12:14:00,089] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-22 12:14:00,089] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-22 12:14:00,089] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-22 12:14:00,089] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-22 12:14:00,089] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-22 12:14:00,089] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-22 12:14:00,089] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-22 12:14:00,089] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-22 12:14:00,089] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-22 12:14:00,090] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-22 12:14:00,090] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-22 12:14:00,090] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-22 12:14:00,090] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-22 12:14:00,090] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.5240743160247803 seconds
Loading extension module utils...
Time to load utils op: 0.40435075759887695 seconds
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.5046613216400146 seconds
Time to load utils op: 0.6051821708679199 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: The machine was very intricate, it was quite an what? Choices:  A: box B: apparatus C: appliance D: wash dishes E: implement
Output: 1. The sentence talks about a machine being very intricate.
2. The missing word would need to be something that can be described as being complex or intricate. 
3. An 'intricate box' doesn't make much sense as a box is often simple in its design. Hence option A is incorrect.
4. Similarly, 'intricate wash dishes' does not fit the given context. Hence option D is incorrect.
5. Option E, 'implement' often refers to tools or equipment for specific purposes, which can be intricate but it is less often used to describe machinery. Hence it might not be the best fit.
6. Although appliances can be intricate, they are generally things like a kitchen or household devices, which may not be the best fit for the general term of'machine'. Therefore, option C might not be the best fit.
7. That leaves 'apparatus'. An apparatus is a technical device or machinery, and can indeed be intricate, fitting the sentence context well.
8. Therefore, the answer is B: apparatus.
So the final answer is B: apparatus

Input: Where do you get petrol? Choices:  A: burn hot B: fuel tank C: burn hot D: car E: gas station
Output: 1. The question is asking where petrol is obtained from or where we can usually get petrol. 
2. Option A: burn hot, does not pertain to the question since it does not have a location where petrol can be obtained. It seems more related to the process of burning or combustion.
3. Option B: fuel tank, while it is a place where petrol is stored, it is not typically where individuals go to obtain petrol. Therefore, this option is skipped.
4. Option C: burn hot, as it is the same as option A and it does not provide an answer related to where petrol is typically obtained. 
5. Option D: car; petrol is used by a car and is stored in its fuel tank for operation, but it is not typically the place where individuals go to obtain or purchase petrol. 
6. Option E: gas station; this is the correct answer as this is the typical place where individuals go to obtain or purchase petrol for their vehicles.
So the final answer is E: gas station

Input: Where might a television used at night be? Choices:  A: cabinet B: house C: apartment D: bedroom E: woods
Output: Step 1: Consider the options. The question asks where a television, used at night, might be.
Step 2: Option A: Cabinet is not a valid option since televisions are typically stored in cabinets when not in use, not when they are being watched. 
Step 3: Option B: House is a valid option as televisions are typically found in houses. But it's quite broad and does not specify a particular location within a house where a television would be used at night.
Step 4: Option C: Apartment is also a valid option like a house. But the same reasoning as option B applies here - it does not specify a particular place where a television would usually be used at night.
Step 5: Option D: Bedroom is a valid answer. People often watch TV in their bedrooms before going to sleep at night, so this choice is more specific than just a house or an apartment.
Step 6: Option E: Woods is not a valid option. Televisions require a power source and strong signal connection to broadcast, which are typically not available in the woods.
Step 7: Among all the options, bedroom is the most specific one which answers the question of where a television might be used at night. Therefore, the answer is D: bedroom.
So the final answer is D: bedroom

Input: The knowledge was expensive to get, where was it being gained? Choices:  A: university B: book C: field D: meeting E: class
Output: 1. The question asks about where an expensive knowledge acquisition process takes place.
2. We start by examining each of the choices.
3. Choice B: Knowledge acquired from books can be expensive, but not necessarily as it can also be freely accessible through libraries or online sources. So, it might not be the correct answer.
4. Choice C: Getting knowledge through field or practical experience is not necessarily expensive, it depends more on the nature of the job or project. So, it's less likely to be the right answer.
5. Choice D: Obtaining knowledge via a meeting is not usually thought of as an expensive process, as meetings can often be attended for free or at a low cost. Therefore, it rules out the choice.
6. Choice E: While knowledge can be expensive to gain in classes, this could be any type of class, not necessarily one that comes with a high cost.
7. Choice A: Universities are commonly referred to as places where one gains knowledge, and it is typically an expensive process due to tuition fees, living expenses, etc. Thus, it fits best with the descriptor 'expensive.'
8. Therefore, the answer is A: University.
So the final answer is A: university

Input: Where are small grapes likely to be found? Choices:  A: lunch box B: food store C: wine country D: kitchen E: raisins
Output: 1. This question is asking for a place where small grapes are typically found.
2. If we look at choice A: lunch box, we can eliminate this option because any type of fruit, not specifically small grapes, could be in a lunch box.  
3. Choice B: food store is a broader option as it could contain all kinds of food, not specifically small grapes.
4. Choice D: kitchen, a place where all types of food are prepared and not solely devoted for small grapes.
5. Choice E: raisins. While grapes are indeed used to make raisins, the question asks for a place where one would find small grapes, not their byproducts.
6. The answer is therefore choice C: wine country. This is because small grapes are often used in making certain types of wine, and vineyards in wine countries are known to cultivate and harvest small grapes specifically for this purpose.
So the final answer is C: wine country

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i5-s20-rTrue
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:39<31:59, 39.17s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:17<30:51, 38.58s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [01:55<30:06, 38.43s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [02:33<29:25, 38.37s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [03:12<28:43, 38.31s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [03:50<28:03, 38.26s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [04:28<27:28, 38.35s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [05:07<26:49, 38.33s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [05:45<26:10, 38.30s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [06:23<25:31, 38.29s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [07:01<24:51, 38.24s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [07:39<24:11, 38.20s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [08:17<23:32, 38.17s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [08:56<22:56, 38.23s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [09:34<22:19, 38.26s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [10:12<21:40, 38.24s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [10:51<21:02, 38.26s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [11:29<20:24, 38.26s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [12:07<19:48, 38.34s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [12:46<19:09, 38.30s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [13:24<18:28, 38.23s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [14:02<17:49, 38.19s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [14:40<17:10, 38.16s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [15:18<16:31, 38.14s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [15:56<15:53, 38.13s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [16:34<15:15, 38.14s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [17:12<14:36, 38.12s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [17:50<13:58, 38.14s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [18:29<13:20, 38.12s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [19:07<12:42, 38.12s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [19:45<12:04, 38.13s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [20:23<11:26, 38.12s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [21:01<10:48, 38.13s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [21:39<10:10, 38.14s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [22:17<09:31, 38.12s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [22:55<08:53, 38.11s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [23:34<08:15, 38.12s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [24:12<07:37, 38.14s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [24:50<06:59, 38.15s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [25:28<06:21, 38.12s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [26:06<05:43, 38.15s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [26:44<05:05, 38.17s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [27:23<04:27, 38.16s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [28:01<03:49, 38.17s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [28:39<03:10, 38.15s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [29:17<02:32, 38.22s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [29:55<01:54, 38.21s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [30:33<01:16, 38.17s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [31:11<00:38, 38.10s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [31:49<00:00, 38.10s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [31:49<00:00, 38.20s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 1.6309} | avg. gen lenth: 432.24
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i6-s20-rTrue --seed 20 --max-prompt-length 2048 --rationales --num-in-domain 6
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-22 12:46:22,813] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i6-s20-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 6
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i6-s20-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 20
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9735 [00:00<?, ?it/s]  0%|▏                                                     | 23/9735 [00:00<00:44, 220.55it/s]  0%|▎                                                     | 46/9735 [00:00<00:43, 220.99it/s]  1%|▍                                                     | 69/9735 [00:00<00:43, 220.42it/s]  1%|▌                                                     | 92/9735 [00:00<00:43, 221.11it/s]  1%|▋                                                    | 115/9735 [00:00<00:43, 221.54it/s]  1%|▊                                                    | 138/9735 [00:00<00:43, 221.73it/s]  2%|▉                                                    | 161/9735 [00:00<00:43, 218.73it/s]  2%|█                                                    | 184/9735 [00:00<00:43, 219.05it/s]  2%|█                                                    | 206/9735 [00:00<00:43, 218.08it/s]  2%|█▏                                                   | 229/9735 [00:01<00:43, 219.09it/s]  3%|█▎                                                   | 252/9735 [00:01<00:43, 219.69it/s]  3%|█▍                                                   | 275/9735 [00:01<00:42, 220.25it/s]  3%|█▌                                                   | 298/9735 [00:01<00:42, 220.39it/s]  3%|█▋                                                   | 321/9735 [00:01<00:42, 220.70it/s]  4%|█▊                                                   | 344/9735 [00:01<00:42, 221.00it/s]  4%|█▉                                                   | 367/9735 [00:01<00:42, 221.08it/s]  4%|██                                                   | 390/9735 [00:01<00:42, 219.23it/s]  4%|██▎                                                  | 415/9735 [00:01<00:41, 226.37it/s]  5%|██▍                                                  | 448/9735 [00:01<00:36, 255.75it/s]  5%|██▌                                                  | 481/9735 [00:02<00:33, 277.51it/s]  5%|██▊                                                  | 515/9735 [00:02<00:31, 294.10it/s]  6%|██▉                                                  | 549/9735 [00:02<00:29, 306.85it/s]  6%|███▏                                                 | 583/9735 [00:02<00:28, 315.77it/s]  6%|███▎                                                 | 617/9735 [00:02<00:28, 322.07it/s]  7%|███▌                                                 | 651/9735 [00:02<00:27, 326.59it/s]  7%|███▋                                                 | 685/9735 [00:02<00:27, 328.07it/s]  7%|███▉                                                 | 719/9735 [00:02<00:27, 330.73it/s]  8%|████                                                 | 753/9735 [00:02<00:27, 332.38it/s]  8%|████▎                                                | 787/9735 [00:02<00:26, 333.79it/s]  8%|████▍                                                | 821/9735 [00:03<00:26, 334.86it/s]  9%|████▋                                                | 855/9735 [00:03<00:26, 335.35it/s]  9%|████▊                                                | 889/9735 [00:03<00:26, 333.90it/s]  9%|█████                                                | 923/9735 [00:03<00:26, 334.76it/s] 10%|█████▏                                               | 957/9735 [00:03<00:26, 335.22it/s] 10%|█████▍                                               | 991/9735 [00:03<00:26, 335.78it/s] 11%|█████▍                                              | 1025/9735 [00:03<00:25, 335.68it/s] 11%|█████▋                                              | 1059/9735 [00:03<00:25, 336.11it/s] 11%|█████▊                                              | 1093/9735 [00:03<00:25, 336.46it/s] 12%|██████                                              | 1127/9735 [00:04<00:25, 334.70it/s] 12%|██████▏                                             | 1161/9735 [00:04<00:25, 335.30it/s] 12%|██████▍                                             | 1195/9735 [00:04<00:25, 335.44it/s] 13%|██████▌                                             | 1229/9735 [00:04<00:25, 335.44it/s] 13%|██████▋                                             | 1263/9735 [00:04<00:25, 335.69it/s] 13%|██████▉                                             | 1297/9735 [00:04<00:25, 336.04it/s] 14%|███████                                             | 1331/9735 [00:04<00:24, 336.44it/s] 14%|███████▎                                            | 1365/9735 [00:04<00:25, 334.60it/s] 14%|███████▍                                            | 1399/9735 [00:04<00:24, 335.00it/s] 15%|███████▋                                            | 1433/9735 [00:04<00:24, 335.41it/s] 15%|███████▊                                            | 1467/9735 [00:05<00:24, 335.88it/s] 15%|████████                                            | 1501/9735 [00:05<00:24, 336.00it/s] 16%|████████▏                                           | 1535/9735 [00:05<00:24, 336.31it/s] 16%|████████▍                                           | 1569/9735 [00:05<00:24, 334.64it/s] 16%|████████▌                                           | 1603/9735 [00:05<00:24, 334.69it/s] 17%|████████▋                                           | 1637/9735 [00:05<00:24, 335.50it/s] 17%|████████▉                                           | 1671/9735 [00:05<00:24, 334.62it/s] 18%|█████████                                           | 1705/9735 [00:05<00:23, 334.76it/s] 18%|█████████▎                                          | 1739/9735 [00:05<00:23, 335.02it/s] 18%|█████████▍                                          | 1773/9735 [00:05<00:23, 331.90it/s] 19%|█████████▋                                          | 1807/9735 [00:06<00:25, 313.85it/s] 19%|█████████▊                                          | 1841/9735 [00:06<00:24, 320.02it/s] 19%|██████████                                          | 1875/9735 [00:06<00:24, 324.43it/s] 20%|██████████▏                                         | 1909/9735 [00:06<00:23, 327.74it/s] 20%|██████████▍                                         | 1943/9735 [00:06<00:23, 329.72it/s] 20%|██████████▌                                         | 1977/9735 [00:06<00:23, 331.46it/s] 21%|██████████▋                                         | 2011/9735 [00:06<00:23, 332.85it/s] 21%|██████████▉                                         | 2045/9735 [00:06<00:23, 331.65it/s] 21%|███████████                                         | 2079/9735 [00:06<00:23, 332.72it/s] 22%|███████████▎                                        | 2113/9735 [00:06<00:23, 330.46it/s] 22%|███████████▍                                        | 2147/9735 [00:07<00:22, 331.92it/s] 22%|███████████▋                                        | 2181/9735 [00:07<00:22, 333.24it/s] 23%|███████████▊                                        | 2215/9735 [00:07<00:22, 334.02it/s] 23%|████████████                                        | 2249/9735 [00:07<00:22, 332.63it/s] 23%|████████████▏                                       | 2283/9735 [00:07<00:22, 333.62it/s] 24%|████████████▍                                       | 2317/9735 [00:07<00:22, 334.23it/s] 24%|████████████▌                                       | 2351/9735 [00:07<00:22, 334.71it/s] 24%|████████████▋                                       | 2385/9735 [00:07<00:21, 335.17it/s] 25%|████████████▉                                       | 2419/9735 [00:07<00:21, 335.50it/s] 25%|█████████████                                       | 2453/9735 [00:07<00:21, 335.41it/s] 26%|█████████████▎                                      | 2487/9735 [00:08<00:21, 333.52it/s] 26%|█████████████▍                                      | 2521/9735 [00:08<00:21, 334.01it/s] 26%|█████████████▋                                      | 2555/9735 [00:08<00:21, 331.62it/s] 27%|█████████████▊                                      | 2589/9735 [00:08<00:21, 333.03it/s] 27%|██████████████                                      | 2623/9735 [00:08<00:21, 333.91it/s] 27%|██████████████▏                                     | 2657/9735 [00:08<00:21, 334.35it/s] 28%|██████████████▎                                     | 2691/9735 [00:08<00:21, 334.41it/s] 28%|██████████████▌                                     | 2725/9735 [00:08<00:21, 332.58it/s] 28%|██████████████▋                                     | 2759/9735 [00:08<00:20, 333.37it/s] 29%|██████████████▉                                     | 2793/9735 [00:09<00:20, 333.93it/s] 29%|███████████████                                     | 2827/9735 [00:09<00:20, 334.37it/s] 29%|███████████████▎                                    | 2861/9735 [00:09<00:20, 334.88it/s] 30%|███████████████▍                                    | 2895/9735 [00:09<00:20, 335.05it/s] 30%|███████████████▋                                    | 2929/9735 [00:09<00:20, 330.85it/s] 30%|███████████████▊                                    | 2963/9735 [00:09<00:20, 330.82it/s] 31%|████████████████                                    | 2997/9735 [00:09<00:20, 329.11it/s] 31%|████████████████▏                                   | 3030/9735 [00:09<00:20, 329.19it/s] 31%|████████████████▎                                   | 3063/9735 [00:09<00:20, 327.93it/s] 32%|████████████████▌                                   | 3097/9735 [00:09<00:20, 330.05it/s] 32%|████████████████▋                                   | 3131/9735 [00:10<00:19, 331.76it/s] 33%|████████████████▉                                   | 3165/9735 [00:10<00:19, 330.61it/s] 33%|█████████████████                                   | 3199/9735 [00:10<00:19, 332.33it/s] 33%|█████████████████▎                                  | 3233/9735 [00:10<00:19, 333.19it/s] 34%|█████████████████▍                                  | 3267/9735 [00:10<00:19, 334.00it/s] 34%|█████████████████▋                                  | 3301/9735 [00:10<00:19, 334.27it/s] 34%|█████████████████▊                                  | 3335/9735 [00:10<00:19, 334.01it/s] 35%|█████████████████▉                                  | 3369/9735 [00:10<00:19, 334.36it/s] 35%|██████████████████▏                                 | 3403/9735 [00:10<00:19, 332.86it/s] 35%|██████████████████▎                                 | 3437/9735 [00:10<00:18, 333.42it/s] 36%|██████████████████▌                                 | 3471/9735 [00:11<00:18, 334.00it/s] 36%|██████████████████▋                                 | 3505/9735 [00:11<00:18, 334.09it/s] 36%|██████████████████▉                                 | 3539/9735 [00:11<00:18, 334.38it/s] 37%|███████████████████                                 | 3573/9735 [00:11<00:18, 334.39it/s] 37%|███████████████████▎                                | 3607/9735 [00:11<00:18, 332.71it/s] 37%|███████████████████▍                                | 3641/9735 [00:11<00:18, 333.62it/s] 38%|███████████████████▋                                | 3675/9735 [00:11<00:18, 333.76it/s] 38%|███████████████████▊                                | 3709/9735 [00:11<00:18, 334.39it/s] 38%|███████████████████▉                                | 3743/9735 [00:11<00:17, 334.86it/s] 39%|████████████████████▏                               | 3777/9735 [00:11<00:17, 334.95it/s] 39%|████████████████████▎                               | 3811/9735 [00:12<00:17, 335.21it/s] 39%|████████████████████▌                               | 3845/9735 [00:12<00:17, 332.83it/s] 40%|████████████████████▋                               | 3879/9735 [00:12<00:17, 333.67it/s] 40%|████████████████████▉                               | 3913/9735 [00:12<00:17, 334.26it/s] 41%|█████████████████████                               | 3947/9735 [00:12<00:17, 334.55it/s] 41%|█████████████████████▎                              | 3981/9735 [00:12<00:17, 334.63it/s] 41%|█████████████████████▍                              | 4015/9735 [00:12<00:17, 335.05it/s] 42%|█████████████████████▋                              | 4049/9735 [00:12<00:17, 333.21it/s] 42%|█████████████████████▊                              | 4083/9735 [00:12<00:17, 330.86it/s] 42%|█████████████████████▉                              | 4117/9735 [00:12<00:16, 332.23it/s] 43%|██████████████████████▏                             | 4151/9735 [00:13<00:16, 333.11it/s] 43%|██████████████████████▎                             | 4185/9735 [00:13<00:16, 333.79it/s] 43%|██████████████████████▌                             | 4219/9735 [00:13<00:16, 334.23it/s] 44%|██████████████████████▋                             | 4253/9735 [00:13<00:16, 334.70it/s] 44%|██████████████████████▉                             | 4287/9735 [00:13<00:16, 333.27it/s] 44%|███████████████████████                             | 4321/9735 [00:13<00:16, 333.85it/s] 45%|███████████████████████▎                            | 4355/9735 [00:13<00:16, 334.30it/s] 45%|███████████████████████▍                            | 4389/9735 [00:13<00:15, 334.68it/s] 45%|███████████████████████▋                            | 4423/9735 [00:13<00:15, 334.58it/s] 46%|███████████████████████▊                            | 4457/9735 [00:13<00:15, 334.54it/s] 46%|███████████████████████▉                            | 4491/9735 [00:14<00:15, 334.69it/s] 46%|████████████████████████▏                           | 4525/9735 [00:14<00:17, 302.69it/s] 47%|████████████████████████▎                           | 4559/9735 [00:14<00:16, 311.81it/s] 47%|████████████████████████▌                           | 4593/9735 [00:14<00:16, 318.59it/s] 48%|████████████████████████▋                           | 4627/9735 [00:14<00:15, 323.57it/s] 48%|████████████████████████▉                           | 4661/9735 [00:14<00:15, 326.89it/s] 48%|█████████████████████████                           | 4695/9735 [00:14<00:15, 329.53it/s] 49%|█████████████████████████▎                          | 4729/9735 [00:14<00:15, 331.30it/s] 49%|█████████████████████████▍                          | 4763/9735 [00:15<00:21, 231.97it/s] 49%|█████████████████████████▌                          | 4797/9735 [00:15<00:19, 255.63it/s] 50%|█████████████████████████▊                          | 4831/9735 [00:15<00:17, 275.16it/s] 50%|█████████████████████████▉                          | 4865/9735 [00:15<00:16, 290.35it/s] 50%|██████████████████████████▏                         | 4899/9735 [00:15<00:15, 302.45it/s] 51%|██████████████████████████▎                         | 4933/9735 [00:15<00:15, 311.55it/s] 51%|██████████████████████████▌                         | 4966/9735 [00:15<00:15, 316.72it/s] 51%|██████████████████████████▋                         | 5000/9735 [00:15<00:14, 322.00it/s] 52%|██████████████████████████▉                         | 5033/9735 [00:15<00:14, 320.32it/s] 52%|███████████████████████████                         | 5067/9735 [00:16<00:14, 323.46it/s] 52%|███████████████████████████▏                        | 5101/9735 [00:16<00:14, 326.98it/s] 53%|███████████████████████████▍                        | 5135/9735 [00:16<00:13, 329.36it/s] 53%|███████████████████████████▌                        | 5169/9735 [00:16<00:13, 331.33it/s] 53%|███████████████████████████▊                        | 5203/9735 [00:16<00:13, 330.57it/s] 54%|███████████████████████████▉                        | 5237/9735 [00:16<00:13, 331.73it/s] 54%|████████████████████████████▏                       | 5271/9735 [00:16<00:13, 332.78it/s] 54%|████████████████████████████▎                       | 5305/9735 [00:16<00:13, 333.35it/s] 55%|████████████████████████████▌                       | 5339/9735 [00:16<00:13, 333.58it/s] 55%|████████████████████████████▋                       | 5373/9735 [00:16<00:13, 333.91it/s] 56%|████████████████████████████▉                       | 5407/9735 [00:17<00:13, 330.53it/s] 56%|█████████████████████████████                       | 5441/9735 [00:17<00:12, 330.63it/s] 56%|█████████████████████████████▏                      | 5475/9735 [00:17<00:12, 330.38it/s] 57%|█████████████████████████████▍                      | 5510/9735 [00:17<00:12, 334.39it/s] 57%|█████████████████████████████▌                      | 5545/9735 [00:17<00:12, 337.58it/s] 57%|█████████████████████████████▊                      | 5580/9735 [00:17<00:12, 339.74it/s] 58%|█████████████████████████████▉                      | 5615/9735 [00:17<00:12, 341.21it/s] 58%|██████████████████████████████▏                     | 5650/9735 [00:17<00:11, 340.47it/s] 58%|██████████████████████████████▎                     | 5685/9735 [00:17<00:11, 341.86it/s] 59%|██████████████████████████████▌                     | 5720/9735 [00:17<00:11, 342.91it/s] 59%|██████████████████████████████▋                     | 5755/9735 [00:18<00:11, 343.28it/s] 59%|██████████████████████████████▉                     | 5790/9735 [00:18<00:11, 343.82it/s] 60%|███████████████████████████████                     | 5825/9735 [00:18<00:11, 344.29it/s] 60%|███████████████████████████████▎                    | 5860/9735 [00:18<00:11, 342.73it/s] 61%|███████████████████████████████▍                    | 5895/9735 [00:18<00:11, 343.59it/s] 61%|███████████████████████████████▋                    | 5930/9735 [00:18<00:11, 344.05it/s] 61%|███████████████████████████████▊                    | 5965/9735 [00:18<00:10, 343.11it/s] 62%|████████████████████████████████                    | 6000/9735 [00:18<00:10, 341.96it/s] 62%|████████████████████████████████▏                   | 6035/9735 [00:18<00:10, 343.08it/s] 62%|████████████████████████████████▍                   | 6070/9735 [00:18<00:10, 343.04it/s] 63%|████████████████████████████████▌                   | 6105/9735 [00:19<00:10, 341.90it/s] 63%|████████████████████████████████▊                   | 6140/9735 [00:19<00:10, 342.61it/s] 63%|████████████████████████████████▉                   | 6175/9735 [00:19<00:10, 343.53it/s] 64%|█████████████████████████████████▏                  | 6210/9735 [00:19<00:10, 344.00it/s] 64%|█████████████████████████████████▎                  | 6245/9735 [00:19<00:10, 343.83it/s] 65%|█████████████████████████████████▌                  | 6280/9735 [00:19<00:10, 341.52it/s] 65%|█████████████████████████████████▋                  | 6315/9735 [00:19<00:10, 338.23it/s] 65%|█████████████████████████████████▉                  | 6350/9735 [00:19<00:09, 339.77it/s] 66%|██████████████████████████████████                  | 6385/9735 [00:19<00:09, 341.38it/s] 66%|██████████████████████████████████▎                 | 6420/9735 [00:19<00:09, 342.40it/s] 66%|██████████████████████████████████▍                 | 6455/9735 [00:20<00:09, 342.85it/s] 67%|██████████████████████████████████▋                 | 6490/9735 [00:20<00:09, 343.44it/s] 67%|██████████████████████████████████▊                 | 6525/9735 [00:20<00:09, 343.42it/s] 67%|███████████████████████████████████                 | 6560/9735 [00:20<00:09, 342.00it/s] 68%|███████████████████████████████████▏                | 6595/9735 [00:20<00:09, 342.58it/s] 68%|███████████████████████████████████▍                | 6630/9735 [00:20<00:09, 343.25it/s] 68%|███████████████████████████████████▌                | 6665/9735 [00:20<00:08, 343.19it/s] 69%|███████████████████████████████████▊                | 6700/9735 [00:20<00:08, 343.50it/s] 69%|███████████████████████████████████▉                | 6735/9735 [00:20<00:08, 343.93it/s] 70%|████████████████████████████████████▏               | 6770/9735 [00:21<00:08, 342.63it/s] 70%|████████████████████████████████████▎               | 6805/9735 [00:21<00:08, 343.28it/s] 70%|████████████████████████████████████▌               | 6840/9735 [00:21<00:08, 343.75it/s] 71%|████████████████████████████████████▋               | 6875/9735 [00:21<00:08, 344.06it/s] 71%|████████████████████████████████████▉               | 6910/9735 [00:21<00:08, 344.29it/s] 71%|█████████████████████████████████████               | 6945/9735 [00:21<00:08, 344.54it/s] 72%|█████████████████████████████████████▎              | 6980/9735 [00:21<00:07, 344.48it/s] 72%|█████████████████████████████████████▍              | 7015/9735 [00:21<00:07, 342.54it/s] 72%|█████████████████████████████████████▋              | 7050/9735 [00:21<00:07, 343.15it/s] 73%|█████████████████████████████████████▊              | 7085/9735 [00:21<00:07, 343.61it/s] 73%|██████████████████████████████████████              | 7120/9735 [00:22<00:07, 343.88it/s] 73%|██████████████████████████████████████▏             | 7155/9735 [00:22<00:07, 339.00it/s] 74%|██████████████████████████████████████▍             | 7189/9735 [00:22<00:07, 338.96it/s] 74%|██████████████████████████████████████▌             | 7223/9735 [00:22<00:07, 337.06it/s] 75%|██████████████████████████████████████▊             | 7258/9735 [00:22<00:07, 339.21it/s] 75%|██████████████████████████████████████▉             | 7293/9735 [00:22<00:07, 340.71it/s] 75%|███████████████████████████████████████▏            | 7328/9735 [00:22<00:07, 341.86it/s] 76%|███████████████████████████████████████▎            | 7363/9735 [00:22<00:06, 342.80it/s] 76%|███████████████████████████████████████▌            | 7398/9735 [00:22<00:06, 343.21it/s] 76%|███████████████████████████████████████▋            | 7433/9735 [00:22<00:06, 343.18it/s] 77%|███████████████████████████████████████▉            | 7468/9735 [00:23<00:07, 320.83it/s] 77%|████████████████████████████████████████            | 7503/9735 [00:23<00:06, 327.22it/s] 77%|████████████████████████████████████████▎           | 7538/9735 [00:23<00:06, 331.91it/s] 78%|████████████████████████████████████████▍           | 7573/9735 [00:23<00:06, 335.51it/s] 78%|████████████████████████████████████████▋           | 7608/9735 [00:23<00:06, 337.91it/s] 79%|████████████████████████████████████████▊           | 7643/9735 [00:23<00:06, 339.44it/s] 79%|█████████████████████████████████████████           | 7678/9735 [00:23<00:06, 338.99it/s] 79%|█████████████████████████████████████████▏          | 7713/9735 [00:23<00:05, 340.73it/s] 80%|█████████████████████████████████████████▍          | 7748/9735 [00:23<00:05, 341.92it/s] 80%|█████████████████████████████████████████▌          | 7783/9735 [00:23<00:05, 342.56it/s] 80%|█████████████████████████████████████████▊          | 7818/9735 [00:24<00:05, 340.63it/s] 81%|█████████████████████████████████████████▉          | 7853/9735 [00:24<00:05, 341.45it/s] 81%|██████████████████████████████████████████▏         | 7888/9735 [00:24<00:05, 342.16it/s] 81%|██████████████████████████████████████████▎         | 7923/9735 [00:24<00:05, 341.16it/s] 82%|██████████████████████████████████████████▌         | 7958/9735 [00:24<00:05, 339.43it/s] 82%|██████████████████████████████████████████▋         | 7992/9735 [00:24<00:05, 339.04it/s] 82%|██████████████████████████████████████████▉         | 8027/9735 [00:24<00:05, 340.48it/s] 83%|███████████████████████████████████████████         | 8062/9735 [00:24<00:04, 341.40it/s] 83%|███████████████████████████████████████████▎        | 8097/9735 [00:24<00:04, 342.28it/s] 84%|███████████████████████████████████████████▍        | 8132/9735 [00:25<00:04, 341.41it/s] 84%|███████████████████████████████████████████▌        | 8167/9735 [00:25<00:04, 342.21it/s] 84%|███████████████████████████████████████████▊        | 8202/9735 [00:25<00:04, 342.83it/s] 85%|███████████████████████████████████████████▉        | 8237/9735 [00:25<00:04, 343.22it/s] 85%|████████████████████████████████████████████▏       | 8272/9735 [00:25<00:04, 343.33it/s] 85%|████████████████████████████████████████████▎       | 8307/9735 [00:25<00:04, 343.27it/s] 86%|████████████████████████████████████████████▌       | 8342/9735 [00:25<00:04, 343.51it/s] 86%|████████████████████████████████████████████▋       | 8377/9735 [00:25<00:04, 338.87it/s] 86%|████████████████████████████████████████████▉       | 8412/9735 [00:25<00:03, 340.29it/s] 87%|█████████████████████████████████████████████       | 8447/9735 [00:25<00:03, 341.35it/s] 87%|█████████████████████████████████████████████▎      | 8482/9735 [00:26<00:03, 342.13it/s] 87%|█████████████████████████████████████████████▍      | 8517/9735 [00:26<00:03, 342.84it/s] 88%|█████████████████████████████████████████████▋      | 8552/9735 [00:26<00:03, 342.93it/s] 88%|█████████████████████████████████████████████▊      | 8587/9735 [00:26<00:03, 341.18it/s] 89%|██████████████████████████████████████████████      | 8622/9735 [00:26<00:03, 341.75it/s] 89%|██████████████████████████████████████████████▏     | 8657/9735 [00:26<00:03, 342.32it/s] 89%|██████████████████████████████████████████████▍     | 8692/9735 [00:26<00:03, 342.88it/s] 90%|██████████████████████████████████████████████▌     | 8727/9735 [00:26<00:02, 343.10it/s] 90%|██████████████████████████████████████████████▊     | 8762/9735 [00:26<00:02, 342.19it/s] 90%|██████████████████████████████████████████████▉     | 8797/9735 [00:26<00:02, 338.39it/s] 91%|███████████████████████████████████████████████▏    | 8831/9735 [00:27<00:02, 338.03it/s] 91%|███████████████████████████████████████████████▎    | 8866/9735 [00:27<00:02, 339.64it/s] 91%|███████████████████████████████████████████████▌    | 8901/9735 [00:27<00:02, 340.91it/s] 92%|███████████████████████████████████████████████▋    | 8936/9735 [00:27<00:02, 341.80it/s] 92%|███████████████████████████████████████████████▉    | 8971/9735 [00:27<00:02, 339.75it/s] 93%|████████████████████████████████████████████████    | 9006/9735 [00:27<00:02, 340.95it/s] 93%|████████████████████████████████████████████████▎   | 9041/9735 [00:27<00:02, 339.91it/s] 93%|████████████████████████████████████████████████▍   | 9076/9735 [00:27<00:01, 341.02it/s] 94%|████████████████████████████████████████████████▋   | 9111/9735 [00:27<00:01, 341.66it/s] 94%|████████████████████████████████████████████████▊   | 9146/9735 [00:27<00:01, 342.23it/s] 94%|█████████████████████████████████████████████████   | 9181/9735 [00:28<00:01, 342.77it/s] 95%|█████████████████████████████████████████████████▏  | 9216/9735 [00:28<00:01, 342.87it/s] 95%|█████████████████████████████████████████████████▍  | 9251/9735 [00:28<00:01, 343.29it/s] 95%|█████████████████████████████████████████████████▌  | 9286/9735 [00:28<00:01, 341.61it/s] 96%|█████████████████████████████████████████████████▊  | 9321/9735 [00:28<00:01, 342.10it/s] 96%|█████████████████████████████████████████████████▉  | 9356/9735 [00:28<00:01, 342.53it/s] 96%|██████████████████████████████████████████████████▏ | 9391/9735 [00:28<00:01, 342.90it/s] 97%|██████████████████████████████████████████████████▎ | 9426/9735 [00:28<00:00, 342.90it/s] 97%|██████████████████████████████████████████████████▌ | 9461/9735 [00:28<00:00, 342.77it/s] 98%|██████████████████████████████████████████████████▋ | 9496/9735 [00:29<00:00, 339.28it/s] 98%|██████████████████████████████████████████████████▉ | 9530/9735 [00:29<00:00, 335.51it/s] 98%|███████████████████████████████████████████████████ | 9565/9735 [00:29<00:00, 337.56it/s] 99%|███████████████████████████████████████████████████▎| 9600/9735 [00:29<00:00, 338.96it/s] 99%|███████████████████████████████████████████████████▍| 9635/9735 [00:29<00:00, 340.24it/s] 99%|███████████████████████████████████████████████████▋| 9670/9735 [00:29<00:00, 340.85it/s]100%|███████████████████████████████████████████████████▊| 9705/9735 [00:29<00:00, 339.82it/s]100%|████████████████████████████████████████████████████| 9735/9735 [00:29<00:00, 327.59it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.29s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.27s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.20s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:11,  5.63s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.19s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.23s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.27s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.41s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.58s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.75s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.63s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.80s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.65s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.81s/it]
[2023-08-22 12:47:44,688] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.76s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.96s/it]
[2023-08-22 12:47:56,035] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-22 12:47:56,036] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-22 12:47:56,037] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-22 12:47:56,037] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-22 12:47:56,037] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-22 12:47:56,037] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-22 12:47:56,037] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-22 12:47:56,037] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-22 12:47:56,037] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-22 12:47:56,037] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-22 12:47:56,037] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-22 12:47:56,037] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f9528290fd0>
[2023-08-22 12:47:56,037] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-22 12:47:56,037] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-22 12:47:56,037] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-22 12:47:56,038] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-22 12:47:56,038] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-22 12:47:56,038] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-22 12:47:56,038] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-22 12:47:56,038] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-22 12:47:56,038] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-22 12:47:56,038] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-22 12:47:56,038] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-22 12:47:56,038] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-22 12:47:56,038] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-22 12:47:56,038] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-22 12:47:56,038] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-22 12:47:56,038] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-22 12:47:56,038] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-22 12:47:56,038] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-22 12:47:56,038] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-22 12:47:56,038] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-22 12:47:56,038] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-22 12:47:56,038] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-22 12:47:56,038] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-22 12:47:56,038] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-22 12:47:56,038] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-22 12:47:56,038] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-22 12:47:56,038] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-22 12:47:56,038] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-22 12:47:56,038] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-22 12:47:56,038] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-22 12:47:56,038] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-22 12:47:56,038] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-22 12:47:56,038] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f9525fe7220>
[2023-08-22 12:47:56,038] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-22 12:47:56,038] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-22 12:47:56,038] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-22 12:47:56,039] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-22 12:47:56,039] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-22 12:47:56,039] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-22 12:47:56,039] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-22 12:47:56,039] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-22 12:47:56,039] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-22 12:47:56,039] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-22 12:47:56,039] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-22 12:47:56,039] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-22 12:47:56,039] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-22 12:47:56,039] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-22 12:47:56,039] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-22 12:47:56,039] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-22 12:47:56,039] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-22 12:47:56,039] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-22 12:47:56,039] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-22 12:47:56,039] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-22 12:47:56,039] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-22 12:47:56,039] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-22 12:47:56,039] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.54742431640625 seconds
Loading extension module utils...
Time to load utils op: 0.5046324729919434 seconds
Time to load utils op: 0.30437779426574707 seconds
Loading extension module utils...
Time to load utils op: 0.5046279430389404 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: The machine was very intricate, it was quite an what? Choices:  A: box B: apparatus C: appliance D: wash dishes E: implement
Output: 1. We need to fill in the blank using one of the provided choices. 
2. The context implies that the machine is very intricate or complex. Therefore, we need to find a word among the choices that adequately represents a complex machine.
3. The words "box" and "wash dishes" don't fit because they don't convey the complexity of a machine.
4. Although "appliance" and "implement" might make sense of complexity, they're too specific. These words are used for machines designed for a specific purpose. Without knowing the specific function of the machine, these words might misrepresent it.
5. The word "apparatus" is a general term for a complex machine, irrespective of what specific function it performs, fitting the context of sentence.
6. Therefore, the answer is B: apparatus.
So the final answer is B: apparatus

Input: Where do you get petrol? Choices:  A: burn hot B: fuel tank C: burn hot D: car E: gas station
Output: 1. First, eliminate irrelevant choices. In this context, the items "burn hot" and "car" can be eliminated as they do not specifically relate to the source of petrol.
2. Among the remaining options, "fuel tank" can be eliminated as a petrol source. Although petrol is stored in a fuel tank, it does not originate from there.
3. Therefore, the correct answer is "gas station", where petrol is usually purchased or obtained.
So the final answer is E: gas station

Input: Where might a television used at night be? Choices:  A: cabinet B: house C: apartment D: bedroom E: woods
Output: 1. The question asks where a television used at night might be.
2. A television is typically an indoor item, so both the woods and a cabinet wouldn't provide the appropriate setting or the purpose of watching television. So options A and E can be eliminated.
3. Remaining choices are the house, the apartment, and the bedroom.
4. While a television can be located in both a house and an apartment, these choices lack the specificity needed to determine the exact location within those places, hence may not be suitable responses.
5. This leaves the bedroom where it's common for people to have a TV and use at night before sleeping. 
6. Thus, the answer is D: bedroom.
So the final answer is D: bedroom

Input: The knowledge was expensive to get, where was it being gained? Choices:  A: university B: book C: field D: meeting E: class
Output: 1. The question is asking for a place where gaining knowledge is considered expensive. 
2. Although knowledge can be gained in all of the options given (university, book, field, meeting, class), not all of them are notably expensive. 
3. From our everyday understanding, we know that buying a book is considerably cheaper than paying for a university or class. Similarly, learning in a field or a meeting does not necessarily imply a high cost. 
4. Therefore, amongst the given choices, getting a university education usually involves significant costs, making it the most expensive medium to gain knowledge. 
5. Thus, the answer is "A: university".
So the final answer is A: university

Input: Where are small grapes likely to be found? Choices:  A: lunch box B: food store C: wine country D: kitchen E: raisins
Output: 1. The question is asking where you are likely to find small grapes. 
2. Grapes can be found in all the options provided. However, the question specifically mentions "small" grapes. 
3. In a lunch box, kitchen, or food store, the size of the grapes might vary and are not necessarily small.
4. Raisins are dried grapes, so they wouldn't be considered as small grapes. 
5. Small grapes are generally used in wine production because they have a better skin to fruit ratio, which is ideal for wine-making.
6. Wine is predominantly made in the wine country.
7. Therefore, small grapes are most likely to be found in the wine country. Hence, the answer is C: wine country.
So the final answer is C: wine country

Input: The painter explained how he never achieved a flawless portrait, he said this was because all people are what? Choices:  A: imperfect B: disfigured C: damaged D: flawed E: defective
Output: 1. Begin with understanding the question: we're being asked to figure out what the painter associates with why he is unable to create a flawless portrait.
2. Consider all the choices given: imperfect, disfigured, damaged, flawed, defective. 
3. Evaluate all the presented choices. The painter's inability to create a perfect portrait does not necessarily mean that all people are disfigured, damaged, flawed, or defective. These are strong words and talk about physical or mental damage or deformities, which is not implied in the question.
4. The word 'flawless' is the clue it's synonymous with 'perfect'. So the reason why the painter never achieved a flawless portrait is because he believes all people are imperfect.
5. Therefore the answer is A: imperfect. 
6. Conclude that the reasoning behind this answer is that 'imperfect' is a less harsh term and is synonymous with 'flawless', making it the most fitting word choice in this context.
So the final answer is A: imperfect

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i6-s20-rTrue
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:40<33:01, 40.44s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:19<31:48, 39.76s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [01:58<30:53, 39.44s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [02:37<30:06, 39.27s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [03:16<29:23, 39.18s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [03:55<28:40, 39.11s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [04:34<28:00, 39.09s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [05:13<27:20, 39.05s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [05:52<26:42, 39.08s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [06:32<26:03, 39.10s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [07:11<25:26, 39.13s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [07:50<24:44, 39.07s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [08:29<24:04, 39.05s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [09:08<23:31, 39.20s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [09:48<22:53, 39.26s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [10:27<22:14, 39.25s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [11:06<21:34, 39.24s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [11:45<20:55, 39.25s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [12:25<20:16, 39.23s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [13:04<19:36, 39.22s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [13:43<18:55, 39.15s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [14:22<18:16, 39.14s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [15:01<17:40, 39.26s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [15:40<16:59, 39.22s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [16:19<16:18, 39.14s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [16:58<15:38, 39.10s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [17:38<15:01, 39.18s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [18:17<14:24, 39.31s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [18:57<13:45, 39.33s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [19:36<13:05, 39.29s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [20:15<12:24, 39.20s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [20:54<11:46, 39.26s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [21:34<11:06, 39.23s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [22:13<10:27, 39.23s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [22:52<09:48, 39.20s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [23:32<09:10, 39.31s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [24:11<08:30, 39.28s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [24:50<07:51, 39.28s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [25:29<07:12, 39.28s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [26:08<06:32, 39.25s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [26:48<05:52, 39.21s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [27:27<05:13, 39.23s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [28:06<04:34, 39.18s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [28:45<03:55, 39.18s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [29:24<03:15, 39.16s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [30:03<02:36, 39.15s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [30:43<01:57, 39.26s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [31:22<01:18, 39.22s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [32:01<00:39, 39.30s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [32:41<00:00, 39.31s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [32:41<00:00, 39.23s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 1.5616} | avg. gen lenth: 409.432
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i7-s20-rTrue --seed 20 --max-prompt-length 2048 --rationales --num-in-domain 7
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-22 13:20:46,304] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i7-s20-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 7
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i7-s20-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 20
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9734 [00:00<?, ?it/s]  0%|                                                      | 15/9734 [00:00<01:09, 140.63it/s]  0%|▏                                                     | 30/9734 [00:00<01:08, 141.17it/s]  0%|▏                                                     | 45/9734 [00:00<01:08, 141.52it/s]  1%|▎                                                     | 60/9734 [00:00<01:08, 141.48it/s]  1%|▍                                                     | 75/9734 [00:00<01:08, 141.97it/s]  1%|▍                                                     | 90/9734 [00:00<01:08, 140.50it/s]  1%|▌                                                    | 105/9734 [00:00<01:08, 141.18it/s]  1%|▋                                                    | 120/9734 [00:00<01:07, 141.61it/s]  1%|▋                                                    | 135/9734 [00:00<01:07, 141.95it/s]  2%|▊                                                    | 150/9734 [00:01<01:07, 141.95it/s]  2%|▉                                                    | 165/9734 [00:01<01:07, 141.87it/s]  2%|▉                                                    | 180/9734 [00:01<01:07, 141.67it/s]  2%|█                                                    | 195/9734 [00:01<01:07, 141.60it/s]  2%|█▏                                                   | 212/9734 [00:01<01:03, 148.81it/s]  2%|█▎                                                   | 234/9734 [00:01<00:56, 168.44it/s]  3%|█▍                                                   | 256/9734 [00:01<00:52, 181.26it/s]  3%|█▌                                                   | 278/9734 [00:01<00:49, 191.51it/s]  3%|█▋                                                   | 300/9734 [00:01<00:47, 198.38it/s]  3%|█▊                                                   | 322/9734 [00:01<00:46, 203.58it/s]  4%|█▊                                                   | 344/9734 [00:02<00:45, 207.02it/s]  4%|█▉                                                   | 366/9734 [00:02<00:44, 209.40it/s]  4%|██                                                   | 388/9734 [00:02<00:44, 210.83it/s]  4%|██▏                                                  | 410/9734 [00:02<00:43, 212.27it/s]  4%|██▎                                                  | 432/9734 [00:02<00:44, 211.40it/s]  5%|██▍                                                  | 454/9734 [00:02<00:43, 212.78it/s]  5%|██▌                                                  | 476/9734 [00:02<00:43, 213.80it/s]  5%|██▋                                                  | 498/9734 [00:02<00:43, 214.49it/s]  5%|██▊                                                  | 520/9734 [00:02<00:42, 215.12it/s]  6%|██▉                                                  | 542/9734 [00:03<00:42, 215.42it/s]  6%|███                                                  | 564/9734 [00:03<00:42, 215.38it/s]  6%|███▏                                                 | 586/9734 [00:03<00:42, 214.87it/s]  6%|███▎                                                 | 608/9734 [00:03<00:42, 212.90it/s]  6%|███▍                                                 | 630/9734 [00:03<00:42, 212.22it/s]  7%|███▌                                                 | 652/9734 [00:03<00:42, 213.15it/s]  7%|███▋                                                 | 674/9734 [00:03<00:42, 212.56it/s]  7%|███▊                                                 | 696/9734 [00:03<00:42, 213.75it/s]  7%|███▉                                                 | 718/9734 [00:03<00:42, 214.40it/s]  8%|████                                                 | 740/9734 [00:03<00:41, 215.35it/s]  8%|████▏                                                | 762/9734 [00:04<00:41, 216.13it/s]  8%|████▎                                                | 784/9734 [00:04<00:41, 216.86it/s]  8%|████▍                                                | 806/9734 [00:04<00:41, 217.27it/s]  9%|████▌                                                | 828/9734 [00:04<00:41, 216.35it/s]  9%|████▋                                                | 850/9734 [00:04<00:41, 215.22it/s]  9%|████▋                                                | 872/9734 [00:04<00:41, 215.52it/s]  9%|████▊                                                | 894/9734 [00:04<00:41, 214.42it/s]  9%|████▉                                                | 916/9734 [00:04<00:40, 215.41it/s] 10%|█████                                                | 938/9734 [00:04<00:40, 216.26it/s] 10%|█████▏                                               | 960/9734 [00:04<00:40, 216.89it/s] 10%|█████▎                                               | 982/9734 [00:05<00:40, 217.33it/s] 10%|█████▎                                              | 1004/9734 [00:05<00:40, 217.29it/s] 11%|█████▍                                              | 1026/9734 [00:05<00:40, 217.28it/s] 11%|█████▌                                              | 1048/9734 [00:05<00:39, 217.59it/s] 11%|█████▋                                              | 1070/9734 [00:05<00:39, 216.84it/s] 11%|█████▊                                              | 1092/9734 [00:05<00:40, 214.77it/s] 11%|█████▉                                              | 1114/9734 [00:05<00:40, 214.01it/s] 12%|██████                                              | 1136/9734 [00:05<00:39, 215.25it/s] 12%|██████▏                                             | 1158/9734 [00:05<00:39, 216.10it/s] 12%|██████▎                                             | 1180/9734 [00:05<00:39, 216.64it/s] 12%|██████▍                                             | 1202/9734 [00:06<00:39, 216.79it/s] 13%|██████▌                                             | 1224/9734 [00:06<00:39, 216.76it/s] 13%|██████▋                                             | 1246/9734 [00:06<00:39, 216.43it/s] 13%|██████▊                                             | 1268/9734 [00:06<00:39, 215.99it/s] 13%|██████▉                                             | 1290/9734 [00:06<00:38, 216.57it/s] 13%|███████                                             | 1312/9734 [00:06<00:38, 216.60it/s] 14%|███████▏                                            | 1334/9734 [00:06<00:38, 216.48it/s] 14%|███████▏                                            | 1356/9734 [00:06<00:38, 215.25it/s] 14%|███████▎                                            | 1378/9734 [00:06<00:39, 214.13it/s] 14%|███████▍                                            | 1400/9734 [00:06<00:38, 215.11it/s] 15%|███████▌                                            | 1422/9734 [00:07<00:38, 215.87it/s] 15%|███████▋                                            | 1444/9734 [00:07<00:38, 215.89it/s] 15%|███████▊                                            | 1466/9734 [00:07<00:38, 216.45it/s] 15%|███████▉                                            | 1488/9734 [00:07<00:38, 216.87it/s] 16%|████████                                            | 1510/9734 [00:07<00:37, 216.86it/s] 16%|████████▏                                           | 1532/9734 [00:07<00:37, 216.97it/s] 16%|████████▎                                           | 1554/9734 [00:07<00:37, 217.29it/s] 16%|████████▍                                           | 1576/9734 [00:07<00:37, 215.28it/s] 16%|████████▌                                           | 1598/9734 [00:07<00:37, 215.99it/s] 17%|████████▋                                           | 1620/9734 [00:08<00:37, 216.35it/s] 17%|████████▊                                           | 1642/9734 [00:08<00:37, 216.85it/s] 17%|████████▉                                           | 1664/9734 [00:08<00:37, 216.58it/s] 17%|█████████                                           | 1686/9734 [00:08<00:37, 216.31it/s] 18%|█████████                                           | 1708/9734 [00:08<00:37, 216.45it/s] 18%|█████████▏                                          | 1730/9734 [00:08<00:36, 216.36it/s] 18%|█████████▎                                          | 1752/9734 [00:08<00:36, 216.40it/s] 18%|█████████▍                                          | 1774/9734 [00:08<00:36, 216.39it/s] 18%|█████████▌                                          | 1796/9734 [00:08<00:40, 195.72it/s] 19%|█████████▋                                          | 1818/9734 [00:08<00:39, 201.66it/s] 19%|█████████▊                                          | 1840/9734 [00:09<00:38, 205.90it/s] 19%|█████████▉                                          | 1862/9734 [00:09<00:37, 209.21it/s] 19%|██████████                                          | 1884/9734 [00:09<00:37, 211.51it/s] 20%|██████████▏                                         | 1906/9734 [00:09<00:36, 213.29it/s] 20%|██████████▎                                         | 1928/9734 [00:09<00:36, 214.35it/s] 20%|██████████▍                                         | 1950/9734 [00:09<00:36, 215.26it/s] 20%|██████████▌                                         | 1972/9734 [00:09<00:36, 215.46it/s] 20%|██████████▋                                         | 1994/9734 [00:09<00:35, 216.02it/s] 21%|██████████▊                                         | 2016/9734 [00:09<00:35, 216.28it/s] 21%|██████████▉                                         | 2038/9734 [00:09<00:35, 214.81it/s] 21%|███████████                                         | 2060/9734 [00:10<00:35, 215.33it/s] 21%|███████████                                         | 2082/9734 [00:10<00:35, 215.73it/s] 22%|███████████▏                                        | 2104/9734 [00:10<00:35, 216.08it/s] 22%|███████████▎                                        | 2126/9734 [00:10<00:35, 216.40it/s] 22%|███████████▍                                        | 2148/9734 [00:10<00:35, 216.24it/s] 22%|███████████▌                                        | 2170/9734 [00:10<00:34, 216.26it/s] 23%|███████████▋                                        | 2192/9734 [00:10<00:34, 216.36it/s] 23%|███████████▊                                        | 2214/9734 [00:10<00:34, 216.58it/s] 23%|███████████▉                                        | 2236/9734 [00:10<00:34, 216.54it/s] 23%|████████████                                        | 2258/9734 [00:10<00:34, 215.04it/s] 23%|████████████▏                                       | 2280/9734 [00:11<00:34, 215.36it/s] 24%|████████████▎                                       | 2302/9734 [00:11<00:34, 215.76it/s] 24%|████████████▍                                       | 2324/9734 [00:11<00:34, 215.75it/s] 24%|████████████▌                                       | 2346/9734 [00:11<00:34, 215.71it/s] 24%|████████████▋                                       | 2368/9734 [00:11<00:34, 214.93it/s] 25%|████████████▊                                       | 2390/9734 [00:11<00:34, 213.75it/s] 25%|████████████▉                                       | 2412/9734 [00:11<00:34, 214.41it/s] 25%|█████████████                                       | 2434/9734 [00:11<00:33, 215.07it/s] 25%|█████████████                                       | 2456/9734 [00:11<00:33, 215.31it/s] 25%|█████████████▏                                      | 2478/9734 [00:12<00:33, 214.06it/s] 26%|█████████████▎                                      | 2500/9734 [00:12<00:33, 214.66it/s] 26%|█████████████▍                                      | 2522/9734 [00:12<00:33, 215.09it/s] 26%|█████████████▌                                      | 2544/9734 [00:12<00:33, 215.26it/s] 26%|█████████████▋                                      | 2566/9734 [00:12<00:33, 215.56it/s] 27%|█████████████▊                                      | 2588/9734 [00:12<00:33, 215.95it/s] 27%|█████████████▉                                      | 2610/9734 [00:12<00:32, 216.20it/s] 27%|██████████████                                      | 2632/9734 [00:12<00:32, 216.31it/s] 27%|██████████████▏                                     | 2654/9734 [00:12<00:32, 216.43it/s] 27%|██████████████▎                                     | 2676/9734 [00:12<00:32, 216.43it/s] 28%|██████████████▍                                     | 2698/9734 [00:13<00:32, 216.49it/s] 28%|██████████████▌                                     | 2720/9734 [00:13<00:32, 214.84it/s] 28%|██████████████▋                                     | 2742/9734 [00:13<00:32, 215.45it/s] 28%|██████████████▊                                     | 2764/9734 [00:13<00:32, 214.88it/s] 29%|██████████████▉                                     | 2786/9734 [00:13<00:32, 215.38it/s] 29%|███████████████                                     | 2808/9734 [00:13<00:32, 215.78it/s] 29%|███████████████                                     | 2830/9734 [00:13<00:31, 215.99it/s] 29%|███████████████▏                                    | 2852/9734 [00:13<00:31, 216.33it/s] 30%|███████████████▎                                    | 2874/9734 [00:13<00:31, 216.69it/s] 30%|███████████████▍                                    | 2896/9734 [00:13<00:31, 216.66it/s] 30%|███████████████▌                                    | 2918/9734 [00:14<00:31, 216.95it/s] 30%|███████████████▋                                    | 2940/9734 [00:14<00:31, 215.00it/s] 30%|███████████████▊                                    | 2962/9734 [00:14<00:31, 211.74it/s] 31%|███████████████▉                                    | 2984/9734 [00:14<00:31, 213.10it/s] 31%|████████████████                                    | 3006/9734 [00:14<00:31, 214.26it/s] 31%|████████████████▏                                   | 3028/9734 [00:14<00:31, 214.86it/s] 31%|████████████████▎                                   | 3050/9734 [00:14<00:31, 214.69it/s] 32%|████████████████▍                                   | 3072/9734 [00:14<00:30, 215.18it/s] 32%|████████████████▌                                   | 3094/9734 [00:14<00:30, 215.50it/s] 32%|████████████████▋                                   | 3116/9734 [00:14<00:30, 215.54it/s] 32%|████████████████▊                                   | 3138/9734 [00:15<00:30, 215.92it/s] 32%|████████████████▉                                   | 3160/9734 [00:15<00:30, 214.47it/s] 33%|████████████████▉                                   | 3182/9734 [00:15<00:30, 215.25it/s] 33%|█████████████████                                   | 3204/9734 [00:15<00:30, 215.77it/s] 33%|█████████████████▏                                  | 3226/9734 [00:15<00:30, 215.46it/s] 33%|█████████████████▎                                  | 3248/9734 [00:15<00:30, 216.07it/s] 34%|█████████████████▍                                  | 3270/9734 [00:15<00:29, 216.20it/s] 34%|█████████████████▌                                  | 3292/9734 [00:15<00:29, 216.30it/s] 34%|█████████████████▋                                  | 3314/9734 [00:15<00:29, 215.49it/s] 34%|█████████████████▊                                  | 3336/9734 [00:16<00:29, 215.55it/s] 34%|█████████████████▉                                  | 3358/9734 [00:16<00:29, 215.62it/s] 35%|██████████████████                                  | 3380/9734 [00:16<00:29, 214.44it/s] 35%|██████████████████▏                                 | 3402/9734 [00:16<00:29, 215.16it/s] 35%|██████████████████▎                                 | 3424/9734 [00:16<00:29, 215.66it/s] 35%|██████████████████▍                                 | 3446/9734 [00:16<00:29, 215.46it/s] 36%|██████████████████▌                                 | 3468/9734 [00:16<00:29, 215.19it/s] 36%|██████████████████▋                                 | 3490/9734 [00:16<00:29, 214.85it/s] 36%|██████████████████▊                                 | 3512/9734 [00:16<00:28, 215.08it/s] 36%|██████████████████▉                                 | 3534/9734 [00:16<00:28, 215.55it/s] 37%|██████████████████▉                                 | 3556/9734 [00:17<00:28, 215.98it/s] 37%|███████████████████                                 | 3578/9734 [00:17<00:28, 216.14it/s] 37%|███████████████████▏                                | 3600/9734 [00:17<00:28, 216.37it/s] 37%|███████████████████▎                                | 3622/9734 [00:17<00:28, 214.40it/s] 37%|███████████████████▍                                | 3644/9734 [00:17<00:28, 215.04it/s] 38%|███████████████████▌                                | 3666/9734 [00:17<00:28, 215.46it/s] 38%|███████████████████▋                                | 3688/9734 [00:17<00:27, 216.07it/s] 38%|███████████████████▊                                | 3710/9734 [00:17<00:27, 216.29it/s] 38%|███████████████████▉                                | 3732/9734 [00:17<00:27, 216.41it/s] 39%|████████████████████                                | 3754/9734 [00:17<00:27, 216.29it/s] 39%|████████████████████▏                               | 3776/9734 [00:18<00:27, 216.55it/s] 39%|████████████████████▎                               | 3798/9734 [00:18<00:27, 216.77it/s] 39%|████████████████████▍                               | 3820/9734 [00:18<00:27, 216.87it/s] 39%|████████████████████▌                               | 3842/9734 [00:18<00:27, 213.11it/s] 40%|████████████████████▋                               | 3864/9734 [00:18<00:27, 214.01it/s] 40%|████████████████████▊                               | 3886/9734 [00:18<00:27, 214.86it/s] 40%|████████████████████▉                               | 3908/9734 [00:18<00:27, 215.40it/s] 40%|████████████████████▉                               | 3930/9734 [00:18<00:26, 215.77it/s] 41%|█████████████████████                               | 3952/9734 [00:18<00:26, 215.77it/s] 41%|█████████████████████▏                              | 3974/9734 [00:18<00:26, 215.97it/s] 41%|█████████████████████▎                              | 3996/9734 [00:19<00:26, 216.28it/s] 41%|█████████████████████▍                              | 4018/9734 [00:19<00:26, 216.52it/s] 42%|█████████████████████▌                              | 4040/9734 [00:19<00:26, 216.62it/s] 42%|█████████████████████▋                              | 4062/9734 [00:19<00:26, 214.88it/s] 42%|█████████████████████▊                              | 4084/9734 [00:19<00:26, 215.24it/s] 42%|█████████████████████▉                              | 4106/9734 [00:19<00:26, 215.56it/s] 42%|██████████████████████                              | 4128/9734 [00:19<00:25, 216.05it/s] 43%|██████████████████████▏                             | 4150/9734 [00:19<00:25, 216.16it/s] 43%|██████████████████████▎                             | 4172/9734 [00:19<00:25, 216.39it/s] 43%|██████████████████████▍                             | 4194/9734 [00:19<00:25, 215.95it/s] 43%|██████████████████████▌                             | 4216/9734 [00:20<00:25, 214.35it/s] 44%|██████████████████████▋                             | 4238/9734 [00:20<00:25, 214.76it/s] 44%|██████████████████████▊                             | 4260/9734 [00:20<00:25, 214.92it/s] 44%|██████████████████████▊                             | 4282/9734 [00:20<00:25, 215.28it/s] 44%|██████████████████████▉                             | 4304/9734 [00:20<00:25, 213.52it/s] 44%|███████████████████████                             | 4326/9734 [00:20<00:25, 213.63it/s] 45%|███████████████████████▏                            | 4348/9734 [00:20<00:25, 214.00it/s] 45%|███████████████████████▎                            | 4370/9734 [00:20<00:24, 214.60it/s] 45%|███████████████████████▍                            | 4392/9734 [00:20<00:24, 215.00it/s] 45%|███████████████████████▌                            | 4414/9734 [00:21<00:24, 215.41it/s] 46%|███████████████████████▋                            | 4436/9734 [00:21<00:24, 215.59it/s] 46%|███████████████████████▊                            | 4458/9734 [00:21<00:24, 216.03it/s] 46%|███████████████████████▉                            | 4480/9734 [00:21<00:24, 216.10it/s] 46%|████████████████████████                            | 4502/9734 [00:21<00:24, 216.21it/s] 46%|████████████████████████▏                           | 4524/9734 [00:21<00:26, 195.25it/s] 47%|████████████████████████▎                           | 4546/9734 [00:21<00:25, 200.89it/s] 47%|████████████████████████▍                           | 4568/9734 [00:21<00:25, 203.90it/s] 47%|████████████████████████▌                           | 4590/9734 [00:21<00:24, 207.60it/s] 47%|████████████████████████▋                           | 4612/9734 [00:21<00:24, 210.25it/s] 48%|████████████████████████▊                           | 4634/9734 [00:22<00:24, 212.21it/s] 48%|████████████████████████▊                           | 4656/9734 [00:22<00:23, 213.57it/s] 48%|████████████████████████▉                           | 4678/9734 [00:22<00:23, 214.51it/s] 48%|█████████████████████████                           | 4700/9734 [00:22<00:23, 215.21it/s] 49%|█████████████████████████▏                          | 4722/9734 [00:22<00:23, 215.70it/s] 49%|█████████████████████████▎                          | 4744/9734 [00:22<00:31, 158.27it/s] 49%|█████████████████████████▍                          | 4766/9734 [00:22<00:28, 171.81it/s] 49%|█████████████████████████▌                          | 4788/9734 [00:22<00:27, 183.01it/s] 49%|█████████████████████████▋                          | 4810/9734 [00:22<00:25, 191.82it/s] 50%|█████████████████████████▊                          | 4832/9734 [00:23<00:24, 198.68it/s] 50%|█████████████████████████▉                          | 4854/9734 [00:23<00:23, 203.54it/s] 50%|██████████████████████████                          | 4876/9734 [00:23<00:23, 206.02it/s] 50%|██████████████████████████▏                         | 4898/9734 [00:23<00:23, 209.08it/s] 51%|██████████████████████████▎                         | 4920/9734 [00:23<00:22, 209.79it/s] 51%|██████████████████████████▍                         | 4942/9734 [00:23<00:22, 211.92it/s] 51%|██████████████████████████▌                         | 4964/9734 [00:23<00:22, 211.50it/s] 51%|██████████████████████████▋                         | 4986/9734 [00:23<00:22, 212.71it/s] 51%|██████████████████████████▊                         | 5008/9734 [00:23<00:22, 213.42it/s] 52%|██████████████████████████▊                         | 5030/9734 [00:24<00:21, 214.15it/s] 52%|██████████████████████████▉                         | 5052/9734 [00:24<00:21, 214.45it/s] 52%|███████████████████████████                         | 5074/9734 [00:24<00:21, 214.50it/s] 52%|███████████████████████████▏                        | 5096/9734 [00:24<00:21, 215.15it/s] 53%|███████████████████████████▎                        | 5118/9734 [00:24<00:21, 215.69it/s] 53%|███████████████████████████▍                        | 5140/9734 [00:24<00:21, 215.99it/s] 53%|███████████████████████████▌                        | 5162/9734 [00:24<00:21, 216.36it/s] 53%|███████████████████████████▋                        | 5184/9734 [00:24<00:21, 214.51it/s] 53%|███████████████████████████▊                        | 5206/9734 [00:24<00:21, 215.11it/s] 54%|███████████████████████████▉                        | 5228/9734 [00:24<00:20, 215.56it/s] 54%|████████████████████████████                        | 5250/9734 [00:25<00:20, 215.84it/s] 54%|████████████████████████████▏                       | 5272/9734 [00:25<00:20, 214.65it/s] 54%|████████████████████████████▎                       | 5294/9734 [00:25<00:20, 214.85it/s] 55%|████████████████████████████▍                       | 5316/9734 [00:25<00:20, 214.63it/s] 55%|████████████████████████████▌                       | 5338/9734 [00:25<00:20, 214.37it/s] 55%|████████████████████████████▋                       | 5360/9734 [00:25<00:20, 214.02it/s] 55%|████████████████████████████▊                       | 5382/9734 [00:25<00:20, 214.03it/s] 56%|████████████████████████████▊                       | 5404/9734 [00:25<00:20, 211.70it/s] 56%|████████████████████████████▉                       | 5426/9734 [00:25<00:20, 212.56it/s] 56%|█████████████████████████████                       | 5448/9734 [00:25<00:20, 213.61it/s] 56%|█████████████████████████████▏                      | 5470/9734 [00:26<00:19, 214.45it/s] 56%|█████████████████████████████▎                      | 5493/9734 [00:26<00:19, 216.55it/s] 57%|█████████████████████████████▍                      | 5516/9734 [00:26<00:19, 218.24it/s] 57%|█████████████████████████████▌                      | 5539/9734 [00:26<00:19, 219.38it/s] 57%|█████████████████████████████▋                      | 5562/9734 [00:26<00:18, 219.79it/s] 57%|█████████████████████████████▊                      | 5584/9734 [00:26<00:18, 218.51it/s] 58%|█████████████████████████████▉                      | 5607/9734 [00:26<00:18, 219.00it/s] 58%|██████████████████████████████                      | 5629/9734 [00:26<00:18, 218.16it/s] 58%|██████████████████████████████▏                     | 5651/9734 [00:26<00:18, 217.37it/s] 58%|██████████████████████████████▎                     | 5674/9734 [00:27<00:18, 218.69it/s] 59%|██████████████████████████████▍                     | 5697/9734 [00:27<00:18, 219.57it/s] 59%|██████████████████████████████▌                     | 5720/9734 [00:27<00:18, 220.32it/s] 59%|██████████████████████████████▋                     | 5743/9734 [00:27<00:18, 220.82it/s] 59%|██████████████████████████████▊                     | 5766/9734 [00:27<00:17, 221.11it/s] 59%|██████████████████████████████▉                     | 5789/9734 [00:27<00:17, 221.32it/s] 60%|███████████████████████████████                     | 5812/9734 [00:27<00:17, 221.50it/s] 60%|███████████████████████████████▏                    | 5835/9734 [00:27<00:17, 221.48it/s] 60%|███████████████████████████████▎                    | 5858/9734 [00:27<00:17, 219.57it/s] 60%|███████████████████████████████▍                    | 5881/9734 [00:27<00:17, 220.12it/s] 61%|███████████████████████████████▌                    | 5904/9734 [00:28<00:17, 220.32it/s] 61%|███████████████████████████████▋                    | 5927/9734 [00:28<00:17, 220.63it/s] 61%|███████████████████████████████▊                    | 5950/9734 [00:28<00:17, 221.13it/s] 61%|███████████████████████████████▉                    | 5973/9734 [00:28<00:16, 221.39it/s] 62%|████████████████████████████████                    | 5996/9734 [00:28<00:16, 221.41it/s] 62%|████████████████████████████████▏                   | 6019/9734 [00:28<00:16, 220.99it/s] 62%|████████████████████████████████▎                   | 6042/9734 [00:28<00:16, 221.37it/s] 62%|████████████████████████████████▍                   | 6065/9734 [00:28<00:16, 221.50it/s] 63%|████████████████████████████████▌                   | 6088/9734 [00:28<00:16, 220.15it/s] 63%|████████████████████████████████▋                   | 6111/9734 [00:28<00:16, 220.66it/s] 63%|████████████████████████████████▊                   | 6134/9734 [00:29<00:16, 220.63it/s] 63%|████████████████████████████████▉                   | 6157/9734 [00:29<00:16, 220.97it/s] 63%|█████████████████████████████████                   | 6180/9734 [00:29<00:16, 221.20it/s] 64%|█████████████████████████████████▏                  | 6203/9734 [00:29<00:15, 221.39it/s] 64%|█████████████████████████████████▎                  | 6226/9734 [00:29<00:15, 221.25it/s] 64%|█████████████████████████████████▍                  | 6249/9734 [00:29<00:15, 221.36it/s] 64%|█████████████████████████████████▌                  | 6272/9734 [00:29<00:15, 221.35it/s] 65%|█████████████████████████████████▋                  | 6295/9734 [00:29<00:15, 221.51it/s] 65%|█████████████████████████████████▊                  | 6318/9734 [00:29<00:15, 220.05it/s] 65%|█████████████████████████████████▊                  | 6341/9734 [00:30<00:15, 220.35it/s] 65%|█████████████████████████████████▉                  | 6364/9734 [00:30<00:15, 220.68it/s] 66%|██████████████████████████████████                  | 6387/9734 [00:30<00:15, 221.09it/s] 66%|██████████████████████████████████▏                 | 6410/9734 [00:30<00:15, 221.25it/s] 66%|██████████████████████████████████▎                 | 6433/9734 [00:30<00:14, 220.92it/s] 66%|██████████████████████████████████▍                 | 6456/9734 [00:30<00:14, 218.98it/s] 67%|██████████████████████████████████▌                 | 6479/9734 [00:30<00:14, 219.40it/s] 67%|██████████████████████████████████▋                 | 6501/9734 [00:30<00:14, 218.71it/s] 67%|██████████████████████████████████▊                 | 6524/9734 [00:30<00:14, 219.38it/s] 67%|██████████████████████████████████▉                 | 6546/9734 [00:30<00:14, 218.38it/s] 67%|███████████████████████████████████                 | 6568/9734 [00:31<00:14, 218.76it/s] 68%|███████████████████████████████████▏                | 6591/9734 [00:31<00:14, 219.38it/s] 68%|███████████████████████████████████▎                | 6614/9734 [00:31<00:14, 220.11it/s] 68%|███████████████████████████████████▍                | 6637/9734 [00:31<00:14, 220.57it/s] 68%|███████████████████████████████████▌                | 6660/9734 [00:31<00:13, 221.08it/s] 69%|███████████████████████████████████▋                | 6683/9734 [00:31<00:13, 220.42it/s] 69%|███████████████████████████████████▊                | 6706/9734 [00:31<00:13, 220.71it/s] 69%|███████████████████████████████████▉                | 6729/9734 [00:31<00:13, 220.89it/s] 69%|████████████████████████████████████                | 6752/9734 [00:31<00:13, 221.34it/s] 70%|████████████████████████████████████▏               | 6775/9734 [00:31<00:13, 219.84it/s] 70%|████████████████████████████████████▎               | 6798/9734 [00:32<00:13, 220.39it/s] 70%|████████████████████████████████████▍               | 6821/9734 [00:32<00:13, 220.85it/s] 70%|████████████████████████████████████▌               | 6844/9734 [00:32<00:13, 221.18it/s] 71%|████████████████████████████████████▋               | 6867/9734 [00:32<00:12, 221.39it/s] 71%|████████████████████████████████████▊               | 6890/9734 [00:32<00:12, 221.34it/s] 71%|████████████████████████████████████▉               | 6913/9734 [00:32<00:12, 221.48it/s] 71%|█████████████████████████████████████               | 6936/9734 [00:32<00:12, 221.65it/s] 71%|█████████████████████████████████████▏              | 6959/9734 [00:32<00:12, 221.80it/s] 72%|█████████████████████████████████████▎              | 6982/9734 [00:32<00:12, 221.72it/s] 72%|█████████████████████████████████████▍              | 7005/9734 [00:33<00:12, 219.57it/s] 72%|█████████████████████████████████████▌              | 7028/9734 [00:33<00:12, 220.08it/s] 72%|█████████████████████████████████████▋              | 7051/9734 [00:33<00:12, 220.41it/s] 73%|█████████████████████████████████████▊              | 7074/9734 [00:33<00:12, 220.44it/s] 73%|█████████████████████████████████████▉              | 7097/9734 [00:33<00:11, 220.50it/s] 73%|██████████████████████████████████████              | 7120/9734 [00:33<00:11, 220.90it/s] 73%|██████████████████████████████████████▏             | 7143/9734 [00:33<00:11, 221.24it/s] 74%|██████████████████████████████████████▎             | 7166/9734 [00:33<00:11, 221.32it/s] 74%|██████████████████████████████████████▍             | 7189/9734 [00:33<00:11, 221.44it/s] 74%|██████████████████████████████████████▌             | 7212/9734 [00:33<00:11, 221.45it/s] 74%|██████████████████████████████████████▋             | 7235/9734 [00:34<00:11, 220.01it/s] 75%|██████████████████████████████████████▊             | 7258/9734 [00:34<00:11, 220.42it/s] 75%|██████████████████████████████████████▉             | 7281/9734 [00:34<00:11, 220.62it/s] 75%|███████████████████████████████████████             | 7304/9734 [00:34<00:11, 220.87it/s] 75%|███████████████████████████████████████▏            | 7327/9734 [00:34<00:10, 221.01it/s] 76%|███████████████████████████████████████▎            | 7350/9734 [00:34<00:10, 221.30it/s] 76%|███████████████████████████████████████▍            | 7373/9734 [00:34<00:10, 221.27it/s] 76%|███████████████████████████████████████▌            | 7396/9734 [00:34<00:10, 221.44it/s] 76%|███████████████████████████████████████▋            | 7419/9734 [00:34<00:10, 221.26it/s] 76%|███████████████████████████████████████▊            | 7442/9734 [00:35<00:11, 200.60it/s] 77%|███████████████████████████████████████▊            | 7464/9734 [00:35<00:11, 205.41it/s] 77%|███████████████████████████████████████▉            | 7486/9734 [00:35<00:10, 209.39it/s] 77%|████████████████████████████████████████            | 7509/9734 [00:35<00:10, 212.57it/s] 77%|████████████████████████████████████████▏           | 7531/9734 [00:35<00:10, 213.89it/s] 78%|████████████████████████████████████████▎           | 7553/9734 [00:35<00:10, 214.50it/s] 78%|████████████████████████████████████████▍           | 7576/9734 [00:35<00:09, 216.44it/s] 78%|████████████████████████████████████████▌           | 7599/9734 [00:35<00:09, 217.95it/s] 78%|████████████████████████████████████████▋           | 7622/9734 [00:35<00:09, 218.81it/s] 79%|████████████████████████████████████████▊           | 7645/9734 [00:35<00:09, 219.48it/s] 79%|████████████████████████████████████████▉           | 7668/9734 [00:36<00:09, 219.93it/s] 79%|█████████████████████████████████████████           | 7691/9734 [00:36<00:09, 218.33it/s] 79%|█████████████████████████████████████████▏          | 7714/9734 [00:36<00:09, 219.27it/s] 79%|█████████████████████████████████████████▎          | 7737/9734 [00:36<00:09, 219.99it/s] 80%|█████████████████████████████████████████▍          | 7760/9734 [00:36<00:08, 220.28it/s] 80%|█████████████████████████████████████████▌          | 7783/9734 [00:36<00:08, 219.90it/s] 80%|█████████████████████████████████████████▋          | 7806/9734 [00:36<00:08, 220.23it/s] 80%|█████████████████████████████████████████▊          | 7829/9734 [00:36<00:08, 220.38it/s] 81%|█████████████████████████████████████████▉          | 7852/9734 [00:36<00:08, 220.49it/s] 81%|██████████████████████████████████████████          | 7875/9734 [00:37<00:08, 220.63it/s] 81%|██████████████████████████████████████████▏         | 7898/9734 [00:37<00:08, 219.44it/s] 81%|██████████████████████████████████████████▎         | 7921/9734 [00:37<00:08, 219.92it/s] 82%|██████████████████████████████████████████▍         | 7944/9734 [00:37<00:08, 220.29it/s] 82%|██████████████████████████████████████████▌         | 7967/9734 [00:37<00:08, 220.14it/s] 82%|██████████████████████████████████████████▋         | 7990/9734 [00:37<00:07, 220.45it/s] 82%|██████████████████████████████████████████▊         | 8013/9734 [00:37<00:07, 220.78it/s] 83%|██████████████████████████████████████████▉         | 8036/9734 [00:37<00:07, 220.90it/s] 83%|███████████████████████████████████████████         | 8059/9734 [00:37<00:07, 220.75it/s] 83%|███████████████████████████████████████████▏        | 8082/9734 [00:37<00:07, 220.96it/s] 83%|███████████████████████████████████████████▎        | 8105/9734 [00:38<00:07, 221.15it/s] 84%|███████████████████████████████████████████▍        | 8128/9734 [00:38<00:07, 219.56it/s] 84%|███████████████████████████████████████████▌        | 8151/9734 [00:38<00:07, 219.93it/s] 84%|███████████████████████████████████████████▋        | 8174/9734 [00:38<00:07, 220.28it/s] 84%|███████████████████████████████████████████▊        | 8197/9734 [00:38<00:06, 220.32it/s] 84%|███████████████████████████████████████████▉        | 8220/9734 [00:38<00:06, 220.55it/s] 85%|████████████████████████████████████████████        | 8243/9734 [00:38<00:06, 220.60it/s] 85%|████████████████████████████████████████████▏       | 8266/9734 [00:38<00:06, 220.72it/s] 85%|████████████████████████████████████████████▎       | 8289/9734 [00:38<00:06, 220.69it/s] 85%|████████████████████████████████████████████▍       | 8312/9734 [00:38<00:06, 220.92it/s] 86%|████████████████████████████████████████████▌       | 8335/9734 [00:39<00:06, 221.03it/s] 86%|████████████████████████████████████████████▋       | 8358/9734 [00:39<00:06, 219.59it/s] 86%|████████████████████████████████████████████▊       | 8381/9734 [00:39<00:06, 220.06it/s] 86%|████████████████████████████████████████████▉       | 8404/9734 [00:39<00:06, 220.36it/s] 87%|█████████████████████████████████████████████       | 8427/9734 [00:39<00:05, 220.55it/s] 87%|█████████████████████████████████████████████▏      | 8450/9734 [00:39<00:05, 220.20it/s] 87%|█████████████████████████████████████████████▎      | 8473/9734 [00:39<00:05, 220.29it/s] 87%|█████████████████████████████████████████████▍      | 8496/9734 [00:39<00:05, 220.64it/s] 88%|█████████████████████████████████████████████▌      | 8519/9734 [00:39<00:05, 220.67it/s] 88%|█████████████████████████████████████████████▋      | 8542/9734 [00:40<00:05, 220.51it/s] 88%|█████████████████████████████████████████████▊      | 8565/9734 [00:40<00:05, 220.40it/s] 88%|█████████████████████████████████████████████▉      | 8588/9734 [00:40<00:05, 218.92it/s] 88%|█████████████████████████████████████████████▉      | 8610/9734 [00:40<00:05, 219.11it/s] 89%|██████████████████████████████████████████████      | 8632/9734 [00:40<00:05, 218.10it/s] 89%|██████████████████████████████████████████████▏     | 8654/9734 [00:40<00:04, 216.43it/s] 89%|██████████████████████████████████████████████▎     | 8677/9734 [00:40<00:04, 217.80it/s] 89%|██████████████████████████████████████████████▍     | 8700/9734 [00:40<00:04, 218.64it/s] 90%|██████████████████████████████████████████████▌     | 8723/9734 [00:40<00:04, 219.34it/s] 90%|██████████████████████████████████████████████▋     | 8745/9734 [00:40<00:04, 219.52it/s] 90%|██████████████████████████████████████████████▊     | 8768/9734 [00:41<00:04, 219.94it/s] 90%|██████████████████████████████████████████████▉     | 8790/9734 [00:41<00:04, 219.93it/s] 91%|███████████████████████████████████████████████     | 8812/9734 [00:41<00:04, 218.66it/s] 91%|███████████████████████████████████████████████▏    | 8835/9734 [00:41<00:04, 219.17it/s] 91%|███████████████████████████████████████████████▎    | 8858/9734 [00:41<00:03, 219.66it/s] 91%|███████████████████████████████████████████████▍    | 8880/9734 [00:41<00:03, 219.66it/s] 91%|███████████████████████████████████████████████▌    | 8903/9734 [00:41<00:03, 220.10it/s] 92%|███████████████████████████████████████████████▋    | 8926/9734 [00:41<00:03, 220.07it/s] 92%|███████████████████████████████████████████████▊    | 8949/9734 [00:41<00:03, 220.34it/s] 92%|███████████████████████████████████████████████▉    | 8972/9734 [00:42<00:03, 220.26it/s] 92%|████████████████████████████████████████████████    | 8995/9734 [00:42<00:03, 220.45it/s] 93%|████████████████████████████████████████████████▏   | 9018/9734 [00:42<00:03, 218.77it/s] 93%|████████████████████████████████████████████████▎   | 9040/9734 [00:42<00:03, 204.74it/s] 93%|████████████████████████████████████████████████▍   | 9062/9734 [00:42<00:03, 208.81it/s] 93%|████████████████████████████████████████████████▌   | 9084/9734 [00:42<00:03, 211.90it/s] 94%|████████████████████████████████████████████████▋   | 9107/9734 [00:42<00:02, 214.43it/s] 94%|████████████████████████████████████████████████▊   | 9130/9734 [00:42<00:02, 216.21it/s] 94%|████████████████████████████████████████████████▉   | 9153/9734 [00:42<00:02, 217.66it/s] 94%|█████████████████████████████████████████████████   | 9176/9734 [00:42<00:02, 218.67it/s] 95%|█████████████████████████████████████████████████▏  | 9199/9734 [00:43<00:02, 219.26it/s] 95%|█████████████████████████████████████████████████▎  | 9222/9734 [00:43<00:02, 219.77it/s] 95%|█████████████████████████████████████████████████▍  | 9245/9734 [00:43<00:02, 220.15it/s] 95%|█████████████████████████████████████████████████▌  | 9268/9734 [00:43<00:02, 218.86it/s] 95%|█████████████████████████████████████████████████▋  | 9291/9734 [00:43<00:02, 219.30it/s] 96%|█████████████████████████████████████████████████▊  | 9314/9734 [00:43<00:01, 219.78it/s] 96%|█████████████████████████████████████████████████▊  | 9336/9734 [00:43<00:01, 219.83it/s] 96%|█████████████████████████████████████████████████▉  | 9359/9734 [00:43<00:01, 220.16it/s] 96%|██████████████████████████████████████████████████  | 9382/9734 [00:43<00:01, 220.37it/s] 97%|██████████████████████████████████████████████████▏ | 9405/9734 [00:43<00:01, 220.33it/s] 97%|██████████████████████████████████████████████████▎ | 9428/9734 [00:44<00:01, 220.22it/s] 97%|██████████████████████████████████████████████████▍ | 9451/9734 [00:44<00:01, 220.32it/s] 97%|██████████████████████████████████████████████████▌ | 9474/9734 [00:44<00:01, 220.47it/s] 98%|██████████████████████████████████████████████████▋ | 9497/9734 [00:44<00:01, 218.81it/s] 98%|██████████████████████████████████████████████████▊ | 9519/9734 [00:44<00:00, 218.87it/s] 98%|██████████████████████████████████████████████████▉ | 9542/9734 [00:44<00:00, 219.42it/s] 98%|███████████████████████████████████████████████████ | 9564/9734 [00:44<00:00, 219.46it/s] 98%|███████████████████████████████████████████████████▏| 9587/9734 [00:44<00:00, 219.73it/s] 99%|███████████████████████████████████████████████████▎| 9610/9734 [00:44<00:00, 219.92it/s] 99%|███████████████████████████████████████████████████▍| 9633/9734 [00:45<00:00, 220.12it/s] 99%|███████████████████████████████████████████████████▌| 9656/9734 [00:45<00:00, 220.24it/s] 99%|███████████████████████████████████████████████████▋| 9679/9734 [00:45<00:00, 220.40it/s]100%|███████████████████████████████████████████████████▊| 9702/9734 [00:45<00:00, 220.13it/s]100%|███████████████████████████████████████████████████▉| 9725/9734 [00:45<00:00, 218.42it/s]100%|████████████████████████████████████████████████████| 9734/9734 [00:45<00:00, 213.95it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.07s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.16s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.13s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.13s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.05s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.08s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.17s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.23s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.55s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.70s/it]
[2023-08-22 13:22:23,679] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.55s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.69s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.57s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.73s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.69s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.83s/it]
[2023-08-22 13:22:32,211] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-22 13:22:32,214] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-22 13:22:32,214] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-22 13:22:32,214] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-22 13:22:32,215] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-22 13:22:32,215] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-22 13:22:32,215] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-22 13:22:32,215] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-22 13:22:32,215] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-22 13:22:32,216] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-22 13:22:32,216] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-22 13:22:32,216] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fa69ae29fd0>
[2023-08-22 13:22:32,216] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-22 13:22:32,216] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-22 13:22:32,216] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-22 13:22:32,216] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-22 13:22:32,216] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-22 13:22:32,216] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-22 13:22:32,216] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-22 13:22:32,216] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-22 13:22:32,216] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-22 13:22:32,216] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-22 13:22:32,216] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-22 13:22:32,216] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-22 13:22:32,216] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-22 13:22:32,216] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-22 13:22:32,216] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-22 13:22:32,217] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-22 13:22:32,217] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-22 13:22:32,217] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-22 13:22:32,217] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-22 13:22:32,217] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-22 13:22:32,217] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-22 13:22:32,217] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-22 13:22:32,217] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-22 13:22:32,217] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-22 13:22:32,217] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-22 13:22:32,217] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-22 13:22:32,217] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-22 13:22:32,217] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-22 13:22:32,217] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-22 13:22:32,217] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-22 13:22:32,217] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-22 13:22:32,217] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-22 13:22:32,217] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7fa69a737220>
[2023-08-22 13:22:32,218] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-22 13:22:32,218] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-22 13:22:32,218] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-22 13:22:32,218] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-22 13:22:32,218] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-22 13:22:32,218] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-22 13:22:32,218] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-22 13:22:32,218] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-22 13:22:32,218] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-22 13:22:32,218] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-22 13:22:32,218] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-22 13:22:32,218] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-22 13:22:32,218] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-22 13:22:32,218] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-22 13:22:32,218] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-22 13:22:32,218] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-22 13:22:32,218] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-22 13:22:32,218] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-22 13:22:32,218] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-22 13:22:32,219] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-22 13:22:32,219] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-22 13:22:32,219] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-22 13:22:32,219] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.6029953956604004 seconds
Loading extension module utils...
Time to load utils op: 0.6040730476379395 seconds
Loading extension module utils...
Time to load utils op: 0.6047484874725342 seconds
Loading extension module utils...
Time to load utils op: 0.6043002605438232 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: The machine was very intricate, it was quite an what? Choices:  A: box B: apparatus C: appliance D: wash dishes E: implement
Output: 1. The sentence in the question is describing a complicated machine. The right word must fit well into this context.
2. The choices are: A: box B: apparatus C: appliance D: wash dishes E: implement.
3. Looking up each choice, an 'apparatus' can denote a complex machine or device, 'appliance' stands for a piece of equipment designed to perform a specific task, typically a domestic one, 'implement' is a tool or utensil helping to do something(not complex enough), and 'box' is a container or 'wash dishes' obviously does not fit in the context.
4. Therefore, the appropriate word is apparatus as it is complex and it fits the context of the sentence well. 
5. So, the answer is B: apparatus.
So the final answer is B: apparatus

Input: Where do you get petrol? Choices:  A: burn hot B: fuel tank C: burn hot D: car E: gas station
Output: 1. The question asks where we can obtain petrol.
2. Petrol, also known as gasoline, is a type of fuel commonly used in internal combustion engines.
3. Looking at the choices:
    - Option A and C suggest "burn hot". However, this is a description of what can happen when petrol is used, not a place where it can be obtained, so both options A and C can be eliminated.
    - Option B suggests a "fuel tank." While a fuel tank is where petrol is stored once obtained, it's not a place where one can go to get petrol, hence option B is not correct.
    - Option D suggests a "car." While it's true that petrol is used in cars, cars are not a place where you can get petrol. They are where you use petrol. So, option D can also be eliminated.
    - Option E suggests a "gas station." Gas stations are exactly where one would go to obtain petrol to fuel their cars or other engines.
4. Therefore, the answer is E: Gas station, which is the place where petrol can be obtained.
So the final answer is E: gas station

Input: Where might a television used at night be? Choices:  A: cabinet B: house C: apartment D: bedroom E: woods
Output: 1. A television used at night most likely implies it is used for personal entertainment during leisure time, especially before sleep time.
2. If we go through the answer options: a cabinet is usually for storing items, so it's not likely to be the correct choice.
3. A house or an apartment could be a right answer, as they do have televisions. However, these options are pretty broad because they contain many other rooms/areas where people may or may not watch television.
4. Woods is an unlikely answer as it is open and not resided in, making it unfeasible for using a television, especially during the night.
5. That leaves us the option of a bedroom. People often watch TV in their bedrooms at night as a form of relaxation or to fall asleep. 
6. Therefore, the most accurate answer would be D. bedroom, because it's the most likely place for a television to be used at night.
So the final answer is D: bedroom

Input: The knowledge was expensive to get, where was it being gained? Choices:  A: university B: book C: field D: meeting E: class
Output: 1. The phrase "The knowledge was expensive to get" implies a place where extensive and high-level learning occurs, often requiring significant financial investment.
2. A book (choice B), could contain expensive knowledge, but the cost of a book is generally not high compared to other means of obtaining knowledge.
3. A field (choice C) typically refers to "field of study" or on the job training, this could be seen as costly in terms of time and commitment, but it's not inherently expensive.
4. Meetings (choice D) could present costly information if it's a high-end conference or seminar, but again meetings in general do not require a significant financial investment.
5. A class (choice E) might be expensive depending on the course or program, but a class is typically part of a larger educational institution or system.
6. Out of all the choices, a university (choice A) is the most likely to require a substantial financial investment. This is due to high tuition costs, cost of books, housing fees, and other related expenses.
7. Therefore, the answer is A: University.
So the final answer is A: university

Input: Where are small grapes likely to be found? Choices:  A: lunch box B: food store C: wine country D: kitchen E: raisins
Output: 1. The question is asking for a location where small grapes are likely found.
2. Looking at the answer choices, we have a lunch box, a food store, wine country, a kitchen and raisins.
3. Think about the context in which small grapes specifically can be seen.
4. Small grapes could exist in a lunch box, a food store, or a kitchen, but there's no specification in these places for the grapes to be small.
5. But in the case of wine country, wine grapes are typically smaller in size than the grapes typically eaten as fruit.
6. Raisins are not a location but are dried grapes. 
7. Therefore, the most likely answer would be wine country (C) where small grapes are specifically cultivated for wine production.
So the final answer is C: wine country

Input: The painter explained how he never achieved a flawless portrait, he said this was because all people are what? Choices:  A: imperfect B: disfigured C: damaged D: flawed E: defective
Output: 1. The question is asking for a word from the choices that could describe the reason why the painter never achieved a flawless portrait.
2. As per the painter's explanation, the reason is related to the inherent quality of people.
3. The choices offer various negative characteristics that could potentially describe people, which include being imperfect, disfigured, damaged, flawed, or defective.
4. The words 'disfigured', 'damaged', 'defective' could all be considered to mean 'broken' or 'wounded'. It's not in line with the painter's statement which intended to imply a natural perceived imperfection rather than a severe condition.
5. The word 'flawed' could also apply but it is more often used to describe faults or mistakes.
6. The word 'imperfect' best fits the explanation as it refers to the natural shortcomings or limitations that all people inherently have.
7. Therefore, the answer is A: imperfect.
So the final answer is A: imperfect

Input: If you're betting with a shark, where are you likely playing? Choices:  A: aquarium B: mediterranean sea C: south pacific D: pool hall E: pacific ocean
Output: 1. The term 'betting with a shark' is a slang term. 
2. This term does not refer to the animal shark, but to an experienced gambler who wins consistently, often in pool or billiards games.
3. Thus, it's necessary to identify which of the options provided is a place where this type of activity could happen. 
4. The options aquarium, mediterranean sea, south pacific and pacific ocean - while they could contain the animal species'shark' - do not relate to the context of gambling or pool games. 
5. The only option left and that fits the context of gambling specifically is 'pool hall', which is commonly associated with pool or billiards games. 
6. Therefore, the answer is D: pool hall.
So the final answer is D: pool hall

Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid
Output:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i7-s20-rTrue
Evaluating commonsenseqa :   0%|                                       | 0/50 [00:03<?, ?it/s]
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 126, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 123, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 107, in evaluate_main
    query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 89, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 126, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 123, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 107, in evaluate_main
    query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 89, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 126, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 123, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 107, in evaluate_main
    query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 89, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 126, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 123, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 107, in evaluate_main
    query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 89, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 3727331) of binary: /home/ylu130/.conda/envs/distllm/bin/python
Traceback (most recent call last):
  File "/home/ylu130/.conda/envs/distllm/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 345, in wrapper
    return f(*args, **kwargs)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 761, in main
    run(args)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 752, in run
    elastic_launch(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 131, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 245, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
/home/ylu130/workspace/in-context-generalization/inference.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2023-08-22_13:22:39
  host      : ia1.wse.jhu.edu
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 3727332)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2023-08-22_13:22:39
  host      : ia1.wse.jhu.edu
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 3727333)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2023-08-22_13:22:39
  host      : ia1.wse.jhu.edu
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 3727334)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2023-08-22_13:22:39
  host      : ia1.wse.jhu.edu
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 3727331)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i8-s20-rTrue --seed 20 --max-prompt-length 2048 --rationales --num-in-domain 8
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-22 13:22:42,247] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i8-s20-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 8
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i8-s20-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 20
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9733 [00:00<?, ?it/s]  0%|                                                      | 12/9733 [00:00<01:23, 117.03it/s]  0%|▏                                                     | 24/9733 [00:00<01:22, 118.10it/s]  0%|▏                                                     | 36/9733 [00:00<01:22, 118.12it/s]  0%|▎                                                     | 48/9733 [00:00<01:21, 118.57it/s]  1%|▎                                                     | 60/9733 [00:00<01:21, 118.57it/s]  1%|▍                                                     | 72/9733 [00:00<01:21, 118.71it/s]  1%|▍                                                     | 84/9733 [00:00<01:21, 118.69it/s]  1%|▌                                                     | 96/9733 [00:00<01:21, 118.78it/s]  1%|▌                                                    | 108/9733 [00:00<01:20, 118.88it/s]  1%|▋                                                    | 120/9733 [00:01<01:21, 117.31it/s]  1%|▋                                                    | 132/9733 [00:01<01:21, 117.83it/s]  1%|▊                                                    | 144/9733 [00:01<01:21, 118.13it/s]  2%|▊                                                    | 156/9733 [00:01<01:20, 118.33it/s]  2%|▉                                                    | 168/9733 [00:01<01:20, 118.33it/s]  2%|▉                                                    | 180/9733 [00:01<01:20, 118.31it/s]  2%|█                                                    | 192/9733 [00:01<01:20, 118.49it/s]  2%|█                                                    | 204/9733 [00:01<01:21, 116.79it/s]  2%|█▏                                                   | 216/9733 [00:01<01:21, 117.32it/s]  2%|█▏                                                   | 228/9733 [00:01<01:20, 117.79it/s]  2%|█▎                                                   | 240/9733 [00:02<01:20, 117.66it/s]  3%|█▎                                                   | 252/9733 [00:02<01:20, 117.90it/s]  3%|█▍                                                   | 264/9733 [00:02<01:20, 118.18it/s]  3%|█▌                                                   | 276/9733 [00:02<01:19, 118.29it/s]  3%|█▌                                                   | 288/9733 [00:02<01:20, 118.02it/s]  3%|█▋                                                   | 300/9733 [00:02<01:20, 117.89it/s]  3%|█▋                                                   | 312/9733 [00:02<01:19, 117.82it/s]  3%|█▊                                                   | 324/9733 [00:02<01:19, 117.68it/s]  3%|█▊                                                   | 336/9733 [00:02<01:20, 117.46it/s]  4%|█▉                                                   | 348/9733 [00:02<01:19, 117.42it/s]  4%|█▉                                                   | 360/9733 [00:03<01:19, 117.28it/s]  4%|██                                                   | 372/9733 [00:03<01:19, 117.35it/s]  4%|██                                                   | 388/9733 [00:03<01:12, 129.13it/s]  4%|██▏                                                  | 406/9733 [00:03<01:04, 143.52it/s]  4%|██▎                                                  | 424/9733 [00:03<01:00, 154.03it/s]  5%|██▍                                                  | 442/9733 [00:03<00:58, 159.89it/s]  5%|██▌                                                  | 460/9733 [00:03<00:55, 165.61it/s]  5%|██▌                                                  | 478/9733 [00:03<00:54, 169.41it/s]  5%|██▋                                                  | 496/9733 [00:03<00:53, 172.12it/s]  5%|██▊                                                  | 514/9733 [00:03<00:52, 174.02it/s]  5%|██▉                                                  | 532/9733 [00:04<00:52, 175.34it/s]  6%|██▉                                                  | 550/9733 [00:04<00:52, 176.27it/s]  6%|███                                                  | 568/9733 [00:04<00:51, 176.60it/s]  6%|███▏                                                 | 586/9733 [00:04<00:51, 176.90it/s]  6%|███▎                                                 | 604/9733 [00:04<00:51, 177.11it/s]  6%|███▍                                                 | 622/9733 [00:04<00:51, 177.07it/s]  7%|███▍                                                 | 640/9733 [00:04<00:51, 176.23it/s]  7%|███▌                                                 | 658/9733 [00:04<00:51, 174.95it/s]  7%|███▋                                                 | 676/9733 [00:04<00:51, 175.93it/s]  7%|███▊                                                 | 694/9733 [00:04<00:51, 176.63it/s]  7%|███▉                                                 | 712/9733 [00:05<00:50, 177.02it/s]  8%|███▉                                                 | 730/9733 [00:05<00:50, 177.31it/s]  8%|████                                                 | 748/9733 [00:05<00:50, 177.59it/s]  8%|████▏                                                | 766/9733 [00:05<00:50, 177.78it/s]  8%|████▎                                                | 784/9733 [00:05<00:50, 177.75it/s]  8%|████▎                                                | 802/9733 [00:05<00:50, 177.71it/s]  8%|████▍                                                | 820/9733 [00:05<00:50, 177.77it/s]  9%|████▌                                                | 838/9733 [00:05<00:50, 177.29it/s]  9%|████▋                                                | 856/9733 [00:05<00:50, 177.01it/s]  9%|████▊                                                | 874/9733 [00:06<00:50, 175.66it/s]  9%|████▊                                                | 892/9733 [00:06<00:51, 173.28it/s]  9%|████▉                                                | 910/9733 [00:06<00:50, 174.50it/s] 10%|█████                                                | 928/9733 [00:06<00:50, 175.08it/s] 10%|█████▏                                               | 946/9733 [00:06<00:50, 175.62it/s] 10%|█████▏                                               | 964/9733 [00:06<00:49, 175.97it/s] 10%|█████▎                                               | 982/9733 [00:06<00:49, 176.27it/s] 10%|█████▎                                              | 1000/9733 [00:06<00:49, 176.44it/s] 10%|█████▍                                              | 1018/9733 [00:06<00:49, 176.52it/s] 11%|█████▌                                              | 1036/9733 [00:06<00:49, 175.40it/s] 11%|█████▋                                              | 1054/9733 [00:07<00:50, 173.27it/s] 11%|█████▋                                              | 1072/9733 [00:07<00:50, 170.73it/s] 11%|█████▊                                              | 1090/9733 [00:07<00:50, 170.79it/s] 11%|█████▉                                              | 1108/9733 [00:07<00:50, 172.36it/s] 12%|██████                                              | 1126/9733 [00:07<00:50, 171.00it/s] 12%|██████                                              | 1144/9733 [00:07<00:50, 171.47it/s] 12%|██████▏                                             | 1162/9733 [00:07<00:49, 171.69it/s] 12%|██████▎                                             | 1180/9733 [00:07<00:49, 171.99it/s] 12%|██████▍                                             | 1198/9733 [00:07<00:49, 172.05it/s] 12%|██████▍                                             | 1216/9733 [00:07<00:49, 171.32it/s] 13%|██████▌                                             | 1234/9733 [00:08<00:49, 172.49it/s] 13%|██████▋                                             | 1252/9733 [00:08<00:48, 173.36it/s] 13%|██████▊                                             | 1270/9733 [00:08<00:48, 173.44it/s] 13%|██████▉                                             | 1288/9733 [00:08<00:48, 174.13it/s] 13%|██████▉                                             | 1306/9733 [00:08<00:48, 174.76it/s] 14%|███████                                             | 1324/9733 [00:08<00:47, 175.21it/s] 14%|███████▏                                            | 1342/9733 [00:08<00:48, 171.90it/s] 14%|███████▎                                            | 1360/9733 [00:08<00:48, 172.77it/s] 14%|███████▎                                            | 1378/9733 [00:08<00:48, 173.76it/s] 14%|███████▍                                            | 1396/9733 [00:09<00:47, 174.27it/s] 15%|███████▌                                            | 1414/9733 [00:09<00:47, 174.64it/s] 15%|███████▋                                            | 1432/9733 [00:09<00:47, 174.69it/s] 15%|███████▋                                            | 1450/9733 [00:09<00:47, 174.85it/s] 15%|███████▊                                            | 1468/9733 [00:09<00:47, 175.20it/s] 15%|███████▉                                            | 1486/9733 [00:09<00:47, 175.02it/s] 15%|████████                                            | 1504/9733 [00:09<00:47, 174.64it/s] 16%|████████▏                                           | 1522/9733 [00:09<00:46, 174.71it/s] 16%|████████▏                                           | 1540/9733 [00:09<00:46, 174.62it/s] 16%|████████▎                                           | 1558/9733 [00:09<00:46, 175.06it/s] 16%|████████▍                                           | 1576/9733 [00:10<00:46, 173.56it/s] 16%|████████▌                                           | 1594/9733 [00:10<00:46, 174.11it/s] 17%|████████▌                                           | 1612/9733 [00:10<00:46, 174.18it/s] 17%|████████▋                                           | 1630/9733 [00:10<00:46, 174.18it/s] 17%|████████▊                                           | 1648/9733 [00:10<00:46, 174.60it/s] 17%|████████▉                                           | 1666/9733 [00:10<00:46, 175.12it/s] 17%|████████▉                                           | 1684/9733 [00:10<00:45, 175.25it/s] 17%|█████████                                           | 1702/9733 [00:10<00:45, 175.37it/s] 18%|█████████▏                                          | 1720/9733 [00:10<00:45, 175.43it/s] 18%|█████████▎                                          | 1738/9733 [00:10<00:45, 175.06it/s] 18%|█████████▍                                          | 1756/9733 [00:11<00:45, 175.27it/s] 18%|█████████▍                                          | 1774/9733 [00:11<00:45, 176.50it/s] 18%|█████████▌                                          | 1792/9733 [00:11<00:49, 161.12it/s] 19%|█████████▋                                          | 1810/9733 [00:11<00:47, 165.68it/s] 19%|█████████▊                                          | 1828/9733 [00:11<00:46, 169.10it/s] 19%|█████████▊                                          | 1846/9733 [00:11<00:45, 172.22it/s] 19%|█████████▉                                          | 1864/9733 [00:11<00:45, 174.11it/s] 19%|██████████                                          | 1882/9733 [00:11<00:44, 175.42it/s] 20%|██████████▏                                         | 1900/9733 [00:11<00:44, 176.57it/s] 20%|██████████▏                                         | 1918/9733 [00:12<00:44, 177.52it/s] 20%|██████████▎                                         | 1936/9733 [00:12<00:43, 178.19it/s] 20%|██████████▍                                         | 1954/9733 [00:12<00:43, 178.52it/s] 20%|██████████▌                                         | 1972/9733 [00:12<00:43, 178.76it/s] 20%|██████████▋                                         | 1990/9733 [00:12<00:43, 178.90it/s] 21%|██████████▋                                         | 2008/9733 [00:12<00:43, 178.69it/s] 21%|██████████▊                                         | 2026/9733 [00:12<00:43, 177.14it/s] 21%|██████████▉                                         | 2044/9733 [00:12<00:43, 177.95it/s] 21%|███████████                                         | 2062/9733 [00:12<00:43, 178.23it/s] 21%|███████████                                         | 2080/9733 [00:12<00:42, 178.63it/s] 22%|███████████▏                                        | 2098/9733 [00:13<00:42, 178.84it/s] 22%|███████████▎                                        | 2116/9733 [00:13<00:42, 178.99it/s] 22%|███████████▍                                        | 2134/9733 [00:13<00:42, 179.16it/s] 22%|███████████▍                                        | 2152/9733 [00:13<00:42, 179.29it/s] 22%|███████████▌                                        | 2170/9733 [00:13<00:42, 179.39it/s] 22%|███████████▋                                        | 2188/9733 [00:13<00:42, 178.73it/s] 23%|███████████▊                                        | 2206/9733 [00:13<00:42, 178.82it/s] 23%|███████████▉                                        | 2224/9733 [00:13<00:41, 178.96it/s] 23%|███████████▉                                        | 2242/9733 [00:13<00:41, 179.19it/s] 23%|████████████                                        | 2260/9733 [00:13<00:42, 177.80it/s] 23%|████████████▏                                       | 2278/9733 [00:14<00:41, 178.32it/s] 24%|████████████▎                                       | 2297/9733 [00:14<00:41, 178.85it/s] 24%|████████████▎                                       | 2315/9733 [00:14<00:41, 179.14it/s] 24%|████████████▍                                       | 2333/9733 [00:14<00:41, 178.99it/s] 24%|████████████▌                                       | 2351/9733 [00:14<00:41, 179.27it/s] 24%|████████████▋                                       | 2369/9733 [00:14<00:41, 179.39it/s] 25%|████████████▊                                       | 2388/9733 [00:14<00:40, 179.67it/s] 25%|████████████▊                                       | 2406/9733 [00:14<00:40, 179.45it/s] 25%|████████████▉                                       | 2425/9733 [00:14<00:40, 179.69it/s] 25%|█████████████                                       | 2443/9733 [00:14<00:40, 179.73it/s] 25%|█████████████▏                                      | 2461/9733 [00:15<00:40, 179.76it/s] 25%|█████████████▏                                      | 2479/9733 [00:15<00:40, 177.57it/s] 26%|█████████████▎                                      | 2497/9733 [00:15<00:40, 178.01it/s] 26%|█████████████▍                                      | 2516/9733 [00:15<00:40, 178.63it/s] 26%|█████████████▌                                      | 2534/9733 [00:15<00:40, 178.99it/s] 26%|█████████████▋                                      | 2553/9733 [00:15<00:40, 179.38it/s] 26%|█████████████▋                                      | 2571/9733 [00:15<00:40, 178.89it/s] 27%|█████████████▊                                      | 2589/9733 [00:15<00:39, 178.88it/s] 27%|█████████████▉                                      | 2608/9733 [00:15<00:39, 179.38it/s] 27%|██████████████                                      | 2626/9733 [00:15<00:39, 179.47it/s] 27%|██████████████▏                                     | 2644/9733 [00:16<00:39, 179.56it/s] 27%|██████████████▏                                     | 2663/9733 [00:16<00:39, 179.82it/s] 28%|██████████████▎                                     | 2681/9733 [00:16<00:39, 179.72it/s] 28%|██████████████▍                                     | 2699/9733 [00:16<00:39, 178.10it/s] 28%|██████████████▌                                     | 2717/9733 [00:16<00:39, 178.41it/s] 28%|██████████████▌                                     | 2735/9733 [00:16<00:39, 178.75it/s] 28%|██████████████▋                                     | 2753/9733 [00:16<00:39, 174.91it/s] 28%|██████████████▊                                     | 2771/9733 [00:16<00:39, 175.36it/s] 29%|██████████████▉                                     | 2789/9733 [00:16<00:39, 176.69it/s] 29%|██████████████▉                                     | 2807/9733 [00:16<00:39, 177.36it/s] 29%|███████████████                                     | 2826/9733 [00:17<00:38, 178.21it/s] 29%|███████████████▏                                    | 2844/9733 [00:17<00:38, 178.70it/s] 29%|███████████████▎                                    | 2863/9733 [00:17<00:38, 179.27it/s] 30%|███████████████▍                                    | 2882/9733 [00:17<00:38, 179.58it/s] 30%|███████████████▍                                    | 2900/9733 [00:17<00:38, 179.63it/s] 30%|███████████████▌                                    | 2919/9733 [00:17<00:37, 179.82it/s] 30%|███████████████▋                                    | 2937/9733 [00:17<00:38, 178.16it/s] 30%|███████████████▊                                    | 2955/9733 [00:17<00:38, 177.87it/s] 31%|███████████████▉                                    | 2973/9733 [00:17<00:37, 178.11it/s] 31%|███████████████▉                                    | 2991/9733 [00:18<00:37, 178.35it/s] 31%|████████████████                                    | 3009/9733 [00:18<00:37, 178.67it/s] 31%|████████████████▏                                   | 3027/9733 [00:18<00:37, 177.82it/s] 31%|████████████████▎                                   | 3045/9733 [00:18<00:37, 178.40it/s] 31%|████████████████▎                                   | 3063/9733 [00:18<00:37, 178.68it/s] 32%|████████████████▍                                   | 3081/9733 [00:18<00:37, 178.90it/s] 32%|████████████████▌                                   | 3100/9733 [00:18<00:37, 179.26it/s] 32%|████████████████▋                                   | 3118/9733 [00:18<00:36, 179.47it/s] 32%|████████████████▊                                   | 3136/9733 [00:18<00:36, 179.05it/s] 32%|████████████████▊                                   | 3154/9733 [00:18<00:37, 177.34it/s] 33%|████████████████▉                                   | 3172/9733 [00:19<00:36, 177.56it/s] 33%|█████████████████                                   | 3191/9733 [00:19<00:36, 178.43it/s] 33%|█████████████████▏                                  | 3209/9733 [00:19<00:36, 178.61it/s] 33%|█████████████████▏                                  | 3227/9733 [00:19<00:36, 179.00it/s] 33%|█████████████████▎                                  | 3246/9733 [00:19<00:36, 179.50it/s] 34%|█████████████████▍                                  | 3264/9733 [00:19<00:36, 179.46it/s] 34%|█████████████████▌                                  | 3282/9733 [00:19<00:35, 179.58it/s] 34%|█████████████████▋                                  | 3301/9733 [00:19<00:35, 179.78it/s] 34%|█████████████████▋                                  | 3319/9733 [00:19<00:35, 178.58it/s] 34%|█████████████████▊                                  | 3337/9733 [00:19<00:35, 178.95it/s] 34%|█████████████████▉                                  | 3355/9733 [00:20<00:35, 179.17it/s] 35%|██████████████████                                  | 3374/9733 [00:20<00:35, 179.43it/s] 35%|██████████████████                                  | 3392/9733 [00:20<00:35, 178.13it/s] 35%|██████████████████▏                                 | 3410/9733 [00:20<00:35, 178.35it/s] 35%|██████████████████▎                                 | 3428/9733 [00:20<00:35, 178.35it/s] 35%|██████████████████▍                                 | 3446/9733 [00:20<00:35, 177.79it/s] 36%|██████████████████▌                                 | 3464/9733 [00:20<00:35, 178.32it/s] 36%|██████████████████▌                                 | 3482/9733 [00:20<00:34, 178.71it/s] 36%|██████████████████▋                                 | 3500/9733 [00:20<00:34, 178.85it/s] 36%|██████████████████▊                                 | 3518/9733 [00:20<00:34, 179.17it/s] 36%|██████████████████▉                                 | 3536/9733 [00:21<00:34, 179.41it/s] 37%|██████████████████▉                                 | 3555/9733 [00:21<00:34, 179.67it/s] 37%|███████████████████                                 | 3573/9733 [00:21<00:34, 179.63it/s] 37%|███████████████████▏                                | 3591/9733 [00:21<00:34, 178.39it/s] 37%|███████████████████▎                                | 3609/9733 [00:21<00:34, 175.70it/s] 37%|███████████████████▍                                | 3627/9733 [00:21<00:34, 176.66it/s] 37%|███████████████████▍                                | 3645/9733 [00:21<00:34, 177.38it/s] 38%|███████████████████▌                                | 3663/9733 [00:21<00:34, 177.91it/s] 38%|███████████████████▋                                | 3682/9733 [00:21<00:33, 178.63it/s] 38%|███████████████████▊                                | 3700/9733 [00:21<00:33, 178.87it/s] 38%|███████████████████▊                                | 3718/9733 [00:22<00:33, 178.80it/s] 38%|███████████████████▉                                | 3736/9733 [00:22<00:33, 179.06it/s] 39%|████████████████████                                | 3754/9733 [00:22<00:33, 179.23it/s] 39%|████████████████████▏                               | 3772/9733 [00:22<00:33, 178.91it/s] 39%|████████████████████▏                               | 3790/9733 [00:22<00:33, 178.92it/s] 39%|████████████████████▎                               | 3808/9733 [00:22<00:33, 179.24it/s] 39%|████████████████████▍                               | 3826/9733 [00:22<00:32, 179.13it/s] 39%|████████████████████▌                               | 3844/9733 [00:22<00:33, 177.64it/s] 40%|████████████████████▋                               | 3862/9733 [00:22<00:33, 176.78it/s] 40%|████████████████████▋                               | 3880/9733 [00:22<00:32, 177.52it/s] 40%|████████████████████▊                               | 3898/9733 [00:23<00:32, 178.23it/s] 40%|████████████████████▉                               | 3916/9733 [00:23<00:32, 178.54it/s] 40%|█████████████████████                               | 3934/9733 [00:23<00:32, 178.56it/s] 41%|█████████████████████                               | 3952/9733 [00:23<00:32, 178.35it/s] 41%|█████████████████████▏                              | 3970/9733 [00:23<00:32, 178.27it/s] 41%|█████████████████████▎                              | 3988/9733 [00:23<00:32, 178.05it/s] 41%|█████████████████████▍                              | 4006/9733 [00:23<00:32, 178.30it/s] 41%|█████████████████████▍                              | 4024/9733 [00:23<00:32, 178.11it/s] 42%|█████████████████████▌                              | 4042/9733 [00:23<00:32, 176.29it/s] 42%|█████████████████████▋                              | 4060/9733 [00:24<00:32, 175.15it/s] 42%|█████████████████████▊                              | 4078/9733 [00:24<00:32, 174.41it/s] 42%|█████████████████████▉                              | 4096/9733 [00:24<00:32, 175.45it/s] 42%|█████████████████████▉                              | 4114/9733 [00:24<00:31, 176.29it/s] 42%|██████████████████████                              | 4132/9733 [00:24<00:31, 176.70it/s] 43%|██████████████████████▏                             | 4150/9733 [00:24<00:31, 176.96it/s] 43%|██████████████████████▎                             | 4168/9733 [00:24<00:31, 177.17it/s] 43%|██████████████████████▎                             | 4186/9733 [00:24<00:31, 177.32it/s] 43%|██████████████████████▍                             | 4204/9733 [00:24<00:31, 176.96it/s] 43%|██████████████████████▌                             | 4222/9733 [00:24<00:31, 177.24it/s] 44%|██████████████████████▋                             | 4240/9733 [00:25<00:30, 177.55it/s] 44%|██████████████████████▋                             | 4258/9733 [00:25<00:31, 176.52it/s] 44%|██████████████████████▊                             | 4276/9733 [00:25<00:30, 176.71it/s] 44%|██████████████████████▉                             | 4294/9733 [00:25<00:30, 175.61it/s] 44%|███████████████████████                             | 4312/9733 [00:25<00:30, 176.23it/s] 44%|███████████████████████▏                            | 4330/9733 [00:25<00:30, 176.79it/s] 45%|███████████████████████▏                            | 4348/9733 [00:25<00:30, 177.20it/s] 45%|███████████████████████▎                            | 4366/9733 [00:25<00:30, 174.43it/s] 45%|███████████████████████▍                            | 4384/9733 [00:25<00:30, 175.49it/s] 45%|███████████████████████▌                            | 4402/9733 [00:25<00:30, 176.23it/s] 45%|███████████████████████▌                            | 4420/9733 [00:26<00:30, 176.09it/s] 46%|███████████████████████▋                            | 4438/9733 [00:26<00:30, 175.05it/s] 46%|███████████████████████▊                            | 4456/9733 [00:26<00:30, 174.69it/s] 46%|███████████████████████▉                            | 4474/9733 [00:26<00:29, 175.59it/s] 46%|███████████████████████▉                            | 4492/9733 [00:26<00:29, 176.26it/s] 46%|████████████████████████                            | 4510/9733 [00:26<00:29, 176.65it/s] 47%|████████████████████████▏                           | 4528/9733 [00:26<00:34, 150.98it/s] 47%|████████████████████████▎                           | 4546/9733 [00:26<00:32, 158.31it/s] 47%|████████████████████████▍                           | 4564/9733 [00:26<00:31, 163.78it/s] 47%|████████████████████████▍                           | 4582/9733 [00:27<00:30, 167.92it/s] 47%|████████████████████████▌                           | 4600/9733 [00:27<00:30, 170.76it/s] 47%|████████████████████████▋                           | 4618/9733 [00:27<00:29, 172.77it/s] 48%|████████████████████████▊                           | 4636/9733 [00:27<00:29, 174.38it/s] 48%|████████████████████████▊                           | 4654/9733 [00:27<00:28, 175.48it/s] 48%|████████████████████████▉                           | 4672/9733 [00:27<00:28, 175.98it/s] 48%|█████████████████████████                           | 4690/9733 [00:27<00:28, 176.52it/s] 48%|█████████████████████████▏                          | 4708/9733 [00:27<00:28, 176.88it/s] 49%|█████████████████████████▏                          | 4726/9733 [00:27<00:28, 177.72it/s] 49%|█████████████████████████▎                          | 4744/9733 [00:28<00:42, 117.13it/s] 49%|█████████████████████████▍                          | 4763/9733 [00:28<00:37, 131.45it/s] 49%|█████████████████████████▌                          | 4781/9733 [00:28<00:34, 142.87it/s] 49%|█████████████████████████▋                          | 4799/9733 [00:28<00:32, 152.11it/s] 49%|█████████████████████████▋                          | 4817/9733 [00:28<00:30, 159.43it/s] 50%|█████████████████████████▊                          | 4835/9733 [00:28<00:29, 164.74it/s] 50%|█████████████████████████▉                          | 4853/9733 [00:28<00:28, 168.72it/s] 50%|██████████████████████████                          | 4871/9733 [00:28<00:28, 171.83it/s] 50%|██████████████████████████                          | 4889/9733 [00:28<00:27, 174.16it/s] 50%|██████████████████████████▏                         | 4907/9733 [00:29<00:27, 175.76it/s] 51%|██████████████████████████▎                         | 4925/9733 [00:29<00:27, 176.88it/s] 51%|██████████████████████████▍                         | 4944/9733 [00:29<00:26, 177.94it/s] 51%|██████████████████████████▌                         | 4962/9733 [00:29<00:26, 177.13it/s] 51%|██████████████████████████▌                         | 4980/9733 [00:29<00:26, 177.68it/s] 51%|██████████████████████████▋                         | 4998/9733 [00:29<00:26, 178.34it/s] 52%|██████████████████████████▊                         | 5016/9733 [00:29<00:26, 178.63it/s] 52%|██████████████████████████▉                         | 5035/9733 [00:29<00:26, 179.09it/s] 52%|██████████████████████████▉                         | 5053/9733 [00:29<00:26, 179.32it/s] 52%|███████████████████████████                         | 5071/9733 [00:29<00:26, 179.28it/s] 52%|███████████████████████████▏                        | 5089/9733 [00:30<00:25, 179.42it/s] 52%|███████████████████████████▎                        | 5107/9733 [00:30<00:25, 179.57it/s] 53%|███████████████████████████▍                        | 5125/9733 [00:30<00:25, 179.58it/s] 53%|███████████████████████████▍                        | 5143/9733 [00:30<00:25, 179.66it/s] 53%|███████████████████████████▌                        | 5161/9733 [00:30<00:25, 179.26it/s] 53%|███████████████████████████▋                        | 5179/9733 [00:30<00:25, 177.85it/s] 53%|███████████████████████████▊                        | 5197/9733 [00:30<00:25, 178.39it/s] 54%|███████████████████████████▊                        | 5215/9733 [00:30<00:25, 178.60it/s] 54%|███████████████████████████▉                        | 5234/9733 [00:30<00:25, 179.05it/s] 54%|████████████████████████████                        | 5252/9733 [00:30<00:24, 179.25it/s] 54%|████████████████████████████▏                       | 5270/9733 [00:31<00:24, 179.31it/s] 54%|████████████████████████████▎                       | 5289/9733 [00:31<00:24, 179.52it/s] 55%|████████████████████████████▎                       | 5307/9733 [00:31<00:24, 179.63it/s] 55%|████████████████████████████▍                       | 5325/9733 [00:31<00:24, 179.42it/s] 55%|████████████████████████████▌                       | 5343/9733 [00:31<00:24, 179.25it/s] 55%|████████████████████████████▋                       | 5361/9733 [00:31<00:24, 179.17it/s] 55%|████████████████████████████▋                       | 5380/9733 [00:31<00:24, 179.42it/s] 55%|████████████████████████████▊                       | 5398/9733 [00:31<00:24, 179.52it/s] 56%|████████████████████████████▉                       | 5416/9733 [00:31<00:24, 177.94it/s] 56%|█████████████████████████████                       | 5434/9733 [00:31<00:24, 178.44it/s] 56%|█████████████████████████████▏                      | 5452/9733 [00:32<00:23, 178.83it/s] 56%|█████████████████████████████▏                      | 5470/9733 [00:32<00:23, 179.13it/s] 56%|█████████████████████████████▎                      | 5489/9733 [00:32<00:23, 180.58it/s] 57%|█████████████████████████████▍                      | 5508/9733 [00:32<00:23, 181.56it/s] 57%|█████████████████████████████▌                      | 5527/9733 [00:32<00:23, 182.35it/s] 57%|█████████████████████████████▋                      | 5546/9733 [00:32<00:22, 182.95it/s] 57%|█████████████████████████████▋                      | 5565/9733 [00:32<00:22, 182.93it/s] 57%|█████████████████████████████▊                      | 5584/9733 [00:32<00:22, 183.22it/s] 58%|█████████████████████████████▉                      | 5603/9733 [00:32<00:22, 183.46it/s] 58%|██████████████████████████████                      | 5622/9733 [00:32<00:22, 183.73it/s] 58%|██████████████████████████████▏                     | 5641/9733 [00:33<00:22, 182.37it/s] 58%|██████████████████████████████▏                     | 5660/9733 [00:33<00:22, 182.99it/s] 58%|██████████████████████████████▎                     | 5679/9733 [00:33<00:22, 183.41it/s] 59%|██████████████████████████████▍                     | 5698/9733 [00:33<00:21, 183.73it/s] 59%|██████████████████████████████▌                     | 5717/9733 [00:33<00:21, 184.04it/s] 59%|██████████████████████████████▋                     | 5736/9733 [00:33<00:21, 184.18it/s] 59%|██████████████████████████████▋                     | 5755/9733 [00:33<00:21, 183.87it/s] 59%|██████████████████████████████▊                     | 5774/9733 [00:33<00:21, 183.87it/s] 60%|██████████████████████████████▉                     | 5793/9733 [00:33<00:21, 184.00it/s] 60%|███████████████████████████████                     | 5812/9733 [00:34<00:21, 184.02it/s] 60%|███████████████████████████████▏                    | 5831/9733 [00:34<00:21, 184.02it/s] 60%|███████████████████████████████▎                    | 5850/9733 [00:34<00:21, 183.81it/s] 60%|███████████████████████████████▎                    | 5869/9733 [00:34<00:21, 182.56it/s] 60%|███████████████████████████████▍                    | 5888/9733 [00:34<00:21, 183.03it/s] 61%|███████████████████████████████▌                    | 5907/9733 [00:34<00:20, 183.32it/s] 61%|███████████████████████████████▋                    | 5926/9733 [00:34<00:20, 183.09it/s] 61%|███████████████████████████████▊                    | 5945/9733 [00:34<00:20, 183.49it/s] 61%|███████████████████████████████▊                    | 5964/9733 [00:34<00:20, 183.93it/s] 61%|███████████████████████████████▉                    | 5983/9733 [00:34<00:20, 184.07it/s] 62%|████████████████████████████████                    | 6002/9733 [00:35<00:20, 184.06it/s] 62%|████████████████████████████████▏                   | 6021/9733 [00:35<00:20, 184.21it/s] 62%|████████████████████████████████▎                   | 6040/9733 [00:35<00:20, 184.26it/s] 62%|████████████████████████████████▎                   | 6059/9733 [00:35<00:19, 184.32it/s] 62%|████████████████████████████████▍                   | 6078/9733 [00:35<00:19, 184.28it/s] 63%|████████████████████████████████▌                   | 6097/9733 [00:35<00:19, 182.80it/s] 63%|████████████████████████████████▋                   | 6116/9733 [00:35<00:19, 183.23it/s] 63%|████████████████████████████████▊                   | 6135/9733 [00:35<00:19, 183.41it/s] 63%|████████████████████████████████▉                   | 6154/9733 [00:35<00:19, 183.64it/s] 63%|████████████████████████████████▉                   | 6173/9733 [00:35<00:19, 183.73it/s] 64%|█████████████████████████████████                   | 6192/9733 [00:36<00:19, 183.21it/s] 64%|█████████████████████████████████▏                  | 6211/9733 [00:36<00:19, 183.36it/s] 64%|█████████████████████████████████▎                  | 6230/9733 [00:36<00:19, 183.46it/s] 64%|█████████████████████████████████▍                  | 6249/9733 [00:36<00:18, 183.61it/s] 64%|█████████████████████████████████▍                  | 6268/9733 [00:36<00:18, 183.61it/s] 65%|█████████████████████████████████▌                  | 6287/9733 [00:36<00:18, 183.90it/s] 65%|█████████████████████████████████▋                  | 6306/9733 [00:36<00:18, 183.87it/s] 65%|█████████████████████████████████▊                  | 6325/9733 [00:36<00:18, 182.36it/s] 65%|█████████████████████████████████▉                  | 6344/9733 [00:36<00:18, 182.88it/s] 65%|█████████████████████████████████▉                  | 6363/9733 [00:37<00:18, 183.16it/s] 66%|██████████████████████████████████                  | 6382/9733 [00:37<00:18, 183.52it/s] 66%|██████████████████████████████████▏                 | 6401/9733 [00:37<00:18, 183.76it/s] 66%|██████████████████████████████████▎                 | 6420/9733 [00:37<00:18, 183.85it/s] 66%|██████████████████████████████████▍                 | 6439/9733 [00:37<00:17, 183.90it/s] 66%|██████████████████████████████████▌                 | 6458/9733 [00:37<00:17, 183.85it/s] 67%|██████████████████████████████████▌                 | 6477/9733 [00:37<00:17, 184.03it/s] 67%|██████████████████████████████████▋                 | 6496/9733 [00:37<00:17, 184.13it/s] 67%|██████████████████████████████████▊                 | 6515/9733 [00:37<00:17, 183.81it/s] 67%|██████████████████████████████████▉                 | 6534/9733 [00:37<00:17, 181.13it/s] 67%|███████████████████████████████████                 | 6553/9733 [00:38<00:17, 181.78it/s] 68%|███████████████████████████████████                 | 6572/9733 [00:38<00:17, 182.47it/s] 68%|███████████████████████████████████▏                | 6591/9733 [00:38<00:17, 182.75it/s] 68%|███████████████████████████████████▎                | 6610/9733 [00:38<00:17, 183.29it/s] 68%|███████████████████████████████████▍                | 6629/9733 [00:38<00:16, 183.56it/s] 68%|███████████████████████████████████▌                | 6648/9733 [00:38<00:16, 183.67it/s] 68%|███████████████████████████████████▌                | 6667/9733 [00:38<00:16, 183.85it/s] 69%|███████████████████████████████████▋                | 6686/9733 [00:38<00:16, 183.88it/s] 69%|███████████████████████████████████▊                | 6705/9733 [00:38<00:16, 184.02it/s] 69%|███████████████████████████████████▉                | 6724/9733 [00:38<00:16, 183.58it/s] 69%|████████████████████████████████████                | 6743/9733 [00:39<00:16, 183.76it/s] 69%|████████████████████████████████████▏               | 6762/9733 [00:39<00:16, 182.45it/s] 70%|████████████████████████████████████▏               | 6781/9733 [00:39<00:16, 182.91it/s] 70%|████████████████████████████████████▎               | 6800/9733 [00:39<00:16, 183.20it/s] 70%|████████████████████████████████████▍               | 6819/9733 [00:39<00:15, 183.21it/s] 70%|████████████████████████████████████▌               | 6838/9733 [00:39<00:15, 183.53it/s] 70%|████████████████████████████████████▋               | 6857/9733 [00:39<00:15, 183.78it/s] 71%|████████████████████████████████████▋               | 6876/9733 [00:39<00:15, 183.07it/s] 71%|████████████████████████████████████▊               | 6895/9733 [00:39<00:15, 183.30it/s] 71%|████████████████████████████████████▉               | 6914/9733 [00:40<00:15, 181.28it/s] 71%|█████████████████████████████████████               | 6933/9733 [00:40<00:18, 149.21it/s] 71%|█████████████████████████████████████▏              | 6949/9733 [00:40<00:20, 137.58it/s] 72%|█████████████████████████████████████▏              | 6964/9733 [00:40<00:21, 129.09it/s] 72%|█████████████████████████████████████▎              | 6978/9733 [00:40<00:22, 124.45it/s] 72%|█████████████████████████████████████▎              | 6991/9733 [00:40<00:22, 119.72it/s] 72%|█████████████████████████████████████▍              | 7004/9733 [00:40<00:23, 116.97it/s] 72%|█████████████████████████████████████▍              | 7016/9733 [00:40<00:23, 115.21it/s] 72%|█████████████████████████████████████▌              | 7028/9733 [00:41<00:23, 114.50it/s] 72%|█████████████████████████████████████▌              | 7040/9733 [00:41<00:23, 113.92it/s] 72%|█████████████████████████████████████▋              | 7052/9733 [00:41<00:23, 113.11it/s] 73%|█████████████████████████████████████▋              | 7064/9733 [00:41<00:23, 112.35it/s] 73%|█████████████████████████████████████▊              | 7076/9733 [00:41<00:23, 111.74it/s] 73%|█████████████████████████████████████▊              | 7088/9733 [00:41<00:25, 105.71it/s] 73%|█████████████████████████████████████▉              | 7099/9733 [00:41<00:25, 101.78it/s] 73%|█████████████████████████████████████▉              | 7110/9733 [00:41<00:25, 103.84it/s] 73%|██████████████████████████████████████              | 7122/9733 [00:41<00:24, 105.89it/s] 73%|██████████████████████████████████████              | 7134/9733 [00:42<00:24, 107.33it/s] 73%|██████████████████████████████████████▏             | 7146/9733 [00:42<00:23, 108.39it/s] 74%|██████████████████████████████████████▏             | 7158/9733 [00:42<00:23, 109.54it/s] 74%|██████████████████████████████████████▎             | 7169/9733 [00:42<00:23, 109.60it/s] 74%|██████████████████████████████████████▎             | 7181/9733 [00:42<00:23, 109.99it/s] 74%|██████████████████████████████████████▍             | 7193/9733 [00:42<00:23, 109.91it/s] 74%|██████████████████████████████████████▍             | 7205/9733 [00:42<00:22, 111.66it/s] 74%|██████████████████████████████████████▌             | 7217/9733 [00:42<00:22, 112.39it/s] 74%|██████████████████████████████████████▋             | 7230/9733 [00:42<00:21, 114.78it/s] 74%|██████████████████████████████████████▋             | 7242/9733 [00:43<00:21, 116.19it/s] 75%|██████████████████████████████████████▊             | 7255/9733 [00:43<00:21, 117.32it/s] 75%|██████████████████████████████████████▊             | 7267/9733 [00:43<00:20, 117.90it/s] 75%|██████████████████████████████████████▉             | 7279/9733 [00:43<00:20, 118.01it/s] 75%|██████████████████████████████████████▉             | 7291/9733 [00:43<00:20, 116.84it/s] 75%|███████████████████████████████████████             | 7303/9733 [00:43<00:20, 116.08it/s] 75%|███████████████████████████████████████             | 7315/9733 [00:43<00:21, 114.84it/s] 75%|███████████████████████████████████████▏            | 7327/9733 [00:43<00:20, 114.79it/s] 75%|███████████████████████████████████████▏            | 7339/9733 [00:43<00:20, 114.62it/s] 76%|███████████████████████████████████████▎            | 7351/9733 [00:43<00:20, 114.06it/s] 76%|███████████████████████████████████████▎            | 7363/9733 [00:44<00:20, 113.64it/s] 76%|███████████████████████████████████████▍            | 7375/9733 [00:44<00:20, 113.22it/s] 76%|███████████████████████████████████████▍            | 7387/9733 [00:44<00:20, 113.16it/s] 76%|███████████████████████████████████████▌            | 7399/9733 [00:44<00:20, 113.37it/s] 76%|███████████████████████████████████████▌            | 7411/9733 [00:44<00:20, 113.58it/s] 76%|███████████████████████████████████████▋            | 7423/9733 [00:44<00:20, 113.75it/s] 76%|███████████████████████████████████████▋            | 7435/9733 [00:44<00:20, 113.16it/s] 77%|████████████████████████████████████████▌            | 7447/9733 [00:44<00:25, 90.12it/s] 77%|████████████████████████████████████████▌            | 7459/9733 [00:45<00:23, 95.98it/s] 77%|███████████████████████████████████████▉            | 7477/9733 [00:45<00:19, 116.22it/s] 77%|████████████████████████████████████████            | 7495/9733 [00:45<00:16, 132.33it/s] 77%|████████████████████████████████████████▏           | 7513/9733 [00:45<00:15, 144.14it/s] 77%|████████████████████████████████████████▏           | 7531/9733 [00:45<00:14, 152.97it/s] 78%|████████████████████████████████████████▎           | 7548/9733 [00:45<00:13, 157.71it/s] 78%|████████████████████████████████████████▍           | 7566/9733 [00:45<00:13, 162.63it/s] 78%|████████████████████████████████████████▌           | 7584/9733 [00:45<00:12, 165.60it/s] 78%|████████████████████████████████████████▌           | 7602/9733 [00:45<00:12, 167.97it/s] 78%|████████████████████████████████████████▋           | 7620/9733 [00:45<00:12, 169.75it/s] 78%|████████████████████████████████████████▊           | 7638/9733 [00:46<00:12, 172.34it/s] 79%|████████████████████████████████████████▉           | 7657/9733 [00:46<00:11, 175.67it/s] 79%|█████████████████████████████████████████           | 7675/9733 [00:46<00:11, 176.28it/s] 79%|█████████████████████████████████████████           | 7694/9733 [00:46<00:11, 178.47it/s] 79%|█████████████████████████████████████████▏          | 7713/9733 [00:46<00:11, 180.26it/s] 79%|█████████████████████████████████████████▎          | 7732/9733 [00:46<00:11, 181.40it/s] 80%|█████████████████████████████████████████▍          | 7751/9733 [00:46<00:10, 181.98it/s] 80%|█████████████████████████████████████████▌          | 7770/9733 [00:46<00:10, 182.49it/s] 80%|█████████████████████████████████████████▌          | 7789/9733 [00:46<00:10, 182.71it/s] 80%|█████████████████████████████████████████▋          | 7808/9733 [00:46<00:10, 182.96it/s] 80%|█████████████████████████████████████████▊          | 7827/9733 [00:47<00:10, 183.09it/s] 81%|█████████████████████████████████████████▉          | 7846/9733 [00:47<00:10, 182.36it/s] 81%|██████████████████████████████████████████          | 7865/9733 [00:47<00:10, 182.42it/s] 81%|██████████████████████████████████████████          | 7884/9733 [00:47<00:10, 182.55it/s] 81%|██████████████████████████████████████████▏         | 7903/9733 [00:47<00:10, 181.43it/s] 81%|██████████████████████████████████████████▎         | 7922/9733 [00:47<00:09, 182.16it/s] 82%|██████████████████████████████████████████▍         | 7941/9733 [00:47<00:09, 182.62it/s] 82%|██████████████████████████████████████████▌         | 7960/9733 [00:47<00:09, 182.36it/s] 82%|██████████████████████████████████████████▋         | 7979/9733 [00:47<00:09, 182.73it/s] 82%|██████████████████████████████████████████▋         | 7998/9733 [00:47<00:09, 183.02it/s] 82%|██████████████████████████████████████████▊         | 8017/9733 [00:48<00:09, 183.19it/s] 83%|██████████████████████████████████████████▉         | 8036/9733 [00:48<00:09, 183.28it/s] 83%|███████████████████████████████████████████         | 8055/9733 [00:48<00:09, 183.13it/s] 83%|███████████████████████████████████████████▏        | 8074/9733 [00:48<00:09, 183.38it/s] 83%|███████████████████████████████████████████▏        | 8093/9733 [00:48<00:08, 183.50it/s] 83%|███████████████████████████████████████████▎        | 8112/9733 [00:48<00:08, 183.47it/s] 84%|███████████████████████████████████████████▍        | 8131/9733 [00:48<00:08, 181.86it/s] 84%|███████████████████████████████████████████▌        | 8150/9733 [00:48<00:08, 182.48it/s] 84%|███████████████████████████████████████████▋        | 8169/9733 [00:48<00:08, 182.91it/s] 84%|███████████████████████████████████████████▋        | 8188/9733 [00:49<00:08, 183.21it/s] 84%|███████████████████████████████████████████▊        | 8207/9733 [00:49<00:08, 183.41it/s] 85%|███████████████████████████████████████████▉        | 8226/9733 [00:49<00:08, 183.53it/s] 85%|████████████████████████████████████████████        | 8245/9733 [00:49<00:08, 183.63it/s] 85%|████████████████████████████████████████████▏       | 8264/9733 [00:49<00:08, 183.60it/s] 85%|████████████████████████████████████████████▎       | 8283/9733 [00:49<00:07, 183.55it/s] 85%|████████████████████████████████████████████▎       | 8302/9733 [00:49<00:07, 183.58it/s] 85%|████████████████████████████████████████████▍       | 8321/9733 [00:49<00:07, 183.78it/s] 86%|████████████████████████████████████████████▌       | 8340/9733 [00:49<00:07, 183.75it/s] 86%|████████████████████████████████████████████▋       | 8359/9733 [00:49<00:07, 181.70it/s] 86%|████████████████████████████████████████████▊       | 8378/9733 [00:50<00:07, 182.09it/s] 86%|████████████████████████████████████████████▊       | 8397/9733 [00:50<00:07, 182.51it/s] 86%|████████████████████████████████████████████▉       | 8416/9733 [00:50<00:07, 182.99it/s] 87%|█████████████████████████████████████████████       | 8435/9733 [00:50<00:07, 183.23it/s] 87%|█████████████████████████████████████████████▏      | 8454/9733 [00:50<00:06, 183.43it/s] 87%|█████████████████████████████████████████████▎      | 8473/9733 [00:50<00:06, 183.36it/s] 87%|█████████████████████████████████████████████▎      | 8492/9733 [00:50<00:06, 183.62it/s] 87%|█████████████████████████████████████████████▍      | 8511/9733 [00:50<00:06, 183.71it/s] 88%|█████████████████████████████████████████████▌      | 8530/9733 [00:50<00:06, 183.44it/s] 88%|█████████████████████████████████████████████▋      | 8549/9733 [00:51<00:06, 183.58it/s] 88%|█████████████████████████████████████████████▊      | 8568/9733 [00:51<00:06, 183.39it/s] 88%|█████████████████████████████████████████████▉      | 8587/9733 [00:51<00:06, 182.12it/s] 88%|█████████████████████████████████████████████▉      | 8606/9733 [00:51<00:06, 182.36it/s] 89%|██████████████████████████████████████████████      | 8625/9733 [00:51<00:06, 177.43it/s] 89%|██████████████████████████████████████████████▏     | 8644/9733 [00:51<00:06, 179.16it/s] 89%|██████████████████████████████████████████████▎     | 8663/9733 [00:51<00:05, 180.44it/s] 89%|██████████████████████████████████████████████▍     | 8682/9733 [00:51<00:05, 181.22it/s] 89%|██████████████████████████████████████████████▍     | 8701/9733 [00:51<00:05, 181.83it/s] 90%|██████████████████████████████████████████████▌     | 8720/9733 [00:51<00:05, 182.35it/s] 90%|██████████████████████████████████████████████▋     | 8739/9733 [00:52<00:05, 182.77it/s] 90%|██████████████████████████████████████████████▊     | 8758/9733 [00:52<00:05, 183.03it/s] 90%|██████████████████████████████████████████████▉     | 8777/9733 [00:52<00:05, 182.98it/s] 90%|██████████████████████████████████████████████▉     | 8796/9733 [00:52<00:05, 182.99it/s] 91%|███████████████████████████████████████████████     | 8815/9733 [00:52<00:05, 181.09it/s] 91%|███████████████████████████████████████████████▏    | 8834/9733 [00:52<00:04, 181.39it/s] 91%|███████████████████████████████████████████████▎    | 8853/9733 [00:52<00:04, 181.79it/s] 91%|███████████████████████████████████████████████▍    | 8872/9733 [00:52<00:04, 182.43it/s] 91%|███████████████████████████████████████████████▌    | 8891/9733 [00:52<00:04, 182.77it/s] 92%|███████████████████████████████████████████████▌    | 8910/9733 [00:52<00:04, 182.43it/s] 92%|███████████████████████████████████████████████▋    | 8929/9733 [00:53<00:04, 182.71it/s] 92%|███████████████████████████████████████████████▊    | 8948/9733 [00:53<00:04, 182.95it/s] 92%|███████████████████████████████████████████████▉    | 8967/9733 [00:53<00:04, 182.98it/s] 92%|████████████████████████████████████████████████    | 8986/9733 [00:53<00:04, 183.15it/s] 93%|████████████████████████████████████████████████    | 9005/9733 [00:53<00:03, 183.29it/s] 93%|████████████████████████████████████████████████▏   | 9024/9733 [00:53<00:03, 183.41it/s] 93%|████████████████████████████████████████████████▎   | 9043/9733 [00:53<00:03, 181.99it/s] 93%|████████████████████████████████████████████████▍   | 9062/9733 [00:53<00:03, 182.58it/s] 93%|████████████████████████████████████████████████▌   | 9081/9733 [00:53<00:03, 182.90it/s] 93%|████████████████████████████████████████████████▌   | 9100/9733 [00:54<00:03, 183.24it/s] 94%|████████████████████████████████████████████████▋   | 9119/9733 [00:54<00:03, 183.50it/s] 94%|████████████████████████████████████████████████▊   | 9138/9733 [00:54<00:03, 183.63it/s] 94%|████████████████████████████████████████████████▉   | 9157/9733 [00:54<00:03, 183.73it/s] 94%|█████████████████████████████████████████████████   | 9176/9733 [00:54<00:03, 183.84it/s] 94%|█████████████████████████████████████████████████▏  | 9195/9733 [00:54<00:02, 183.31it/s] 95%|█████████████████████████████████████████████████▏  | 9214/9733 [00:54<00:02, 182.85it/s] 95%|█████████████████████████████████████████████████▎  | 9233/9733 [00:54<00:02, 182.79it/s] 95%|█████████████████████████████████████████████████▍  | 9252/9733 [00:54<00:02, 182.89it/s] 95%|█████████████████████████████████████████████████▌  | 9271/9733 [00:54<00:02, 181.49it/s] 95%|█████████████████████████████████████████████████▋  | 9290/9733 [00:55<00:02, 181.93it/s] 96%|█████████████████████████████████████████████████▋  | 9309/9733 [00:55<00:02, 182.38it/s] 96%|█████████████████████████████████████████████████▊  | 9328/9733 [00:55<00:02, 182.82it/s] 96%|█████████████████████████████████████████████████▉  | 9347/9733 [00:55<00:02, 182.94it/s] 96%|██████████████████████████████████████████████████  | 9366/9733 [00:55<00:02, 183.20it/s] 96%|██████████████████████████████████████████████████▏ | 9385/9733 [00:55<00:01, 182.74it/s] 97%|██████████████████████████████████████████████████▏ | 9404/9733 [00:55<00:01, 182.06it/s] 97%|██████████████████████████████████████████████████▎ | 9423/9733 [00:55<00:01, 182.45it/s] 97%|██████████████████████████████████████████████████▍ | 9442/9733 [00:55<00:01, 182.39it/s] 97%|██████████████████████████████████████████████████▌ | 9461/9733 [00:56<00:01, 182.60it/s] 97%|██████████████████████████████████████████████████▋ | 9480/9733 [00:56<00:01, 177.80it/s] 98%|██████████████████████████████████████████████████▋ | 9498/9733 [00:56<00:01, 177.62it/s] 98%|██████████████████████████████████████████████████▊ | 9517/9733 [00:56<00:01, 179.36it/s] 98%|██████████████████████████████████████████████████▉ | 9536/9733 [00:56<00:01, 180.62it/s] 98%|███████████████████████████████████████████████████ | 9555/9733 [00:56<00:00, 181.46it/s] 98%|███████████████████████████████████████████████████▏| 9574/9733 [00:56<00:00, 181.00it/s] 99%|███████████████████████████████████████████████████▎| 9593/9733 [00:56<00:00, 180.92it/s] 99%|███████████████████████████████████████████████████▎| 9612/9733 [00:56<00:00, 181.65it/s] 99%|███████████████████████████████████████████████████▍| 9631/9733 [00:56<00:00, 182.15it/s] 99%|███████████████████████████████████████████████████▌| 9650/9733 [00:57<00:00, 182.34it/s] 99%|███████████████████████████████████████████████████▋| 9669/9733 [00:57<00:00, 182.67it/s]100%|███████████████████████████████████████████████████▊| 9688/9733 [00:57<00:00, 182.72it/s]100%|███████████████████████████████████████████████████▊| 9707/9733 [00:57<00:00, 182.86it/s]100%|███████████████████████████████████████████████████▉| 9726/9733 [00:57<00:00, 181.48it/s]100%|████████████████████████████████████████████████████| 9733/9733 [00:57<00:00, 169.24it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:04<00:09,  4.73s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.35s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.50s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:09<00:04,  4.79s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:06<00:12,  6.03s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.50s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.21s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.36s/it]
Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:11<00:05,  5.63s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  4.93s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  5.07s/it]
Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:11<00:05,  5.89s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  5.08s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:15<00:00,  5.22s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:16<00:00,  5.18s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:16<00:00,  5.38s/it]
[2023-08-22 13:24:35,683] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
[2023-08-22 13:24:46,668] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-22 13:24:46,669] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-22 13:24:46,669] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-22 13:24:46,669] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-22 13:24:46,669] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-22 13:24:46,669] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-22 13:24:46,669] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-22 13:24:46,669] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-22 13:24:46,669] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f438cf39dc0>
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f43587b8280>
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-22 13:24:46,670] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-22 13:24:46,671] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-22 13:24:46,671] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-22 13:24:46,671] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-22 13:24:46,671] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-22 13:24:46,671] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-22 13:24:46,671] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-22 13:24:46,671] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.6078801155090332 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]Loading extension module utils...
############### Example ###############
Time to load utils op: 0.6048095226287842 seconds
### Instruction:Answer the following multiple choice question.

Input: The machine was very intricate, it was quite an what? Choices:  A: box B: apparatus C: appliance D: wash dishes E: implement
Output: 1. The sentence implies that the machine was quite complex or complicated. 
2. We need to find a word that could be used to refer to a complex machine.
3. Looking at the choices, "box" would not be correct because it is not typically used to describe something intricate or complex.
4. Similarly, "wash dishes" is incorrect as it's an action, not a descriptor.
5. While "appliance" and "implement" are words used to describe types of machines, they don't specifically describe a machine as being intricate.
6. Only the word "apparatus" fits well, as it can be used to refer to a complex equipment or machinery.
7. Therefore, the answer is B: apparatus.
So the final answer is B: apparatus

Input: Where do you get petrol? Choices:  A: burn hot B: fuel tank C: burn hot D: car E: gas station
Output: 1. The question asks where you get petrol, which requires an understanding of what petrol is used for and where it is typically acquired.
2. Petrol is a type of fuel used to power internal combustion engines, which are commonly found in cars and other types of vehicles.
3. Looking at the choices, we can eliminate A and C because "burn hot" does not align with the concept of obtaining petrol.
4. Choice B, "fuel tank", is also not a place where you get petrol but rather where petrol is stored after it is acquired.
5. Choice D, "car", can also be eliminated because although we put petrol in a car, we do not obtain petrol from a car.
6. Through process of elimination, we are left with choice E, "gas station".
7. A gas station is where you generally go to acquire petrol for your car.
8. So the best answer to the question "Where do you get petrol?" would be E: gas station.
So the final answer is E: gas station

Input: Where might a television used at night be? Choices:  A: cabinet B: house C: apartment D: bedroom E: woods
Output: Step 1: The question is asking for a location where a television is typically used at night.
Step 2: Let's consider each option individually.
Step 3: Option A is a "cabinet". A cabinet is not a location where a television is typically used at night. Therefore, a cabinet is not the correct answer.
Step 4: Next are options B and C, which are "house" and "apartment". While a television can certainly be used in both a house and an apartment, these are not the most specific answers because they could refer to anywhere within these buildings.
Step 5: We now consider option D, "bedroom". People often use a television in a bedroom at night before sleeping, making this a likely answer.
Step 6: The last option is E, "woods". The woods is not usually a place where people use a television, especially at night.
Step 7: Comparing all the options, the best and most specific answer is D, "bedroom". So, a television used at night might be in a bedroom.
So the final answer is D: bedroom

Input: The knowledge was expensive to get, where was it being gained? Choices:  A: university B: book C: field D: meeting E: class
Output: 1. The question is asking about the location knowledge was being gained.
2. The aspect of being "expensive" is a vital hint given in the question.
3. We know knowledge can be attained from various sources - a book, in the field, during meetings or in a class.
4. However, not all options associate with being "expensive". Books can be priced but it's not necessarily considered that high compared with other options.
5. Knowledge gained at a meeting or in the field does not typically require a large financial investment.
6. When we talk about an expensive learning environment, universities come into play as they often requires significant monetary investment in terms of tuition and other fees.
7. Therefore, the correct answer is A: university.
So the final answer is A: university

Input: Where are small grapes likely to be found? Choices:  A: lunch box B: food store C: wine country D: kitchen E: raisins
Output: 1. To solve this, you must examine each of the answer choices in relation to the original question. A lunch box, a food store, a kitchen, and raisins are all places where grapes of any size might be located. However, these options do not specify the size of the grapes.

2. The term'small grapes' can often be associated with the type of grapes used in wine making. These grapes are typically smaller than the type you'd find in a grocery store.

3. The term 'wine country' refers to regions that are famed for their vineyards and wine production. 

4. Thus option C: wine country is the place where small grapes are most likely to be found because it is the only choice that directly connects to the concept of small grapes used in wine making. 

5. Hence, the answer is C: wine country.
So the final answer is C: wine country

Input: The painter explained how he never achieved a flawless portrait, he said this was because all people are what? Choices:  A: imperfect B: disfigured C: damaged D: flawed E: defective
Output: Step 1: The question asks what the painter believes about all people, which is the reason he never achieves a flawless portrait. 
Step 2: To begin the reasoning process, we need to find a term from the choices that aligns with the notion that people are not without flaws. 
Step 3: A look at the choices presents us with the options: imperfect, disfigured, damaged, flawed, and defective. 
Step 4: Disfigured, damaged, and defective are eliminated because they imply physical or serious flaws which may not apply to all people and don't necessarily represent the common understanding of human nature. 
Step 5: Looking at the remaining options (imperfect and flawed), flawed carries a significantly negative connotation compared to imperfect. Since there is no indication from the question that the painter views all people in a negative light, we eliminate flawed. 
Final Step: Therefore, the only suitable choice that aligns with believing all people have some shortcomings but does not denote a negative connotation is "imperfect," making option A: Imperfect the correct answer.
So the final answer is A: imperfect

Input: If you're betting with a shark, where are you likely playing? Choices:  A: aquarium B: mediterranean sea C: south pacific D: pool hall E: pacific ocean
Output: 1. Understand the question and the set of answers given. It may seem that the question refers to a real shark, implying water-based environments like an aquarium, the Mediterranean Sea, South Pacific or Pacific Ocean.
2. Understand the slang term “shark.” In some contexts, especially in the field of gaming and betting, a "shark" is a slang term referring to a person who is an expert or highly skilled professional.
3. Apply the meaning of "shark" to the given options. Considering the "shark" as a skilled gamer, it can be deduced that a shark does not necessarily mean a real marine creature but someone good at games.
4. Analyze the answer choices. Among the options listed, the only place where you are likely to play or bet with a highly skilled professional or expert "shark" in gaming is D: pool hall. 
5. Therefore, the answer is D: Pool Hall. A pool hall is a place where "sharks" or skilled individuals play pool games and sometimes place bets.
So the final answer is D: pool hall

Input: Marmot's can be found in high places.  They have hands that they can use to get to the top of what? Choices:  A: outside B: hill C: jungle D: rocky hillside E: tree
Output: 1. The first step is to understand the main features of the question which talks about Marmot's ability to reach high places due to their hands.
2. As per the question, we should associate their hands with an ability to climb.
3. The next step is to identify the options that involve climbing.
4. Among the given options, 'outside' is too general and does not specify a particular place or object that a marmot could climb.
5
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i8-s20-rTrue
Loading extension module utils...
Time to load utils op: 0.604881763458252 seconds
Loading extension module utils...
Time to load utils op: 0.6049072742462158 seconds
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:39<32:05, 39.30s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:18<31:30, 39.39s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [01:57<30:41, 39.18s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [02:36<29:50, 38.93s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [03:14<29:05, 38.78s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [03:53<28:24, 38.74s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [04:32<27:44, 38.70s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [05:10<27:03, 38.65s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [05:49<26:24, 38.64s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [06:27<25:44, 38.60s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [07:06<25:06, 38.62s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [07:44<24:27, 38.61s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [08:23<23:48, 38.59s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [09:01<23:07, 38.55s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [09:40<22:29, 38.57s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [10:19<21:50, 38.54s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [10:57<21:11, 38.54s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [11:36<20:33, 38.53s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [12:14<19:53, 38.50s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [12:53<19:15, 38.51s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [13:31<18:37, 38.55s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [14:10<17:59, 38.55s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [14:46<17:00, 37.78s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [15:24<16:28, 38.00s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [16:03<15:53, 38.15s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [16:41<15:18, 38.26s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [17:20<14:41, 38.32s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [17:58<14:04, 38.41s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [18:37<13:27, 38.45s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [19:15<12:49, 38.49s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [19:54<12:10, 38.44s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [20:32<11:32, 38.47s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [21:11<10:54, 38.49s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [21:49<10:16, 38.51s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [22:28<09:38, 38.54s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [23:07<08:59, 38.53s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [23:45<08:21, 38.55s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [24:24<07:42, 38.55s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [25:03<07:04, 38.63s/it]Evaluating commonsenseqa :  80%|████████████████████████      | 40/50 [25:41<06:26, 38.64s/it]Evaluating commonsenseqa :  82%|████████████████████████▌     | 41/50 [26:20<05:47, 38.61s/it]Evaluating commonsenseqa :  84%|█████████████████████████▏    | 42/50 [26:58<05:08, 38.56s/it]Evaluating commonsenseqa :  86%|█████████████████████████▊    | 43/50 [27:37<04:29, 38.57s/it]Evaluating commonsenseqa :  88%|██████████████████████████▍   | 44/50 [28:15<03:51, 38.59s/it]Evaluating commonsenseqa :  90%|███████████████████████████   | 45/50 [28:54<03:12, 38.55s/it]Evaluating commonsenseqa :  92%|███████████████████████████▌  | 46/50 [29:32<02:34, 38.57s/it]Evaluating commonsenseqa :  94%|████████████████████████████▏ | 47/50 [30:11<01:55, 38.56s/it]Evaluating commonsenseqa :  96%|████████████████████████████▊ | 48/50 [30:49<01:17, 38.53s/it]Evaluating commonsenseqa :  98%|█████████████████████████████▍| 49/50 [31:28<00:38, 38.54s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [32:06<00:00, 38.51s/it]Evaluating commonsenseqa : 100%|██████████████████████████████| 50/50 [32:06<00:00, 38.54s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 0.6952} | avg. gen lenth: 426.592
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-out-domain 0 --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/in-domain/i9-s20-rTrue --seed 20 --max-prompt-length 2048 --rationales --num-in-domain 9
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date![nltk_data]   Package punkt is already up-to-date!

[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-22 13:57:01,202] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/in-domain/i9-s20-rTrue
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 9
  num_out_domain ............... 0
  out_domain_data_name ......... None
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i9-s20-rTrue
  rationales ................... True
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 20
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                | 0/9732 [00:00<?, ?it/s]  0%|                                                       | 10/9732 [00:00<01:44, 93.47it/s]  0%|                                                       | 20/9732 [00:00<01:43, 93.89it/s]  0%|▏                                                      | 30/9732 [00:00<01:43, 93.78it/s]  0%|▏                                                      | 40/9732 [00:00<01:43, 93.94it/s]  1%|▎                                                      | 50/9732 [00:00<01:42, 94.08it/s]  1%|▎                                                      | 60/9732 [00:00<01:44, 92.89it/s]  1%|▍                                                      | 70/9732 [00:00<01:43, 93.06it/s]  1%|▍                                                     | 83/9732 [00:00<01:34, 102.40it/s]  1%|▌                                                     | 98/9732 [00:00<01:23, 115.26it/s]  1%|▌                                                    | 113/9732 [00:01<01:17, 123.94it/s]  1%|▋                                                    | 128/9732 [00:01<01:13, 129.97it/s]  1%|▊                                                    | 143/9732 [00:01<01:11, 134.12it/s]  2%|▊                                                    | 158/9732 [00:01<01:09, 136.84it/s]  2%|▉                                                    | 173/9732 [00:01<01:08, 138.72it/s]  2%|█                                                    | 187/9732 [00:01<01:08, 138.52it/s]  2%|█                                                    | 202/9732 [00:01<01:08, 139.96it/s]  2%|█▏                                                   | 217/9732 [00:01<01:08, 138.33it/s]  2%|█▎                                                   | 232/9732 [00:01<01:08, 139.65it/s]  3%|█▎                                                   | 247/9732 [00:02<01:07, 140.85it/s]  3%|█▍                                                   | 262/9732 [00:02<01:06, 141.67it/s]  3%|█▌                                                   | 277/9732 [00:02<01:06, 142.31it/s]  3%|█▌                                                   | 292/9732 [00:02<01:06, 142.58it/s]  3%|█▋                                                   | 307/9732 [00:02<01:06, 142.79it/s]  3%|█▊                                                   | 322/9732 [00:02<01:05, 143.03it/s]  3%|█▊                                                   | 337/9732 [00:02<01:06, 141.47it/s]  4%|█▉                                                   | 352/9732 [00:02<01:06, 141.72it/s]  4%|█▉                                                   | 367/9732 [00:02<01:05, 142.24it/s]  4%|██                                                   | 382/9732 [00:02<01:05, 142.74it/s]  4%|██▏                                                  | 397/9732 [00:03<01:05, 142.94it/s]  4%|██▏                                                  | 412/9732 [00:03<01:05, 143.14it/s]  4%|██▎                                                  | 427/9732 [00:03<01:04, 143.34it/s]  5%|██▍                                                  | 442/9732 [00:03<01:05, 141.85it/s]  5%|██▍                                                  | 457/9732 [00:03<01:05, 142.45it/s]  5%|██▌                                                  | 472/9732 [00:03<01:04, 142.80it/s]  5%|██▋                                                  | 487/9732 [00:03<01:04, 142.27it/s]  5%|██▋                                                  | 502/9732 [00:03<01:04, 142.74it/s]  5%|██▊                                                  | 517/9732 [00:03<01:04, 142.86it/s]  5%|██▉                                                  | 532/9732 [00:04<01:04, 142.55it/s]  6%|██▉                                                  | 547/9732 [00:04<01:04, 142.85it/s]  6%|███                                                  | 562/9732 [00:04<01:04, 142.90it/s]  6%|███▏                                                 | 577/9732 [00:04<01:04, 143.01it/s]  6%|███▏                                                 | 592/9732 [00:04<01:03, 142.84it/s]  6%|███▎                                                 | 607/9732 [00:04<01:03, 142.98it/s]  6%|███▍                                                 | 622/9732 [00:04<01:04, 141.35it/s]  7%|███▍                                                 | 637/9732 [00:04<01:04, 140.24it/s]  7%|███▌                                                 | 652/9732 [00:04<01:04, 141.01it/s]  7%|███▋                                                 | 667/9732 [00:04<01:05, 139.20it/s]  7%|███▋                                                 | 682/9732 [00:05<01:04, 139.98it/s]  7%|███▊                                                 | 697/9732 [00:05<01:04, 141.17it/s]  7%|███▉                                                 | 712/9732 [00:05<01:04, 140.38it/s]  7%|███▉                                                 | 727/9732 [00:05<01:03, 141.42it/s]  8%|████                                                 | 742/9732 [00:05<01:03, 142.05it/s]  8%|████                                                 | 757/9732 [00:05<01:02, 142.63it/s]  8%|████▏                                                | 772/9732 [00:05<01:02, 143.13it/s]  8%|████▎                                                | 787/9732 [00:05<01:02, 143.35it/s]  8%|████▎                                                | 802/9732 [00:05<01:02, 143.50it/s]  8%|████▍                                                | 817/9732 [00:06<01:02, 142.92it/s]  9%|████▌                                                | 832/9732 [00:06<01:02, 142.39it/s]  9%|████▌                                                | 847/9732 [00:06<01:02, 142.84it/s]  9%|████▋                                                | 862/9732 [00:06<01:01, 143.15it/s]  9%|████▊                                                | 877/9732 [00:06<01:01, 143.32it/s]  9%|████▊                                                | 892/9732 [00:06<01:02, 140.45it/s]  9%|████▉                                                | 907/9732 [00:06<01:02, 141.46it/s]  9%|█████                                                | 922/9732 [00:06<01:01, 142.12it/s] 10%|█████                                                | 937/9732 [00:06<01:01, 142.58it/s] 10%|█████▏                                               | 952/9732 [00:06<01:01, 142.99it/s] 10%|█████▎                                               | 967/9732 [00:07<01:01, 143.07it/s] 10%|█████▎                                               | 982/9732 [00:07<01:01, 143.05it/s] 10%|█████▍                                               | 997/9732 [00:07<01:01, 142.18it/s] 10%|█████▍                                              | 1012/9732 [00:07<01:01, 142.53it/s] 11%|█████▍                                              | 1027/9732 [00:07<01:00, 142.87it/s] 11%|█████▌                                              | 1042/9732 [00:07<01:00, 142.82it/s] 11%|█████▋                                              | 1057/9732 [00:07<01:00, 142.35it/s] 11%|█████▋                                              | 1072/9732 [00:07<01:00, 142.73it/s] 11%|█████▊                                              | 1087/9732 [00:07<01:00, 142.59it/s] 11%|█████▉                                              | 1102/9732 [00:08<01:00, 142.75it/s] 11%|█████▉                                              | 1117/9732 [00:08<01:00, 141.36it/s] 12%|██████                                              | 1132/9732 [00:08<01:01, 140.67it/s] 12%|██████▏                                             | 1147/9732 [00:08<01:01, 139.83it/s] 12%|██████▏                                             | 1162/9732 [00:08<01:01, 140.29it/s] 12%|██████▎                                             | 1177/9732 [00:08<01:00, 141.28it/s] 12%|██████▎                                             | 1192/9732 [00:08<01:00, 140.95it/s] 12%|██████▍                                             | 1207/9732 [00:08<01:00, 141.42it/s] 13%|██████▌                                             | 1222/9732 [00:08<01:00, 141.00it/s] 13%|██████▌                                             | 1237/9732 [00:08<01:00, 140.97it/s] 13%|██████▋                                             | 1252/9732 [00:09<00:59, 141.86it/s] 13%|██████▊                                             | 1267/9732 [00:09<00:59, 142.37it/s] 13%|██████▊                                             | 1282/9732 [00:09<00:59, 142.85it/s] 13%|██████▉                                             | 1297/9732 [00:09<00:58, 143.16it/s] 13%|███████                                             | 1312/9732 [00:09<00:58, 143.28it/s] 14%|███████                                             | 1327/9732 [00:09<00:58, 142.94it/s] 14%|███████▏                                            | 1342/9732 [00:09<00:59, 141.49it/s] 14%|███████▎                                            | 1357/9732 [00:09<00:58, 142.11it/s] 14%|███████▎                                            | 1372/9732 [00:09<00:58, 142.18it/s] 14%|███████▍                                            | 1387/9732 [00:10<00:58, 142.10it/s] 14%|███████▍                                            | 1402/9732 [00:10<00:58, 141.66it/s] 15%|███████▌                                            | 1417/9732 [00:10<00:58, 141.74it/s] 15%|███████▋                                            | 1432/9732 [00:10<00:58, 142.28it/s] 15%|███████▋                                            | 1447/9732 [00:10<00:58, 141.93it/s] 15%|███████▊                                            | 1462/9732 [00:10<00:58, 142.34it/s] 15%|███████▉                                            | 1477/9732 [00:10<00:57, 142.49it/s] 15%|███████▉                                            | 1492/9732 [00:10<00:57, 142.64it/s] 15%|████████                                            | 1507/9732 [00:10<00:57, 143.00it/s] 16%|████████▏                                           | 1522/9732 [00:10<00:57, 143.16it/s] 16%|████████▏                                           | 1537/9732 [00:11<00:57, 143.20it/s] 16%|████████▎                                           | 1552/9732 [00:11<00:57, 141.97it/s] 16%|████████▎                                           | 1567/9732 [00:11<00:58, 139.99it/s] 16%|████████▍                                           | 1582/9732 [00:11<00:58, 140.35it/s] 16%|████████▌                                           | 1597/9732 [00:11<00:57, 140.68it/s] 17%|████████▌                                           | 1612/9732 [00:11<00:57, 140.47it/s] 17%|████████▋                                           | 1627/9732 [00:11<00:57, 141.20it/s] 17%|████████▊                                           | 1642/9732 [00:11<00:57, 140.71it/s] 17%|████████▊                                           | 1657/9732 [00:11<00:57, 141.57it/s] 17%|████████▉                                           | 1672/9732 [00:12<00:56, 142.03it/s] 17%|█████████                                           | 1687/9732 [00:12<00:56, 142.52it/s] 17%|█████████                                           | 1702/9732 [00:12<00:56, 142.36it/s] 18%|█████████▏                                          | 1717/9732 [00:12<00:56, 142.67it/s] 18%|█████████▎                                          | 1732/9732 [00:12<00:56, 142.52it/s] 18%|█████████▎                                          | 1747/9732 [00:12<00:55, 142.73it/s] 18%|█████████▍                                          | 1762/9732 [00:12<00:55, 143.14it/s] 18%|█████████▍                                          | 1777/9732 [00:12<00:55, 143.30it/s] 18%|█████████▌                                          | 1792/9732 [00:12<01:03, 125.94it/s] 19%|█████████▋                                          | 1807/9732 [00:13<01:00, 130.83it/s] 19%|█████████▋                                          | 1822/9732 [00:13<00:58, 134.40it/s] 19%|█████████▊                                          | 1837/9732 [00:13<00:57, 137.03it/s] 19%|█████████▉                                          | 1852/9732 [00:13<00:56, 138.98it/s] 19%|█████████▉                                          | 1867/9732 [00:13<00:56, 140.24it/s] 19%|██████████                                          | 1882/9732 [00:13<00:55, 140.95it/s] 19%|██████████▏                                         | 1897/9732 [00:13<00:55, 141.38it/s] 20%|██████████▏                                         | 1912/9732 [00:13<00:55, 141.68it/s] 20%|██████████▎                                         | 1927/9732 [00:13<00:55, 141.80it/s] 20%|██████████▍                                         | 1942/9732 [00:13<00:55, 140.90it/s] 20%|██████████▍                                         | 1957/9732 [00:14<00:54, 141.67it/s] 20%|██████████▌                                         | 1972/9732 [00:14<00:54, 142.29it/s] 20%|██████████▌                                         | 1987/9732 [00:14<00:54, 142.72it/s] 21%|██████████▋                                         | 2002/9732 [00:14<00:54, 143.08it/s] 21%|██████████▊                                         | 2017/9732 [00:14<00:53, 142.88it/s] 21%|██████████▊                                         | 2032/9732 [00:14<00:54, 140.49it/s] 21%|██████████▉                                         | 2047/9732 [00:14<00:54, 141.32it/s] 21%|███████████                                         | 2062/9732 [00:14<00:54, 141.87it/s] 21%|███████████                                         | 2077/9732 [00:14<00:53, 142.18it/s] 21%|███████████▏                                        | 2092/9732 [00:15<00:53, 142.24it/s] 22%|███████████▎                                        | 2107/9732 [00:15<00:53, 142.49it/s] 22%|███████████▎                                        | 2122/9732 [00:15<00:53, 142.52it/s] 22%|███████████▍                                        | 2137/9732 [00:15<00:53, 142.65it/s] 22%|███████████▍                                        | 2152/9732 [00:15<00:53, 142.77it/s] 22%|███████████▌                                        | 2167/9732 [00:15<00:52, 142.81it/s] 22%|███████████▋                                        | 2182/9732 [00:15<00:52, 142.80it/s] 23%|███████████▋                                        | 2197/9732 [00:15<00:52, 142.75it/s] 23%|███████████▊                                        | 2212/9732 [00:15<00:52, 142.81it/s] 23%|███████████▉                                        | 2227/9732 [00:15<00:52, 143.21it/s] 23%|███████████▉                                        | 2242/9732 [00:16<00:52, 143.32it/s] 23%|████████████                                        | 2257/9732 [00:16<00:52, 141.81it/s] 23%|████████████▏                                       | 2272/9732 [00:16<00:52, 142.35it/s] 23%|████████████▏                                       | 2287/9732 [00:16<00:52, 141.60it/s] 24%|████████████▎                                       | 2302/9732 [00:16<00:52, 141.47it/s] 24%|████████████▍                                       | 2317/9732 [00:16<00:52, 142.01it/s] 24%|████████████▍                                       | 2332/9732 [00:16<00:51, 142.48it/s] 24%|████████████▌                                       | 2347/9732 [00:16<00:51, 142.99it/s] 24%|████████████▌                                       | 2362/9732 [00:16<00:51, 143.36it/s] 24%|████████████▋                                       | 2377/9732 [00:17<00:51, 143.60it/s] 25%|████████████▊                                       | 2392/9732 [00:17<00:51, 143.77it/s] 25%|████████████▊                                       | 2407/9732 [00:17<00:50, 143.96it/s] 25%|████████████▉                                       | 2422/9732 [00:17<00:50, 143.69it/s] 25%|█████████████                                       | 2437/9732 [00:17<00:50, 143.84it/s] 25%|█████████████                                       | 2452/9732 [00:17<00:50, 143.99it/s] 25%|█████████████▏                                      | 2467/9732 [00:17<00:50, 143.98it/s] 26%|█████████████▎                                      | 2482/9732 [00:17<00:50, 142.44it/s] 26%|█████████████▎                                      | 2497/9732 [00:17<00:50, 142.56it/s] 26%|█████████████▍                                      | 2512/9732 [00:17<00:51, 141.38it/s] 26%|█████████████▌                                      | 2527/9732 [00:18<00:51, 140.37it/s] 26%|█████████████▌                                      | 2542/9732 [00:18<00:50, 141.27it/s] 26%|█████████████▋                                      | 2557/9732 [00:18<00:50, 142.15it/s] 26%|█████████████▋                                      | 2572/9732 [00:18<00:50, 142.86it/s] 27%|█████████████▊                                      | 2587/9732 [00:18<00:49, 143.41it/s] 27%|█████████████▉                                      | 2602/9732 [00:18<00:49, 143.81it/s] 27%|█████████████▉                                      | 2617/9732 [00:18<00:49, 144.00it/s] 27%|██████████████                                      | 2632/9732 [00:18<00:49, 144.09it/s] 27%|██████████████▏                                     | 2647/9732 [00:18<00:49, 143.50it/s] 27%|██████████████▏                                     | 2662/9732 [00:19<00:49, 143.78it/s] 28%|██████████████▎                                     | 2677/9732 [00:19<00:49, 143.89it/s] 28%|██████████████▍                                     | 2692/9732 [00:19<00:48, 143.70it/s] 28%|██████████████▍                                     | 2707/9732 [00:19<00:49, 142.31it/s] 28%|██████████████▌                                     | 2722/9732 [00:19<00:49, 142.91it/s] 28%|██████████████▌                                     | 2737/9732 [00:19<00:48, 143.22it/s] 28%|██████████████▋                                     | 2752/9732 [00:19<00:48, 143.59it/s] 28%|██████████████▊                                     | 2767/9732 [00:19<00:48, 142.54it/s] 29%|██████████████▊                                     | 2782/9732 [00:19<00:48, 142.90it/s] 29%|██████████████▉                                     | 2797/9732 [00:19<00:48, 143.37it/s] 29%|███████████████                                     | 2812/9732 [00:20<00:48, 143.62it/s] 29%|███████████████                                     | 2827/9732 [00:20<00:47, 143.95it/s] 29%|███████████████▏                                    | 2842/9732 [00:20<00:47, 143.87it/s] 29%|███████████████▎                                    | 2857/9732 [00:20<00:48, 143.09it/s] 30%|███████████████▎                                    | 2872/9732 [00:20<00:47, 143.47it/s] 30%|███████████████▍                                    | 2887/9732 [00:20<00:47, 143.56it/s] 30%|███████████████▌                                    | 2902/9732 [00:20<00:47, 143.66it/s] 30%|███████████████▌                                    | 2917/9732 [00:20<00:47, 143.90it/s] 30%|███████████████▋                                    | 2932/9732 [00:20<00:47, 141.93it/s] 30%|███████████████▋                                    | 2947/9732 [00:21<00:47, 142.36it/s] 30%|███████████████▊                                    | 2962/9732 [00:21<00:47, 143.00it/s] 31%|███████████████▉                                    | 2977/9732 [00:21<00:47, 143.44it/s] 31%|███████████████▉                                    | 2992/9732 [00:21<00:46, 143.64it/s] 31%|████████████████                                    | 3007/9732 [00:21<00:47, 142.58it/s] 31%|████████████████▏                                   | 3022/9732 [00:21<00:46, 143.11it/s] 31%|████████████████▏                                   | 3037/9732 [00:21<00:46, 143.47it/s] 31%|████████████████▎                                   | 3052/9732 [00:21<00:46, 143.63it/s] 32%|████████████████▍                                   | 3067/9732 [00:21<00:46, 143.69it/s] 32%|████████████████▍                                   | 3082/9732 [00:21<00:46, 143.63it/s] 32%|████████████████▌                                   | 3097/9732 [00:22<00:46, 143.58it/s] 32%|████████████████▋                                   | 3112/9732 [00:22<00:46, 143.48it/s] 32%|████████████████▋                                   | 3127/9732 [00:22<00:46, 143.34it/s] 32%|████████████████▊                                   | 3142/9732 [00:22<00:45, 143.29it/s] 32%|████████████████▊                                   | 3157/9732 [00:22<00:46, 141.85it/s] 33%|████████████████▉                                   | 3172/9732 [00:22<00:46, 142.33it/s] 33%|█████████████████                                   | 3187/9732 [00:22<00:45, 142.38it/s] 33%|█████████████████                                   | 3202/9732 [00:22<00:45, 142.65it/s] 33%|█████████████████▏                                  | 3217/9732 [00:22<00:45, 142.95it/s] 33%|█████████████████▎                                  | 3232/9732 [00:22<00:45, 143.12it/s] 33%|█████████████████▎                                  | 3247/9732 [00:23<00:45, 143.22it/s] 34%|█████████████████▍                                  | 3262/9732 [00:23<00:45, 142.68it/s] 34%|█████████████████▌                                  | 3277/9732 [00:23<00:45, 142.91it/s] 34%|█████████████████▌                                  | 3292/9732 [00:23<00:44, 143.20it/s] 34%|█████████████████▋                                  | 3307/9732 [00:23<00:44, 143.37it/s] 34%|█████████████████▊                                  | 3322/9732 [00:23<00:44, 143.39it/s] 34%|█████████████████▊                                  | 3337/9732 [00:23<00:44, 143.55it/s] 34%|█████████████████▉                                  | 3352/9732 [00:23<00:44, 143.64it/s] 35%|█████████████████▉                                  | 3367/9732 [00:23<00:44, 143.30it/s] 35%|██████████████████                                  | 3382/9732 [00:24<00:44, 141.94it/s] 35%|██████████████████▏                                 | 3397/9732 [00:24<00:44, 142.39it/s] 35%|██████████████████▏                                 | 3412/9732 [00:24<00:44, 142.42it/s] 35%|██████████████████▎                                 | 3427/9732 [00:24<00:44, 142.79it/s] 35%|██████████████████▍                                 | 3442/9732 [00:24<00:43, 143.04it/s] 36%|██████████████████▍                                 | 3457/9732 [00:24<00:43, 143.23it/s] 36%|██████████████████▌                                 | 3472/9732 [00:24<00:43, 143.38it/s] 36%|██████████████████▋                                 | 3487/9732 [00:24<00:43, 143.36it/s] 36%|██████████████████▋                                 | 3502/9732 [00:24<00:43, 143.02it/s] 36%|██████████████████▊                                 | 3517/9732 [00:24<00:43, 142.90it/s] 36%|██████████████████▊                                 | 3532/9732 [00:25<00:43, 143.20it/s] 36%|██████████████████▉                                 | 3547/9732 [00:25<00:43, 143.20it/s] 37%|███████████████████                                 | 3562/9732 [00:25<00:43, 142.35it/s] 37%|███████████████████                                 | 3577/9732 [00:25<00:43, 142.61it/s] 37%|███████████████████▏                                | 3592/9732 [00:25<00:42, 142.98it/s] 37%|███████████████████▎                                | 3607/9732 [00:25<00:43, 141.79it/s] 37%|███████████████████▎                                | 3622/9732 [00:25<00:42, 142.26it/s] 37%|███████████████████▍                                | 3637/9732 [00:25<00:42, 142.09it/s] 38%|███████████████████▌                                | 3652/9732 [00:25<00:42, 141.71it/s] 38%|███████████████████▌                                | 3667/9732 [00:26<00:42, 142.09it/s] 38%|███████████████████▋                                | 3682/9732 [00:26<00:42, 142.58it/s] 38%|███████████████████▊                                | 3697/9732 [00:26<00:42, 142.98it/s] 38%|███████████████████▊                                | 3712/9732 [00:26<00:42, 143.18it/s] 38%|███████████████████▉                                | 3727/9732 [00:26<00:41, 143.36it/s] 38%|███████████████████▉                                | 3742/9732 [00:26<00:41, 143.39it/s] 39%|████████████████████                                | 3757/9732 [00:26<00:41, 143.39it/s] 39%|████████████████████▏                               | 3772/9732 [00:26<00:41, 143.43it/s] 39%|████████████████████▏                               | 3787/9732 [00:26<00:41, 143.40it/s] 39%|████████████████████▎                               | 3802/9732 [00:26<00:41, 143.28it/s] 39%|████████████████████▍                               | 3817/9732 [00:27<00:41, 143.25it/s] 39%|████████████████████▍                               | 3832/9732 [00:27<00:41, 143.42it/s] 40%|████████████████████▌                               | 3847/9732 [00:27<00:41, 142.03it/s] 40%|████████████████████▋                               | 3862/9732 [00:27<00:41, 142.39it/s] 40%|████████████████████▋                               | 3877/9732 [00:27<00:41, 142.50it/s] 40%|████████████████████▊                               | 3892/9732 [00:27<00:40, 142.53it/s] 40%|████████████████████▉                               | 3907/9732 [00:27<00:41, 141.55it/s] 40%|████████████████████▉                               | 3922/9732 [00:27<00:41, 140.97it/s] 40%|█████████████████████                               | 3937/9732 [00:27<00:41, 140.94it/s] 41%|█████████████████████                               | 3952/9732 [00:28<00:41, 140.50it/s] 41%|█████████████████████▏                              | 3967/9732 [00:28<00:40, 140.74it/s] 41%|█████████████████████▎                              | 3982/9732 [00:28<00:40, 141.06it/s] 41%|█████████████████████▎                              | 3997/9732 [00:28<00:40, 141.86it/s] 41%|█████████████████████▍                              | 4012/9732 [00:28<00:40, 142.46it/s] 41%|█████████████████████▌                              | 4027/9732 [00:28<00:39, 142.69it/s] 42%|█████████████████████▌                              | 4042/9732 [00:28<00:39, 143.10it/s] 42%|█████████████████████▋                              | 4057/9732 [00:28<00:39, 143.15it/s] 42%|█████████████████████▊                              | 4072/9732 [00:28<00:39, 141.63it/s] 42%|█████████████████████▊                              | 4087/9732 [00:28<00:39, 142.21it/s] 42%|█████████████████████▉                              | 4102/9732 [00:29<00:39, 142.33it/s] 42%|█████████████████████▉                              | 4117/9732 [00:29<00:39, 142.48it/s] 42%|██████████████████████                              | 4132/9732 [00:29<00:39, 142.85it/s] 43%|██████████████████████▏                             | 4147/9732 [00:29<00:39, 143.03it/s] 43%|██████████████████████▏                             | 4162/9732 [00:29<00:38, 142.86it/s] 43%|██████████████████████▎                             | 4177/9732 [00:29<00:38, 142.87it/s] 43%|██████████████████████▍                             | 4192/9732 [00:29<00:38, 143.02it/s] 43%|██████████████████████▍                             | 4207/9732 [00:29<00:38, 143.18it/s] 43%|██████████████████████▌                             | 4222/9732 [00:29<00:38, 143.00it/s] 44%|██████████████████████▋                             | 4237/9732 [00:30<00:38, 142.82it/s] 44%|██████████████████████▋                             | 4252/9732 [00:30<00:38, 142.96it/s] 44%|██████████████████████▊                             | 4267/9732 [00:30<00:38, 143.13it/s] 44%|██████████████████████▉                             | 4282/9732 [00:30<00:38, 143.39it/s] 44%|██████████████████████▉                             | 4297/9732 [00:30<00:38, 140.76it/s] 44%|███████████████████████                             | 4312/9732 [00:30<00:38, 140.46it/s] 44%|███████████████████████                             | 4327/9732 [00:30<00:38, 140.97it/s] 45%|███████████████████████▏                            | 4342/9732 [00:30<00:38, 141.04it/s] 45%|███████████████████████▎                            | 4357/9732 [00:30<00:37, 141.67it/s] 45%|███████████████████████▎                            | 4372/9732 [00:30<00:37, 142.30it/s] 45%|███████████████████████▍                            | 4387/9732 [00:31<00:37, 142.68it/s] 45%|███████████████████████▌                            | 4402/9732 [00:31<00:37, 142.80it/s] 45%|███████████████████████▌                            | 4417/9732 [00:31<00:37, 143.09it/s] 46%|███████████████████████▋                            | 4432/9732 [00:31<00:37, 143.17it/s] 46%|███████████████████████▊                            | 4447/9732 [00:31<00:36, 143.30it/s] 46%|███████████████████████▊                            | 4462/9732 [00:31<00:36, 143.17it/s] 46%|███████████████████████▉                            | 4477/9732 [00:31<00:36, 143.07it/s] 46%|████████████████████████                            | 4492/9732 [00:31<00:36, 143.03it/s] 46%|████████████████████████                            | 4507/9732 [00:31<00:36, 142.88it/s] 46%|████████████████████████▏                           | 4522/9732 [00:32<00:42, 122.44it/s] 47%|████████████████████████▏                           | 4537/9732 [00:32<00:40, 128.16it/s] 47%|████████████████████████▎                           | 4552/9732 [00:32<00:39, 131.97it/s] 47%|████████████████████████▍                           | 4567/9732 [00:32<00:38, 135.20it/s] 47%|████████████████████████▍                           | 4582/9732 [00:32<00:37, 137.64it/s] 47%|████████████████████████▌                           | 4597/9732 [00:32<00:36, 139.32it/s] 47%|████████████████████████▋                           | 4612/9732 [00:32<00:36, 140.60it/s] 48%|████████████████████████▋                           | 4627/9732 [00:32<00:36, 141.36it/s] 48%|████████████████████████▊                           | 4642/9732 [00:32<00:35, 141.94it/s] 48%|████████████████████████▉                           | 4657/9732 [00:33<00:35, 142.32it/s] 48%|████████████████████████▉                           | 4672/9732 [00:33<00:35, 142.46it/s] 48%|█████████████████████████                           | 4687/9732 [00:33<00:35, 142.80it/s] 48%|█████████████████████████                           | 4702/9732 [00:33<00:35, 142.98it/s] 48%|█████████████████████████▏                          | 4717/9732 [00:33<00:35, 143.23it/s] 49%|█████████████████████████▎                          | 4732/9732 [00:33<00:34, 143.37it/s] 49%|█████████████████████████▊                           | 4747/9732 [00:33<00:51, 97.22it/s] 49%|█████████████████████████▍                          | 4762/9732 [00:33<00:46, 107.51it/s] 49%|█████████████████████████▌                          | 4776/9732 [00:34<00:43, 115.03it/s] 49%|█████████████████████████▌                          | 4791/9732 [00:34<00:40, 121.96it/s] 49%|█████████████████████████▋                          | 4806/9732 [00:34<00:38, 127.68it/s] 50%|█████████████████████████▊                          | 4821/9732 [00:34<00:37, 131.84it/s] 50%|█████████████████████████▊                          | 4836/9732 [00:34<00:36, 134.90it/s] 50%|█████████████████████████▉                          | 4851/9732 [00:34<00:35, 137.02it/s] 50%|██████████████████████████                          | 4866/9732 [00:34<00:35, 137.90it/s] 50%|██████████████████████████                          | 4881/9732 [00:34<00:35, 138.41it/s] 50%|██████████████████████████▏                         | 4895/9732 [00:34<00:34, 138.58it/s] 50%|██████████████████████████▏                         | 4909/9732 [00:34<00:34, 138.42it/s] 51%|██████████████████████████▎                         | 4924/9732 [00:35<00:34, 139.16it/s] 51%|██████████████████████████▍                         | 4939/9732 [00:35<00:34, 140.14it/s] 51%|██████████████████████████▍                         | 4954/9732 [00:35<00:34, 139.55it/s] 51%|██████████████████████████▌                         | 4969/9732 [00:35<00:34, 140.05it/s] 51%|██████████████████████████▋                         | 4984/9732 [00:35<00:33, 140.74it/s] 51%|██████████████████████████▋                         | 4999/9732 [00:35<00:33, 140.80it/s] 52%|██████████████████████████▊                         | 5014/9732 [00:35<00:33, 140.62it/s] 52%|██████████████████████████▊                         | 5029/9732 [00:35<00:33, 140.76it/s] 52%|██████████████████████████▉                         | 5044/9732 [00:35<00:33, 140.56it/s] 52%|███████████████████████████                         | 5059/9732 [00:36<00:33, 141.28it/s] 52%|███████████████████████████                         | 5074/9732 [00:36<00:32, 141.84it/s] 52%|███████████████████████████▏                        | 5089/9732 [00:36<00:32, 142.14it/s] 52%|███████████████████████████▎                        | 5104/9732 [00:36<00:32, 142.38it/s] 53%|███████████████████████████▎                        | 5119/9732 [00:36<00:32, 142.67it/s] 53%|███████████████████████████▍                        | 5134/9732 [00:36<00:32, 142.77it/s] 53%|███████████████████████████▌                        | 5149/9732 [00:36<00:32, 142.91it/s] 53%|███████████████████████████▌                        | 5164/9732 [00:36<00:31, 142.90it/s] 53%|███████████████████████████▋                        | 5179/9732 [00:36<00:32, 141.50it/s] 53%|███████████████████████████▊                        | 5194/9732 [00:36<00:32, 141.34it/s] 54%|███████████████████████████▊                        | 5209/9732 [00:37<00:31, 141.78it/s] 54%|███████████████████████████▉                        | 5224/9732 [00:37<00:31, 142.25it/s] 54%|███████████████████████████▉                        | 5239/9732 [00:37<00:31, 142.52it/s] 54%|████████████████████████████                        | 5254/9732 [00:37<00:31, 142.52it/s] 54%|████████████████████████████▏                       | 5269/9732 [00:37<00:31, 142.33it/s] 54%|████████████████████████████▏                       | 5284/9732 [00:37<00:31, 142.60it/s] 54%|████████████████████████████▎                       | 5299/9732 [00:37<00:31, 142.90it/s] 55%|████████████████████████████▍                       | 5314/9732 [00:37<00:30, 143.05it/s] 55%|████████████████████████████▍                       | 5329/9732 [00:37<00:30, 143.15it/s] 55%|████████████████████████████▌                       | 5344/9732 [00:38<00:30, 143.16it/s] 55%|████████████████████████████▋                       | 5359/9732 [00:38<00:30, 142.80it/s] 55%|████████████████████████████▋                       | 5374/9732 [00:38<00:30, 143.01it/s] 55%|████████████████████████████▊                       | 5389/9732 [00:38<00:30, 142.99it/s] 56%|████████████████████████████▊                       | 5404/9732 [00:38<00:30, 141.63it/s] 56%|████████████████████████████▉                       | 5419/9732 [00:38<00:30, 140.95it/s] 56%|█████████████████████████████                       | 5434/9732 [00:38<00:30, 141.61it/s] 56%|█████████████████████████████                       | 5449/9732 [00:38<00:30, 141.27it/s] 56%|█████████████████████████████▏                      | 5464/9732 [00:38<00:30, 141.42it/s] 56%|█████████████████████████████▎                      | 5479/9732 [00:38<00:29, 142.50it/s] 56%|█████████████████████████████▎                      | 5494/9732 [00:39<00:29, 142.24it/s] 57%|█████████████████████████████▍                      | 5509/9732 [00:39<00:29, 141.88it/s] 57%|█████████████████████████████▌                      | 5524/9732 [00:39<00:29, 142.13it/s] 57%|█████████████████████████████▌                      | 5539/9732 [00:39<00:29, 142.39it/s] 57%|█████████████████████████████▋                      | 5554/9732 [00:39<00:29, 143.04it/s] 57%|█████████████████████████████▊                      | 5569/9732 [00:39<00:28, 144.01it/s] 57%|█████████████████████████████▊                      | 5584/9732 [00:39<00:28, 144.60it/s] 58%|█████████████████████████████▉                      | 5599/9732 [00:39<00:28, 145.11it/s] 58%|█████████████████████████████▉                      | 5614/9732 [00:39<00:28, 145.48it/s] 58%|██████████████████████████████                      | 5629/9732 [00:40<00:28, 143.45it/s] 58%|██████████████████████████████▏                     | 5644/9732 [00:40<00:28, 144.30it/s] 58%|██████████████████████████████▏                     | 5659/9732 [00:40<00:28, 144.62it/s] 58%|██████████████████████████████▎                     | 5674/9732 [00:40<00:27, 145.02it/s] 58%|██████████████████████████████▍                     | 5689/9732 [00:40<00:27, 145.59it/s] 59%|██████████████████████████████▍                     | 5704/9732 [00:40<00:27, 145.94it/s] 59%|██████████████████████████████▌                     | 5719/9732 [00:40<00:27, 146.26it/s] 59%|██████████████████████████████▋                     | 5734/9732 [00:40<00:27, 145.41it/s] 59%|██████████████████████████████▋                     | 5749/9732 [00:40<00:27, 145.56it/s] 59%|██████████████████████████████▊                     | 5764/9732 [00:40<00:27, 145.87it/s] 59%|██████████████████████████████▉                     | 5779/9732 [00:41<00:27, 146.07it/s] 60%|██████████████████████████████▉                     | 5794/9732 [00:41<00:26, 146.23it/s] 60%|███████████████████████████████                     | 5809/9732 [00:41<00:26, 146.30it/s] 60%|███████████████████████████████                     | 5824/9732 [00:41<00:26, 145.62it/s] 60%|███████████████████████████████▏                    | 5839/9732 [00:41<00:26, 145.75it/s] 60%|███████████████████████████████▎                    | 5854/9732 [00:41<00:26, 144.44it/s] 60%|███████████████████████████████▎                    | 5869/9732 [00:41<00:26, 145.06it/s] 60%|███████████████████████████████▍                    | 5884/9732 [00:41<00:26, 144.33it/s] 61%|███████████████████████████████▌                    | 5899/9732 [00:41<00:26, 143.95it/s] 61%|███████████████████████████████▌                    | 5914/9732 [00:42<00:26, 144.65it/s] 61%|███████████████████████████████▋                    | 5929/9732 [00:42<00:26, 145.18it/s] 61%|███████████████████████████████▊                    | 5944/9732 [00:42<00:25, 145.69it/s] 61%|███████████████████████████████▊                    | 5959/9732 [00:42<00:25, 146.03it/s] 61%|███████████████████████████████▉                    | 5974/9732 [00:42<00:25, 145.40it/s] 62%|████████████████████████████████                    | 5989/9732 [00:42<00:26, 143.73it/s] 62%|████████████████████████████████                    | 6004/9732 [00:42<00:26, 142.95it/s] 62%|████████████████████████████████▏                   | 6019/9732 [00:42<00:26, 142.43it/s] 62%|████████████████████████████████▏                   | 6034/9732 [00:42<00:25, 142.24it/s] 62%|████████████████████████████████▎                   | 6049/9732 [00:42<00:26, 141.28it/s] 62%|████████████████████████████████▍                   | 6064/9732 [00:43<00:25, 141.17it/s] 62%|████████████████████████████████▍                   | 6079/9732 [00:43<00:26, 139.80it/s] 63%|████████████████████████████████▌                   | 6094/9732 [00:43<00:25, 140.24it/s] 63%|████████████████████████████████▋                   | 6109/9732 [00:43<00:25, 140.58it/s] 63%|████████████████████████████████▋                   | 6124/9732 [00:43<00:25, 140.74it/s] 63%|████████████████████████████████▊                   | 6139/9732 [00:43<00:25, 140.91it/s] 63%|████████████████████████████████▉                   | 6154/9732 [00:43<00:25, 140.98it/s] 63%|████████████████████████████████▉                   | 6169/9732 [00:43<00:25, 140.73it/s] 64%|█████████████████████████████████                   | 6184/9732 [00:43<00:25, 140.89it/s] 64%|█████████████████████████████████                   | 6199/9732 [00:44<00:25, 141.00it/s] 64%|█████████████████████████████████▏                  | 6214/9732 [00:44<00:24, 141.03it/s] 64%|█████████████████████████████████▎                  | 6229/9732 [00:44<00:24, 141.00it/s] 64%|█████████████████████████████████▎                  | 6244/9732 [00:44<00:24, 141.09it/s] 64%|█████████████████████████████████▍                  | 6259/9732 [00:44<00:24, 141.15it/s] 64%|█████████████████████████████████▌                  | 6274/9732 [00:44<00:24, 141.25it/s] 65%|█████████████████████████████████▌                  | 6289/9732 [00:44<00:24, 141.34it/s] 65%|█████████████████████████████████▋                  | 6304/9732 [00:44<00:24, 141.30it/s] 65%|█████████████████████████████████▊                  | 6319/9732 [00:44<00:24, 139.46it/s] 65%|█████████████████████████████████▊                  | 6334/9732 [00:44<00:24, 139.97it/s] 65%|█████████████████████████████████▉                  | 6349/9732 [00:45<00:24, 139.98it/s] 65%|██████████████████████████████████                  | 6364/9732 [00:45<00:24, 139.19it/s] 66%|██████████████████████████████████                  | 6379/9732 [00:45<00:23, 139.90it/s] 66%|██████████████████████████████████▏                 | 6394/9732 [00:45<00:23, 140.19it/s] 66%|██████████████████████████████████▏                 | 6409/9732 [00:45<00:23, 140.52it/s] 66%|██████████████████████████████████▎                 | 6424/9732 [00:45<00:23, 140.68it/s] 66%|██████████████████████████████████▍                 | 6439/9732 [00:45<00:23, 140.69it/s] 66%|██████████████████████████████████▍                 | 6454/9732 [00:45<00:23, 140.32it/s] 66%|██████████████████████████████████▌                 | 6469/9732 [00:45<00:23, 140.32it/s] 67%|██████████████████████████████████▋                 | 6484/9732 [00:46<00:23, 140.45it/s] 67%|██████████████████████████████████▋                 | 6499/9732 [00:46<00:22, 140.59it/s] 67%|██████████████████████████████████▊                 | 6514/9732 [00:46<00:22, 140.61it/s] 67%|██████████████████████████████████▉                 | 6529/9732 [00:46<00:22, 140.86it/s] 67%|██████████████████████████████████▉                 | 6544/9732 [00:46<00:22, 139.22it/s] 67%|███████████████████████████████████                 | 6559/9732 [00:46<00:22, 139.75it/s] 68%|███████████████████████████████████▏                | 6574/9732 [00:46<00:22, 139.96it/s] 68%|███████████████████████████████████▏                | 6589/9732 [00:46<00:22, 140.20it/s] 68%|███████████████████████████████████▎                | 6604/9732 [00:46<00:22, 140.38it/s] 68%|███████████████████████████████████▎                | 6619/9732 [00:47<00:22, 140.51it/s] 68%|███████████████████████████████████▍                | 6634/9732 [00:47<00:22, 140.32it/s] 68%|███████████████████████████████████▌                | 6649/9732 [00:47<00:21, 140.41it/s] 68%|███████████████████████████████████▌                | 6664/9732 [00:47<00:21, 140.61it/s] 69%|███████████████████████████████████▋                | 6679/9732 [00:47<00:21, 139.44it/s] 69%|███████████████████████████████████▊                | 6694/9732 [00:47<00:21, 139.81it/s] 69%|███████████████████████████████████▊                | 6709/9732 [00:47<00:21, 140.00it/s] 69%|███████████████████████████████████▉                | 6724/9732 [00:47<00:21, 140.24it/s] 69%|████████████████████████████████████                | 6739/9732 [00:47<00:21, 140.53it/s] 69%|████████████████████████████████████                | 6754/9732 [00:47<00:21, 140.41it/s] 70%|████████████████████████████████████▏               | 6769/9732 [00:48<00:21, 138.29it/s] 70%|████████████████████████████████████▏               | 6783/9732 [00:48<00:21, 138.39it/s] 70%|████████████████████████████████████▎               | 6797/9732 [00:48<00:21, 138.30it/s] 70%|████████████████████████████████████▍               | 6811/9732 [00:48<00:21, 138.50it/s] 70%|████████████████████████████████████▍               | 6826/9732 [00:48<00:20, 139.13it/s] 70%|████████████████████████████████████▌               | 6841/9732 [00:48<00:20, 139.65it/s] 70%|████████████████████████████████████▋               | 6856/9732 [00:48<00:20, 139.95it/s] 71%|████████████████████████████████████▋               | 6871/9732 [00:48<00:20, 140.22it/s] 71%|████████████████████████████████████▊               | 6886/9732 [00:48<00:20, 140.44it/s] 71%|████████████████████████████████████▊               | 6901/9732 [00:49<00:20, 140.40it/s] 71%|████████████████████████████████████▉               | 6916/9732 [00:49<00:20, 140.74it/s] 71%|█████████████████████████████████████               | 6931/9732 [00:49<00:19, 140.37it/s] 71%|█████████████████████████████████████               | 6946/9732 [00:49<00:19, 140.40it/s] 72%|█████████████████████████████████████▏              | 6961/9732 [00:49<00:19, 140.47it/s] 72%|█████████████████████████████████████▎              | 6976/9732 [00:49<00:19, 139.75it/s] 72%|█████████████████████████████████████▎              | 6990/9732 [00:49<00:19, 138.62it/s] 72%|█████████████████████████████████████▍              | 7005/9732 [00:49<00:19, 139.17it/s] 72%|█████████████████████████████████████▌              | 7020/9732 [00:49<00:19, 139.74it/s] 72%|█████████████████████████████████████▌              | 7035/9732 [00:49<00:19, 140.04it/s] 72%|█████████████████████████████████████▋              | 7050/9732 [00:50<00:19, 140.33it/s] 73%|█████████████████████████████████████▋              | 7065/9732 [00:50<00:18, 140.45it/s] 73%|█████████████████████████████████████▊              | 7080/9732 [00:50<00:18, 140.50it/s] 73%|█████████████████████████████████████▉              | 7095/9732 [00:50<00:18, 140.36it/s] 73%|█████████████████████████████████████▉              | 7110/9732 [00:50<00:18, 138.89it/s] 73%|██████████████████████████████████████              | 7125/9732 [00:50<00:18, 139.39it/s] 73%|██████████████████████████████████████▏             | 7140/9732 [00:50<00:18, 139.70it/s] 74%|██████████████████████████████████████▏             | 7155/9732 [00:50<00:18, 140.09it/s] 74%|██████████████████████████████████████▎             | 7170/9732 [00:50<00:18, 140.28it/s] 74%|██████████████████████████████████████▍             | 7185/9732 [00:51<00:18, 140.58it/s] 74%|██████████████████████████████████████▍             | 7200/9732 [00:51<00:18, 140.66it/s] 74%|██████████████████████████████████████▌             | 7215/9732 [00:51<00:18, 139.16it/s] 74%|██████████████████████████████████████▋             | 7230/9732 [00:51<00:17, 139.57it/s] 74%|██████████████████████████████████████▋             | 7245/9732 [00:51<00:17, 139.86it/s] 75%|██████████████████████████████████████▊             | 7259/9732 [00:51<00:17, 139.66it/s] 75%|██████████████████████████████████████▊             | 7274/9732 [00:51<00:17, 140.07it/s] 75%|██████████████████████████████████████▉             | 7289/9732 [00:51<00:17, 139.27it/s] 75%|███████████████████████████████████████             | 7304/9732 [00:51<00:17, 139.73it/s] 75%|███████████████████████████████████████             | 7319/9732 [00:52<00:17, 140.11it/s] 75%|███████████████████████████████████████▏            | 7334/9732 [00:52<00:17, 140.34it/s] 76%|███████████████████████████████████████▎            | 7349/9732 [00:52<00:16, 140.46it/s] 76%|███████████████████████████████████████▎            | 7364/9732 [00:52<00:16, 140.30it/s] 76%|███████████████████████████████████████▍            | 7379/9732 [00:52<00:16, 140.47it/s] 76%|███████████████████████████████████████▌            | 7394/9732 [00:52<00:16, 140.20it/s] 76%|███████████████████████████████████████▌            | 7409/9732 [00:52<00:16, 140.21it/s] 76%|███████████████████████████████████████▋            | 7424/9732 [00:52<00:16, 140.43it/s] 76%|███████████████████████████████████████▋            | 7439/9732 [00:52<00:16, 140.50it/s] 77%|███████████████████████████████████████▊            | 7454/9732 [00:53<00:19, 117.02it/s] 77%|███████████████████████████████████████▉            | 7468/9732 [00:53<00:18, 122.64it/s] 77%|███████████████████████████████████████▉            | 7483/9732 [00:53<00:17, 127.71it/s] 77%|████████████████████████████████████████            | 7498/9732 [00:53<00:16, 131.42it/s] 77%|████████████████████████████████████████▏           | 7513/9732 [00:53<00:16, 134.27it/s] 77%|████████████████████████████████████████▏           | 7528/9732 [00:53<00:16, 136.22it/s] 78%|████████████████████████████████████████▎           | 7543/9732 [00:53<00:15, 137.71it/s] 78%|████████████████████████████████████████▍           | 7558/9732 [00:53<00:15, 138.55it/s] 78%|████████████████████████████████████████▍           | 7573/9732 [00:53<00:15, 139.19it/s] 78%|████████████████████████████████████████▌           | 7587/9732 [00:53<00:15, 138.82it/s] 78%|████████████████████████████████████████▌           | 7602/9732 [00:54<00:15, 139.38it/s] 78%|████████████████████████████████████████▋           | 7617/9732 [00:54<00:15, 139.83it/s] 78%|████████████████████████████████████████▊           | 7632/9732 [00:54<00:14, 140.12it/s] 79%|████████████████████████████████████████▊           | 7647/9732 [00:54<00:14, 140.31it/s] 79%|████████████████████████████████████████▉           | 7662/9732 [00:54<00:14, 140.50it/s] 79%|█████████████████████████████████████████           | 7677/9732 [00:54<00:14, 139.27it/s] 79%|█████████████████████████████████████████           | 7692/9732 [00:54<00:14, 139.78it/s] 79%|█████████████████████████████████████████▏          | 7706/9732 [00:54<00:14, 139.09it/s] 79%|█████████████████████████████████████████▏          | 7720/9732 [00:54<00:14, 139.26it/s] 79%|█████████████████████████████████████████▎          | 7735/9732 [00:55<00:14, 139.75it/s] 80%|█████████████████████████████████████████▍          | 7750/9732 [00:55<00:14, 140.13it/s] 80%|█████████████████████████████████████████▍          | 7765/9732 [00:55<00:14, 140.34it/s] 80%|█████████████████████████████████████████▌          | 7780/9732 [00:55<00:13, 140.61it/s] 80%|█████████████████████████████████████████▋          | 7795/9732 [00:55<00:13, 140.85it/s] 80%|█████████████████████████████████████████▋          | 7810/9732 [00:55<00:13, 140.68it/s] 80%|█████████████████████████████████████████▊          | 7825/9732 [00:55<00:13, 140.75it/s] 81%|█████████████████████████████████████████▉          | 7840/9732 [00:55<00:13, 140.82it/s] 81%|█████████████████████████████████████████▉          | 7855/9732 [00:55<00:13, 140.19it/s] 81%|██████████████████████████████████████████          | 7870/9732 [00:56<00:13, 140.35it/s] 81%|██████████████████████████████████████████▏         | 7885/9732 [00:56<00:13, 140.48it/s] 81%|██████████████████████████████████████████▏         | 7900/9732 [00:56<00:13, 139.26it/s] 81%|██████████████████████████████████████████▎         | 7915/9732 [00:56<00:12, 139.80it/s] 81%|██████████████████████████████████████████▎         | 7930/9732 [00:56<00:12, 140.16it/s] 82%|██████████████████████████████████████████▍         | 7945/9732 [00:56<00:12, 140.42it/s] 82%|██████████████████████████████████████████▌         | 7960/9732 [00:56<00:12, 140.70it/s] 82%|██████████████████████████████████████████▌         | 7975/9732 [00:56<00:12, 140.79it/s] 82%|██████████████████████████████████████████▋         | 7990/9732 [00:56<00:12, 140.13it/s] 82%|██████████████████████████████████████████▊         | 8005/9732 [00:56<00:12, 138.95it/s] 82%|██████████████████████████████████████████▊         | 8019/9732 [00:57<00:12, 139.00it/s] 83%|██████████████████████████████████████████▉         | 8034/9732 [00:57<00:12, 139.61it/s] 83%|███████████████████████████████████████████         | 8049/9732 [00:57<00:12, 139.99it/s] 83%|███████████████████████████████████████████         | 8064/9732 [00:57<00:11, 140.31it/s] 83%|███████████████████████████████████████████▏        | 8079/9732 [00:57<00:11, 140.44it/s] 83%|███████████████████████████████████████████▏        | 8094/9732 [00:57<00:11, 140.70it/s] 83%|███████████████████████████████████████████▎        | 8109/9732 [00:57<00:11, 140.81it/s] 83%|███████████████████████████████████████████▍        | 8124/9732 [00:57<00:11, 139.51it/s] 84%|███████████████████████████████████████████▍        | 8139/9732 [00:57<00:11, 139.82it/s] 84%|███████████████████████████████████████████▌        | 8153/9732 [00:58<00:11, 139.63it/s] 84%|███████████████████████████████████████████▋        | 8167/9732 [00:58<00:11, 139.73it/s] 84%|███████████████████████████████████████████▋        | 8182/9732 [00:58<00:11, 139.98it/s] 84%|███████████████████████████████████████████▊        | 8197/9732 [00:58<00:10, 140.22it/s] 84%|███████████████████████████████████████████▉        | 8212/9732 [00:58<00:10, 140.46it/s] 85%|███████████████████████████████████████████▉        | 8227/9732 [00:58<00:10, 140.64it/s] 85%|████████████████████████████████████████████        | 8242/9732 [00:58<00:10, 140.80it/s] 85%|████████████████████████████████████████████        | 8257/9732 [00:58<00:10, 140.79it/s] 85%|████████████████████████████████████████████▏       | 8272/9732 [00:58<00:10, 140.76it/s] 85%|████████████████████████████████████████████▎       | 8287/9732 [00:58<00:10, 140.65it/s] 85%|████████████████████████████████████████████▎       | 8302/9732 [00:59<00:10, 140.35it/s] 85%|████████████████████████████████████████████▍       | 8317/9732 [00:59<00:10, 138.58it/s] 86%|████████████████████████████████████████████▌       | 8332/9732 [00:59<00:10, 139.19it/s] 86%|████████████████████████████████████████████▌       | 8347/9732 [00:59<00:09, 139.66it/s] 86%|████████████████████████████████████████████▋       | 8361/9732 [00:59<00:09, 138.66it/s] 86%|████████████████████████████████████████████▊       | 8376/9732 [00:59<00:09, 139.35it/s] 86%|████████████████████████████████████████████▊       | 8390/9732 [00:59<00:09, 139.49it/s] 86%|████████████████████████████████████████████▉       | 8405/9732 [00:59<00:09, 139.83it/s] 87%|████████████████████████████████████████████▉       | 8420/9732 [00:59<00:09, 140.16it/s] 87%|█████████████████████████████████████████████       | 8435/9732 [01:00<00:09, 140.46it/s] 87%|█████████████████████████████████████████████▏      | 8450/9732 [01:00<00:09, 140.43it/s] 87%|█████████████████████████████████████████████▏      | 8465/9732 [01:00<00:09, 139.24it/s] 87%|█████████████████████████████████████████████▎      | 8479/9732 [01:00<00:08, 139.23it/s] 87%|█████████████████████████████████████████████▍      | 8494/9732 [01:00<00:08, 139.86it/s] 87%|█████████████████████████████████████████████▍      | 8509/9732 [01:00<00:08, 140.25it/s] 88%|█████████████████████████████████████████████▌      | 8524/9732 [01:00<00:08, 140.31it/s] 88%|█████████████████████████████████████████████▋      | 8539/9732 [01:00<00:08, 140.41it/s] 88%|█████████████████████████████████████████████▋      | 8554/9732 [01:00<00:08, 140.44it/s] 88%|█████████████████████████████████████████████▊      | 8569/9732 [01:01<00:08, 139.89it/s] 88%|█████████████████████████████████████████████▊      | 8583/9732 [01:01<00:08, 138.76it/s] 88%|█████████████████████████████████████████████▉      | 8598/9732 [01:01<00:08, 139.28it/s] 88%|██████████████████████████████████████████████      | 8612/9732 [01:01<00:08, 138.14it/s] 89%|██████████████████████████████████████████████      | 8626/9732 [01:01<00:07, 138.28it/s] 89%|██████████████████████████████████████████████▏     | 8641/9732 [01:01<00:07, 139.00it/s] 89%|██████████████████████████████████████████████▎     | 8656/9732 [01:01<00:07, 139.53it/s] 89%|██████████████████████████████████████████████▎     | 8671/9732 [01:01<00:07, 139.86it/s] 89%|██████████████████████████████████████████████▍     | 8686/9732 [01:01<00:07, 140.16it/s] 89%|██████████████████████████████████████████████▍     | 8701/9732 [01:01<00:07, 140.39it/s] 90%|██████████████████████████████████████████████▌     | 8716/9732 [01:02<00:07, 140.50it/s] 90%|██████████████████████████████████████████████▋     | 8731/9732 [01:02<00:07, 140.67it/s] 90%|██████████████████████████████████████████████▋     | 8746/9732 [01:02<00:07, 140.76it/s] 90%|██████████████████████████████████████████████▊     | 8761/9732 [01:02<00:06, 139.85it/s] 90%|██████████████████████████████████████████████▉     | 8775/9732 [01:02<00:06, 139.55it/s] 90%|██████████████████████████████████████████████▉     | 8789/9732 [01:02<00:06, 138.11it/s] 90%|███████████████████████████████████████████████     | 8803/9732 [01:02<00:06, 136.72it/s] 91%|███████████████████████████████████████████████     | 8818/9732 [01:02<00:06, 137.92it/s] 91%|███████████████████████████████████████████████▏    | 8833/9732 [01:02<00:06, 138.75it/s] 91%|███████████████████████████████████████████████▎    | 8848/9732 [01:03<00:06, 139.39it/s] 91%|███████████████████████████████████████████████▎    | 8863/9732 [01:03<00:06, 139.94it/s] 91%|███████████████████████████████████████████████▍    | 8878/9732 [01:03<00:06, 140.20it/s] 91%|███████████████████████████████████████████████▌    | 8893/9732 [01:03<00:05, 140.50it/s] 92%|███████████████████████████████████████████████▌    | 8908/9732 [01:03<00:05, 140.71it/s] 92%|███████████████████████████████████████████████▋    | 8923/9732 [01:03<00:05, 140.78it/s] 92%|███████████████████████████████████████████████▊    | 8938/9732 [01:03<00:05, 139.96it/s] 92%|███████████████████████████████████████████████▊    | 8952/9732 [01:03<00:05, 139.56it/s] 92%|███████████████████████████████████████████████▉    | 8967/9732 [01:03<00:05, 139.75it/s] 92%|███████████████████████████████████████████████▉    | 8982/9732 [01:03<00:05, 140.00it/s] 92%|████████████████████████████████████████████████    | 8997/9732 [01:04<00:05, 140.09it/s] 93%|████████████████████████████████████████████████▏   | 9012/9732 [01:04<00:05, 140.26it/s] 93%|████████████████████████████████████████████████▏   | 9027/9732 [01:04<00:05, 140.37it/s] 93%|████████████████████████████████████████████████▎   | 9042/9732 [01:04<00:05, 124.96it/s] 93%|█████████████████████████████████████████████████▎   | 9055/9732 [01:04<00:06, 99.33it/s] 93%|█████████████████████████████████████████████████▎   | 9066/9732 [01:04<00:07, 86.63it/s] 93%|█████████████████████████████████████████████████▍   | 9076/9732 [01:04<00:07, 89.33it/s] 93%|████████████████████████████████████████████████▌   | 9091/9732 [01:05<00:06, 102.11it/s] 94%|████████████████████████████████████████████████▋   | 9106/9732 [01:05<00:05, 112.23it/s] 94%|████████████████████████████████████████████████▋   | 9121/9732 [01:05<00:05, 119.92it/s] 94%|████████████████████████████████████████████████▊   | 9136/9732 [01:05<00:04, 125.69it/s] 94%|████████████████████████████████████████████████▉   | 9150/9732 [01:05<00:04, 129.56it/s] 94%|████████████████████████████████████████████████▉   | 9165/9732 [01:05<00:04, 132.75it/s] 94%|█████████████████████████████████████████████████   | 9180/9732 [01:05<00:04, 135.07it/s] 94%|█████████████████████████████████████████████████▏  | 9195/9732 [01:05<00:03, 136.67it/s] 95%|█████████████████████████████████████████████████▏  | 9210/9732 [01:05<00:03, 137.72it/s] 95%|█████████████████████████████████████████████████▎  | 9225/9732 [01:05<00:03, 138.48it/s] 95%|█████████████████████████████████████████████████▎  | 9240/9732 [01:06<00:03, 139.18it/s] 95%|█████████████████████████████████████████████████▍  | 9255/9732 [01:06<00:03, 139.56it/s] 95%|█████████████████████████████████████████████████▌  | 9269/9732 [01:06<00:03, 138.42it/s] 95%|█████████████████████████████████████████████████▌  | 9284/9732 [01:06<00:03, 139.12it/s] 96%|█████████████████████████████████████████████████▋  | 9299/9732 [01:06<00:03, 139.54it/s] 96%|█████████████████████████████████████████████████▊  | 9314/9732 [01:06<00:02, 139.90it/s] 96%|█████████████████████████████████████████████████▊  | 9329/9732 [01:06<00:02, 140.21it/s] 96%|█████████████████████████████████████████████████▉  | 9344/9732 [01:06<00:02, 140.24it/s] 96%|██████████████████████████████████████████████████  | 9359/9732 [01:06<00:02, 140.10it/s] 96%|██████████████████████████████████████████████████  | 9374/9732 [01:07<00:02, 140.28it/s] 96%|██████████████████████████████████████████████████▏ | 9389/9732 [01:07<00:02, 140.42it/s] 97%|██████████████████████████████████████████████████▏ | 9404/9732 [01:07<00:02, 140.38it/s] 97%|██████████████████████████████████████████████████▎ | 9419/9732 [01:07<00:02, 140.34it/s] 97%|██████████████████████████████████████████████████▍ | 9434/9732 [01:07<00:02, 140.45it/s] 97%|██████████████████████████████████████████████████▍ | 9449/9732 [01:07<00:02, 140.56it/s] 97%|██████████████████████████████████████████████████▌ | 9464/9732 [01:07<00:01, 140.32it/s] 97%|██████████████████████████████████████████████████▋ | 9479/9732 [01:07<00:01, 140.19it/s] 98%|██████████████████████████████████████████████████▋ | 9494/9732 [01:07<00:01, 138.81it/s] 98%|██████████████████████████████████████████████████▊ | 9508/9732 [01:07<00:01, 138.10it/s] 98%|██████████████████████████████████████████████████▉ | 9522/9732 [01:08<00:01, 138.62it/s] 98%|██████████████████████████████████████████████████▉ | 9537/9732 [01:08<00:01, 139.27it/s] 98%|███████████████████████████████████████████████████ | 9552/9732 [01:08<00:01, 139.54it/s] 98%|███████████████████████████████████████████████████ | 9567/9732 [01:08<00:01, 140.04it/s] 98%|███████████████████████████████████████████████████▏| 9582/9732 [01:08<00:01, 140.17it/s] 99%|███████████████████████████████████████████████████▎| 9597/9732 [01:08<00:00, 140.43it/s] 99%|███████████████████████████████████████████████████▎| 9612/9732 [01:08<00:00, 140.46it/s] 99%|███████████████████████████████████████████████████▍| 9627/9732 [01:08<00:00, 140.23it/s] 99%|███████████████████████████████████████████████████▌| 9642/9732 [01:08<00:00, 140.26it/s] 99%|███████████████████████████████████████████████████▌| 9657/9732 [01:09<00:00, 140.11it/s] 99%|███████████████████████████████████████████████████▋| 9672/9732 [01:09<00:00, 139.75it/s]100%|███████████████████████████████████████████████████▊| 9687/9732 [01:09<00:00, 139.89it/s]100%|███████████████████████████████████████████████████▊| 9702/9732 [01:09<00:00, 140.10it/s]100%|███████████████████████████████████████████████████▉| 9717/9732 [01:09<00:00, 138.67it/s]100%|████████████████████████████████████████████████████| 9732/9732 [01:09<00:00, 139.11it/s]100%|████████████████████████████████████████████████████| 9732/9732 [01:09<00:00, 139.83it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.07s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.14s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:05<00:10,  5.06s/it]Loading checkpoint shards:  33%|██████████▋                     | 1/3 [00:04<00:09,  4.98s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.13s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.13s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.09s/it]Loading checkpoint shards:  67%|█████████████████████▎          | 2/3 [00:10<00:05,  5.04s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.56s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.71s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.60s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.74s/it]
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.42s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:13<00:00,  4.58s/it]
[2023-08-22 13:59:02,480] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.57s/it]Loading checkpoint shards: 100%|████████████████████████████████| 3/3 [00:14<00:00,  4.71s/it]
[2023-08-22 13:59:09,902] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-22 13:59:09,903] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-22 13:59:09,903] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-22 13:59:09,903] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-22 13:59:09,903] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-22 13:59:09,903] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-22 13:59:09,903] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-22 13:59:09,903] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-22 13:59:09,903] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-22 13:59:09,903] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-22 13:59:09,903] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-22 13:59:09,903] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fbf43a1bdc0>
[2023-08-22 13:59:09,903] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-22 13:59:09,903] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-22 13:59:09,903] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-22 13:59:09,903] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-22 13:59:09,903] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-22 13:59:09,903] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-22 13:59:09,903] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-22 13:59:09,903] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-22 13:59:09,903] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7fbf5d862280>
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-22 13:59:09,904] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-22 13:59:09,904] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.5987744331359863 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                       | 0/50 [00:00<?, ?it/s]############### Example ###############
### Instruction:Answer the following multiple choice question.

Input: The machine was very intricate, it was quite an what? Choices:  A: box B: apparatus C: appliance D: wash dishes E: implement
Output: 1. The problem here is to identify the most suitable word that fits the context of the sentence. 
2. From the given choices, we need to select a word that describes something that can be referred to as "very intricate".
3. An intricate thing is usually complex in design or system. 
4. 'Box' is a simple object to hold things, it doesn't necessarily have a complex arrangement, so it doesn't fit here.
5. 'Wash dishes' is not an object or thing, it is an action, and can't be referred to as something intricate, so we rule this out.
6. 'Implement' is a tool or a piece of equipment, which may or may not be complex, so it doesn't quite fit.
7. 'Appliance' can also represent a complex item, but appliances are usually referred to devices that perform specific tasks around the household, like a fridge, a microwave, or a dishwasher. 
8. 'Apparatus' is a more generic term used for a complex set of equipment or machine that performs a specific task. This fits the context well because it can be intricate, complex in its design or mechanism.
9. Therefore, by analyzing and eliminating the wrong answer choices, the correct answer is B: apparatus.
So the final answer is B: apparatus

Input: Where do you get petrol? Choices:  A: burn hot B: fuel tank C: burn hot D: car E: gas station
Output: 1. The question is asking us to identify where we usually acquire petrol.
2. We begin by evaluating each of the given choices in relation to the question.
3. Choice A suggests that petrol is obtained from burning something hot, which is incorrect because petrol is a type of fuel, not a byproduct of heat.
4. Choice B suggests that petrol is obtained from a fuel tank, which isn't the case, because a fuel tank is where petrol is stored, not where it is sourced.
5. Choice C is the same as Choice A, suggesting that petrol is obtained from burning something hot, which is also incorrect.
6. Choice D suggests that petrol is obtained from a car. While cars use petrol to operate, they aren't where petrol is sourced.
7. Choice E suggests that petrol is obtained from a gas station, which is correct. Petrol is typically purchased from gas stations.
8. Therefore, the answer is E: gas station.
So the final answer is E: gas station

Input: Where might a television used at night be? Choices:  A: cabinet B: house C: apartment D: bedroom E: woods
Output: 1. First, think about where a television is typically used.
2. Televisions are typically used in indoor surroundings, rather than outdoor locations, because of the need for electricity and a stable set up, thereby excluding option E: woods.
3. We narrow down the choices to A: cabinet, B: house, C: apartment, and D: bedroom.
4. The term "cabinet" usually refers to a piece of furniture for storage. While televisions could be stored in a TV cabinet, we generally use the term 'cabinet' to denote a place of storage and not active use, so we can exclude option A: cabinet.
5. This leaves options B: house, C: apartment, and D: bedroom.
6. Both a house and an apartment are environments where a TV is likely to be found. 
7. However, the question specifies that the television is used at night. 
8. Considering human behaviour and activities typically done at night, people usually retreat to their bedrooms after their day's work for relaxation and rest.
9. Ingenerally, bedrooms are the most likely places for people to be watching television at night.
10. Therefore, option D: bedroom is the most suitable answer.
So the final answer is D: bedroom

Input: The knowledge was expensive to get, where was it being gained? Choices:  A: university B: book C: field D: meeting E: class
Output: 1. The question is asking where knowledge is being gained that is considered "expensive" to get.
2. We can assume that the term "expensive" here implies a significant amount of money is spent to gain this knowledge.
3. Now look at given options and try to associate them with the possible places where people usually spend money to gain knowledge.
4. Option A: University - This is a very plausible answer as people often pay high fees for gaining knowledge in a university.
5. Option B: Book - While books can sometimes be pricey, they are not typically considered an expensive source of knowledge.
6. Option C: Field - This seems to refer to gaining knowledge through experience or on job training. Although it could be expensive in terms of time, it's not typically associated with a significant monetary cost.
7. Option D: Meeting - This option would not typically be associated with a high cost to gain knowledge.
8. Option E: Class - While taking classes can be expensive but it usually refers to smaller teaching sessions and not necessarily implying significant expenditure like a university degree does.
9. So, it can be reasonably deduced that the university is the most strongly associated with spending a significant amount of money to gain knowledge.
10. Therefore, the answer is A: university.
So the final answer is A: university

Input: Where are small grapes likely to be found? Choices:  A: lunch box B: food store C: wine country D: kitchen E: raisins
Output: 1. The question asks about where small grapes are most likely to be found.
2. We need to consider the best place where small grapes would typically be situated.
3. Option A (lunch box) could contain small grapes, but they are not naturally found there.
4. Option B (food store) may have small grapes but they are also not naturally found here, they are sold here which is dependent on if and when they are delivered to the store.
5. Option C is wine country, where small grapes would naturally grow, as wine is produced from grapes, often smaller ones.
6. Option D (kitchen) might have small grapes but they don't naturally appear there.
7. Option E (raisins) is not a location.
8. Based on the options, Wine Country (Option C) is the most logical choice. This is the place where small grapes are naturally grown and specifically used for wine production.
So the final answer is C: wine country

Input: The painter explained how he never achieved a flawless portrait, he said this was because all people are what? Choices:  A: imperfect B: disfigured C: damaged D: flawed E: defective
Output: 1. The question presents a statement from a painter about how he never achieved a flawless portrait.
2. The reasoning he gives for this is that all people are a certain way. 
3. The answer choices provided all represent different types of imperfections or deficiencies. 
4. However, some words such as "disfigured," "damaged," and "defective" imply physical harm or abnormal structure, which might not be the reason behind the lack of perfection in the painter's portraits. 
5. The options "flawed" and "imperfect" are more generic descriptions, applying to failures or inaccuracies in a broad sense. 
6. In this case, "imperfect" would be a more suitable answer as it can include a wider array of imperfections, both physical and non-physical.
7. Thus, the answer is A: imperfect.
So the final answer is A: imperfect

Input: If you're betting with a shark, where are you likely playing? Choices:  A: aquarium B: mediterranean sea C: south pacific D: pool hall E: pacific ocean
Output: 1. The term "betting with a shark" actually contains the clue. In this case, it is not a marine creature but an indirect reference to a cunning person with great skills in whatever game is being played.
2. The clue is that it is more about a place where games requiring skills and often involving wagers are played. 
3. The aquarium, the Mediterranean sea, the South Pacific, and the Pacific Ocean are associated with actual marine sharks, but they are not places typically associated with gambling or betting games.
4. Thus, we can rule out options A, B, C, and E, leading us to the conclusion that the phrase "betting with a shark" is referring to playing games in a 'pool hall' (option
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/in-domain/i9-s20-rTrue
Loading extension module utils...
Time to load utils op: 0.5051310062408447 seconds
Loading extension module utils...
Time to load utils op: 0.5050070285797119 seconds
Loading extension module utils...
Time to load utils op: 0.5049867630004883 seconds
Evaluating commonsenseqa :   2%|▌                              | 1/50 [00:39<32:10, 39.40s/it]Evaluating commonsenseqa :   4%|█▏                             | 2/50 [01:18<31:23, 39.25s/it]Evaluating commonsenseqa :   6%|█▊                             | 3/50 [01:57<30:34, 39.03s/it]Evaluating commonsenseqa :   8%|██▍                            | 4/50 [02:36<29:53, 38.99s/it]Evaluating commonsenseqa :  10%|███                            | 5/50 [03:15<29:18, 39.08s/it]Evaluating commonsenseqa :  12%|███▋                           | 6/50 [03:54<28:40, 39.11s/it]Evaluating commonsenseqa :  14%|████▎                          | 7/50 [04:33<27:58, 39.04s/it]Evaluating commonsenseqa :  16%|████▉                          | 8/50 [05:12<27:15, 38.95s/it]Evaluating commonsenseqa :  18%|█████▌                         | 9/50 [05:51<26:37, 38.96s/it]Evaluating commonsenseqa :  20%|██████                        | 10/50 [06:30<25:56, 38.91s/it]Evaluating commonsenseqa :  22%|██████▌                       | 11/50 [07:08<25:17, 38.90s/it]Evaluating commonsenseqa :  24%|███████▏                      | 12/50 [07:47<24:38, 38.90s/it]Evaluating commonsenseqa :  26%|███████▊                      | 13/50 [08:26<24:01, 38.96s/it]Evaluating commonsenseqa :  28%|████████▍                     | 14/50 [09:05<23:21, 38.93s/it]Evaluating commonsenseqa :  30%|█████████                     | 15/50 [09:44<22:41, 38.91s/it]Evaluating commonsenseqa :  32%|█████████▌                    | 16/50 [10:23<22:02, 38.89s/it]Evaluating commonsenseqa :  34%|██████████▏                   | 17/50 [11:02<21:23, 38.88s/it]Evaluating commonsenseqa :  36%|██████████▊                   | 18/50 [11:41<20:43, 38.86s/it]Evaluating commonsenseqa :  38%|███████████▍                  | 19/50 [12:20<20:04, 38.85s/it]Evaluating commonsenseqa :  40%|████████████                  | 20/50 [12:58<19:25, 38.84s/it]Evaluating commonsenseqa :  42%|████████████▌                 | 21/50 [13:37<18:46, 38.83s/it]Evaluating commonsenseqa :  44%|█████████████▏                | 22/50 [14:16<18:08, 38.89s/it]Evaluating commonsenseqa :  46%|█████████████▊                | 23/50 [14:55<17:30, 38.90s/it]Evaluating commonsenseqa :  48%|██████████████▍               | 24/50 [15:34<16:51, 38.90s/it]Evaluating commonsenseqa :  50%|███████████████               | 25/50 [16:13<16:14, 38.96s/it]Evaluating commonsenseqa :  52%|███████████████▌              | 26/50 [16:52<15:35, 38.99s/it]Evaluating commonsenseqa :  54%|████████████████▏             | 27/50 [17:31<14:56, 38.96s/it]Evaluating commonsenseqa :  56%|████████████████▊             | 28/50 [18:10<14:17, 38.98s/it]Evaluating commonsenseqa :  58%|█████████████████▍            | 29/50 [18:49<13:39, 39.00s/it]Evaluating commonsenseqa :  60%|██████████████████            | 30/50 [19:28<12:59, 38.98s/it]Evaluating commonsenseqa :  62%|██████████████████▌           | 31/50 [20:07<12:20, 38.96s/it]Evaluating commonsenseqa :  64%|███████████████████▏          | 32/50 [20:46<11:41, 38.96s/it]Evaluating commonsenseqa :  66%|███████████████████▊          | 33/50 [21:25<11:02, 38.98s/it]Evaluating commonsenseqa :  68%|████████████████████▍         | 34/50 [22:04<10:23, 38.95s/it]Evaluating commonsenseqa :  70%|█████████████████████         | 35/50 [22:43<09:45, 39.03s/it]Evaluating commonsenseqa :  72%|█████████████████████▌        | 36/50 [23:22<09:06, 39.01s/it]Evaluating commonsenseqa :  74%|██████████████████████▏       | 37/50 [24:01<08:26, 38.98s/it]Evaluating commonsenseqa :  76%|██████████████████████▊       | 38/50 [24:40<07:47, 38.98s/it]Evaluating commonsenseqa :  78%|███████████████████████▍      | 39/50 [25:19<07:09, 39.03s/it]