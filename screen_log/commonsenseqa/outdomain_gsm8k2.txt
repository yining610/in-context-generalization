PYTHONPATH=/home/ylu130/workspace/in-context-generalization
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name gsm8k --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/out-domain/o10-tgsm8k-s1-rFalse --seed 1 --num-out-domain 10
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-14 01:27:26,282] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/out-domain/o10-tgsm8k-s1-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 10
  out_domain_data_name ......... gsm8k
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o10-tgsm8k-s1-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                             | 0/9741 [00:00<?, ?it/s]  0%|▏                                  | 47/9741 [00:00<00:20, 461.79it/s]  1%|▎                                  | 94/9741 [00:00<00:20, 463.32it/s]  1%|▍                                 | 141/9741 [00:00<00:20, 464.37it/s]  2%|▋                                 | 188/9741 [00:00<00:20, 464.52it/s]  2%|▊                                 | 235/9741 [00:00<00:20, 462.66it/s]  3%|▉                                 | 282/9741 [00:00<00:20, 463.53it/s]  3%|█▏                                | 329/9741 [00:00<00:20, 458.39it/s]  4%|█▎                                | 375/9741 [00:00<00:20, 458.80it/s]  4%|█▍                                | 422/9741 [00:00<00:20, 460.20it/s]  5%|█▋                                | 469/9741 [00:01<00:20, 458.52it/s]  5%|█▊                                | 516/9741 [00:01<00:20, 460.27it/s]  6%|█▉                                | 563/9741 [00:01<00:19, 461.12it/s]  6%|██▏                               | 610/9741 [00:01<00:19, 461.82it/s]  7%|██▎                               | 657/9741 [00:01<00:19, 460.46it/s]  7%|██▍                               | 704/9741 [00:01<00:19, 461.48it/s]  8%|██▌                               | 751/9741 [00:01<00:19, 462.30it/s]  8%|██▊                               | 798/9741 [00:01<00:19, 458.47it/s]  9%|██▉                               | 844/9741 [00:01<00:19, 458.88it/s]  9%|███                               | 890/9741 [00:01<00:19, 458.03it/s] 10%|███▎                              | 951/9741 [00:02<00:17, 501.96it/s] 10%|███▍                             | 1021/9741 [00:02<00:15, 559.66it/s] 11%|███▋                             | 1092/9741 [00:02<00:14, 604.27it/s] 12%|███▉                             | 1162/9741 [00:02<00:13, 632.12it/s] 13%|████▏                            | 1232/9741 [00:02<00:13, 652.36it/s] 13%|████▍                            | 1303/9741 [00:02<00:12, 667.76it/s] 14%|████▋                            | 1372/9741 [00:02<00:12, 674.20it/s] 15%|████▉                            | 1443/9741 [00:02<00:12, 681.99it/s] 16%|█████▏                           | 1514/9741 [00:02<00:11, 687.83it/s] 16%|█████▎                           | 1584/9741 [00:02<00:11, 689.59it/s] 17%|█████▌                           | 1654/9741 [00:03<00:11, 691.37it/s] 18%|█████▊                           | 1724/9741 [00:03<00:11, 692.05it/s] 18%|██████                           | 1794/9741 [00:03<00:11, 663.10it/s] 19%|██████▎                          | 1865/9741 [00:03<00:11, 674.05it/s] 20%|██████▌                          | 1936/9741 [00:03<00:11, 682.32it/s] 21%|██████▊                          | 2007/9741 [00:03<00:11, 688.74it/s] 21%|███████                          | 2077/9741 [00:03<00:11, 688.45it/s] 22%|███████▎                         | 2147/9741 [00:03<00:10, 691.42it/s] 23%|███████▌                         | 2218/9741 [00:03<00:10, 695.46it/s] 23%|███████▊                         | 2288/9741 [00:03<00:10, 695.30it/s] 24%|███████▉                         | 2359/9741 [00:04<00:10, 697.37it/s] 25%|████████▏                        | 2429/9741 [00:04<00:10, 698.05it/s] 26%|████████▍                        | 2499/9741 [00:04<00:10, 694.59it/s] 26%|████████▋                        | 2569/9741 [00:04<00:10, 689.73it/s] 27%|████████▉                        | 2640/9741 [00:04<00:10, 693.09it/s] 28%|█████████▏                       | 2710/9741 [00:04<00:10, 690.05it/s] 29%|█████████▍                       | 2780/9741 [00:04<00:10, 692.49it/s] 29%|█████████▋                       | 2851/9741 [00:04<00:09, 695.34it/s] 30%|█████████▉                       | 2922/9741 [00:04<00:09, 697.71it/s] 31%|██████████▏                      | 2992/9741 [00:04<00:09, 695.75it/s] 31%|██████████▍                      | 3063/9741 [00:05<00:09, 697.26it/s] 32%|██████████▌                      | 3134/9741 [00:05<00:09, 699.08it/s] 33%|██████████▊                      | 3204/9741 [00:05<00:09, 694.82it/s] 34%|███████████                      | 3274/9741 [00:05<00:09, 696.17it/s] 34%|███████████▎                     | 3344/9741 [00:05<00:09, 696.03it/s] 35%|███████████▌                     | 3414/9741 [00:05<00:09, 695.09it/s] 36%|███████████▊                     | 3484/9741 [00:05<00:09, 692.74it/s] 36%|████████████                     | 3554/9741 [00:05<00:08, 694.31it/s] 37%|████████████▎                    | 3624/9741 [00:05<00:08, 692.46it/s] 38%|████████████▌                    | 3695/9741 [00:05<00:08, 694.70it/s] 39%|████████████▊                    | 3766/9741 [00:06<00:08, 697.23it/s] 39%|████████████▉                    | 3836/9741 [00:06<00:08, 696.45it/s] 40%|█████████████▏                   | 3907/9741 [00:06<00:08, 698.26it/s] 41%|█████████████▍                   | 3977/9741 [00:06<00:08, 698.11it/s] 42%|█████████████▋                   | 4047/9741 [00:06<00:08, 698.30it/s] 42%|█████████████▉                   | 4117/9741 [00:06<00:08, 694.50it/s] 43%|██████████████▏                  | 4187/9741 [00:06<00:07, 695.52it/s] 44%|██████████████▍                  | 4257/9741 [00:06<00:07, 696.40it/s] 44%|██████████████▋                  | 4327/9741 [00:06<00:07, 695.49it/s] 45%|██████████████▉                  | 4397/9741 [00:06<00:07, 695.87it/s] 46%|███████████████▏                 | 4467/9741 [00:07<00:07, 696.16it/s] 47%|███████████████▎                 | 4537/9741 [00:07<00:07, 655.01it/s] 47%|███████████████▌                 | 4608/9741 [00:07<00:07, 668.97it/s] 48%|███████████████▊                 | 4677/9741 [00:07<00:07, 674.99it/s] 49%|████████████████                 | 4745/9741 [00:07<00:10, 489.71it/s] 49%|████████████████▎                | 4816/9741 [00:07<00:09, 539.41it/s] 50%|████████████████▌                | 4886/9741 [00:07<00:08, 579.26it/s] 51%|████████████████▊                | 4955/9741 [00:07<00:07, 606.87it/s] 52%|█████████████████                | 5025/9741 [00:08<00:07, 630.63it/s] 52%|█████████████████▎               | 5096/9741 [00:08<00:07, 650.33it/s] 53%|█████████████████▌               | 5167/9741 [00:08<00:06, 665.33it/s] 54%|█████████████████▋               | 5236/9741 [00:08<00:06, 672.29it/s] 54%|█████████████████▉               | 5307/9741 [00:08<00:06, 680.69it/s] 55%|██████████████████▏              | 5377/9741 [00:08<00:06, 685.44it/s] 56%|██████████████████▍              | 5447/9741 [00:08<00:06, 686.81it/s] 57%|██████████████████▋              | 5519/9741 [00:08<00:06, 695.33it/s] 57%|██████████████████▉              | 5592/9741 [00:08<00:05, 704.21it/s] 58%|███████████████████▏             | 5664/9741 [00:08<00:05, 707.60it/s] 59%|███████████████████▍             | 5737/9741 [00:09<00:05, 712.29it/s] 60%|███████████████████▋             | 5810/9741 [00:09<00:05, 715.73it/s] 60%|███████████████████▉             | 5882/9741 [00:09<00:05, 714.04it/s] 61%|████████████████████▏            | 5954/9741 [00:09<00:05, 715.75it/s] 62%|████████████████████▍            | 6027/9741 [00:09<00:05, 719.41it/s] 63%|████████████████████▋            | 6099/9741 [00:09<00:05, 718.13it/s] 63%|████████████████████▉            | 6171/9741 [00:09<00:04, 718.53it/s] 64%|█████████████████████▏           | 6244/9741 [00:09<00:04, 720.69it/s] 65%|█████████████████████▍           | 6317/9741 [00:09<00:04, 719.60it/s] 66%|█████████████████████▋           | 6390/9741 [00:09<00:04, 721.20it/s] 66%|█████████████████████▉           | 6463/9741 [00:10<00:04, 722.57it/s] 67%|██████████████████████▏          | 6536/9741 [00:10<00:04, 721.33it/s] 68%|██████████████████████▍          | 6609/9741 [00:10<00:04, 722.17it/s] 69%|██████████████████████▋          | 6682/9741 [00:10<00:04, 723.05it/s] 69%|██████████████████████▉          | 6755/9741 [00:10<00:04, 724.59it/s] 70%|███████████████████████▏         | 6828/9741 [00:10<00:04, 722.93it/s] 71%|███████████████████████▍         | 6901/9741 [00:10<00:03, 722.88it/s] 72%|███████████████████████▋         | 6974/9741 [00:10<00:03, 721.59it/s] 72%|███████████████████████▊         | 7047/9741 [00:10<00:03, 719.93it/s] 73%|████████████████████████         | 7121/9741 [00:10<00:03, 723.30it/s] 74%|████████████████████████▎        | 7194/9741 [00:11<00:03, 725.07it/s] 75%|████████████████████████▌        | 7267/9741 [00:11<00:03, 722.53it/s] 75%|████████████████████████▊        | 7340/9741 [00:11<00:03, 723.49it/s] 76%|█████████████████████████        | 7414/9741 [00:11<00:03, 725.47it/s] 77%|█████████████████████████▎       | 7487/9741 [00:11<00:03, 692.67it/s] 78%|█████████████████████████▌       | 7560/9741 [00:11<00:03, 701.46it/s] 78%|█████████████████████████▊       | 7633/9741 [00:11<00:02, 708.20it/s] 79%|██████████████████████████       | 7705/9741 [00:11<00:02, 708.09it/s] 80%|██████████████████████████▎      | 7777/9741 [00:11<00:02, 708.95it/s] 81%|██████████████████████████▌      | 7848/9741 [00:12<00:02, 691.50it/s] 81%|██████████████████████████▊      | 7920/9741 [00:12<00:02, 698.70it/s] 82%|███████████████████████████      | 7993/9741 [00:12<00:02, 706.86it/s] 83%|███████████████████████████▎     | 8066/9741 [00:12<00:02, 712.53it/s] 84%|███████████████████████████▌     | 8139/9741 [00:12<00:02, 715.06it/s] 84%|███████████████████████████▊     | 8211/9741 [00:12<00:02, 711.51it/s] 85%|████████████████████████████     | 8284/9741 [00:12<00:02, 714.84it/s] 86%|████████████████████████████▎    | 8356/9741 [00:12<00:01, 714.21it/s] 87%|████████████████████████████▌    | 8429/9741 [00:12<00:01, 717.90it/s] 87%|████████████████████████████▊    | 8501/9741 [00:12<00:01, 718.17it/s] 88%|█████████████████████████████    | 8574/9741 [00:13<00:01, 716.56it/s] 89%|█████████████████████████████▎   | 8647/9741 [00:13<00:01, 718.41it/s] 90%|█████████████████████████████▌   | 8720/9741 [00:13<00:01, 721.25it/s] 90%|█████████████████████████████▊   | 8793/9741 [00:13<00:01, 721.26it/s] 91%|██████████████████████████████   | 8866/9741 [00:13<00:01, 719.67it/s] 92%|██████████████████████████████▎  | 8939/9741 [00:13<00:01, 721.97it/s] 93%|██████████████████████████████▌  | 9012/9741 [00:13<00:01, 722.85it/s] 93%|██████████████████████████████▊  | 9085/9741 [00:13<00:00, 720.51it/s] 94%|███████████████████████████████  | 9158/9741 [00:13<00:00, 722.62it/s] 95%|███████████████████████████████▎ | 9231/9741 [00:13<00:00, 723.70it/s] 96%|███████████████████████████████▌ | 9304/9741 [00:14<00:00, 719.55it/s] 96%|███████████████████████████████▊ | 9376/9741 [00:14<00:00, 713.58it/s] 97%|████████████████████████████████ | 9448/9741 [00:14<00:00, 715.25it/s] 98%|████████████████████████████████▎| 9520/9741 [00:14<00:00, 714.34it/s] 98%|████████████████████████████████▍| 9593/9741 [00:14<00:00, 716.82it/s] 99%|████████████████████████████████▋| 9666/9741 [00:14<00:00, 718.59it/s]100%|████████████████████████████████▉| 9738/9741 [00:14<00:00, 718.32it/s]100%|█████████████████████████████████| 9741/9741 [00:14<00:00, 665.13it/s]
Load End
Num instances: 1000
^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A                                                                                        Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.33s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:04<00:09,  4.95s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:11,  5.61s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:11,  5.57s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:09<00:04,  4.98s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.46s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.45s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:12<00:06,  6.32s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.34s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.51s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:15<00:00,  4.86s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.00s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.02s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.15s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:18<00:00,  6.23s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:18<00:00,  6.18s/it]
[2023-08-14 01:28:37,074] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
[2023-08-14 01:28:47,048] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-14 01:28:47,049] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-14 01:28:47,050] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-14 01:28:47,050] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-14 01:28:47,050] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-14 01:28:47,050] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-14 01:28:47,050] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-14 01:28:47,050] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-14 01:28:47,050] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-14 01:28:47,050] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-14 01:28:47,050] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-14 01:28:47,050] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f9bb5ef3fd0>
[2023-08-14 01:28:47,050] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-14 01:28:47,050] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-14 01:28:47,050] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-14 01:28:47,050] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-14 01:28:47,050] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-14 01:28:47,050] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-14 01:28:47,050] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-14 01:28:47,050] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-14 01:28:47,050] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-14 01:28:47,050] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-14 01:28:47,050] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-14 01:28:47,050] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-14 01:28:47,050] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-14 01:28:47,050] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-14 01:28:47,050] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-14 01:28:47,050] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-14 01:28:47,051] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-14 01:28:47,051] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-14 01:28:47,051] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-14 01:28:47,051] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-14 01:28:47,051] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-14 01:28:47,051] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-14 01:28:47,051] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-14 01:28:47,051] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-14 01:28:47,051] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-14 01:28:47,051] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-14 01:28:47,051] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-14 01:28:47,051] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-14 01:28:47,051] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-14 01:28:47,051] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-14 01:28:47,051] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-14 01:28:47,051] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-14 01:28:47,051] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f9ba7fa2cd0>
[2023-08-14 01:28:47,051] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-14 01:28:47,051] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-14 01:28:47,051] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-14 01:28:47,051] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-14 01:28:47,051] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-14 01:28:47,051] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-14 01:28:47,051] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-14 01:28:47,051] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-14 01:28:47,051] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-14 01:28:47,051] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-14 01:28:47,051] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-14 01:28:47,051] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-14 01:28:47,051] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-14 01:28:47,051] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-14 01:28:47,051] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-14 01:28:47,051] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-14 01:28:47,051] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-14 01:28:47,051] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-14 01:28:47,051] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-14 01:28:47,051] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-14 01:28:47,051] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-14 01:28:47,051] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-14 01:28:47,051] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.5068793296813965 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                                           | 0/50 [00:00<?, ?it/s]############### Example ###############
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following multiple choice question.

### Demonstration:
Input: Mary had 89 stickers.  She used 3 large stickers on the front page of her journal and 7 stickers each to 6 other pages of her journal. How many stickers does Mary have remaining?
Answer: 44

Input: Zach is saving his money to buy a brand new bike that costs $100.  His weekly allowance is $5.  His parent will pay him an extra $10 to mow the lawn.  His neighbor will pay him $7 per hour to babysit their son.  He has already saved up $65.  He'll receive his allowance on Friday and he's planning on babysitting for 2 hours this Saturday after he mows the lawn.  How much more money does Zach need to earn before he can buy the bike?
Answer: 6

Input: Mark has kangaroos and goats.  Kangaroos have two legs and goats have four legs.  If he has 23 kangaroos and three times as many goats as kangaroos what is the total number of legs of all his animals?
Answer: 322

Input: Josh’s mom gives him $20 to go shopping at the mall. He buys a hat for $10 and a pencil for $2. Then he buys four cookies. If each cookie costs $1.25, how much money does Josh have left?
Answer: 3

Input: George's bowling team is one round away from breaking the league record for most points scored in a season. The old record is an average score per player of 287 per round. Each team has 4 players and there are 10 rounds in the season. Through the first 9 rounds, his team has scored a total of 10,440. How many points less than the current league record per game average is the minimum average they need to score, per player, in the final round to tie the league record?
Answer: 27

Input: Max was doing homework in three different subjects. It took him 20 minutes to finish tasks from biology and two times more time to finish history. Geography took him the most time, three times more than history. How much time did Max spend on doing his homework?
Answer: 180

Input: Sophia ate 1/6 of her pie and she put the rest on the fridge. If the pie left in the fridge weighs 1200 grams, how many grams did Sophia eat?
Answer: 240

Input: Sarah, Mary, and Tuan decided to go to the restaurant for a meal. They decided to split the cost of the meal evenly. If the total price of the meal comes to $67 and they have a coupon for $4, how much does each person need to contribute to the bill?
Answer: 21

Input: Tom's brother is 4 times as old as Tom's dog. If in 6 years, Tom's brother will be 30 years, how old is Tom's dog going to be in six years?
Answer: 12

Input: There are 50 children at the party. Three-fifths of them are boys. How many of the children are girls?
Answer: 20

### Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid

### Response:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o10-tgsm8k-s1-rFalse
Loading extension module utils...
Time to load utils op: 0.40522027015686035 seconds
Loading extension module utils...
Time to load utils op: 0.40489816665649414 seconds
Loading extension module utils...
Time to load utils op: 0.5045413970947266 seconds
Evaluating commonsenseqa :   2%|█                                                  | 1/50 [00:36<29:45, 36.45s/it]Evaluating commonsenseqa :   4%|██                                                 | 2/50 [01:24<34:27, 43.07s/it]Evaluating commonsenseqa :   6%|███                                                | 3/50 [02:10<34:49, 44.46s/it]Evaluating commonsenseqa :   8%|████                                               | 4/50 [02:57<34:52, 45.49s/it]Evaluating commonsenseqa :  10%|█████                                              | 5/50 [03:43<34:24, 45.87s/it]Evaluating commonsenseqa :  12%|██████                                             | 6/50 [04:31<34:00, 46.38s/it]Evaluating commonsenseqa :  14%|███████▏                                           | 7/50 [05:18<33:26, 46.65s/it]Evaluating commonsenseqa :  16%|████████▏                                          | 8/50 [06:04<32:36, 46.58s/it]Evaluating commonsenseqa :  18%|█████████▏                                         | 9/50 [06:51<31:53, 46.68s/it]Evaluating commonsenseqa :  20%|██████████                                        | 10/50 [07:38<31:06, 46.67s/it]Evaluating commonsenseqa :  22%|███████████                                       | 11/50 [08:25<30:22, 46.72s/it]Evaluating commonsenseqa :  24%|████████████                                      | 12/50 [09:11<29:33, 46.68s/it]Evaluating commonsenseqa :  26%|█████████████                                     | 13/50 [09:58<28:45, 46.63s/it]Evaluating commonsenseqa :  28%|██████████████                                    | 14/50 [10:45<28:01, 46.71s/it]Evaluating commonsenseqa :  30%|███████████████                                   | 15/50 [11:28<26:42, 45.80s/it]Evaluating commonsenseqa :  32%|████████████████                                  | 16/50 [12:16<26:11, 46.21s/it]Evaluating commonsenseqa :  34%|█████████████████                                 | 17/50 [13:02<25:28, 46.31s/it]Evaluating commonsenseqa :  36%|██████████████████                                | 18/50 [13:50<24:53, 46.68s/it]Evaluating commonsenseqa :  38%|███████████████████                               | 19/50 [14:07<19:35, 37.93s/it]Evaluating commonsenseqa :  40%|████████████████████                              | 20/50 [14:54<20:20, 40.70s/it]Evaluating commonsenseqa :  42%|█████████████████████                             | 21/50 [15:30<18:54, 39.14s/it]Evaluating commonsenseqa :  44%|██████████████████████                            | 22/50 [16:17<19:22, 41.52s/it]Evaluating commonsenseqa :  46%|███████████████████████                           | 23/50 [17:05<19:30, 43.37s/it]Evaluating commonsenseqa :  48%|████████████████████████                          | 24/50 [17:46<18:31, 42.76s/it]Evaluating commonsenseqa :  50%|█████████████████████████                         | 25/50 [18:16<16:14, 38.99s/it]Evaluating commonsenseqa :  52%|██████████████████████████                        | 26/50 [18:34<13:04, 32.71s/it]Evaluating commonsenseqa :  54%|███████████████████████████                       | 27/50 [19:22<14:14, 37.13s/it]Evaluating commonsenseqa :  56%|████████████████████████████                      | 28/50 [20:09<14:40, 40.04s/it]Evaluating commonsenseqa :  58%|████████████████████████████▉                     | 29/50 [20:56<14:45, 42.15s/it]Evaluating commonsenseqa :  60%|██████████████████████████████                    | 30/50 [21:35<13:45, 41.26s/it]Evaluating commonsenseqa :  62%|███████████████████████████████                   | 31/50 [22:22<13:36, 42.98s/it]Evaluating commonsenseqa :  64%|████████████████████████████████                  | 32/50 [22:53<11:49, 39.41s/it]Evaluating commonsenseqa :  66%|█████████████████████████████████                 | 33/50 [23:40<11:48, 41.68s/it]Evaluating commonsenseqa :  68%|██████████████████████████████████                | 34/50 [24:27<11:33, 43.35s/it]Evaluating commonsenseqa :  70%|███████████████████████████████████               | 35/50 [25:15<11:10, 44.69s/it]Evaluating commonsenseqa :  72%|████████████████████████████████████              | 36/50 [26:02<10:34, 45.32s/it]Evaluating commonsenseqa :  74%|█████████████████████████████████████             | 37/50 [26:48<09:54, 45.70s/it]Evaluating commonsenseqa :  76%|██████████████████████████████████████            | 38/50 [27:28<08:47, 43.95s/it]Evaluating commonsenseqa :  78%|███████████████████████████████████████           | 39/50 [28:01<07:28, 40.73s/it]Evaluating commonsenseqa :  80%|████████████████████████████████████████          | 40/50 [28:39<06:39, 39.94s/it]Evaluating commonsenseqa :  82%|█████████████████████████████████████████         | 41/50 [29:26<06:16, 41.83s/it]Evaluating commonsenseqa :  84%|██████████████████████████████████████████        | 42/50 [30:13<05:47, 43.46s/it]Evaluating commonsenseqa :  86%|███████████████████████████████████████████       | 43/50 [30:49<04:47, 41.10s/it]Evaluating commonsenseqa :  88%|████████████████████████████████████████████      | 44/50 [31:36<04:17, 42.91s/it]Evaluating commonsenseqa :  90%|█████████████████████████████████████████████     | 45/50 [32:22<03:40, 44.01s/it]Evaluating commonsenseqa :  92%|██████████████████████████████████████████████    | 46/50 [33:09<02:58, 44.68s/it]Evaluating commonsenseqa :  94%|███████████████████████████████████████████████   | 47/50 [33:55<02:15, 45.20s/it]Evaluating commonsenseqa :  96%|████████████████████████████████████████████████  | 48/50 [34:26<01:21, 40.89s/it]Evaluating commonsenseqa :  98%|█████████████████████████████████████████████████ | 49/50 [35:14<00:43, 43.08s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████| 50/50 [35:48<00:00, 40.27s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████| 50/50 [35:48<00:00, 42.96s/it]
name: commonsenseqa | {'exact_match': 0.4, 'rougeL': 4.0831} | lm_loss 7.8334 | avg. gen lenth: 235.716
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name gsm8k --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/out-domain/o11-tgsm8k-s1-rFalse --seed 1 --num-out-domain 11
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-14 02:04:45,010] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/out-domain/o11-tgsm8k-s1-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 11
  out_domain_data_name ......... gsm8k
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o11-tgsm8k-s1-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                    | 0/9741 [00:00<?, ?it/s]  0%|▎                                                                         | 43/9741 [00:00<00:22, 427.05it/s]  1%|▋                                                                         | 86/9741 [00:00<00:22, 428.34it/s]  1%|▉                                                                        | 130/9741 [00:00<00:22, 429.98it/s]  2%|█▎                                                                       | 174/9741 [00:00<00:22, 430.82it/s]  2%|█▋                                                                       | 218/9741 [00:00<00:22, 428.48it/s]  3%|█▉                                                                       | 262/9741 [00:00<00:22, 429.38it/s]  3%|██▎                                                                      | 305/9741 [00:00<00:22, 424.25it/s]  4%|██▌                                                                      | 348/9741 [00:00<00:22, 424.64it/s]  4%|██▉                                                                      | 392/9741 [00:00<00:21, 426.47it/s]  4%|███▎                                                                     | 435/9741 [00:01<00:21, 425.16it/s]  5%|███▌                                                                     | 479/9741 [00:01<00:21, 426.77it/s]  5%|███▉                                                                     | 523/9741 [00:01<00:21, 427.83it/s]  6%|████▏                                                                    | 566/9741 [00:01<00:21, 428.15it/s]  6%|████▌                                                                    | 610/9741 [00:01<00:21, 429.39it/s]  7%|████▉                                                                    | 653/9741 [00:01<00:21, 429.51it/s]  7%|█████▎                                                                   | 710/9741 [00:01<00:19, 471.22it/s]  8%|█████▊                                                                   | 774/9741 [00:01<00:17, 519.64it/s]  9%|██████▎                                                                  | 839/9741 [00:01<00:15, 557.99it/s]  9%|██████▊                                                                  | 904/9741 [00:01<00:15, 583.22it/s] 10%|███████▎                                                                 | 970/9741 [00:02<00:14, 603.63it/s] 11%|███████▋                                                                | 1036/9741 [00:02<00:14, 617.97it/s] 11%|████████▏                                                               | 1102/9741 [00:02<00:13, 628.71it/s] 12%|████████▋                                                               | 1167/9741 [00:02<00:13, 632.79it/s] 13%|█████████                                                               | 1233/9741 [00:02<00:13, 638.21it/s] 13%|█████████▌                                                              | 1299/9741 [00:02<00:13, 641.97it/s] 14%|██████████                                                              | 1364/9741 [00:02<00:13, 641.24it/s] 15%|██████████▌                                                             | 1429/9741 [00:02<00:12, 643.47it/s] 15%|███████████                                                             | 1494/9741 [00:02<00:12, 645.38it/s] 16%|███████████▌                                                            | 1559/9741 [00:02<00:12, 646.75it/s] 17%|████████████                                                            | 1624/9741 [00:03<00:12, 645.32it/s] 17%|████████████▍                                                           | 1690/9741 [00:03<00:12, 646.78it/s] 18%|████████████▉                                                           | 1755/9741 [00:03<00:12, 647.59it/s] 19%|█████████████▍                                                          | 1820/9741 [00:03<00:12, 620.29it/s] 19%|█████████████▉                                                          | 1885/9741 [00:03<00:12, 627.78it/s] 20%|██████████████▍                                                         | 1950/9741 [00:03<00:12, 633.59it/s] 21%|██████████████▉                                                         | 2015/9741 [00:03<00:12, 638.09it/s] 21%|███████████████▎                                                        | 2079/9741 [00:03<00:12, 637.66it/s] 22%|███████████████▊                                                        | 2144/9741 [00:03<00:11, 640.25it/s] 23%|████████████████▎                                                       | 2209/9741 [00:03<00:11, 642.35it/s] 23%|████████████████▊                                                       | 2274/9741 [00:04<00:11, 642.21it/s] 24%|█████████████████▎                                                      | 2340/9741 [00:04<00:11, 644.73it/s] 25%|█████████████████▊                                                      | 2406/9741 [00:04<00:11, 646.73it/s] 25%|██████████████████▎                                                     | 2471/9741 [00:04<00:11, 641.16it/s] 26%|██████████████████▋                                                     | 2536/9741 [00:04<00:11, 642.63it/s] 27%|███████████████████▏                                                    | 2602/9741 [00:04<00:11, 644.86it/s] 27%|███████████████████▋                                                    | 2667/9741 [00:04<00:10, 646.29it/s] 28%|████████████████████▏                                                   | 2732/9741 [00:04<00:10, 644.12it/s] 29%|████████████████████▋                                                   | 2797/9741 [00:04<00:10, 645.21it/s] 29%|█████████████████████▏                                                  | 2862/9741 [00:04<00:10, 646.28it/s] 30%|█████████████████████▋                                                  | 2927/9741 [00:05<00:10, 645.18it/s] 31%|██████████████████████                                                  | 2992/9741 [00:05<00:10, 646.28it/s] 31%|██████████████████████▌                                                 | 3057/9741 [00:05<00:10, 647.07it/s] 32%|███████████████████████                                                 | 3122/9741 [00:05<00:10, 647.88it/s] 33%|███████████████████████▌                                                | 3187/9741 [00:05<00:10, 646.30it/s] 33%|████████████████████████                                                | 3253/9741 [00:05<00:10, 647.80it/s] 34%|████████████████████████▌                                               | 3318/9741 [00:05<00:10, 641.76it/s] 35%|█████████████████████████                                               | 3383/9741 [00:05<00:09, 641.57it/s] 35%|█████████████████████████▍                                              | 3448/9741 [00:05<00:09, 643.56it/s] 36%|█████████████████████████▉                                              | 3513/9741 [00:05<00:09, 644.63it/s] 37%|██████████████████████████▍                                             | 3578/9741 [00:06<00:09, 646.15it/s] 37%|██████████████████████████▉                                             | 3643/9741 [00:06<00:09, 644.13it/s] 38%|███████████████████████████▍                                            | 3708/9741 [00:06<00:09, 645.51it/s] 39%|███████████████████████████▉                                            | 3773/9741 [00:06<00:09, 646.72it/s] 39%|████████████████████████████▎                                           | 3838/9741 [00:06<00:09, 644.64it/s] 40%|████████████████████████████▊                                           | 3904/9741 [00:06<00:09, 646.58it/s] 41%|█████████████████████████████▎                                          | 3969/9741 [00:06<00:08, 647.14it/s] 41%|█████████████████████████████▊                                          | 4035/9741 [00:06<00:08, 648.25it/s] 42%|██████████████████████████████▎                                         | 4100/9741 [00:06<00:08, 646.70it/s] 43%|██████████████████████████████▊                                         | 4165/9741 [00:06<00:08, 640.70it/s] 43%|███████████████████████████████▎                                        | 4230/9741 [00:07<00:08, 642.66it/s] 44%|███████████████████████████████▋                                        | 4295/9741 [00:07<00:08, 641.63it/s] 45%|████████████████████████████████▏                                       | 4360/9741 [00:07<00:08, 643.22it/s] 45%|████████████████████████████████▋                                       | 4425/9741 [00:07<00:08, 644.23it/s] 46%|█████████████████████████████████▏                                      | 4490/9741 [00:07<00:08, 645.59it/s] 47%|█████████████████████████████████▋                                      | 4555/9741 [00:07<00:08, 604.77it/s] 47%|██████████████████████████████████▏                                     | 4620/9741 [00:07<00:08, 616.77it/s] 48%|██████████████████████████████████▋                                     | 4686/9741 [00:07<00:08, 626.51it/s] 49%|███████████████████████████████████                                     | 4749/9741 [00:08<00:10, 467.35it/s] 49%|███████████████████████████████████▌                                    | 4814/9741 [00:08<00:09, 510.27it/s] 50%|████████████████████████████████████                                    | 4879/9741 [00:08<00:08, 544.75it/s] 51%|████████████████████████████████████▌                                   | 4942/9741 [00:08<00:08, 566.69it/s] 51%|█████████████████████████████████████                                   | 5006/9741 [00:08<00:08, 586.04it/s] 52%|█████████████████████████████████████▍                                  | 5071/9741 [00:08<00:07, 603.52it/s] 53%|█████████████████████████████████████▉                                  | 5137/9741 [00:08<00:07, 617.05it/s] 53%|██████████████████████████████████████▍                                 | 5202/9741 [00:08<00:07, 624.21it/s] 54%|██████████████████████████████████████▉                                 | 5267/9741 [00:08<00:07, 631.63it/s] 55%|███████████████████████████████████████▍                                | 5332/9741 [00:08<00:06, 636.93it/s] 55%|███████████████████████████████████████▉                                | 5397/9741 [00:09<00:06, 640.42it/s] 56%|████████████████████████████████████████▎                               | 5462/9741 [00:09<00:06, 638.32it/s] 57%|████████████████████████████████████████▊                               | 5529/9741 [00:09<00:06, 647.65it/s] 57%|█████████████████████████████████████████▎                              | 5597/9741 [00:09<00:06, 654.89it/s] 58%|█████████████████████████████████████████▊                              | 5664/9741 [00:09<00:06, 656.96it/s] 59%|██████████████████████████████████████████▎                             | 5732/9741 [00:09<00:06, 661.61it/s] 60%|██████████████████████████████████████████▊                             | 5800/9741 [00:09<00:05, 664.67it/s] 60%|███████████████████████████████████████████▎                            | 5867/9741 [00:09<00:05, 664.36it/s] 61%|███████████████████████████████████████████▊                            | 5935/9741 [00:09<00:05, 667.15it/s] 62%|████████████████████████████████████████████▎                           | 6003/9741 [00:09<00:05, 668.63it/s] 62%|████████████████████████████████████████████▊                           | 6071/9741 [00:10<00:05, 669.97it/s] 63%|█████████████████████████████████████████████▍                          | 6139/9741 [00:10<00:05, 668.33it/s] 64%|█████████████████████████████████████████████▉                          | 6207/9741 [00:10<00:05, 669.40it/s] 64%|██████████████████████████████████████████████▍                         | 6275/9741 [00:10<00:05, 669.65it/s] 65%|██████████████████████████████████████████████▉                         | 6342/9741 [00:10<00:05, 668.15it/s] 66%|███████████████████████████████████████████████▎                        | 6409/9741 [00:10<00:04, 667.88it/s] 66%|███████████████████████████████████████████████▊                        | 6477/9741 [00:10<00:04, 669.11it/s] 67%|████████████████████████████████████████████████▎                       | 6544/9741 [00:10<00:04, 667.34it/s] 68%|████████████████████████████████████████████████▊                       | 6611/9741 [00:10<00:04, 667.92it/s] 69%|█████████████████████████████████████████████████▎                      | 6679/9741 [00:10<00:04, 669.61it/s] 69%|█████████████████████████████████████████████████▊                      | 6747/9741 [00:11<00:04, 670.95it/s] 70%|██████████████████████████████████████████████████▎                     | 6815/9741 [00:11<00:04, 669.71it/s] 71%|██████████████████████████████████████████████████▉                     | 6883/9741 [00:11<00:04, 671.51it/s] 71%|███████████████████████████████████████████████████▍                    | 6951/9741 [00:11<00:04, 672.69it/s] 72%|███████████████████████████████████████████████████▉                    | 7019/9741 [00:11<00:04, 670.00it/s] 73%|████████████████████████████████████████████████████▍                   | 7087/9741 [00:11<00:03, 670.66it/s] 73%|████████████████████████████████████████████████████▉                   | 7155/9741 [00:11<00:03, 670.54it/s] 74%|█████████████████████████████████████████████████████▍                  | 7223/9741 [00:11<00:03, 668.45it/s] 75%|█████████████████████████████████████████████████████▉                  | 7291/9741 [00:11<00:03, 669.81it/s] 76%|██████████████████████████████████████████████████████▍                 | 7359/9741 [00:11<00:03, 670.83it/s] 76%|██████████████████████████████████████████████████████▉                 | 7427/9741 [00:12<00:03, 671.24it/s] 77%|███████████████████████████████████████████████████████▍                | 7495/9741 [00:12<00:03, 640.62it/s] 78%|███████████████████████████████████████████████████████▉                | 7563/9741 [00:12<00:03, 649.34it/s] 78%|████████████████████████████████████████████████████████▍               | 7631/9741 [00:12<00:03, 656.07it/s] 79%|████████████████████████████████████████████████████████▉               | 7698/9741 [00:12<00:03, 658.01it/s] 80%|█████████████████████████████████████████████████████████▍              | 7766/9741 [00:12<00:02, 662.44it/s] 80%|█████████████████████████████████████████████████████████▉              | 7834/9741 [00:12<00:02, 665.02it/s] 81%|██████████████████████████████████████████████████████████▍             | 7901/9741 [00:12<00:02, 665.25it/s] 82%|██████████████████████████████████████████████████████████▉             | 7969/9741 [00:12<00:02, 667.52it/s] 83%|███████████████████████████████████████████████████████████▍            | 8037/9741 [00:13<00:02, 668.80it/s] 83%|███████████████████████████████████████████████████████████▉            | 8105/9741 [00:13<00:02, 670.33it/s] 84%|████████████████████████████████████████████████████████████▍           | 8173/9741 [00:13<00:02, 669.28it/s] 85%|████████████████████████████████████████████████████████████▉           | 8241/9741 [00:13<00:02, 670.68it/s] 85%|█████████████████████████████████████████████████████████████▍          | 8309/9741 [00:13<00:02, 666.26it/s] 86%|█████████████████████████████████████████████████████████████▉          | 8376/9741 [00:13<00:02, 666.29it/s] 87%|██████████████████████████████████████████████████████████████▍         | 8444/9741 [00:13<00:01, 667.74it/s] 87%|██████████████████████████████████████████████████████████████▉         | 8511/9741 [00:13<00:01, 664.00it/s] 88%|███████████████████████████████████████████████████████████████▍        | 8578/9741 [00:13<00:01, 662.34it/s] 89%|███████████████████████████████████████████████████████████████▉        | 8645/9741 [00:13<00:01, 664.38it/s] 89%|████████████████████████████████████████████████████████████████▍       | 8712/9741 [00:14<00:01, 665.94it/s] 90%|████████████████████████████████████████████████████████████████▉       | 8780/9741 [00:14<00:01, 667.88it/s] 91%|█████████████████████████████████████████████████████████████████▍      | 8847/9741 [00:14<00:01, 666.62it/s] 92%|█████████████████████████████████████████████████████████████████▉      | 8915/9741 [00:14<00:01, 668.61it/s] 92%|██████████████████████████████████████████████████████████████████▍     | 8983/9741 [00:14<00:01, 669.82it/s] 93%|██████████████████████████████████████████████████████████████████▉     | 9050/9741 [00:14<00:01, 668.34it/s] 94%|███████████████████████████████████████████████████████████████████▍    | 9117/9741 [00:14<00:00, 668.14it/s] 94%|███████████████████████████████████████████████████████████████████▉    | 9185/9741 [00:14<00:00, 669.45it/s] 95%|████████████████████████████████████████████████████████████████████▍   | 9253/9741 [00:14<00:00, 669.56it/s] 96%|████████████████████████████████████████████████████████████████████▉   | 9320/9741 [00:14<00:00, 666.08it/s] 96%|█████████████████████████████████████████████████████████████████████▍  | 9387/9741 [00:15<00:00, 666.96it/s] 97%|█████████████████████████████████████████████████████████████████████▉  | 9455/9741 [00:15<00:00, 668.28it/s] 98%|██████████████████████████████████████████████████████████████████████▍ | 9522/9741 [00:15<00:00, 667.21it/s] 98%|██████████████████████████████████████████████████████████████████████▉ | 9590/9741 [00:15<00:00, 668.90it/s] 99%|███████████████████████████████████████████████████████████████████████▍| 9658/9741 [00:15<00:00, 669.60it/s]100%|███████████████████████████████████████████████████████████████████████▉| 9725/9741 [00:15<00:00, 668.49it/s]100%|████████████████████████████████████████████████████████████████████████| 9741/9741 [00:15<00:00, 626.10it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.31s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.15s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.02s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.41s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.10s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.03s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.00s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.29s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.46s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.63s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.56s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.73s/it]
[2023-08-14 02:05:52,219] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.45s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.60s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.69s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.86s/it]
[2023-08-14 02:06:04,265] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-14 02:06:04,266] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-14 02:06:04,267] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-14 02:06:04,267] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-14 02:06:04,267] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-14 02:06:04,267] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-14 02:06:04,267] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-14 02:06:04,267] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-14 02:06:04,267] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-14 02:06:04,267] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-14 02:06:04,267] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-14 02:06:04,267] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fac931b5fd0>
[2023-08-14 02:06:04,267] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-14 02:06:04,267] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-14 02:06:04,267] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-14 02:06:04,267] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-14 02:06:04,267] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-14 02:06:04,267] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-14 02:06:04,267] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-14 02:06:04,267] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-14 02:06:04,267] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-14 02:06:04,267] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-14 02:06:04,267] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-14 02:06:04,267] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-14 02:06:04,267] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-14 02:06:04,267] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-14 02:06:04,267] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-14 02:06:04,267] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-14 02:06:04,267] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-14 02:06:04,267] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-14 02:06:04,267] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-14 02:06:04,268] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-14 02:06:04,268] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-14 02:06:04,268] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-14 02:06:04,268] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-14 02:06:04,268] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-14 02:06:04,268] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-14 02:06:04,268] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-14 02:06:04,268] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-14 02:06:04,268] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-14 02:06:04,268] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-14 02:06:04,268] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-14 02:06:04,268] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-14 02:06:04,268] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-14 02:06:04,268] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7fac9c33acd0>
[2023-08-14 02:06:04,268] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-14 02:06:04,268] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-14 02:06:04,268] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-14 02:06:04,268] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-14 02:06:04,268] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-14 02:06:04,268] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-14 02:06:04,268] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-14 02:06:04,268] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-14 02:06:04,268] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-14 02:06:04,268] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-14 02:06:04,268] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-14 02:06:04,268] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-14 02:06:04,268] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-14 02:06:04,268] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-14 02:06:04,268] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-14 02:06:04,268] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-14 02:06:04,268] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-14 02:06:04,268] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-14 02:06:04,268] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-14 02:06:04,268] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-14 02:06:04,268] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-14 02:06:04,268] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-14 02:06:04,268] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.46720433235168457 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                                           | 0/50 [00:00<?, ?it/s]############### Example ###############
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following multiple choice question.

### Demonstration:
Input: Mary had 89 stickers.  She used 3 large stickers on the front page of her journal and 7 stickers each to 6 other pages of her journal. How many stickers does Mary have remaining?
Answer: 44

Input: Zach is saving his money to buy a brand new bike that costs $100.  His weekly allowance is $5.  His parent will pay him an extra $10 to mow the lawn.  His neighbor will pay him $7 per hour to babysit their son.  He has already saved up $65.  He'll receive his allowance on Friday and he's planning on babysitting for 2 hours this Saturday after he mows the lawn.  How much more money does Zach need to earn before he can buy the bike?
Answer: 6

Input: Mark has kangaroos and goats.  Kangaroos have two legs and goats have four legs.  If he has 23 kangaroos and three times as many goats as kangaroos what is the total number of legs of all his animals?
Answer: 322

Input: Josh’s mom gives him $20 to go shopping at the mall. He buys a hat for $10 and a pencil for $2. Then he buys four cookies. If each cookie costs $1.25, how much money does Josh have left?
Answer: 3

Input: George's bowling team is one round away from breaking the league record for most points scored in a season. The old record is an average score per player of 287 per round. Each team has 4 players and there are 10 rounds in the season. Through the first 9 rounds, his team has scored a total of 10,440. How many points less than the current league record per game average is the minimum average they need to score, per player, in the final round to tie the league record?
Answer: 27

Input: Max was doing homework in three different subjects. It took him 20 minutes to finish tasks from biology and two times more time to finish history. Geography took him the most time, three times more than history. How much time did Max spend on doing his homework?
Answer: 180

Input: Sophia ate 1/6 of her pie and she put the rest on the fridge. If the pie left in the fridge weighs 1200 grams, how many grams did Sophia eat?
Answer: 240

Input: Sarah, Mary, and Tuan decided to go to the restaurant for a meal. They decided to split the cost of the meal evenly. If the total price of the meal comes to $67 and they have a coupon for $4, how much does each person need to contribute to the bill?
Answer: 21

Input: Tom's brother is 4 times as old as Tom's dog. If in 6 years, Tom's brother will be 30 years, how old is Tom's dog going to be in six years?
Answer: 12

Input: There are 50 children at the party. Three-fifths of them are boys. How many of the children are girls?
Answer: 20

Input: Gail has some bills in her wallet which amount to $100. She has four $5 bills and three $20 bills, and the rest are $10 bills. How many $10 bills are in her wallet?
Answer: 2

### Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid

### Response:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o11-tgsm8k-s1-rFalse
Loading extension module utils...
Time to load utils op: 0.4045372009277344 seconds
Loading extension module utils...
Time to load utils op: 0.4043247699737549 seconds
Loading extension module utils...
Time to load utils op: 0.4050126075744629 seconds
Evaluating commonsenseqa :   2%|█                                                  | 1/50 [00:46<37:44, 46.22s/it]Evaluating commonsenseqa :   4%|██                                                 | 2/50 [01:32<36:51, 46.07s/it]Evaluating commonsenseqa :   6%|███                                                | 3/50 [02:18<36:09, 46.15s/it]Evaluating commonsenseqa :   8%|████                                               | 4/50 [03:03<35:10, 45.87s/it]Evaluating commonsenseqa :  10%|█████                                              | 5/50 [03:50<34:34, 46.10s/it]Evaluating commonsenseqa :  12%|██████                                             | 6/50 [04:11<27:31, 37.53s/it]Evaluating commonsenseqa :  14%|███████▏                                           | 7/50 [04:24<21:07, 29.47s/it]Evaluating commonsenseqa :  16%|████████▏                                          | 8/50 [05:10<24:22, 34.83s/it]Evaluating commonsenseqa :  18%|█████████▏                                         | 9/50 [05:56<26:12, 38.36s/it]Evaluating commonsenseqa :  20%|██████████                                        | 10/50 [06:42<27:08, 40.72s/it]Evaluating commonsenseqa :  22%|███████████                                       | 11/50 [07:21<26:08, 40.21s/it]Evaluating commonsenseqa :  24%|████████████                                      | 12/50 [08:07<26:37, 42.05s/it]Evaluating commonsenseqa :  26%|█████████████                                     | 13/50 [08:54<26:45, 43.40s/it]Evaluating commonsenseqa :  28%|██████████████                                    | 14/50 [09:39<26:25, 44.04s/it]Evaluating commonsenseqa :  30%|███████████████                                   | 15/50 [10:15<24:09, 41.41s/it]Evaluating commonsenseqa :  32%|████████████████                                  | 16/50 [11:00<24:09, 42.64s/it]Evaluating commonsenseqa :  34%|█████████████████                                 | 17/50 [11:46<24:02, 43.71s/it]Evaluating commonsenseqa :  36%|██████████████████                                | 18/50 [12:32<23:33, 44.18s/it]Evaluating commonsenseqa :  38%|███████████████████                               | 19/50 [13:15<22:40, 43.87s/it]Evaluating commonsenseqa :  40%|████████████████████                              | 20/50 [14:00<22:11, 44.38s/it]Evaluating commonsenseqa :  42%|█████████████████████                             | 21/50 [14:38<20:25, 42.24s/it]Evaluating commonsenseqa :  44%|██████████████████████                            | 22/50 [15:23<20:09, 43.21s/it]Evaluating commonsenseqa :  46%|███████████████████████                           | 23/50 [16:09<19:44, 43.89s/it]Evaluating commonsenseqa :  48%|████████████████████████                          | 24/50 [16:55<19:18, 44.58s/it]Evaluating commonsenseqa :  50%|█████████████████████████                         | 25/50 [17:20<16:12, 38.89s/it]Evaluating commonsenseqa :  52%|██████████████████████████                        | 26/50 [18:02<15:55, 39.83s/it]Evaluating commonsenseqa :  54%|███████████████████████████                       | 27/50 [18:48<15:56, 41.60s/it]Evaluating commonsenseqa :  56%|████████████████████████████                      | 28/50 [19:34<15:41, 42.79s/it]Evaluating commonsenseqa :  58%|████████████████████████████▉                     | 29/50 [20:19<15:11, 43.41s/it]Evaluating commonsenseqa :  60%|██████████████████████████████                    | 30/50 [21:05<14:46, 44.35s/it]Evaluating commonsenseqa :  62%|███████████████████████████████                   | 31/50 [21:43<13:25, 42.37s/it]Evaluating commonsenseqa :  64%|████████████████████████████████                  | 32/50 [22:29<13:04, 43.59s/it]Evaluating commonsenseqa :  66%|█████████████████████████████████                 | 33/50 [23:15<12:32, 44.28s/it]Evaluating commonsenseqa :  68%|██████████████████████████████████                | 34/50 [24:01<11:57, 44.83s/it]Evaluating commonsenseqa :  70%|███████████████████████████████████               | 35/50 [24:47<11:17, 45.14s/it]Evaluating commonsenseqa :  72%|████████████████████████████████████              | 36/50 [25:34<10:37, 45.56s/it]Evaluating commonsenseqa :  74%|█████████████████████████████████████             | 37/50 [26:19<09:49, 45.34s/it]Evaluating commonsenseqa :  76%|██████████████████████████████████████            | 38/50 [27:04<09:05, 45.44s/it]Evaluating commonsenseqa :  78%|███████████████████████████████████████           | 39/50 [27:49<08:18, 45.36s/it]Evaluating commonsenseqa :  80%|████████████████████████████████████████          | 40/50 [28:36<07:37, 45.76s/it]Evaluating commonsenseqa :  82%|█████████████████████████████████████████         | 41/50 [28:57<05:44, 38.30s/it]Evaluating commonsenseqa :  84%|██████████████████████████████████████████        | 42/50 [29:32<04:59, 37.39s/it]Evaluating commonsenseqa :  86%|███████████████████████████████████████████       | 43/50 [30:02<04:04, 34.95s/it]Evaluating commonsenseqa :  88%|████████████████████████████████████████████      | 44/50 [30:48<03:50, 38.38s/it]Evaluating commonsenseqa :  90%|█████████████████████████████████████████████     | 45/50 [31:33<03:21, 40.36s/it]Evaluating commonsenseqa :  92%|██████████████████████████████████████████████    | 46/50 [32:18<02:47, 41.87s/it]Evaluating commonsenseqa :  94%|███████████████████████████████████████████████   | 47/50 [32:52<01:58, 39.47s/it]Evaluating commonsenseqa :  96%|████████████████████████████████████████████████  | 48/50 [33:38<01:22, 41.49s/it]Evaluating commonsenseqa :  98%|█████████████████████████████████████████████████ | 49/50 [34:25<00:42, 42.93s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████| 50/50 [35:10<00:00, 43.80s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████| 50/50 [35:10<00:00, 42.22s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 3.2937} | lm_loss 7.839 | avg. gen lenth: 243.052
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name gsm8k --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/out-domain/o12-tgsm8k-s1-rFalse --seed 1 --num-out-domain 12
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-14 02:43:08,770] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/out-domain/o12-tgsm8k-s1-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 12
  out_domain_data_name ......... gsm8k
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o12-tgsm8k-s1-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                    | 0/9741 [00:00<?, ?it/s]  0%|▎                                                                         | 41/9741 [00:00<00:23, 408.18it/s]  1%|▋                                                                         | 83/9741 [00:00<00:23, 409.81it/s]  1%|▉                                                                        | 125/9741 [00:00<00:23, 411.43it/s]  2%|█▎                                                                       | 167/9741 [00:00<00:23, 411.68it/s]  2%|█▌                                                                       | 209/9741 [00:00<00:23, 409.49it/s]  3%|█▉                                                                       | 251/9741 [00:00<00:23, 410.19it/s]  3%|██▏                                                                      | 293/9741 [00:00<00:23, 410.45it/s]  3%|██▌                                                                      | 335/9741 [00:00<00:23, 406.25it/s]  4%|██▊                                                                      | 376/9741 [00:00<00:22, 407.32it/s]  4%|███▏                                                                     | 418/9741 [00:01<00:22, 408.15it/s]  5%|███▍                                                                     | 459/9741 [00:01<00:22, 407.30it/s]  5%|███▋                                                                     | 500/9741 [00:01<00:22, 408.04it/s]  6%|████                                                                     | 542/9741 [00:01<00:22, 409.07it/s]  6%|████▎                                                                    | 583/9741 [00:01<00:22, 408.97it/s]  6%|████▋                                                                    | 624/9741 [00:01<00:22, 408.79it/s]  7%|████▉                                                                    | 665/9741 [00:01<00:22, 407.84it/s]  7%|█████▎                                                                   | 706/9741 [00:01<00:22, 408.38it/s]  8%|█████▌                                                                   | 747/9741 [00:01<00:22, 404.89it/s]  8%|█████▉                                                                   | 789/9741 [00:01<00:21, 408.91it/s]  9%|██████▍                                                                  | 851/9741 [00:02<00:18, 471.25it/s]  9%|██████▊                                                                  | 912/9741 [00:02<00:17, 511.71it/s] 10%|███████▎                                                                 | 974/9741 [00:02<00:16, 543.06it/s] 11%|███████▋                                                                | 1036/9741 [00:02<00:15, 565.73it/s] 11%|████████                                                                | 1098/9741 [00:02<00:14, 580.76it/s] 12%|████████▌                                                               | 1159/9741 [00:02<00:14, 588.46it/s] 13%|█████████                                                               | 1221/9741 [00:02<00:14, 596.17it/s] 13%|█████████▍                                                              | 1283/9741 [00:02<00:14, 601.77it/s] 14%|█████████▉                                                              | 1344/9741 [00:02<00:13, 603.83it/s] 14%|██████████▍                                                             | 1406/9741 [00:02<00:13, 606.84it/s] 15%|██████████▊                                                             | 1468/9741 [00:03<00:13, 608.80it/s] 16%|███████████▎                                                            | 1529/9741 [00:03<00:13, 608.04it/s] 16%|███████████▊                                                            | 1590/9741 [00:03<00:13, 607.52it/s] 17%|████████████▏                                                           | 1652/9741 [00:03<00:13, 609.43it/s] 18%|████████████▋                                                           | 1714/9741 [00:03<00:13, 610.63it/s] 18%|█████████████▏                                                          | 1776/9741 [00:03<00:13, 611.44it/s] 19%|█████████████▌                                                          | 1838/9741 [00:03<00:13, 584.10it/s] 20%|██████████████                                                          | 1900/9741 [00:03<00:13, 592.47it/s] 20%|██████████████▌                                                         | 1962/9741 [00:03<00:12, 598.84it/s] 21%|██████████████▉                                                         | 2023/9741 [00:03<00:12, 600.50it/s] 21%|███████████████▍                                                        | 2084/9741 [00:04<00:12, 603.19it/s] 22%|███████████████▊                                                        | 2146/9741 [00:04<00:12, 606.29it/s] 23%|████████████████▎                                                       | 2208/9741 [00:04<00:12, 608.74it/s] 23%|████████████████▊                                                       | 2269/9741 [00:04<00:12, 607.67it/s] 24%|█████████████████▏                                                      | 2330/9741 [00:04<00:12, 604.07it/s] 25%|█████████████████▋                                                      | 2392/9741 [00:04<00:12, 607.58it/s] 25%|██████████████████▏                                                     | 2454/9741 [00:04<00:11, 609.64it/s] 26%|██████████████████▌                                                     | 2515/9741 [00:04<00:11, 607.37it/s] 26%|███████████████████                                                     | 2577/9741 [00:04<00:11, 608.89it/s] 27%|███████████████████▌                                                    | 2639/9741 [00:04<00:11, 609.92it/s] 28%|███████████████████▉                                                    | 2700/9741 [00:05<00:11, 608.16it/s] 28%|████████████████████▍                                                   | 2761/9741 [00:05<00:11, 608.63it/s] 29%|████████████████████▊                                                   | 2822/9741 [00:05<00:11, 608.93it/s] 30%|█████████████████████▎                                                  | 2884/9741 [00:05<00:11, 609.99it/s] 30%|█████████████████████▊                                                  | 2945/9741 [00:05<00:11, 608.03it/s] 31%|██████████████████████▏                                                 | 3007/9741 [00:05<00:11, 609.70it/s] 31%|██████████████████████▋                                                 | 3068/9741 [00:05<00:10, 609.31it/s] 32%|███████████████████████▏                                                | 3129/9741 [00:05<00:10, 606.39it/s] 33%|███████████████████████▌                                                | 3190/9741 [00:05<00:10, 605.47it/s] 33%|████████████████████████                                                | 3252/9741 [00:05<00:10, 607.63it/s] 34%|████████████████████████▍                                               | 3314/9741 [00:06<00:10, 608.50it/s] 35%|████████████████████████▉                                               | 3376/9741 [00:06<00:10, 609.32it/s] 35%|█████████████████████████▍                                              | 3437/9741 [00:06<00:10, 607.83it/s] 36%|█████████████████████████▊                                              | 3498/9741 [00:06<00:10, 608.29it/s] 37%|██████████████████████████▎                                             | 3559/9741 [00:06<00:10, 608.56it/s] 37%|██████████████████████████▊                                             | 3620/9741 [00:06<00:10, 606.64it/s] 38%|███████████████████████████▏                                            | 3682/9741 [00:06<00:09, 607.82it/s] 38%|███████████████████████████▋                                            | 3744/9741 [00:06<00:09, 609.40it/s] 39%|████████████████████████████▏                                           | 3806/9741 [00:06<00:09, 609.76it/s] 40%|████████████████████████████▌                                           | 3867/9741 [00:06<00:09, 607.37it/s] 40%|█████████████████████████████                                           | 3929/9741 [00:07<00:09, 608.50it/s] 41%|█████████████████████████████▍                                          | 3991/9741 [00:07<00:09, 609.18it/s] 42%|█████████████████████████████▉                                          | 4053/9741 [00:07<00:09, 610.04it/s] 42%|██████████████████████████████▍                                         | 4115/9741 [00:07<00:09, 606.29it/s] 43%|██████████████████████████████▊                                         | 4176/9741 [00:07<00:09, 606.79it/s] 43%|███████████████████████████████▎                                        | 4237/9741 [00:07<00:09, 607.11it/s] 44%|███████████████████████████████▊                                        | 4298/9741 [00:07<00:08, 605.79it/s] 45%|████████████████████████████████▏                                       | 4360/9741 [00:07<00:08, 607.53it/s] 45%|████████████████████████████████▋                                       | 4421/9741 [00:07<00:08, 607.56it/s] 46%|█████████████████████████████████▏                                      | 4482/9741 [00:08<00:08, 607.92it/s] 47%|█████████████████████████████████▌                                      | 4543/9741 [00:08<00:09, 572.75it/s] 47%|██████████████████████████████████                                      | 4605/9741 [00:08<00:08, 583.56it/s] 48%|██████████████████████████████████▍                                     | 4666/9741 [00:08<00:08, 590.84it/s] 49%|██████████████████████████████████▉                                     | 4728/9741 [00:08<00:08, 596.92it/s] 49%|███████████████████████████████████▍                                    | 4788/9741 [00:08<00:10, 469.56it/s] 50%|███████████████████████████████████▊                                    | 4849/9741 [00:08<00:09, 503.61it/s] 50%|████████████████████████████████████▎                                   | 4910/9741 [00:08<00:09, 531.01it/s] 51%|████████████████████████████████████▋                                   | 4971/9741 [00:08<00:08, 550.29it/s] 52%|█████████████████████████████████████▏                                  | 5032/9741 [00:09<00:08, 566.78it/s] 52%|█████████████████████████████████████▋                                  | 5093/9741 [00:09<00:08, 577.57it/s] 53%|██████████████████████████████████████                                  | 5154/9741 [00:09<00:07, 586.64it/s] 54%|██████████████████████████████████████▌                                 | 5215/9741 [00:09<00:07, 591.67it/s] 54%|██████████████████████████████████████▉                                 | 5276/9741 [00:09<00:07, 596.13it/s] 55%|███████████████████████████████████████▍                                | 5337/9741 [00:09<00:07, 599.98it/s] 55%|███████████████████████████████████████▉                                | 5398/9741 [00:09<00:07, 600.69it/s] 56%|████████████████████████████████████████▎                               | 5459/9741 [00:09<00:07, 603.44it/s] 57%|████████████████████████████████████████▊                               | 5522/9741 [00:09<00:06, 610.47it/s] 57%|█████████████████████████████████████████▎                              | 5586/9741 [00:09<00:06, 617.27it/s] 58%|█████████████████████████████████████████▊                              | 5649/9741 [00:10<00:06, 619.37it/s] 59%|██████████████████████████████████████████▏                             | 5713/9741 [00:10<00:06, 623.25it/s] 59%|██████████████████████████████████████████▋                             | 5777/9741 [00:10<00:06, 626.15it/s] 60%|███████████████████████████████████████████▏                            | 5841/9741 [00:10<00:06, 628.22it/s] 61%|███████████████████████████████████████████▋                            | 5904/9741 [00:10<00:06, 627.35it/s] 61%|████████████████████████████████████████████                            | 5968/9741 [00:10<00:05, 629.05it/s] 62%|████████████████████████████████████████████▌                           | 6032/9741 [00:10<00:05, 630.46it/s] 63%|█████████████████████████████████████████████                           | 6096/9741 [00:10<00:05, 628.77it/s] 63%|█████████████████████████████████████████████▌                          | 6160/9741 [00:10<00:05, 629.66it/s] 64%|██████████████████████████████████████████████                          | 6224/9741 [00:10<00:05, 630.30it/s] 65%|██████████████████████████████████████████████▍                         | 6288/9741 [00:11<00:05, 630.77it/s] 65%|██████████████████████████████████████████████▉                         | 6352/9741 [00:11<00:05, 628.72it/s] 66%|███████████████████████████████████████████████▍                        | 6416/9741 [00:11<00:05, 629.94it/s] 67%|███████████████████████████████████████████████▉                        | 6480/9741 [00:11<00:05, 630.36it/s] 67%|████████████████████████████████████████████████▎                       | 6544/9741 [00:11<00:05, 628.91it/s] 68%|████████████████████████████████████████████████▊                       | 6607/9741 [00:11<00:04, 628.66it/s] 68%|█████████████████████████████████████████████████▎                      | 6671/9741 [00:11<00:04, 630.02it/s] 69%|█████████████████████████████████████████████████▊                      | 6735/9741 [00:11<00:04, 630.25it/s] 70%|██████████████████████████████████████████████████▎                     | 6799/9741 [00:11<00:04, 628.88it/s] 70%|██████████████████████████████████████████████████▋                     | 6863/9741 [00:11<00:04, 630.47it/s] 71%|███████████████████████████████████████████████████▏                    | 6927/9741 [00:12<00:04, 631.24it/s] 72%|███████████████████████████████████████████████████▋                    | 6991/9741 [00:12<00:04, 629.01it/s] 72%|████████████████████████████████████████████████████▏                   | 7055/9741 [00:12<00:04, 629.80it/s] 73%|████████████████████████████████████████████████████▌                   | 7119/9741 [00:12<00:04, 631.34it/s] 74%|█████████████████████████████████████████████████████                   | 7183/9741 [00:12<00:04, 631.92it/s] 74%|█████████████████████████████████████████████████████▌                  | 7247/9741 [00:12<00:03, 625.26it/s] 75%|██████████████████████████████████████████████████████                  | 7311/9741 [00:12<00:03, 626.84it/s] 76%|██████████████████████████████████████████████████████▌                 | 7375/9741 [00:12<00:03, 628.94it/s] 76%|██████████████████████████████████████████████████████▉                 | 7439/9741 [00:12<00:03, 600.53it/s] 77%|███████████████████████████████████████████████████████▍                | 7502/9741 [00:12<00:03, 608.70it/s] 78%|███████████████████████████████████████████████████████▉                | 7566/9741 [00:13<00:03, 615.28it/s] 78%|████████████████████████████████████████████████████████▍               | 7630/9741 [00:13<00:03, 620.66it/s] 79%|████████████████████████████████████████████████████████▊               | 7693/9741 [00:13<00:03, 621.45it/s] 80%|█████████████████████████████████████████████████████████▎              | 7757/9741 [00:13<00:03, 625.12it/s] 80%|█████████████████████████████████████████████████████████▊              | 7821/9741 [00:13<00:03, 627.60it/s] 81%|██████████████████████████████████████████████████████████▎             | 7885/9741 [00:13<00:02, 629.13it/s] 82%|██████████████████████████████████████████████████████████▋             | 7948/9741 [00:13<00:02, 628.29it/s] 82%|███████████████████████████████████████████████████████████▏            | 8012/9741 [00:13<00:02, 629.07it/s] 83%|███████████████████████████████████████████████████████████▋            | 8076/9741 [00:13<00:02, 630.05it/s] 84%|████████████████████████████████████████████████████████████▏           | 8140/9741 [00:14<00:02, 629.62it/s] 84%|████████████████████████████████████████████████████████████▋           | 8204/9741 [00:14<00:02, 630.48it/s] 85%|█████████████████████████████████████████████████████████████           | 8268/9741 [00:14<00:02, 625.47it/s] 86%|█████████████████████████████████████████████████████████████▌          | 8332/9741 [00:14<00:02, 627.22it/s] 86%|██████████████████████████████████████████████████████████████          | 8395/9741 [00:14<00:02, 626.20it/s] 87%|██████████████████████████████████████████████████████████████▌         | 8459/9741 [00:14<00:02, 628.51it/s] 87%|██████████████████████████████████████████████████████████████▉         | 8523/9741 [00:14<00:01, 629.77it/s] 88%|███████████████████████████████████████████████████████████████▍        | 8586/9741 [00:14<00:01, 627.99it/s] 89%|███████████████████████████████████████████████████████████████▉        | 8650/9741 [00:14<00:01, 628.94it/s] 89%|████████████████████████████████████████████████████████████████▍       | 8714/9741 [00:14<00:01, 629.28it/s] 90%|████████████████████████████████████████████████████████████████▉       | 8778/9741 [00:15<00:01, 630.13it/s] 91%|█████████████████████████████████████████████████████████████████▎      | 8842/9741 [00:15<00:01, 628.26it/s] 91%|█████████████████████████████████████████████████████████████████▊      | 8906/9741 [00:15<00:01, 629.71it/s] 92%|██████████████████████████████████████████████████████████████████▎     | 8970/9741 [00:15<00:01, 630.45it/s] 93%|██████████████████████████████████████████████████████████████████▊     | 9034/9741 [00:15<00:01, 628.34it/s] 93%|███████████████████████████████████████████████████████████████████▏    | 9098/9741 [00:15<00:01, 629.60it/s] 94%|███████████████████████████████████████████████████████████████████▋    | 9162/9741 [00:15<00:00, 630.54it/s] 95%|████████████████████████████████████████████████████████████████████▏   | 9226/9741 [00:15<00:00, 630.88it/s] 95%|████████████████████████████████████████████████████████████████████▋   | 9290/9741 [00:15<00:00, 629.37it/s] 96%|█████████████████████████████████████████████████████████████████████▏  | 9353/9741 [00:15<00:00, 625.70it/s] 97%|█████████████████████████████████████████████████████████████████████▌  | 9417/9741 [00:16<00:00, 627.57it/s] 97%|██████████████████████████████████████████████████████████████████████  | 9481/9741 [00:16<00:00, 629.04it/s] 98%|██████████████████████████████████████████████████████████████████████▌ | 9544/9741 [00:16<00:00, 626.61it/s] 99%|███████████████████████████████████████████████████████████████████████ | 9607/9741 [00:16<00:00, 627.12it/s] 99%|███████████████████████████████████████████████████████████████████████▍| 9670/9741 [00:16<00:00, 627.63it/s]100%|███████████████████████████████████████████████████████████████████████▉| 9733/9741 [00:16<00:00, 625.50it/s]100%|████████████████████████████████████████████████████████████████████████| 9741/9741 [00:16<00:00, 588.56it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:04<00:09,  4.99s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.14s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.26s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.46s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.10s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.06s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.36s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.48s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.51s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.65s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.48s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.64s/it]
[2023-08-14 02:44:16,849] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.74s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.90s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:15<00:00,  4.84s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.01s/it]
[2023-08-14 02:44:25,142] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-14 02:44:25,143] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-14 02:44:25,143] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-14 02:44:25,143] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-14 02:44:25,143] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-14 02:44:25,143] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-14 02:44:25,143] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-14 02:44:25,143] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-14 02:44:25,143] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-14 02:44:25,143] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-14 02:44:25,143] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-14 02:44:25,143] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f6e8b2bffd0>
[2023-08-14 02:44:25,143] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-14 02:44:25,143] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-14 02:44:25,143] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-14 02:44:25,143] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-14 02:44:25,143] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-14 02:44:25,143] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-14 02:44:25,143] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-14 02:44:25,143] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-14 02:44:25,143] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-14 02:44:25,143] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f6e6568bcd0>
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-14 02:44:25,144] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-14 02:44:25,144] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.43075037002563477 seconds
Time to load utils op: 0.40456509590148926 seconds
Loading extension module utils...
Time to load utils op: 0.30443668365478516 seconds
Loading extension module utils...
Time to load utils op: 0.5045137405395508 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                                           | 0/50 [00:00<?, ?it/s]############### Example ###############
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following multiple choice question.

### Demonstration:
Input: Mary had 89 stickers.  She used 3 large stickers on the front page of her journal and 7 stickers each to 6 other pages of her journal. How many stickers does Mary have remaining?
Answer: 44

Input: Zach is saving his money to buy a brand new bike that costs $100.  His weekly allowance is $5.  His parent will pay him an extra $10 to mow the lawn.  His neighbor will pay him $7 per hour to babysit their son.  He has already saved up $65.  He'll receive his allowance on Friday and he's planning on babysitting for 2 hours this Saturday after he mows the lawn.  How much more money does Zach need to earn before he can buy the bike?
Answer: 6

Input: Mark has kangaroos and goats.  Kangaroos have two legs and goats have four legs.  If he has 23 kangaroos and three times as many goats as kangaroos what is the total number of legs of all his animals?
Answer: 322

Input: Josh’s mom gives him $20 to go shopping at the mall. He buys a hat for $10 and a pencil for $2. Then he buys four cookies. If each cookie costs $1.25, how much money does Josh have left?
Answer: 3

Input: George's bowling team is one round away from breaking the league record for most points scored in a season. The old record is an average score per player of 287 per round. Each team has 4 players and there are 10 rounds in the season. Through the first 9 rounds, his team has scored a total of 10,440. How many points less than the current league record per game average is the minimum average they need to score, per player, in the final round to tie the league record?
Answer: 27

Input: Max was doing homework in three different subjects. It took him 20 minutes to finish tasks from biology and two times more time to finish history. Geography took him the most time, three times more than history. How much time did Max spend on doing his homework?
Answer: 180

Input: Sophia ate 1/6 of her pie and she put the rest on the fridge. If the pie left in the fridge weighs 1200 grams, how many grams did Sophia eat?
Answer: 240

Input: Sarah, Mary, and Tuan decided to go to the restaurant for a meal. They decided to split the cost of the meal evenly. If the total price of the meal comes to $67 and they have a coupon for $4, how much does each person need to contribute to the bill?
Answer: 21

Input: Tom's brother is 4 times as old as Tom's dog. If in 6 years, Tom's brother will be 30 years, how old is Tom's dog going to be in six years?
Answer: 12

Input: There are 50 children at the party. Three-fifths of them are boys. How many of the children are girls?
Answer: 20

Input: Gail has some bills in her wallet which amount to $100. She has four $5 bills and three $20 bills, and the rest are $10 bills. How many $10 bills are in her wallet?
Answer: 2

Input: A 220-liter barrel has a small leak. It lost 10% of its contents before anyone noticed. How many liters are left in the barrel?
Answer: 198

### Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid

### Response:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o12-tgsm8k-s1-rFalse
Evaluating commonsenseqa :   2%|█                                                  | 1/50 [00:45<37:22, 45.76s/it]Evaluating commonsenseqa :   4%|██                                                 | 2/50 [01:05<24:28, 30.60s/it]Evaluating commonsenseqa :   6%|███                                                | 3/50 [01:52<29:36, 37.79s/it]Evaluating commonsenseqa :   8%|████                                               | 4/50 [02:36<31:04, 40.54s/it]Evaluating commonsenseqa :  10%|█████                                              | 5/50 [03:21<31:37, 42.16s/it]Evaluating commonsenseqa :  12%|██████                                             | 6/50 [04:06<31:38, 43.16s/it]Evaluating commonsenseqa :  14%|███████▏                                           | 7/50 [04:45<29:53, 41.72s/it]Evaluating commonsenseqa :  16%|████████▏                                          | 8/50 [05:19<27:21, 39.08s/it]Evaluating commonsenseqa :  18%|█████████▏                                         | 9/50 [06:04<28:02, 41.04s/it]Evaluating commonsenseqa :  20%|██████████                                        | 10/50 [06:49<28:15, 42.40s/it]Evaluating commonsenseqa :  22%|███████████                                       | 11/50 [07:35<28:11, 43.38s/it]Evaluating commonsenseqa :  24%|████████████                                      | 12/50 [08:21<27:52, 44.02s/it]Evaluating commonsenseqa :  26%|█████████████                                     | 13/50 [09:07<27:35, 44.74s/it]Evaluating commonsenseqa :  28%|██████████████                                    | 14/50 [09:52<26:50, 44.74s/it]Evaluating commonsenseqa :  30%|███████████████                                   | 15/50 [10:36<26:04, 44.70s/it]Evaluating commonsenseqa :  32%|████████████████                                  | 16/50 [11:22<25:27, 44.94s/it]Evaluating commonsenseqa :  34%|█████████████████                                 | 17/50 [12:06<24:39, 44.84s/it]Evaluating commonsenseqa :  36%|██████████████████                                | 18/50 [12:51<23:55, 44.85s/it]Evaluating commonsenseqa :  38%|███████████████████                               | 19/50 [13:37<23:22, 45.25s/it]Evaluating commonsenseqa :  40%|████████████████████                              | 20/50 [14:13<21:12, 42.42s/it]Evaluating commonsenseqa :  42%|█████████████████████                             | 21/50 [14:58<20:47, 43.01s/it]Evaluating commonsenseqa :  44%|██████████████████████                            | 22/50 [15:42<20:16, 43.44s/it]Evaluating commonsenseqa :  46%|███████████████████████                           | 23/50 [16:14<17:59, 39.97s/it]Evaluating commonsenseqa :  48%|████████████████████████                          | 24/50 [16:59<17:54, 41.34s/it]Evaluating commonsenseqa :  50%|█████████████████████████                         | 25/50 [17:44<17:45, 42.63s/it]Evaluating commonsenseqa :  52%|██████████████████████████                        | 26/50 [18:30<17:26, 43.60s/it]Evaluating commonsenseqa :  54%|███████████████████████████                       | 27/50 [19:15<16:54, 44.11s/it]Evaluating commonsenseqa :  56%|████████████████████████████                      | 28/50 [20:01<16:21, 44.59s/it]Evaluating commonsenseqa :  58%|████████████████████████████▉                     | 29/50 [20:46<15:38, 44.68s/it]Evaluating commonsenseqa :  60%|██████████████████████████████                    | 30/50 [21:31<14:56, 44.83s/it]Evaluating commonsenseqa :  62%|███████████████████████████████                   | 31/50 [21:53<12:00, 37.90s/it]Evaluating commonsenseqa :  64%|████████████████████████████████                  | 32/50 [22:34<11:39, 38.89s/it]Evaluating commonsenseqa :  66%|█████████████████████████████████                 | 33/50 [23:20<11:38, 41.08s/it]Evaluating commonsenseqa :  68%|██████████████████████████████████                | 34/50 [23:34<08:45, 32.87s/it]Evaluating commonsenseqa :  70%|███████████████████████████████████               | 35/50 [24:19<09:06, 36.42s/it]Evaluating commonsenseqa :  72%|████████████████████████████████████              | 36/50 [25:04<09:05, 38.97s/it]Evaluating commonsenseqa :  74%|█████████████████████████████████████             | 37/50 [25:50<08:55, 41.18s/it]Evaluating commonsenseqa :  76%|██████████████████████████████████████            | 38/50 [26:36<08:30, 42.57s/it]Evaluating commonsenseqa :  78%|███████████████████████████████████████           | 39/50 [27:10<07:19, 39.97s/it]Evaluating commonsenseqa :  80%|████████████████████████████████████████          | 40/50 [27:55<06:55, 41.58s/it]Evaluating commonsenseqa :  82%|█████████████████████████████████████████         | 41/50 [28:41<06:27, 43.04s/it]Evaluating commonsenseqa :  84%|██████████████████████████████████████████        | 42/50 [29:26<05:49, 43.65s/it]Evaluating commonsenseqa :  86%|███████████████████████████████████████████       | 43/50 [29:56<04:36, 39.54s/it]Evaluating commonsenseqa :  88%|████████████████████████████████████████████      | 44/50 [30:41<04:06, 41.10s/it]Evaluating commonsenseqa :  90%|█████████████████████████████████████████████     | 45/50 [31:27<03:32, 42.43s/it]Evaluating commonsenseqa :  92%|██████████████████████████████████████████████    | 46/50 [32:13<02:54, 43.61s/it]Evaluating commonsenseqa :  94%|███████████████████████████████████████████████   | 47/50 [32:54<02:08, 42.71s/it]Evaluating commonsenseqa :  96%|████████████████████████████████████████████████  | 48/50 [33:39<01:27, 43.56s/it]Evaluating commonsenseqa :  98%|█████████████████████████████████████████████████ | 49/50 [33:53<00:34, 34.51s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████| 50/50 [34:37<00:00, 37.62s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████| 50/50 [34:37<00:00, 41.56s/it]
name: commonsenseqa | {'exact_match': 0.4, 'rougeL': 3.1241} | lm_loss 7.8469 | avg. gen lenth: 266.9
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name gsm8k --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/out-domain/o13-tgsm8k-s1-rFalse --seed 1 --num-out-domain 13
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-14 03:19:42,378] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/out-domain/o13-tgsm8k-s1-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 13
  out_domain_data_name ......... gsm8k
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o13-tgsm8k-s1-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                    | 0/9741 [00:00<?, ?it/s]  0%|▎                                                                         | 39/9741 [00:00<00:25, 383.40it/s]  1%|▌                                                                         | 78/9741 [00:00<00:25, 385.15it/s]  1%|▉                                                                        | 117/9741 [00:00<00:24, 386.65it/s]  2%|█▏                                                                       | 156/9741 [00:00<00:24, 387.11it/s]  2%|█▍                                                                       | 195/9741 [00:00<00:24, 386.65it/s]  2%|█▊                                                                       | 234/9741 [00:00<00:24, 384.55it/s]  3%|██                                                                       | 273/9741 [00:00<00:24, 379.44it/s]  3%|██▎                                                                      | 312/9741 [00:00<00:24, 380.45it/s]  4%|██▋                                                                      | 351/9741 [00:00<00:24, 381.60it/s]  4%|██▉                                                                      | 390/9741 [00:01<00:24, 383.15it/s]  4%|███▏                                                                     | 429/9741 [00:01<00:24, 382.05it/s]  5%|███▌                                                                     | 468/9741 [00:01<00:24, 383.27it/s]  5%|███▊                                                                     | 507/9741 [00:01<00:24, 384.18it/s]  6%|████                                                                     | 546/9741 [00:01<00:23, 384.75it/s]  6%|████▍                                                                    | 585/9741 [00:01<00:23, 384.42it/s]  7%|████▊                                                                    | 635/9741 [00:01<00:21, 418.41it/s]  7%|█████▏                                                                   | 691/9741 [00:01<00:19, 460.12it/s]  8%|█████▌                                                                   | 749/9741 [00:01<00:18, 495.36it/s]  8%|██████                                                                   | 807/9741 [00:01<00:17, 520.11it/s]  9%|██████▍                                                                  | 866/9741 [00:02<00:16, 539.26it/s]  9%|██████▉                                                                  | 924/9741 [00:02<00:16, 549.34it/s] 10%|███████▎                                                                 | 983/9741 [00:02<00:15, 559.29it/s] 11%|███████▋                                                                | 1042/9741 [00:02<00:15, 566.37it/s] 11%|████████▏                                                               | 1101/9741 [00:02<00:15, 571.11it/s] 12%|████████▌                                                               | 1159/9741 [00:02<00:15, 571.30it/s] 12%|████████▉                                                               | 1217/9741 [00:02<00:14, 573.70it/s] 13%|█████████▍                                                              | 1275/9741 [00:02<00:14, 575.41it/s] 14%|█████████▊                                                              | 1334/9741 [00:02<00:14, 577.00it/s] 14%|██████████▎                                                             | 1392/9741 [00:02<00:14, 575.32it/s] 15%|██████████▋                                                             | 1450/9741 [00:03<00:14, 576.68it/s] 15%|███████████▏                                                            | 1508/9741 [00:03<00:14, 577.25it/s] 16%|███████████▌                                                            | 1566/9741 [00:03<00:14, 575.85it/s] 17%|████████████                                                            | 1624/9741 [00:03<00:14, 576.77it/s] 17%|████████████▍                                                           | 1683/9741 [00:03<00:13, 577.69it/s] 18%|████████████▊                                                           | 1741/9741 [00:03<00:13, 576.77it/s] 18%|█████████████▎                                                          | 1799/9741 [00:03<00:14, 553.68it/s] 19%|█████████████▋                                                          | 1857/9741 [00:03<00:14, 561.22it/s] 20%|██████████████▏                                                         | 1915/9741 [00:03<00:13, 566.21it/s] 20%|██████████████▌                                                         | 1973/9741 [00:03<00:13, 568.73it/s] 21%|███████████████                                                         | 2031/9741 [00:04<00:13, 569.66it/s] 21%|███████████████▍                                                        | 2089/9741 [00:04<00:13, 571.56it/s] 22%|███████████████▊                                                        | 2147/9741 [00:04<00:13, 574.03it/s] 23%|████████████████▎                                                       | 2205/9741 [00:04<00:13, 572.84it/s] 23%|████████████████▋                                                       | 2263/9741 [00:04<00:13, 571.81it/s] 24%|█████████████████▏                                                      | 2321/9741 [00:04<00:12, 573.08it/s] 24%|█████████████████▌                                                      | 2379/9741 [00:04<00:12, 574.00it/s] 25%|██████████████████                                                      | 2437/9741 [00:04<00:12, 575.67it/s] 26%|██████████████████▍                                                     | 2495/9741 [00:04<00:12, 573.29it/s] 26%|██████████████████▊                                                     | 2553/9741 [00:04<00:12, 574.27it/s] 27%|███████████████████▎                                                    | 2612/9741 [00:05<00:12, 576.11it/s] 27%|███████████████████▋                                                    | 2670/9741 [00:05<00:12, 576.42it/s] 28%|████████████████████▏                                                   | 2728/9741 [00:05<00:12, 573.79it/s] 29%|████████████████████▌                                                   | 2786/9741 [00:05<00:12, 574.18it/s] 29%|█████████████████████                                                   | 2844/9741 [00:05<00:11, 574.82it/s] 30%|█████████████████████▍                                                  | 2903/9741 [00:05<00:11, 576.49it/s] 30%|█████████████████████▉                                                  | 2961/9741 [00:05<00:11, 568.20it/s] 31%|██████████████████████▎                                                 | 3019/9741 [00:05<00:11, 570.80it/s] 32%|██████████████████████▋                                                 | 3077/9741 [00:05<00:11, 572.02it/s] 32%|███████████████████████▏                                                | 3135/9741 [00:05<00:11, 573.60it/s] 33%|███████████████████████▌                                                | 3193/9741 [00:06<00:11, 572.62it/s] 33%|████████████████████████                                                | 3251/9741 [00:06<00:11, 574.71it/s] 34%|████████████████████████▍                                               | 3309/9741 [00:06<00:11, 575.33it/s] 35%|████████████████████████▉                                               | 3367/9741 [00:06<00:11, 575.39it/s] 35%|█████████████████████████▎                                              | 3425/9741 [00:06<00:11, 573.75it/s] 36%|█████████████████████████▋                                              | 3483/9741 [00:06<00:10, 573.78it/s] 36%|██████████████████████████▏                                             | 3541/9741 [00:06<00:10, 574.05it/s] 37%|██████████████████████████▌                                             | 3599/9741 [00:06<00:10, 574.41it/s] 38%|███████████████████████████                                             | 3657/9741 [00:06<00:10, 570.82it/s] 38%|███████████████████████████▍                                            | 3715/9741 [00:06<00:10, 566.67it/s] 39%|███████████████████████████▉                                            | 3773/9741 [00:07<00:10, 568.04it/s] 39%|████████████████████████████▎                                           | 3831/9741 [00:07<00:10, 570.26it/s] 40%|████████████████████████████▋                                           | 3889/9741 [00:07<00:10, 569.21it/s] 41%|█████████████████████████████▏                                          | 3947/9741 [00:07<00:10, 570.97it/s] 41%|█████████████████████████████▌                                          | 4005/9741 [00:07<00:10, 572.90it/s] 42%|██████████████████████████████                                          | 4063/9741 [00:07<00:09, 571.66it/s] 42%|██████████████████████████████▍                                         | 4121/9741 [00:07<00:09, 573.36it/s] 43%|██████████████████████████████▉                                         | 4179/9741 [00:07<00:09, 574.24it/s] 43%|███████████████████████████████▎                                        | 4237/9741 [00:07<00:09, 574.45it/s] 44%|███████████████████████████████▋                                        | 4295/9741 [00:08<00:09, 571.70it/s] 45%|████████████████████████████████▏                                       | 4353/9741 [00:08<00:09, 572.98it/s] 45%|████████████████████████████████▌                                       | 4411/9741 [00:08<00:09, 574.31it/s] 46%|█████████████████████████████████                                       | 4469/9741 [00:08<00:09, 569.92it/s] 46%|█████████████████████████████████▍                                      | 4527/9741 [00:08<00:09, 522.78it/s] 47%|█████████████████████████████████▉                                      | 4585/9741 [00:08<00:09, 537.97it/s] 48%|██████████████████████████████████▎                                     | 4643/9741 [00:08<00:09, 548.80it/s] 48%|██████████████████████████████████▋                                     | 4701/9741 [00:08<00:09, 557.01it/s] 49%|███████████████████████████████████▏                                    | 4758/9741 [00:08<00:12, 399.83it/s] 49%|███████████████████████████████████▌                                    | 4816/9741 [00:09<00:11, 439.93it/s] 50%|████████████████████████████████████                                    | 4874/9741 [00:09<00:10, 472.59it/s] 51%|████████████████████████████████████▍                                   | 4932/9741 [00:09<00:09, 499.59it/s] 51%|████████████████████████████████████▉                                   | 4989/9741 [00:09<00:09, 517.88it/s] 52%|█████████████████████████████████████▎                                  | 5047/9741 [00:09<00:08, 533.63it/s] 52%|█████████████████████████████████████▋                                  | 5105/9741 [00:09<00:08, 545.25it/s] 53%|██████████████████████████████████████▏                                 | 5163/9741 [00:09<00:08, 554.41it/s] 54%|██████████████████████████████████████▌                                 | 5220/9741 [00:09<00:08, 557.93it/s] 54%|███████████████████████████████████████                                 | 5278/9741 [00:09<00:07, 562.68it/s] 55%|███████████████████████████████████████▍                                | 5336/9741 [00:09<00:07, 565.55it/s] 55%|███████████████████████████████████████▊                                | 5394/9741 [00:10<00:07, 567.76it/s] 56%|████████████████████████████████████████▎                               | 5452/9741 [00:10<00:07, 567.23it/s] 57%|████████████████████████████████████████▋                               | 5511/9741 [00:10<00:07, 573.63it/s] 57%|█████████████████████████████████████████▏                              | 5571/9741 [00:10<00:07, 581.26it/s] 58%|█████████████████████████████████████████▌                              | 5630/9741 [00:10<00:07, 583.15it/s] 58%|██████████████████████████████████████████                              | 5690/9741 [00:10<00:06, 587.32it/s] 59%|██████████████████████████████████████████▌                             | 5750/9741 [00:10<00:06, 590.49it/s] 60%|██████████████████████████████████████████▉                             | 5810/9741 [00:10<00:06, 592.73it/s] 60%|███████████████████████████████████████████▍                            | 5870/9741 [00:10<00:06, 591.56it/s] 61%|███████████████████████████████████████████▊                            | 5930/9741 [00:11<00:06, 593.96it/s] 61%|████████████████████████████████████████████▎                           | 5990/9741 [00:11<00:06, 594.69it/s] 62%|████████████████████████████████████████████▋                           | 6050/9741 [00:11<00:06, 595.45it/s] 63%|█████████████████████████████████████████████▏                          | 6110/9741 [00:11<00:06, 593.65it/s] 63%|█████████████████████████████████████████████▌                          | 6170/9741 [00:11<00:06, 594.82it/s] 64%|██████████████████████████████████████████████                          | 6230/9741 [00:11<00:05, 595.32it/s] 65%|██████████████████████████████████████████████▍                         | 6290/9741 [00:11<00:05, 596.20it/s] 65%|██████████████████████████████████████████████▉                         | 6350/9741 [00:11<00:05, 593.88it/s] 66%|███████████████████████████████████████████████▍                        | 6410/9741 [00:11<00:05, 595.01it/s] 66%|███████████████████████████████████████████████▊                        | 6470/9741 [00:11<00:05, 595.30it/s] 67%|████████████████████████████████████████████████▎                       | 6530/9741 [00:12<00:05, 595.12it/s] 68%|████████████████████████████████████████████████▋                       | 6590/9741 [00:12<00:05, 593.57it/s] 68%|█████████████████████████████████████████████████▏                      | 6650/9741 [00:12<00:05, 593.27it/s] 69%|█████████████████████████████████████████████████▌                      | 6710/9741 [00:12<00:05, 594.85it/s] 70%|██████████████████████████████████████████████████                      | 6770/9741 [00:12<00:05, 593.87it/s] 70%|██████████████████████████████████████████████████▍                     | 6830/9741 [00:12<00:04, 595.35it/s] 71%|██████████████████████████████████████████████████▉                     | 6890/9741 [00:12<00:04, 595.95it/s] 71%|███████████████████████████████████████████████████▎                    | 6950/9741 [00:12<00:04, 596.49it/s] 72%|███████████████████████████████████████████████████▊                    | 7010/9741 [00:12<00:04, 594.61it/s] 73%|████████████████████████████████████████████████████▎                   | 7070/9741 [00:12<00:04, 595.89it/s] 73%|████████████████████████████████████████████████████▋                   | 7130/9741 [00:13<00:04, 596.70it/s] 74%|█████████████████████████████████████████████████████▏                  | 7190/9741 [00:13<00:04, 597.52it/s] 74%|█████████████████████████████████████████████████████▌                  | 7250/9741 [00:13<00:04, 594.96it/s] 75%|██████████████████████████████████████████████████████                  | 7310/9741 [00:13<00:04, 591.85it/s] 76%|██████████████████████████████████████████████████████▍                 | 7370/9741 [00:13<00:03, 592.75it/s] 76%|██████████████████████████████████████████████████████▉                 | 7430/9741 [00:13<00:03, 594.69it/s] 77%|███████████████████████████████████████████████████████▎                | 7490/9741 [00:13<00:03, 563.88it/s] 78%|███████████████████████████████████████████████████████▊                | 7550/9741 [00:13<00:03, 573.01it/s] 78%|████████████████████████████████████████████████████████▏               | 7610/9741 [00:13<00:03, 579.87it/s] 79%|████████████████████████████████████████████████████████▋               | 7669/9741 [00:13<00:03, 582.13it/s] 79%|█████████████████████████████████████████████████████████▏              | 7729/9741 [00:14<00:03, 585.88it/s] 80%|█████████████████████████████████████████████████████████▌              | 7789/9741 [00:14<00:03, 587.75it/s] 81%|██████████████████████████████████████████████████████████              | 7849/9741 [00:14<00:03, 590.45it/s] 81%|██████████████████████████████████████████████████████████▍             | 7909/9741 [00:14<00:03, 589.68it/s] 82%|██████████████████████████████████████████████████████████▉             | 7969/9741 [00:14<00:03, 589.69it/s] 82%|███████████████████████████████████████████████████████████▎            | 8029/9741 [00:14<00:02, 589.89it/s] 83%|███████████████████████████████████████████████████████████▊            | 8089/9741 [00:14<00:02, 592.14it/s] 84%|████████████████████████████████████████████████████████████▏           | 8149/9741 [00:14<00:02, 591.97it/s] 84%|████████████████████████████████████████████████████████████▋           | 8209/9741 [00:14<00:02, 593.82it/s] 85%|█████████████████████████████████████████████████████████████           | 8269/9741 [00:14<00:02, 594.85it/s] 86%|█████████████████████████████████████████████████████████████▌          | 8329/9741 [00:15<00:02, 594.03it/s] 86%|██████████████████████████████████████████████████████████████          | 8389/9741 [00:15<00:02, 592.75it/s] 87%|██████████████████████████████████████████████████████████████▍         | 8449/9741 [00:15<00:02, 594.75it/s] 87%|██████████████████████████████████████████████████████████████▉         | 8509/9741 [00:15<00:02, 595.56it/s] 88%|███████████████████████████████████████████████████████████████▎        | 8569/9741 [00:15<00:01, 595.70it/s] 89%|███████████████████████████████████████████████████████████████▊        | 8629/9741 [00:15<00:01, 593.57it/s] 89%|████████████████████████████████████████████████████████████████▏       | 8689/9741 [00:15<00:01, 594.60it/s] 90%|████████████████████████████████████████████████████████████████▋       | 8749/9741 [00:15<00:01, 595.39it/s] 90%|█████████████████████████████████████████████████████████████████       | 8809/9741 [00:15<00:01, 592.17it/s] 91%|█████████████████████████████████████████████████████████████████▌      | 8869/9741 [00:15<00:01, 591.77it/s] 92%|█████████████████████████████████████████████████████████████████▉      | 8929/9741 [00:16<00:01, 593.14it/s] 92%|██████████████████████████████████████████████████████████████████▍     | 8989/9741 [00:16<00:01, 593.87it/s] 93%|██████████████████████████████████████████████████████████████████▉     | 9049/9741 [00:16<00:01, 592.16it/s] 94%|███████████████████████████████████████████████████████████████████▎    | 9109/9741 [00:16<00:01, 593.70it/s] 94%|███████████████████████████████████████████████████████████████████▊    | 9169/9741 [00:16<00:00, 594.80it/s] 95%|████████████████████████████████████████████████████████████████████▏   | 9229/9741 [00:16<00:00, 595.11it/s] 95%|████████████████████████████████████████████████████████████████████▋   | 9289/9741 [00:16<00:00, 593.38it/s] 96%|█████████████████████████████████████████████████████████████████████   | 9349/9741 [00:16<00:00, 593.12it/s] 97%|█████████████████████████████████████████████████████████████████████▌  | 9409/9741 [00:16<00:00, 593.77it/s] 97%|█████████████████████████████████████████████████████████████████████▉  | 9469/9741 [00:16<00:00, 594.17it/s] 98%|██████████████████████████████████████████████████████████████████████▍ | 9529/9741 [00:17<00:00, 590.78it/s] 98%|██████████████████████████████████████████████████████████████████████▉ | 9589/9741 [00:17<00:00, 589.06it/s] 99%|███████████████████████████████████████████████████████████████████████▎| 9649/9741 [00:17<00:00, 590.02it/s]100%|███████████████████████████████████████████████████████████████████████▊| 9709/9741 [00:17<00:00, 589.44it/s]100%|████████████████████████████████████████████████████████████████████████| 9741/9741 [00:17<00:00, 558.54it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.07s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:04<00:09,  4.98s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.29s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:11,  5.51s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:09<00:04,  4.88s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.08s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:12<00:06,  6.13s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.30s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.47s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.54s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.68s/it]
[2023-08-14 03:20:51,420] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.46s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.13s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.31s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:15<00:00,  4.83s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.01s/it]
[2023-08-14 03:21:13,258] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-14 03:21:13,260] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-14 03:21:13,260] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-14 03:21:13,260] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-14 03:21:13,260] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-14 03:21:13,261] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-14 03:21:13,261] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-14 03:21:13,261] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-14 03:21:13,261] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-14 03:21:13,261] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-14 03:21:13,261] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-14 03:21:13,261] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f646effffd0>
[2023-08-14 03:21:13,261] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-14 03:21:13,261] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-14 03:21:13,261] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-14 03:21:13,261] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-14 03:21:13,261] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-14 03:21:13,261] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-14 03:21:13,261] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-14 03:21:13,262] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-14 03:21:13,262] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-14 03:21:13,262] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-14 03:21:13,262] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-14 03:21:13,262] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-14 03:21:13,262] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-14 03:21:13,262] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-14 03:21:13,262] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-14 03:21:13,262] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-14 03:21:13,262] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-14 03:21:13,262] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-14 03:21:13,262] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-14 03:21:13,262] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-14 03:21:13,262] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-14 03:21:13,262] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-14 03:21:13,262] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-14 03:21:13,262] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-14 03:21:13,262] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-14 03:21:13,262] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-14 03:21:13,262] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-14 03:21:13,262] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-14 03:21:13,262] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-14 03:21:13,262] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-14 03:21:13,262] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-14 03:21:13,262] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-14 03:21:13,262] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f64642f1be0>
[2023-08-14 03:21:13,262] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-14 03:21:13,262] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-14 03:21:13,262] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-14 03:21:13,262] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-14 03:21:13,263] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-14 03:21:13,263] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-14 03:21:13,263] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-14 03:21:13,263] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-14 03:21:13,263] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-14 03:21:13,263] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-14 03:21:13,263] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-14 03:21:13,263] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-14 03:21:13,263] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-14 03:21:13,263] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-14 03:21:13,263] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-14 03:21:13,263] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-14 03:21:13,263] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-14 03:21:13,263] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-14 03:21:13,263] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-14 03:21:13,263] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-14 03:21:13,263] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-14 03:21:13,263] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-14 03:21:13,263] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.5189814567565918 seconds
Loading extension module utils...
Time to load utils op: 0.5067031383514404 seconds
Loading extension module utils...
Time to load utils op: 0.5073578357696533 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                                           | 0/50 [00:00<?, ?it/s]############### Example ###############
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following multiple choice question.

### Demonstration:
Input: Mary had 89 stickers.  She used 3 large stickers on the front page of her journal and 7 stickers each to 6 other pages of her journal. How many stickers does Mary have remaining?
Answer: 44

Input: Zach is saving his money to buy a brand new bike that costs $100.  His weekly allowance is $5.  His parent will pay him an extra $10 to mow the lawn.  His neighbor will pay him $7 per hour to babysit their son.  He has already saved up $65.  He'll receive his allowance on Friday and he's planning on babysitting for 2 hours this Saturday after he mows the lawn.  How much more money does Zach need to earn before he can buy the bike?
Answer: 6

Input: Mark has kangaroos and goats.  Kangaroos have two legs and goats have four legs.  If he has 23 kangaroos and three times as many goats as kangaroos what is the total number of legs of all his animals?
Answer: 322

Input: Josh’s mom gives him $20 to go shopping at the mall. He buys a hat for $10 and a pencil for $2. Then he buys four cookies. If each cookie costs $1.25, how much money does Josh have left?
Answer: 3

Input: George's bowling team is one round away from breaking the league record for most points scored in a season. The old record is an average score per player of 287 per round. Each team has 4 players and there are 10 rounds in the season. Through the first 9 rounds, his team has scored a total of 10,440. How many points less than the current league record per game average is the minimum average they need to score, per player, in the final round to tie the league record?
Answer: 27

Input: Max was doing homework in three different subjects. It took him 20 minutes to finish tasks from biology and two times more time to finish history. Geography took him the most time, three times more than history. How much time did Max spend on doing his homework?
Answer: 180

Input: Sophia ate 1/6 of her pie and she put the rest on the fridge. If the pie left in the fridge weighs 1200 grams, how many grams did Sophia eat?
Answer: 240

Input: Sarah, Mary, and Tuan decided to go to the restaurant for a meal. They decided to split the cost of the meal evenly. If the total price of the meal comes to $67 and they have a coupon for $4, how much does each person need to contribute to the bill?
Answer: 21

Input: Tom's brother is 4 times as old as Tom's dog. If in 6 years, Tom's brother will be 30 years, how old is Tom's dog going to be in six years?
Answer: 12

Input: There are 50 children at the party. Three-fifths of them are boys. How many of the children are girls?
Answer: 20

Input: Gail has some bills in her wallet which amount to $100. She has four $5 bills and three $20 bills, and the rest are $10 bills. How many $10 bills are in her wallet?
Answer: 2

Input: A 220-liter barrel has a small leak. It lost 10% of its contents before anyone noticed. How many liters are left in the barrel?
Answer: 198

Input: Markese earned 5 fewer dollars than Evan. Together they earned $37. How many dollars did Markese earn? Use E to represent how many dollars Evan earned.
Answer: 16

### Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid

### Response:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o13-tgsm8k-s1-rFalse
Loading extension module utils...
Time to load utils op: 0.5045952796936035 seconds
Evaluating commonsenseqa :   2%|█                                                  | 1/50 [00:46<37:36, 46.05s/it]Evaluating commonsenseqa :   4%|██                                                 | 2/50 [01:31<36:38, 45.80s/it]Evaluating commonsenseqa :   6%|███                                                | 3/50 [02:16<35:39, 45.52s/it]Evaluating commonsenseqa :   8%|████                                               | 4/50 [03:01<34:29, 44.99s/it]Evaluating commonsenseqa :  10%|█████                                              | 5/50 [03:46<33:56, 45.26s/it]Evaluating commonsenseqa :  12%|██████                                             | 6/50 [04:31<33:07, 45.18s/it]Evaluating commonsenseqa :  14%|███████▏                                           | 7/50 [05:06<29:50, 41.64s/it]Evaluating commonsenseqa :  16%|████████▏                                          | 8/50 [05:51<29:59, 42.83s/it]Evaluating commonsenseqa :  18%|█████████▏                                         | 9/50 [06:37<29:59, 43.88s/it]Evaluating commonsenseqa :  20%|██████████                                        | 10/50 [07:22<29:31, 44.29s/it]Evaluating commonsenseqa :  22%|███████████                                       | 11/50 [08:07<28:46, 44.28s/it]Evaluating commonsenseqa :  24%|████████████                                      | 12/50 [08:45<26:52, 42.44s/it]Evaluating commonsenseqa :  26%|█████████████                                     | 13/50 [09:30<26:42, 43.32s/it]Evaluating commonsenseqa :  28%|██████████████                                    | 14/50 [10:16<26:20, 43.90s/it]Evaluating commonsenseqa :  30%|███████████████                                   | 15/50 [10:42<22:32, 38.65s/it]Evaluating commonsenseqa :  32%|████████████████                                  | 16/50 [11:28<23:05, 40.75s/it]Evaluating commonsenseqa :  34%|█████████████████                                 | 17/50 [12:13<23:10, 42.13s/it]Evaluating commonsenseqa :  36%|██████████████████                                | 18/50 [12:58<22:53, 42.91s/it]Evaluating commonsenseqa :  38%|███████████████████                               | 19/50 [13:43<22:30, 43.56s/it]Evaluating commonsenseqa :  40%|████████████████████                              | 20/50 [14:16<20:12, 40.42s/it]Evaluating commonsenseqa :  42%|█████████████████████                             | 21/50 [15:02<20:18, 42.00s/it]Evaluating commonsenseqa :  44%|██████████████████████                            | 22/50 [15:46<19:58, 42.81s/it]Evaluating commonsenseqa :  46%|███████████████████████                           | 23/50 [16:31<19:34, 43.51s/it]Evaluating commonsenseqa :  48%|████████████████████████                          | 24/50 [17:16<19:03, 43.99s/it]Evaluating commonsenseqa :  50%|█████████████████████████                         | 25/50 [18:01<18:24, 44.17s/it]Evaluating commonsenseqa :  52%|██████████████████████████                        | 26/50 [18:33<16:11, 40.48s/it]Evaluating commonsenseqa :  54%|███████████████████████████                       | 27/50 [19:18<16:01, 41.83s/it]Evaluating commonsenseqa :  56%|████████████████████████████                      | 28/50 [20:03<15:43, 42.88s/it]Evaluating commonsenseqa :  58%|████████████████████████████▉                     | 29/50 [20:49<15:18, 43.73s/it]Evaluating commonsenseqa :  60%|██████████████████████████████                    | 30/50 [21:34<14:44, 44.21s/it]Evaluating commonsenseqa :  62%|███████████████████████████████                   | 31/50 [22:17<13:53, 43.88s/it]Evaluating commonsenseqa :  64%|████████████████████████████████                  | 32/50 [23:03<13:18, 44.37s/it]Evaluating commonsenseqa :  66%|█████████████████████████████████                 | 33/50 [23:48<12:36, 44.52s/it]Evaluating commonsenseqa :  68%|██████████████████████████████████                | 34/50 [24:02<09:28, 35.54s/it]Evaluating commonsenseqa :  70%|███████████████████████████████████               | 35/50 [24:48<09:40, 38.71s/it]Evaluating commonsenseqa :  72%|████████████████████████████████████              | 36/50 [25:33<09:28, 40.60s/it]Evaluating commonsenseqa :  74%|█████████████████████████████████████             | 37/50 [26:19<09:05, 42.00s/it]Evaluating commonsenseqa :  76%|██████████████████████████████████████            | 38/50 [27:05<08:40, 43.37s/it]Evaluating commonsenseqa :  78%|███████████████████████████████████████           | 39/50 [27:51<08:05, 44.16s/it]Evaluating commonsenseqa :  80%|████████████████████████████████████████          | 40/50 [28:19<06:30, 39.08s/it]Evaluating commonsenseqa :  82%|█████████████████████████████████████████         | 41/50 [28:46<05:19, 35.54s/it]Evaluating commonsenseqa :  84%|██████████████████████████████████████████        | 42/50 [29:32<05:08, 38.62s/it]Evaluating commonsenseqa :  86%|███████████████████████████████████████████       | 43/50 [30:17<04:44, 40.57s/it]Evaluating commonsenseqa :  88%|████████████████████████████████████████████      | 44/50 [31:02<04:11, 41.98s/it]Evaluating commonsenseqa :  90%|█████████████████████████████████████████████     | 45/50 [31:47<03:34, 42.82s/it]Evaluating commonsenseqa :  92%|██████████████████████████████████████████████    | 46/50 [32:33<02:54, 43.71s/it]Evaluating commonsenseqa :  94%|███████████████████████████████████████████████   | 47/50 [33:17<02:12, 44.00s/it]Evaluating commonsenseqa :  96%|████████████████████████████████████████████████  | 48/50 [33:28<01:08, 34.14s/it]Evaluating commonsenseqa :  98%|█████████████████████████████████████████████████ | 49/50 [34:13<00:37, 37.31s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████| 50/50 [34:59<00:00, 39.88s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████| 50/50 [34:59<00:00, 41.99s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 3.6217} | lm_loss 7.9102 | avg. gen lenth: 236.812
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name gsm8k --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/out-domain/o14-tgsm8k-s1-rFalse --seed 1 --num-out-domain 14
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-14 03:57:06,094] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/out-domain/o14-tgsm8k-s1-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 14
  out_domain_data_name ......... gsm8k
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o14-tgsm8k-s1-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                    | 0/9741 [00:00<?, ?it/s]  0%|▏                                                                         | 31/9741 [00:00<00:32, 302.36it/s]  1%|▍                                                                         | 62/9741 [00:00<00:31, 303.93it/s]  1%|▋                                                                         | 93/9741 [00:00<00:31, 305.53it/s]  1%|▉                                                                        | 124/9741 [00:00<00:31, 307.08it/s]  2%|█▏                                                                       | 155/9741 [00:00<00:31, 307.34it/s]  2%|█▍                                                                       | 186/9741 [00:00<00:31, 306.62it/s]  2%|█▋                                                                       | 217/9741 [00:00<00:31, 299.55it/s]  3%|█▊                                                                       | 248/9741 [00:00<00:31, 301.43it/s]  3%|██                                                                       | 279/9741 [00:00<00:31, 302.93it/s]  3%|██▎                                                                      | 310/9741 [00:01<00:30, 304.29it/s]  4%|██▌                                                                      | 341/9741 [00:01<00:30, 304.57it/s]  4%|██▊                                                                      | 372/9741 [00:01<00:30, 304.85it/s]  4%|███                                                                      | 403/9741 [00:01<00:30, 304.73it/s]  4%|███▎                                                                     | 434/9741 [00:01<00:30, 303.44it/s]  5%|███▍                                                                     | 465/9741 [00:01<00:30, 304.03it/s]  5%|███▋                                                                     | 496/9741 [00:01<00:30, 304.18it/s]  5%|████                                                                     | 534/9741 [00:01<00:28, 326.20it/s]  6%|████▎                                                                    | 581/9741 [00:01<00:24, 367.29it/s]  6%|████▋                                                                    | 628/9741 [00:01<00:23, 395.94it/s]  7%|█████                                                                    | 674/9741 [00:02<00:21, 414.27it/s]  7%|█████▍                                                                   | 721/9741 [00:02<00:20, 430.03it/s]  8%|█████▊                                                                   | 768/9741 [00:02<00:20, 440.37it/s]  8%|██████                                                                   | 815/9741 [00:02<00:19, 447.55it/s]  9%|██████▍                                                                  | 862/9741 [00:02<00:19, 452.74it/s]  9%|██████▊                                                                  | 908/9741 [00:02<00:19, 454.22it/s] 10%|███████▏                                                                 | 955/9741 [00:02<00:19, 457.10it/s] 10%|███████▍                                                                | 1002/9741 [00:02<00:19, 459.10it/s] 11%|███████▊                                                                | 1049/9741 [00:02<00:18, 461.00it/s] 11%|████████                                                                | 1096/9741 [00:02<00:18, 459.26it/s] 12%|████████▍                                                               | 1142/9741 [00:03<00:18, 458.44it/s] 12%|████████▊                                                               | 1189/9741 [00:03<00:18, 459.91it/s] 13%|█████████▏                                                              | 1236/9741 [00:03<00:18, 460.59it/s] 13%|█████████▍                                                              | 1283/9741 [00:03<00:18, 461.60it/s] 14%|█████████▊                                                              | 1330/9741 [00:03<00:18, 462.06it/s] 14%|██████████▏                                                             | 1377/9741 [00:03<00:18, 460.09it/s] 15%|██████████▌                                                             | 1424/9741 [00:03<00:18, 460.47it/s] 15%|██████████▊                                                             | 1471/9741 [00:03<00:17, 460.98it/s] 16%|███████████▏                                                            | 1518/9741 [00:03<00:17, 461.16it/s] 16%|███████████▌                                                            | 1565/9741 [00:03<00:17, 459.63it/s] 17%|███████████▉                                                            | 1612/9741 [00:04<00:17, 459.93it/s] 17%|████████████▎                                                           | 1659/9741 [00:04<00:17, 461.12it/s] 18%|████████████▌                                                           | 1706/9741 [00:04<00:17, 460.17it/s] 18%|████████████▉                                                           | 1753/9741 [00:04<00:17, 460.39it/s] 18%|█████████████▎                                                          | 1800/9741 [00:04<00:18, 439.49it/s] 19%|█████████████▋                                                          | 1847/9741 [00:04<00:17, 445.67it/s] 19%|█████████████▉                                                          | 1894/9741 [00:04<00:17, 450.36it/s] 20%|██████████████▎                                                         | 1941/9741 [00:04<00:17, 453.40it/s] 20%|██████████████▋                                                         | 1988/9741 [00:04<00:17, 455.55it/s] 21%|███████████████                                                         | 2034/9741 [00:05<00:16, 455.17it/s] 21%|███████████████▍                                                        | 2081/9741 [00:05<00:16, 456.70it/s] 22%|███████████████▋                                                        | 2128/9741 [00:05<00:16, 457.97it/s] 22%|████████████████                                                        | 2175/9741 [00:05<00:16, 458.90it/s] 23%|████████████████▍                                                       | 2222/9741 [00:05<00:16, 459.34it/s] 23%|████████████████▊                                                       | 2268/9741 [00:05<00:16, 457.48it/s] 24%|█████████████████                                                       | 2314/9741 [00:05<00:16, 454.43it/s] 24%|█████████████████▍                                                      | 2360/9741 [00:05<00:16, 455.92it/s] 25%|█████████████████▊                                                      | 2407/9741 [00:05<00:16, 457.68it/s] 25%|██████████████████▏                                                     | 2453/9741 [00:05<00:15, 457.58it/s] 26%|██████████████████▍                                                     | 2499/9741 [00:06<00:15, 456.30it/s] 26%|██████████████████▊                                                     | 2545/9741 [00:06<00:15, 457.25it/s] 27%|███████████████████▏                                                    | 2592/9741 [00:06<00:15, 458.80it/s] 27%|███████████████████▌                                                    | 2639/9741 [00:06<00:15, 459.61it/s] 28%|███████████████████▊                                                    | 2686/9741 [00:06<00:15, 459.72it/s] 28%|████████████████████▏                                                   | 2732/9741 [00:06<00:15, 457.44it/s] 29%|████████████████████▌                                                   | 2778/9741 [00:06<00:15, 458.08it/s] 29%|████████████████████▊                                                   | 2824/9741 [00:06<00:15, 458.49it/s] 29%|█████████████████████▏                                                  | 2871/9741 [00:06<00:14, 459.51it/s] 30%|█████████████████████▌                                                  | 2917/9741 [00:06<00:14, 455.58it/s] 30%|█████████████████████▉                                                  | 2963/9741 [00:07<00:14, 452.75it/s] 31%|██████████████████████▏                                                 | 3010/9741 [00:07<00:14, 455.36it/s] 31%|██████████████████████▌                                                 | 3056/9741 [00:07<00:14, 456.48it/s] 32%|██████████████████████▉                                                 | 3103/9741 [00:07<00:14, 457.62it/s] 32%|███████████████████████▎                                                | 3150/9741 [00:07<00:14, 458.41it/s] 33%|███████████████████████▌                                                | 3196/9741 [00:07<00:14, 457.71it/s] 33%|███████████████████████▉                                                | 3243/9741 [00:07<00:14, 458.56it/s] 34%|████████████████████████▎                                               | 3290/9741 [00:07<00:14, 459.32it/s] 34%|████████████████████████▋                                               | 3336/9741 [00:07<00:13, 459.47it/s] 35%|████████████████████████▉                                               | 3382/9741 [00:07<00:13, 457.42it/s] 35%|█████████████████████████▎                                              | 3429/9741 [00:08<00:13, 458.67it/s] 36%|█████████████████████████▋                                              | 3475/9741 [00:08<00:13, 458.68it/s] 36%|██████████████████████████                                              | 3521/9741 [00:08<00:13, 455.52it/s] 37%|██████████████████████████▎                                             | 3567/9741 [00:08<00:13, 456.76it/s] 37%|██████████████████████████▋                                             | 3613/9741 [00:08<00:13, 455.54it/s] 38%|███████████████████████████                                             | 3660/9741 [00:08<00:13, 457.06it/s] 38%|███████████████████████████▍                                            | 3707/9741 [00:08<00:13, 458.28it/s] 39%|███████████████████████████▋                                            | 3754/9741 [00:08<00:13, 459.23it/s] 39%|████████████████████████████                                            | 3801/9741 [00:08<00:12, 459.77it/s] 39%|████████████████████████████▍                                           | 3847/9741 [00:08<00:12, 458.02it/s] 40%|████████████████████████████▊                                           | 3894/9741 [00:09<00:12, 459.15it/s] 40%|█████████████████████████████▏                                          | 3941/9741 [00:09<00:12, 459.50it/s] 41%|█████████████████████████████▍                                          | 3988/9741 [00:09<00:12, 459.95it/s] 41%|█████████████████████████████▊                                          | 4035/9741 [00:09<00:12, 460.75it/s] 42%|██████████████████████████████▏                                         | 4082/9741 [00:09<00:12, 458.91it/s] 42%|██████████████████████████████▌                                         | 4129/9741 [00:09<00:12, 459.43it/s] 43%|██████████████████████████████▊                                         | 4175/9741 [00:09<00:12, 459.39it/s] 43%|███████████████████████████████▏                                        | 4221/9741 [00:09<00:12, 459.33it/s] 44%|███████████████████████████████▌                                        | 4268/9741 [00:09<00:11, 460.15it/s] 44%|███████████████████████████████▉                                        | 4315/9741 [00:09<00:11, 458.43it/s] 45%|████████████████████████████████▏                                       | 4361/9741 [00:10<00:11, 458.78it/s] 45%|████████████████████████████████▌                                       | 4408/9741 [00:10<00:11, 459.61it/s] 46%|████████████████████████████████▉                                       | 4455/9741 [00:10<00:11, 460.08it/s] 46%|█████████████████████████████████▎                                      | 4502/9741 [00:10<00:11, 460.29it/s] 47%|█████████████████████████████████▌                                      | 4549/9741 [00:10<00:12, 424.03it/s] 47%|█████████████████████████████████▉                                      | 4595/9741 [00:10<00:11, 432.64it/s] 48%|██████████████████████████████████▎                                     | 4642/9741 [00:10<00:11, 441.22it/s] 48%|██████████████████████████████████▋                                     | 4688/9741 [00:10<00:11, 446.18it/s] 49%|██████████████████████████████████▉                                     | 4735/9741 [00:10<00:11, 450.87it/s] 49%|███████████████████████████████████▎                                    | 4781/9741 [00:11<00:15, 322.62it/s] 50%|███████████████████████████████████▋                                    | 4827/9741 [00:11<00:13, 354.00it/s] 50%|████████████████████████████████████                                    | 4873/9741 [00:11<00:12, 379.51it/s] 51%|████████████████████████████████████▎                                   | 4920/9741 [00:11<00:12, 400.91it/s] 51%|████████████████████████████████████▋                                   | 4965/9741 [00:11<00:11, 412.79it/s] 51%|█████████████████████████████████████                                   | 5012/9741 [00:11<00:11, 426.27it/s] 52%|█████████████████████████████████████▍                                  | 5059/9741 [00:11<00:10, 436.44it/s] 52%|█████████████████████████████████████▋                                  | 5105/9741 [00:11<00:10, 443.12it/s] 53%|██████████████████████████████████████                                  | 5152/9741 [00:11<00:10, 448.31it/s] 53%|██████████████████████████████████████▍                                 | 5198/9741 [00:12<00:10, 450.01it/s] 54%|██████████████████████████████████████▊                                 | 5245/9741 [00:12<00:09, 453.07it/s] 54%|███████████████████████████████████████                                 | 5292/9741 [00:12<00:09, 455.13it/s] 55%|███████████████████████████████████████▍                                | 5339/9741 [00:12<00:09, 456.61it/s] 55%|███████████████████████████████████████▊                                | 5386/9741 [00:12<00:09, 457.69it/s] 56%|████████████████████████████████████████▏                               | 5432/9741 [00:12<00:09, 456.28it/s] 56%|████████████████████████████████████████▍                               | 5479/9741 [00:12<00:09, 458.69it/s] 57%|████████████████████████████████████████▊                               | 5527/9741 [00:12<00:09, 463.62it/s] 57%|█████████████████████████████████████████▏                              | 5575/9741 [00:12<00:08, 467.25it/s] 58%|█████████████████████████████████████████▌                              | 5623/9741 [00:12<00:08, 469.57it/s] 58%|█████████████████████████████████████████▉                              | 5670/9741 [00:13<00:08, 469.43it/s] 59%|██████████████████████████████████████████▎                             | 5718/9741 [00:13<00:08, 471.95it/s] 59%|██████████████████████████████████████████▌                             | 5766/9741 [00:13<00:08, 454.89it/s] 60%|██████████████████████████████████████████▉                             | 5814/9741 [00:13<00:08, 460.98it/s] 60%|███████████████████████████████████████████▎                            | 5861/9741 [00:13<00:08, 462.89it/s] 61%|███████████████████████████████████████████▋                            | 5909/9741 [00:13<00:08, 466.70it/s] 61%|████████████████████████████████████████████                            | 5957/9741 [00:13<00:08, 469.79it/s] 62%|████████████████████████████████████████████▍                           | 6005/9741 [00:13<00:07, 471.68it/s] 62%|████████████████████████████████████████████▋                           | 6053/9741 [00:13<00:07, 473.24it/s] 63%|█████████████████████████████████████████████                           | 6101/9741 [00:14<00:07, 472.17it/s] 63%|█████████████████████████████████████████████▍                          | 6149/9741 [00:14<00:07, 472.97it/s] 64%|█████████████████████████████████████████████▊                          | 6197/9741 [00:14<00:07, 474.24it/s] 64%|██████████████████████████████████████████████▏                         | 6245/9741 [00:14<00:07, 474.48it/s] 65%|██████████████████████████████████████████████▌                         | 6293/9741 [00:14<00:07, 474.89it/s] 65%|██████████████████████████████████████████████▊                         | 6341/9741 [00:14<00:07, 473.45it/s] 66%|███████████████████████████████████████████████▏                        | 6389/9741 [00:14<00:07, 473.98it/s] 66%|███████████████████████████████████████████████▌                        | 6437/9741 [00:14<00:06, 474.03it/s] 67%|███████████████████████████████████████████████▉                        | 6485/9741 [00:14<00:06, 473.81it/s] 67%|████████████████████████████████████████████████▎                       | 6533/9741 [00:14<00:06, 472.22it/s] 68%|████████████████████████████████████████████████▋                       | 6581/9741 [00:15<00:06, 472.32it/s] 68%|████████████████████████████████████████████████▉                       | 6629/9741 [00:15<00:06, 473.37it/s] 69%|█████████████████████████████████████████████████▎                      | 6677/9741 [00:15<00:06, 474.34it/s] 69%|█████████████████████████████████████████████████▋                      | 6725/9741 [00:15<00:06, 463.41it/s] 70%|██████████████████████████████████████████████████                      | 6772/9741 [00:15<00:06, 463.74it/s] 70%|██████████████████████████████████████████████████▍                     | 6820/9741 [00:15<00:06, 467.52it/s] 71%|██████████████████████████████████████████████████▊                     | 6868/9741 [00:15<00:06, 470.79it/s] 71%|███████████████████████████████████████████████████                     | 6916/9741 [00:15<00:05, 472.23it/s] 71%|███████████████████████████████████████████████████▍                    | 6964/9741 [00:15<00:05, 473.12it/s] 72%|███████████████████████████████████████████████████▊                    | 7012/9741 [00:15<00:05, 469.43it/s] 72%|████████████████████████████████████████████████████▏                   | 7060/9741 [00:16<00:05, 471.50it/s] 73%|████████████████████████████████████████████████████▌                   | 7108/9741 [00:16<00:05, 472.87it/s] 73%|████████████████████████████████████████████████████▉                   | 7156/9741 [00:16<00:05, 473.81it/s] 74%|█████████████████████████████████████████████████████▏                  | 7204/9741 [00:16<00:05, 469.61it/s] 74%|█████████████████████████████████████████████████████▌                  | 7251/9741 [00:16<00:05, 451.95it/s] 75%|█████████████████████████████████████████████████████▉                  | 7299/9741 [00:16<00:05, 459.21it/s] 75%|██████████████████████████████████████████████████████▎                 | 7347/9741 [00:16<00:05, 464.29it/s] 76%|██████████████████████████████████████████████████████▋                 | 7395/9741 [00:16<00:05, 466.68it/s] 76%|███████████████████████████████████████████████████████                 | 7442/9741 [00:16<00:05, 439.38it/s] 77%|███████████████████████████████████████████████████████▎                | 7490/9741 [00:16<00:05, 449.26it/s] 77%|███████████████████████████████████████████████████████▋                | 7538/9741 [00:17<00:04, 456.62it/s] 78%|████████████████████████████████████████████████████████                | 7586/9741 [00:17<00:04, 462.06it/s] 78%|████████████████████████████████████████████████████████▍               | 7634/9741 [00:17<00:04, 465.86it/s] 79%|████████████████████████████████████████████████████████▊               | 7681/9741 [00:17<00:04, 466.74it/s] 79%|█████████████████████████████████████████████████████████▏              | 7729/9741 [00:17<00:04, 470.09it/s] 80%|█████████████████████████████████████████████████████████▍              | 7777/9741 [00:17<00:04, 471.93it/s] 80%|█████████████████████████████████████████████████████████▊              | 7825/9741 [00:17<00:04, 473.15it/s] 81%|██████████████████████████████████████████████████████████▏             | 7873/9741 [00:17<00:03, 473.98it/s] 81%|██████████████████████████████████████████████████████████▌             | 7921/9741 [00:17<00:03, 473.30it/s] 82%|██████████████████████████████████████████████████████████▉             | 7969/9741 [00:17<00:03, 474.01it/s] 82%|███████████████████████████████████████████████████████████▎            | 8017/9741 [00:18<00:03, 474.45it/s] 83%|███████████████████████████████████████████████████████████▌            | 8065/9741 [00:18<00:03, 475.04it/s] 83%|███████████████████████████████████████████████████████████▉            | 8113/9741 [00:18<00:03, 475.45it/s] 84%|████████████████████████████████████████████████████████████▎           | 8161/9741 [00:18<00:03, 469.58it/s] 84%|████████████████████████████████████████████████████████████▋           | 8209/9741 [00:18<00:03, 470.93it/s] 85%|█████████████████████████████████████████████████████████████           | 8257/9741 [00:18<00:03, 472.61it/s] 85%|█████████████████████████████████████████████████████████████▍          | 8305/9741 [00:18<00:03, 473.30it/s] 86%|█████████████████████████████████████████████████████████████▋          | 8353/9741 [00:18<00:02, 472.16it/s] 86%|██████████████████████████████████████████████████████████████          | 8401/9741 [00:18<00:02, 473.14it/s] 87%|██████████████████████████████████████████████████████████████▍         | 8449/9741 [00:19<00:02, 474.00it/s] 87%|██████████████████████████████████████████████████████████████▊         | 8497/9741 [00:19<00:02, 459.84it/s] 88%|███████████████████████████████████████████████████████████████▏        | 8544/9741 [00:19<00:02, 462.64it/s] 88%|███████████████████████████████████████████████████████████████▍        | 8591/9741 [00:19<00:02, 433.23it/s] 89%|███████████████████████████████████████████████████████████████▊        | 8635/9741 [00:19<00:02, 405.71it/s] 89%|████████████████████████████████████████████████████████████████▏       | 8682/9741 [00:19<00:02, 422.56it/s] 90%|████████████████████████████████████████████████████████████████▌       | 8730/9741 [00:19<00:02, 436.94it/s] 90%|████████████████████████████████████████████████████████████████▉       | 8778/9741 [00:19<00:02, 447.70it/s] 91%|█████████████████████████████████████████████████████████████████▏      | 8824/9741 [00:19<00:02, 436.96it/s] 91%|█████████████████████████████████████████████████████████████████▌      | 8872/9741 [00:19<00:01, 447.22it/s] 92%|█████████████████████████████████████████████████████████████████▉      | 8919/9741 [00:20<00:01, 451.11it/s] 92%|██████████████████████████████████████████████████████████████████▎     | 8966/9741 [00:20<00:01, 455.54it/s] 93%|██████████████████████████████████████████████████████████████████▌     | 9012/9741 [00:20<00:01, 455.22it/s] 93%|██████████████████████████████████████████████████████████████████▉     | 9059/9741 [00:20<00:01, 457.89it/s] 93%|███████████████████████████████████████████████████████████████████▎    | 9105/9741 [00:20<00:01, 458.04it/s] 94%|███████████████████████████████████████████████████████████████████▋    | 9152/9741 [00:20<00:01, 461.39it/s] 94%|████████████████████████████████████████████████████████████████████    | 9200/9741 [00:20<00:01, 465.45it/s] 95%|████████████████████████████████████████████████████████████████████▎   | 9248/9741 [00:20<00:01, 468.13it/s] 95%|████████████████████████████████████████████████████████████████████▋   | 9295/9741 [00:20<00:00, 468.17it/s] 96%|█████████████████████████████████████████████████████████████████████   | 9343/9741 [00:20<00:00, 470.31it/s] 96%|█████████████████████████████████████████████████████████████████████▍  | 9391/9741 [00:21<00:00, 471.44it/s] 97%|█████████████████████████████████████████████████████████████████████▊  | 9439/9741 [00:21<00:00, 472.45it/s] 97%|██████████████████████████████████████████████████████████████████████  | 9487/9741 [00:21<00:00, 470.66it/s] 98%|██████████████████████████████████████████████████████████████████████▍ | 9535/9741 [00:21<00:00, 471.44it/s] 98%|██████████████████████████████████████████████████████████████████████▊ | 9583/9741 [00:21<00:00, 471.94it/s] 99%|███████████████████████████████████████████████████████████████████████▏| 9631/9741 [00:21<00:00, 472.11it/s] 99%|███████████████████████████████████████████████████████████████████████▌| 9679/9741 [00:21<00:00, 472.26it/s]100%|███████████████████████████████████████████████████████████████████████▉| 9727/9741 [00:21<00:00, 436.19it/s]100%|████████████████████████████████████████████████████████████████████████| 9741/9741 [00:21<00:00, 445.26it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:04<00:09,  4.74s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:04<00:09,  4.75s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.09s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.18s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:09<00:04,  4.85s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:09<00:04,  4.86s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.37s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.41s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.29s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.43s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.32s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.45s/it]
[2023-08-14 03:58:18,881] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.77s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.91s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.80s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.93s/it]
[2023-08-14 03:58:29,961] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-14 03:58:29,962] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-14 03:58:29,962] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-14 03:58:29,962] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-14 03:58:29,962] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-14 03:58:29,962] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-14 03:58:29,962] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f8acc175fd0>
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f8adb148970>
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-14 03:58:29,963] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-14 03:58:29,964] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-14 03:58:29,964] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-14 03:58:29,964] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-14 03:58:29,964] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-14 03:58:29,964] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-14 03:58:29,964] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-14 03:58:29,964] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.5144960880279541 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Loading extension module utils...
Evaluating commonsenseqa :   0%|                                                           | 0/50 [00:00<?, ?it/s]Time to load utils op: 0.20418977737426758 seconds
############### Example ###############
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following multiple choice question.

### Demonstration:
Input: Mary had 89 stickers.  She used 3 large stickers on the front page of her journal and 7 stickers each to 6 other pages of her journal. How many stickers does Mary have remaining?
Answer: 44

Input: Zach is saving his money to buy a brand new bike that costs $100.  His weekly allowance is $5.  His parent will pay him an extra $10 to mow the lawn.  His neighbor will pay him $7 per hour to babysit their son.  He has already saved up $65.  He'll receive his allowance on Friday and he's planning on babysitting for 2 hours this Saturday after he mows the lawn.  How much more money does Zach need to earn before he can buy the bike?
Answer: 6

Input: Mark has kangaroos and goats.  Kangaroos have two legs and goats have four legs.  If he has 23 kangaroos and three times as many goats as kangaroos what is the total number of legs of all his animals?
Answer: 322

Input: Josh’s mom gives him $20 to go shopping at the mall. He buys a hat for $10 and a pencil for $2. Then he buys four cookies. If each cookie costs $1.25, how much money does Josh have left?
Answer: 3

Input: George's bowling team is one round away from breaking the league record for most points scored in a season. The old record is an average score per player of 287 per round. Each team has 4 players and there are 10 rounds in the season. Through the first 9 rounds, his team has scored a total of 10,440. How many points less than the current league record per game average is the minimum average they need to score, per player, in the final round to tie the league record?
Answer: 27

Input: Max was doing homework in three different subjects. It took him 20 minutes to finish tasks from biology and two times more time to finish history. Geography took him the most time, three times more than history. How much time did Max spend on doing his homework?
Answer: 180

Input: Sophia ate 1/6 of her pie and she put the rest on the fridge. If the pie left in the fridge weighs 1200 grams, how many grams did Sophia eat?
Answer: 240

Input: Sarah, Mary, and Tuan decided to go to the restaurant for a meal. They decided to split the cost of the meal evenly. If the total price of the meal comes to $67 and they have a coupon for $4, how much does each person need to contribute to the bill?
Answer: 21

Input: Tom's brother is 4 times as old as Tom's dog. If in 6 years, Tom's brother will be 30 years, how old is Tom's dog going to be in six years?
Answer: 12

Input: There are 50 children at the party. Three-fifths of them are boys. How many of the children are girls?
Answer: 20

Input: Gail has some bills in her wallet which amount to $100. She has four $5 bills and three $20 bills, and the rest are $10 bills. How many $10 bills are in her wallet?
Answer: 2

Input: A 220-liter barrel has a small leak. It lost 10% of its contents before anyone noticed. How many liters are left in the barrel?
Answer: 198

Input: Markese earned 5 fewer dollars than Evan. Together they earned $37. How many dollars did Markese earn? Use E to represent how many dollars Evan earned.
Answer: 16

Input: Lou Senior took 3 cookies out of the cookie jar and ate them.  Since he didn't get caught by his wife, he went back the next day and took another 3 cookies out of the jar.  But after eating just one of the cookies, he felt guilty about it and put the other two cookies back.  His son, Louie Junior saw that his Dad was eating cookies.  So, Louie Junior took seven cookies out of the jar and hid them in his bedroom for later.  The next morning, Debra, Lou's wife looked into the cookie jar and reacted by accusing her husband of eating half of the cookies out of the cookie jar.  How many cookies remained in the jar?
Answer: 11

### Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid

### Response:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o14-tgsm8k-s1-rFalse
Loading extension module utils...
Time to load utils op: 0.5059835910797119 seconds
Loading extension module utils...
Time to load utils op: 0.5046110153198242 seconds
Evaluating commonsenseqa :   2%|█                                                  | 1/50 [00:43<35:28, 43.44s/it]Evaluating commonsenseqa :   4%|██                                                 | 2/50 [01:16<29:40, 37.09s/it]Evaluating commonsenseqa :   6%|███                                                | 3/50 [01:58<31:07, 39.74s/it]Evaluating commonsenseqa :   8%|████                                               | 4/50 [02:42<31:30, 41.09s/it]Evaluating commonsenseqa :  10%|█████                                              | 5/50 [03:24<31:17, 41.72s/it]Evaluating commonsenseqa :  12%|██████                                             | 6/50 [04:08<31:03, 42.35s/it]Evaluating commonsenseqa :  14%|███████▏                                           | 7/50 [04:52<30:42, 42.85s/it]Evaluating commonsenseqa :  16%|████████▏                                          | 8/50 [05:32<29:18, 41.87s/it]Evaluating commonsenseqa :  18%|█████████▏                                         | 9/50 [06:15<28:57, 42.38s/it]Evaluating commonsenseqa :  20%|██████████                                        | 10/50 [06:59<28:37, 42.95s/it]Evaluating commonsenseqa :  22%|███████████                                       | 11/50 [07:43<28:00, 43.08s/it]Evaluating commonsenseqa :  24%|████████████                                      | 12/50 [08:26<27:15, 43.03s/it]Evaluating commonsenseqa :  26%|█████████████                                     | 13/50 [09:09<26:35, 43.13s/it]Evaluating commonsenseqa :  28%|██████████████                                    | 14/50 [09:52<25:53, 43.15s/it]Evaluating commonsenseqa :  30%|███████████████                                   | 15/50 [10:21<22:40, 38.87s/it]Evaluating commonsenseqa :  32%|████████████████                                  | 16/50 [11:04<22:43, 40.10s/it]Evaluating commonsenseqa :  34%|█████████████████                                 | 17/50 [11:38<21:03, 38.30s/it]Evaluating commonsenseqa :  36%|██████████████████                                | 18/50 [11:56<17:04, 32.03s/it]Evaluating commonsenseqa :  38%|███████████████████                               | 19/50 [12:39<18:13, 35.27s/it]Evaluating commonsenseqa :  40%|████████████████████                              | 20/50 [13:22<18:48, 37.62s/it]Evaluating commonsenseqa :  42%|█████████████████████                             | 21/50 [13:54<17:26, 36.10s/it]Evaluating commonsenseqa :  44%|██████████████████████                            | 22/50 [14:37<17:50, 38.22s/it]Evaluating commonsenseqa :  46%|███████████████████████                           | 23/50 [15:21<17:52, 39.73s/it]Evaluating commonsenseqa :  48%|████████████████████████                          | 24/50 [16:04<17:37, 40.69s/it]Evaluating commonsenseqa :  50%|█████████████████████████                         | 25/50 [16:47<17:17, 41.48s/it]Evaluating commonsenseqa :  52%|██████████████████████████                        | 26/50 [17:30<16:47, 41.99s/it]Evaluating commonsenseqa :  54%|███████████████████████████                       | 27/50 [18:13<16:15, 42.42s/it]Evaluating commonsenseqa :  56%|████████████████████████████                      | 28/50 [18:57<15:38, 42.66s/it]Evaluating commonsenseqa :  58%|████████████████████████████▉                     | 29/50 [19:40<14:58, 42.76s/it]Evaluating commonsenseqa :  60%|██████████████████████████████                    | 30/50 [20:22<14:14, 42.72s/it]Evaluating commonsenseqa :  62%|███████████████████████████████                   | 31/50 [21:06<13:37, 43.02s/it]Evaluating commonsenseqa :  64%|████████████████████████████████                  | 32/50 [21:34<11:30, 38.36s/it]Evaluating commonsenseqa :  66%|█████████████████████████████████                 | 33/50 [22:17<11:18, 39.89s/it]Evaluating commonsenseqa :  68%|██████████████████████████████████                | 34/50 [23:00<10:53, 40.85s/it]Evaluating commonsenseqa :  70%|███████████████████████████████████               | 35/50 [23:44<10:26, 41.79s/it]Evaluating commonsenseqa :  72%|████████████████████████████████████              | 36/50 [24:11<08:44, 37.44s/it]Evaluating commonsenseqa :  74%|█████████████████████████████████████             | 37/50 [24:55<08:29, 39.18s/it]Evaluating commonsenseqa :  76%|██████████████████████████████████████            | 38/50 [25:38<08:04, 40.36s/it]Evaluating commonsenseqa :  78%|███████████████████████████████████████           | 39/50 [26:21<07:33, 41.20s/it]Evaluating commonsenseqa :  80%|████████████████████████████████████████          | 40/50 [27:04<06:56, 41.67s/it]Evaluating commonsenseqa :  82%|█████████████████████████████████████████         | 41/50 [27:47<06:19, 42.19s/it]Evaluating commonsenseqa :  84%|██████████████████████████████████████████        | 42/50 [28:17<05:08, 38.54s/it]Evaluating commonsenseqa :  86%|███████████████████████████████████████████       | 43/50 [29:00<04:39, 39.89s/it]Evaluating commonsenseqa :  88%|████████████████████████████████████████████      | 44/50 [29:44<04:05, 41.00s/it]Evaluating commonsenseqa :  90%|█████████████████████████████████████████████     | 45/50 [30:27<03:28, 41.64s/it]Evaluating commonsenseqa :  92%|██████████████████████████████████████████████    | 46/50 [31:09<02:47, 41.94s/it]Evaluating commonsenseqa :  94%|███████████████████████████████████████████████   | 47/50 [31:53<02:07, 42.34s/it]Evaluating commonsenseqa :  96%|████████████████████████████████████████████████  | 48/50 [32:36<01:25, 42.72s/it]Evaluating commonsenseqa :  98%|█████████████████████████████████████████████████ | 49/50 [33:19<00:42, 42.74s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████| 50/50 [34:02<00:00, 42.65s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████| 50/50 [34:02<00:00, 40.84s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 3.6301} | lm_loss 7.8416 | avg. gen lenth: 287.084
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name gsm8k --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/out-domain/o15-tgsm8k-s1-rFalse --seed 1 --num-out-domain 15
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date![nltk_data]   Package punkt is already up-to-date!

[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-14 04:32:39,709] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/out-domain/o15-tgsm8k-s1-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 15
  out_domain_data_name ......... gsm8k
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o15-tgsm8k-s1-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                    | 0/9741 [00:00<?, ?it/s]  0%|▏                                                                         | 30/9741 [00:00<00:33, 292.90it/s]  1%|▍                                                                         | 60/9741 [00:00<00:32, 293.73it/s]  1%|▋                                                                         | 90/9741 [00:00<00:32, 294.42it/s]  1%|▉                                                                        | 120/9741 [00:00<00:32, 295.05it/s]  2%|█                                                                        | 150/9741 [00:00<00:32, 295.30it/s]  2%|█▎                                                                       | 180/9741 [00:00<00:32, 294.95it/s]  2%|█▌                                                                       | 210/9741 [00:00<00:33, 288.67it/s]  2%|█▊                                                                       | 240/9741 [00:00<00:32, 290.41it/s]  3%|██                                                                       | 270/9741 [00:00<00:32, 291.62it/s]  3%|██▏                                                                      | 300/9741 [00:01<00:32, 292.66it/s]  3%|██▍                                                                      | 330/9741 [00:01<00:32, 293.38it/s]  4%|██▋                                                                      | 360/9741 [00:01<00:31, 293.40it/s]  4%|██▉                                                                      | 390/9741 [00:01<00:31, 293.36it/s]  4%|███▏                                                                     | 420/9741 [00:01<00:31, 293.73it/s]  5%|███▎                                                                     | 450/9741 [00:01<00:31, 292.36it/s]  5%|███▌                                                                     | 480/9741 [00:01<00:31, 292.76it/s]  5%|███▊                                                                     | 510/9741 [00:01<00:31, 289.65it/s]  6%|████                                                                     | 540/9741 [00:01<00:31, 290.32it/s]  6%|████▎                                                                    | 570/9741 [00:01<00:31, 291.21it/s]  6%|████▍                                                                    | 600/9741 [00:02<00:31, 291.81it/s]  6%|████▋                                                                    | 630/9741 [00:02<00:31, 292.40it/s]  7%|████▉                                                                    | 660/9741 [00:02<00:31, 290.97it/s]  7%|█████▏                                                                   | 691/9741 [00:02<00:30, 295.79it/s]  8%|█████▌                                                                   | 736/9741 [00:02<00:26, 340.19it/s]  8%|█████▊                                                                   | 781/9741 [00:02<00:24, 371.95it/s]  8%|██████▏                                                                  | 826/9741 [00:02<00:22, 394.25it/s]  9%|██████▌                                                                  | 871/9741 [00:02<00:21, 409.64it/s]  9%|██████▊                                                                  | 915/9741 [00:02<00:21, 417.98it/s] 10%|███████▏                                                                 | 960/9741 [00:02<00:20, 426.07it/s] 10%|███████▍                                                                | 1005/9741 [00:03<00:20, 431.52it/s] 11%|███████▊                                                                | 1050/9741 [00:03<00:19, 434.87it/s] 11%|████████                                                                | 1095/9741 [00:03<00:19, 437.07it/s] 12%|████████▍                                                               | 1139/9741 [00:03<00:19, 436.61it/s] 12%|████████▊                                                               | 1184/9741 [00:03<00:19, 439.15it/s] 13%|█████████                                                               | 1229/9741 [00:03<00:19, 440.32it/s] 13%|█████████▍                                                              | 1274/9741 [00:03<00:19, 441.30it/s] 14%|█████████▋                                                              | 1319/9741 [00:03<00:19, 442.21it/s] 14%|██████████                                                              | 1364/9741 [00:03<00:19, 440.32it/s] 14%|██████████▍                                                             | 1409/9741 [00:03<00:18, 441.55it/s] 15%|██████████▋                                                             | 1454/9741 [00:04<00:18, 442.70it/s] 15%|███████████                                                             | 1499/9741 [00:04<00:18, 443.17it/s] 16%|███████████▍                                                            | 1544/9741 [00:04<00:18, 443.77it/s] 16%|███████████▋                                                            | 1589/9741 [00:04<00:18, 441.12it/s] 17%|████████████                                                            | 1634/9741 [00:04<00:18, 442.50it/s] 17%|████████████▍                                                           | 1679/9741 [00:04<00:18, 443.23it/s] 18%|████████████▋                                                           | 1724/9741 [00:04<00:18, 443.50it/s] 18%|█████████████                                                           | 1769/9741 [00:04<00:17, 443.82it/s] 19%|█████████████▍                                                          | 1814/9741 [00:04<00:18, 420.65it/s] 19%|█████████████▋                                                          | 1859/9741 [00:05<00:18, 426.87it/s] 20%|██████████████                                                          | 1904/9741 [00:05<00:18, 431.52it/s] 20%|██████████████▍                                                         | 1949/9741 [00:05<00:17, 434.91it/s] 20%|██████████████▋                                                         | 1994/9741 [00:05<00:17, 436.93it/s] 21%|███████████████                                                         | 2038/9741 [00:05<00:17, 435.98it/s] 21%|███████████████▍                                                        | 2082/9741 [00:05<00:17, 436.77it/s] 22%|███████████████▋                                                        | 2126/9741 [00:05<00:17, 437.24it/s] 22%|████████████████                                                        | 2171/9741 [00:05<00:17, 438.83it/s] 23%|████████████████▍                                                       | 2216/9741 [00:05<00:17, 440.10it/s] 23%|████████████████▋                                                       | 2261/9741 [00:05<00:17, 437.86it/s] 24%|█████████████████                                                       | 2306/9741 [00:06<00:16, 439.34it/s] 24%|█████████████████▍                                                      | 2351/9741 [00:06<00:16, 440.52it/s] 25%|█████████████████▋                                                      | 2396/9741 [00:06<00:16, 441.40it/s] 25%|██████████████████                                                      | 2441/9741 [00:06<00:16, 441.93it/s] 26%|██████████████████▍                                                     | 2486/9741 [00:06<00:16, 439.69it/s] 26%|██████████████████▋                                                     | 2531/9741 [00:06<00:16, 439.97it/s] 26%|███████████████████                                                     | 2576/9741 [00:06<00:16, 440.86it/s] 27%|███████████████████▎                                                    | 2621/9741 [00:06<00:16, 441.79it/s] 27%|███████████████████▋                                                    | 2666/9741 [00:06<00:16, 442.02it/s] 28%|████████████████████                                                    | 2711/9741 [00:06<00:16, 435.43it/s] 28%|████████████████████▎                                                   | 2756/9741 [00:07<00:15, 437.56it/s] 29%|████████████████████▋                                                   | 2801/9741 [00:07<00:15, 438.96it/s] 29%|█████████████████████                                                   | 2846/9741 [00:07<00:15, 439.50it/s] 30%|█████████████████████▎                                                  | 2891/9741 [00:07<00:15, 440.36it/s] 30%|█████████████████████▋                                                  | 2936/9741 [00:07<00:15, 438.95it/s] 31%|██████████████████████                                                  | 2981/9741 [00:07<00:15, 439.55it/s] 31%|██████████████████████▎                                                 | 3026/9741 [00:07<00:15, 440.21it/s] 32%|██████████████████████▋                                                 | 3071/9741 [00:07<00:15, 440.51it/s] 32%|███████████████████████                                                 | 3116/9741 [00:07<00:15, 441.31it/s] 32%|███████████████████████▎                                                | 3161/9741 [00:07<00:14, 439.02it/s] 33%|███████████████████████▋                                                | 3206/9741 [00:08<00:14, 440.02it/s] 33%|████████████████████████                                                | 3251/9741 [00:08<00:14, 441.29it/s] 34%|████████████████████████▎                                               | 3296/9741 [00:08<00:14, 437.45it/s] 34%|████████████████████████▋                                               | 3341/9741 [00:08<00:14, 438.87it/s] 35%|█████████████████████████                                               | 3385/9741 [00:08<00:14, 437.64it/s] 35%|█████████████████████████▎                                              | 3430/9741 [00:08<00:14, 439.31it/s] 36%|█████████████████████████▋                                              | 3475/9741 [00:08<00:14, 439.77it/s] 36%|██████████████████████████                                              | 3519/9741 [00:08<00:14, 438.88it/s] 37%|██████████████████████████▎                                             | 3564/9741 [00:08<00:14, 440.14it/s] 37%|██████████████████████████▋                                             | 3609/9741 [00:08<00:13, 438.26it/s] 38%|███████████████████████████                                             | 3654/9741 [00:09<00:13, 439.29it/s] 38%|███████████████████████████▎                                            | 3699/9741 [00:09<00:13, 439.49it/s] 38%|███████████████████████████▋                                            | 3744/9741 [00:09<00:13, 440.30it/s] 39%|████████████████████████████                                            | 3789/9741 [00:09<00:13, 440.29it/s] 39%|████████████████████████████▎                                           | 3834/9741 [00:09<00:13, 438.88it/s] 40%|████████████████████████████▋                                           | 3878/9741 [00:09<00:13, 435.67it/s] 40%|████████████████████████████▉                                           | 3923/9741 [00:09<00:13, 437.62it/s] 41%|█████████████████████████████▎                                          | 3968/9741 [00:09<00:13, 438.45it/s] 41%|█████████████████████████████▋                                          | 4012/9741 [00:09<00:13, 438.19it/s] 42%|█████████████████████████████▉                                          | 4057/9741 [00:10<00:12, 439.30it/s] 42%|██████████████████████████████▎                                         | 4101/9741 [00:10<00:12, 437.64it/s] 43%|██████████████████████████████▋                                         | 4146/9741 [00:10<00:12, 438.81it/s] 43%|██████████████████████████████▉                                         | 4191/9741 [00:10<00:12, 439.45it/s] 43%|███████████████████████████████▎                                        | 4236/9741 [00:10<00:12, 439.81it/s] 44%|███████████████████████████████▋                                        | 4281/9741 [00:10<00:12, 440.60it/s] 44%|███████████████████████████████▉                                        | 4326/9741 [00:10<00:12, 438.52it/s] 45%|████████████████████████████████▎                                       | 4371/9741 [00:10<00:12, 439.49it/s] 45%|████████████████████████████████▋                                       | 4415/9741 [00:10<00:12, 439.48it/s] 46%|████████████████████████████████▉                                       | 4459/9741 [00:10<00:12, 439.07it/s] 46%|█████████████████████████████████▎                                      | 4504/9741 [00:11<00:11, 439.97it/s] 47%|█████████████████████████████████▌                                      | 4548/9741 [00:11<00:13, 395.04it/s] 47%|█████████████████████████████████▉                                      | 4593/9741 [00:11<00:12, 408.27it/s] 48%|██████████████████████████████████▎                                     | 4638/9741 [00:11<00:12, 417.70it/s] 48%|██████████████████████████████████▌                                     | 4683/9741 [00:11<00:11, 424.95it/s] 49%|██████████████████████████████████▉                                     | 4728/9741 [00:11<00:11, 430.05it/s] 49%|███████████████████████████████████▎                                    | 4772/9741 [00:11<00:16, 304.61it/s] 49%|███████████████████████████████████▌                                    | 4817/9741 [00:11<00:14, 335.78it/s] 50%|███████████████████████████████████▉                                    | 4862/9741 [00:12<00:13, 361.80it/s] 50%|████████████████████████████████████▎                                   | 4907/9741 [00:12<00:12, 382.59it/s] 51%|████████████████████████████████████▌                                   | 4950/9741 [00:12<00:12, 393.05it/s] 51%|████████████████████████████████████▉                                   | 4995/9741 [00:12<00:11, 406.29it/s] 52%|█████████████████████████████████████▏                                  | 5039/9741 [00:12<00:11, 415.63it/s] 52%|█████████████████████████████████████▌                                  | 5084/9741 [00:12<00:11, 423.06it/s] 53%|█████████████████████████████████████▉                                  | 5128/9741 [00:12<00:10, 427.80it/s] 53%|██████████████████████████████████████▏                                 | 5172/9741 [00:12<00:10, 429.54it/s] 54%|██████████████████████████████████████▌                                 | 5217/9741 [00:12<00:10, 432.76it/s] 54%|██████████████████████████████████████▉                                 | 5262/9741 [00:12<00:10, 435.01it/s] 54%|███████████████████████████████████████▏                                | 5307/9741 [00:13<00:10, 436.73it/s] 55%|███████████████████████████████████████▌                                | 5352/9741 [00:13<00:10, 438.35it/s] 55%|███████████████████████████████████████▉                                | 5397/9741 [00:13<00:09, 436.69it/s] 56%|████████████████████████████████████████▏                               | 5442/9741 [00:13<00:09, 437.92it/s] 56%|████████████████████████████████████████▌                               | 5487/9741 [00:13<00:09, 439.29it/s] 57%|████████████████████████████████████████▉                               | 5533/9741 [00:13<00:09, 444.41it/s] 57%|█████████████████████████████████████████▏                              | 5579/9741 [00:13<00:09, 447.93it/s] 58%|█████████████████████████████████████████▌                              | 5624/9741 [00:13<00:09, 447.46it/s] 58%|█████████████████████████████████████████▉                              | 5669/9741 [00:13<00:09, 447.47it/s] 59%|██████████████████████████████████████████▏                             | 5715/9741 [00:13<00:08, 449.94it/s] 59%|██████████████████████████████████████████▌                             | 5761/9741 [00:14<00:08, 451.12it/s] 60%|██████████████████████████████████████████▉                             | 5807/9741 [00:14<00:08, 451.55it/s] 60%|███████████████████████████████████████████▎                            | 5853/9741 [00:14<00:08, 432.25it/s] 61%|███████████████████████████████████████████▌                            | 5899/9741 [00:14<00:08, 439.08it/s] 61%|███████████████████████████████████████████▉                            | 5945/9741 [00:14<00:08, 444.30it/s] 62%|████████████████████████████████████████████▎                           | 5991/9741 [00:14<00:08, 448.11it/s] 62%|████████████████████████████████████████████▌                           | 6037/9741 [00:14<00:08, 450.49it/s] 62%|████████████████████████████████████████████▉                           | 6083/9741 [00:14<00:08, 449.11it/s] 63%|█████████████████████████████████████████████▎                          | 6129/9741 [00:14<00:08, 450.86it/s] 63%|█████████████████████████████████████████████▋                          | 6175/9741 [00:14<00:07, 452.49it/s] 64%|█████████████████████████████████████████████▉                          | 6221/9741 [00:15<00:07, 453.74it/s] 64%|██████████████████████████████████████████████▎                         | 6267/9741 [00:15<00:07, 452.88it/s] 65%|██████████████████████████████████████████████▋                         | 6313/9741 [00:15<00:07, 451.56it/s] 65%|███████████████████████████████████████████████                         | 6359/9741 [00:15<00:07, 452.53it/s] 66%|███████████████████████████████████████████████▎                        | 6405/9741 [00:15<00:07, 453.64it/s] 66%|███████████████████████████████████████████████▋                        | 6451/9741 [00:15<00:07, 453.86it/s] 67%|████████████████████████████████████████████████                        | 6497/9741 [00:15<00:07, 454.50it/s] 67%|████████████████████████████████████████████████▎                       | 6543/9741 [00:15<00:07, 452.23it/s] 68%|████████████████████████████████████████████████▋                       | 6589/9741 [00:15<00:06, 453.30it/s] 68%|█████████████████████████████████████████████████                       | 6635/9741 [00:15<00:06, 453.80it/s] 69%|█████████████████████████████████████████████████▍                      | 6681/9741 [00:16<00:06, 454.50it/s] 69%|█████████████████████████████████████████████████▋                      | 6727/9741 [00:16<00:06, 454.94it/s] 70%|██████████████████████████████████████████████████                      | 6773/9741 [00:16<00:06, 452.56it/s] 70%|██████████████████████████████████████████████████▍                     | 6819/9741 [00:16<00:06, 453.73it/s] 70%|██████████████████████████████████████████████████▋                     | 6865/9741 [00:16<00:06, 454.97it/s] 71%|███████████████████████████████████████████████████                     | 6911/9741 [00:16<00:06, 455.49it/s] 71%|███████████████████████████████████████████████████▍                    | 6957/9741 [00:16<00:06, 456.29it/s] 72%|███████████████████████████████████████████████████▊                    | 7003/9741 [00:16<00:06, 453.74it/s] 72%|████████████████████████████████████████████████████                    | 7049/9741 [00:16<00:05, 454.59it/s] 73%|████████████████████████████████████████████████████▍                   | 7095/9741 [00:17<00:05, 455.30it/s] 73%|████████████████████████████████████████████████████▊                   | 7141/9741 [00:17<00:05, 455.63it/s] 74%|█████████████████████████████████████████████████████                   | 7187/9741 [00:17<00:05, 455.59it/s] 74%|█████████████████████████████████████████████████████▍                  | 7233/9741 [00:17<00:05, 451.97it/s] 75%|█████████████████████████████████████████████████████▊                  | 7279/9741 [00:17<00:05, 452.00it/s] 75%|██████████████████████████████████████████████████████▏                 | 7325/9741 [00:17<00:05, 453.30it/s] 76%|██████████████████████████████████████████████████████▍                 | 7371/9741 [00:17<00:05, 454.27it/s] 76%|██████████████████████████████████████████████████████▊                 | 7417/9741 [00:17<00:05, 454.42it/s] 77%|███████████████████████████████████████████████████████▏                | 7463/9741 [00:17<00:05, 425.59it/s] 77%|███████████████████████████████████████████████████████▌                | 7509/9741 [00:17<00:05, 434.09it/s] 78%|███████████████████████████████████████████████████████▊                | 7555/9741 [00:18<00:04, 440.40it/s] 78%|████████████████████████████████████████████████████████▏               | 7601/9741 [00:18<00:04, 445.08it/s] 79%|████████████████████████████████████████████████████████▌               | 7647/9741 [00:18<00:04, 448.29it/s] 79%|████████████████████████████████████████████████████████▊               | 7692/9741 [00:18<00:04, 448.02it/s] 79%|█████████████████████████████████████████████████████████▏              | 7738/9741 [00:18<00:04, 449.61it/s] 80%|█████████████████████████████████████████████████████████▌              | 7784/9741 [00:18<00:04, 450.63it/s] 80%|█████████████████████████████████████████████████████████▊              | 7830/9741 [00:18<00:04, 452.16it/s] 81%|██████████████████████████████████████████████████████████▏             | 7876/9741 [00:18<00:04, 453.14it/s] 81%|██████████████████████████████████████████████████████████▌             | 7922/9741 [00:18<00:04, 452.24it/s] 82%|██████████████████████████████████████████████████████████▉             | 7968/9741 [00:18<00:03, 451.41it/s] 82%|███████████████████████████████████████████████████████████▏            | 8014/9741 [00:19<00:03, 452.74it/s] 83%|███████████████████████████████████████████████████████████▌            | 8060/9741 [00:19<00:03, 453.74it/s] 83%|███████████████████████████████████████████████████████████▉            | 8106/9741 [00:19<00:03, 454.30it/s] 84%|████████████████████████████████████████████████████████████▎           | 8152/9741 [00:19<00:03, 452.76it/s] 84%|████████████████████████████████████████████████████████████▌           | 8198/9741 [00:19<00:03, 453.29it/s] 85%|████████████████████████████████████████████████████████████▉           | 8244/9741 [00:19<00:03, 453.55it/s] 85%|█████████████████████████████████████████████████████████████▎          | 8290/9741 [00:19<00:03, 453.97it/s] 86%|█████████████████████████████████████████████████████████████▌          | 8336/9741 [00:19<00:03, 454.39it/s] 86%|█████████████████████████████████████████████████████████████▉          | 8382/9741 [00:19<00:03, 452.83it/s] 87%|██████████████████████████████████████████████████████████████▎         | 8428/9741 [00:19<00:02, 453.99it/s] 87%|██████████████████████████████████████████████████████████████▋         | 8474/9741 [00:20<00:02, 454.58it/s] 87%|██████████████████████████████████████████████████████████████▉         | 8520/9741 [00:20<00:02, 455.46it/s] 88%|███████████████████████████████████████████████████████████████▎        | 8566/9741 [00:20<00:02, 455.60it/s] 88%|███████████████████████████████████████████████████████████████▋        | 8612/9741 [00:20<00:02, 453.22it/s] 89%|███████████████████████████████████████████████████████████████▉        | 8658/9741 [00:20<00:02, 454.16it/s] 89%|████████████████████████████████████████████████████████████████▎       | 8704/9741 [00:20<00:02, 454.41it/s] 90%|████████████████████████████████████████████████████████████████▋       | 8750/9741 [00:20<00:02, 449.01it/s] 90%|█████████████████████████████████████████████████████████████████       | 8796/9741 [00:20<00:02, 450.76it/s] 91%|█████████████████████████████████████████████████████████████████▎      | 8842/9741 [00:20<00:01, 449.86it/s] 91%|█████████████████████████████████████████████████████████████████▋      | 8888/9741 [00:20<00:01, 451.93it/s] 92%|██████████████████████████████████████████████████████████████████      | 8934/9741 [00:21<00:01, 453.10it/s] 92%|██████████████████████████████████████████████████████████████████▍     | 8980/9741 [00:21<00:01, 453.90it/s] 93%|██████████████████████████████████████████████████████████████████▋     | 9026/9741 [00:21<00:01, 454.49it/s] 93%|███████████████████████████████████████████████████████████████████     | 9072/9741 [00:21<00:01, 452.64it/s] 94%|███████████████████████████████████████████████████████████████████▍    | 9118/9741 [00:21<00:01, 453.43it/s] 94%|███████████████████████████████████████████████████████████████████▋    | 9164/9741 [00:21<00:01, 453.94it/s] 95%|████████████████████████████████████████████████████████████████████    | 9210/9741 [00:21<00:01, 453.41it/s] 95%|████████████████████████████████████████████████████████████████████▍   | 9256/9741 [00:21<00:01, 450.02it/s] 95%|████████████████████████████████████████████████████████████████████▊   | 9302/9741 [00:21<00:00, 451.01it/s] 96%|█████████████████████████████████████████████████████████████████████   | 9348/9741 [00:22<00:00, 452.43it/s] 96%|█████████████████████████████████████████████████████████████████████▍  | 9394/9741 [00:22<00:00, 453.50it/s] 97%|█████████████████████████████████████████████████████████████████████▊  | 9440/9741 [00:22<00:00, 454.43it/s] 97%|██████████████████████████████████████████████████████████████████████  | 9486/9741 [00:22<00:00, 452.52it/s] 98%|██████████████████████████████████████████████████████████████████████▍ | 9532/9741 [00:22<00:00, 449.22it/s] 98%|██████████████████████████████████████████████████████████████████████▊ | 9578/9741 [00:22<00:00, 451.05it/s] 99%|███████████████████████████████████████████████████████████████████████▏| 9624/9741 [00:22<00:00, 451.95it/s] 99%|███████████████████████████████████████████████████████████████████████▍| 9670/9741 [00:22<00:00, 452.66it/s]100%|███████████████████████████████████████████████████████████████████████▊| 9716/9741 [00:22<00:00, 448.04it/s]100%|████████████████████████████████████████████████████████████████████████| 9741/9741 [00:22<00:00, 425.83it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:04<00:09,  4.98s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:04<00:09,  4.88s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:11,  5.52s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:11,  5.91s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:09<00:04,  4.98s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:09<00:04,  4.98s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.40s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:11<00:05,  5.53s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.39s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.55s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.38s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.53s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.76s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.95s/it]
[2023-08-14 04:33:55,177] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:15<00:00,  4.81s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.05s/it]
[2023-08-14 04:34:04,617] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-14 04:34:04,618] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-14 04:34:04,618] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-14 04:34:04,618] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-14 04:34:04,618] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-14 04:34:04,618] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f9256919fd0>
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f922a9e2cd0>
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-14 04:34:04,619] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-14 04:34:04,620] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-14 04:34:04,620] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-14 04:34:04,620] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-14 04:34:04,620] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-14 04:34:04,620] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-14 04:34:04,620] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-14 04:34:04,620] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-14 04:34:04,620] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-14 04:34:04,620] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-14 04:34:04,620] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-14 04:34:04,620] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-14 04:34:04,620] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-14 04:34:04,620] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-14 04:34:04,620] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-14 04:34:04,620] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-14 04:34:04,620] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.5043237209320068 seconds
Loading extension module utils...
Time to load utils op: 0.4043083190917969 seconds
Loading extension module utils...
Time to load utils op: 0.5047342777252197 seconds
Loading extension module utils...
Time to load utils op: 0.5048122406005859 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                                           | 0/50 [00:00<?, ?it/s]############### Example ###############
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following multiple choice question.

### Demonstration:
Input: Mary had 89 stickers.  She used 3 large stickers on the front page of her journal and 7 stickers each to 6 other pages of her journal. How many stickers does Mary have remaining?
Answer: 44

Input: Zach is saving his money to buy a brand new bike that costs $100.  His weekly allowance is $5.  His parent will pay him an extra $10 to mow the lawn.  His neighbor will pay him $7 per hour to babysit their son.  He has already saved up $65.  He'll receive his allowance on Friday and he's planning on babysitting for 2 hours this Saturday after he mows the lawn.  How much more money does Zach need to earn before he can buy the bike?
Answer: 6

Input: Mark has kangaroos and goats.  Kangaroos have two legs and goats have four legs.  If he has 23 kangaroos and three times as many goats as kangaroos what is the total number of legs of all his animals?
Answer: 322

Input: Josh’s mom gives him $20 to go shopping at the mall. He buys a hat for $10 and a pencil for $2. Then he buys four cookies. If each cookie costs $1.25, how much money does Josh have left?
Answer: 3

Input: George's bowling team is one round away from breaking the league record for most points scored in a season. The old record is an average score per player of 287 per round. Each team has 4 players and there are 10 rounds in the season. Through the first 9 rounds, his team has scored a total of 10,440. How many points less than the current league record per game average is the minimum average they need to score, per player, in the final round to tie the league record?
Answer: 27

Input: Max was doing homework in three different subjects. It took him 20 minutes to finish tasks from biology and two times more time to finish history. Geography took him the most time, three times more than history. How much time did Max spend on doing his homework?
Answer: 180

Input: Sophia ate 1/6 of her pie and she put the rest on the fridge. If the pie left in the fridge weighs 1200 grams, how many grams did Sophia eat?
Answer: 240

Input: Sarah, Mary, and Tuan decided to go to the restaurant for a meal. They decided to split the cost of the meal evenly. If the total price of the meal comes to $67 and they have a coupon for $4, how much does each person need to contribute to the bill?
Answer: 21

Input: Tom's brother is 4 times as old as Tom's dog. If in 6 years, Tom's brother will be 30 years, how old is Tom's dog going to be in six years?
Answer: 12

Input: There are 50 children at the party. Three-fifths of them are boys. How many of the children are girls?
Answer: 20

Input: Gail has some bills in her wallet which amount to $100. She has four $5 bills and three $20 bills, and the rest are $10 bills. How many $10 bills are in her wallet?
Answer: 2

Input: A 220-liter barrel has a small leak. It lost 10% of its contents before anyone noticed. How many liters are left in the barrel?
Answer: 198

Input: Markese earned 5 fewer dollars than Evan. Together they earned $37. How many dollars did Markese earn? Use E to represent how many dollars Evan earned.
Answer: 16

Input: Lou Senior took 3 cookies out of the cookie jar and ate them.  Since he didn't get caught by his wife, he went back the next day and took another 3 cookies out of the jar.  But after eating just one of the cookies, he felt guilty about it and put the other two cookies back.  His son, Louie Junior saw that his Dad was eating cookies.  So, Louie Junior took seven cookies out of the jar and hid them in his bedroom for later.  The next morning, Debra, Lou's wife looked into the cookie jar and reacted by accusing her husband of eating half of the cookies out of the cookie jar.  How many cookies remained in the jar?
Answer: 11

Input: John had $200. He gave 3/8 of his money to his mother and 3/10 to his father. How much money did John have left?
Answer: 65

### Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid

### Response:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o15-tgsm8k-s1-rFalse
Evaluating commonsenseqa :   2%|█                                                  | 1/50 [00:43<35:26, 43.40s/it]Evaluating commonsenseqa :   4%|██                                                 | 2/50 [01:26<34:36, 43.27s/it]Evaluating commonsenseqa :   6%|███                                                | 3/50 [02:09<33:51, 43.23s/it]Evaluating commonsenseqa :   8%|████                                               | 4/50 [02:52<33:01, 43.08s/it]Evaluating commonsenseqa :  10%|█████                                              | 5/50 [03:35<32:20, 43.13s/it]Evaluating commonsenseqa :  12%|██████                                             | 6/50 [04:18<31:35, 43.08s/it]Evaluating commonsenseqa :  14%|███████▏                                           | 7/50 [05:01<30:48, 42.99s/it]Evaluating commonsenseqa :  16%|████████▏                                          | 8/50 [05:44<30:10, 43.10s/it]Evaluating commonsenseqa :  18%|█████████▏                                         | 9/50 [06:27<29:18, 42.90s/it]Evaluating commonsenseqa :  20%|██████████                                        | 10/50 [07:10<28:38, 42.96s/it]Evaluating commonsenseqa :  22%|███████████                                       | 11/50 [07:53<27:55, 42.96s/it]Evaluating commonsenseqa :  24%|████████████                                      | 12/50 [08:36<27:13, 42.98s/it]Evaluating commonsenseqa :  26%|█████████████                                     | 13/50 [09:19<26:31, 43.01s/it]Evaluating commonsenseqa :  28%|██████████████                                    | 14/50 [10:02<25:46, 42.94s/it]Evaluating commonsenseqa :  30%|███████████████                                   | 15/50 [10:45<25:05, 43.00s/it]Evaluating commonsenseqa :  32%|████████████████                                  | 16/50 [11:28<24:22, 43.02s/it]Evaluating commonsenseqa :  34%|█████████████████                                 | 17/50 [12:12<23:44, 43.17s/it]Evaluating commonsenseqa :  36%|██████████████████                                | 18/50 [12:55<23:06, 43.33s/it]Evaluating commonsenseqa :  38%|███████████████████                               | 19/50 [13:38<22:21, 43.29s/it]Evaluating commonsenseqa :  40%|████████████████████                              | 20/50 [14:22<21:37, 43.24s/it]Evaluating commonsenseqa :  42%|█████████████████████                             | 21/50 [15:05<20:51, 43.16s/it]Evaluating commonsenseqa :  44%|██████████████████████                            | 22/50 [15:48<20:13, 43.32s/it]Evaluating commonsenseqa :  46%|███████████████████████                           | 23/50 [16:26<18:45, 41.69s/it]Evaluating commonsenseqa :  48%|████████████████████████                          | 24/50 [17:09<18:11, 41.97s/it]Evaluating commonsenseqa :  50%|█████████████████████████                         | 25/50 [17:21<13:45, 33.02s/it]Evaluating commonsenseqa :  52%|██████████████████████████                        | 26/50 [17:59<13:49, 34.55s/it]Evaluating commonsenseqa :  54%|███████████████████████████                       | 27/50 [18:23<11:58, 31.23s/it]Evaluating commonsenseqa :  56%|████████████████████████████                      | 28/50 [19:06<12:46, 34.85s/it]Evaluating commonsenseqa :  58%|████████████████████████████▉                     | 29/50 [19:26<10:41, 30.53s/it]Evaluating commonsenseqa :  60%|██████████████████████████████                    | 30/50 [20:09<11:25, 34.25s/it]Evaluating commonsenseqa :  62%|███████████████████████████████                   | 31/50 [20:53<11:44, 37.06s/it]Evaluating commonsenseqa :  64%|████████████████████████████████                  | 32/50 [21:36<11:41, 38.98s/it]Evaluating commonsenseqa :  66%|█████████████████████████████████                 | 33/50 [22:20<11:24, 40.26s/it]Evaluating commonsenseqa :  68%|██████████████████████████████████                | 34/50 [23:02<10:56, 41.03s/it]Evaluating commonsenseqa :  70%|███████████████████████████████████               | 35/50 [23:30<09:14, 36.98s/it]Evaluating commonsenseqa :  72%|████████████████████████████████████              | 36/50 [24:06<08:32, 36.58s/it]Evaluating commonsenseqa :  74%|█████████████████████████████████████             | 37/50 [24:48<08:20, 38.47s/it]Evaluating commonsenseqa :  76%|██████████████████████████████████████            | 38/50 [25:31<07:54, 39.57s/it]Evaluating commonsenseqa :  78%|███████████████████████████████████████           | 39/50 [26:13<07:26, 40.57s/it]Evaluating commonsenseqa :  80%|████████████████████████████████████████          | 40/50 [26:56<06:52, 41.24s/it]Evaluating commonsenseqa :  82%|█████████████████████████████████████████         | 41/50 [27:39<06:14, 41.59s/it]Evaluating commonsenseqa :  84%|██████████████████████████████████████████        | 42/50 [28:21<05:35, 41.92s/it]Evaluating commonsenseqa :  86%|███████████████████████████████████████████       | 43/50 [29:04<04:54, 42.14s/it]Evaluating commonsenseqa :  88%|████████████████████████████████████████████      | 44/50 [29:47<04:14, 42.33s/it]Evaluating commonsenseqa :  90%|█████████████████████████████████████████████     | 45/50 [30:30<03:32, 42.46s/it]Evaluating commonsenseqa :  92%|██████████████████████████████████████████████    | 46/50 [31:13<02:51, 42.76s/it]Evaluating commonsenseqa :  94%|███████████████████████████████████████████████   | 47/50 [31:56<02:08, 42.77s/it]Evaluating commonsenseqa :  96%|████████████████████████████████████████████████  | 48/50 [32:39<01:25, 42.82s/it]Evaluating commonsenseqa :  98%|█████████████████████████████████████████████████ | 49/50 [33:22<00:42, 42.82s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████| 50/50 [34:05<00:00, 42.92s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████| 50/50 [34:05<00:00, 40.90s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 3.1278} | lm_loss 7.8677 | avg. gen lenth: 277.78
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name gsm8k --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/out-domain/o16-tgsm8k-s1-rFalse --seed 1 --num-out-domain 16
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-14 05:09:33,424] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/out-domain/o16-tgsm8k-s1-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 16
  out_domain_data_name ......... gsm8k
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o16-tgsm8k-s1-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                    | 0/9741 [00:00<?, ?it/s]  0%|▏                                                                         | 28/9741 [00:00<00:35, 274.57it/s]  1%|▍                                                                         | 56/9741 [00:00<00:35, 275.84it/s]  1%|▋                                                                         | 84/9741 [00:00<00:34, 276.51it/s]  1%|▊                                                                        | 112/9741 [00:00<00:34, 277.11it/s]  1%|█                                                                        | 140/9741 [00:00<00:34, 277.21it/s]  2%|█▎                                                                       | 168/9741 [00:00<00:34, 277.41it/s]  2%|█▍                                                                       | 196/9741 [00:00<00:34, 273.87it/s]  2%|█▋                                                                       | 224/9741 [00:00<00:34, 272.76it/s]  3%|█▉                                                                       | 252/9741 [00:00<00:34, 273.76it/s]  3%|██                                                                       | 280/9741 [00:01<00:34, 274.58it/s]  3%|██▎                                                                      | 308/9741 [00:01<00:34, 275.16it/s]  3%|██▌                                                                      | 336/9741 [00:01<00:34, 275.18it/s]  4%|██▋                                                                      | 364/9741 [00:01<00:34, 275.26it/s]  4%|██▉                                                                      | 392/9741 [00:01<00:33, 276.30it/s]  4%|███▏                                                                     | 420/9741 [00:01<00:33, 276.40it/s]  5%|███▎                                                                     | 448/9741 [00:01<00:33, 274.97it/s]  5%|███▌                                                                     | 476/9741 [00:01<00:33, 273.03it/s]  5%|███▊                                                                     | 504/9741 [00:01<00:33, 274.17it/s]  5%|███▉                                                                     | 532/9741 [00:01<00:33, 274.95it/s]  6%|████▏                                                                    | 560/9741 [00:02<00:33, 275.02it/s]  6%|████▍                                                                    | 588/9741 [00:02<00:33, 275.45it/s]  6%|████▋                                                                    | 625/9741 [00:02<00:30, 302.03it/s]  7%|████▉                                                                    | 667/9741 [00:02<00:27, 335.82it/s]  7%|█████▎                                                                   | 709/9741 [00:02<00:25, 360.79it/s]  8%|█████▋                                                                   | 752/9741 [00:02<00:23, 378.77it/s]  8%|█████▉                                                                   | 795/9741 [00:02<00:22, 391.42it/s]  9%|██████▎                                                                  | 838/9741 [00:02<00:22, 400.11it/s]  9%|██████▌                                                                  | 881/9741 [00:02<00:21, 404.60it/s]  9%|██████▉                                                                  | 923/9741 [00:02<00:21, 408.91it/s] 10%|███████▏                                                                 | 965/9741 [00:03<00:21, 410.71it/s] 10%|███████▍                                                                | 1007/9741 [00:03<00:21, 411.93it/s] 11%|███████▊                                                                | 1049/9741 [00:03<00:20, 414.10it/s] 11%|████████                                                                | 1092/9741 [00:03<00:20, 415.97it/s] 12%|████████▍                                                               | 1134/9741 [00:03<00:20, 414.88it/s] 12%|████████▋                                                               | 1176/9741 [00:03<00:20, 416.03it/s] 13%|█████████                                                               | 1218/9741 [00:03<00:20, 416.62it/s] 13%|█████████▎                                                              | 1260/9741 [00:03<00:20, 417.60it/s] 13%|█████████▌                                                              | 1302/9741 [00:03<00:20, 418.22it/s] 14%|█████████▉                                                              | 1344/9741 [00:03<00:20, 416.65it/s] 14%|██████████▏                                                             | 1386/9741 [00:04<00:20, 417.06it/s] 15%|██████████▌                                                             | 1428/9741 [00:04<00:19, 417.27it/s] 15%|██████████▊                                                             | 1470/9741 [00:04<00:19, 417.82it/s] 16%|███████████▏                                                            | 1512/9741 [00:04<00:19, 414.72it/s] 16%|███████████▍                                                            | 1555/9741 [00:04<00:19, 416.56it/s] 16%|███████████▊                                                            | 1597/9741 [00:04<00:19, 413.74it/s] 17%|████████████                                                            | 1639/9741 [00:04<00:19, 415.48it/s] 17%|████████████▍                                                           | 1681/9741 [00:04<00:19, 416.15it/s] 18%|████████████▋                                                           | 1723/9741 [00:04<00:19, 416.97it/s] 18%|█████████████                                                           | 1765/9741 [00:04<00:19, 417.49it/s] 19%|█████████████▎                                                          | 1807/9741 [00:05<00:20, 393.84it/s] 19%|█████████████▋                                                          | 1849/9741 [00:05<00:19, 400.50it/s] 19%|█████████████▉                                                          | 1891/9741 [00:05<00:19, 405.54it/s] 20%|██████████████▎                                                         | 1933/9741 [00:05<00:19, 409.07it/s] 20%|██████████████▌                                                         | 1975/9741 [00:05<00:18, 411.70it/s] 21%|██████████████▉                                                         | 2017/9741 [00:05<00:18, 411.89it/s] 21%|███████████████▏                                                        | 2059/9741 [00:05<00:18, 411.10it/s] 22%|███████████████▌                                                        | 2101/9741 [00:05<00:18, 412.42it/s] 22%|███████████████▊                                                        | 2143/9741 [00:05<00:18, 413.91it/s] 22%|████████████████▏                                                       | 2185/9741 [00:06<00:18, 414.92it/s] 23%|████████████████▍                                                       | 2227/9741 [00:06<00:18, 415.79it/s] 23%|████████████████▊                                                       | 2269/9741 [00:06<00:18, 414.28it/s] 24%|█████████████████                                                       | 2311/9741 [00:06<00:17, 415.47it/s] 24%|█████████████████▍                                                      | 2353/9741 [00:06<00:17, 416.12it/s] 25%|█████████████████▋                                                      | 2395/9741 [00:06<00:17, 416.62it/s] 25%|██████████████████                                                      | 2437/9741 [00:06<00:17, 417.21it/s] 25%|██████████████████▎                                                     | 2479/9741 [00:06<00:17, 415.14it/s] 26%|██████████████████▋                                                     | 2521/9741 [00:06<00:17, 415.84it/s] 26%|██████████████████▉                                                     | 2563/9741 [00:06<00:17, 416.12it/s] 27%|███████████████████▎                                                    | 2605/9741 [00:07<00:17, 416.64it/s] 27%|███████████████████▌                                                    | 2647/9741 [00:07<00:17, 416.55it/s] 28%|███████████████████▉                                                    | 2689/9741 [00:07<00:16, 416.44it/s] 28%|████████████████████▏                                                   | 2731/9741 [00:07<00:16, 413.89it/s] 28%|████████████████████▍                                                   | 2773/9741 [00:07<00:16, 414.24it/s] 29%|████████████████████▊                                                   | 2815/9741 [00:07<00:16, 414.56it/s] 29%|█████████████████████                                                   | 2857/9741 [00:07<00:16, 415.25it/s] 30%|█████████████████████▍                                                  | 2899/9741 [00:07<00:16, 415.63it/s] 30%|█████████████████████▋                                                  | 2941/9741 [00:07<00:16, 414.25it/s] 31%|██████████████████████                                                  | 2983/9741 [00:07<00:16, 414.89it/s] 31%|██████████████████████▎                                                 | 3025/9741 [00:08<00:16, 415.88it/s] 31%|██████████████████████▋                                                 | 3067/9741 [00:08<00:16, 415.96it/s] 32%|██████████████████████▉                                                 | 3109/9741 [00:08<00:15, 416.25it/s] 32%|███████████████████████▎                                                | 3151/9741 [00:08<00:15, 414.52it/s] 33%|███████████████████████▌                                                | 3193/9741 [00:08<00:15, 415.35it/s] 33%|███████████████████████▉                                                | 3235/9741 [00:08<00:15, 415.88it/s] 34%|████████████████████████▏                                               | 3277/9741 [00:08<00:15, 416.33it/s] 34%|████████████████████████▌                                               | 3319/9741 [00:08<00:15, 416.60it/s] 35%|████████████████████████▊                                               | 3361/9741 [00:08<00:15, 416.35it/s] 35%|█████████████████████████▏                                              | 3403/9741 [00:08<00:15, 414.28it/s] 35%|█████████████████████████▍                                              | 3445/9741 [00:09<00:15, 413.77it/s] 36%|█████████████████████████▊                                              | 3487/9741 [00:09<00:15, 414.53it/s] 36%|██████████████████████████                                              | 3529/9741 [00:09<00:14, 414.84it/s] 37%|██████████████████████████▍                                             | 3571/9741 [00:09<00:14, 414.92it/s] 37%|██████████████████████████▋                                             | 3613/9741 [00:09<00:14, 413.41it/s] 38%|███████████████████████████                                             | 3655/9741 [00:09<00:14, 414.44it/s] 38%|███████████████████████████▎                                            | 3697/9741 [00:09<00:14, 415.48it/s] 38%|███████████████████████████▋                                            | 3739/9741 [00:09<00:14, 416.23it/s] 39%|███████████████████████████▉                                            | 3781/9741 [00:09<00:14, 416.41it/s] 39%|████████████████████████████▎                                           | 3823/9741 [00:09<00:14, 416.50it/s] 40%|████████████████████████████▌                                           | 3865/9741 [00:10<00:14, 414.73it/s] 40%|████████████████████████████▉                                           | 3907/9741 [00:10<00:14, 415.18it/s] 41%|█████████████████████████████▏                                          | 3949/9741 [00:10<00:13, 415.28it/s] 41%|█████████████████████████████▍                                          | 3991/9741 [00:10<00:13, 415.54it/s] 41%|█████████████████████████████▊                                          | 4033/9741 [00:10<00:13, 416.53it/s] 42%|██████████████████████████████                                          | 4075/9741 [00:10<00:13, 415.46it/s] 42%|██████████████████████████████▍                                         | 4117/9741 [00:10<00:13, 416.19it/s] 43%|██████████████████████████████▋                                         | 4159/9741 [00:10<00:13, 417.06it/s] 43%|███████████████████████████████                                         | 4201/9741 [00:10<00:13, 417.27it/s] 44%|███████████████████████████████▎                                        | 4243/9741 [00:10<00:13, 417.38it/s] 44%|███████████████████████████████▋                                        | 4285/9741 [00:11<00:13, 414.99it/s] 44%|███████████████████████████████▉                                        | 4327/9741 [00:11<00:13, 415.73it/s] 45%|████████████████████████████████▎                                       | 4369/9741 [00:11<00:12, 416.20it/s] 45%|████████████████████████████████▌                                       | 4411/9741 [00:11<00:12, 416.56it/s] 46%|████████████████████████████████▉                                       | 4453/9741 [00:11<00:12, 416.61it/s] 46%|█████████████████████████████████▏                                      | 4495/9741 [00:11<00:12, 416.69it/s] 47%|█████████████████████████████████▌                                      | 4537/9741 [00:11<00:13, 389.45it/s] 47%|█████████████████████████████████▊                                      | 4579/9741 [00:11<00:13, 397.01it/s] 47%|██████████████████████████████████▏                                     | 4621/9741 [00:11<00:12, 402.47it/s] 48%|██████████████████████████████████▍                                     | 4663/9741 [00:11<00:12, 406.28it/s] 48%|██████████████████████████████████▊                                     | 4705/9741 [00:12<00:12, 409.29it/s] 49%|███████████████████████████████████                                     | 4747/9741 [00:12<00:15, 315.10it/s] 49%|███████████████████████████████████▍                                    | 4789/9741 [00:12<00:14, 339.34it/s] 50%|███████████████████████████████████▋                                    | 4830/9741 [00:12<00:13, 356.31it/s] 50%|████████████████████████████████████                                    | 4872/9741 [00:12<00:13, 371.67it/s] 50%|████████████████████████████████████▎                                   | 4914/9741 [00:12<00:12, 383.48it/s] 51%|████████████████████████████████████▌                                   | 4955/9741 [00:12<00:12, 390.23it/s] 51%|████████████████████████████████████▉                                   | 4997/9741 [00:12<00:11, 397.08it/s] 52%|█████████████████████████████████████▏                                  | 5039/9741 [00:12<00:11, 402.32it/s] 52%|█████████████████████████████████████▌                                  | 5081/9741 [00:13<00:11, 405.52it/s] 53%|█████████████████████████████████████▊                                  | 5123/9741 [00:13<00:11, 408.32it/s] 53%|██████████████████████████████████████▏                                 | 5165/9741 [00:13<00:11, 410.10it/s] 53%|██████████████████████████████████████▍                                 | 5207/9741 [00:13<00:11, 408.58it/s] 54%|██████████████████████████████████████▊                                 | 5249/9741 [00:13<00:10, 409.49it/s] 54%|███████████████████████████████████████                                 | 5291/9741 [00:13<00:10, 410.17it/s] 55%|███████████████████████████████████████▍                                | 5333/9741 [00:13<00:10, 411.24it/s] 55%|███████████████████████████████████████▋                                | 5375/9741 [00:13<00:10, 412.07it/s] 56%|████████████████████████████████████████                                | 5417/9741 [00:13<00:10, 410.44it/s] 56%|████████████████████████████████████████▎                               | 5459/9741 [00:14<00:10, 411.10it/s] 56%|████████████████████████████████████████▋                               | 5501/9741 [00:14<00:10, 411.81it/s] 57%|████████████████████████████████████████▉                               | 5544/9741 [00:14<00:10, 416.67it/s] 57%|█████████████████████████████████████████▎                              | 5587/9741 [00:14<00:09, 420.10it/s] 58%|█████████████████████████████████████████▌                              | 5630/9741 [00:14<00:09, 420.36it/s] 58%|█████████████████████████████████████████▉                              | 5673/9741 [00:14<00:09, 422.88it/s] 59%|██████████████████████████████████████████▏                             | 5716/9741 [00:14<00:09, 424.80it/s] 59%|██████████████████████████████████████████▌                             | 5759/9741 [00:14<00:09, 426.04it/s] 60%|██████████████████████████████████████████▉                             | 5802/9741 [00:14<00:09, 426.43it/s] 60%|███████████████████████████████████████████▏                            | 5845/9741 [00:14<00:09, 426.74it/s] 60%|███████████████████████████████████████████▌                            | 5888/9741 [00:15<00:09, 425.25it/s] 61%|███████████████████████████████████████████▊                            | 5931/9741 [00:15<00:08, 426.58it/s] 61%|████████████████████████████████████████████▏                           | 5974/9741 [00:15<00:08, 427.12it/s] 62%|████████████████████████████████████████████▍                           | 6017/9741 [00:15<00:08, 427.56it/s] 62%|████████████████████████████████████████████▊                           | 6061/9741 [00:15<00:08, 428.44it/s] 63%|█████████████████████████████████████████████                           | 6104/9741 [00:15<00:08, 426.54it/s] 63%|█████████████████████████████████████████████▍                          | 6147/9741 [00:15<00:08, 427.26it/s] 64%|█████████████████████████████████████████████▊                          | 6190/9741 [00:15<00:08, 428.04it/s] 64%|██████████████████████████████████████████████                          | 6233/9741 [00:15<00:08, 424.56it/s] 64%|██████████████████████████████████████████████▍                         | 6276/9741 [00:15<00:08, 426.10it/s] 65%|██████████████████████████████████████████████▋                         | 6319/9741 [00:16<00:08, 425.32it/s] 65%|███████████████████████████████████████████████                         | 6362/9741 [00:16<00:07, 426.48it/s] 66%|███████████████████████████████████████████████▎                        | 6406/9741 [00:16<00:07, 427.74it/s] 66%|███████████████████████████████████████████████▋                        | 6450/9741 [00:16<00:07, 428.71it/s] 67%|███████████████████████████████████████████████▉                        | 6493/9741 [00:16<00:07, 428.68it/s] 67%|████████████████████████████████████████████████▎                       | 6536/9741 [00:16<00:07, 425.83it/s] 68%|████████████████████████████████████████████████▋                       | 6579/9741 [00:16<00:07, 426.56it/s] 68%|████████████████████████████████████████████████▉                       | 6622/9741 [00:16<00:07, 427.18it/s] 68%|█████████████████████████████████████████████████▎                      | 6666/9741 [00:16<00:07, 428.05it/s] 69%|█████████████████████████████████████████████████▌                      | 6709/9741 [00:16<00:07, 427.99it/s] 69%|█████████████████████████████████████████████████▉                      | 6753/9741 [00:17<00:06, 428.70it/s] 70%|██████████████████████████████████████████████████▏                     | 6796/9741 [00:17<00:06, 427.26it/s] 70%|██████████████████████████████████████████████████▌                     | 6840/9741 [00:17<00:06, 428.20it/s] 71%|██████████████████████████████████████████████████▉                     | 6883/9741 [00:17<00:06, 428.57it/s] 71%|███████████████████████████████████████████████████▏                    | 6926/9741 [00:17<00:06, 428.82it/s] 72%|███████████████████████████████████████████████████▌                    | 6969/9741 [00:17<00:06, 425.14it/s] 72%|███████████████████████████████████████████████████▊                    | 7012/9741 [00:17<00:06, 422.59it/s] 72%|████████████████████████████████████████████████████▏                   | 7056/9741 [00:17<00:06, 424.87it/s] 73%|████████████████████████████████████████████████████▍                   | 7099/9741 [00:17<00:06, 426.13it/s] 73%|████████████████████████████████████████████████████▊                   | 7143/9741 [00:17<00:06, 427.33it/s] 74%|█████████████████████████████████████████████████████                   | 7186/9741 [00:18<00:05, 428.02it/s] 74%|█████████████████████████████████████████████████████▍                  | 7229/9741 [00:18<00:05, 426.14it/s] 75%|█████████████████████████████████████████████████████▊                  | 7272/9741 [00:18<00:05, 427.13it/s] 75%|██████████████████████████████████████████████████████                  | 7315/9741 [00:18<00:05, 427.84it/s] 76%|██████████████████████████████████████████████████████▍                 | 7358/9741 [00:18<00:05, 428.44it/s] 76%|██████████████████████████████████████████████████████▋                 | 7402/9741 [00:18<00:05, 429.16it/s] 76%|███████████████████████████████████████████████████████                 | 7445/9741 [00:18<00:05, 383.81it/s] 77%|███████████████████████████████████████████████████████▎                | 7488/9741 [00:18<00:05, 396.00it/s] 77%|███████████████████████████████████████████████████████▋                | 7531/9741 [00:18<00:05, 405.02it/s] 78%|███████████████████████████████████████████████████████▉                | 7575/9741 [00:19<00:05, 412.36it/s] 78%|████████████████████████████████████████████████████████▎               | 7618/9741 [00:19<00:05, 417.20it/s] 79%|████████████████████████████████████████████████████████▋               | 7661/9741 [00:19<00:04, 416.83it/s] 79%|████████████████████████████████████████████████████████▉               | 7704/9741 [00:19<00:04, 418.20it/s] 80%|█████████████████████████████████████████████████████████▎              | 7747/9741 [00:19<00:04, 421.44it/s] 80%|█████████████████████████████████████████████████████████▌              | 7790/9741 [00:19<00:04, 423.63it/s] 80%|█████████████████████████████████████████████████████████▉              | 7833/9741 [00:19<00:04, 425.33it/s] 81%|██████████████████████████████████████████████████████████▏             | 7876/9741 [00:19<00:04, 426.50it/s] 81%|██████████████████████████████████████████████████████████▌             | 7919/9741 [00:19<00:04, 425.53it/s] 82%|██████████████████████████████████████████████████████████▊             | 7962/9741 [00:19<00:04, 426.36it/s] 82%|███████████████████████████████████████████████████████████▏            | 8005/9741 [00:20<00:04, 426.81it/s] 83%|███████████████████████████████████████████████████████████▍            | 8048/9741 [00:20<00:03, 427.45it/s] 83%|███████████████████████████████████████████████████████████▊            | 8091/9741 [00:20<00:03, 428.02it/s] 84%|████████████████████████████████████████████████████████████            | 8134/9741 [00:20<00:03, 426.96it/s] 84%|████████████████████████████████████████████████████████████▍           | 8178/9741 [00:20<00:03, 427.78it/s] 84%|████████████████████████████████████████████████████████████▊           | 8221/9741 [00:20<00:03, 428.11it/s] 85%|█████████████████████████████████████████████████████████████           | 8264/9741 [00:20<00:03, 428.63it/s] 85%|█████████████████████████████████████████████████████████████▍          | 8307/9741 [00:20<00:03, 428.64it/s] 86%|█████████████████████████████████████████████████████████████▋          | 8350/9741 [00:20<00:03, 427.04it/s] 86%|██████████████████████████████████████████████████████████████          | 8393/9741 [00:20<00:03, 427.61it/s] 87%|██████████████████████████████████████████████████████████████▎         | 8437/9741 [00:21<00:03, 428.67it/s] 87%|██████████████████████████████████████████████████████████████▋         | 8480/9741 [00:21<00:02, 428.85it/s] 87%|██████████████████████████████████████████████████████████████▉         | 8523/9741 [00:21<00:02, 428.95it/s] 88%|███████████████████████████████████████████████████████████████▎        | 8566/9741 [00:21<00:02, 428.63it/s] 88%|███████████████████████████████████████████████████████████████▋        | 8609/9741 [00:21<00:02, 424.56it/s] 89%|███████████████████████████████████████████████████████████████▉        | 8652/9741 [00:21<00:02, 425.70it/s] 89%|████████████████████████████████████████████████████████████████▎       | 8695/9741 [00:21<00:02, 426.54it/s] 90%|████████████████████████████████████████████████████████████████▌       | 8738/9741 [00:21<00:02, 427.14it/s] 90%|████████████████████████████████████████████████████████████████▉       | 8781/9741 [00:21<00:02, 426.86it/s] 91%|█████████████████████████████████████████████████████████████████▏      | 8824/9741 [00:21<00:02, 425.33it/s] 91%|█████████████████████████████████████████████████████████████████▌      | 8867/9741 [00:22<00:02, 426.48it/s] 91%|█████████████████████████████████████████████████████████████████▊      | 8910/9741 [00:22<00:01, 427.44it/s] 92%|██████████████████████████████████████████████████████████████████▏     | 8954/9741 [00:22<00:01, 428.33it/s] 92%|██████████████████████████████████████████████████████████████████▌     | 8997/9741 [00:22<00:01, 428.51it/s] 93%|██████████████████████████████████████████████████████████████████▊     | 9040/9741 [00:22<00:01, 426.85it/s] 93%|███████████████████████████████████████████████████████████████████▏    | 9083/9741 [00:22<00:01, 427.64it/s] 94%|███████████████████████████████████████████████████████████████████▍    | 9127/9741 [00:22<00:01, 428.50it/s] 94%|███████████████████████████████████████████████████████████████████▊    | 9170/9741 [00:22<00:01, 428.86it/s] 95%|████████████████████████████████████████████████████████████████████    | 9213/9741 [00:22<00:01, 428.62it/s] 95%|████████████████████████████████████████████████████████████████████▍   | 9256/9741 [00:22<00:01, 427.10it/s] 95%|████████████████████████████████████████████████████████████████████▋   | 9299/9741 [00:23<00:01, 427.84it/s] 96%|█████████████████████████████████████████████████████████████████████   | 9343/9741 [00:23<00:00, 428.49it/s] 96%|█████████████████████████████████████████████████████████████████████▍  | 9386/9741 [00:23<00:00, 428.54it/s] 97%|█████████████████████████████████████████████████████████████████████▋  | 9429/9741 [00:23<00:00, 428.79it/s] 97%|██████████████████████████████████████████████████████████████████████  | 9472/9741 [00:23<00:00, 428.99it/s] 98%|██████████████████████████████████████████████████████████████████████▎ | 9515/9741 [00:23<00:00, 427.16it/s] 98%|██████████████████████████████████████████████████████████████████████▋ | 9558/9741 [00:23<00:00, 427.10it/s] 99%|██████████████████████████████████████████████████████████████████████▉ | 9601/9741 [00:23<00:00, 427.62it/s] 99%|███████████████████████████████████████████████████████████████████████▎| 9644/9741 [00:23<00:00, 427.84it/s] 99%|███████████████████████████████████████████████████████████████████████▌| 9687/9741 [00:23<00:00, 428.29it/s]100%|███████████████████████████████████████████████████████████████████████▉| 9730/9741 [00:24<00:00, 426.45it/s]100%|████████████████████████████████████████████████████████████████████████| 9741/9741 [00:24<00:00, 404.49it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:11,  5.50s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.47s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:11,  5.78s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:11,  5.76s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.16s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.39s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:11<00:05,  5.64s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:11<00:05,  5.69s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.62s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.80s/it]
[2023-08-14 05:10:49,472] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.79s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.96s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:15<00:00,  4.98s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.17s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.09s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.26s/it]
[2023-08-14 05:11:04,464] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-14 05:11:04,465] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-14 05:11:04,465] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-14 05:11:04,465] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-14 05:11:04,465] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-14 05:11:04,465] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-14 05:11:04,466] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-14 05:11:04,466] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-14 05:11:04,466] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-14 05:11:04,466] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-14 05:11:04,466] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-14 05:11:04,466] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fdec05dcfd0>
[2023-08-14 05:11:04,466] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-14 05:11:04,466] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-14 05:11:04,466] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-14 05:11:04,466] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-14 05:11:04,466] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-14 05:11:04,466] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-14 05:11:04,466] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-14 05:11:04,466] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-14 05:11:04,466] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-14 05:11:04,466] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-14 05:11:04,466] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-14 05:11:04,466] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-14 05:11:04,466] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-14 05:11:04,466] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-14 05:11:04,466] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-14 05:11:04,467] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-14 05:11:04,467] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-14 05:11:04,467] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-14 05:11:04,467] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-14 05:11:04,467] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-14 05:11:04,467] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-14 05:11:04,467] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-14 05:11:04,467] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-14 05:11:04,467] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-14 05:11:04,467] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-14 05:11:04,467] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-14 05:11:04,467] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-14 05:11:04,467] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-14 05:11:04,467] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-14 05:11:04,467] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-14 05:11:04,467] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-14 05:11:04,467] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-14 05:11:04,467] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7fded0a98cd0>
[2023-08-14 05:11:04,467] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-14 05:11:04,467] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-14 05:11:04,467] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-14 05:11:04,467] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-14 05:11:04,467] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-14 05:11:04,467] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-14 05:11:04,467] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-14 05:11:04,467] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-14 05:11:04,467] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-14 05:11:04,467] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-14 05:11:04,467] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-14 05:11:04,467] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-14 05:11:04,467] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-14 05:11:04,467] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-14 05:11:04,467] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-14 05:11:04,467] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-14 05:11:04,467] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-14 05:11:04,467] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-14 05:11:04,468] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-14 05:11:04,468] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-14 05:11:04,468] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-14 05:11:04,468] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-14 05:11:04,468] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.5159320831298828 seconds
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.40298914909362793 seconds
Time to load utils op: 0.4043452739715576 seconds
Loading extension module utils...
Time to load utils op: 0.5046663284301758 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                                           | 0/50 [00:00<?, ?it/s]############### Example ###############
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following multiple choice question.

### Demonstration:
Input: Mary had 89 stickers.  She used 3 large stickers on the front page of her journal and 7 stickers each to 6 other pages of her journal. How many stickers does Mary have remaining?
Answer: 44

Input: Zach is saving his money to buy a brand new bike that costs $100.  His weekly allowance is $5.  His parent will pay him an extra $10 to mow the lawn.  His neighbor will pay him $7 per hour to babysit their son.  He has already saved up $65.  He'll receive his allowance on Friday and he's planning on babysitting for 2 hours this Saturday after he mows the lawn.  How much more money does Zach need to earn before he can buy the bike?
Answer: 6

Input: Mark has kangaroos and goats.  Kangaroos have two legs and goats have four legs.  If he has 23 kangaroos and three times as many goats as kangaroos what is the total number of legs of all his animals?
Answer: 322

Input: Josh’s mom gives him $20 to go shopping at the mall. He buys a hat for $10 and a pencil for $2. Then he buys four cookies. If each cookie costs $1.25, how much money does Josh have left?
Answer: 3

Input: George's bowling team is one round away from breaking the league record for most points scored in a season. The old record is an average score per player of 287 per round. Each team has 4 players and there are 10 rounds in the season. Through the first 9 rounds, his team has scored a total of 10,440. How many points less than the current league record per game average is the minimum average they need to score, per player, in the final round to tie the league record?
Answer: 27

Input: Max was doing homework in three different subjects. It took him 20 minutes to finish tasks from biology and two times more time to finish history. Geography took him the most time, three times more than history. How much time did Max spend on doing his homework?
Answer: 180

Input: Sophia ate 1/6 of her pie and she put the rest on the fridge. If the pie left in the fridge weighs 1200 grams, how many grams did Sophia eat?
Answer: 240

Input: Sarah, Mary, and Tuan decided to go to the restaurant for a meal. They decided to split the cost of the meal evenly. If the total price of the meal comes to $67 and they have a coupon for $4, how much does each person need to contribute to the bill?
Answer: 21

Input: Tom's brother is 4 times as old as Tom's dog. If in 6 years, Tom's brother will be 30 years, how old is Tom's dog going to be in six years?
Answer: 12

Input: There are 50 children at the party. Three-fifths of them are boys. How many of the children are girls?
Answer: 20

Input: Gail has some bills in her wallet which amount to $100. She has four $5 bills and three $20 bills, and the rest are $10 bills. How many $10 bills are in her wallet?
Answer: 2

Input: A 220-liter barrel has a small leak. It lost 10% of its contents before anyone noticed. How many liters are left in the barrel?
Answer: 198

Input: Markese earned 5 fewer dollars than Evan. Together they earned $37. How many dollars did Markese earn? Use E to represent how many dollars Evan earned.
Answer: 16

Input: Lou Senior took 3 cookies out of the cookie jar and ate them.  Since he didn't get caught by his wife, he went back the next day and took another 3 cookies out of the jar.  But after eating just one of the cookies, he felt guilty about it and put the other two cookies back.  His son, Louie Junior saw that his Dad was eating cookies.  So, Louie Junior took seven cookies out of the jar and hid them in his bedroom for later.  The next morning, Debra, Lou's wife looked into the cookie jar and reacted by accusing her husband of eating half of the cookies out of the cookie jar.  How many cookies remained in the jar?
Answer: 11

Input: John had $200. He gave 3/8 of his money to his mother and 3/10 to his father. How much money did John have left?
Answer: 65

Input: Tonya has $150.00 on her credit card.  If she leaves any balance on her card at the end of the month, she is charged 20% interest.  If she makes a $50.00 payment on her card, what will be the new balance?
Answer: 120

### Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid

### Response:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o16-tgsm8k-s1-rFalse
Evaluating commonsenseqa :   2%|█                                                  | 1/50 [00:42<34:55, 42.76s/it]Evaluating commonsenseqa :   4%|██                                                 | 2/50 [01:25<34:00, 42.51s/it]Evaluating commonsenseqa :   6%|███                                                | 3/50 [02:06<32:57, 42.08s/it]Evaluating commonsenseqa :   8%|████                                               | 4/50 [02:48<32:13, 42.02s/it]Evaluating commonsenseqa :  10%|█████                                              | 5/50 [03:10<26:09, 34.89s/it]Evaluating commonsenseqa :  12%|██████                                             | 6/50 [03:52<27:23, 37.34s/it]Evaluating commonsenseqa :  14%|███████▏                                           | 7/50 [04:23<25:11, 35.16s/it]Evaluating commonsenseqa :  16%|████████▏                                          | 8/50 [04:56<24:05, 34.43s/it]Evaluating commonsenseqa :  18%|█████████▏                                         | 9/50 [05:38<25:07, 36.76s/it]Evaluating commonsenseqa :  20%|██████████                                        | 10/50 [06:21<25:46, 38.66s/it]Evaluating commonsenseqa :  22%|███████████                                       | 11/50 [07:03<25:53, 39.83s/it]Evaluating commonsenseqa :  24%|████████████                                      | 12/50 [07:45<25:34, 40.39s/it]Evaluating commonsenseqa :  26%|█████████████                                     | 13/50 [08:27<25:14, 40.94s/it]Evaluating commonsenseqa :  28%|██████████████                                    | 14/50 [09:09<24:42, 41.19s/it]Evaluating commonsenseqa :  30%|███████████████                                   | 15/50 [09:51<24:13, 41.53s/it]Evaluating commonsenseqa :  32%|████████████████                                  | 16/50 [10:34<23:45, 41.93s/it]Evaluating commonsenseqa :  34%|█████████████████                                 | 17/50 [11:16<23:02, 41.91s/it]Evaluating commonsenseqa :  36%|██████████████████                                | 18/50 [11:58<22:23, 41.97s/it]Evaluating commonsenseqa :  38%|███████████████████                               | 19/50 [12:40<21:38, 41.87s/it]Evaluating commonsenseqa :  40%|████████████████████                              | 20/50 [13:22<21:02, 42.09s/it]Evaluating commonsenseqa :  42%|█████████████████████                             | 21/50 [14:05<20:24, 42.23s/it]Evaluating commonsenseqa :  44%|██████████████████████                            | 22/50 [14:47<19:45, 42.34s/it]Evaluating commonsenseqa :  46%|███████████████████████                           | 23/50 [15:30<19:06, 42.45s/it]Evaluating commonsenseqa :  48%|████████████████████████                          | 24/50 [15:51<15:32, 35.87s/it]Evaluating commonsenseqa :  50%|█████████████████████████                         | 25/50 [16:34<15:51, 38.06s/it]Evaluating commonsenseqa :  52%|██████████████████████████                        | 26/50 [17:16<15:41, 39.22s/it]Evaluating commonsenseqa :  54%|███████████████████████████                       | 27/50 [17:58<15:23, 40.14s/it]Evaluating commonsenseqa :  56%|████████████████████████████                      | 28/50 [18:41<15:01, 40.97s/it]Evaluating commonsenseqa :  58%|████████████████████████████▉                     | 29/50 [19:23<14:26, 41.27s/it]Evaluating commonsenseqa :  60%|██████████████████████████████                    | 30/50 [20:06<13:54, 41.75s/it]Evaluating commonsenseqa :  62%|███████████████████████████████                   | 31/50 [20:48<13:14, 41.81s/it]Evaluating commonsenseqa :  64%|████████████████████████████████                  | 32/50 [21:18<11:31, 38.41s/it]Evaluating commonsenseqa :  66%|█████████████████████████████████                 | 33/50 [22:01<11:14, 39.67s/it]Evaluating commonsenseqa :  68%|██████████████████████████████████                | 34/50 [22:44<10:50, 40.67s/it]Evaluating commonsenseqa :  70%|███████████████████████████████████               | 35/50 [23:26<10:15, 41.02s/it]Evaluating commonsenseqa :  72%|████████████████████████████████████              | 36/50 [24:08<09:40, 41.48s/it]Evaluating commonsenseqa :  74%|█████████████████████████████████████             | 37/50 [24:51<09:03, 41.80s/it]Evaluating commonsenseqa :  76%|██████████████████████████████████████            | 38/50 [25:33<08:23, 41.96s/it]Evaluating commonsenseqa :  78%|███████████████████████████████████████           | 39/50 [26:15<07:42, 42.08s/it]Evaluating commonsenseqa :  80%|████████████████████████████████████████          | 40/50 [26:58<07:01, 42.18s/it]Evaluating commonsenseqa :  82%|█████████████████████████████████████████         | 41/50 [27:41<06:21, 42.38s/it]Evaluating commonsenseqa :  84%|██████████████████████████████████████████        | 42/50 [28:23<05:39, 42.39s/it]Evaluating commonsenseqa :  86%|███████████████████████████████████████████       | 43/50 [29:06<04:57, 42.44s/it]Evaluating commonsenseqa :  88%|████████████████████████████████████████████      | 44/50 [29:48<04:14, 42.47s/it]Evaluating commonsenseqa :  90%|█████████████████████████████████████████████     | 45/50 [30:31<03:32, 42.42s/it]Evaluating commonsenseqa :  92%|██████████████████████████████████████████████    | 46/50 [31:13<02:49, 42.48s/it]Evaluating commonsenseqa :  94%|███████████████████████████████████████████████   | 47/50 [31:56<02:07, 42.55s/it]Evaluating commonsenseqa :  96%|████████████████████████████████████████████████  | 48/50 [32:27<01:18, 39.20s/it]Evaluating commonsenseqa :  98%|█████████████████████████████████████████████████ | 49/50 [33:10<00:40, 40.29s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████| 50/50 [33:53<00:00, 40.97s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████| 50/50 [33:53<00:00, 40.66s/it]
name: commonsenseqa | {'exact_match': 0.8, 'rougeL': 3.1751} | lm_loss 7.8739 | avg. gen lenth: 301.688
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name gsm8k --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/out-domain/o17-tgsm8k-s1-rFalse --seed 1 --num-out-domain 17
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-14 05:45:16,974] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/out-domain/o17-tgsm8k-s1-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 17
  out_domain_data_name ......... gsm8k
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o17-tgsm8k-s1-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                    | 0/9741 [00:00<?, ?it/s]  0%|▏                                                                         | 26/9741 [00:00<00:38, 250.83it/s]  1%|▍                                                                         | 52/9741 [00:00<00:38, 251.31it/s]  1%|▌                                                                         | 78/9741 [00:00<00:38, 251.02it/s]  1%|▊                                                                        | 104/9741 [00:00<00:38, 251.16it/s]  1%|▉                                                                        | 130/9741 [00:00<00:38, 251.23it/s]  2%|█▏                                                                       | 156/9741 [00:00<00:38, 251.73it/s]  2%|█▎                                                                       | 182/9741 [00:00<00:38, 247.36it/s]  2%|█▌                                                                       | 207/9741 [00:00<00:38, 246.49it/s]  2%|█▋                                                                       | 233/9741 [00:00<00:38, 247.82it/s]  3%|█▉                                                                       | 259/9741 [00:01<00:38, 248.77it/s]  3%|██▏                                                                      | 285/9741 [00:01<00:37, 249.73it/s]  3%|██▎                                                                      | 311/9741 [00:01<00:37, 250.53it/s]  3%|██▌                                                                      | 337/9741 [00:01<00:37, 250.51it/s]  4%|██▋                                                                      | 363/9741 [00:01<00:37, 250.86it/s]  4%|██▉                                                                      | 389/9741 [00:01<00:37, 251.18it/s]  4%|███                                                                      | 415/9741 [00:01<00:37, 251.03it/s]  5%|███▎                                                                     | 441/9741 [00:01<00:36, 253.01it/s]  5%|███▌                                                                     | 480/9741 [00:01<00:31, 291.13it/s]  5%|███▉                                                                     | 519/9741 [00:01<00:28, 318.07it/s]  6%|████▏                                                                    | 558/9741 [00:02<00:27, 336.74it/s]  6%|████▍                                                                    | 597/9741 [00:02<00:26, 349.87it/s]  7%|████▊                                                                    | 635/9741 [00:02<00:25, 358.74it/s]  7%|█████                                                                    | 673/9741 [00:02<00:24, 363.75it/s]  7%|█████▎                                                                   | 712/9741 [00:02<00:24, 369.29it/s]  8%|█████▌                                                                   | 750/9741 [00:02<00:24, 372.29it/s]  8%|█████▉                                                                   | 788/9741 [00:02<00:23, 374.21it/s]  8%|██████▏                                                                  | 826/9741 [00:02<00:23, 372.99it/s]  9%|██████▍                                                                  | 864/9741 [00:02<00:23, 373.30it/s]  9%|██████▊                                                                  | 902/9741 [00:02<00:23, 372.13it/s] 10%|███████                                                                  | 940/9741 [00:03<00:23, 374.29it/s] 10%|███████▎                                                                 | 979/9741 [00:03<00:23, 376.57it/s] 10%|███████▌                                                                | 1017/9741 [00:03<00:23, 377.51it/s] 11%|███████▊                                                                | 1056/9741 [00:03<00:22, 378.30it/s] 11%|████████                                                                | 1095/9741 [00:03<00:22, 378.92it/s] 12%|████████▎                                                               | 1133/9741 [00:03<00:22, 377.05it/s] 12%|████████▋                                                               | 1171/9741 [00:03<00:22, 377.48it/s] 12%|████████▉                                                               | 1210/9741 [00:03<00:22, 378.18it/s] 13%|█████████▏                                                              | 1248/9741 [00:03<00:22, 378.47it/s] 13%|█████████▌                                                              | 1287/9741 [00:03<00:22, 378.96it/s] 14%|█████████▊                                                              | 1325/9741 [00:04<00:22, 378.54it/s] 14%|██████████                                                              | 1363/9741 [00:04<00:22, 374.72it/s] 14%|██████████▎                                                             | 1401/9741 [00:04<00:22, 375.57it/s] 15%|██████████▋                                                             | 1439/9741 [00:04<00:22, 376.69it/s] 15%|██████████▉                                                             | 1478/9741 [00:04<00:21, 377.76it/s] 16%|███████████▏                                                            | 1516/9741 [00:04<00:21, 377.29it/s] 16%|███████████▍                                                            | 1555/9741 [00:04<00:21, 378.45it/s] 16%|███████████▊                                                            | 1593/9741 [00:04<00:21, 376.83it/s] 17%|████████████                                                            | 1632/9741 [00:04<00:21, 378.00it/s] 17%|████████████▎                                                           | 1670/9741 [00:05<00:21, 378.47it/s] 18%|████████████▌                                                           | 1708/9741 [00:05<00:21, 378.28it/s] 18%|████████████▉                                                           | 1746/9741 [00:05<00:21, 378.71it/s] 18%|█████████████▏                                                          | 1784/9741 [00:05<00:21, 378.35it/s] 19%|█████████████▍                                                          | 1822/9741 [00:05<00:22, 358.60it/s] 19%|█████████████▋                                                          | 1860/9741 [00:05<00:21, 364.21it/s] 19%|██████████████                                                          | 1898/9741 [00:05<00:21, 366.89it/s] 20%|██████████████▎                                                         | 1936/9741 [00:05<00:21, 370.05it/s] 20%|██████████████▌                                                         | 1974/9741 [00:05<00:20, 372.43it/s] 21%|██████████████▊                                                         | 2012/9741 [00:05<00:20, 374.22it/s] 21%|███████████████▏                                                        | 2050/9741 [00:06<00:20, 373.12it/s] 21%|███████████████▍                                                        | 2088/9741 [00:06<00:20, 374.37it/s] 22%|███████████████▋                                                        | 2126/9741 [00:06<00:20, 375.69it/s] 22%|███████████████▉                                                        | 2164/9741 [00:06<00:20, 376.53it/s] 23%|████████████████▎                                                       | 2202/9741 [00:06<00:19, 377.15it/s] 23%|████████████████▌                                                       | 2240/9741 [00:06<00:19, 375.85it/s] 23%|████████████████▊                                                       | 2278/9741 [00:06<00:20, 372.86it/s] 24%|█████████████████                                                       | 2316/9741 [00:06<00:19, 374.26it/s] 24%|█████████████████▍                                                      | 2354/9741 [00:06<00:19, 375.41it/s] 25%|█████████████████▋                                                      | 2392/9741 [00:06<00:19, 373.02it/s] 25%|█████████████████▉                                                      | 2430/9741 [00:07<00:19, 375.04it/s] 25%|██████████████████▏                                                     | 2468/9741 [00:07<00:19, 375.15it/s] 26%|██████████████████▌                                                     | 2506/9741 [00:07<00:19, 373.86it/s] 26%|██████████████████▊                                                     | 2544/9741 [00:07<00:19, 374.83it/s] 27%|███████████████████                                                     | 2582/9741 [00:07<00:19, 375.90it/s] 27%|███████████████████▎                                                    | 2620/9741 [00:07<00:18, 376.85it/s] 27%|███████████████████▋                                                    | 2658/9741 [00:07<00:18, 375.62it/s] 28%|███████████████████▉                                                    | 2696/9741 [00:07<00:18, 374.67it/s] 28%|████████████████████▏                                                   | 2734/9741 [00:07<00:18, 371.80it/s] 28%|████████████████████▍                                                   | 2772/9741 [00:07<00:19, 363.47it/s] 29%|████████████████████▊                                                   | 2810/9741 [00:08<00:18, 367.65it/s] 29%|█████████████████████                                                   | 2848/9741 [00:08<00:18, 371.13it/s] 30%|█████████████████████▎                                                  | 2886/9741 [00:08<00:18, 370.65it/s] 30%|█████████████████████▌                                                  | 2924/9741 [00:08<00:18, 371.23it/s] 30%|█████████████████████▉                                                  | 2962/9741 [00:08<00:18, 373.38it/s] 31%|██████████████████████▏                                                 | 3000/9741 [00:08<00:17, 375.20it/s] 31%|██████████████████████▍                                                 | 3038/9741 [00:08<00:17, 375.16it/s] 32%|██████████████████████▋                                                 | 3076/9741 [00:08<00:17, 375.41it/s] 32%|███████████████████████                                                 | 3114/9741 [00:08<00:17, 376.03it/s] 32%|███████████████████████▎                                                | 3152/9741 [00:08<00:17, 374.90it/s] 33%|███████████████████████▌                                                | 3191/9741 [00:09<00:17, 376.62it/s] 33%|███████████████████████▊                                                | 3229/9741 [00:09<00:17, 376.95it/s] 34%|████████████████████████▏                                               | 3267/9741 [00:09<00:17, 376.23it/s] 34%|████████████████████████▍                                               | 3305/9741 [00:09<00:17, 375.92it/s] 34%|████████████████████████▋                                               | 3343/9741 [00:09<00:16, 376.44it/s] 35%|████████████████████████▉                                               | 3381/9741 [00:09<00:17, 369.91it/s] 35%|█████████████████████████▎                                              | 3419/9741 [00:09<00:16, 371.97it/s] 35%|█████████████████████████▌                                              | 3457/9741 [00:09<00:16, 374.16it/s] 36%|█████████████████████████▊                                              | 3495/9741 [00:09<00:16, 375.52it/s] 36%|██████████████████████████                                              | 3533/9741 [00:10<00:16, 375.57it/s] 37%|██████████████████████████▍                                             | 3571/9741 [00:10<00:16, 376.36it/s] 37%|██████████████████████████▋                                             | 3609/9741 [00:10<00:16, 375.14it/s] 37%|██████████████████████████▉                                             | 3647/9741 [00:10<00:16, 375.72it/s] 38%|███████████████████████████▏                                            | 3685/9741 [00:10<00:16, 376.05it/s] 38%|███████████████████████████▌                                            | 3723/9741 [00:10<00:15, 376.67it/s] 39%|███████████████████████████▊                                            | 3761/9741 [00:10<00:15, 375.62it/s] 39%|████████████████████████████                                            | 3799/9741 [00:10<00:15, 373.53it/s] 39%|████████████████████████████▎                                           | 3837/9741 [00:10<00:15, 372.69it/s] 40%|████████████████████████████▋                                           | 3875/9741 [00:10<00:15, 374.36it/s] 40%|████████████████████████████▉                                           | 3913/9741 [00:11<00:15, 375.35it/s] 41%|█████████████████████████████▏                                          | 3951/9741 [00:11<00:15, 376.33it/s] 41%|█████████████████████████████▍                                          | 3989/9741 [00:11<00:15, 376.02it/s] 41%|█████████████████████████████▊                                          | 4027/9741 [00:11<00:15, 374.85it/s] 42%|██████████████████████████████                                          | 4065/9741 [00:11<00:15, 373.60it/s] 42%|██████████████████████████████▎                                         | 4103/9741 [00:11<00:15, 375.00it/s] 43%|██████████████████████████████▌                                         | 4141/9741 [00:11<00:14, 375.52it/s] 43%|██████████████████████████████▉                                         | 4179/9741 [00:11<00:14, 375.73it/s] 43%|███████████████████████████████▏                                        | 4217/9741 [00:11<00:14, 376.20it/s] 44%|███████████████████████████████▍                                        | 4255/9741 [00:11<00:14, 376.95it/s] 44%|███████████████████████████████▋                                        | 4293/9741 [00:12<00:14, 375.47it/s] 44%|████████████████████████████████                                        | 4331/9741 [00:12<00:14, 374.36it/s] 45%|████████████████████████████████▎                                       | 4369/9741 [00:12<00:14, 374.54it/s] 45%|████████████████████████████████▌                                       | 4407/9741 [00:12<00:14, 375.71it/s] 46%|████████████████████████████████▊                                       | 4445/9741 [00:12<00:14, 375.48it/s] 46%|█████████████████████████████████▏                                      | 4483/9741 [00:12<00:13, 376.11it/s] 46%|█████████████████████████████████▍                                      | 4521/9741 [00:12<00:15, 339.64it/s] 47%|█████████████████████████████████▋                                      | 4559/9741 [00:12<00:14, 349.19it/s] 47%|█████████████████████████████████▉                                      | 4596/9741 [00:12<00:14, 353.81it/s] 48%|██████████████████████████████████▎                                     | 4634/9741 [00:12<00:14, 359.82it/s] 48%|██████████████████████████████████▌                                     | 4672/9741 [00:13<00:13, 364.52it/s] 48%|██████████████████████████████████▊                                     | 4710/9741 [00:13<00:13, 368.43it/s] 49%|███████████████████████████████████                                     | 4748/9741 [00:13<00:19, 253.44it/s] 49%|███████████████████████████████████▍                                    | 4786/9741 [00:13<00:17, 280.80it/s] 50%|███████████████████████████████████▋                                    | 4824/9741 [00:13<00:16, 303.70it/s] 50%|███████████████████████████████████▉                                    | 4862/9741 [00:13<00:15, 322.38it/s] 50%|████████████████████████████████████▏                                   | 4900/9741 [00:13<00:14, 335.65it/s] 51%|████████████████████████████████████▍                                   | 4938/9741 [00:13<00:13, 346.73it/s] 51%|████████████████████████████████████▊                                   | 4975/9741 [00:14<00:13, 353.18it/s] 51%|█████████████████████████████████████                                   | 5013/9741 [00:14<00:13, 360.09it/s] 52%|█████████████████████████████████████▎                                  | 5051/9741 [00:14<00:12, 365.29it/s] 52%|█████████████████████████████████████▌                                  | 5089/9741 [00:14<00:12, 369.05it/s] 53%|█████████████████████████████████████▉                                  | 5127/9741 [00:14<00:12, 371.86it/s] 53%|██████████████████████████████████████▏                                 | 5165/9741 [00:14<00:12, 374.18it/s] 53%|██████████████████████████████████████▍                                 | 5203/9741 [00:14<00:12, 372.78it/s] 54%|██████████████████████████████████████▋                                 | 5241/9741 [00:14<00:12, 372.85it/s] 54%|███████████████████████████████████████                                 | 5279/9741 [00:14<00:11, 374.30it/s] 55%|███████████████████████████████████████▎                                | 5317/9741 [00:14<00:11, 375.09it/s] 55%|███████████████████████████████████████▌                                | 5355/9741 [00:15<00:11, 375.07it/s] 55%|███████████████████████████████████████▊                                | 5393/9741 [00:15<00:11, 375.42it/s] 56%|████████████████████████████████████████▏                               | 5431/9741 [00:15<00:11, 374.09it/s] 56%|████████████████████████████████████████▍                               | 5469/9741 [00:15<00:11, 375.16it/s] 57%|████████████████████████████████████████▋                               | 5508/9741 [00:15<00:11, 379.02it/s] 57%|█████████████████████████████████████████                               | 5547/9741 [00:15<00:10, 381.51it/s] 57%|█████████████████████████████████████████▎                              | 5586/9741 [00:15<00:10, 383.45it/s] 58%|█████████████████████████████████████████▌                              | 5625/9741 [00:15<00:10, 383.32it/s] 58%|█████████████████████████████████████████▊                              | 5664/9741 [00:15<00:10, 385.13it/s] 59%|██████████████████████████████████████████▏                             | 5703/9741 [00:15<00:10, 386.27it/s] 59%|██████████████████████████████████████████▍                             | 5743/9741 [00:16<00:10, 387.44it/s] 59%|██████████████████████████████████████████▋                             | 5782/9741 [00:16<00:10, 387.40it/s] 60%|███████████████████████████████████████████                             | 5821/9741 [00:16<00:10, 387.24it/s] 60%|███████████████████████████████████████████▎                            | 5860/9741 [00:16<00:10, 385.50it/s] 61%|███████████████████████████████████████████▌                            | 5899/9741 [00:16<00:09, 386.54it/s] 61%|███████████████████████████████████████████▉                            | 5938/9741 [00:16<00:09, 387.51it/s] 61%|████████████████████████████████████████████▏                           | 5977/9741 [00:16<00:09, 388.15it/s] 62%|████████████████████████████████████████████▍                           | 6016/9741 [00:16<00:09, 386.92it/s] 62%|████████████████████████████████████████████▊                           | 6056/9741 [00:16<00:09, 387.88it/s] 63%|█████████████████████████████████████████████                           | 6095/9741 [00:16<00:09, 385.63it/s] 63%|█████████████████████████████████████████████▎                          | 6134/9741 [00:17<00:09, 386.46it/s] 63%|█████████████████████████████████████████████▋                          | 6173/9741 [00:17<00:09, 387.21it/s] 64%|█████████████████████████████████████████████▉                          | 6212/9741 [00:17<00:09, 387.20it/s] 64%|██████████████████████████████████████████████▏                         | 6251/9741 [00:17<00:09, 387.39it/s] 65%|██████████████████████████████████████████████▍                         | 6290/9741 [00:17<00:08, 387.92it/s] 65%|██████████████████████████████████████████████▊                         | 6329/9741 [00:17<00:08, 385.83it/s] 65%|███████████████████████████████████████████████                         | 6368/9741 [00:17<00:08, 386.77it/s] 66%|███████████████████████████████████████████████▎                        | 6407/9741 [00:17<00:08, 387.71it/s] 66%|███████████████████████████████████████████████▋                        | 6446/9741 [00:17<00:08, 387.85it/s] 67%|███████████████████████████████████████████████▉                        | 6485/9741 [00:17<00:08, 387.85it/s] 67%|████████████████████████████████████████████████▏                       | 6524/9741 [00:18<00:08, 388.17it/s] 67%|████████████████████████████████████████████████▌                       | 6563/9741 [00:18<00:08, 386.36it/s] 68%|████████████████████████████████████████████████▊                       | 6602/9741 [00:18<00:08, 384.93it/s] 68%|█████████████████████████████████████████████████                       | 6641/9741 [00:18<00:08, 385.33it/s] 69%|█████████████████████████████████████████████████▍                      | 6681/9741 [00:18<00:07, 386.84it/s] 69%|█████████████████████████████████████████████████▋                      | 6720/9741 [00:18<00:07, 387.60it/s] 69%|█████████████████████████████████████████████████▉                      | 6759/9741 [00:18<00:07, 386.30it/s] 70%|██████████████████████████████████████████████████▏                     | 6798/9741 [00:18<00:07, 386.45it/s] 70%|██████████████████████████████████████████████████▌                     | 6837/9741 [00:18<00:07, 386.89it/s] 71%|██████████████████████████████████████████████████▊                     | 6876/9741 [00:18<00:07, 386.16it/s] 71%|███████████████████████████████████████████████████                     | 6915/9741 [00:19<00:07, 387.23it/s] 71%|███████████████████████████████████████████████████▍                    | 6955/9741 [00:19<00:07, 388.11it/s] 72%|███████████████████████████████████████████████████▋                    | 6994/9741 [00:19<00:07, 385.90it/s] 72%|███████████████████████████████████████████████████▉                    | 7033/9741 [00:19<00:06, 386.87it/s] 73%|████████████████████████████████████████████████████▎                   | 7072/9741 [00:19<00:06, 387.77it/s] 73%|████████████████████████████████████████████████████▌                   | 7111/9741 [00:19<00:06, 388.29it/s] 73%|████████████████████████████████████████████████████▊                   | 7150/9741 [00:19<00:06, 388.67it/s] 74%|█████████████████████████████████████████████████████▏                  | 7189/9741 [00:19<00:06, 388.83it/s] 74%|█████████████████████████████████████████████████████▍                  | 7228/9741 [00:19<00:06, 386.86it/s] 75%|█████████████████████████████████████████████████████▋                  | 7267/9741 [00:19<00:06, 387.72it/s] 75%|██████████████████████████████████████████████████████                  | 7306/9741 [00:20<00:06, 388.01it/s] 75%|██████████████████████████████████████████████████████▎                 | 7345/9741 [00:20<00:06, 388.34it/s] 76%|██████████████████████████████████████████████████████▌                 | 7385/9741 [00:20<00:06, 389.09it/s] 76%|██████████████████████████████████████████████████████▊                 | 7424/9741 [00:20<00:05, 387.66it/s] 77%|███████████████████████████████████████████████████████▏                | 7463/9741 [00:20<00:06, 361.43it/s] 77%|███████████████████████████████████████████████████████▍                | 7501/9741 [00:20<00:06, 366.41it/s] 77%|███████████████████████████████████████████████████████▋                | 7540/9741 [00:20<00:05, 371.39it/s] 78%|████████████████████████████████████████████████████████                | 7579/9741 [00:20<00:05, 376.16it/s] 78%|████████████████████████████████████████████████████████▎               | 7618/9741 [00:20<00:05, 380.04it/s] 79%|████████████████████████████████████████████████████████▌               | 7657/9741 [00:21<00:05, 382.54it/s] 79%|████████████████████████████████████████████████████████▉               | 7696/9741 [00:21<00:05, 382.51it/s] 79%|█████████████████████████████████████████████████████████▏              | 7736/9741 [00:21<00:05, 384.87it/s] 80%|█████████████████████████████████████████████████████████▍              | 7775/9741 [00:21<00:05, 385.97it/s] 80%|█████████████████████████████████████████████████████████▊              | 7814/9741 [00:21<00:04, 386.63it/s] 81%|██████████████████████████████████████████████████████████              | 7853/9741 [00:21<00:04, 385.17it/s] 81%|██████████████████████████████████████████████████████████▎             | 7892/9741 [00:21<00:04, 385.21it/s] 81%|██████████████████████████████████████████████████████████▌             | 7931/9741 [00:21<00:04, 384.53it/s] 82%|██████████████████████████████████████████████████████████▉             | 7970/9741 [00:21<00:04, 385.73it/s] 82%|███████████████████████████████████████████████████████████▏            | 8009/9741 [00:21<00:04, 386.64it/s] 83%|███████████████████████████████████████████████████████████▍            | 8048/9741 [00:22<00:04, 387.19it/s] 83%|███████████████████████████████████████████████████████████▊            | 8088/9741 [00:22<00:04, 388.14it/s] 83%|████████████████████████████████████████████████████████████            | 8127/9741 [00:22<00:04, 386.94it/s] 84%|████████████████████████████████████████████████████████████▎           | 8166/9741 [00:22<00:04, 384.43it/s] 84%|████████████████████████████████████████████████████████████▋           | 8205/9741 [00:22<00:03, 385.61it/s] 85%|████████████████████████████████████████████████████████████▉           | 8244/9741 [00:22<00:03, 385.50it/s] 85%|█████████████████████████████████████████████████████████████▏          | 8283/9741 [00:22<00:03, 384.57it/s] 85%|█████████████████████████████████████████████████████████████▌          | 8322/9741 [00:22<00:03, 384.65it/s] 86%|█████████████████████████████████████████████████████████████▊          | 8361/9741 [00:22<00:03, 383.61it/s] 86%|██████████████████████████████████████████████████████████████          | 8400/9741 [00:22<00:03, 385.30it/s] 87%|██████████████████████████████████████████████████████████████▍         | 8439/9741 [00:23<00:03, 386.57it/s] 87%|██████████████████████████████████████████████████████████████▋         | 8478/9741 [00:23<00:03, 387.21it/s] 87%|██████████████████████████████████████████████████████████████▉         | 8517/9741 [00:23<00:03, 387.84it/s] 88%|███████████████████████████████████████████████████████████████▏        | 8556/9741 [00:23<00:03, 388.02it/s] 88%|███████████████████████████████████████████████████████████████▌        | 8595/9741 [00:23<00:02, 386.34it/s] 89%|███████████████████████████████████████████████████████████████▊        | 8634/9741 [00:23<00:02, 386.69it/s] 89%|████████████████████████████████████████████████████████████████        | 8673/9741 [00:23<00:02, 386.70it/s] 89%|████████████████████████████████████████████████████████████████▍       | 8712/9741 [00:23<00:02, 385.04it/s] 90%|████████████████████████████████████████████████████████████████▋       | 8751/9741 [00:23<00:02, 385.91it/s] 90%|████████████████████████████████████████████████████████████████▉       | 8790/9741 [00:23<00:02, 386.70it/s] 91%|█████████████████████████████████████████████████████████████████▎      | 8829/9741 [00:24<00:02, 382.56it/s] 91%|█████████████████████████████████████████████████████████████████▌      | 8868/9741 [00:24<00:02, 384.42it/s] 91%|█████████████████████████████████████████████████████████████████▊      | 8907/9741 [00:24<00:02, 385.97it/s] 92%|██████████████████████████████████████████████████████████████████      | 8946/9741 [00:24<00:02, 386.95it/s] 92%|██████████████████████████████████████████████████████████████████▍     | 8985/9741 [00:24<00:01, 387.57it/s] 93%|██████████████████████████████████████████████████████████████████▋     | 9024/9741 [00:24<00:01, 387.94it/s] 93%|██████████████████████████████████████████████████████████████████▉     | 9063/9741 [00:24<00:01, 386.09it/s] 93%|███████████████████████████████████████████████████████████████████▎    | 9102/9741 [00:24<00:01, 383.75it/s] 94%|███████████████████████████████████████████████████████████████████▌    | 9141/9741 [00:24<00:01, 383.83it/s] 94%|███████████████████████████████████████████████████████████████████▊    | 9180/9741 [00:24<00:01, 384.28it/s] 95%|████████████████████████████████████████████████████████████████████▏   | 9219/9741 [00:25<00:01, 385.69it/s] 95%|████████████████████████████████████████████████████████████████████▍   | 9258/9741 [00:25<00:01, 384.76it/s] 95%|████████████████████████████████████████████████████████████████████▋   | 9297/9741 [00:25<00:01, 385.80it/s] 96%|█████████████████████████████████████████████████████████████████████   | 9336/9741 [00:25<00:01, 386.87it/s] 96%|█████████████████████████████████████████████████████████████████████▎  | 9375/9741 [00:25<00:00, 387.53it/s] 97%|█████████████████████████████████████████████████████████████████████▌  | 9414/9741 [00:25<00:00, 387.85it/s] 97%|█████████████████████████████████████████████████████████████████████▊  | 9453/9741 [00:25<00:00, 388.24it/s] 97%|██████████████████████████████████████████████████████████████████████▏ | 9492/9741 [00:25<00:00, 383.84it/s] 98%|██████████████████████████████████████████████████████████████████████▍ | 9531/9741 [00:25<00:00, 385.28it/s] 98%|██████████████████████████████████████████████████████████████████████▋ | 9570/9741 [00:25<00:00, 386.07it/s] 99%|███████████████████████████████████████████████████████████████████████ | 9609/9741 [00:26<00:00, 383.83it/s] 99%|███████████████████████████████████████████████████████████████████████▎| 9648/9741 [00:26<00:00, 384.60it/s] 99%|███████████████████████████████████████████████████████████████████████▌| 9687/9741 [00:26<00:00, 385.96it/s]100%|███████████████████████████████████████████████████████████████████████▉| 9726/9741 [00:26<00:00, 384.74it/s]100%|████████████████████████████████████████████████████████████████████████| 9741/9741 [00:26<00:00, 368.53it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.43s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:11,  5.64s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:11,  5.76s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:11,  5.82s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.41s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:11<00:05,  5.61s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:11<00:05,  5.65s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:11<00:05,  5.96s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.80s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.97s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:15<00:00,  4.96s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.15s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.09s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.25s/it]
[2023-08-14 05:46:36,925] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:17<00:00,  5.86s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:17<00:00,  5.86s/it]
[2023-08-14 05:46:53,827] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-14 05:46:53,828] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-14 05:46:53,829] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-14 05:46:53,829] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-14 05:46:53,829] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-14 05:46:53,829] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-14 05:46:53,829] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-14 05:46:53,829] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-14 05:46:53,829] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-14 05:46:53,829] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-14 05:46:53,829] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-14 05:46:53,829] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f4e30200fd0>
[2023-08-14 05:46:53,829] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-14 05:46:53,829] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-14 05:46:53,829] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-14 05:46:53,829] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-14 05:46:53,829] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-14 05:46:53,829] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-14 05:46:53,829] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-14 05:46:53,829] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-14 05:46:53,829] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-14 05:46:53,829] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-14 05:46:53,829] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-14 05:46:53,829] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-14 05:46:53,829] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-14 05:46:53,829] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-14 05:46:53,829] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-14 05:46:53,829] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-14 05:46:53,829] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-14 05:46:53,829] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-14 05:46:53,829] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-14 05:46:53,829] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-14 05:46:53,830] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-14 05:46:53,830] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-14 05:46:53,830] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-14 05:46:53,830] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-14 05:46:53,830] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-14 05:46:53,830] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-14 05:46:53,830] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-14 05:46:53,830] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-14 05:46:53,830] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-14 05:46:53,830] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-14 05:46:53,830] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-14 05:46:53,830] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-14 05:46:53,830] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f4e06c57cd0>
[2023-08-14 05:46:53,830] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-14 05:46:53,830] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-14 05:46:53,830] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-14 05:46:53,830] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-14 05:46:53,830] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-14 05:46:53,830] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-14 05:46:53,830] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-14 05:46:53,830] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-14 05:46:53,830] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-14 05:46:53,830] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-14 05:46:53,830] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-14 05:46:53,830] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-14 05:46:53,830] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-14 05:46:53,830] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-14 05:46:53,830] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-14 05:46:53,830] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-14 05:46:53,830] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-14 05:46:53,830] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-14 05:46:53,830] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-14 05:46:53,830] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-14 05:46:53,830] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-14 05:46:53,830] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-14 05:46:53,830] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.5286264419555664 seconds
Loading extension module utils...
Time to load utils op: 0.4045100212097168 seconds
Loading extension module utils...
Time to load utils op: 0.6050424575805664 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Loading extension module utils...
Time to load utils op: 0.5046193599700928 seconds
Evaluating commonsenseqa :   0%|                                                           | 0/50 [00:00<?, ?it/s]############### Example ###############
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following multiple choice question.

### Demonstration:
Input: Mary had 89 stickers.  She used 3 large stickers on the front page of her journal and 7 stickers each to 6 other pages of her journal. How many stickers does Mary have remaining?
Answer: 44

Input: Zach is saving his money to buy a brand new bike that costs $100.  His weekly allowance is $5.  His parent will pay him an extra $10 to mow the lawn.  His neighbor will pay him $7 per hour to babysit their son.  He has already saved up $65.  He'll receive his allowance on Friday and he's planning on babysitting for 2 hours this Saturday after he mows the lawn.  How much more money does Zach need to earn before he can buy the bike?
Answer: 6

Input: Mark has kangaroos and goats.  Kangaroos have two legs and goats have four legs.  If he has 23 kangaroos and three times as many goats as kangaroos what is the total number of legs of all his animals?
Answer: 322

Input: Josh’s mom gives him $20 to go shopping at the mall. He buys a hat for $10 and a pencil for $2. Then he buys four cookies. If each cookie costs $1.25, how much money does Josh have left?
Answer: 3

Input: George's bowling team is one round away from breaking the league record for most points scored in a season. The old record is an average score per player of 287 per round. Each team has 4 players and there are 10 rounds in the season. Through the first 9 rounds, his team has scored a total of 10,440. How many points less than the current league record per game average is the minimum average they need to score, per player, in the final round to tie the league record?
Answer: 27

Input: Max was doing homework in three different subjects. It took him 20 minutes to finish tasks from biology and two times more time to finish history. Geography took him the most time, three times more than history. How much time did Max spend on doing his homework?
Answer: 180

Input: Sophia ate 1/6 of her pie and she put the rest on the fridge. If the pie left in the fridge weighs 1200 grams, how many grams did Sophia eat?
Answer: 240

Input: Sarah, Mary, and Tuan decided to go to the restaurant for a meal. They decided to split the cost of the meal evenly. If the total price of the meal comes to $67 and they have a coupon for $4, how much does each person need to contribute to the bill?
Answer: 21

Input: Tom's brother is 4 times as old as Tom's dog. If in 6 years, Tom's brother will be 30 years, how old is Tom's dog going to be in six years?
Answer: 12

Input: There are 50 children at the party. Three-fifths of them are boys. How many of the children are girls?
Answer: 20

Input: Gail has some bills in her wallet which amount to $100. She has four $5 bills and three $20 bills, and the rest are $10 bills. How many $10 bills are in her wallet?
Answer: 2

Input: A 220-liter barrel has a small leak. It lost 10% of its contents before anyone noticed. How many liters are left in the barrel?
Answer: 198

Input: Markese earned 5 fewer dollars than Evan. Together they earned $37. How many dollars did Markese earn? Use E to represent how many dollars Evan earned.
Answer: 16

Input: Lou Senior took 3 cookies out of the cookie jar and ate them.  Since he didn't get caught by his wife, he went back the next day and took another 3 cookies out of the jar.  But after eating just one of the cookies, he felt guilty about it and put the other two cookies back.  His son, Louie Junior saw that his Dad was eating cookies.  So, Louie Junior took seven cookies out of the jar and hid them in his bedroom for later.  The next morning, Debra, Lou's wife looked into the cookie jar and reacted by accusing her husband of eating half of the cookies out of the cookie jar.  How many cookies remained in the jar?
Answer: 11

Input: John had $200. He gave 3/8 of his money to his mother and 3/10 to his father. How much money did John have left?
Answer: 65

Input: Tonya has $150.00 on her credit card.  If she leaves any balance on her card at the end of the month, she is charged 20% interest.  If she makes a $50.00 payment on her card, what will be the new balance?
Answer: 120

Input: In her first term, Governor Sandoval gave twice as many commencement addresses as Governor Hawkins. Governor Sloan gave ten more commencement addresses than Governor Sandoval in the same amount of time. If Governor Sandoval gave 12 commencement addresses, how many commencement addresses did the three of them give altogether?
Answer: 40

### Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid

### Response:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o17-tgsm8k-s1-rFalse
Evaluating commonsenseqa :   2%|█                                                  | 1/50 [00:42<34:46, 42.58s/it]Evaluating commonsenseqa :   4%|██                                                 | 2/50 [00:59<22:04, 27.59s/it]Evaluating commonsenseqa :   6%|███                                                | 3/50 [01:41<26:38, 34.01s/it]Evaluating commonsenseqa :   8%|████                                               | 4/50 [02:23<28:25, 37.07s/it]Evaluating commonsenseqa :  10%|█████                                              | 5/50 [03:05<29:11, 38.92s/it]Evaluating commonsenseqa :  12%|██████                                             | 6/50 [03:47<29:21, 40.04s/it]Evaluating commonsenseqa :  14%|███████▏                                           | 7/50 [04:29<29:13, 40.79s/it]Evaluating commonsenseqa :  16%|████████▏                                          | 8/50 [05:12<28:56, 41.35s/it]Evaluating commonsenseqa :  18%|█████████▏                                         | 9/50 [05:54<28:26, 41.63s/it]Evaluating commonsenseqa :  20%|██████████                                        | 10/50 [06:36<27:49, 41.73s/it]Evaluating commonsenseqa :  22%|███████████                                       | 11/50 [07:18<27:13, 41.87s/it]Evaluating commonsenseqa :  24%|████████████                                      | 12/50 [08:00<26:34, 41.97s/it]Evaluating commonsenseqa :  26%|█████████████                                     | 13/50 [08:40<25:23, 41.18s/it]Evaluating commonsenseqa :  28%|██████████████                                    | 14/50 [09:23<25:00, 41.69s/it]Evaluating commonsenseqa :  30%|███████████████                                   | 15/50 [10:05<24:26, 41.90s/it]Evaluating commonsenseqa :  32%|████████████████                                  | 16/50 [10:47<23:46, 41.95s/it]Evaluating commonsenseqa :  34%|█████████████████                                 | 17/50 [11:30<23:08, 42.08s/it]Evaluating commonsenseqa :  36%|██████████████████                                | 18/50 [12:12<22:26, 42.08s/it]Evaluating commonsenseqa :  38%|███████████████████                               | 19/50 [12:54<21:44, 42.07s/it]Evaluating commonsenseqa :  40%|████████████████████                              | 20/50 [13:36<21:06, 42.23s/it]Evaluating commonsenseqa :  42%|█████████████████████                             | 21/50 [14:19<20:25, 42.25s/it]Evaluating commonsenseqa :  44%|██████████████████████                            | 22/50 [15:01<19:44, 42.31s/it]Evaluating commonsenseqa :  46%|███████████████████████                           | 23/50 [15:43<18:58, 42.17s/it]Evaluating commonsenseqa :  48%|████████████████████████                          | 24/50 [16:25<18:14, 42.10s/it]Evaluating commonsenseqa :  50%|█████████████████████████                         | 25/50 [17:07<17:30, 42.04s/it]Evaluating commonsenseqa :  52%|██████████████████████████                        | 26/50 [17:48<16:45, 41.89s/it]Evaluating commonsenseqa :  54%|███████████████████████████                       | 27/50 [18:30<16:04, 41.91s/it]Evaluating commonsenseqa :  56%|████████████████████████████                      | 28/50 [19:12<15:19, 41.82s/it]Evaluating commonsenseqa :  58%|████████████████████████████▉                     | 29/50 [19:54<14:41, 41.96s/it]Evaluating commonsenseqa :  60%|██████████████████████████████                    | 30/50 [20:36<13:58, 41.93s/it]Evaluating commonsenseqa :  62%|███████████████████████████████                   | 31/50 [21:08<12:18, 38.87s/it]Evaluating commonsenseqa :  64%|████████████████████████████████                  | 32/50 [21:50<11:55, 39.77s/it]Evaluating commonsenseqa :  66%|█████████████████████████████████                 | 33/50 [22:32<11:30, 40.59s/it]Evaluating commonsenseqa :  68%|██████████████████████████████████                | 34/50 [23:14<10:57, 41.07s/it]Evaluating commonsenseqa :  70%|███████████████████████████████████               | 35/50 [23:56<10:19, 41.28s/it]Evaluating commonsenseqa :  72%|████████████████████████████████████              | 36/50 [24:38<09:40, 41.48s/it]Evaluating commonsenseqa :  74%|█████████████████████████████████████             | 37/50 [25:20<09:01, 41.68s/it]Evaluating commonsenseqa :  76%|██████████████████████████████████████            | 38/50 [26:02<08:20, 41.73s/it]Evaluating commonsenseqa :  78%|███████████████████████████████████████           | 39/50 [26:43<07:38, 41.66s/it]Evaluating commonsenseqa :  80%|████████████████████████████████████████          | 40/50 [27:19<06:37, 39.73s/it]Evaluating commonsenseqa :  82%|█████████████████████████████████████████         | 41/50 [28:00<06:02, 40.28s/it]Evaluating commonsenseqa :  84%|██████████████████████████████████████████        | 42/50 [28:43<05:27, 40.89s/it]Evaluating commonsenseqa :  86%|███████████████████████████████████████████       | 43/50 [29:24<04:47, 41.03s/it]Evaluating commonsenseqa :  88%|████████████████████████████████████████████      | 44/50 [30:06<04:07, 41.30s/it]Evaluating commonsenseqa :  90%|█████████████████████████████████████████████     | 45/50 [30:31<03:02, 36.48s/it]Evaluating commonsenseqa :  92%|██████████████████████████████████████████████    | 46/50 [31:13<02:32, 38.18s/it]Evaluating commonsenseqa :  94%|███████████████████████████████████████████████   | 47/50 [31:55<01:57, 39.22s/it]Evaluating commonsenseqa :  96%|████████████████████████████████████████████████  | 48/50 [32:36<01:19, 39.90s/it]Evaluating commonsenseqa :  98%|█████████████████████████████████████████████████ | 49/50 [33:19<00:40, 40.59s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████| 50/50 [34:01<00:00, 41.07s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████| 50/50 [34:01<00:00, 40.83s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 2.0676} | lm_loss 7.8685 | avg. gen lenth: 290.14
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name gsm8k --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/out-domain/o18-tgsm8k-s1-rFalse --seed 1 --num-out-domain 18
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...

[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-14 06:21:45,626] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/out-domain/o18-tgsm8k-s1-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 18
  out_domain_data_name ......... gsm8k
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o18-tgsm8k-s1-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                    | 0/9741 [00:00<?, ?it/s]  0%|▏                                                                         | 24/9741 [00:00<00:40, 237.76it/s]  0%|▎                                                                         | 48/9741 [00:00<00:40, 238.08it/s]  1%|▌                                                                         | 72/9741 [00:00<00:40, 238.25it/s]  1%|▋                                                                         | 96/9741 [00:00<00:40, 238.66it/s]  1%|▉                                                                        | 120/9741 [00:00<00:40, 238.87it/s]  1%|█                                                                        | 144/9741 [00:00<00:40, 238.81it/s]  2%|█▎                                                                       | 168/9741 [00:00<00:40, 234.86it/s]  2%|█▍                                                                       | 192/9741 [00:00<00:40, 235.28it/s]  2%|█▌                                                                       | 216/9741 [00:00<00:40, 234.02it/s]  2%|█▊                                                                       | 240/9741 [00:01<00:40, 235.31it/s]  3%|█▉                                                                       | 264/9741 [00:01<00:40, 235.83it/s]  3%|██▏                                                                      | 288/9741 [00:01<00:40, 236.05it/s]  3%|██▎                                                                      | 312/9741 [00:01<00:39, 236.64it/s]  3%|██▌                                                                      | 336/9741 [00:01<00:39, 236.88it/s]  4%|██▋                                                                      | 360/9741 [00:01<00:39, 237.10it/s]  4%|██▉                                                                      | 384/9741 [00:01<00:39, 237.53it/s]  4%|███                                                                      | 408/9741 [00:01<00:39, 235.15it/s]  4%|███▏                                                                     | 432/9741 [00:01<00:39, 233.50it/s]  5%|███▍                                                                     | 456/9741 [00:01<00:39, 234.92it/s]  5%|███▋                                                                     | 484/9741 [00:02<00:37, 247.74it/s]  5%|███▉                                                                     | 521/9741 [00:02<00:32, 281.96it/s]  6%|████▏                                                                    | 557/9741 [00:02<00:30, 305.02it/s]  6%|████▍                                                                    | 594/9741 [00:02<00:28, 321.83it/s]  6%|████▋                                                                    | 630/9741 [00:02<00:27, 332.60it/s]  7%|████▉                                                                    | 666/9741 [00:02<00:26, 338.56it/s]  7%|█████▎                                                                   | 703/9741 [00:02<00:26, 345.34it/s]  8%|█████▌                                                                   | 740/9741 [00:02<00:25, 349.98it/s]  8%|█████▊                                                                   | 777/9741 [00:02<00:25, 353.64it/s]  8%|██████                                                                   | 813/9741 [00:02<00:25, 355.09it/s]  9%|██████▎                                                                  | 849/9741 [00:03<00:25, 355.31it/s]  9%|██████▋                                                                  | 885/9741 [00:03<00:24, 354.61it/s]  9%|██████▉                                                                  | 922/9741 [00:03<00:24, 356.27it/s] 10%|███████▏                                                                 | 958/9741 [00:03<00:24, 357.06it/s] 10%|███████▍                                                                 | 995/9741 [00:03<00:24, 358.06it/s] 11%|███████▌                                                                | 1031/9741 [00:03<00:24, 358.52it/s] 11%|███████▉                                                                | 1067/9741 [00:03<00:24, 356.66it/s] 11%|████████▏                                                               | 1103/9741 [00:03<00:24, 356.05it/s] 12%|████████▍                                                               | 1139/9741 [00:03<00:24, 355.20it/s] 12%|████████▋                                                               | 1175/9741 [00:03<00:24, 356.54it/s] 12%|████████▉                                                               | 1211/9741 [00:04<00:23, 357.26it/s] 13%|█████████▏                                                              | 1247/9741 [00:04<00:23, 357.84it/s] 13%|█████████▍                                                              | 1283/9741 [00:04<00:23, 357.18it/s] 14%|█████████▋                                                              | 1319/9741 [00:04<00:23, 353.80it/s] 14%|██████████                                                              | 1355/9741 [00:04<00:23, 352.85it/s] 14%|██████████▎                                                             | 1391/9741 [00:04<00:23, 354.44it/s] 15%|██████████▌                                                             | 1427/9741 [00:04<00:23, 355.69it/s] 15%|██████████▊                                                             | 1463/9741 [00:04<00:23, 356.04it/s] 15%|███████████                                                             | 1499/9741 [00:04<00:23, 355.07it/s] 16%|███████████▎                                                            | 1535/9741 [00:04<00:23, 355.18it/s] 16%|███████████▌                                                            | 1571/9741 [00:05<00:23, 353.78it/s] 16%|███████████▉                                                            | 1607/9741 [00:05<00:22, 355.09it/s] 17%|████████████▏                                                           | 1643/9741 [00:05<00:22, 356.12it/s] 17%|████████████▍                                                           | 1679/9741 [00:05<00:22, 355.03it/s] 18%|████████████▋                                                           | 1715/9741 [00:05<00:22, 356.06it/s] 18%|████████████▉                                                           | 1751/9741 [00:05<00:22, 356.49it/s] 18%|█████████████▏                                                          | 1787/9741 [00:05<00:22, 353.07it/s] 19%|█████████████▍                                                          | 1823/9741 [00:05<00:24, 322.14it/s] 19%|█████████████▋                                                          | 1859/9741 [00:05<00:23, 332.19it/s] 19%|██████████████                                                          | 1895/9741 [00:06<00:23, 339.11it/s] 20%|██████████████▎                                                         | 1931/9741 [00:06<00:22, 344.08it/s] 20%|██████████████▌                                                         | 1967/9741 [00:06<00:22, 347.37it/s] 21%|██████████████▊                                                         | 2003/9741 [00:06<00:22, 350.25it/s] 21%|███████████████                                                         | 2039/9741 [00:06<00:21, 350.47it/s] 21%|███████████████▎                                                        | 2075/9741 [00:06<00:21, 352.89it/s] 22%|███████████████▌                                                        | 2111/9741 [00:06<00:21, 354.27it/s] 22%|███████████████▊                                                        | 2147/9741 [00:06<00:21, 355.59it/s] 22%|████████████████▏                                                       | 2183/9741 [00:06<00:21, 356.66it/s] 23%|████████████████▍                                                       | 2219/9741 [00:06<00:21, 357.14it/s] 23%|████████████████▋                                                       | 2255/9741 [00:07<00:21, 355.22it/s] 24%|████████████████▉                                                       | 2292/9741 [00:07<00:20, 356.64it/s] 24%|█████████████████▏                                                      | 2328/9741 [00:07<00:20, 357.30it/s] 24%|█████████████████▍                                                      | 2364/9741 [00:07<00:20, 356.07it/s] 25%|█████████████████▋                                                      | 2400/9741 [00:07<00:20, 356.22it/s] 25%|██████████████████                                                      | 2436/9741 [00:07<00:20, 356.77it/s] 25%|██████████████████▎                                                     | 2472/9741 [00:07<00:20, 354.92it/s] 26%|██████████████████▌                                                     | 2508/9741 [00:07<00:20, 356.05it/s] 26%|██████████████████▊                                                     | 2544/9741 [00:07<00:20, 356.38it/s] 26%|███████████████████                                                     | 2580/9741 [00:07<00:20, 357.33it/s] 27%|███████████████████▎                                                    | 2616/9741 [00:08<00:19, 357.93it/s] 27%|███████████████████▌                                                    | 2652/9741 [00:08<00:19, 358.14it/s] 28%|███████████████████▊                                                    | 2688/9741 [00:08<00:19, 356.62it/s] 28%|████████████████████▏                                                   | 2724/9741 [00:08<00:19, 354.34it/s] 28%|████████████████████▍                                                   | 2760/9741 [00:08<00:19, 355.35it/s] 29%|████████████████████▋                                                   | 2796/9741 [00:08<00:19, 355.79it/s] 29%|████████████████████▉                                                   | 2832/9741 [00:08<00:19, 354.67it/s] 29%|█████████████████████▏                                                  | 2868/9741 [00:08<00:19, 355.77it/s] 30%|█████████████████████▍                                                  | 2904/9741 [00:08<00:19, 356.07it/s] 30%|█████████████████████▋                                                  | 2940/9741 [00:08<00:19, 354.50it/s] 31%|█████████████████████▉                                                  | 2976/9741 [00:09<00:19, 355.40it/s] 31%|██████████████████████▎                                                 | 3012/9741 [00:09<00:18, 356.12it/s] 31%|██████████████████████▌                                                 | 3048/9741 [00:09<00:18, 356.39it/s] 32%|██████████████████████▊                                                 | 3084/9741 [00:09<00:18, 355.75it/s] 32%|███████████████████████                                                 | 3120/9741 [00:09<00:18, 355.90it/s] 32%|███████████████████████▎                                                | 3156/9741 [00:09<00:18, 352.97it/s] 33%|███████████████████████▌                                                | 3192/9741 [00:09<00:18, 354.69it/s] 33%|███████████████████████▊                                                | 3228/9741 [00:09<00:18, 355.30it/s] 34%|████████████████████████▏                                               | 3264/9741 [00:09<00:18, 354.63it/s] 34%|████████████████████████▍                                               | 3300/9741 [00:09<00:18, 355.47it/s] 34%|████████████████████████▋                                               | 3336/9741 [00:10<00:18, 355.66it/s] 35%|████████████████████████▉                                               | 3372/9741 [00:10<00:17, 355.15it/s] 35%|█████████████████████████▏                                              | 3408/9741 [00:10<00:17, 352.70it/s] 35%|█████████████████████████▍                                              | 3444/9741 [00:10<00:17, 353.89it/s] 36%|█████████████████████████▋                                              | 3480/9741 [00:10<00:17, 355.04it/s] 36%|█████████████████████████▉                                              | 3516/9741 [00:10<00:17, 354.82it/s] 36%|██████████████████████████▎                                             | 3552/9741 [00:10<00:17, 355.59it/s] 37%|██████████████████████████▌                                             | 3588/9741 [00:10<00:17, 355.84it/s] 37%|██████████████████████████▊                                             | 3624/9741 [00:10<00:17, 353.87it/s] 38%|███████████████████████████                                             | 3660/9741 [00:10<00:17, 354.91it/s] 38%|███████████████████████████▎                                            | 3696/9741 [00:11<00:16, 355.88it/s] 38%|███████████████████████████▌                                            | 3732/9741 [00:11<00:16, 356.81it/s] 39%|███████████████████████████▊                                            | 3768/9741 [00:11<00:16, 357.23it/s] 39%|████████████████████████████                                            | 3804/9741 [00:11<00:16, 357.14it/s] 39%|████████████████████████████▍                                           | 3840/9741 [00:11<00:16, 355.27it/s] 40%|████████████████████████████▋                                           | 3876/9741 [00:11<00:16, 354.37it/s] 40%|████████████████████████████▉                                           | 3912/9741 [00:11<00:16, 353.22it/s] 41%|█████████████████████████████▏                                          | 3948/9741 [00:11<00:16, 354.54it/s] 41%|█████████████████████████████▍                                          | 3984/9741 [00:11<00:16, 355.31it/s] 41%|█████████████████████████████▋                                          | 4020/9741 [00:11<00:16, 356.32it/s] 42%|█████████████████████████████▉                                          | 4056/9741 [00:12<00:15, 356.29it/s] 42%|██████████████████████████████▏                                         | 4092/9741 [00:12<00:15, 354.47it/s] 42%|██████████████████████████████▌                                         | 4128/9741 [00:12<00:15, 355.41it/s] 43%|██████████████████████████████▊                                         | 4164/9741 [00:12<00:15, 356.09it/s] 43%|███████████████████████████████                                         | 4200/9741 [00:12<00:15, 356.77it/s] 43%|███████████████████████████████▎                                        | 4236/9741 [00:12<00:15, 356.57it/s] 44%|███████████████████████████████▌                                        | 4272/9741 [00:12<00:15, 353.98it/s] 44%|███████████████████████████████▊                                        | 4308/9741 [00:12<00:15, 350.11it/s] 45%|████████████████████████████████                                        | 4344/9741 [00:12<00:15, 351.03it/s] 45%|████████████████████████████████▎                                       | 4380/9741 [00:13<00:15, 353.04it/s] 45%|████████████████████████████████▋                                       | 4416/9741 [00:13<00:15, 354.46it/s] 46%|████████████████████████████████▉                                       | 4452/9741 [00:13<00:14, 355.31it/s] 46%|█████████████████████████████████▏                                      | 4488/9741 [00:13<00:14, 355.88it/s] 46%|█████████████████████████████████▍                                      | 4524/9741 [00:13<00:15, 329.63it/s] 47%|█████████████████████████████████▋                                      | 4560/9741 [00:13<00:15, 336.91it/s] 47%|█████████████████████████████████▉                                      | 4596/9741 [00:13<00:15, 342.27it/s] 48%|██████████████████████████████████▏                                     | 4631/9741 [00:13<00:14, 343.93it/s] 48%|██████████████████████████████████▍                                     | 4666/9741 [00:13<00:14, 340.99it/s] 48%|██████████████████████████████████▊                                     | 4702/9741 [00:13<00:14, 343.75it/s] 49%|███████████████████████████████████                                     | 4738/9741 [00:14<00:14, 347.82it/s] 49%|███████████████████████████████████▎                                    | 4773/9741 [00:14<00:20, 244.98it/s] 49%|███████████████████████████████████▌                                    | 4809/9741 [00:14<00:18, 270.61it/s] 50%|███████████████████████████████████▊                                    | 4845/9741 [00:14<00:16, 292.05it/s] 50%|████████████████████████████████████                                    | 4881/9741 [00:14<00:15, 308.82it/s] 50%|████████████████████████████████████▎                                   | 4917/9741 [00:14<00:14, 322.15it/s] 51%|████████████████████████████████████▌                                   | 4952/9741 [00:14<00:14, 329.52it/s] 51%|████████████████████████████████████▊                                   | 4987/9741 [00:14<00:14, 334.34it/s] 52%|█████████████████████████████████████▏                                  | 5023/9741 [00:15<00:13, 340.46it/s] 52%|█████████████████████████████████████▍                                  | 5059/9741 [00:15<00:13, 345.59it/s] 52%|█████████████████████████████████████▋                                  | 5095/9741 [00:15<00:13, 349.31it/s] 53%|█████████████████████████████████████▉                                  | 5131/9741 [00:15<00:13, 352.03it/s] 53%|██████████████████████████████████████▏                                 | 5167/9741 [00:15<00:12, 352.76it/s] 53%|██████████████████████████████████████▍                                 | 5203/9741 [00:15<00:13, 348.87it/s] 54%|██████████████████████████████████████▋                                 | 5239/9741 [00:15<00:12, 351.15it/s] 54%|██████████████████████████████████████▉                                 | 5275/9741 [00:15<00:12, 353.35it/s] 55%|███████████████████████████████████████▎                                | 5311/9741 [00:15<00:12, 355.19it/s] 55%|███████████████████████████████████████▌                                | 5347/9741 [00:15<00:12, 354.79it/s] 55%|███████████████████████████████████████▊                                | 5383/9741 [00:16<00:12, 352.16it/s] 56%|████████████████████████████████████████                                | 5419/9741 [00:16<00:12, 350.36it/s] 56%|████████████████████████████████████████▎                               | 5455/9741 [00:16<00:12, 352.78it/s] 56%|████████████████████████████████████████▌                               | 5492/9741 [00:16<00:11, 356.38it/s] 57%|████████████████████████████████████████▊                               | 5530/9741 [00:16<00:11, 360.58it/s] 57%|█████████████████████████████████████████▏                              | 5568/9741 [00:16<00:11, 363.68it/s] 58%|█████████████████████████████████████████▍                              | 5605/9741 [00:16<00:11, 364.95it/s] 58%|█████████████████████████████████████████▋                              | 5642/9741 [00:16<00:11, 364.21it/s] 58%|█████████████████████████████████████████▉                              | 5680/9741 [00:16<00:11, 366.22it/s] 59%|██████████████████████████████████████████▎                             | 5717/9741 [00:16<00:10, 366.43it/s] 59%|██████████████████████████████████████████▌                             | 5754/9741 [00:17<00:10, 364.32it/s] 59%|██████████████████████████████████████████▊                             | 5791/9741 [00:17<00:10, 359.18it/s] 60%|███████████████████████████████████████████                             | 5827/9741 [00:17<00:10, 359.06it/s] 60%|███████████████████████████████████████████▎                            | 5864/9741 [00:17<00:10, 359.76it/s] 61%|███████████████████████████████████████████▌                            | 5901/9741 [00:17<00:10, 362.27it/s] 61%|███████████████████████████████████████████▉                            | 5939/9741 [00:17<00:10, 364.60it/s] 61%|████████████████████████████████████████████▏                           | 5977/9741 [00:17<00:10, 366.55it/s] 62%|████████████████████████████████████████████▍                           | 6015/9741 [00:17<00:10, 367.80it/s] 62%|████████████████████████████████████████████▋                           | 6053/9741 [00:17<00:10, 368.51it/s] 63%|█████████████████████████████████████████████                           | 6090/9741 [00:17<00:09, 366.18it/s] 63%|█████████████████████████████████████████████▎                          | 6127/9741 [00:18<00:09, 367.01it/s] 63%|█████████████████████████████████████████████▌                          | 6164/9741 [00:18<00:09, 367.81it/s] 64%|█████████████████████████████████████████████▊                          | 6201/9741 [00:18<00:09, 368.34it/s] 64%|██████████████████████████████████████████████                          | 6238/9741 [00:18<00:09, 368.75it/s] 64%|██████████████████████████████████████████████▍                         | 6275/9741 [00:18<00:09, 368.66it/s] 65%|██████████████████████████████████████████████▋                         | 6312/9741 [00:18<00:09, 365.24it/s] 65%|██████████████████████████████████████████████▉                         | 6349/9741 [00:18<00:09, 364.83it/s] 66%|███████████████████████████████████████████████▏                        | 6386/9741 [00:18<00:09, 366.03it/s] 66%|███████████████████████████████████████████████▍                        | 6423/9741 [00:18<00:09, 363.43it/s] 66%|███████████████████████████████████████████████▋                        | 6460/9741 [00:18<00:08, 365.02it/s] 67%|████████████████████████████████████████████████                        | 6497/9741 [00:19<00:08, 366.46it/s] 67%|████████████████████████████████████████████████▎                       | 6534/9741 [00:19<00:08, 363.93it/s] 67%|████████████████████████████████████████████████▌                       | 6571/9741 [00:19<00:08, 364.76it/s] 68%|████████████████████████████████████████████████▊                       | 6608/9741 [00:19<00:08, 365.30it/s] 68%|█████████████████████████████████████████████████                       | 6645/9741 [00:19<00:08, 366.63it/s] 69%|█████████████████████████████████████████████████▍                      | 6682/9741 [00:19<00:08, 366.35it/s] 69%|█████████████████████████████████████████████████▋                      | 6719/9741 [00:19<00:08, 366.10it/s] 69%|█████████████████████████████████████████████████▉                      | 6757/9741 [00:19<00:08, 367.59it/s] 70%|██████████████████████████████████████████████████▏                     | 6794/9741 [00:19<00:08, 365.91it/s] 70%|██████████████████████████████████████████████████▍                     | 6832/9741 [00:19<00:07, 367.17it/s] 71%|██████████████████████████████████████████████████▊                     | 6869/9741 [00:20<00:07, 367.71it/s] 71%|███████████████████████████████████████████████████                     | 6906/9741 [00:20<00:07, 365.67it/s] 71%|███████████████████████████████████████████████████▎                    | 6943/9741 [00:20<00:07, 364.94it/s] 72%|███████████████████████████████████████████████████▌                    | 6980/9741 [00:20<00:07, 366.33it/s] 72%|███████████████████████████████████████████████████▊                    | 7017/9741 [00:20<00:07, 364.98it/s] 72%|████████████████████████████████████████████████████▏                   | 7054/9741 [00:20<00:07, 362.84it/s] 73%|████████████████████████████████████████████████████▍                   | 7092/9741 [00:20<00:07, 365.15it/s] 73%|████████████████████████████████████████████████████▋                   | 7129/9741 [00:20<00:07, 366.53it/s] 74%|████████████████████████████████████████████████████▉                   | 7166/9741 [00:20<00:07, 367.52it/s] 74%|█████████████████████████████████████████████████████▏                  | 7203/9741 [00:21<00:06, 367.68it/s] 74%|█████████████████████████████████████████████████████▌                  | 7240/9741 [00:21<00:06, 365.97it/s] 75%|█████████████████████████████████████████████████████▊                  | 7277/9741 [00:21<00:06, 366.70it/s] 75%|██████████████████████████████████████████████████████                  | 7314/9741 [00:21<00:06, 365.33it/s] 75%|██████████████████████████████████████████████████████▎                 | 7351/9741 [00:21<00:06, 365.82it/s] 76%|██████████████████████████████████████████████████████▌                 | 7388/9741 [00:21<00:06, 367.03it/s] 76%|██████████████████████████████████████████████████████▉                 | 7425/9741 [00:21<00:06, 367.53it/s] 77%|███████████████████████████████████████████████████████▏                | 7462/9741 [00:21<00:06, 327.95it/s] 77%|███████████████████████████████████████████████████████▍                | 7499/9741 [00:21<00:06, 339.02it/s] 77%|███████████████████████████████████████████████████████▋                | 7536/9741 [00:21<00:06, 347.28it/s] 78%|███████████████████████████████████████████████████████▉                | 7574/9741 [00:22<00:06, 354.05it/s] 78%|████████████████████████████████████████████████████████▎               | 7612/9741 [00:22<00:05, 358.91it/s] 79%|████████████████████████████████████████████████████████▌               | 7649/9741 [00:22<00:05, 358.65it/s] 79%|████████████████████████████████████████████████████████▊               | 7686/9741 [00:22<00:05, 359.34it/s] 79%|█████████████████████████████████████████████████████████               | 7724/9741 [00:22<00:05, 363.01it/s] 80%|█████████████████████████████████████████████████████████▎              | 7761/9741 [00:22<00:05, 364.67it/s] 80%|█████████████████████████████████████████████████████████▋              | 7798/9741 [00:22<00:05, 366.10it/s] 80%|█████████████████████████████████████████████████████████▉              | 7836/9741 [00:22<00:05, 367.46it/s] 81%|██████████████████████████████████████████████████████████▏             | 7873/9741 [00:22<00:05, 368.04it/s] 81%|██████████████████████████████████████████████████████████▍             | 7910/9741 [00:22<00:04, 366.80it/s] 82%|██████████████████████████████████████████████████████████▋             | 7947/9741 [00:23<00:04, 367.54it/s] 82%|███████████████████████████████████████████████████████████             | 7984/9741 [00:23<00:04, 367.96it/s] 82%|███████████████████████████████████████████████████████████▎            | 8022/9741 [00:23<00:04, 368.65it/s] 83%|███████████████████████████████████████████████████████████▌            | 8059/9741 [00:23<00:04, 368.05it/s] 83%|███████████████████████████████████████████████████████████▊            | 8096/9741 [00:23<00:04, 366.86it/s] 83%|████████████████████████████████████████████████████████████            | 8133/9741 [00:23<00:04, 365.55it/s] 84%|████████████████████████████████████████████████████████████▍           | 8170/9741 [00:23<00:04, 363.05it/s] 84%|████████████████████████████████████████████████████████████▋           | 8207/9741 [00:23<00:04, 364.93it/s] 85%|████████████████████████████████████████████████████████████▉           | 8245/9741 [00:23<00:04, 366.68it/s] 85%|█████████████████████████████████████████████████████████████▏          | 8282/9741 [00:23<00:03, 367.61it/s] 85%|█████████████████████████████████████████████████████████████▍          | 8319/9741 [00:24<00:03, 368.04it/s] 86%|█████████████████████████████████████████████████████████████▊          | 8356/9741 [00:24<00:03, 365.90it/s] 86%|██████████████████████████████████████████████████████████████          | 8393/9741 [00:24<00:03, 367.07it/s] 87%|██████████████████████████████████████████████████████████████▎         | 8431/9741 [00:24<00:03, 368.08it/s] 87%|██████████████████████████████████████████████████████████████▌         | 8468/9741 [00:24<00:03, 366.12it/s] 87%|██████████████████████████████████████████████████████████████▊         | 8505/9741 [00:24<00:03, 367.00it/s] 88%|███████████████████████████████████████████████████████████████▏        | 8542/9741 [00:24<00:03, 366.10it/s] 88%|███████████████████████████████████████████████████████████████▍        | 8579/9741 [00:24<00:03, 363.86it/s] 88%|███████████████████████████████████████████████████████████████▋        | 8616/9741 [00:24<00:03, 364.69it/s] 89%|███████████████████████████████████████████████████████████████▉        | 8653/9741 [00:24<00:02, 365.78it/s] 89%|████████████████████████████████████████████████████████████████▏       | 8690/9741 [00:25<00:02, 366.84it/s] 90%|████████████████████████████████████████████████████████████████▌       | 8727/9741 [00:25<00:02, 367.64it/s] 90%|████████████████████████████████████████████████████████████████▊       | 8764/9741 [00:25<00:02, 367.93it/s] 90%|█████████████████████████████████████████████████████████████████       | 8801/9741 [00:25<00:02, 365.61it/s] 91%|█████████████████████████████████████████████████████████████████▎      | 8838/9741 [00:25<00:02, 366.29it/s] 91%|█████████████████████████████████████████████████████████████████▌      | 8875/9741 [00:25<00:02, 366.86it/s] 91%|█████████████████████████████████████████████████████████████████▊      | 8912/9741 [00:25<00:02, 367.72it/s] 92%|██████████████████████████████████████████████████████████████████▏     | 8949/9741 [00:25<00:02, 366.43it/s] 92%|██████████████████████████████████████████████████████████████████▍     | 8986/9741 [00:25<00:02, 363.98it/s] 93%|██████████████████████████████████████████████████████████████████▋     | 9023/9741 [00:26<00:01, 365.55it/s] 93%|██████████████████████████████████████████████████████████████████▉     | 9060/9741 [00:26<00:01, 364.19it/s] 93%|███████████████████████████████████████████████████████████████████▏    | 9097/9741 [00:26<00:01, 365.48it/s] 94%|███████████████████████████████████████████████████████████████████▌    | 9134/9741 [00:26<00:01, 366.58it/s] 94%|███████████████████████████████████████████████████████████████████▊    | 9171/9741 [00:26<00:01, 367.33it/s] 95%|████████████████████████████████████████████████████████████████████    | 9208/9741 [00:26<00:01, 367.74it/s] 95%|████████████████████████████████████████████████████████████████████▎   | 9245/9741 [00:26<00:01, 368.27it/s] 95%|████████████████████████████████████████████████████████████████████▌   | 9282/9741 [00:26<00:01, 365.03it/s] 96%|████████████████████████████████████████████████████████████████████▉   | 9319/9741 [00:26<00:01, 365.23it/s] 96%|█████████████████████████████████████████████████████████████████████▏  | 9356/9741 [00:26<00:01, 366.17it/s] 96%|█████████████████████████████████████████████████████████████████████▍  | 9394/9741 [00:27<00:00, 367.38it/s] 97%|█████████████████████████████████████████████████████████████████████▋  | 9431/9741 [00:27<00:00, 367.77it/s] 97%|█████████████████████████████████████████████████████████████████████▉  | 9468/9741 [00:27<00:00, 365.61it/s] 98%|██████████████████████████████████████████████████████████████████████▎ | 9505/9741 [00:27<00:00, 364.32it/s] 98%|██████████████████████████████████████████████████████████████████████▌ | 9542/9741 [00:27<00:00, 365.63it/s] 98%|██████████████████████████████████████████████████████████████████████▊ | 9579/9741 [00:27<00:00, 366.15it/s] 99%|███████████████████████████████████████████████████████████████████████ | 9616/9741 [00:27<00:00, 366.42it/s] 99%|███████████████████████████████████████████████████████████████████████▎| 9653/9741 [00:27<00:00, 367.07it/s] 99%|███████████████████████████████████████████████████████████████████████▌| 9690/9741 [00:27<00:00, 366.78it/s]100%|███████████████████████████████████████████████████████████████████████▉| 9727/9741 [00:27<00:00, 364.83it/s]100%|████████████████████████████████████████████████████████████████████████| 9741/9741 [00:27<00:00, 348.29it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:11,  5.51s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.43s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:11,  6.00s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:11,  5.56s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.37s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.46s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.49s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:11<00:05,  5.67s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.73s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.92s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.78s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.96s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:15<00:00,  4.83s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.09s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.06s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.18s/it]
[2023-08-14 06:23:07,092] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
[2023-08-14 06:23:19,236] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-14 06:23:19,237] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-14 06:23:19,238] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-14 06:23:19,238] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-14 06:23:19,238] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-14 06:23:19,238] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-14 06:23:19,238] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-14 06:23:19,238] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-14 06:23:19,238] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-14 06:23:19,238] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-14 06:23:19,238] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-14 06:23:19,238] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f9ccf70dfd0>
[2023-08-14 06:23:19,238] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-14 06:23:19,238] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-14 06:23:19,238] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-14 06:23:19,238] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-14 06:23:19,239] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-14 06:23:19,239] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-14 06:23:19,239] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-14 06:23:19,239] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-14 06:23:19,239] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-14 06:23:19,239] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-14 06:23:19,239] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-14 06:23:19,239] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-14 06:23:19,239] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-14 06:23:19,239] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-14 06:23:19,239] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-14 06:23:19,239] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-14 06:23:19,239] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-14 06:23:19,239] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-14 06:23:19,239] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-14 06:23:19,239] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-14 06:23:19,239] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-14 06:23:19,239] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-14 06:23:19,239] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-14 06:23:19,239] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-14 06:23:19,239] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-14 06:23:19,239] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-14 06:23:19,239] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-14 06:23:19,239] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-14 06:23:19,239] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-14 06:23:19,239] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-14 06:23:19,239] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-14 06:23:19,239] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-14 06:23:19,239] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f9cc1b7bcd0>
[2023-08-14 06:23:19,239] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-14 06:23:19,239] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-14 06:23:19,239] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-14 06:23:19,240] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-14 06:23:19,240] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-14 06:23:19,240] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-14 06:23:19,240] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-14 06:23:19,240] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-14 06:23:19,240] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-14 06:23:19,240] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-14 06:23:19,240] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-14 06:23:19,240] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-14 06:23:19,240] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-14 06:23:19,240] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-14 06:23:19,240] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-14 06:23:19,240] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-14 06:23:19,240] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-14 06:23:19,240] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-14 06:23:19,240] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-14 06:23:19,240] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-14 06:23:19,240] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-14 06:23:19,240] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-14 06:23:19,240] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.592660665512085 seconds
Loading extension module utils...
Time to load utils op: 0.5047726631164551 seconds
Loading extension module utils...
Time to load utils op: 0.504650354385376 seconds
Loading extension module utils...
Time to load utils op: 0.5047011375427246 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                                           | 0/50 [00:00<?, ?it/s]############### Example ###############
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following multiple choice question.

### Demonstration:
Input: Mary had 89 stickers.  She used 3 large stickers on the front page of her journal and 7 stickers each to 6 other pages of her journal. How many stickers does Mary have remaining?
Answer: 44

Input: Zach is saving his money to buy a brand new bike that costs $100.  His weekly allowance is $5.  His parent will pay him an extra $10 to mow the lawn.  His neighbor will pay him $7 per hour to babysit their son.  He has already saved up $65.  He'll receive his allowance on Friday and he's planning on babysitting for 2 hours this Saturday after he mows the lawn.  How much more money does Zach need to earn before he can buy the bike?
Answer: 6

Input: Mark has kangaroos and goats.  Kangaroos have two legs and goats have four legs.  If he has 23 kangaroos and three times as many goats as kangaroos what is the total number of legs of all his animals?
Answer: 322

Input: Josh’s mom gives him $20 to go shopping at the mall. He buys a hat for $10 and a pencil for $2. Then he buys four cookies. If each cookie costs $1.25, how much money does Josh have left?
Answer: 3

Input: George's bowling team is one round away from breaking the league record for most points scored in a season. The old record is an average score per player of 287 per round. Each team has 4 players and there are 10 rounds in the season. Through the first 9 rounds, his team has scored a total of 10,440. How many points less than the current league record per game average is the minimum average they need to score, per player, in the final round to tie the league record?
Answer: 27

Input: Max was doing homework in three different subjects. It took him 20 minutes to finish tasks from biology and two times more time to finish history. Geography took him the most time, three times more than history. How much time did Max spend on doing his homework?
Answer: 180

Input: Sophia ate 1/6 of her pie and she put the rest on the fridge. If the pie left in the fridge weighs 1200 grams, how many grams did Sophia eat?
Answer: 240

Input: Sarah, Mary, and Tuan decided to go to the restaurant for a meal. They decided to split the cost of the meal evenly. If the total price of the meal comes to $67 and they have a coupon for $4, how much does each person need to contribute to the bill?
Answer: 21

Input: Tom's brother is 4 times as old as Tom's dog. If in 6 years, Tom's brother will be 30 years, how old is Tom's dog going to be in six years?
Answer: 12

Input: There are 50 children at the party. Three-fifths of them are boys. How many of the children are girls?
Answer: 20

Input: Gail has some bills in her wallet which amount to $100. She has four $5 bills and three $20 bills, and the rest are $10 bills. How many $10 bills are in her wallet?
Answer: 2

Input: A 220-liter barrel has a small leak. It lost 10% of its contents before anyone noticed. How many liters are left in the barrel?
Answer: 198

Input: Markese earned 5 fewer dollars than Evan. Together they earned $37. How many dollars did Markese earn? Use E to represent how many dollars Evan earned.
Answer: 16

Input: Lou Senior took 3 cookies out of the cookie jar and ate them.  Since he didn't get caught by his wife, he went back the next day and took another 3 cookies out of the jar.  But after eating just one of the cookies, he felt guilty about it and put the other two cookies back.  His son, Louie Junior saw that his Dad was eating cookies.  So, Louie Junior took seven cookies out of the jar and hid them in his bedroom for later.  The next morning, Debra, Lou's wife looked into the cookie jar and reacted by accusing her husband of eating half of the cookies out of the cookie jar.  How many cookies remained in the jar?
Answer: 11

Input: John had $200. He gave 3/8 of his money to his mother and 3/10 to his father. How much money did John have left?
Answer: 65

Input: Tonya has $150.00 on her credit card.  If she leaves any balance on her card at the end of the month, she is charged 20% interest.  If she makes a $50.00 payment on her card, what will be the new balance?
Answer: 120

Input: In her first term, Governor Sandoval gave twice as many commencement addresses as Governor Hawkins. Governor Sloan gave ten more commencement addresses than Governor Sandoval in the same amount of time. If Governor Sandoval gave 12 commencement addresses, how many commencement addresses did the three of them give altogether?
Answer: 40

Input: If Buzz bought a pizza with 78 slices at a restaurant and then decided to share it with the waiter in the ratio of 5:8, with Buzz's ratio being 5, what's twenty less the number of slices of pizza that the waiter ate?
Answer: 28

### Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid

### Response:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o18-tgsm8k-s1-rFalse
Evaluating commonsenseqa :   2%|█                                                  | 1/50 [00:43<35:14, 43.15s/it]Evaluating commonsenseqa :   4%|██                                                 | 2/50 [01:25<34:06, 42.63s/it]Evaluating commonsenseqa :   6%|███                                                | 3/50 [02:07<33:12, 42.39s/it]Evaluating commonsenseqa :   8%|████                                               | 4/50 [02:49<32:16, 42.10s/it]Evaluating commonsenseqa :  10%|█████                                              | 5/50 [03:31<31:34, 42.09s/it]Evaluating commonsenseqa :  12%|██████                                             | 6/50 [04:13<30:48, 42.00s/it]Evaluating commonsenseqa :  14%|███████▏                                           | 7/50 [04:55<30:06, 42.01s/it]Evaluating commonsenseqa :  16%|████████▏                                          | 8/50 [05:37<29:24, 42.01s/it]Evaluating commonsenseqa :  18%|█████████▏                                         | 9/50 [06:18<28:38, 41.92s/it]Evaluating commonsenseqa :  20%|██████████                                        | 10/50 [07:00<27:55, 41.90s/it]Evaluating commonsenseqa :  22%|███████████                                       | 11/50 [07:42<27:13, 41.89s/it]Evaluating commonsenseqa :  24%|████████████                                      | 12/50 [08:23<26:26, 41.74s/it]Evaluating commonsenseqa :  26%|█████████████                                     | 13/50 [09:06<25:50, 41.91s/it]Evaluating commonsenseqa :  28%|██████████████                                    | 14/50 [09:48<25:10, 41.95s/it]Evaluating commonsenseqa :  30%|███████████████                                   | 15/50 [10:30<24:28, 41.96s/it]Evaluating commonsenseqa :  32%|████████████████                                  | 16/50 [11:12<23:46, 41.96s/it]Evaluating commonsenseqa :  34%|█████████████████                                 | 17/50 [11:54<23:10, 42.13s/it]Evaluating commonsenseqa :  36%|██████████████████                                | 18/50 [12:14<18:54, 35.45s/it]Evaluating commonsenseqa :  38%|███████████████████                               | 19/50 [12:56<19:15, 37.28s/it]Evaluating commonsenseqa :  40%|████████████████████                              | 20/50 [13:38<19:19, 38.67s/it]Evaluating commonsenseqa :  42%|█████████████████████                             | 21/50 [14:19<19:08, 39.61s/it]Evaluating commonsenseqa :  44%|██████████████████████                            | 22/50 [15:01<18:44, 40.16s/it]Evaluating commonsenseqa :  46%|███████████████████████                           | 23/50 [15:42<18:13, 40.52s/it]Evaluating commonsenseqa :  48%|████████████████████████                          | 24/50 [16:25<17:47, 41.06s/it]Evaluating commonsenseqa :  50%|█████████████████████████                         | 25/50 [17:07<17:14, 41.37s/it]Evaluating commonsenseqa :  52%|██████████████████████████                        | 26/50 [17:49<16:37, 41.58s/it]Evaluating commonsenseqa :  54%|███████████████████████████                       | 27/50 [18:20<14:44, 38.44s/it]Evaluating commonsenseqa :  56%|████████████████████████████                      | 28/50 [19:02<14:27, 39.44s/it]Evaluating commonsenseqa :  58%|████████████████████████████▉                     | 29/50 [19:44<14:07, 40.36s/it]Evaluating commonsenseqa :  60%|██████████████████████████████                    | 30/50 [20:27<13:40, 41.02s/it]Evaluating commonsenseqa :  62%|███████████████████████████████                   | 31/50 [21:09<13:05, 41.33s/it]Evaluating commonsenseqa :  64%|████████████████████████████████                  | 32/50 [21:50<12:25, 41.42s/it]Evaluating commonsenseqa :  66%|█████████████████████████████████                 | 33/50 [22:32<11:47, 41.59s/it]Evaluating commonsenseqa :  68%|██████████████████████████████████                | 34/50 [23:14<11:06, 41.68s/it]Evaluating commonsenseqa :  70%|███████████████████████████████████               | 35/50 [23:56<10:25, 41.73s/it]Evaluating commonsenseqa :  72%|████████████████████████████████████              | 36/50 [24:38<09:46, 41.89s/it]Evaluating commonsenseqa :  74%|█████████████████████████████████████             | 37/50 [25:20<09:04, 41.87s/it]Evaluating commonsenseqa :  76%|██████████████████████████████████████            | 38/50 [26:02<08:22, 41.89s/it]Evaluating commonsenseqa :  78%|███████████████████████████████████████           | 39/50 [26:44<07:41, 41.93s/it]Evaluating commonsenseqa :  80%|████████████████████████████████████████          | 40/50 [27:26<06:59, 41.99s/it]Evaluating commonsenseqa :  82%|█████████████████████████████████████████         | 41/50 [27:58<05:50, 38.89s/it]Evaluating commonsenseqa :  84%|██████████████████████████████████████████        | 42/50 [28:40<05:19, 39.92s/it]Evaluating commonsenseqa :  86%|███████████████████████████████████████████       | 43/50 [29:23<04:44, 40.62s/it]Evaluating commonsenseqa :  88%|████████████████████████████████████████████      | 44/50 [30:05<04:06, 41.07s/it]Evaluating commonsenseqa :  90%|█████████████████████████████████████████████     | 45/50 [30:46<03:26, 41.31s/it]Evaluating commonsenseqa :  92%|██████████████████████████████████████████████    | 46/50 [31:11<02:25, 36.27s/it]Evaluating commonsenseqa :  94%|███████████████████████████████████████████████   | 47/50 [31:53<01:53, 37.91s/it]Evaluating commonsenseqa :  96%|████████████████████████████████████████████████  | 48/50 [32:35<01:18, 39.19s/it]Evaluating commonsenseqa :  98%|█████████████████████████████████████████████████ | 49/50 [33:17<00:40, 40.14s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████| 50/50 [33:59<00:00, 40.75s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████| 50/50 [33:59<00:00, 40.80s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 3.0644} | lm_loss 7.8764 | avg. gen lenth: 289.796
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name gsm8k --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/out-domain/o19-tgsm8k-s1-rFalse --seed 1 --num-out-domain 19
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-14 06:57:59,267] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/out-domain/o19-tgsm8k-s1-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 19
  out_domain_data_name ......... gsm8k
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o19-tgsm8k-s1-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                    | 0/9741 [00:00<?, ?it/s]  0%|▏                                                                         | 22/9741 [00:00<00:45, 215.62it/s]  0%|▎                                                                         | 44/9741 [00:00<00:44, 216.18it/s]  1%|▌                                                                         | 66/9741 [00:00<00:44, 216.24it/s]  1%|▋                                                                         | 88/9741 [00:00<00:44, 216.54it/s]  1%|▊                                                                        | 110/9741 [00:00<00:44, 216.91it/s]  1%|▉                                                                        | 132/9741 [00:00<00:45, 213.50it/s]  2%|█▏                                                                       | 154/9741 [00:00<00:44, 214.21it/s]  2%|█▎                                                                       | 176/9741 [00:00<00:44, 214.83it/s]  2%|█▍                                                                       | 198/9741 [00:00<00:44, 215.34it/s]  2%|█▋                                                                       | 220/9741 [00:01<00:44, 213.99it/s]  2%|█▊                                                                       | 242/9741 [00:01<00:44, 214.62it/s]  3%|█▉                                                                       | 264/9741 [00:01<00:44, 215.17it/s]  3%|██▏                                                                      | 286/9741 [00:01<00:43, 215.50it/s]  3%|██▎                                                                      | 308/9741 [00:01<00:43, 215.97it/s]  3%|██▍                                                                      | 330/9741 [00:01<00:43, 216.01it/s]  4%|██▋                                                                      | 352/9741 [00:01<00:44, 213.28it/s]  4%|██▊                                                                      | 374/9741 [00:01<00:43, 214.02it/s]  4%|███                                                                      | 404/9741 [00:01<00:39, 238.44it/s]  4%|███▎                                                                     | 436/9741 [00:01<00:35, 261.46it/s]  5%|███▌                                                                     | 469/9741 [00:02<00:33, 279.92it/s]  5%|███▊                                                                     | 502/9741 [00:02<00:31, 294.63it/s]  5%|████                                                                     | 535/9741 [00:02<00:30, 305.13it/s]  6%|████▎                                                                    | 568/9741 [00:02<00:29, 312.24it/s]  6%|████▌                                                                    | 601/9741 [00:02<00:28, 317.44it/s]  7%|████▊                                                                    | 634/9741 [00:02<00:28, 320.91it/s]  7%|████▉                                                                    | 667/9741 [00:02<00:28, 321.11it/s]  7%|█████▏                                                                   | 700/9741 [00:02<00:27, 323.35it/s]  8%|█████▍                                                                   | 733/9741 [00:02<00:27, 324.94it/s]  8%|█████▋                                                                   | 766/9741 [00:02<00:27, 326.02it/s]  8%|█████▉                                                                   | 799/9741 [00:03<00:27, 326.76it/s]  9%|██████▏                                                                  | 832/9741 [00:03<00:27, 325.22it/s]  9%|██████▍                                                                  | 865/9741 [00:03<00:27, 325.59it/s]  9%|██████▋                                                                  | 898/9741 [00:03<00:27, 324.66it/s] 10%|██████▉                                                                  | 931/9741 [00:03<00:27, 325.92it/s] 10%|███████▏                                                                 | 964/9741 [00:03<00:26, 326.89it/s] 10%|███████▍                                                                 | 997/9741 [00:03<00:26, 327.64it/s] 11%|███████▌                                                                | 1030/9741 [00:03<00:26, 328.14it/s] 11%|███████▊                                                                | 1063/9741 [00:03<00:26, 328.50it/s] 11%|████████                                                                | 1096/9741 [00:03<00:26, 328.18it/s] 12%|████████▎                                                               | 1129/9741 [00:04<00:26, 326.23it/s] 12%|████████▌                                                               | 1162/9741 [00:04<00:26, 326.46it/s] 12%|████████▊                                                               | 1195/9741 [00:04<00:26, 324.19it/s] 13%|█████████                                                               | 1228/9741 [00:04<00:26, 324.89it/s] 13%|█████████▎                                                              | 1261/9741 [00:04<00:26, 325.95it/s] 13%|█████████▌                                                              | 1294/9741 [00:04<00:25, 326.60it/s] 14%|█████████▊                                                              | 1327/9741 [00:04<00:25, 327.20it/s] 14%|██████████                                                              | 1360/9741 [00:04<00:25, 325.45it/s] 14%|██████████▎                                                             | 1393/9741 [00:04<00:25, 326.16it/s] 15%|██████████▌                                                             | 1426/9741 [00:04<00:25, 326.48it/s] 15%|██████████▊                                                             | 1459/9741 [00:05<00:25, 327.06it/s] 15%|███████████                                                             | 1492/9741 [00:05<00:25, 327.41it/s] 16%|███████████▎                                                            | 1525/9741 [00:05<00:25, 324.88it/s] 16%|███████████▌                                                            | 1558/9741 [00:05<00:25, 326.12it/s] 16%|███████████▊                                                            | 1591/9741 [00:05<00:25, 324.38it/s] 17%|████████████                                                            | 1624/9741 [00:05<00:25, 324.13it/s] 17%|████████████▏                                                           | 1657/9741 [00:05<00:24, 324.31it/s] 17%|████████████▍                                                           | 1690/9741 [00:05<00:24, 324.27it/s] 18%|████████████▋                                                           | 1723/9741 [00:05<00:24, 324.38it/s] 18%|████████████▉                                                           | 1756/9741 [00:05<00:24, 324.82it/s] 18%|█████████████▏                                                          | 1789/9741 [00:06<00:26, 305.41it/s] 19%|█████████████▍                                                          | 1822/9741 [00:06<00:25, 311.55it/s] 19%|█████████████▋                                                          | 1855/9741 [00:06<00:24, 315.75it/s] 19%|█████████████▉                                                          | 1887/9741 [00:06<00:24, 315.78it/s] 20%|██████████████▏                                                         | 1920/9741 [00:06<00:24, 317.40it/s] 20%|██████████████▍                                                         | 1952/9741 [00:06<00:24, 316.04it/s] 20%|██████████████▋                                                         | 1985/9741 [00:06<00:24, 318.37it/s] 21%|██████████████▉                                                         | 2017/9741 [00:06<00:24, 317.31it/s] 21%|███████████████▏                                                        | 2050/9741 [00:06<00:24, 319.91it/s] 21%|███████████████▍                                                        | 2083/9741 [00:07<00:23, 321.87it/s] 22%|███████████████▋                                                        | 2116/9741 [00:07<00:23, 322.92it/s] 22%|███████████████▉                                                        | 2149/9741 [00:07<00:23, 324.40it/s] 22%|████████████████▏                                                       | 2182/9741 [00:07<00:23, 325.68it/s] 23%|████████████████▎                                                       | 2215/9741 [00:07<00:23, 326.31it/s] 23%|████████████████▌                                                       | 2248/9741 [00:07<00:23, 323.97it/s] 23%|████████████████▊                                                       | 2281/9741 [00:07<00:22, 324.88it/s] 24%|█████████████████                                                       | 2314/9741 [00:07<00:22, 325.82it/s] 24%|█████████████████▎                                                      | 2347/9741 [00:07<00:22, 326.26it/s] 24%|█████████████████▌                                                      | 2380/9741 [00:07<00:22, 324.99it/s] 25%|█████████████████▊                                                      | 2413/9741 [00:08<00:22, 325.76it/s] 25%|██████████████████                                                      | 2446/9741 [00:08<00:22, 326.45it/s] 25%|██████████████████▎                                                     | 2479/9741 [00:08<00:22, 324.80it/s] 26%|██████████████████▌                                                     | 2512/9741 [00:08<00:22, 325.52it/s] 26%|██████████████████▊                                                     | 2545/9741 [00:08<00:22, 325.68it/s] 26%|███████████████████                                                     | 2578/9741 [00:08<00:21, 326.39it/s] 27%|███████████████████▎                                                    | 2611/9741 [00:08<00:21, 326.90it/s] 27%|███████████████████▌                                                    | 2644/9741 [00:08<00:21, 326.99it/s] 27%|███████████████████▊                                                    | 2677/9741 [00:08<00:21, 326.88it/s] 28%|████████████████████                                                    | 2710/9741 [00:08<00:21, 324.48it/s] 28%|████████████████████▎                                                   | 2743/9741 [00:09<00:21, 325.26it/s] 28%|████████████████████▌                                                   | 2776/9741 [00:09<00:21, 325.75it/s] 29%|████████████████████▊                                                   | 2809/9741 [00:09<00:21, 326.13it/s] 29%|█████████████████████                                                   | 2842/9741 [00:09<00:21, 326.55it/s] 30%|█████████████████████▎                                                  | 2875/9741 [00:09<00:21, 326.37it/s] 30%|█████████████████████▍                                                  | 2908/9741 [00:09<00:20, 325.84it/s] 30%|█████████████████████▋                                                  | 2941/9741 [00:09<00:20, 324.33it/s] 31%|█████████████████████▉                                                  | 2974/9741 [00:09<00:20, 322.95it/s] 31%|██████████████████████▏                                                 | 3007/9741 [00:09<00:20, 324.58it/s] 31%|██████████████████████▍                                                 | 3040/9741 [00:09<00:20, 325.37it/s] 32%|██████████████████████▋                                                 | 3073/9741 [00:10<00:20, 325.30it/s] 32%|██████████████████████▉                                                 | 3106/9741 [00:10<00:20, 326.05it/s] 32%|███████████████████████▏                                                | 3139/9741 [00:10<00:20, 326.51it/s] 33%|███████████████████████▍                                                | 3172/9741 [00:10<00:20, 324.88it/s] 33%|███████████████████████▋                                                | 3205/9741 [00:10<00:20, 325.97it/s] 33%|███████████████████████▉                                                | 3238/9741 [00:10<00:19, 326.64it/s] 34%|████████████████████████▏                                               | 3271/9741 [00:10<00:19, 327.09it/s] 34%|████████████████████████▍                                               | 3304/9741 [00:10<00:19, 327.25it/s] 34%|████████████████████████▋                                               | 3337/9741 [00:10<00:19, 327.17it/s] 35%|████████████████████████▉                                               | 3370/9741 [00:10<00:19, 326.99it/s] 35%|█████████████████████████▏                                              | 3403/9741 [00:11<00:19, 325.22it/s] 35%|█████████████████████████▍                                              | 3436/9741 [00:11<00:19, 325.86it/s] 36%|█████████████████████████▋                                              | 3469/9741 [00:11<00:19, 326.32it/s] 36%|█████████████████████████▉                                              | 3502/9741 [00:11<00:19, 326.48it/s] 36%|██████████████████████████▏                                             | 3535/9741 [00:11<00:18, 326.76it/s] 37%|██████████████████████████▎                                             | 3568/9741 [00:11<00:18, 326.85it/s] 37%|██████████████████████████▌                                             | 3601/9741 [00:11<00:18, 326.92it/s] 37%|██████████████████████████▊                                             | 3634/9741 [00:11<00:18, 324.90it/s] 38%|███████████████████████████                                             | 3667/9741 [00:11<00:18, 325.27it/s] 38%|███████████████████████████▎                                            | 3700/9741 [00:11<00:18, 325.91it/s] 38%|███████████████████████████▌                                            | 3733/9741 [00:12<00:18, 326.29it/s] 39%|███████████████████████████▊                                            | 3766/9741 [00:12<00:18, 326.33it/s] 39%|████████████████████████████                                            | 3799/9741 [00:12<00:18, 326.34it/s] 39%|████████████████████████████▎                                           | 3832/9741 [00:12<00:18, 324.62it/s] 40%|████████████████████████████▌                                           | 3865/9741 [00:12<00:18, 325.21it/s] 40%|████████████████████████████▊                                           | 3898/9741 [00:12<00:17, 325.76it/s] 40%|█████████████████████████████                                           | 3931/9741 [00:12<00:17, 325.96it/s] 41%|█████████████████████████████▎                                          | 3964/9741 [00:12<00:17, 326.03it/s] 41%|█████████████████████████████▌                                          | 3997/9741 [00:12<00:17, 326.17it/s] 41%|█████████████████████████████▊                                          | 4030/9741 [00:12<00:17, 325.28it/s] 42%|██████████████████████████████                                          | 4063/9741 [00:13<00:17, 323.63it/s] 42%|██████████████████████████████▎                                         | 4096/9741 [00:13<00:17, 324.66it/s] 42%|██████████████████████████████▌                                         | 4129/9741 [00:13<00:17, 325.27it/s] 43%|██████████████████████████████▊                                         | 4162/9741 [00:13<00:17, 325.73it/s] 43%|███████████████████████████████                                         | 4195/9741 [00:13<00:17, 326.09it/s] 43%|███████████████████████████████▎                                        | 4228/9741 [00:13<00:16, 325.87it/s] 44%|███████████████████████████████▍                                        | 4261/9741 [00:13<00:16, 326.41it/s] 44%|███████████████████████████████▋                                        | 4294/9741 [00:13<00:16, 324.84it/s] 44%|███████████████████████████████▉                                        | 4327/9741 [00:13<00:16, 325.43it/s] 45%|████████████████████████████████▏                                       | 4360/9741 [00:14<00:16, 325.85it/s] 45%|████████████████████████████████▍                                       | 4393/9741 [00:14<00:16, 326.39it/s] 45%|████████████████████████████████▋                                       | 4426/9741 [00:14<00:16, 326.52it/s] 46%|████████████████████████████████▉                                       | 4459/9741 [00:14<00:16, 326.64it/s] 46%|█████████████████████████████████▏                                      | 4492/9741 [00:14<00:16, 326.85it/s] 46%|█████████████████████████████████▍                                      | 4525/9741 [00:14<00:17, 302.34it/s] 47%|█████████████████████████████████▋                                      | 4558/9741 [00:14<00:16, 308.67it/s] 47%|█████████████████████████████████▉                                      | 4591/9741 [00:14<00:16, 313.84it/s] 47%|██████████████████████████████████▏                                     | 4624/9741 [00:14<00:16, 317.04it/s] 48%|██████████████████████████████████▍                                     | 4657/9741 [00:14<00:15, 318.45it/s] 48%|██████████████████████████████████▋                                     | 4689/9741 [00:15<00:15, 318.66it/s] 48%|██████████████████████████████████▉                                     | 4722/9741 [00:15<00:15, 319.82it/s] 49%|███████████████████████████████████▏                                    | 4755/9741 [00:15<00:22, 220.18it/s] 49%|███████████████████████████████████▍                                    | 4788/9741 [00:15<00:20, 244.13it/s] 49%|███████████████████████████████████▋                                    | 4821/9741 [00:15<00:18, 264.30it/s] 50%|███████████████████████████████████▉                                    | 4854/9741 [00:15<00:17, 279.94it/s] 50%|████████████████████████████████████                                    | 4887/9741 [00:15<00:16, 291.92it/s] 51%|████████████████████████████████████▎                                   | 4920/9741 [00:15<00:15, 301.44it/s] 51%|████████████████████████████████████▌                                   | 4953/9741 [00:16<00:15, 307.11it/s] 51%|████████████████████████████████████▊                                   | 4986/9741 [00:16<00:15, 312.66it/s] 52%|█████████████████████████████████████                                   | 5019/9741 [00:16<00:14, 316.58it/s] 52%|█████████████████████████████████████▎                                  | 5052/9741 [00:16<00:14, 319.43it/s] 52%|█████████████████████████████████████▌                                  | 5085/9741 [00:16<00:14, 320.69it/s] 53%|█████████████████████████████████████▊                                  | 5118/9741 [00:16<00:14, 322.35it/s] 53%|██████████████████████████████████████                                  | 5151/9741 [00:16<00:14, 323.66it/s] 53%|██████████████████████████████████████▎                                 | 5184/9741 [00:16<00:14, 322.47it/s] 54%|██████████████████████████████████████▌                                 | 5217/9741 [00:16<00:13, 323.78it/s] 54%|██████████████████████████████████████▊                                 | 5250/9741 [00:16<00:13, 324.70it/s] 54%|███████████████████████████████████████                                 | 5283/9741 [00:17<00:13, 324.20it/s] 55%|███████████████████████████████████████▎                                | 5316/9741 [00:17<00:13, 325.06it/s] 55%|███████████████████████████████████████▌                                | 5349/9741 [00:17<00:13, 325.47it/s] 55%|███████████████████████████████████████▊                                | 5382/9741 [00:17<00:13, 325.74it/s] 56%|████████████████████████████████████████                                | 5415/9741 [00:17<00:13, 323.95it/s] 56%|████████████████████████████████████████▎                               | 5448/9741 [00:17<00:13, 324.53it/s] 56%|████████████████████████████████████████▌                               | 5481/9741 [00:17<00:13, 325.87it/s] 57%|████████████████████████████████████████▊                               | 5515/9741 [00:17<00:12, 328.96it/s] 57%|█████████████████████████████████████████                               | 5549/9741 [00:17<00:12, 331.22it/s] 57%|█████████████████████████████████████████▎                              | 5583/9741 [00:17<00:12, 332.64it/s] 58%|█████████████████████████████████████████▌                              | 5617/9741 [00:18<00:12, 330.93it/s] 58%|█████████████████████████████████████████▊                              | 5651/9741 [00:18<00:12, 330.66it/s] 58%|██████████████████████████████████████████                              | 5685/9741 [00:18<00:12, 332.46it/s] 59%|██████████████████████████████████████████▎                             | 5719/9741 [00:18<00:12, 333.63it/s] 59%|██████████████████████████████████████████▌                             | 5753/9741 [00:18<00:11, 334.49it/s] 59%|██████████████████████████████████████████▊                             | 5787/9741 [00:18<00:11, 335.11it/s] 60%|███████████████████████████████████████████                             | 5821/9741 [00:18<00:11, 335.36it/s] 60%|███████████████████████████████████████████▎                            | 5855/9741 [00:18<00:11, 333.52it/s] 60%|███████████████████████████████████████████▌                            | 5889/9741 [00:18<00:11, 334.48it/s] 61%|███████████████████████████████████████████▊                            | 5923/9741 [00:18<00:11, 334.96it/s] 61%|████████████████████████████████████████████                            | 5957/9741 [00:19<00:11, 334.82it/s] 62%|████████████████████████████████████████████▎                           | 5991/9741 [00:19<00:11, 335.33it/s] 62%|████████████████████████████████████████████▌                           | 6025/9741 [00:19<00:11, 335.20it/s] 62%|████████████████████████████████████████████▊                           | 6059/9741 [00:19<00:10, 335.72it/s] 63%|█████████████████████████████████████████████                           | 6093/9741 [00:19<00:10, 333.87it/s] 63%|█████████████████████████████████████████████▎                          | 6127/9741 [00:19<00:10, 334.43it/s] 63%|█████████████████████████████████████████████▌                          | 6161/9741 [00:19<00:10, 334.80it/s] 64%|█████████████████████████████████████████████▊                          | 6195/9741 [00:19<00:10, 332.83it/s] 64%|██████████████████████████████████████████████                          | 6229/9741 [00:19<00:10, 333.50it/s] 64%|██████████████████████████████████████████████▎                         | 6263/9741 [00:19<00:10, 333.81it/s] 65%|██████████████████████████████████████████████▌                         | 6297/9741 [00:20<00:10, 334.34it/s] 65%|██████████████████████████████████████████████▊                         | 6331/9741 [00:20<00:10, 332.85it/s] 65%|███████████████████████████████████████████████                         | 6365/9741 [00:20<00:10, 333.83it/s] 66%|███████████████████████████████████████████████▎                        | 6399/9741 [00:20<00:09, 334.82it/s] 66%|███████████████████████████████████████████████▌                        | 6433/9741 [00:20<00:09, 335.30it/s] 66%|███████████████████████████████████████████████▊                        | 6467/9741 [00:20<00:09, 335.28it/s] 67%|████████████████████████████████████████████████                        | 6501/9741 [00:20<00:09, 335.73it/s] 67%|████████████████████████████████████████████████▎                       | 6535/9741 [00:20<00:09, 333.85it/s] 67%|████████████████████████████████████████████████▌                       | 6569/9741 [00:20<00:09, 334.43it/s] 68%|████████████████████████████████████████████████▊                       | 6603/9741 [00:20<00:09, 334.75it/s] 68%|█████████████████████████████████████████████████                       | 6637/9741 [00:21<00:09, 334.21it/s] 68%|█████████████████████████████████████████████████▎                      | 6671/9741 [00:21<00:09, 334.73it/s] 69%|█████████████████████████████████████████████████▌                      | 6705/9741 [00:21<00:09, 334.91it/s] 69%|█████████████████████████████████████████████████▊                      | 6739/9741 [00:21<00:08, 335.53it/s] 70%|██████████████████████████████████████████████████                      | 6773/9741 [00:21<00:08, 331.42it/s] 70%|██████████████████████████████████████████████████▎                     | 6807/9741 [00:21<00:08, 332.79it/s] 70%|██████████████████████████████████████████████████▌                     | 6841/9741 [00:21<00:08, 333.68it/s] 71%|██████████████████████████████████████████████████▊                     | 6875/9741 [00:21<00:08, 334.28it/s] 71%|███████████████████████████████████████████████████                     | 6909/9741 [00:21<00:08, 334.94it/s] 71%|███████████████████████████████████████████████████▎                    | 6943/9741 [00:22<00:08, 335.59it/s] 72%|███████████████████████████████████████████████████▌                    | 6977/9741 [00:22<00:08, 335.66it/s] 72%|███████████████████████████████████████████████████▊                    | 7011/9741 [00:22<00:08, 333.93it/s] 72%|████████████████████████████████████████████████████                    | 7045/9741 [00:22<00:08, 334.81it/s] 73%|████████████████████████████████████████████████████▎                   | 7079/9741 [00:22<00:07, 335.38it/s] 73%|████████████████████████████████████████████████████▌                   | 7113/9741 [00:22<00:07, 335.68it/s] 73%|████████████████████████████████████████████████████▊                   | 7147/9741 [00:22<00:07, 335.74it/s] 74%|█████████████████████████████████████████████████████                   | 7181/9741 [00:22<00:07, 335.84it/s] 74%|█████████████████████████████████████████████████████▎                  | 7215/9741 [00:22<00:07, 334.03it/s] 74%|█████████████████████████████████████████████████████▌                  | 7249/9741 [00:22<00:07, 334.55it/s] 75%|█████████████████████████████████████████████████████▊                  | 7283/9741 [00:23<00:07, 334.66it/s] 75%|██████████████████████████████████████████████████████                  | 7317/9741 [00:23<00:07, 332.67it/s] 75%|██████████████████████████████████████████████████████▎                 | 7351/9741 [00:23<00:07, 333.67it/s] 76%|██████████████████████████████████████████████████████▌                 | 7385/9741 [00:23<00:07, 334.59it/s] 76%|██████████████████████████████████████████████████████▊                 | 7419/9741 [00:23<00:06, 333.94it/s] 77%|███████████████████████████████████████████████████████                 | 7453/9741 [00:23<00:07, 290.97it/s] 77%|███████████████████████████████████████████████████████▎                | 7487/9741 [00:23<00:07, 303.04it/s] 77%|███████████████████████████████████████████████████████▌                | 7521/9741 [00:23<00:07, 311.85it/s] 78%|███████████████████████████████████████████████████████▊                | 7555/9741 [00:23<00:06, 318.67it/s] 78%|████████████████████████████████████████████████████████                | 7589/9741 [00:23<00:06, 323.38it/s] 78%|████████████████████████████████████████████████████████▎               | 7623/9741 [00:24<00:06, 326.83it/s] 79%|████████████████████████████████████████████████████████▌               | 7657/9741 [00:24<00:06, 329.31it/s] 79%|████████████████████████████████████████████████████████▊               | 7691/9741 [00:24<00:06, 329.29it/s] 79%|█████████████████████████████████████████████████████████               | 7725/9741 [00:24<00:06, 331.71it/s] 80%|█████████████████████████████████████████████████████████▎              | 7759/9741 [00:24<00:05, 333.28it/s] 80%|█████████████████████████████████████████████████████████▌              | 7793/9741 [00:24<00:05, 333.92it/s] 80%|█████████████████████████████████████████████████████████▊              | 7827/9741 [00:24<00:05, 334.74it/s] 81%|██████████████████████████████████████████████████████████              | 7861/9741 [00:24<00:05, 335.17it/s] 81%|██████████████████████████████████████████████████████████▎             | 7895/9741 [00:24<00:05, 330.11it/s] 81%|██████████████████████████████████████████████████████████▌             | 7929/9741 [00:25<00:05, 331.94it/s] 82%|██████████████████████████████████████████████████████████▊             | 7963/9741 [00:25<00:05, 332.86it/s] 82%|███████████████████████████████████████████████████████████             | 7997/9741 [00:25<00:05, 333.55it/s] 82%|███████████████████████████████████████████████████████████▎            | 8031/9741 [00:25<00:05, 333.93it/s] 83%|███████████████████████████████████████████████████████████▌            | 8065/9741 [00:25<00:05, 334.48it/s] 83%|███████████████████████████████████████████████████████████▊            | 8099/9741 [00:25<00:04, 335.08it/s] 83%|████████████████████████████████████████████████████████████            | 8133/9741 [00:25<00:04, 333.57it/s] 84%|████████████████████████████████████████████████████████████▎           | 8167/9741 [00:25<00:04, 334.39it/s] 84%|████████████████████████████████████████████████████████████▌           | 8201/9741 [00:25<00:04, 335.02it/s] 85%|████████████████████████████████████████████████████████████▊           | 8235/9741 [00:25<00:04, 335.41it/s] 85%|█████████████████████████████████████████████████████████████           | 8269/9741 [00:26<00:04, 335.68it/s] 85%|█████████████████████████████████████████████████████████████▎          | 8303/9741 [00:26<00:04, 334.76it/s] 86%|█████████████████████████████████████████████████████████████▌          | 8337/9741 [00:26<00:04, 334.76it/s] 86%|█████████████████████████████████████████████████████████████▊          | 8371/9741 [00:26<00:04, 333.33it/s] 86%|██████████████████████████████████████████████████████████████▏         | 8405/9741 [00:26<00:03, 334.02it/s] 87%|██████████████████████████████████████████████████████████████▍         | 8439/9741 [00:26<00:03, 333.95it/s] 87%|██████████████████████████████████████████████████████████████▋         | 8473/9741 [00:26<00:03, 334.45it/s] 87%|██████████████████████████████████████████████████████████████▉         | 8507/9741 [00:26<00:03, 335.21it/s] 88%|███████████████████████████████████████████████████████████████▏        | 8541/9741 [00:26<00:03, 335.34it/s] 88%|███████████████████████████████████████████████████████████████▍        | 8575/9741 [00:26<00:03, 333.52it/s] 88%|███████████████████████████████████████████████████████████████▋        | 8609/9741 [00:27<00:03, 334.07it/s] 89%|███████████████████████████████████████████████████████████████▉        | 8643/9741 [00:27<00:03, 333.69it/s] 89%|████████████████████████████████████████████████████████████████▏       | 8677/9741 [00:27<00:03, 334.54it/s] 89%|████████████████████████████████████████████████████████████████▍       | 8711/9741 [00:27<00:03, 335.08it/s] 90%|████████████████████████████████████████████████████████████████▋       | 8745/9741 [00:27<00:02, 334.60it/s] 90%|████████████████████████████████████████████████████████████████▉       | 8779/9741 [00:27<00:02, 334.69it/s] 90%|█████████████████████████████████████████████████████████████████▏      | 8813/9741 [00:27<00:02, 333.13it/s] 91%|█████████████████████████████████████████████████████████████████▍      | 8847/9741 [00:27<00:02, 333.80it/s] 91%|█████████████████████████████████████████████████████████████████▋      | 8881/9741 [00:27<00:02, 334.55it/s] 92%|█████████████████████████████████████████████████████████████████▉      | 8915/9741 [00:27<00:02, 335.15it/s] 92%|██████████████████████████████████████████████████████████████████▏     | 8949/9741 [00:28<00:02, 335.68it/s] 92%|██████████████████████████████████████████████████████████████████▍     | 8983/9741 [00:28<00:02, 335.27it/s] 93%|██████████████████████████████████████████████████████████████████▋     | 9017/9741 [00:28<00:02, 335.23it/s] 93%|██████████████████████████████████████████████████████████████████▉     | 9051/9741 [00:28<00:02, 333.41it/s] 93%|███████████████████████████████████████████████████████████████████▏    | 9085/9741 [00:28<00:01, 333.43it/s] 94%|███████████████████████████████████████████████████████████████████▍    | 9119/9741 [00:28<00:01, 330.55it/s] 94%|███████████████████████████████████████████████████████████████████▋    | 9153/9741 [00:28<00:01, 331.97it/s] 94%|███████████████████████████████████████████████████████████████████▉    | 9187/9741 [00:28<00:01, 333.17it/s] 95%|████████████████████████████████████████████████████████████████████▏   | 9221/9741 [00:28<00:01, 333.84it/s] 95%|████████████████████████████████████████████████████████████████████▍   | 9255/9741 [00:28<00:01, 332.79it/s] 95%|████████████████████████████████████████████████████████████████████▋   | 9289/9741 [00:29<00:01, 333.39it/s] 96%|████████████████████████████████████████████████████████████████████▉   | 9323/9741 [00:29<00:01, 334.25it/s] 96%|█████████████████████████████████████████████████████████████████████▏  | 9357/9741 [00:29<00:01, 334.80it/s] 96%|█████████████████████████████████████████████████████████████████████▍  | 9391/9741 [00:29<00:01, 335.42it/s] 97%|█████████████████████████████████████████████████████████████████████▋  | 9425/9741 [00:29<00:00, 335.49it/s] 97%|█████████████████████████████████████████████████████████████████████▉  | 9459/9741 [00:29<00:00, 335.29it/s] 97%|██████████████████████████████████████████████████████████████████████▏ | 9493/9741 [00:29<00:00, 333.60it/s] 98%|██████████████████████████████████████████████████████████████████████▍ | 9527/9741 [00:29<00:00, 334.12it/s] 98%|██████████████████████████████████████████████████████████████████████▋ | 9561/9741 [00:29<00:00, 334.63it/s] 99%|██████████████████████████████████████████████████████████████████████▉ | 9595/9741 [00:29<00:00, 334.86it/s] 99%|███████████████████████████████████████████████████████████████████████▏| 9629/9741 [00:30<00:00, 335.10it/s] 99%|███████████████████████████████████████████████████████████████████████▍| 9663/9741 [00:30<00:00, 335.27it/s]100%|███████████████████████████████████████████████████████████████████████▋| 9697/9741 [00:30<00:00, 335.55it/s]100%|███████████████████████████████████████████████████████████████████████▉| 9731/9741 [00:30<00:00, 333.71it/s]100%|████████████████████████████████████████████████████████████████████████| 9741/9741 [00:30<00:00, 320.06it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.12s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.04s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.15s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.44s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:04,  5.00s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:09<00:04,  4.94s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.20s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.35s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.33s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.50s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.38s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.56s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.65s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.79s/it]
[2023-08-14 06:59:21,766] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.76s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.93s/it]
[2023-08-14 06:59:31,070] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-14 06:59:31,070] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-14 06:59:31,071] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-14 06:59:31,071] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-14 06:59:31,071] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-14 06:59:31,071] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-14 06:59:31,071] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-14 06:59:31,071] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-14 06:59:31,071] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-14 06:59:31,071] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-14 06:59:31,071] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-14 06:59:31,071] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f30414cafd0>
[2023-08-14 06:59:31,071] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-14 06:59:31,071] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-14 06:59:31,071] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-14 06:59:31,071] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f3016899cd0>
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-14 06:59:31,072] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-14 06:59:31,073] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.502830982208252 seconds
Loading extension module utils...
Time to load utils op: 0.40437746047973633 seconds
Loading extension module utils...
Time to load utils op: 0.4041740894317627 seconds
Loading extension module utils...
Time to load utils op: 0.5051865577697754 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                                           | 0/50 [00:00<?, ?it/s]############### Example ###############
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following multiple choice question.

### Demonstration:
Input: Mary had 89 stickers.  She used 3 large stickers on the front page of her journal and 7 stickers each to 6 other pages of her journal. How many stickers does Mary have remaining?
Answer: 44

Input: Zach is saving his money to buy a brand new bike that costs $100.  His weekly allowance is $5.  His parent will pay him an extra $10 to mow the lawn.  His neighbor will pay him $7 per hour to babysit their son.  He has already saved up $65.  He'll receive his allowance on Friday and he's planning on babysitting for 2 hours this Saturday after he mows the lawn.  How much more money does Zach need to earn before he can buy the bike?
Answer: 6

Input: Mark has kangaroos and goats.  Kangaroos have two legs and goats have four legs.  If he has 23 kangaroos and three times as many goats as kangaroos what is the total number of legs of all his animals?
Answer: 322

Input: Josh’s mom gives him $20 to go shopping at the mall. He buys a hat for $10 and a pencil for $2. Then he buys four cookies. If each cookie costs $1.25, how much money does Josh have left?
Answer: 3

Input: George's bowling team is one round away from breaking the league record for most points scored in a season. The old record is an average score per player of 287 per round. Each team has 4 players and there are 10 rounds in the season. Through the first 9 rounds, his team has scored a total of 10,440. How many points less than the current league record per game average is the minimum average they need to score, per player, in the final round to tie the league record?
Answer: 27

Input: Max was doing homework in three different subjects. It took him 20 minutes to finish tasks from biology and two times more time to finish history. Geography took him the most time, three times more than history. How much time did Max spend on doing his homework?
Answer: 180

Input: Sophia ate 1/6 of her pie and she put the rest on the fridge. If the pie left in the fridge weighs 1200 grams, how many grams did Sophia eat?
Answer: 240

Input: Sarah, Mary, and Tuan decided to go to the restaurant for a meal. They decided to split the cost of the meal evenly. If the total price of the meal comes to $67 and they have a coupon for $4, how much does each person need to contribute to the bill?
Answer: 21

Input: Tom's brother is 4 times as old as Tom's dog. If in 6 years, Tom's brother will be 30 years, how old is Tom's dog going to be in six years?
Answer: 12

Input: There are 50 children at the party. Three-fifths of them are boys. How many of the children are girls?
Answer: 20

Input: Gail has some bills in her wallet which amount to $100. She has four $5 bills and three $20 bills, and the rest are $10 bills. How many $10 bills are in her wallet?
Answer: 2

Input: A 220-liter barrel has a small leak. It lost 10% of its contents before anyone noticed. How many liters are left in the barrel?
Answer: 198

Input: Markese earned 5 fewer dollars than Evan. Together they earned $37. How many dollars did Markese earn? Use E to represent how many dollars Evan earned.
Answer: 16

Input: Lou Senior took 3 cookies out of the cookie jar and ate them.  Since he didn't get caught by his wife, he went back the next day and took another 3 cookies out of the jar.  But after eating just one of the cookies, he felt guilty about it and put the other two cookies back.  His son, Louie Junior saw that his Dad was eating cookies.  So, Louie Junior took seven cookies out of the jar and hid them in his bedroom for later.  The next morning, Debra, Lou's wife looked into the cookie jar and reacted by accusing her husband of eating half of the cookies out of the cookie jar.  How many cookies remained in the jar?
Answer: 11

Input: John had $200. He gave 3/8 of his money to his mother and 3/10 to his father. How much money did John have left?
Answer: 65

Input: Tonya has $150.00 on her credit card.  If she leaves any balance on her card at the end of the month, she is charged 20% interest.  If she makes a $50.00 payment on her card, what will be the new balance?
Answer: 120

Input: In her first term, Governor Sandoval gave twice as many commencement addresses as Governor Hawkins. Governor Sloan gave ten more commencement addresses than Governor Sandoval in the same amount of time. If Governor Sandoval gave 12 commencement addresses, how many commencement addresses did the three of them give altogether?
Answer: 40

Input: If Buzz bought a pizza with 78 slices at a restaurant and then decided to share it with the waiter in the ratio of 5:8, with Buzz's ratio being 5, what's twenty less the number of slices of pizza that the waiter ate?
Answer: 28

Input: Jolene and Phil have four children, each with the same birthday.  They gave birth to their first child exactly 15 years ago.  They gave birth to their second child exactly one year after the birth of their first child.  They gave birth to their third child on the fourth birthday of their second child. Two years after the birth of their third child, they gave birth to their fourth child.  How old, in years, is their fourth child?
Answer: 8

### Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid

### Response:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o19-tgsm8k-s1-rFalse
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Evaluating commonsenseqa :   0%|                                                           | 0/50 [00:05<?, ?it/s]
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 4114456) of binary: /home/ylu130/.conda/envs/distllm/bin/python
Traceback (most recent call last):
  File "/home/ylu130/.conda/envs/distllm/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 345, in wrapper
    return f(*args, **kwargs)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 761, in main
    run(args)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 752, in run
    elastic_launch(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 131, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 245, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
/home/ylu130/workspace/in-context-generalization/inference.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2023-08-14_06:59:42
  host      : ia1.wse.jhu.edu
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 4114457)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2023-08-14_06:59:42
  host      : ia1.wse.jhu.edu
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 4114458)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2023-08-14_06:59:42
  host      : ia1.wse.jhu.edu
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 4114459)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2023-08-14_06:59:42
  host      : ia1.wse.jhu.edu
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 4114456)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name gsm8k --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/out-domain/o20-tgsm8k-s1-rFalse --seed 1 --num-out-domain 20
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-14 06:59:45,691] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/out-domain/o20-tgsm8k-s1-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 20
  out_domain_data_name ......... gsm8k
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o20-tgsm8k-s1-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                    | 0/9741 [00:00<?, ?it/s]  0%|▏                                                                         | 21/9741 [00:00<00:47, 205.57it/s]  0%|▎                                                                         | 42/9741 [00:00<00:47, 206.12it/s]  1%|▍                                                                         | 63/9741 [00:00<00:46, 206.28it/s]  1%|▋                                                                         | 84/9741 [00:00<00:46, 206.57it/s]  1%|▊                                                                        | 105/9741 [00:00<00:46, 206.97it/s]  1%|▉                                                                        | 126/9741 [00:00<00:46, 206.92it/s]  2%|█                                                                        | 147/9741 [00:00<00:46, 204.66it/s]  2%|█▎                                                                       | 168/9741 [00:00<00:46, 205.14it/s]  2%|█▍                                                                       | 189/9741 [00:00<00:46, 205.29it/s]  2%|█▌                                                                       | 210/9741 [00:01<00:46, 204.12it/s]  2%|█▋                                                                       | 231/9741 [00:01<00:46, 204.94it/s]  3%|█▉                                                                       | 252/9741 [00:01<00:46, 205.30it/s]  3%|██                                                                       | 273/9741 [00:01<00:46, 205.14it/s]  3%|██▏                                                                      | 294/9741 [00:01<00:46, 204.41it/s]  3%|██▎                                                                      | 315/9741 [00:01<00:46, 203.83it/s]  3%|██▌                                                                      | 336/9741 [00:01<00:46, 204.34it/s]  4%|██▋                                                                      | 357/9741 [00:01<00:46, 203.01it/s]  4%|██▉                                                                      | 389/9741 [00:01<00:39, 235.65it/s]  4%|███▏                                                                     | 421/9741 [00:01<00:35, 259.02it/s]  5%|███▍                                                                     | 452/9741 [00:02<00:34, 272.47it/s]  5%|███▋                                                                     | 484/9741 [00:02<00:32, 285.07it/s]  5%|███▊                                                                     | 516/9741 [00:02<00:31, 294.04it/s]  6%|████                                                                     | 548/9741 [00:02<00:30, 300.26it/s]  6%|████▎                                                                    | 580/9741 [00:02<00:30, 304.61it/s]  6%|████▌                                                                    | 612/9741 [00:02<00:29, 307.61it/s]  7%|████▊                                                                    | 644/9741 [00:02<00:29, 309.79it/s]  7%|█████                                                                    | 675/9741 [00:02<00:29, 309.25it/s]  7%|█████▎                                                                   | 707/9741 [00:02<00:29, 310.92it/s]  8%|█████▌                                                                   | 739/9741 [00:02<00:28, 311.87it/s]  8%|█████▊                                                                   | 771/9741 [00:03<00:28, 311.79it/s]  8%|██████                                                                   | 803/9741 [00:03<00:28, 312.78it/s]  9%|██████▎                                                                  | 835/9741 [00:03<00:28, 313.31it/s]  9%|██████▍                                                                  | 867/9741 [00:03<00:28, 313.68it/s]  9%|██████▋                                                                  | 899/9741 [00:03<00:28, 311.93it/s] 10%|██████▉                                                                  | 931/9741 [00:03<00:28, 312.59it/s] 10%|███████▏                                                                 | 963/9741 [00:03<00:28, 313.17it/s] 10%|███████▍                                                                 | 995/9741 [00:03<00:27, 313.46it/s] 11%|███████▌                                                                | 1027/9741 [00:03<00:27, 313.79it/s] 11%|███████▊                                                                | 1059/9741 [00:03<00:27, 313.78it/s] 11%|████████                                                                | 1091/9741 [00:04<00:27, 313.38it/s] 12%|████████▎                                                               | 1123/9741 [00:04<00:27, 311.46it/s] 12%|████████▌                                                               | 1155/9741 [00:04<00:27, 312.26it/s] 12%|████████▊                                                               | 1187/9741 [00:04<00:27, 312.63it/s] 13%|█████████                                                               | 1219/9741 [00:04<00:27, 312.62it/s] 13%|█████████▏                                                              | 1251/9741 [00:04<00:27, 312.82it/s] 13%|█████████▍                                                              | 1283/9741 [00:04<00:27, 313.01it/s] 13%|█████████▋                                                              | 1315/9741 [00:04<00:26, 313.17it/s] 14%|█████████▉                                                              | 1347/9741 [00:04<00:26, 311.22it/s] 14%|██████████▏                                                             | 1379/9741 [00:05<00:26, 311.84it/s] 14%|██████████▍                                                             | 1411/9741 [00:05<00:26, 312.20it/s] 15%|██████████▋                                                             | 1443/9741 [00:05<00:26, 312.47it/s] 15%|██████████▉                                                             | 1475/9741 [00:05<00:26, 312.81it/s] 15%|███████████▏                                                            | 1507/9741 [00:05<00:26, 310.64it/s] 16%|███████████▍                                                            | 1539/9741 [00:05<00:26, 310.82it/s] 16%|███████████▌                                                            | 1571/9741 [00:05<00:26, 308.43it/s] 16%|███████████▊                                                            | 1602/9741 [00:05<00:26, 308.37it/s] 17%|████████████                                                            | 1633/9741 [00:05<00:26, 308.71it/s] 17%|████████████▎                                                           | 1664/9741 [00:05<00:26, 308.94it/s] 17%|████████████▌                                                           | 1695/9741 [00:06<00:26, 308.88it/s] 18%|████████████▊                                                           | 1726/9741 [00:06<00:25, 308.77it/s] 18%|████████████▉                                                           | 1757/9741 [00:06<00:25, 308.94it/s] 18%|█████████████▏                                                          | 1788/9741 [00:06<00:25, 308.95it/s] 19%|█████████████▍                                                          | 1819/9741 [00:06<00:27, 289.45it/s] 19%|█████████████▋                                                          | 1850/9741 [00:06<00:26, 294.80it/s] 19%|█████████████▉                                                          | 1881/9741 [00:06<00:26, 296.58it/s] 20%|██████████████▏                                                         | 1912/9741 [00:06<00:26, 300.04it/s] 20%|██████████████▎                                                         | 1943/9741 [00:06<00:25, 302.35it/s] 20%|██████████████▌                                                         | 1974/9741 [00:06<00:25, 304.20it/s] 21%|██████████████▊                                                         | 2005/9741 [00:07<00:25, 305.50it/s] 21%|███████████████                                                         | 2036/9741 [00:07<00:25, 303.54it/s] 21%|███████████████▎                                                        | 2067/9741 [00:07<00:25, 304.95it/s] 22%|███████████████▌                                                        | 2098/9741 [00:07<00:25, 305.55it/s] 22%|███████████████▋                                                        | 2129/9741 [00:07<00:24, 306.35it/s] 22%|███████████████▉                                                        | 2160/9741 [00:07<00:24, 307.01it/s] 22%|████████████████▏                                                       | 2191/9741 [00:07<00:24, 307.48it/s] 23%|████████████████▍                                                       | 2222/9741 [00:07<00:24, 307.87it/s] 23%|████████████████▋                                                       | 2253/9741 [00:07<00:24, 306.04it/s] 23%|████████████████▉                                                       | 2284/9741 [00:07<00:24, 305.05it/s] 24%|█████████████████                                                       | 2315/9741 [00:08<00:24, 305.76it/s] 24%|█████████████████▎                                                      | 2346/9741 [00:08<00:24, 306.46it/s] 24%|█████████████████▌                                                      | 2377/9741 [00:08<00:23, 307.30it/s] 25%|█████████████████▊                                                      | 2408/9741 [00:08<00:23, 307.83it/s] 25%|██████████████████                                                      | 2439/9741 [00:08<00:23, 308.19it/s] 25%|██████████████████▎                                                     | 2470/9741 [00:08<00:23, 306.16it/s] 26%|██████████████████▍                                                     | 2501/9741 [00:08<00:23, 306.60it/s] 26%|██████████████████▋                                                     | 2532/9741 [00:08<00:23, 306.98it/s] 26%|██████████████████▉                                                     | 2563/9741 [00:08<00:23, 307.29it/s] 27%|███████████████████▏                                                    | 2594/9741 [00:08<00:23, 307.91it/s] 27%|███████████████████▍                                                    | 2625/9741 [00:09<00:23, 308.06it/s] 27%|███████████████████▋                                                    | 2656/9741 [00:09<00:23, 307.88it/s] 28%|███████████████████▊                                                    | 2687/9741 [00:09<00:22, 307.80it/s] 28%|████████████████████                                                    | 2718/9741 [00:09<00:22, 305.83it/s] 28%|████████████████████▎                                                   | 2749/9741 [00:09<00:22, 306.40it/s] 29%|████████████████████▌                                                   | 2780/9741 [00:09<00:22, 306.54it/s] 29%|████████████████████▊                                                   | 2811/9741 [00:09<00:22, 306.72it/s] 29%|█████████████████████                                                   | 2843/9741 [00:09<00:22, 307.95it/s] 30%|█████████████████████▎                                                  | 2875/9741 [00:09<00:22, 309.01it/s] 30%|█████████████████████▍                                                  | 2907/9741 [00:09<00:22, 309.45it/s] 30%|█████████████████████▋                                                  | 2938/9741 [00:10<00:22, 307.72it/s] 30%|█████████████████████▉                                                  | 2970/9741 [00:10<00:21, 308.49it/s] 31%|██████████████████████▏                                                 | 3002/9741 [00:10<00:21, 309.27it/s] 31%|██████████████████████▍                                                 | 3034/9741 [00:10<00:21, 309.70it/s] 31%|██████████████████████▋                                                 | 3066/9741 [00:10<00:21, 309.83it/s] 32%|██████████████████████▉                                                 | 3098/9741 [00:10<00:21, 310.05it/s] 32%|███████████████████████▏                                                | 3130/9741 [00:10<00:21, 310.51it/s] 32%|███████████████████████▎                                                | 3162/9741 [00:10<00:21, 308.54it/s] 33%|███████████████████████▌                                                | 3194/9741 [00:10<00:21, 309.51it/s] 33%|███████████████████████▊                                                | 3226/9741 [00:11<00:21, 309.91it/s] 33%|████████████████████████                                                | 3258/9741 [00:11<00:20, 310.49it/s] 34%|████████████████████████▎                                               | 3290/9741 [00:11<00:20, 310.42it/s] 34%|████████████████████████▌                                               | 3322/9741 [00:11<00:20, 310.47it/s] 34%|████████████████████████▊                                               | 3354/9741 [00:11<00:20, 310.48it/s] 35%|█████████████████████████                                               | 3386/9741 [00:11<00:20, 308.61it/s] 35%|█████████████████████████▎                                              | 3418/9741 [00:11<00:20, 309.34it/s] 35%|█████████████████████████▌                                              | 3450/9741 [00:11<00:20, 310.03it/s] 36%|█████████████████████████▋                                              | 3482/9741 [00:11<00:20, 310.72it/s] 36%|█████████████████████████▉                                              | 3514/9741 [00:11<00:20, 310.60it/s] 36%|██████████████████████████▏                                             | 3546/9741 [00:12<00:19, 311.27it/s] 37%|██████████████████████████▍                                             | 3578/9741 [00:12<00:19, 311.31it/s] 37%|██████████████████████████▋                                             | 3610/9741 [00:12<00:19, 309.62it/s] 37%|██████████████████████████▉                                             | 3642/9741 [00:12<00:19, 310.48it/s] 38%|███████████████████████████▏                                            | 3674/9741 [00:12<00:19, 310.99it/s] 38%|███████████████████████████▍                                            | 3706/9741 [00:12<00:19, 311.33it/s] 38%|███████████████████████████▋                                            | 3738/9741 [00:12<00:19, 311.84it/s] 39%|███████████████████████████▊                                            | 3770/9741 [00:12<00:19, 312.06it/s] 39%|████████████████████████████                                            | 3802/9741 [00:12<00:19, 312.18it/s] 39%|████████████████████████████▎                                           | 3834/9741 [00:12<00:19, 310.35it/s] 40%|████████████████████████████▌                                           | 3866/9741 [00:13<00:18, 310.38it/s] 40%|████████████████████████████▊                                           | 3898/9741 [00:13<00:18, 310.99it/s] 40%|█████████████████████████████                                           | 3930/9741 [00:13<00:18, 310.90it/s] 41%|█████████████████████████████▎                                          | 3962/9741 [00:13<00:18, 311.13it/s] 41%|█████████████████████████████▌                                          | 3994/9741 [00:13<00:18, 311.40it/s] 41%|█████████████████████████████▊                                          | 4026/9741 [00:13<00:18, 311.73it/s] 42%|█████████████████████████████▉                                          | 4058/9741 [00:13<00:18, 309.88it/s] 42%|██████████████████████████████▏                                         | 4090/9741 [00:13<00:18, 310.58it/s] 42%|██████████████████████████████▍                                         | 4122/9741 [00:13<00:18, 310.89it/s] 43%|██████████████████████████████▋                                         | 4154/9741 [00:14<00:17, 311.14it/s] 43%|██████████████████████████████▉                                         | 4186/9741 [00:14<00:17, 311.27it/s] 43%|███████████████████████████████▏                                        | 4218/9741 [00:14<00:17, 311.26it/s] 44%|███████████████████████████████▍                                        | 4250/9741 [00:14<00:17, 311.48it/s] 44%|███████████████████████████████▋                                        | 4282/9741 [00:14<00:17, 311.66it/s] 44%|███████████████████████████████▉                                        | 4314/9741 [00:14<00:17, 309.82it/s] 45%|████████████████████████████████                                        | 4346/9741 [00:14<00:17, 310.36it/s] 45%|████████████████████████████████▎                                       | 4378/9741 [00:14<00:17, 310.57it/s] 45%|████████████████████████████████▌                                       | 4410/9741 [00:14<00:17, 310.03it/s] 46%|████████████████████████████████▊                                       | 4442/9741 [00:14<00:17, 310.32it/s] 46%|█████████████████████████████████                                       | 4474/9741 [00:15<00:16, 310.80it/s] 46%|█████████████████████████████████▎                                      | 4506/9741 [00:15<00:16, 311.18it/s] 47%|█████████████████████████████████▌                                      | 4538/9741 [00:15<00:18, 287.03it/s] 47%|█████████████████████████████████▊                                      | 4570/9741 [00:15<00:17, 294.11it/s] 47%|██████████████████████████████████                                      | 4602/9741 [00:15<00:17, 299.39it/s] 48%|██████████████████████████████████▎                                     | 4634/9741 [00:15<00:16, 302.99it/s] 48%|██████████████████████████████████▍                                     | 4666/9741 [00:15<00:16, 305.57it/s] 48%|██████████████████████████████████▋                                     | 4698/9741 [00:15<00:16, 307.68it/s] 49%|██████████████████████████████████▉                                     | 4730/9741 [00:15<00:16, 309.11it/s] 49%|███████████████████████████████████▏                                    | 4761/9741 [00:16<00:21, 227.41it/s] 49%|███████████████████████████████████▍                                    | 4793/9741 [00:16<00:19, 247.45it/s] 50%|███████████████████████████████████▋                                    | 4824/9741 [00:16<00:18, 262.88it/s] 50%|███████████████████████████████████▉                                    | 4855/9741 [00:16<00:17, 275.00it/s] 50%|████████████████████████████████████                                    | 4886/9741 [00:16<00:17, 282.68it/s] 50%|████████████████████████████████████▎                                   | 4918/9741 [00:16<00:16, 290.94it/s] 51%|████████████████████████████████████▌                                   | 4949/9741 [00:16<00:16, 295.12it/s] 51%|████████████████████████████████████▊                                   | 4981/9741 [00:16<00:15, 300.05it/s] 51%|█████████████████████████████████████                                   | 5013/9741 [00:16<00:15, 303.43it/s] 52%|█████████████████████████████████████▎                                  | 5045/9741 [00:17<00:15, 305.81it/s] 52%|█████████████████████████████████████▌                                  | 5077/9741 [00:17<00:15, 307.45it/s] 52%|█████████████████████████████████████▊                                  | 5109/9741 [00:17<00:15, 308.76it/s] 53%|█████████████████████████████████████▉                                  | 5141/9741 [00:17<00:14, 309.59it/s] 53%|██████████████████████████████████████▏                                 | 5173/9741 [00:17<00:14, 308.48it/s] 53%|██████████████████████████████████████▍                                 | 5205/9741 [00:17<00:14, 309.33it/s] 54%|██████████████████████████████████████▋                                 | 5237/9741 [00:17<00:14, 310.07it/s] 54%|██████████████████████████████████████▉                                 | 5269/9741 [00:17<00:14, 310.49it/s] 54%|███████████████████████████████████████▏                                | 5301/9741 [00:17<00:14, 310.91it/s] 55%|███████████████████████████████████████▍                                | 5333/9741 [00:17<00:14, 310.90it/s] 55%|███████████████████████████████████████▋                                | 5365/9741 [00:18<00:14, 311.14it/s] 55%|███████████████████████████████████████▉                                | 5397/9741 [00:18<00:14, 307.06it/s] 56%|████████████████████████████████████████▏                               | 5429/9741 [00:18<00:13, 308.37it/s] 56%|████████████████████████████████████████▎                               | 5461/9741 [00:18<00:13, 309.21it/s] 56%|████████████████████████████████████████▌                               | 5493/9741 [00:18<00:13, 311.71it/s] 57%|████████████████████████████████████████▊                               | 5526/9741 [00:18<00:13, 314.31it/s] 57%|█████████████████████████████████████████                               | 5559/9741 [00:18<00:13, 316.31it/s] 57%|█████████████████████████████████████████▎                              | 5591/9741 [00:18<00:13, 317.20it/s] 58%|█████████████████████████████████████████▌                              | 5624/9741 [00:18<00:13, 316.55it/s] 58%|█████████████████████████████████████████▊                              | 5657/9741 [00:18<00:12, 317.81it/s] 58%|██████████████████████████████████████████                              | 5690/9741 [00:19<00:12, 318.82it/s] 59%|██████████████████████████████████████████▎                             | 5723/9741 [00:19<00:12, 319.30it/s] 59%|██████████████████████████████████████████▌                             | 5756/9741 [00:19<00:12, 319.59it/s] 59%|██████████████████████████████████████████▊                             | 5789/9741 [00:19<00:12, 319.88it/s] 60%|███████████████████████████████████████████                             | 5822/9741 [00:19<00:12, 320.15it/s] 60%|███████████████████████████████████████████▎                            | 5855/9741 [00:19<00:12, 318.19it/s] 60%|███████████████████████████████████████████▌                            | 5888/9741 [00:19<00:12, 319.02it/s] 61%|███████████████████████████████████████████▊                            | 5921/9741 [00:19<00:11, 319.50it/s] 61%|████████████████████████████████████████████                            | 5953/9741 [00:19<00:11, 317.53it/s] 61%|████████████████████████████████████████████▏                           | 5986/9741 [00:20<00:11, 318.60it/s] 62%|████████████████████████████████████████████▍                           | 6019/9741 [00:20<00:11, 319.14it/s] 62%|████████████████████████████████████████████▋                           | 6052/9741 [00:20<00:11, 319.78it/s] 62%|████████████████████████████████████████████▉                           | 6084/9741 [00:20<00:11, 318.21it/s] 63%|█████████████████████████████████████████████▏                          | 6117/9741 [00:20<00:11, 318.91it/s] 63%|█████████████████████████████████████████████▍                          | 6149/9741 [00:20<00:11, 319.10it/s] 63%|█████████████████████████████████████████████▋                          | 6182/9741 [00:20<00:11, 319.68it/s] 64%|█████████████████████████████████████████████▉                          | 6215/9741 [00:20<00:11, 319.93it/s] 64%|██████████████████████████████████████████████▏                         | 6247/9741 [00:20<00:10, 319.82it/s] 64%|██████████████████████████████████████████████▍                         | 6280/9741 [00:20<00:10, 320.09it/s] 65%|██████████████████████████████████████████████▋                         | 6313/9741 [00:21<00:10, 318.37it/s] 65%|██████████████████████████████████████████████▉                         | 6346/9741 [00:21<00:10, 319.07it/s] 65%|███████████████████████████████████████████████▏                        | 6379/9741 [00:21<00:10, 319.41it/s] 66%|███████████████████████████████████████████████▍                        | 6412/9741 [00:21<00:10, 319.59it/s] 66%|███████████████████████████████████████████████▋                        | 6445/9741 [00:21<00:10, 319.71it/s] 66%|███████████████████████████████████████████████▊                        | 6477/9741 [00:21<00:10, 317.02it/s] 67%|████████████████████████████████████████████████                        | 6509/9741 [00:21<00:10, 317.37it/s] 67%|████████████████████████████████████████████████▎                       | 6541/9741 [00:21<00:10, 314.27it/s] 67%|████████████████████████████████████████████████▌                       | 6573/9741 [00:21<00:10, 315.43it/s] 68%|████████████████████████████████████████████████▊                       | 6605/9741 [00:21<00:09, 316.15it/s] 68%|█████████████████████████████████████████████████                       | 6637/9741 [00:22<00:09, 317.05it/s] 68%|█████████████████████████████████████████████████▎                      | 6669/9741 [00:22<00:09, 317.85it/s] 69%|█████████████████████████████████████████████████▌                      | 6701/9741 [00:22<00:09, 317.90it/s] 69%|█████████████████████████████████████████████████▊                      | 6733/9741 [00:22<00:09, 318.38it/s] 69%|██████████████████████████████████████████████████                      | 6765/9741 [00:22<00:09, 317.01it/s] 70%|██████████████████████████████████████████████████▏                     | 6797/9741 [00:22<00:09, 317.58it/s] 70%|██████████████████████████████████████████████████▍                     | 6829/9741 [00:22<00:09, 318.10it/s] 70%|██████████████████████████████████████████████████▋                     | 6861/9741 [00:22<00:09, 318.55it/s] 71%|██████████████████████████████████████████████████▉                     | 6893/9741 [00:22<00:08, 318.72it/s] 71%|███████████████████████████████████████████████████▏                    | 6925/9741 [00:22<00:08, 318.97it/s] 71%|███████████████████████████████████████████████████▍                    | 6957/9741 [00:23<00:08, 319.00it/s] 72%|███████████████████████████████████████████████████▋                    | 6989/9741 [00:23<00:08, 317.10it/s] 72%|███████████████████████████████████████████████████▉                    | 7021/9741 [00:23<00:08, 314.79it/s] 72%|████████████████████████████████████████████████████▏                   | 7053/9741 [00:23<00:08, 316.12it/s] 73%|████████████████████████████████████████████████████▎                   | 7085/9741 [00:23<00:08, 316.77it/s] 73%|████████████████████████████████████████████████████▌                   | 7117/9741 [00:23<00:08, 316.77it/s] 73%|████████████████████████████████████████████████████▊                   | 7149/9741 [00:23<00:08, 316.63it/s] 74%|█████████████████████████████████████████████████████                   | 7181/9741 [00:23<00:08, 316.40it/s] 74%|█████████████████████████████████████████████████████▎                  | 7213/9741 [00:23<00:08, 312.58it/s] 74%|█████████████████████████████████████████████████████▌                  | 7245/9741 [00:23<00:07, 313.62it/s] 75%|█████████████████████████████████████████████████████▊                  | 7277/9741 [00:24<00:07, 314.24it/s] 75%|██████████████████████████████████████████████████████                  | 7309/9741 [00:24<00:07, 314.93it/s] 75%|██████████████████████████████████████████████████████▎                 | 7341/9741 [00:24<00:07, 315.29it/s] 76%|██████████████████████████████████████████████████████▍                 | 7373/9741 [00:24<00:07, 315.72it/s] 76%|██████████████████████████████████████████████████████▋                 | 7405/9741 [00:24<00:07, 316.06it/s] 76%|██████████████████████████████████████████████████████▉                 | 7437/9741 [00:24<00:07, 315.96it/s] 77%|███████████████████████████████████████████████████████▏                | 7469/9741 [00:24<00:08, 280.31it/s] 77%|███████████████████████████████████████████████████████▍                | 7501/9741 [00:24<00:07, 290.02it/s] 77%|███████████████████████████████████████████████████████▋                | 7533/9741 [00:24<00:07, 295.98it/s] 78%|███████████████████████████████████████████████████████▉                | 7565/9741 [00:25<00:07, 301.55it/s] 78%|████████████████████████████████████████████████████████▏               | 7597/9741 [00:25<00:07, 305.69it/s] 78%|████████████████████████████████████████████████████████▍               | 7629/9741 [00:25<00:06, 308.77it/s] 79%|████████████████████████████████████████████████████████▋               | 7661/9741 [00:25<00:06, 310.58it/s] 79%|████████████████████████████████████████████████████████▊               | 7693/9741 [00:25<00:06, 310.21it/s] 79%|█████████████████████████████████████████████████████████               | 7725/9741 [00:25<00:06, 312.23it/s] 80%|█████████████████████████████████████████████████████████▎              | 7757/9741 [00:25<00:06, 313.38it/s] 80%|█████████████████████████████████████████████████████████▌              | 7789/9741 [00:25<00:06, 313.95it/s] 80%|█████████████████████████████████████████████████████████▊              | 7821/9741 [00:25<00:06, 314.60it/s] 81%|██████████████████████████████████████████████████████████              | 7853/9741 [00:25<00:05, 315.02it/s] 81%|██████████████████████████████████████████████████████████▎             | 7885/9741 [00:26<00:05, 315.11it/s] 81%|██████████████████████████████████████████████████████████▌             | 7917/9741 [00:26<00:05, 313.75it/s] 82%|██████████████████████████████████████████████████████████▊             | 7949/9741 [00:26<00:05, 314.43it/s] 82%|██████████████████████████████████████████████████████████▉             | 7981/9741 [00:26<00:05, 314.85it/s] 82%|███████████████████████████████████████████████████████████▏            | 8013/9741 [00:26<00:05, 315.15it/s] 83%|███████████████████████████████████████████████████████████▍            | 8045/9741 [00:26<00:05, 315.28it/s] 83%|███████████████████████████████████████████████████████████▋            | 8077/9741 [00:26<00:05, 315.39it/s] 83%|███████████████████████████████████████████████████████████▉            | 8109/9741 [00:26<00:05, 315.85it/s] 84%|████████████████████████████████████████████████████████████▏           | 8141/9741 [00:26<00:05, 314.13it/s] 84%|████████████████████████████████████████████████████████████▍           | 8173/9741 [00:26<00:04, 314.70it/s] 84%|████████████████████████████████████████████████████████████▋           | 8205/9741 [00:27<00:04, 315.09it/s] 85%|████████████████████████████████████████████████████████████▉           | 8237/9741 [00:27<00:04, 313.83it/s] 85%|█████████████████████████████████████████████████████████████           | 8269/9741 [00:27<00:04, 314.21it/s] 85%|█████████████████████████████████████████████████████████████▎          | 8301/9741 [00:27<00:04, 314.45it/s] 86%|█████████████████████████████████████████████████████████████▌          | 8333/9741 [00:27<00:04, 314.93it/s] 86%|█████████████████████████████████████████████████████████████▊          | 8365/9741 [00:27<00:04, 313.34it/s] 86%|██████████████████████████████████████████████████████████████          | 8397/9741 [00:27<00:04, 314.06it/s] 87%|██████████████████████████████████████████████████████████████▎         | 8429/9741 [00:27<00:04, 314.75it/s] 87%|██████████████████████████████████████████████████████████████▌         | 8461/9741 [00:27<00:04, 315.15it/s] 87%|██████████████████████████████████████████████████████████████▊         | 8493/9741 [00:27<00:03, 314.87it/s] 88%|███████████████████████████████████████████████████████████████         | 8525/9741 [00:28<00:03, 315.02it/s] 88%|███████████████████████████████████████████████████████████████▏        | 8557/9741 [00:28<00:03, 315.18it/s] 88%|███████████████████████████████████████████████████████████████▍        | 8589/9741 [00:28<00:03, 314.60it/s] 89%|███████████████████████████████████████████████████████████████▋        | 8621/9741 [00:28<00:03, 316.01it/s] 89%|███████████████████████████████████████████████████████████████▉        | 8654/9741 [00:28<00:03, 317.34it/s] 89%|████████████████████████████████████████████████████████████████▏       | 8687/9741 [00:28<00:03, 318.19it/s] 90%|████████████████████████████████████████████████████████████████▍       | 8720/9741 [00:28<00:03, 318.86it/s] 90%|████████████████████████████████████████████████████████████████▋       | 8753/9741 [00:28<00:03, 319.28it/s] 90%|████████████████████████████████████████████████████████████████▉       | 8785/9741 [00:28<00:02, 319.48it/s] 91%|█████████████████████████████████████████████████████████████████▏      | 8817/9741 [00:29<00:02, 317.70it/s] 91%|█████████████████████████████████████████████████████████████████▍      | 8849/9741 [00:29<00:02, 318.35it/s] 91%|█████████████████████████████████████████████████████████████████▋      | 8882/9741 [00:29<00:02, 319.04it/s] 92%|█████████████████████████████████████████████████████████████████▉      | 8915/9741 [00:29<00:02, 319.51it/s] 92%|██████████████████████████████████████████████████████████████████▏     | 8947/9741 [00:29<00:02, 319.37it/s] 92%|██████████████████████████████████████████████████████████████████▍     | 8980/9741 [00:29<00:02, 319.63it/s] 93%|██████████████████████████████████████████████████████████████████▌     | 9013/9741 [00:29<00:02, 319.86it/s] 93%|██████████████████████████████████████████████████████████████████▊     | 9045/9741 [00:29<00:02, 317.54it/s] 93%|███████████████████████████████████████████████████████████████████     | 9078/9741 [00:29<00:02, 318.29it/s] 94%|███████████████████████████████████████████████████████████████████▎    | 9110/9741 [00:29<00:01, 318.71it/s] 94%|███████████████████████████████████████████████████████████████████▌    | 9143/9741 [00:30<00:01, 319.25it/s] 94%|███████████████████████████████████████████████████████████████████▊    | 9176/9741 [00:30<00:01, 319.65it/s] 95%|████████████████████████████████████████████████████████████████████    | 9209/9741 [00:30<00:01, 319.84it/s] 95%|████████████████████████████████████████████████████████████████████▎   | 9242/9741 [00:30<00:01, 319.98it/s] 95%|████████████████████████████████████████████████████████████████████▌   | 9274/9741 [00:30<00:01, 318.33it/s] 96%|████████████████████████████████████████████████████████████████████▊   | 9306/9741 [00:30<00:01, 318.75it/s] 96%|█████████████████████████████████████████████████████████████████████   | 9339/9741 [00:30<00:01, 319.24it/s] 96%|█████████████████████████████████████████████████████████████████████▎  | 9372/9741 [00:30<00:01, 319.60it/s] 97%|█████████████████████████████████████████████████████████████████████▌  | 9404/9741 [00:30<00:01, 319.72it/s] 97%|█████████████████████████████████████████████████████████████████████▊  | 9437/9741 [00:30<00:00, 319.96it/s] 97%|█████████████████████████████████████████████████████████████████████▉  | 9469/9741 [00:31<00:00, 319.93it/s] 98%|██████████████████████████████████████████████████████████████████████▏ | 9501/9741 [00:31<00:00, 318.11it/s] 98%|██████████████████████████████████████████████████████████████████████▍ | 9534/9741 [00:31<00:00, 318.88it/s] 98%|██████████████████████████████████████████████████████████████████████▋ | 9567/9741 [00:31<00:00, 319.23it/s] 99%|██████████████████████████████████████████████████████████████████████▉ | 9600/9741 [00:31<00:00, 319.49it/s] 99%|███████████████████████████████████████████████████████████████████████▏| 9632/9741 [00:31<00:00, 319.23it/s] 99%|███████████████████████████████████████████████████████████████████████▍| 9665/9741 [00:31<00:00, 319.55it/s]100%|███████████████████████████████████████████████████████████████████████▋| 9698/9741 [00:31<00:00, 319.70it/s]100%|███████████████████████████████████████████████████████████████████████▉| 9730/9741 [00:31<00:00, 317.33it/s]100%|████████████████████████████████████████████████████████████████████████| 9741/9741 [00:31<00:00, 305.29it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:04<00:09,  4.86s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.15s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.22s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.43s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:09<00:04,  4.96s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.03s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.10s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.31s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.35s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.51s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.42s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.60s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.48s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.66s/it]
[2023-08-14 07:01:09,252] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.68s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.87s/it]
[2023-08-14 07:01:17,382] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-14 07:01:17,382] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-14 07:01:17,383] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-14 07:01:17,383] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-14 07:01:17,383] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-14 07:01:17,383] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-14 07:01:17,383] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-14 07:01:17,383] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-14 07:01:17,383] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-14 07:01:17,383] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-14 07:01:17,383] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-14 07:01:17,383] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f58e04cbfd0>
[2023-08-14 07:01:17,383] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-14 07:01:17,383] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-14 07:01:17,383] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-14 07:01:17,383] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-14 07:01:17,383] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-14 07:01:17,383] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-14 07:01:17,383] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-14 07:01:17,383] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-14 07:01:17,383] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-14 07:01:17,383] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-14 07:01:17,383] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-14 07:01:17,383] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-14 07:01:17,383] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-14 07:01:17,383] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-14 07:01:17,384] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-14 07:01:17,384] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-14 07:01:17,384] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-14 07:01:17,384] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-14 07:01:17,384] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-14 07:01:17,384] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-14 07:01:17,384] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-14 07:01:17,384] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-14 07:01:17,384] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-14 07:01:17,384] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-14 07:01:17,384] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-14 07:01:17,384] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-14 07:01:17,384] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-14 07:01:17,384] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-14 07:01:17,384] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-14 07:01:17,384] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-14 07:01:17,384] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-14 07:01:17,384] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-14 07:01:17,384] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f58b0fb5cd0>
[2023-08-14 07:01:17,384] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-14 07:01:17,384] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-14 07:01:17,384] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-14 07:01:17,384] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-14 07:01:17,384] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-14 07:01:17,384] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-14 07:01:17,384] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-14 07:01:17,384] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-14 07:01:17,384] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-14 07:01:17,384] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-14 07:01:17,384] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-14 07:01:17,384] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-14 07:01:17,384] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-14 07:01:17,384] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-14 07:01:17,384] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-14 07:01:17,384] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-14 07:01:17,384] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-14 07:01:17,384] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-14 07:01:17,384] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-14 07:01:17,384] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-14 07:01:17,384] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-14 07:01:17,384] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-14 07:01:17,384] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.47182345390319824 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                                           | 0/50 [00:00<?, ?it/s]############### Example ###############
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following multiple choice question.

### Demonstration:
Input: Mary had 89 stickers.  She used 3 large stickers on the front page of her journal and 7 stickers each to 6 other pages of her journal. How many stickers does Mary have remaining?
Answer: 44

Input: Zach is saving his money to buy a brand new bike that costs $100.  His weekly allowance is $5.  His parent will pay him an extra $10 to mow the lawn.  His neighbor will pay him $7 per hour to babysit their son.  He has already saved up $65.  He'll receive his allowance on Friday and he's planning on babysitting for 2 hours this Saturday after he mows the lawn.  How much more money does Zach need to earn before he can buy the bike?
Answer: 6

Input: Mark has kangaroos and goats.  Kangaroos have two legs and goats have four legs.  If he has 23 kangaroos and three times as many goats as kangaroos what is the total number of legs of all his animals?
Answer: 322

Input: Josh’s mom gives him $20 to go shopping at the mall. He buys a hat for $10 and a pencil for $2. Then he buys four cookies. If each cookie costs $1.25, how much money does Josh have left?
Answer: 3

Input: George's bowling team is one round away from breaking the league record for most points scored in a season. The old record is an average score per player of 287 per round. Each team has 4 players and there are 10 rounds in the season. Through the first 9 rounds, his team has scored a total of 10,440. How many points less than the current league record per game average is the minimum average they need to score, per player, in the final round to tie the league record?
Answer: 27

Input: Max was doing homework in three different subjects. It took him 20 minutes to finish tasks from biology and two times more time to finish history. Geography took him the most time, three times more than history. How much time did Max spend on doing his homework?
Answer: 180

Input: Sophia ate 1/6 of her pie and she put the rest on the fridge. If the pie left in the fridge weighs 1200 grams, how many grams did Sophia eat?
Answer: 240

Input: Sarah, Mary, and Tuan decided to go to the restaurant for a meal. They decided to split the cost of the meal evenly. If the total price of the meal comes to $67 and they have a coupon for $4, how much does each person need to contribute to the bill?
Answer: 21

Input: Tom's brother is 4 times as old as Tom's dog. If in 6 years, Tom's brother will be 30 years, how old is Tom's dog going to be in six years?
Answer: 12

Input: There are 50 children at the party. Three-fifths of them are boys. How many of the children are girls?
Answer: 20

Input: Gail has some bills in her wallet which amount to $100. She has four $5 bills and three $20 bills, and the rest are $10 bills. How many $10 bills are in her wallet?
Answer: 2

Input: A 220-liter barrel has a small leak. It lost 10% of its contents before anyone noticed. How many liters are left in the barrel?
Answer: 198

Input: Markese earned 5 fewer dollars than Evan. Together they earned $37. How many dollars did Markese earn? Use E to represent how many dollars Evan earned.
Answer: 16

Input: Lou Senior took 3 cookies out of the cookie jar and ate them.  Since he didn't get caught by his wife, he went back the next day and took another 3 cookies out of the jar.  But after eating just one of the cookies, he felt guilty about it and put the other two cookies back.  His son, Louie Junior saw that his Dad was eating cookies.  So, Louie Junior took seven cookies out of the jar and hid them in his bedroom for later.  The next morning, Debra, Lou's wife looked into the cookie jar and reacted by accusing her husband of eating half of the cookies out of the cookie jar.  How many cookies remained in the jar?
Answer: 11

Input: John had $200. He gave 3/8 of his money to his mother and 3/10 to his father. How much money did John have left?
Answer: 65

Input: Tonya has $150.00 on her credit card.  If she leaves any balance on her card at the end of the month, she is charged 20% interest.  If she makes a $50.00 payment on her card, what will be the new balance?
Answer: 120

Input: In her first term, Governor Sandoval gave twice as many commencement addresses as Governor Hawkins. Governor Sloan gave ten more commencement addresses than Governor Sandoval in the same amount of time. If Governor Sandoval gave 12 commencement addresses, how many commencement addresses did the three of them give altogether?
Answer: 40

Input: If Buzz bought a pizza with 78 slices at a restaurant and then decided to share it with the waiter in the ratio of 5:8, with Buzz's ratio being 5, what's twenty less the number of slices of pizza that the waiter ate?
Answer: 28

Input: Jolene and Phil have four children, each with the same birthday.  They gave birth to their first child exactly 15 years ago.  They gave birth to their second child exactly one year after the birth of their first child.  They gave birth to their third child on the fourth birthday of their second child. Two years after the birth of their third child, they gave birth to their fourth child.  How old, in years, is their fourth child?
Answer: 8

Input: Each purple book has 230 pages. Each orange book contains 510 pages. Mirella read 5 purple books and 4 orange books. How many more orange pages did she read than purple pages?
Answer: 890

### Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid

### Response:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o20-tgsm8k-s1-rFalse
Loading extension module utils...
Time to load utils op: 0.3051114082336426 seconds
Loading extension module utils...
Time to load utils op: 0.5046088695526123 seconds
Loading extension module utils...
Time to load utils op: 0.4046657085418701 seconds
Evaluating commonsenseqa :   0%|                                                           | 0/50 [00:05<?, ?it/s]
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 4115602) of binary: /home/ylu130/.conda/envs/distllm/bin/python
Traceback (most recent call last):
  File "/home/ylu130/.conda/envs/distllm/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 345, in wrapper
    return f(*args, **kwargs)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 761, in main
    run(args)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 752, in run
    elastic_launch(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 131, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 245, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
/home/ylu130/workspace/in-context-generalization/inference.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2023-08-14_07:01:28
  host      : ia1.wse.jhu.edu
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 4115603)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2023-08-14_07:01:28
  host      : ia1.wse.jhu.edu
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 4115604)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2023-08-14_07:01:28
  host      : ia1.wse.jhu.edu
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 4115605)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2023-08-14_07:01:28
  host      : ia1.wse.jhu.edu
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 4115602)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name gsm8k --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/out-domain/o21-tgsm8k-s1-rFalse --seed 1 --num-out-domain 21
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-14 07:01:32,451] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/out-domain/o21-tgsm8k-s1-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 21
  out_domain_data_name ......... gsm8k
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o21-tgsm8k-s1-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                    | 0/9741 [00:00<?, ?it/s]  0%|▏                                                                         | 20/9741 [00:00<00:50, 193.44it/s]  0%|▎                                                                         | 40/9741 [00:00<00:50, 193.86it/s]  1%|▍                                                                         | 60/9741 [00:00<00:49, 194.02it/s]  1%|▌                                                                         | 80/9741 [00:00<00:49, 194.13it/s]  1%|▋                                                                        | 100/9741 [00:00<00:49, 194.47it/s]  1%|▉                                                                        | 120/9741 [00:00<00:49, 194.49it/s]  1%|█                                                                        | 140/9741 [00:00<00:49, 192.22it/s]  2%|█▏                                                                       | 160/9741 [00:00<00:49, 192.94it/s]  2%|█▎                                                                       | 180/9741 [00:00<00:49, 193.20it/s]  2%|█▍                                                                       | 200/9741 [00:01<00:49, 191.94it/s]  2%|█▋                                                                       | 220/9741 [00:01<00:49, 192.61it/s]  2%|█▊                                                                       | 240/9741 [00:01<00:49, 193.04it/s]  3%|█▉                                                                       | 260/9741 [00:01<00:49, 193.35it/s]  3%|██                                                                       | 280/9741 [00:01<00:48, 193.70it/s]  3%|██▏                                                                      | 300/9741 [00:01<00:48, 193.79it/s]  3%|██▍                                                                      | 320/9741 [00:01<00:49, 191.84it/s]  3%|██▌                                                                      | 340/9741 [00:01<00:48, 192.35it/s]  4%|██▋                                                                      | 360/9741 [00:01<00:48, 192.84it/s]  4%|██▊                                                                      | 380/9741 [00:01<00:48, 193.33it/s]  4%|██▉                                                                      | 400/9741 [00:02<00:48, 193.71it/s]  4%|███▏                                                                     | 420/9741 [00:02<00:48, 193.70it/s]  5%|███▎                                                                     | 443/9741 [00:02<00:45, 204.15it/s]  5%|███▌                                                                     | 473/9741 [00:02<00:40, 231.55it/s]  5%|███▊                                                                     | 503/9741 [00:02<00:36, 250.87it/s]  5%|███▉                                                                     | 533/9741 [00:02<00:34, 264.44it/s]  6%|████▏                                                                    | 563/9741 [00:02<00:33, 273.45it/s]  6%|████▍                                                                    | 593/9741 [00:02<00:32, 280.08it/s]  6%|████▋                                                                    | 623/9741 [00:02<00:32, 284.60it/s]  7%|████▉                                                                    | 653/9741 [00:02<00:31, 287.93it/s]  7%|█████                                                                    | 682/9741 [00:03<00:31, 288.22it/s]  7%|█████▎                                                                   | 712/9741 [00:03<00:31, 290.35it/s]  8%|█████▌                                                                   | 742/9741 [00:03<00:30, 291.69it/s]  8%|█████▊                                                                   | 772/9741 [00:03<00:30, 293.15it/s]  8%|██████                                                                   | 802/9741 [00:03<00:30, 294.05it/s]  9%|██████▏                                                                  | 832/9741 [00:03<00:30, 294.72it/s]  9%|██████▍                                                                  | 862/9741 [00:03<00:30, 295.30it/s]  9%|██████▋                                                                  | 892/9741 [00:03<00:30, 293.73it/s]  9%|██████▉                                                                  | 922/9741 [00:03<00:29, 294.39it/s] 10%|███████▏                                                                 | 952/9741 [00:03<00:29, 294.18it/s] 10%|███████▎                                                                 | 982/9741 [00:04<00:29, 294.54it/s] 10%|███████▍                                                                | 1012/9741 [00:04<00:29, 294.89it/s] 11%|███████▋                                                                | 1042/9741 [00:04<00:29, 295.38it/s] 11%|███████▉                                                                | 1072/9741 [00:04<00:29, 295.66it/s] 11%|████████▏                                                               | 1102/9741 [00:04<00:29, 295.88it/s] 12%|████████▎                                                               | 1132/9741 [00:04<00:29, 293.95it/s] 12%|████████▌                                                               | 1162/9741 [00:04<00:29, 294.33it/s] 12%|████████▊                                                               | 1192/9741 [00:04<00:29, 294.61it/s] 13%|█████████                                                               | 1222/9741 [00:04<00:28, 294.67it/s] 13%|█████████▎                                                              | 1252/9741 [00:05<00:28, 294.83it/s] 13%|█████████▍                                                              | 1282/9741 [00:05<00:28, 294.94it/s] 13%|█████████▋                                                              | 1312/9741 [00:05<00:28, 295.23it/s] 14%|█████████▉                                                              | 1342/9741 [00:05<00:28, 291.35it/s] 14%|██████████▏                                                             | 1372/9741 [00:05<00:28, 292.43it/s] 14%|██████████▎                                                             | 1402/9741 [00:05<00:28, 293.06it/s] 15%|██████████▌                                                             | 1432/9741 [00:05<00:28, 293.57it/s] 15%|██████████▊                                                             | 1462/9741 [00:05<00:28, 294.02it/s] 15%|███████████                                                             | 1492/9741 [00:05<00:28, 294.22it/s] 16%|███████████▏                                                            | 1522/9741 [00:05<00:27, 294.38it/s] 16%|███████████▍                                                            | 1552/9741 [00:06<00:27, 294.75it/s] 16%|███████████▋                                                            | 1582/9741 [00:06<00:27, 292.75it/s] 17%|███████████▉                                                            | 1612/9741 [00:06<00:27, 293.24it/s] 17%|████████████▏                                                           | 1642/9741 [00:06<00:27, 293.87it/s] 17%|████████████▎                                                           | 1672/9741 [00:06<00:27, 294.16it/s] 17%|████████████▌                                                           | 1702/9741 [00:06<00:27, 294.22it/s] 18%|████████████▊                                                           | 1732/9741 [00:06<00:27, 292.20it/s] 18%|█████████████                                                           | 1762/9741 [00:06<00:27, 292.90it/s] 18%|█████████████▏                                                          | 1792/9741 [00:06<00:29, 267.52it/s] 19%|█████████████▍                                                          | 1822/9741 [00:06<00:28, 275.02it/s] 19%|█████████████▋                                                          | 1852/9741 [00:07<00:28, 280.44it/s] 19%|█████████████▉                                                          | 1882/9741 [00:07<00:27, 284.39it/s] 20%|██████████████▏                                                         | 1912/9741 [00:07<00:27, 287.48it/s] 20%|██████████████▎                                                         | 1942/9741 [00:07<00:26, 289.50it/s] 20%|██████████████▌                                                         | 1972/9741 [00:07<00:26, 290.95it/s] 21%|██████████████▊                                                         | 2002/9741 [00:07<00:26, 292.23it/s] 21%|███████████████                                                         | 2032/9741 [00:07<00:26, 290.97it/s] 21%|███████████████▏                                                        | 2062/9741 [00:07<00:26, 291.98it/s] 21%|███████████████▍                                                        | 2092/9741 [00:07<00:26, 291.12it/s] 22%|███████████████▋                                                        | 2122/9741 [00:08<00:26, 291.93it/s] 22%|███████████████▉                                                        | 2152/9741 [00:08<00:25, 292.80it/s] 22%|████████████████▏                                                       | 2182/9741 [00:08<00:25, 293.46it/s] 23%|████████████████▎                                                       | 2212/9741 [00:08<00:25, 293.85it/s] 23%|████████████████▌                                                       | 2242/9741 [00:08<00:25, 294.05it/s] 23%|████████████████▊                                                       | 2272/9741 [00:08<00:25, 292.19it/s] 24%|█████████████████                                                       | 2302/9741 [00:08<00:25, 292.84it/s] 24%|█████████████████▏                                                      | 2332/9741 [00:08<00:25, 292.95it/s] 24%|█████████████████▍                                                      | 2362/9741 [00:08<00:25, 293.28it/s] 25%|█████████████████▋                                                      | 2392/9741 [00:08<00:25, 293.26it/s] 25%|█████████████████▉                                                      | 2422/9741 [00:09<00:24, 293.68it/s] 25%|██████████████████                                                      | 2452/9741 [00:09<00:24, 293.75it/s] 25%|██████████████████▎                                                     | 2482/9741 [00:09<00:24, 291.90it/s] 26%|██████████████████▌                                                     | 2512/9741 [00:09<00:24, 292.49it/s] 26%|██████████████████▊                                                     | 2542/9741 [00:09<00:24, 292.60it/s] 26%|███████████████████                                                     | 2572/9741 [00:09<00:24, 293.08it/s] 27%|███████████████████▏                                                    | 2602/9741 [00:09<00:24, 292.84it/s] 27%|███████████████████▍                                                    | 2632/9741 [00:09<00:24, 293.00it/s] 27%|███████████████████▋                                                    | 2662/9741 [00:09<00:24, 293.18it/s] 28%|███████████████████▉                                                    | 2692/9741 [00:09<00:24, 293.13it/s] 28%|████████████████████                                                    | 2722/9741 [00:10<00:24, 291.36it/s] 28%|████████████████████▎                                                   | 2752/9741 [00:10<00:23, 291.92it/s] 29%|████████████████████▌                                                   | 2782/9741 [00:10<00:23, 292.18it/s] 29%|████████████████████▊                                                   | 2812/9741 [00:10<00:23, 292.49it/s] 29%|█████████████████████                                                   | 2842/9741 [00:10<00:23, 292.99it/s] 29%|█████████████████████▏                                                  | 2872/9741 [00:10<00:23, 293.51it/s] 30%|█████████████████████▍                                                  | 2902/9741 [00:10<00:23, 293.51it/s] 30%|█████████████████████▋                                                  | 2932/9741 [00:10<00:23, 291.67it/s] 30%|█████████████████████▉                                                  | 2962/9741 [00:10<00:23, 291.99it/s] 31%|██████████████████████                                                  | 2992/9741 [00:10<00:23, 292.65it/s] 31%|██████████████████████▎                                                 | 3022/9741 [00:11<00:22, 293.30it/s] 31%|██████████████████████▌                                                 | 3052/9741 [00:11<00:22, 293.26it/s] 32%|██████████████████████▊                                                 | 3082/9741 [00:11<00:22, 293.42it/s] 32%|███████████████████████                                                 | 3112/9741 [00:11<00:22, 293.74it/s] 32%|███████████████████████▏                                                | 3142/9741 [00:11<00:22, 293.79it/s] 33%|███████████████████████▍                                                | 3172/9741 [00:11<00:22, 292.00it/s] 33%|███████████████████████▋                                                | 3202/9741 [00:11<00:22, 292.90it/s] 33%|███████████████████████▉                                                | 3232/9741 [00:11<00:22, 293.11it/s] 33%|████████████████████████                                                | 3262/9741 [00:11<00:22, 293.52it/s] 34%|████████████████████████▎                                               | 3292/9741 [00:12<00:21, 293.69it/s] 34%|████████████████████████▌                                               | 3322/9741 [00:12<00:21, 293.73it/s] 34%|████████████████████████▊                                               | 3352/9741 [00:12<00:21, 293.71it/s] 35%|████████████████████████▉                                               | 3382/9741 [00:12<00:21, 291.89it/s] 35%|█████████████████████████▏                                              | 3412/9741 [00:12<00:21, 292.63it/s] 35%|█████████████████████████▍                                              | 3442/9741 [00:12<00:21, 292.86it/s] 36%|█████████████████████████▋                                              | 3472/9741 [00:12<00:21, 293.09it/s] 36%|█████████████████████████▉                                              | 3502/9741 [00:12<00:21, 293.14it/s] 36%|██████████████████████████                                              | 3532/9741 [00:12<00:21, 293.30it/s] 37%|██████████████████████████▎                                             | 3562/9741 [00:12<00:21, 293.45it/s] 37%|██████████████████████████▌                                             | 3592/9741 [00:13<00:21, 292.79it/s] 37%|██████████████████████████▊                                             | 3622/9741 [00:13<00:21, 291.20it/s] 37%|██████████████████████████▉                                             | 3652/9741 [00:13<00:20, 291.89it/s] 38%|███████████████████████████▏                                            | 3682/9741 [00:13<00:20, 292.31it/s] 38%|███████████████████████████▍                                            | 3712/9741 [00:13<00:20, 292.72it/s] 38%|███████████████████████████▋                                            | 3742/9741 [00:13<00:20, 293.18it/s] 39%|███████████████████████████▉                                            | 3772/9741 [00:13<00:20, 293.28it/s] 39%|████████████████████████████                                            | 3802/9741 [00:13<00:20, 293.32it/s] 39%|████████████████████████████▎                                           | 3832/9741 [00:13<00:20, 291.70it/s] 40%|████████████████████████████▌                                           | 3862/9741 [00:13<00:20, 292.41it/s] 40%|████████████████████████████▊                                           | 3892/9741 [00:14<00:19, 292.82it/s] 40%|████████████████████████████▉                                           | 3922/9741 [00:14<00:19, 292.99it/s] 41%|█████████████████████████████▏                                          | 3952/9741 [00:14<00:19, 293.05it/s] 41%|█████████████████████████████▍                                          | 3982/9741 [00:14<00:19, 293.21it/s] 41%|█████████████████████████████▋                                          | 4012/9741 [00:14<00:19, 293.49it/s] 41%|█████████████████████████████▉                                          | 4042/9741 [00:14<00:19, 293.46it/s] 42%|██████████████████████████████                                          | 4072/9741 [00:14<00:19, 290.85it/s] 42%|██████████████████████████████▎                                         | 4102/9741 [00:14<00:19, 291.52it/s] 42%|██████████████████████████████▌                                         | 4132/9741 [00:14<00:19, 292.05it/s] 43%|██████████████████████████████▊                                         | 4162/9741 [00:14<00:19, 292.34it/s] 43%|██████████████████████████████▉                                         | 4192/9741 [00:15<00:18, 292.50it/s] 43%|███████████████████████████████▏                                        | 4222/9741 [00:15<00:18, 292.61it/s] 44%|███████████████████████████████▍                                        | 4252/9741 [00:15<00:18, 292.87it/s] 44%|███████████████████████████████▋                                        | 4282/9741 [00:15<00:18, 293.21it/s] 44%|███████████████████████████████▊                                        | 4312/9741 [00:15<00:18, 291.45it/s] 45%|████████████████████████████████                                        | 4342/9741 [00:15<00:18, 292.14it/s] 45%|████████████████████████████████▎                                       | 4372/9741 [00:15<00:18, 292.43it/s] 45%|████████████████████████████████▌                                       | 4402/9741 [00:15<00:18, 292.14it/s] 45%|████████████████████████████████▊                                       | 4432/9741 [00:15<00:18, 291.71it/s] 46%|████████████████████████████████▉                                       | 4462/9741 [00:16<00:18, 291.56it/s] 46%|█████████████████████████████████▏                                      | 4492/9741 [00:16<00:17, 291.69it/s] 46%|█████████████████████████████████▍                                      | 4522/9741 [00:16<00:19, 268.94it/s] 47%|█████████████████████████████████▋                                      | 4552/9741 [00:16<00:18, 275.21it/s] 47%|█████████████████████████████████▊                                      | 4581/9741 [00:16<00:18, 277.67it/s] 47%|██████████████████████████████████                                      | 4611/9741 [00:16<00:18, 281.78it/s] 48%|██████████████████████████████████▎                                     | 4641/9741 [00:16<00:17, 284.75it/s] 48%|██████████████████████████████████▌                                     | 4671/9741 [00:16<00:17, 286.74it/s] 48%|██████████████████████████████████▋                                     | 4701/9741 [00:16<00:17, 288.24it/s] 49%|██████████████████████████████████▉                                     | 4731/9741 [00:16<00:17, 289.22it/s] 49%|███████████████████████████████████▏                                    | 4760/9741 [00:17<00:23, 216.35it/s] 49%|███████████████████████████████████▍                                    | 4789/9741 [00:17<00:21, 233.57it/s] 49%|███████████████████████████████████▌                                    | 4819/9741 [00:17<00:19, 248.25it/s] 50%|███████████████████████████████████▊                                    | 4849/9741 [00:17<00:18, 259.61it/s] 50%|████████████████████████████████████                                    | 4878/9741 [00:17<00:18, 267.68it/s] 50%|████████████████████████████████████▎                                   | 4908/9741 [00:17<00:17, 274.31it/s] 51%|████████████████████████████████████▍                                   | 4938/9741 [00:17<00:17, 279.14it/s] 51%|████████████████████████████████████▋                                   | 4967/9741 [00:17<00:16, 280.90it/s] 51%|████████████████████████████████████▉                                   | 4997/9741 [00:17<00:16, 284.00it/s] 52%|█████████████████████████████████████▏                                  | 5026/9741 [00:18<00:16, 283.98it/s] 52%|█████████████████████████████████████▎                                  | 5056/9741 [00:18<00:16, 286.15it/s] 52%|█████████████████████████████████████▌                                  | 5086/9741 [00:18<00:16, 287.37it/s] 53%|█████████████████████████████████████▊                                  | 5116/9741 [00:18<00:16, 288.51it/s] 53%|██████████████████████████████████████                                  | 5146/9741 [00:18<00:15, 289.13it/s] 53%|██████████████████████████████████████▎                                 | 5175/9741 [00:18<00:15, 287.98it/s] 53%|██████████████████████████████████████▍                                 | 5205/9741 [00:18<00:15, 288.77it/s] 54%|██████████████████████████████████████▋                                 | 5235/9741 [00:18<00:15, 289.64it/s] 54%|██████████████████████████████████████▉                                 | 5265/9741 [00:18<00:15, 290.54it/s] 54%|███████████████████████████████████████▏                                | 5295/9741 [00:19<00:15, 291.34it/s] 55%|███████████████████████████████████████▎                                | 5325/9741 [00:19<00:15, 291.94it/s] 55%|███████████████████████████████████████▌                                | 5355/9741 [00:19<00:15, 291.95it/s] 55%|███████████████████████████████████████▊                                | 5385/9741 [00:19<00:14, 292.25it/s] 56%|████████████████████████████████████████                                | 5415/9741 [00:19<00:14, 290.54it/s] 56%|████████████████████████████████████████▏                               | 5445/9741 [00:19<00:14, 291.29it/s] 56%|████████████████████████████████████████▍                               | 5475/9741 [00:19<00:14, 291.94it/s] 57%|████████████████████████████████████████▋                               | 5505/9741 [00:19<00:14, 294.23it/s] 57%|████████████████████████████████████████▉                               | 5535/9741 [00:19<00:14, 294.15it/s] 57%|█████████████████████████████████████████▏                              | 5566/9741 [00:19<00:14, 296.26it/s] 57%|█████████████████████████████████████████▎                              | 5597/9741 [00:20<00:13, 297.47it/s] 58%|█████████████████████████████████████████▌                              | 5627/9741 [00:20<00:13, 296.80it/s] 58%|█████████████████████████████████████████▊                              | 5658/9741 [00:20<00:13, 298.06it/s] 58%|██████████████████████████████████████████                              | 5689/9741 [00:20<00:13, 298.93it/s] 59%|██████████████████████████████████████████▎                             | 5720/9741 [00:20<00:13, 299.76it/s] 59%|██████████████████████████████████████████▌                             | 5751/9741 [00:20<00:13, 300.26it/s] 59%|██████████████████████████████████████████▋                             | 5782/9741 [00:20<00:13, 300.52it/s] 60%|██████████████████████████████████████████▉                             | 5813/9741 [00:20<00:13, 300.71it/s] 60%|███████████████████████████████████████████▏                            | 5844/9741 [00:20<00:12, 300.72it/s] 60%|███████████████████████████████████████████▍                            | 5875/9741 [00:20<00:12, 299.18it/s] 61%|███████████████████████████████████████████▋                            | 5906/9741 [00:21<00:12, 299.66it/s] 61%|███████████████████████████████████████████▉                            | 5937/9741 [00:21<00:12, 300.09it/s] 61%|████████████████████████████████████████████                            | 5968/9741 [00:21<00:12, 300.53it/s] 62%|████████████████████████████████████████████▎                           | 5999/9741 [00:21<00:12, 300.66it/s] 62%|████████████████████████████████████████████▌                           | 6030/9741 [00:21<00:12, 298.66it/s] 62%|████████████████████████████████████████████▊                           | 6061/9741 [00:21<00:12, 299.44it/s] 63%|█████████████████████████████████████████████                           | 6091/9741 [00:21<00:12, 297.46it/s] 63%|█████████████████████████████████████████████▎                          | 6122/9741 [00:21<00:12, 298.50it/s] 63%|█████████████████████████████████████████████▍                          | 6153/9741 [00:21<00:11, 299.01it/s] 63%|█████████████████████████████████████████████▋                          | 6184/9741 [00:22<00:11, 299.69it/s] 64%|█████████████████████████████████████████████▉                          | 6215/9741 [00:22<00:11, 300.18it/s] 64%|██████████████████████████████████████████████▏                         | 6246/9741 [00:22<00:11, 300.18it/s] 64%|██████████████████████████████████████████████▍                         | 6277/9741 [00:22<00:11, 300.38it/s] 65%|██████████████████████████████████████████████▋                         | 6308/9741 [00:22<00:11, 298.81it/s] 65%|██████████████████████████████████████████████▊                         | 6339/9741 [00:22<00:11, 299.58it/s] 65%|███████████████████████████████████████████████                         | 6370/9741 [00:22<00:11, 300.02it/s] 66%|███████████████████████████████████████████████▎                        | 6401/9741 [00:22<00:11, 300.34it/s] 66%|███████████████████████████████████████████████▌                        | 6432/9741 [00:22<00:11, 300.53it/s] 66%|███████████████████████████████████████████████▊                        | 6463/9741 [00:22<00:10, 300.42it/s] 67%|████████████████████████████████████████████████                        | 6494/9741 [00:23<00:10, 300.49it/s] 67%|████████████████████████████████████████████████▏                       | 6525/9741 [00:23<00:10, 300.21it/s] 67%|████████████████████████████████████████████████▍                       | 6556/9741 [00:23<00:10, 296.43it/s] 68%|████████████████████████████████████████████████▋                       | 6587/9741 [00:23<00:10, 297.65it/s] 68%|████████████████████████████████████████████████▉                       | 6618/9741 [00:23<00:10, 298.56it/s] 68%|█████████████████████████████████████████████████▏                      | 6649/9741 [00:23<00:10, 299.37it/s] 69%|█████████████████████████████████████████████████▎                      | 6680/9741 [00:23<00:10, 299.85it/s] 69%|█████████████████████████████████████████████████▌                      | 6711/9741 [00:23<00:10, 300.19it/s] 69%|█████████████████████████████████████████████████▊                      | 6742/9741 [00:23<00:09, 300.71it/s] 70%|██████████████████████████████████████████████████                      | 6773/9741 [00:23<00:09, 299.40it/s] 70%|██████████████████████████████████████████████████▎                     | 6804/9741 [00:24<00:09, 300.09it/s] 70%|██████████████████████████████████████████████████▌                     | 6835/9741 [00:24<00:09, 300.49it/s] 70%|██████████████████████████████████████████████████▋                     | 6866/9741 [00:24<00:09, 300.85it/s] 71%|██████████████████████████████████████████████████▉                     | 6897/9741 [00:24<00:09, 301.06it/s] 71%|███████████████████████████████████████████████████▏                    | 6928/9741 [00:24<00:09, 301.20it/s] 71%|███████████████████████████████████████████████████▍                    | 6959/9741 [00:24<00:09, 301.29it/s] 72%|███████████████████████████████████████████████████▋                    | 6990/9741 [00:24<00:09, 299.50it/s] 72%|███████████████████████████████████████████████████▉                    | 7021/9741 [00:24<00:09, 299.90it/s] 72%|████████████████████████████████████████████████████                    | 7051/9741 [00:24<00:09, 298.43it/s] 73%|████████████████████████████████████████████████████▎                   | 7082/9741 [00:25<00:08, 298.98it/s] 73%|████████████████████████████████████████████████████▌                   | 7113/9741 [00:25<00:08, 299.75it/s] 73%|████████████████████████████████████████████████████▊                   | 7144/9741 [00:25<00:08, 300.18it/s] 74%|█████████████████████████████████████████████████████                   | 7175/9741 [00:25<00:08, 300.32it/s] 74%|█████████████████████████████████████████████████████▎                  | 7206/9741 [00:25<00:08, 300.64it/s] 74%|█████████████████████████████████████████████████████▍                  | 7237/9741 [00:25<00:08, 299.03it/s] 75%|█████████████████████████████████████████████████████▋                  | 7268/9741 [00:25<00:08, 299.61it/s] 75%|█████████████████████████████████████████████████████▉                  | 7299/9741 [00:25<00:08, 300.21it/s] 75%|██████████████████████████████████████████████████████▏                 | 7330/9741 [00:25<00:08, 300.34it/s] 76%|██████████████████████████████████████████████████████▍                 | 7361/9741 [00:25<00:07, 300.61it/s] 76%|██████████████████████████████████████████████████████▋                 | 7392/9741 [00:26<00:07, 300.81it/s] 76%|██████████████████████████████████████████████████████▊                 | 7423/9741 [00:26<00:07, 300.80it/s] 77%|███████████████████████████████████████████████████████                 | 7454/9741 [00:26<00:08, 268.92it/s] 77%|███████████████████████████████████████████████████████▎                | 7485/9741 [00:26<00:08, 277.78it/s] 77%|███████████████████████████████████████████████████████▌                | 7515/9741 [00:26<00:07, 281.38it/s] 77%|███████████████████████████████████████████████████████▊                | 7546/9741 [00:26<00:07, 286.87it/s] 78%|████████████████████████████████████████████████████████                | 7577/9741 [00:26<00:07, 291.03it/s] 78%|████████████████████████████████████████████████████████▏               | 7608/9741 [00:26<00:07, 293.98it/s] 78%|████████████████████████████████████████████████████████▍               | 7639/9741 [00:26<00:07, 295.97it/s] 79%|████████████████████████████████████████████████████████▋               | 7669/9741 [00:27<00:07, 295.67it/s] 79%|████████████████████████████████████████████████████████▉               | 7699/9741 [00:27<00:06, 295.75it/s] 79%|█████████████████████████████████████████████████████████▏              | 7730/9741 [00:27<00:06, 297.61it/s] 80%|█████████████████████████████████████████████████████████▎              | 7761/9741 [00:27<00:06, 298.67it/s] 80%|█████████████████████████████████████████████████████████▌              | 7792/9741 [00:27<00:06, 299.12it/s] 80%|█████████████████████████████████████████████████████████▊              | 7823/9741 [00:27<00:06, 299.62it/s] 81%|██████████████████████████████████████████████████████████              | 7854/9741 [00:27<00:06, 300.02it/s] 81%|██████████████████████████████████████████████████████████▎             | 7885/9741 [00:27<00:06, 300.37it/s] 81%|██████████████████████████████████████████████████████████▌             | 7916/9741 [00:27<00:06, 299.17it/s] 82%|██████████████████████████████████████████████████████████▋             | 7947/9741 [00:27<00:05, 299.80it/s] 82%|██████████████████████████████████████████████████████████▉             | 7978/9741 [00:28<00:05, 300.18it/s] 82%|███████████████████████████████████████████████████████████▏            | 8009/9741 [00:28<00:05, 300.33it/s] 83%|███████████████████████████████████████████████████████████▍            | 8040/9741 [00:28<00:05, 300.63it/s] 83%|███████████████████████████████████████████████████████████▋            | 8071/9741 [00:28<00:05, 300.68it/s] 83%|███████████████████████████████████████████████████████████▉            | 8102/9741 [00:28<00:05, 301.02it/s] 83%|████████████████████████████████████████████████████████████            | 8133/9741 [00:28<00:05, 299.58it/s] 84%|████████████████████████████████████████████████████████████▎           | 8164/9741 [00:28<00:05, 300.15it/s] 84%|████████████████████████████████████████████████████████████▌           | 8195/9741 [00:28<00:05, 300.44it/s] 84%|████████████████████████████████████████████████████████████▊           | 8226/9741 [00:28<00:05, 300.64it/s] 85%|█████████████████████████████████████████████████████████████           | 8257/9741 [00:28<00:04, 300.78it/s] 85%|█████████████████████████████████████████████████████████████▎          | 8288/9741 [00:29<00:04, 300.48it/s] 85%|█████████████████████████████████████████████████████████████▍          | 8319/9741 [00:29<00:04, 300.52it/s] 86%|█████████████████████████████████████████████████████████████▋          | 8350/9741 [00:29<00:04, 298.32it/s] 86%|█████████████████████████████████████████████████████████████▉          | 8381/9741 [00:29<00:04, 299.23it/s] 86%|██████████████████████████████████████████████████████████████▏         | 8411/9741 [00:29<00:04, 299.12it/s] 87%|██████████████████████████████████████████████████████████████▍         | 8442/9741 [00:29<00:04, 299.87it/s] 87%|██████████████████████████████████████████████████████████████▋         | 8473/9741 [00:29<00:04, 300.07it/s] 87%|██████████████████████████████████████████████████████████████▊         | 8504/9741 [00:29<00:04, 300.50it/s] 88%|███████████████████████████████████████████████████████████████         | 8535/9741 [00:29<00:04, 300.47it/s] 88%|███████████████████████████████████████████████████████████████▎        | 8566/9741 [00:29<00:03, 300.58it/s] 88%|███████████████████████████████████████████████████████████████▌        | 8597/9741 [00:30<00:03, 298.98it/s] 89%|███████████████████████████████████████████████████████████████▊        | 8628/9741 [00:30<00:03, 299.39it/s] 89%|████████████████████████████████████████████████████████████████        | 8659/9741 [00:30<00:03, 299.74it/s] 89%|████████████████████████████████████████████████████████████████▏       | 8690/9741 [00:30<00:03, 300.11it/s] 90%|████████████████████████████████████████████████████████████████▍       | 8721/9741 [00:30<00:03, 300.38it/s] 90%|████████████████████████████████████████████████████████████████▋       | 8752/9741 [00:30<00:03, 300.50it/s] 90%|████████████████████████████████████████████████████████████████▉       | 8783/9741 [00:30<00:03, 300.32it/s] 90%|█████████████████████████████████████████████████████████████████▏      | 8814/9741 [00:30<00:03, 298.40it/s] 91%|█████████████████████████████████████████████████████████████████▎      | 8844/9741 [00:30<00:03, 298.85it/s] 91%|█████████████████████████████████████████████████████████████████▌      | 8875/9741 [00:31<00:02, 299.58it/s] 91%|█████████████████████████████████████████████████████████████████▊      | 8906/9741 [00:31<00:02, 299.92it/s] 92%|██████████████████████████████████████████████████████████████████      | 8937/9741 [00:31<00:02, 300.28it/s] 92%|██████████████████████████████████████████████████████████████████▎     | 8968/9741 [00:31<00:02, 300.45it/s] 92%|██████████████████████████████████████████████████████████████████▌     | 8999/9741 [00:31<00:02, 300.67it/s] 93%|██████████████████████████████████████████████████████████████████▋     | 9030/9741 [00:31<00:02, 298.66it/s] 93%|██████████████████████████████████████████████████████████████████▉     | 9061/9741 [00:31<00:02, 299.30it/s] 93%|███████████████████████████████████████████████████████████████████▏    | 9092/9741 [00:31<00:02, 299.72it/s] 94%|███████████████████████████████████████████████████████████████████▍    | 9123/9741 [00:31<00:02, 300.03it/s] 94%|███████████████████████████████████████████████████████████████████▋    | 9154/9741 [00:31<00:01, 300.27it/s] 94%|███████████████████████████████████████████████████████████████████▉    | 9185/9741 [00:32<00:01, 300.38it/s] 95%|████████████████████████████████████████████████████████████████████    | 9216/9741 [00:32<00:01, 300.45it/s] 95%|████████████████████████████████████████████████████████████████████▎   | 9247/9741 [00:32<00:01, 300.62it/s] 95%|████████████████████████████████████████████████████████████████████▌   | 9278/9741 [00:32<00:01, 298.62it/s] 96%|████████████████████████████████████████████████████████████████████▊   | 9309/9741 [00:32<00:01, 299.15it/s] 96%|█████████████████████████████████████████████████████████████████████   | 9340/9741 [00:32<00:01, 299.63it/s] 96%|█████████████████████████████████████████████████████████████████████▎  | 9371/9741 [00:32<00:01, 299.95it/s] 97%|█████████████████████████████████████████████████████████████████████▍  | 9402/9741 [00:32<00:01, 300.06it/s] 97%|█████████████████████████████████████████████████████████████████████▋  | 9433/9741 [00:32<00:01, 300.17it/s] 97%|█████████████████████████████████████████████████████████████████████▉  | 9464/9741 [00:32<00:00, 300.23it/s] 97%|██████████████████████████████████████████████████████████████████████▏ | 9495/9741 [00:33<00:00, 298.73it/s] 98%|██████████████████████████████████████████████████████████████████████▍ | 9526/9741 [00:33<00:00, 299.37it/s] 98%|██████████████████████████████████████████████████████████████████████▋ | 9557/9741 [00:33<00:00, 299.81it/s] 98%|██████████████████████████████████████████████████████████████████████▊ | 9588/9741 [00:33<00:00, 300.21it/s] 99%|███████████████████████████████████████████████████████████████████████ | 9619/9741 [00:33<00:00, 300.44it/s] 99%|███████████████████████████████████████████████████████████████████████▎| 9650/9741 [00:33<00:00, 300.33it/s] 99%|███████████████████████████████████████████████████████████████████████▌| 9681/9741 [00:33<00:00, 300.04it/s]100%|███████████████████████████████████████████████████████████████████████▊| 9712/9741 [00:33<00:00, 298.37it/s]100%|████████████████████████████████████████████████████████████████████████| 9741/9741 [00:33<00:00, 287.26it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.07s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.15s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.30s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.47s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:04,  4.99s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.03s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.18s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.34s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.40s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.56s/it]
[2023-08-14 07:02:57,727] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.43s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.60s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.56s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.74s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.70s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.88s/it]
[2023-08-14 07:03:06,574] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-14 07:03:06,576] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-14 07:03:06,576] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-14 07:03:06,577] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-14 07:03:06,577] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-14 07:03:06,577] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-14 07:03:06,577] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-14 07:03:06,577] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-14 07:03:06,577] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-14 07:03:06,577] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-14 07:03:06,577] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-14 07:03:06,577] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fd41ce43fd0>
[2023-08-14 07:03:06,577] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-14 07:03:06,578] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-14 07:03:06,578] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-14 07:03:06,578] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-14 07:03:06,578] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-14 07:03:06,578] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-14 07:03:06,578] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-14 07:03:06,578] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-14 07:03:06,578] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-14 07:03:06,578] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-14 07:03:06,578] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-14 07:03:06,578] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-14 07:03:06,578] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-14 07:03:06,578] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-14 07:03:06,578] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-14 07:03:06,578] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-14 07:03:06,578] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-14 07:03:06,578] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-14 07:03:06,578] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-14 07:03:06,578] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-14 07:03:06,578] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-14 07:03:06,578] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-14 07:03:06,578] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-14 07:03:06,578] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-14 07:03:06,578] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-14 07:03:06,578] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-14 07:03:06,578] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-14 07:03:06,578] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-14 07:03:06,579] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-14 07:03:06,579] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-14 07:03:06,579] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-14 07:03:06,579] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-14 07:03:06,579] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7fd3ecacecd0>
[2023-08-14 07:03:06,579] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-14 07:03:06,579] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-14 07:03:06,579] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-14 07:03:06,579] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-14 07:03:06,579] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-14 07:03:06,579] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-14 07:03:06,579] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-14 07:03:06,579] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-14 07:03:06,579] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-14 07:03:06,579] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-14 07:03:06,579] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-14 07:03:06,579] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-14 07:03:06,579] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-14 07:03:06,579] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-14 07:03:06,579] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-14 07:03:06,579] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-14 07:03:06,579] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-14 07:03:06,579] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-14 07:03:06,579] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-14 07:03:06,580] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-14 07:03:06,580] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-14 07:03:06,580] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-14 07:03:06,580] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.5459916591644287 seconds
Loading extension module utils...
Time to load utils op: 0.5044896602630615 seconds
Loading extension module utils...
Time to load utils op: 0.6049156188964844 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                                           | 0/50 [00:00<?, ?it/s]Loading extension module utils...
############### Example ###############
Time to load utils op: 0.6048555374145508 seconds
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following multiple choice question.

### Demonstration:
Input: Mary had 89 stickers.  She used 3 large stickers on the front page of her journal and 7 stickers each to 6 other pages of her journal. How many stickers does Mary have remaining?
Answer: 44

Input: Zach is saving his money to buy a brand new bike that costs $100.  His weekly allowance is $5.  His parent will pay him an extra $10 to mow the lawn.  His neighbor will pay him $7 per hour to babysit their son.  He has already saved up $65.  He'll receive his allowance on Friday and he's planning on babysitting for 2 hours this Saturday after he mows the lawn.  How much more money does Zach need to earn before he can buy the bike?
Answer: 6

Input: Mark has kangaroos and goats.  Kangaroos have two legs and goats have four legs.  If he has 23 kangaroos and three times as many goats as kangaroos what is the total number of legs of all his animals?
Answer: 322

Input: Josh’s mom gives him $20 to go shopping at the mall. He buys a hat for $10 and a pencil for $2. Then he buys four cookies. If each cookie costs $1.25, how much money does Josh have left?
Answer: 3

Input: George's bowling team is one round away from breaking the league record for most points scored in a season. The old record is an average score per player of 287 per round. Each team has 4 players and there are 10 rounds in the season. Through the first 9 rounds, his team has scored a total of 10,440. How many points less than the current league record per game average is the minimum average they need to score, per player, in the final round to tie the league record?
Answer: 27

Input: Max was doing homework in three different subjects. It took him 20 minutes to finish tasks from biology and two times more time to finish history. Geography took him the most time, three times more than history. How much time did Max spend on doing his homework?
Answer: 180

Input: Sophia ate 1/6 of her pie and she put the rest on the fridge. If the pie left in the fridge weighs 1200 grams, how many grams did Sophia eat?
Answer: 240

Input: Sarah, Mary, and Tuan decided to go to the restaurant for a meal. They decided to split the cost of the meal evenly. If the total price of the meal comes to $67 and they have a coupon for $4, how much does each person need to contribute to the bill?
Answer: 21

Input: Tom's brother is 4 times as old as Tom's dog. If in 6 years, Tom's brother will be 30 years, how old is Tom's dog going to be in six years?
Answer: 12

Input: There are 50 children at the party. Three-fifths of them are boys. How many of the children are girls?
Answer: 20

Input: Gail has some bills in her wallet which amount to $100. She has four $5 bills and three $20 bills, and the rest are $10 bills. How many $10 bills are in her wallet?
Answer: 2

Input: A 220-liter barrel has a small leak. It lost 10% of its contents before anyone noticed. How many liters are left in the barrel?
Answer: 198

Input: Markese earned 5 fewer dollars than Evan. Together they earned $37. How many dollars did Markese earn? Use E to represent how many dollars Evan earned.
Answer: 16

Input: Lou Senior took 3 cookies out of the cookie jar and ate them.  Since he didn't get caught by his wife, he went back the next day and took another 3 cookies out of the jar.  But after eating just one of the cookies, he felt guilty about it and put the other two cookies back.  His son, Louie Junior saw that his Dad was eating cookies.  So, Louie Junior took seven cookies out of the jar and hid them in his bedroom for later.  The next morning, Debra, Lou's wife looked into the cookie jar and reacted by accusing her husband of eating half of the cookies out of the cookie jar.  How many cookies remained in the jar?
Answer: 11

Input: John had $200. He gave 3/8 of his money to his mother and 3/10 to his father. How much money did John have left?
Answer: 65

Input: Tonya has $150.00 on her credit card.  If she leaves any balance on her card at the end of the month, she is charged 20% interest.  If she makes a $50.00 payment on her card, what will be the new balance?
Answer: 120

Input: In her first term, Governor Sandoval gave twice as many commencement addresses as Governor Hawkins. Governor Sloan gave ten more commencement addresses than Governor Sandoval in the same amount of time. If Governor Sandoval gave 12 commencement addresses, how many commencement addresses did the three of them give altogether?
Answer: 40

Input: If Buzz bought a pizza with 78 slices at a restaurant and then decided to share it with the waiter in the ratio of 5:8, with Buzz's ratio being 5, what's twenty less the number of slices of pizza that the waiter ate?
Answer: 28

Input: Jolene and Phil have four children, each with the same birthday.  They gave birth to their first child exactly 15 years ago.  They gave birth to their second child exactly one year after the birth of their first child.  They gave birth to their third child on the fourth birthday of their second child. Two years after the birth of their third child, they gave birth to their fourth child.  How old, in years, is their fourth child?
Answer: 8

Input: Each purple book has 230 pages. Each orange book contains 510 pages. Mirella read 5 purple books and 4 orange books. How many more orange pages did she read than purple pages?
Answer: 890

Input: Isabella has $45 more than Sam but only $15 more than Giselle. If Giselle has $120, calculate the total amount of money each shopper will receive if Isabella, Sam, and Giselle donate the money to three shoppers at their local town's supermarket who then decides to share it equally.
Answer: 115

### Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid

### Response:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o21-tgsm8k-s1-rFalse
Evaluating commonsenseqa :   0%|                                                           | 0/50 [00:05<?, ?it/s]
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 4116749) of binary: /home/ylu130/.conda/envs/distllm/bin/python
Traceback (most recent call last):
  File "/home/ylu130/.conda/envs/distllm/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 345, in wrapper
    return f(*args, **kwargs)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 761, in main
    run(args)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 752, in run
    elastic_launch(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 131, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 245, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
/home/ylu130/workspace/in-context-generalization/inference.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2023-08-14_07:03:15
  host      : ia1.wse.jhu.edu
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 4116750)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2023-08-14_07:03:15
  host      : ia1.wse.jhu.edu
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 4116751)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2023-08-14_07:03:15
  host      : ia1.wse.jhu.edu
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 4116752)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2023-08-14_07:03:15
  host      : ia1.wse.jhu.edu
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 4116749)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name gsm8k --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/out-domain/o22-tgsm8k-s1-rFalse --seed 1 --num-out-domain 22
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-14 07:03:18,469] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...

[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date![nltk_data]   Package punkt is already up-to-date!

arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/out-domain/o22-tgsm8k-s1-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 22
  out_domain_data_name ......... gsm8k
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o22-tgsm8k-s1-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                    | 0/9741 [00:00<?, ?it/s]  0%|▏                                                                         | 28/9741 [00:00<00:34, 279.03it/s]  1%|▍                                                                         | 57/9741 [00:00<00:34, 280.32it/s]  1%|▋                                                                         | 86/9741 [00:00<00:34, 280.98it/s]  1%|▊                                                                        | 115/9741 [00:00<00:34, 280.35it/s]  1%|█                                                                        | 144/9741 [00:00<00:34, 280.75it/s]  2%|█▎                                                                       | 173/9741 [00:00<00:34, 281.13it/s]  2%|█▌                                                                       | 202/9741 [00:00<00:34, 278.55it/s]  2%|█▋                                                                       | 231/9741 [00:00<00:34, 279.08it/s]  3%|█▉                                                                       | 260/9741 [00:00<00:33, 279.41it/s]  3%|██▏                                                                      | 289/9741 [00:01<00:33, 280.24it/s]  3%|██▍                                                                      | 318/9741 [00:01<00:33, 277.48it/s]  4%|██▌                                                                      | 347/9741 [00:01<00:33, 278.43it/s]  4%|██▊                                                                      | 376/9741 [00:01<00:33, 279.63it/s]  4%|███                                                                      | 405/9741 [00:01<00:33, 280.46it/s]  4%|███▎                                                                     | 434/9741 [00:01<00:33, 278.91it/s]  5%|███▍                                                                     | 463/9741 [00:01<00:33, 279.95it/s]  5%|███▋                                                                     | 492/9741 [00:01<00:32, 280.40it/s]  5%|███▉                                                                     | 521/9741 [00:01<00:32, 281.00it/s]  6%|████                                                                     | 550/9741 [00:01<00:32, 281.02it/s]  6%|████▎                                                                    | 579/9741 [00:02<00:34, 265.21it/s]  6%|████▌                                                                    | 606/9741 [00:02<00:39, 233.73it/s]  6%|████▋                                                                    | 631/9741 [00:02<00:41, 218.02it/s]  7%|████▉                                                                    | 654/9741 [00:02<00:44, 205.59it/s]  7%|█████                                                                    | 676/9741 [00:02<00:45, 199.78it/s]  7%|█████▏                                                                   | 697/9741 [00:02<00:46, 195.79it/s]  7%|█████▎                                                                   | 717/9741 [00:02<00:46, 192.63it/s]  8%|█████▌                                                                   | 737/9741 [00:02<00:47, 190.50it/s]  8%|█████▋                                                                   | 757/9741 [00:03<00:47, 189.05it/s]  8%|█████▊                                                                   | 776/9741 [00:03<00:48, 186.73it/s]  8%|█████▉                                                                   | 795/9741 [00:03<00:48, 186.09it/s]  8%|██████                                                                   | 814/9741 [00:03<00:48, 185.88it/s]  9%|██████▏                                                                  | 833/9741 [00:03<00:47, 185.70it/s]  9%|██████▍                                                                  | 852/9741 [00:03<00:47, 185.56it/s]  9%|██████▌                                                                  | 871/9741 [00:03<00:47, 185.56it/s]  9%|██████▋                                                                  | 890/9741 [00:03<00:48, 183.93it/s]  9%|██████▊                                                                  | 909/9741 [00:03<00:47, 184.36it/s] 10%|██████▉                                                                  | 928/9741 [00:03<00:47, 184.60it/s] 10%|███████▏                                                                 | 953/9741 [00:04<00:43, 203.19it/s] 10%|███████▎                                                                 | 982/9741 [00:04<00:38, 226.79it/s] 10%|███████▍                                                                | 1011/9741 [00:04<00:35, 243.10it/s] 11%|███████▋                                                                | 1040/9741 [00:04<00:34, 254.15it/s] 11%|███████▉                                                                | 1069/9741 [00:04<00:33, 262.15it/s] 11%|████████                                                                | 1098/9741 [00:04<00:32, 267.84it/s] 12%|████████▎                                                               | 1126/9741 [00:04<00:31, 269.82it/s] 12%|████████▌                                                               | 1155/9741 [00:04<00:31, 273.22it/s] 12%|████████▊                                                               | 1184/9741 [00:04<00:31, 275.56it/s] 12%|████████▉                                                               | 1212/9741 [00:05<00:30, 276.52it/s] 13%|█████████▏                                                              | 1241/9741 [00:05<00:30, 277.77it/s] 13%|█████████▍                                                              | 1270/9741 [00:05<00:30, 278.82it/s] 13%|█████████▌                                                              | 1299/9741 [00:05<00:30, 279.56it/s] 14%|█████████▊                                                              | 1328/9741 [00:05<00:30, 280.02it/s] 14%|██████████                                                              | 1357/9741 [00:05<00:30, 278.26it/s] 14%|██████████▏                                                             | 1385/9741 [00:05<00:29, 278.70it/s] 15%|██████████▍                                                             | 1413/9741 [00:05<00:29, 278.84it/s] 15%|██████████▋                                                             | 1441/9741 [00:05<00:29, 278.35it/s] 15%|██████████▊                                                             | 1469/9741 [00:05<00:29, 278.23it/s] 15%|███████████                                                             | 1498/9741 [00:06<00:29, 278.80it/s] 16%|███████████▎                                                            | 1527/9741 [00:06<00:29, 279.24it/s] 16%|███████████▌                                                            | 1556/9741 [00:06<00:29, 279.94it/s] 16%|███████████▋                                                            | 1584/9741 [00:06<00:29, 277.97it/s] 17%|███████████▉                                                            | 1613/9741 [00:06<00:29, 278.76it/s] 17%|████████████▏                                                           | 1642/9741 [00:06<00:28, 279.60it/s] 17%|████████████▎                                                           | 1671/9741 [00:06<00:28, 280.07it/s] 17%|████████████▌                                                           | 1700/9741 [00:06<00:28, 280.15it/s] 18%|████████████▊                                                           | 1729/9741 [00:06<00:28, 279.32it/s] 18%|████████████▉                                                           | 1758/9741 [00:06<00:28, 279.71it/s] 18%|█████████████▏                                                          | 1786/9741 [00:07<00:28, 278.67it/s] 19%|█████████████▍                                                          | 1814/9741 [00:07<00:30, 257.77it/s] 19%|█████████████▌                                                          | 1843/9741 [00:07<00:29, 264.30it/s] 19%|█████████████▊                                                          | 1872/9741 [00:07<00:29, 268.94it/s] 20%|██████████████                                                          | 1901/9741 [00:07<00:28, 272.30it/s] 20%|██████████████▎                                                         | 1930/9741 [00:07<00:28, 274.65it/s] 20%|██████████████▍                                                         | 1958/9741 [00:07<00:28, 276.06it/s] 20%|██████████████▋                                                         | 1987/9741 [00:07<00:27, 277.37it/s] 21%|██████████████▉                                                         | 2015/9741 [00:07<00:27, 277.42it/s] 21%|███████████████                                                         | 2043/9741 [00:08<00:27, 274.95it/s] 21%|███████████████▎                                                        | 2071/9741 [00:08<00:27, 276.10it/s] 22%|███████████████▌                                                        | 2099/9741 [00:08<00:27, 276.04it/s] 22%|███████████████▋                                                        | 2127/9741 [00:08<00:27, 277.16it/s] 22%|███████████████▉                                                        | 2155/9741 [00:08<00:27, 275.51it/s] 22%|████████████████▏                                                       | 2184/9741 [00:08<00:27, 277.09it/s] 23%|████████████████▎                                                       | 2213/9741 [00:08<00:27, 278.07it/s] 23%|████████████████▌                                                       | 2241/9741 [00:08<00:26, 278.57it/s] 23%|████████████████▊                                                       | 2269/9741 [00:08<00:26, 276.83it/s] 24%|████████████████▉                                                       | 2298/9741 [00:08<00:26, 277.96it/s] 24%|█████████████████▏                                                      | 2326/9741 [00:09<00:26, 278.52it/s] 24%|█████████████████▍                                                      | 2355/9741 [00:09<00:26, 279.01it/s] 24%|█████████████████▌                                                      | 2384/9741 [00:09<00:26, 279.42it/s] 25%|█████████████████▊                                                      | 2412/9741 [00:09<00:26, 279.49it/s] 25%|██████████████████                                                      | 2440/9741 [00:09<00:26, 278.45it/s] 25%|██████████████████▏                                                     | 2469/9741 [00:09<00:26, 278.98it/s] 26%|██████████████████▍                                                     | 2497/9741 [00:09<00:26, 277.10it/s] 26%|██████████████████▋                                                     | 2526/9741 [00:09<00:25, 278.05it/s] 26%|██████████████████▉                                                     | 2554/9741 [00:09<00:25, 278.50it/s] 27%|███████████████████                                                     | 2582/9741 [00:09<00:25, 278.55it/s] 27%|███████████████████▎                                                    | 2611/9741 [00:10<00:25, 279.13it/s] 27%|███████████████████▌                                                    | 2639/9741 [00:10<00:25, 279.34it/s] 27%|███████████████████▋                                                    | 2668/9741 [00:10<00:25, 279.65it/s] 28%|███████████████████▉                                                    | 2696/9741 [00:10<00:25, 277.55it/s] 28%|████████████████████▏                                                   | 2724/9741 [00:10<00:25, 278.13it/s] 28%|████████████████████▎                                                   | 2753/9741 [00:10<00:25, 278.76it/s] 29%|████████████████████▌                                                   | 2781/9741 [00:10<00:24, 278.95it/s] 29%|████████████████████▊                                                   | 2809/9741 [00:10<00:24, 278.66it/s] 29%|████████████████████▉                                                   | 2837/9741 [00:10<00:24, 278.72it/s] 29%|█████████████████████▏                                                  | 2865/9741 [00:10<00:24, 279.08it/s] 30%|█████████████████████▍                                                  | 2893/9741 [00:11<00:24, 279.34it/s] 30%|█████████████████████▌                                                  | 2922/9741 [00:11<00:24, 279.72it/s] 30%|█████████████████████▊                                                  | 2950/9741 [00:11<00:24, 277.56it/s] 31%|██████████████████████                                                  | 2979/9741 [00:11<00:24, 278.37it/s] 31%|██████████████████████▏                                                 | 3008/9741 [00:11<00:24, 279.04it/s] 31%|██████████████████████▍                                                 | 3036/9741 [00:11<00:24, 279.13it/s] 31%|██████████████████████▋                                                 | 3064/9741 [00:11<00:23, 278.96it/s] 32%|██████████████████████▊                                                 | 3092/9741 [00:11<00:23, 277.63it/s] 32%|███████████████████████                                                 | 3121/9741 [00:11<00:23, 278.49it/s] 32%|███████████████████████▎                                                | 3149/9741 [00:11<00:23, 278.39it/s] 33%|███████████████████████▍                                                | 3177/9741 [00:12<00:23, 276.99it/s] 33%|███████████████████████▋                                                | 3206/9741 [00:12<00:23, 278.16it/s] 33%|███████████████████████▉                                                | 3234/9741 [00:12<00:23, 276.00it/s] 33%|████████████████████████                                                | 3263/9741 [00:12<00:23, 277.51it/s] 34%|████████████████████████▎                                               | 3292/9741 [00:12<00:23, 278.40it/s] 34%|████████████████████████▌                                               | 3321/9741 [00:12<00:23, 279.06it/s] 34%|████████████████████████▊                                               | 3349/9741 [00:12<00:22, 279.31it/s] 35%|████████████████████████▉                                               | 3377/9741 [00:12<00:22, 277.59it/s] 35%|█████████████████████████▏                                              | 3406/9741 [00:12<00:22, 278.50it/s] 35%|█████████████████████████▍                                              | 3435/9741 [00:13<00:22, 279.00it/s] 36%|█████████████████████████▌                                              | 3463/9741 [00:13<00:22, 279.18it/s] 36%|█████████████████████████▊                                              | 3491/9741 [00:13<00:22, 279.26it/s] 36%|██████████████████████████                                              | 3519/9741 [00:13<00:22, 279.33it/s] 36%|██████████████████████████▏                                             | 3547/9741 [00:13<00:22, 279.34it/s] 37%|██████████████████████████▍                                             | 3575/9741 [00:13<00:22, 279.44it/s] 37%|██████████████████████████▋                                             | 3603/9741 [00:13<00:22, 277.16it/s] 37%|██████████████████████████▊                                             | 3631/9741 [00:13<00:22, 275.64it/s] 38%|███████████████████████████                                             | 3660/9741 [00:13<00:21, 276.98it/s] 38%|███████████████████████████▎                                            | 3689/9741 [00:13<00:21, 278.05it/s] 38%|███████████████████████████▍                                            | 3717/9741 [00:14<00:21, 278.44it/s] 38%|███████████████████████████▋                                            | 3745/9741 [00:14<00:21, 278.64it/s] 39%|███████████████████████████▉                                            | 3773/9741 [00:14<00:21, 278.92it/s] 39%|████████████████████████████                                            | 3802/9741 [00:14<00:21, 279.32it/s] 39%|████████████████████████████▎                                           | 3831/9741 [00:14<00:21, 277.56it/s] 40%|████████████████████████████▌                                           | 3860/9741 [00:14<00:21, 278.43it/s] 40%|████████████████████████████▋                                           | 3889/9741 [00:14<00:20, 279.09it/s] 40%|████████████████████████████▉                                           | 3918/9741 [00:14<00:20, 279.45it/s] 41%|█████████████████████████████▏                                          | 3947/9741 [00:14<00:20, 279.67it/s] 41%|█████████████████████████████▍                                          | 3975/9741 [00:14<00:20, 277.07it/s] 41%|█████████████████████████████▌                                          | 4004/9741 [00:15<00:20, 278.18it/s] 41%|█████████████████████████████▊                                          | 4033/9741 [00:15<00:20, 278.76it/s] 42%|██████████████████████████████                                          | 4061/9741 [00:15<00:20, 275.35it/s] 42%|██████████████████████████████▏                                         | 4090/9741 [00:15<00:20, 276.84it/s] 42%|██████████████████████████████▍                                         | 4118/9741 [00:15<00:20, 277.72it/s] 43%|██████████████████████████████▋                                         | 4146/9741 [00:15<00:20, 278.33it/s] 43%|██████████████████████████████▊                                         | 4174/9741 [00:15<00:19, 278.56it/s] 43%|███████████████████████████████                                         | 4202/9741 [00:15<00:19, 278.83it/s] 43%|███████████████████████████████▎                                        | 4231/9741 [00:15<00:19, 279.24it/s] 44%|███████████████████████████████▍                                        | 4260/9741 [00:15<00:19, 279.25it/s] 44%|███████████████████████████████▋                                        | 4288/9741 [00:16<00:19, 277.24it/s] 44%|███████████████████████████████▉                                        | 4317/9741 [00:16<00:19, 278.06it/s] 45%|████████████████████████████████                                        | 4345/9741 [00:16<00:19, 278.21it/s] 45%|████████████████████████████████▎                                       | 4373/9741 [00:16<00:19, 277.47it/s] 45%|████████████████████████████████▌                                       | 4401/9741 [00:16<00:19, 277.38it/s] 45%|████████████████████████████████▋                                       | 4429/9741 [00:16<00:19, 277.90it/s] 46%|████████████████████████████████▉                                       | 4457/9741 [00:16<00:18, 278.46it/s] 46%|█████████████████████████████████▏                                      | 4485/9741 [00:16<00:18, 278.73it/s] 46%|█████████████████████████████████▎                                      | 4513/9741 [00:16<00:21, 239.75it/s] 47%|█████████████████████████████████▌                                      | 4541/9741 [00:17<00:20, 250.23it/s] 47%|█████████████████████████████████▊                                      | 4570/9741 [00:17<00:19, 258.78it/s] 47%|█████████████████████████████████▉                                      | 4598/9741 [00:17<00:19, 264.73it/s] 47%|██████████████████████████████████▏                                     | 4626/9741 [00:17<00:19, 269.01it/s] 48%|██████████████████████████████████▍                                     | 4655/9741 [00:17<00:18, 272.31it/s] 48%|██████████████████████████████████▌                                     | 4683/9741 [00:17<00:18, 274.25it/s] 48%|██████████████████████████████████▊                                     | 4711/9741 [00:17<00:18, 275.69it/s] 49%|███████████████████████████████████                                     | 4739/9741 [00:17<00:27, 183.13it/s] 49%|███████████████████████████████████▏                                    | 4767/9741 [00:18<00:24, 203.13it/s] 49%|███████████████████████████████████▍                                    | 4796/9741 [00:18<00:22, 221.82it/s] 50%|███████████████████████████████████▋                                    | 4824/9741 [00:18<00:20, 236.25it/s] 50%|███████████████████████████████████▊                                    | 4852/9741 [00:18<00:19, 247.71it/s] 50%|████████████████████████████████████                                    | 4880/9741 [00:18<00:18, 256.14it/s] 50%|████████████████████████████████████▎                                   | 4908/9741 [00:18<00:18, 262.41it/s] 51%|████████████████████████████████████▍                                   | 4936/9741 [00:18<00:17, 267.12it/s] 51%|████████████████████████████████████▋                                   | 4964/9741 [00:18<00:17, 268.61it/s] 51%|████████████████████████████████████▉                                   | 4992/9741 [00:18<00:17, 271.77it/s] 52%|█████████████████████████████████████                                   | 5020/9741 [00:18<00:17, 274.18it/s] 52%|█████████████████████████████████████▎                                  | 5049/9741 [00:19<00:16, 276.08it/s] 52%|█████████████████████████████████████▌                                  | 5077/9741 [00:19<00:16, 277.17it/s] 52%|█████████████████████████████████████▋                                  | 5105/9741 [00:19<00:16, 277.91it/s] 53%|█████████████████████████████████████▉                                  | 5133/9741 [00:19<00:16, 278.33it/s] 53%|██████████████████████████████████████▏                                 | 5161/9741 [00:19<00:16, 278.69it/s] 53%|██████████████████████████████████████▎                                 | 5189/9741 [00:19<00:16, 276.30it/s] 54%|██████████████████████████████████████▌                                 | 5217/9741 [00:19<00:16, 276.43it/s] 54%|██████████████████████████████████████▊                                 | 5245/9741 [00:19<00:16, 277.37it/s] 54%|██████████████████████████████████████▉                                 | 5273/9741 [00:19<00:16, 277.97it/s] 54%|███████████████████████████████████████▏                                | 5302/9741 [00:19<00:15, 278.72it/s] 55%|███████████████████████████████████████▍                                | 5330/9741 [00:20<00:15, 277.96it/s] 55%|███████████████████████████████████████▌                                | 5358/9741 [00:20<00:15, 277.61it/s] 55%|███████████████████████████████████████▊                                | 5386/9741 [00:20<00:15, 278.29it/s] 56%|████████████████████████████████████████                                | 5414/9741 [00:20<00:15, 276.50it/s] 56%|████████████████████████████████████████▏                               | 5443/9741 [00:20<00:15, 277.60it/s] 56%|████████████████████████████████████████▍                               | 5472/9741 [00:20<00:15, 278.47it/s] 56%|████████████████████████████████████████▋                               | 5501/9741 [00:20<00:15, 280.94it/s] 57%|████████████████████████████████████████▊                               | 5530/9741 [00:20<00:14, 283.10it/s] 57%|█████████████████████████████████████████                               | 5559/9741 [00:20<00:14, 284.64it/s] 57%|█████████████████████████████████████████▎                              | 5588/9741 [00:20<00:14, 285.46it/s] 58%|█████████████████████████████████████████▌                              | 5617/9741 [00:21<00:14, 286.10it/s] 58%|█████████████████████████████████████████▋                              | 5646/9741 [00:21<00:14, 284.52it/s] 58%|█████████████████████████████████████████▉                              | 5675/9741 [00:21<00:14, 285.53it/s] 59%|██████████████████████████████████████████▏                             | 5704/9741 [00:21<00:14, 285.83it/s] 59%|██████████████████████████████████████████▍                             | 5733/9741 [00:21<00:13, 286.69it/s] 59%|██████████████████████████████████████████▌                             | 5762/9741 [00:21<00:13, 287.07it/s] 59%|██████████████████████████████████████████▊                             | 5791/9741 [00:21<00:13, 287.08it/s] 60%|███████████████████████████████████████████                             | 5820/9741 [00:21<00:13, 286.13it/s] 60%|███████████████████████████████████████████▏                            | 5849/9741 [00:21<00:13, 286.03it/s] 60%|███████████████████████████████████████████▍                            | 5878/9741 [00:21<00:13, 284.24it/s] 61%|███████████████████████████████████████████▋                            | 5907/9741 [00:22<00:13, 284.62it/s] 61%|███████████████████████████████████████████▉                            | 5936/9741 [00:22<00:13, 285.58it/s] 61%|████████████████████████████████████████████                            | 5965/9741 [00:22<00:13, 286.45it/s] 62%|████████████████████████████████████████████▎                           | 5994/9741 [00:22<00:13, 287.01it/s] 62%|████████████████████████████████████████████▌                           | 6023/9741 [00:22<00:12, 287.34it/s] 62%|████████████████████████████████████████████▋                           | 6052/9741 [00:22<00:12, 287.64it/s] 62%|████████████████████████████████████████████▉                           | 6081/9741 [00:22<00:12, 285.80it/s] 63%|█████████████████████████████████████████████▏                          | 6110/9741 [00:22<00:12, 286.41it/s] 63%|█████████████████████████████████████████████▍                          | 6139/9741 [00:22<00:12, 286.57it/s] 63%|█████████████████████████████████████████████▌                          | 6168/9741 [00:22<00:12, 286.65it/s] 64%|█████████████████████████████████████████████▊                          | 6197/9741 [00:23<00:12, 287.07it/s] 64%|██████████████████████████████████████████████                          | 6226/9741 [00:23<00:12, 287.04it/s] 64%|██████████████████████████████████████████████▏                         | 6255/9741 [00:23<00:12, 286.41it/s] 65%|██████████████████████████████████████████████▍                         | 6284/9741 [00:23<00:12, 286.65it/s] 65%|██████████████████████████████████████████████▋                         | 6313/9741 [00:23<00:12, 284.90it/s] 65%|██████████████████████████████████████████████▉                         | 6342/9741 [00:23<00:11, 285.78it/s] 65%|███████████████████████████████████████████████                         | 6371/9741 [00:23<00:11, 286.37it/s] 66%|███████████████████████████████████████████████▎                        | 6400/9741 [00:23<00:11, 286.73it/s] 66%|███████████████████████████████████████████████▌                        | 6429/9741 [00:23<00:11, 287.05it/s] 66%|███████████████████████████████████████████████▋                        | 6458/9741 [00:24<00:11, 287.35it/s] 67%|███████████████████████████████████████████████▉                        | 6487/9741 [00:24<00:11, 287.01it/s] 67%|████████████████████████████████████████████████▏                       | 6516/9741 [00:24<00:11, 286.75it/s] 67%|████████████████████████████████████████████████▍                       | 6545/9741 [00:24<00:11, 284.81it/s] 67%|████████████████████████████████████████████████▌                       | 6574/9741 [00:24<00:11, 285.52it/s] 68%|████████████████████████████████████████████████▊                       | 6603/9741 [00:24<00:10, 286.06it/s] 68%|█████████████████████████████████████████████████                       | 6632/9741 [00:24<00:10, 286.61it/s] 68%|█████████████████████████████████████████████████▏                      | 6661/9741 [00:24<00:10, 286.61it/s] 69%|█████████████████████████████████████████████████▍                      | 6690/9741 [00:24<00:10, 286.96it/s] 69%|█████████████████████████████████████████████████▋                      | 6719/9741 [00:24<00:10, 287.20it/s] 69%|█████████████████████████████████████████████████▉                      | 6748/9741 [00:25<00:10, 287.03it/s] 70%|██████████████████████████████████████████████████                      | 6777/9741 [00:25<00:10, 284.49it/s] 70%|██████████████████████████████████████████████████▎                     | 6806/9741 [00:25<00:10, 285.63it/s] 70%|██████████████████████████████████████████████████▌                     | 6835/9741 [00:25<00:10, 286.39it/s] 70%|██████████████████████████████████████████████████▋                     | 6864/9741 [00:25<00:10, 286.98it/s] 71%|██████████████████████████████████████████████████▉                     | 6893/9741 [00:25<00:09, 287.52it/s] 71%|███████████████████████████████████████████████████▏                    | 6922/9741 [00:25<00:09, 287.68it/s] 71%|███████████████████████████████████████████████████▍                    | 6951/9741 [00:25<00:09, 287.83it/s] 72%|███████████████████████████████████████████████████▌                    | 6980/9741 [00:25<00:09, 287.80it/s] 72%|███████████████████████████████████████████████████▊                    | 7009/9741 [00:25<00:09, 285.81it/s] 72%|████████████████████████████████████████████████████                    | 7038/9741 [00:26<00:09, 286.48it/s] 73%|████████████████████████████████████████████████████▏                   | 7067/9741 [00:26<00:09, 286.61it/s] 73%|████████████████████████████████████████████████████▍                   | 7096/9741 [00:26<00:09, 286.75it/s] 73%|████████████████████████████████████████████████████▋                   | 7125/9741 [00:26<00:09, 286.82it/s] 73%|████████████████████████████████████████████████████▉                   | 7154/9741 [00:26<00:09, 284.61it/s] 74%|█████████████████████████████████████████████████████                   | 7183/9741 [00:26<00:08, 285.45it/s] 74%|█████████████████████████████████████████████████████▎                  | 7212/9741 [00:26<00:08, 284.15it/s] 74%|█████████████████████████████████████████████████████▌                  | 7241/9741 [00:26<00:08, 285.29it/s] 75%|█████████████████████████████████████████████████████▋                  | 7270/9741 [00:26<00:08, 286.01it/s] 75%|█████████████████████████████████████████████████████▉                  | 7299/9741 [00:26<00:08, 286.27it/s] 75%|██████████████████████████████████████████████████████▏                 | 7328/9741 [00:27<00:08, 286.09it/s] 76%|██████████████████████████████████████████████████████▍                 | 7357/9741 [00:27<00:08, 286.45it/s] 76%|██████████████████████████████████████████████████████▌                 | 7386/9741 [00:27<00:08, 286.98it/s] 76%|██████████████████████████████████████████████████████▊                 | 7415/9741 [00:27<00:08, 287.39it/s] 76%|███████████████████████████████████████████████████████                 | 7444/9741 [00:27<00:08, 263.37it/s] 77%|███████████████████████████████████████████████████████▏                | 7473/9741 [00:27<00:08, 270.13it/s] 77%|███████████████████████████████████████████████████████▍                | 7502/9741 [00:27<00:08, 275.12it/s] 77%|███████████████████████████████████████████████████████▋                | 7531/9741 [00:27<00:07, 278.52it/s] 78%|███████████████████████████████████████████████████████▉                | 7560/9741 [00:27<00:07, 281.28it/s] 78%|████████████████████████████████████████████████████████                | 7589/9741 [00:27<00:07, 283.19it/s] 78%|████████████████████████████████████████████████████████▎               | 7618/9741 [00:28<00:07, 281.44it/s] 79%|████████████████████████████████████████████████████████▌               | 7647/9741 [00:28<00:07, 282.43it/s] 79%|████████████████████████████████████████████████████████▋               | 7676/9741 [00:28<00:07, 281.88it/s] 79%|████████████████████████████████████████████████████████▉               | 7705/9741 [00:28<00:07, 283.45it/s] 79%|█████████████████████████████████████████████████████████▏              | 7734/9741 [00:28<00:07, 284.91it/s] 80%|█████████████████████████████████████████████████████████▍              | 7763/9741 [00:28<00:06, 285.70it/s] 80%|█████████████████████████████████████████████████████████▌              | 7792/9741 [00:28<00:06, 286.34it/s] 80%|█████████████████████████████████████████████████████████▊              | 7821/9741 [00:28<00:06, 286.78it/s] 81%|██████████████████████████████████████████████████████████              | 7850/9741 [00:28<00:06, 287.19it/s] 81%|██████████████████████████████████████████████████████████▏             | 7879/9741 [00:28<00:06, 287.36it/s] 81%|██████████████████████████████████████████████████████████▍             | 7908/9741 [00:29<00:06, 285.76it/s] 81%|██████████████████████████████████████████████████████████▋             | 7937/9741 [00:29<00:06, 285.93it/s] 82%|██████████████████████████████████████████████████████████▉             | 7966/9741 [00:29<00:06, 286.20it/s] 82%|███████████████████████████████████████████████████████████             | 7995/9741 [00:29<00:06, 286.63it/s] 82%|███████████████████████████████████████████████████████████▎            | 8024/9741 [00:29<00:05, 287.11it/s] 83%|███████████████████████████████████████████████████████████▌            | 8053/9741 [00:29<00:05, 287.00it/s] 83%|███████████████████████████████████████████████████████████▋            | 8082/9741 [00:29<00:05, 287.37it/s] 83%|███████████████████████████████████████████████████████████▉            | 8111/9741 [00:29<00:05, 285.49it/s] 84%|████████████████████████████████████████████████████████████▏           | 8140/9741 [00:29<00:05, 282.53it/s] 84%|████████████████████████████████████████████████████████████▍           | 8169/9741 [00:30<00:05, 284.14it/s] 84%|████████████████████████████████████████████████████████████▌           | 8198/9741 [00:30<00:05, 284.94it/s] 84%|████████████████████████████████████████████████████████████▊           | 8227/9741 [00:30<00:05, 285.52it/s] 85%|█████████████████████████████████████████████████████████████           | 8256/9741 [00:30<00:05, 284.64it/s] 85%|█████████████████████████████████████████████████████████████▏          | 8285/9741 [00:30<00:05, 284.90it/s] 85%|█████████████████████████████████████████████████████████████▍          | 8314/9741 [00:30<00:04, 285.62it/s] 86%|█████████████████████████████████████████████████████████████▋          | 8343/9741 [00:30<00:04, 286.42it/s] 86%|█████████████████████████████████████████████████████████████▉          | 8372/9741 [00:30<00:04, 284.95it/s] 86%|██████████████████████████████████████████████████████████████          | 8401/9741 [00:30<00:04, 285.69it/s] 87%|██████████████████████████████████████████████████████████████▎         | 8430/9741 [00:30<00:04, 286.59it/s] 87%|██████████████████████████████████████████████████████████████▌         | 8459/9741 [00:31<00:04, 287.09it/s] 87%|██████████████████████████████████████████████████████████████▋         | 8488/9741 [00:31<00:04, 287.28it/s] 87%|██████████████████████████████████████████████████████████████▉         | 8517/9741 [00:31<00:04, 287.57it/s] 88%|███████████████████████████████████████████████████████████████▏        | 8546/9741 [00:31<00:04, 286.81it/s] 88%|███████████████████████████████████████████████████████████████▍        | 8575/9741 [00:31<00:04, 284.51it/s] 88%|███████████████████████████████████████████████████████████████▌        | 8604/9741 [00:31<00:04, 283.05it/s] 89%|███████████████████████████████████████████████████████████████▊        | 8633/9741 [00:31<00:03, 284.21it/s] 89%|████████████████████████████████████████████████████████████████        | 8662/9741 [00:31<00:03, 285.23it/s] 89%|████████████████████████████████████████████████████████████████▏       | 8691/9741 [00:31<00:03, 285.87it/s] 90%|████████████████████████████████████████████████████████████████▍       | 8720/9741 [00:31<00:03, 286.41it/s] 90%|████████████████████████████████████████████████████████████████▋       | 8749/9741 [00:32<00:03, 286.70it/s] 90%|████████████████████████████████████████████████████████████████▉       | 8778/9741 [00:32<00:03, 286.35it/s] 90%|█████████████████████████████████████████████████████████████████       | 8807/9741 [00:32<00:03, 284.76it/s] 91%|█████████████████████████████████████████████████████████████████▎      | 8836/9741 [00:32<00:03, 285.34it/s] 91%|█████████████████████████████████████████████████████████████████▌      | 8865/9741 [00:32<00:03, 285.74it/s] 91%|█████████████████████████████████████████████████████████████████▋      | 8894/9741 [00:32<00:02, 286.02it/s] 92%|█████████████████████████████████████████████████████████████████▉      | 8923/9741 [00:32<00:02, 274.85it/s] 92%|██████████████████████████████████████████████████████████████████▏     | 8952/9741 [00:32<00:02, 278.81it/s] 92%|██████████████████████████████████████████████████████████████████▍     | 8981/9741 [00:32<00:02, 281.31it/s] 92%|██████████████████████████████████████████████████████████████████▌     | 9010/9741 [00:32<00:02, 283.12it/s] 93%|██████████████████████████████████████████████████████████████████▊     | 9039/9741 [00:33<00:02, 282.57it/s] 93%|███████████████████████████████████████████████████████████████████     | 9068/9741 [00:33<00:02, 284.17it/s] 93%|███████████████████████████████████████████████████████████████████▏    | 9097/9741 [00:33<00:02, 283.34it/s] 94%|███████████████████████████████████████████████████████████████████▍    | 9126/9741 [00:33<00:02, 284.49it/s] 94%|███████████████████████████████████████████████████████████████████▋    | 9155/9741 [00:33<00:02, 285.47it/s] 94%|███████████████████████████████████████████████████████████████████▉    | 9184/9741 [00:33<00:01, 285.82it/s] 95%|████████████████████████████████████████████████████████████████████    | 9213/9741 [00:33<00:01, 285.52it/s] 95%|████████████████████████████████████████████████████████████████████▎   | 9242/9741 [00:33<00:01, 286.22it/s] 95%|████████████████████████████████████████████████████████████████████▌   | 9271/9741 [00:33<00:01, 284.77it/s] 95%|████████████████████████████████████████████████████████████████████▋   | 9300/9741 [00:33<00:01, 285.46it/s] 96%|████████████████████████████████████████████████████████████████████▉   | 9329/9741 [00:34<00:01, 286.15it/s] 96%|█████████████████████████████████████████████████████████████████████▏  | 9358/9741 [00:34<00:01, 286.22it/s] 96%|█████████████████████████████████████████████████████████████████████▍  | 9387/9741 [00:34<00:01, 286.76it/s] 97%|█████████████████████████████████████████████████████████████████████▌  | 9416/9741 [00:34<00:01, 286.86it/s] 97%|█████████████████████████████████████████████████████████████████████▊  | 9445/9741 [00:34<00:01, 287.00it/s] 97%|██████████████████████████████████████████████████████████████████████  | 9474/9741 [00:34<00:00, 286.94it/s] 98%|██████████████████████████████████████████████████████████████████████▏ | 9503/9741 [00:34<00:00, 284.15it/s] 98%|██████████████████████████████████████████████████████████████████████▍ | 9532/9741 [00:34<00:00, 285.18it/s] 98%|██████████████████████████████████████████████████████████████████████▋ | 9561/9741 [00:34<00:00, 285.77it/s] 98%|██████████████████████████████████████████████████████████████████████▉ | 9590/9741 [00:34<00:00, 286.05it/s] 99%|███████████████████████████████████████████████████████████████████████ | 9619/9741 [00:35<00:00, 286.57it/s] 99%|███████████████████████████████████████████████████████████████████████▎| 9648/9741 [00:35<00:00, 286.71it/s] 99%|███████████████████████████████████████████████████████████████████████▌| 9677/9741 [00:35<00:00, 285.70it/s]100%|███████████████████████████████████████████████████████████████████████▋| 9706/9741 [00:35<00:00, 286.22it/s]100%|███████████████████████████████████████████████████████████████████████▉| 9735/9741 [00:35<00:00, 284.62it/s]100%|████████████████████████████████████████████████████████████████████████| 9741/9741 [00:35<00:00, 274.18it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:04<00:09,  4.93s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.36s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.44s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.47s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:09<00:04,  4.82s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.26s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.40s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.35s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.23s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.40s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.66s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.83s/it]
[2023-08-14 07:04:46,576] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.81s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.97s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.73s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.91s/it]
[2023-08-14 07:04:58,448] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-14 07:04:58,449] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-14 07:04:58,450] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-14 07:04:58,450] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-14 07:04:58,450] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-14 07:04:58,450] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-14 07:04:58,451] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-14 07:04:58,451] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-14 07:04:58,451] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-14 07:04:58,451] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-14 07:04:58,451] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-14 07:04:58,451] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fd300cc8fd0>
[2023-08-14 07:04:58,451] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-14 07:04:58,451] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-14 07:04:58,451] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-14 07:04:58,451] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-14 07:04:58,451] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-14 07:04:58,451] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-14 07:04:58,451] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-14 07:04:58,451] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-14 07:04:58,451] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-14 07:04:58,451] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-14 07:04:58,451] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-14 07:04:58,451] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-14 07:04:58,451] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-14 07:04:58,451] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-14 07:04:58,451] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-14 07:04:58,451] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-14 07:04:58,451] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-14 07:04:58,451] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-14 07:04:58,451] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-14 07:04:58,451] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-14 07:04:58,451] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-14 07:04:58,451] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-14 07:04:58,451] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-14 07:04:58,451] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-14 07:04:58,452] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-14 07:04:58,452] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-14 07:04:58,452] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-14 07:04:58,452] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-14 07:04:58,452] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-14 07:04:58,452] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-14 07:04:58,452] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-14 07:04:58,452] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-14 07:04:58,452] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7fd30101bcd0>
[2023-08-14 07:04:58,452] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-14 07:04:58,452] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-14 07:04:58,452] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-14 07:04:58,452] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-14 07:04:58,452] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-14 07:04:58,452] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-14 07:04:58,452] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-14 07:04:58,452] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-14 07:04:58,452] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-14 07:04:58,452] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-14 07:04:58,452] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-14 07:04:58,452] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-14 07:04:58,452] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-14 07:04:58,452] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-14 07:04:58,452] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-14 07:04:58,452] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-14 07:04:58,452] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-14 07:04:58,452] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-14 07:04:58,452] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-14 07:04:58,452] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-14 07:04:58,452] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-14 07:04:58,452] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-14 07:04:58,453] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.5305447578430176 seconds
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.5046162605285645 seconds
Time to load utils op: 0.5048983097076416 seconds
Loading extension module utils...
Time to load utils op: 0.604956865310669 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                                           | 0/50 [00:00<?, ?it/s]############### Example ###############
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following multiple choice question.

### Demonstration:
Input: Mary had 89 stickers.  She used 3 large stickers on the front page of her journal and 7 stickers each to 6 other pages of her journal. How many stickers does Mary have remaining?
Answer: 44

Input: Zach is saving his money to buy a brand new bike that costs $100.  His weekly allowance is $5.  His parent will pay him an extra $10 to mow the lawn.  His neighbor will pay him $7 per hour to babysit their son.  He has already saved up $65.  He'll receive his allowance on Friday and he's planning on babysitting for 2 hours this Saturday after he mows the lawn.  How much more money does Zach need to earn before he can buy the bike?
Answer: 6

Input: Mark has kangaroos and goats.  Kangaroos have two legs and goats have four legs.  If he has 23 kangaroos and three times as many goats as kangaroos what is the total number of legs of all his animals?
Answer: 322

Input: Josh’s mom gives him $20 to go shopping at the mall. He buys a hat for $10 and a pencil for $2. Then he buys four cookies. If each cookie costs $1.25, how much money does Josh have left?
Answer: 3

Input: George's bowling team is one round away from breaking the league record for most points scored in a season. The old record is an average score per player of 287 per round. Each team has 4 players and there are 10 rounds in the season. Through the first 9 rounds, his team has scored a total of 10,440. How many points less than the current league record per game average is the minimum average they need to score, per player, in the final round to tie the league record?
Answer: 27

Input: Max was doing homework in three different subjects. It took him 20 minutes to finish tasks from biology and two times more time to finish history. Geography took him the most time, three times more than history. How much time did Max spend on doing his homework?
Answer: 180

Input: Sophia ate 1/6 of her pie and she put the rest on the fridge. If the pie left in the fridge weighs 1200 grams, how many grams did Sophia eat?
Answer: 240

Input: Sarah, Mary, and Tuan decided to go to the restaurant for a meal. They decided to split the cost of the meal evenly. If the total price of the meal comes to $67 and they have a coupon for $4, how much does each person need to contribute to the bill?
Answer: 21

Input: Tom's brother is 4 times as old as Tom's dog. If in 6 years, Tom's brother will be 30 years, how old is Tom's dog going to be in six years?
Answer: 12

Input: There are 50 children at the party. Three-fifths of them are boys. How many of the children are girls?
Answer: 20

Input: Gail has some bills in her wallet which amount to $100. She has four $5 bills and three $20 bills, and the rest are $10 bills. How many $10 bills are in her wallet?
Answer: 2

Input: A 220-liter barrel has a small leak. It lost 10% of its contents before anyone noticed. How many liters are left in the barrel?
Answer: 198

Input: Markese earned 5 fewer dollars than Evan. Together they earned $37. How many dollars did Markese earn? Use E to represent how many dollars Evan earned.
Answer: 16

Input: Lou Senior took 3 cookies out of the cookie jar and ate them.  Since he didn't get caught by his wife, he went back the next day and took another 3 cookies out of the jar.  But after eating just one of the cookies, he felt guilty about it and put the other two cookies back.  His son, Louie Junior saw that his Dad was eating cookies.  So, Louie Junior took seven cookies out of the jar and hid them in his bedroom for later.  The next morning, Debra, Lou's wife looked into the cookie jar and reacted by accusing her husband of eating half of the cookies out of the cookie jar.  How many cookies remained in the jar?
Answer: 11

Input: John had $200. He gave 3/8 of his money to his mother and 3/10 to his father. How much money did John have left?
Answer: 65

Input: Tonya has $150.00 on her credit card.  If she leaves any balance on her card at the end of the month, she is charged 20% interest.  If she makes a $50.00 payment on her card, what will be the new balance?
Answer: 120

Input: In her first term, Governor Sandoval gave twice as many commencement addresses as Governor Hawkins. Governor Sloan gave ten more commencement addresses than Governor Sandoval in the same amount of time. If Governor Sandoval gave 12 commencement addresses, how many commencement addresses did the three of them give altogether?
Answer: 40

Input: If Buzz bought a pizza with 78 slices at a restaurant and then decided to share it with the waiter in the ratio of 5:8, with Buzz's ratio being 5, what's twenty less the number of slices of pizza that the waiter ate?
Answer: 28

Input: Jolene and Phil have four children, each with the same birthday.  They gave birth to their first child exactly 15 years ago.  They gave birth to their second child exactly one year after the birth of their first child.  They gave birth to their third child on the fourth birthday of their second child. Two years after the birth of their third child, they gave birth to their fourth child.  How old, in years, is their fourth child?
Answer: 8

Input: Each purple book has 230 pages. Each orange book contains 510 pages. Mirella read 5 purple books and 4 orange books. How many more orange pages did she read than purple pages?
Answer: 890

Input: Isabella has $45 more than Sam but only $15 more than Giselle. If Giselle has $120, calculate the total amount of money each shopper will receive if Isabella, Sam, and Giselle donate the money to three shoppers at their local town's supermarket who then decides to share it equally.
Answer: 115

Input: It takes 40 minutes to freeze ice cubes and 3 minutes per smoothie to turn them into smoothies once they're frozen. How long does it take to make 5 smoothies?
Answer: 55

### Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid

### Response:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o22-tgsm8k-s1-rFalse
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Evaluating commonsenseqa :   0%|                                                           | 0/50 [00:05<?, ?it/s]
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 4118001) of binary: /home/ylu130/.conda/envs/distllm/bin/python
Traceback (most recent call last):
  File "/home/ylu130/.conda/envs/distllm/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 345, in wrapper
    return f(*args, **kwargs)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 761, in main
    run(args)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 752, in run
    elastic_launch(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 131, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 245, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
/home/ylu130/workspace/in-context-generalization/inference.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2023-08-14_07:05:06
  host      : ia1.wse.jhu.edu
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 4118002)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2023-08-14_07:05:06
  host      : ia1.wse.jhu.edu
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 4118003)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2023-08-14_07:05:06
  host      : ia1.wse.jhu.edu
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 4118004)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2023-08-14_07:05:06
  host      : ia1.wse.jhu.edu
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 4118001)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name gsm8k --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/out-domain/o23-tgsm8k-s1-rFalse --seed 1 --num-out-domain 23
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date![nltk_data]   Package punkt is already up-to-date!

[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-14 07:05:10,413] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/out-domain/o23-tgsm8k-s1-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 23
  out_domain_data_name ......... gsm8k
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o23-tgsm8k-s1-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                    | 0/9741 [00:00<?, ?it/s]  0%|▏                                                                         | 27/9741 [00:00<00:36, 268.50it/s]  1%|▍                                                                         | 54/9741 [00:00<00:36, 268.97it/s]  1%|▌                                                                         | 81/9741 [00:00<00:35, 269.04it/s]  1%|▊                                                                        | 109/9741 [00:00<00:35, 269.52it/s]  1%|█                                                                        | 136/9741 [00:00<00:35, 269.46it/s]  2%|█▏                                                                       | 163/9741 [00:00<00:35, 269.32it/s]  2%|█▍                                                                       | 190/9741 [00:00<00:35, 268.74it/s]  2%|█▋                                                                       | 217/9741 [00:00<00:36, 264.40it/s]  3%|█▊                                                                       | 244/9741 [00:00<00:35, 265.45it/s]  3%|██                                                                       | 271/9741 [00:01<00:35, 266.46it/s]  3%|██▏                                                                      | 298/9741 [00:01<00:35, 267.23it/s]  3%|██▍                                                                      | 325/9741 [00:01<00:35, 267.59it/s]  4%|██▋                                                                      | 352/9741 [00:01<00:35, 267.92it/s]  4%|██▊                                                                      | 379/9741 [00:01<00:34, 268.34it/s]  4%|███                                                                      | 406/9741 [00:01<00:34, 268.52it/s]  4%|███▏                                                                     | 433/9741 [00:01<00:34, 266.77it/s]  5%|███▍                                                                     | 460/9741 [00:01<00:34, 267.58it/s]  5%|███▋                                                                     | 487/9741 [00:01<00:34, 265.43it/s]  5%|███▊                                                                     | 514/9741 [00:01<00:34, 266.34it/s]  6%|████                                                                     | 541/9741 [00:02<00:34, 267.00it/s]  6%|████▎                                                                    | 568/9741 [00:02<00:34, 267.29it/s]  6%|████▍                                                                    | 595/9741 [00:02<00:34, 267.61it/s]  6%|████▋                                                                    | 622/9741 [00:02<00:34, 267.72it/s]  7%|████▊                                                                    | 649/9741 [00:02<00:33, 268.01it/s]  7%|█████                                                                    | 676/9741 [00:02<00:34, 265.88it/s]  7%|█████▎                                                                   | 703/9741 [00:02<00:33, 266.65it/s]  7%|█████▍                                                                   | 730/9741 [00:02<00:33, 266.99it/s]  8%|█████▋                                                                   | 757/9741 [00:02<00:33, 266.64it/s]  8%|█████▉                                                                   | 784/9741 [00:02<00:33, 267.09it/s]  8%|██████                                                                   | 811/9741 [00:03<00:33, 267.26it/s]  9%|██████▎                                                                  | 838/9741 [00:03<00:33, 267.36it/s]  9%|██████▍                                                                  | 865/9741 [00:03<00:33, 267.48it/s]  9%|██████▋                                                                  | 892/9741 [00:03<00:33, 265.70it/s]  9%|██████▉                                                                  | 919/9741 [00:03<00:33, 266.24it/s] 10%|███████                                                                  | 946/9741 [00:03<00:32, 266.57it/s] 10%|███████▎                                                                 | 973/9741 [00:03<00:32, 266.71it/s] 10%|███████▍                                                                | 1000/9741 [00:03<00:32, 266.84it/s] 11%|███████▌                                                                | 1027/9741 [00:03<00:32, 267.11it/s] 11%|███████▊                                                                | 1054/9741 [00:03<00:32, 267.37it/s] 11%|███████▉                                                                | 1081/9741 [00:04<00:32, 267.55it/s] 11%|████████▏                                                               | 1108/9741 [00:04<00:32, 265.35it/s] 12%|████████▍                                                               | 1135/9741 [00:04<00:32, 265.86it/s] 12%|████████▌                                                               | 1162/9741 [00:04<00:32, 265.99it/s] 12%|████████▊                                                               | 1189/9741 [00:04<00:32, 266.20it/s] 12%|████████▉                                                               | 1216/9741 [00:04<00:32, 265.99it/s] 13%|█████████▏                                                              | 1243/9741 [00:04<00:31, 265.97it/s] 13%|█████████▍                                                              | 1270/9741 [00:04<00:31, 266.15it/s] 13%|█████████▌                                                              | 1297/9741 [00:04<00:31, 266.32it/s] 14%|█████████▊                                                              | 1324/9741 [00:04<00:31, 266.25it/s] 14%|█████████▉                                                              | 1351/9741 [00:05<00:31, 264.34it/s] 14%|██████████▏                                                             | 1378/9741 [00:05<00:31, 264.61it/s] 14%|██████████▍                                                             | 1405/9741 [00:05<00:31, 264.78it/s] 15%|██████████▌                                                             | 1432/9741 [00:05<00:31, 264.95it/s] 15%|██████████▊                                                             | 1459/9741 [00:05<00:31, 264.95it/s] 15%|██████████▉                                                             | 1486/9741 [00:05<00:31, 265.09it/s] 16%|███████████▏                                                            | 1513/9741 [00:05<00:31, 265.12it/s] 16%|███████████▍                                                            | 1540/9741 [00:05<00:30, 265.27it/s] 16%|███████████▌                                                            | 1567/9741 [00:05<00:31, 263.61it/s] 16%|███████████▊                                                            | 1594/9741 [00:05<00:30, 263.91it/s] 17%|███████████▉                                                            | 1621/9741 [00:06<00:30, 264.69it/s] 17%|████████████▏                                                           | 1648/9741 [00:06<00:30, 264.73it/s] 17%|████████████▍                                                           | 1675/9741 [00:06<00:30, 265.31it/s] 17%|████████████▌                                                           | 1702/9741 [00:06<00:30, 265.79it/s] 18%|████████████▊                                                           | 1729/9741 [00:06<00:30, 266.03it/s] 18%|████████████▉                                                           | 1756/9741 [00:06<00:29, 266.24it/s] 18%|█████████████▏                                                          | 1783/9741 [00:06<00:29, 266.32it/s] 19%|█████████████▍                                                          | 1810/9741 [00:06<00:32, 246.72it/s] 19%|█████████████▌                                                          | 1837/9741 [00:06<00:31, 252.14it/s] 19%|█████████████▊                                                          | 1864/9741 [00:07<00:30, 256.20it/s] 19%|█████████████▉                                                          | 1891/9741 [00:07<00:30, 259.07it/s] 20%|██████████████▏                                                         | 1918/9741 [00:07<00:29, 261.02it/s] 20%|██████████████▍                                                         | 1945/9741 [00:07<00:29, 262.55it/s] 20%|██████████████▌                                                         | 1972/9741 [00:07<00:29, 263.64it/s] 21%|██████████████▊                                                         | 1999/9741 [00:07<00:29, 264.56it/s] 21%|██████████████▉                                                         | 2026/9741 [00:07<00:29, 263.18it/s] 21%|███████████████▏                                                        | 2053/9741 [00:07<00:29, 263.86it/s] 21%|███████████████▎                                                        | 2080/9741 [00:07<00:28, 264.38it/s] 22%|███████████████▌                                                        | 2107/9741 [00:07<00:28, 264.61it/s] 22%|███████████████▊                                                        | 2134/9741 [00:08<00:28, 263.97it/s] 22%|███████████████▉                                                        | 2161/9741 [00:08<00:28, 264.61it/s] 22%|████████████████▏                                                       | 2188/9741 [00:08<00:28, 265.16it/s] 23%|████████████████▎                                                       | 2215/9741 [00:08<00:28, 265.32it/s] 23%|████████████████▌                                                       | 2242/9741 [00:08<00:28, 265.65it/s] 23%|████████████████▊                                                       | 2269/9741 [00:08<00:28, 263.81it/s] 24%|████████████████▉                                                       | 2296/9741 [00:08<00:28, 264.55it/s] 24%|█████████████████▏                                                      | 2323/9741 [00:08<00:28, 264.93it/s] 24%|█████████████████▎                                                      | 2350/9741 [00:08<00:27, 265.35it/s] 24%|█████████████████▌                                                      | 2377/9741 [00:08<00:27, 265.61it/s] 25%|█████████████████▊                                                      | 2404/9741 [00:09<00:27, 265.90it/s] 25%|█████████████████▉                                                      | 2431/9741 [00:09<00:27, 266.03it/s] 25%|██████████████████▏                                                     | 2458/9741 [00:09<00:27, 265.81it/s] 26%|██████████████████▎                                                     | 2485/9741 [00:09<00:27, 261.74it/s] 26%|██████████████████▌                                                     | 2512/9741 [00:09<00:27, 262.91it/s] 26%|██████████████████▊                                                     | 2539/9741 [00:09<00:27, 263.47it/s] 26%|██████████████████▉                                                     | 2566/9741 [00:09<00:27, 264.16it/s] 27%|███████████████████▏                                                    | 2593/9741 [00:09<00:26, 264.91it/s] 27%|███████████████████▎                                                    | 2620/9741 [00:09<00:26, 265.28it/s] 27%|███████████████████▌                                                    | 2647/9741 [00:09<00:26, 265.27it/s] 27%|███████████████████▊                                                    | 2674/9741 [00:10<00:26, 265.60it/s] 28%|███████████████████▉                                                    | 2701/9741 [00:10<00:26, 263.58it/s] 28%|████████████████████▏                                                   | 2728/9741 [00:10<00:26, 264.06it/s] 28%|████████████████████▎                                                   | 2755/9741 [00:10<00:26, 264.54it/s] 29%|████████████████████▌                                                   | 2782/9741 [00:10<00:26, 264.66it/s] 29%|████████████████████▊                                                   | 2809/9741 [00:10<00:26, 264.90it/s] 29%|████████████████████▉                                                   | 2836/9741 [00:10<00:26, 265.24it/s] 29%|█████████████████████▏                                                  | 2863/9741 [00:10<00:25, 265.55it/s] 30%|█████████████████████▎                                                  | 2890/9741 [00:10<00:25, 265.70it/s] 30%|█████████████████████▌                                                  | 2917/9741 [00:10<00:25, 265.74it/s] 30%|█████████████████████▊                                                  | 2944/9741 [00:11<00:25, 263.83it/s] 30%|█████████████████████▉                                                  | 2971/9741 [00:11<00:25, 264.45it/s] 31%|██████████████████████▏                                                 | 2998/9741 [00:11<00:25, 264.83it/s] 31%|██████████████████████▎                                                 | 3025/9741 [00:11<00:25, 264.98it/s] 31%|██████████████████████▌                                                 | 3052/9741 [00:11<00:25, 264.85it/s] 32%|██████████████████████▊                                                 | 3079/9741 [00:11<00:25, 265.02it/s] 32%|██████████████████████▉                                                 | 3106/9741 [00:11<00:25, 265.35it/s] 32%|███████████████████████▏                                                | 3133/9741 [00:11<00:24, 265.46it/s] 32%|███████████████████████▎                                                | 3160/9741 [00:11<00:24, 263.56it/s] 33%|███████████████████████▌                                                | 3187/9741 [00:12<00:24, 264.50it/s] 33%|███████████████████████▊                                                | 3214/9741 [00:12<00:24, 264.69it/s] 33%|███████████████████████▉                                                | 3241/9741 [00:12<00:24, 265.14it/s] 34%|████████████████████████▏                                               | 3268/9741 [00:12<00:24, 265.36it/s] 34%|████████████████████████▎                                               | 3295/9741 [00:12<00:24, 265.42it/s] 34%|████████████████████████▌                                               | 3322/9741 [00:12<00:24, 265.41it/s] 34%|████████████████████████▊                                               | 3349/9741 [00:12<00:24, 265.48it/s] 35%|████████████████████████▉                                               | 3376/9741 [00:12<00:23, 265.39it/s] 35%|█████████████████████████▏                                              | 3403/9741 [00:12<00:24, 263.59it/s] 35%|█████████████████████████▎                                              | 3430/9741 [00:12<00:23, 264.26it/s] 35%|█████████████████████████▌                                              | 3457/9741 [00:13<00:23, 264.47it/s] 36%|█████████████████████████▊                                              | 3484/9741 [00:13<00:23, 264.68it/s] 36%|█████████████████████████▉                                              | 3511/9741 [00:13<00:23, 262.73it/s] 36%|██████████████████████████▏                                             | 3538/9741 [00:13<00:23, 263.55it/s] 37%|██████████████████████████▎                                             | 3565/9741 [00:13<00:23, 263.88it/s] 37%|██████████████████████████▌                                             | 3592/9741 [00:13<00:23, 264.19it/s] 37%|██████████████████████████▋                                             | 3619/9741 [00:13<00:23, 262.63it/s] 37%|██████████████████████████▉                                             | 3646/9741 [00:13<00:23, 263.49it/s] 38%|███████████████████████████▏                                            | 3673/9741 [00:13<00:23, 263.82it/s] 38%|███████████████████████████▎                                            | 3700/9741 [00:13<00:22, 264.50it/s] 38%|███████████████████████████▌                                            | 3727/9741 [00:14<00:22, 264.92it/s] 39%|███████████████████████████▋                                            | 3754/9741 [00:14<00:22, 264.97it/s] 39%|███████████████████████████▉                                            | 3781/9741 [00:14<00:22, 264.94it/s] 39%|████████████████████████████▏                                           | 3808/9741 [00:14<00:22, 264.89it/s] 39%|████████████████████████████▎                                           | 3835/9741 [00:14<00:22, 263.30it/s] 40%|████████████████████████████▌                                           | 3862/9741 [00:14<00:22, 262.09it/s] 40%|████████████████████████████▋                                           | 3889/9741 [00:14<00:22, 263.08it/s] 40%|████████████████████████████▉                                           | 3916/9741 [00:14<00:22, 263.75it/s] 40%|█████████████████████████████▏                                          | 3943/9741 [00:14<00:21, 264.24it/s] 41%|█████████████████████████████▎                                          | 3970/9741 [00:14<00:21, 264.56it/s] 41%|█████████████████████████████▌                                          | 3997/9741 [00:15<00:21, 264.84it/s] 41%|█████████████████████████████▋                                          | 4024/9741 [00:15<00:21, 265.12it/s] 42%|█████████████████████████████▉                                          | 4051/9741 [00:15<00:21, 265.12it/s] 42%|██████████████████████████████▏                                         | 4078/9741 [00:15<00:21, 264.39it/s] 42%|██████████████████████████████▎                                         | 4105/9741 [00:15<00:21, 265.61it/s] 42%|██████████████████████████████▌                                         | 4132/9741 [00:15<00:21, 266.49it/s] 43%|██████████████████████████████▋                                         | 4159/9741 [00:15<00:20, 267.05it/s] 43%|██████████████████████████████▉                                         | 4186/9741 [00:15<00:20, 267.49it/s] 43%|███████████████████████████████▏                                        | 4213/9741 [00:15<00:20, 265.98it/s] 44%|███████████████████████████████▎                                        | 4240/9741 [00:15<00:20, 266.65it/s] 44%|███████████████████████████████▌                                        | 4267/9741 [00:16<00:20, 267.39it/s] 44%|███████████████████████████████▋                                        | 4294/9741 [00:16<00:20, 264.70it/s] 44%|███████████████████████████████▉                                        | 4321/9741 [00:16<00:20, 265.87it/s] 45%|████████████████████████████████▏                                       | 4348/9741 [00:16<00:20, 266.66it/s] 45%|████████████████████████████████▎                                       | 4375/9741 [00:16<00:20, 267.13it/s] 45%|████████████████████████████████▌                                       | 4402/9741 [00:16<00:19, 267.39it/s] 45%|████████████████████████████████▋                                       | 4429/9741 [00:16<00:19, 267.51it/s] 46%|████████████████████████████████▉                                       | 4456/9741 [00:16<00:19, 267.79it/s] 46%|█████████████████████████████████▏                                      | 4483/9741 [00:16<00:19, 267.93it/s] 46%|█████████████████████████████████▎                                      | 4510/9741 [00:17<00:19, 267.98it/s] 47%|█████████████████████████████████▌                                      | 4537/9741 [00:17<00:21, 238.75it/s] 47%|█████████████████████████████████▋                                      | 4564/9741 [00:17<00:21, 245.18it/s] 47%|█████████████████████████████████▉                                      | 4591/9741 [00:17<00:20, 251.74it/s] 47%|██████████████████████████████████▏                                     | 4618/9741 [00:17<00:19, 256.52it/s] 48%|██████████████████████████████████▎                                     | 4645/9741 [00:17<00:19, 260.01it/s] 48%|██████████████████████████████████▌                                     | 4672/9741 [00:17<00:19, 262.52it/s] 48%|██████████████████████████████████▋                                     | 4699/9741 [00:17<00:19, 264.48it/s] 49%|██████████████████████████████████▉                                     | 4726/9741 [00:17<00:18, 265.80it/s] 49%|███████████████████████████████████▏                                    | 4753/9741 [00:18<00:26, 186.73it/s] 49%|███████████████████████████████████▎                                    | 4780/9741 [00:18<00:24, 205.50it/s] 49%|███████████████████████████████████▌                                    | 4807/9741 [00:18<00:22, 221.00it/s] 50%|███████████████████████████████████▋                                    | 4834/9741 [00:18<00:21, 233.01it/s] 50%|███████████████████████████████████▉                                    | 4861/9741 [00:18<00:20, 241.67it/s] 50%|████████████████████████████████████▏                                   | 4888/9741 [00:18<00:19, 248.68it/s] 50%|████████████████████████████████████▎                                   | 4915/9741 [00:18<00:18, 254.10it/s] 51%|████████████████████████████████████▌                                   | 4942/9741 [00:18<00:18, 258.09it/s] 51%|████████████████████████████████████▋                                   | 4969/9741 [00:18<00:18, 258.99it/s] 51%|████████████████████████████████████▉                                   | 4996/9741 [00:19<00:18, 261.44it/s] 52%|█████████████████████████████████████▏                                  | 5023/9741 [00:19<00:17, 263.21it/s] 52%|█████████████████████████████████████▎                                  | 5050/9741 [00:19<00:17, 264.55it/s] 52%|█████████████████████████████████████▌                                  | 5077/9741 [00:19<00:17, 264.92it/s] 52%|█████████████████████████████████████▋                                  | 5104/9741 [00:19<00:17, 265.57it/s] 53%|█████████████████████████████████████▉                                  | 5131/9741 [00:19<00:17, 266.03it/s] 53%|██████████████████████████████████████▏                                 | 5158/9741 [00:19<00:17, 266.58it/s] 53%|██████████████████████████████████████▎                                 | 5185/9741 [00:19<00:17, 264.74it/s] 54%|██████████████████████████████████████▌                                 | 5212/9741 [00:19<00:17, 265.66it/s] 54%|██████████████████████████████████████▋                                 | 5239/9741 [00:19<00:16, 266.09it/s] 54%|██████████████████████████████████████▉                                 | 5266/9741 [00:20<00:16, 266.48it/s] 54%|███████████████████████████████████████                                 | 5293/9741 [00:20<00:16, 266.86it/s] 55%|███████████████████████████████████████▎                                | 5320/9741 [00:20<00:16, 265.88it/s] 55%|███████████████████████████████████████▌                                | 5347/9741 [00:20<00:16, 266.27it/s] 55%|███████████████████████████████████████▋                                | 5374/9741 [00:20<00:16, 266.73it/s] 55%|███████████████████████████████████████▉                                | 5401/9741 [00:20<00:16, 264.95it/s] 56%|████████████████████████████████████████                                | 5428/9741 [00:20<00:16, 266.02it/s] 56%|████████████████████████████████████████▎                               | 5455/9741 [00:20<00:16, 266.73it/s] 56%|████████████████████████████████████████▌                               | 5483/9741 [00:20<00:15, 268.12it/s] 57%|████████████████████████████████████████▋                               | 5511/9741 [00:20<00:15, 270.35it/s] 57%|████████████████████████████████████████▉                               | 5539/9741 [00:21<00:15, 272.23it/s] 57%|█████████████████████████████████████████▏                              | 5567/9741 [00:21<00:15, 273.42it/s] 57%|█████████████████████████████████████████▎                              | 5595/9741 [00:21<00:15, 273.85it/s] 58%|█████████████████████████████████████████▌                              | 5623/9741 [00:21<00:15, 272.33it/s] 58%|█████████████████████████████████████████▊                              | 5651/9741 [00:21<00:14, 273.15it/s] 58%|█████████████████████████████████████████▉                              | 5679/9741 [00:21<00:14, 274.01it/s] 59%|██████████████████████████████████████████▏                             | 5707/9741 [00:21<00:14, 274.62it/s] 59%|██████████████████████████████████████████▍                             | 5735/9741 [00:21<00:14, 275.04it/s] 59%|██████████████████████████████████████████▌                             | 5763/9741 [00:21<00:14, 275.15it/s] 59%|██████████████████████████████████████████▊                             | 5791/9741 [00:21<00:14, 274.88it/s] 60%|███████████████████████████████████████████                             | 5819/9741 [00:22<00:14, 275.13it/s] 60%|███████████████████████████████████████████▏                            | 5847/9741 [00:22<00:14, 275.20it/s] 60%|███████████████████████████████████████████▍                            | 5875/9741 [00:22<00:14, 273.69it/s] 61%|███████████████████████████████████████████▋                            | 5903/9741 [00:22<00:13, 274.27it/s] 61%|███████████████████████████████████████████▊                            | 5931/9741 [00:22<00:13, 274.77it/s] 61%|████████████████████████████████████████████                            | 5959/9741 [00:22<00:13, 275.07it/s] 61%|████████████████████████████████████████████▎                           | 5987/9741 [00:22<00:13, 275.29it/s] 62%|████████████████████████████████████████████▍                           | 6015/9741 [00:22<00:13, 275.40it/s] 62%|████████████████████████████████████████████▋                           | 6043/9741 [00:22<00:13, 275.55it/s] 62%|████████████████████████████████████████████▊                           | 6071/9741 [00:22<00:13, 275.63it/s] 63%|█████████████████████████████████████████████                           | 6099/9741 [00:23<00:13, 273.91it/s] 63%|█████████████████████████████████████████████▎                          | 6127/9741 [00:23<00:13, 274.22it/s] 63%|█████████████████████████████████████████████▍                          | 6155/9741 [00:23<00:13, 274.61it/s] 63%|█████████████████████████████████████████████▋                          | 6183/9741 [00:23<00:12, 275.06it/s] 64%|█████████████████████████████████████████████▉                          | 6211/9741 [00:23<00:12, 275.27it/s] 64%|██████████████████████████████████████████████                          | 6239/9741 [00:23<00:12, 274.79it/s] 64%|██████████████████████████████████████████████▎                         | 6267/9741 [00:23<00:12, 274.72it/s] 65%|██████████████████████████████████████████████▌                         | 6295/9741 [00:23<00:12, 274.89it/s] 65%|██████████████████████████████████████████████▋                         | 6323/9741 [00:23<00:12, 272.99it/s] 65%|██████████████████████████████████████████████▉                         | 6351/9741 [00:23<00:12, 273.93it/s] 65%|███████████████████████████████████████████████▏                        | 6379/9741 [00:24<00:12, 274.50it/s] 66%|███████████████████████████████████████████████▎                        | 6407/9741 [00:24<00:12, 274.96it/s] 66%|███████████████████████████████████████████████▌                        | 6435/9741 [00:24<00:12, 275.18it/s] 66%|███████████████████████████████████████████████▊                        | 6463/9741 [00:24<00:11, 275.15it/s] 67%|███████████████████████████████████████████████▉                        | 6491/9741 [00:24<00:11, 275.39it/s] 67%|████████████████████████████████████████████████▏                       | 6519/9741 [00:24<00:11, 275.21it/s] 67%|████████████████████████████████████████████████▍                       | 6547/9741 [00:24<00:11, 273.78it/s] 67%|████████████████████████████████████████████████▌                       | 6575/9741 [00:24<00:11, 274.24it/s] 68%|████████████████████████████████████████████████▊                       | 6603/9741 [00:24<00:11, 274.51it/s] 68%|█████████████████████████████████████████████████                       | 6631/9741 [00:25<00:11, 274.90it/s] 68%|█████████████████████████████████████████████████▏                      | 6659/9741 [00:25<00:11, 275.34it/s] 69%|█████████████████████████████████████████████████▍                      | 6687/9741 [00:25<00:11, 275.41it/s] 69%|█████████████████████████████████████████████████▋                      | 6715/9741 [00:25<00:11, 275.03it/s] 69%|█████████████████████████████████████████████████▊                      | 6743/9741 [00:25<00:10, 275.38it/s] 70%|██████████████████████████████████████████████████                      | 6771/9741 [00:25<00:10, 273.54it/s] 70%|██████████████████████████████████████████████████▎                     | 6799/9741 [00:25<00:10, 274.15it/s] 70%|██████████████████████████████████████████████████▍                     | 6827/9741 [00:25<00:10, 274.53it/s] 70%|██████████████████████████████████████████████████▋                     | 6855/9741 [00:25<00:10, 274.78it/s] 71%|██████████████████████████████████████████████████▉                     | 6883/9741 [00:25<00:10, 275.11it/s] 71%|███████████████████████████████████████████████████                     | 6911/9741 [00:26<00:10, 275.26it/s] 71%|███████████████████████████████████████████████████▎                    | 6939/9741 [00:26<00:10, 275.39it/s] 72%|███████████████████████████████████████████████████▍                    | 6967/9741 [00:26<00:10, 275.53it/s] 72%|███████████████████████████████████████████████████▋                    | 6995/9741 [00:26<00:10, 273.90it/s] 72%|███████████████████████████████████████████████████▉                    | 7023/9741 [00:26<00:09, 274.36it/s] 72%|████████████████████████████████████████████████████                    | 7051/9741 [00:26<00:09, 274.94it/s] 73%|████████████████████████████████████████████████████▎                   | 7079/9741 [00:26<00:09, 275.30it/s] 73%|████████████████████████████████████████████████████▌                   | 7107/9741 [00:26<00:09, 275.57it/s] 73%|████████████████████████████████████████████████████▋                   | 7135/9741 [00:26<00:09, 275.75it/s] 74%|████████████████████████████████████████████████████▉                   | 7163/9741 [00:26<00:09, 275.68it/s] 74%|█████████████████████████████████████████████████████▏                  | 7191/9741 [00:27<00:09, 275.38it/s] 74%|█████████████████████████████████████████████████████▎                  | 7219/9741 [00:27<00:09, 273.65it/s] 74%|█████████████████████████████████████████████████████▌                  | 7247/9741 [00:27<00:09, 274.31it/s] 75%|█████████████████████████████████████████████████████▊                  | 7275/9741 [00:27<00:08, 274.61it/s] 75%|█████████████████████████████████████████████████████▉                  | 7303/9741 [00:27<00:08, 274.96it/s] 75%|██████████████████████████████████████████████████████▏                 | 7331/9741 [00:27<00:08, 275.21it/s] 76%|██████████████████████████████████████████████████████▍                 | 7359/9741 [00:27<00:08, 275.50it/s] 76%|██████████████████████████████████████████████████████▌                 | 7387/9741 [00:27<00:08, 275.68it/s] 76%|██████████████████████████████████████████████████████▊                 | 7415/9741 [00:27<00:08, 275.44it/s] 76%|███████████████████████████████████████████████████████                 | 7443/9741 [00:27<00:09, 251.75it/s] 77%|███████████████████████████████████████████████████████▏                | 7471/9741 [00:28<00:08, 258.39it/s] 77%|███████████████████████████████████████████████████████▍                | 7499/9741 [00:28<00:08, 263.36it/s] 77%|███████████████████████████████████████████████████████▋                | 7527/9741 [00:28<00:08, 266.69it/s] 78%|███████████████████████████████████████████████████████▊                | 7555/9741 [00:28<00:08, 269.04it/s] 78%|████████████████████████████████████████████████████████                | 7583/9741 [00:28<00:07, 270.77it/s] 78%|████████████████████████████████████████████████████████▎               | 7611/9741 [00:28<00:07, 272.19it/s] 78%|████████████████████████████████████████████████████████▍               | 7639/9741 [00:28<00:07, 272.40it/s] 79%|████████████████████████████████████████████████████████▋               | 7667/9741 [00:28<00:07, 271.45it/s] 79%|████████████████████████████████████████████████████████▉               | 7695/9741 [00:28<00:07, 272.56it/s] 79%|█████████████████████████████████████████████████████████               | 7723/9741 [00:29<00:07, 273.73it/s] 80%|█████████████████████████████████████████████████████████▎              | 7751/9741 [00:29<00:07, 273.93it/s] 80%|█████████████████████████████████████████████████████████▍              | 7779/9741 [00:29<00:07, 267.38it/s] 80%|█████████████████████████████████████████████████████████▋              | 7807/9741 [00:29<00:07, 269.93it/s] 80%|█████████████████████████████████████████████████████████▉              | 7835/9741 [00:29<00:07, 271.80it/s] 81%|██████████████████████████████████████████████████████████              | 7863/9741 [00:29<00:06, 273.06it/s] 81%|██████████████████████████████████████████████████████████▎             | 7891/9741 [00:29<00:06, 273.92it/s] 81%|██████████████████████████████████████████████████████████▌             | 7919/9741 [00:29<00:06, 272.94it/s] 82%|██████████████████████████████████████████████████████████▋             | 7947/9741 [00:29<00:06, 273.96it/s] 82%|██████████████████████████████████████████████████████████▉             | 7975/9741 [00:29<00:06, 274.62it/s] 82%|███████████████████████████████████████████████████████████▏            | 8003/9741 [00:30<00:06, 275.02it/s] 82%|███████████████████████████████████████████████████████████▎            | 8031/9741 [00:30<00:06, 275.19it/s] 83%|███████████████████████████████████████████████████████████▌            | 8059/9741 [00:30<00:06, 275.30it/s] 83%|███████████████████████████████████████████████████████████▊            | 8087/9741 [00:30<00:06, 275.63it/s] 83%|███████████████████████████████████████████████████████████▉            | 8115/9741 [00:30<00:05, 273.40it/s] 84%|████████████████████████████████████████████████████████████▏           | 8143/9741 [00:30<00:05, 272.19it/s] 84%|████████████████████████████████████████████████████████████▍           | 8171/9741 [00:30<00:05, 273.10it/s] 84%|████████████████████████████████████████████████████████████▌           | 8199/9741 [00:30<00:05, 273.95it/s] 84%|████████████████████████████████████████████████████████████▊           | 8227/9741 [00:30<00:05, 274.33it/s] 85%|█████████████████████████████████████████████████████████████           | 8255/9741 [00:30<00:05, 274.79it/s] 85%|█████████████████████████████████████████████████████████████▏          | 8283/9741 [00:31<00:05, 274.98it/s] 85%|█████████████████████████████████████████████████████████████▍          | 8311/9741 [00:31<00:05, 275.08it/s] 86%|█████████████████████████████████████████████████████████████▋          | 8339/9741 [00:31<00:05, 275.39it/s] 86%|█████████████████████████████████████████████████████████████▊          | 8367/9741 [00:31<00:05, 273.78it/s] 86%|██████████████████████████████████████████████████████████████          | 8395/9741 [00:31<00:04, 274.33it/s] 86%|██████████████████████████████████████████████████████████████▎         | 8423/9741 [00:31<00:04, 274.88it/s] 87%|██████████████████████████████████████████████████████████████▍         | 8451/9741 [00:31<00:04, 274.95it/s] 87%|██████████████████████████████████████████████████████████████▋         | 8479/9741 [00:31<00:04, 275.12it/s] 87%|██████████████████████████████████████████████████████████████▉         | 8507/9741 [00:31<00:04, 275.43it/s] 88%|███████████████████████████████████████████████████████████████         | 8535/9741 [00:31<00:04, 275.26it/s] 88%|███████████████████████████████████████████████████████████████▎        | 8563/9741 [00:32<00:04, 273.10it/s] 88%|███████████████████████████████████████████████████████████████▍        | 8591/9741 [00:32<00:04, 270.20it/s] 88%|███████████████████████████████████████████████████████████████▋        | 8619/9741 [00:32<00:04, 271.67it/s] 89%|███████████████████████████████████████████████████████████████▉        | 8647/9741 [00:32<00:04, 272.81it/s] 89%|████████████████████████████████████████████████████████████████        | 8675/9741 [00:32<00:03, 273.52it/s] 89%|████████████████████████████████████████████████████████████████▎       | 8703/9741 [00:32<00:03, 274.28it/s] 90%|████████████████████████████████████████████████████████████████▌       | 8731/9741 [00:32<00:03, 274.68it/s] 90%|████████████████████████████████████████████████████████████████▋       | 8759/9741 [00:32<00:03, 274.66it/s] 90%|████████████████████████████████████████████████████████████████▉       | 8787/9741 [00:32<00:03, 274.79it/s] 90%|█████████████████████████████████████████████████████████████████▏      | 8815/9741 [00:33<00:03, 272.96it/s] 91%|█████████████████████████████████████████████████████████████████▎      | 8843/9741 [00:33<00:03, 273.69it/s] 91%|█████████████████████████████████████████████████████████████████▌      | 8871/9741 [00:33<00:03, 274.28it/s] 91%|█████████████████████████████████████████████████████████████████▊      | 8899/9741 [00:33<00:03, 274.66it/s] 92%|█████████████████████████████████████████████████████████████████▉      | 8927/9741 [00:33<00:02, 275.09it/s] 92%|██████████████████████████████████████████████████████████████████▏     | 8955/9741 [00:33<00:02, 275.30it/s] 92%|██████████████████████████████████████████████████████████████████▍     | 8983/9741 [00:33<00:02, 275.33it/s] 93%|██████████████████████████████████████████████████████████████████▌     | 9011/9741 [00:33<00:02, 275.35it/s] 93%|██████████████████████████████████████████████████████████████████▊     | 9039/9741 [00:33<00:02, 271.72it/s] 93%|███████████████████████████████████████████████████████████████████     | 9067/9741 [00:33<00:02, 272.83it/s] 93%|███████████████████████████████████████████████████████████████████▏    | 9095/9741 [00:34<00:02, 273.61it/s] 94%|███████████████████████████████████████████████████████████████████▍    | 9123/9741 [00:34<00:02, 274.18it/s] 94%|███████████████████████████████████████████████████████████████████▋    | 9151/9741 [00:34<00:02, 274.60it/s] 94%|███████████████████████████████████████████████████████████████████▊    | 9179/9741 [00:34<00:02, 274.93it/s] 95%|████████████████████████████████████████████████████████████████████    | 9207/9741 [00:34<00:01, 275.10it/s] 95%|████████████████████████████████████████████████████████████████████▎   | 9235/9741 [00:34<00:01, 275.23it/s] 95%|████████████████████████████████████████████████████████████████████▍   | 9263/9741 [00:34<00:01, 273.63it/s] 95%|████████████████████████████████████████████████████████████████████▋   | 9291/9741 [00:34<00:01, 274.34it/s] 96%|████████████████████████████████████████████████████████████████████▉   | 9319/9741 [00:34<00:01, 274.76it/s] 96%|█████████████████████████████████████████████████████████████████████   | 9347/9741 [00:34<00:01, 274.93it/s] 96%|█████████████████████████████████████████████████████████████████████▎  | 9375/9741 [00:35<00:01, 275.00it/s] 97%|█████████████████████████████████████████████████████████████████████▌  | 9403/9741 [00:35<00:01, 275.00it/s] 97%|█████████████████████████████████████████████████████████████████████▋  | 9431/9741 [00:35<00:01, 275.16it/s] 97%|█████████████████████████████████████████████████████████████████████▉  | 9459/9741 [00:35<00:01, 275.15it/s] 97%|██████████████████████████████████████████████████████████████████████  | 9487/9741 [00:35<00:00, 271.48it/s] 98%|██████████████████████████████████████████████████████████████████████▎ | 9515/9741 [00:35<00:00, 272.53it/s] 98%|██████████████████████████████████████████████████████████████████████▌ | 9543/9741 [00:35<00:00, 273.58it/s] 98%|██████████████████████████████████████████████████████████████████████▋ | 9571/9741 [00:35<00:00, 274.29it/s] 99%|██████████████████████████████████████████████████████████████████████▉ | 9599/9741 [00:35<00:00, 274.56it/s] 99%|███████████████████████████████████████████████████████████████████████▏| 9627/9741 [00:35<00:00, 274.91it/s] 99%|███████████████████████████████████████████████████████████████████████▎| 9655/9741 [00:36<00:00, 275.03it/s] 99%|███████████████████████████████████████████████████████████████████████▌| 9683/9741 [00:36<00:00, 275.38it/s]100%|███████████████████████████████████████████████████████████████████████▊| 9711/9741 [00:36<00:00, 273.82it/s]100%|███████████████████████████████████████████████████████████████████████▉| 9739/9741 [00:36<00:00, 274.29it/s]100%|████████████████████████████████████████████████████████████████████████| 9741/9741 [00:36<00:00, 267.75it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:04<00:09,  4.84s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.27s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.49s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.45s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:09<00:04,  4.94s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.25s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.39s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.30s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.32s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.48s/it]
[2023-08-14 07:06:37,951] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.64s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.81s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.77s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.95s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.69s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.87s/it]
[2023-08-14 07:06:48,200] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-14 07:06:48,202] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-14 07:06:48,202] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-14 07:06:48,202] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-14 07:06:48,202] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-14 07:06:48,202] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-14 07:06:48,203] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-14 07:06:48,203] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-14 07:06:48,203] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-14 07:06:48,203] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-14 07:06:48,203] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-14 07:06:48,203] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fb75c7a1fd0>
[2023-08-14 07:06:48,203] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-14 07:06:48,203] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-14 07:06:48,203] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-14 07:06:48,203] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-14 07:06:48,203] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-14 07:06:48,203] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-14 07:06:48,203] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-14 07:06:48,203] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-14 07:06:48,203] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-14 07:06:48,203] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-14 07:06:48,203] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-14 07:06:48,203] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-14 07:06:48,203] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-14 07:06:48,203] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-14 07:06:48,203] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-14 07:06:48,203] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-14 07:06:48,203] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-14 07:06:48,203] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-14 07:06:48,203] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-14 07:06:48,203] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-14 07:06:48,203] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-14 07:06:48,204] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-14 07:06:48,204] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-14 07:06:48,204] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-14 07:06:48,204] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-14 07:06:48,204] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-14 07:06:48,204] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-14 07:06:48,204] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-14 07:06:48,204] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-14 07:06:48,204] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-14 07:06:48,204] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-14 07:06:48,204] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-14 07:06:48,204] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7fb72b395cd0>
[2023-08-14 07:06:48,204] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-14 07:06:48,204] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-14 07:06:48,204] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-14 07:06:48,204] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-14 07:06:48,204] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-14 07:06:48,204] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-14 07:06:48,204] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-14 07:06:48,204] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-14 07:06:48,204] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-14 07:06:48,204] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-14 07:06:48,204] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-14 07:06:48,204] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-14 07:06:48,204] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-14 07:06:48,204] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-14 07:06:48,204] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-14 07:06:48,204] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-14 07:06:48,204] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-14 07:06:48,204] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-14 07:06:48,204] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-14 07:06:48,204] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-14 07:06:48,204] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-14 07:06:48,204] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-14 07:06:48,205] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.56252121925354 seconds
Loading extension module utils...
Time to load utils op: 0.5047454833984375 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                                           | 0/50 [00:00<?, ?it/s]############### Example ###############
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following multiple choice question.

### Demonstration:
Input: Mary had 89 stickers.  She used 3 large stickers on the front page of her journal and 7 stickers each to 6 other pages of her journal. How many stickers does Mary have remaining?
Answer: 44

Input: Zach is saving his money to buy a brand new bike that costs $100.  His weekly allowance is $5.  His parent will pay him an extra $10 to mow the lawn.  His neighbor will pay him $7 per hour to babysit their son.  He has already saved up $65.  He'll receive his allowance on Friday and he's planning on babysitting for 2 hours this Saturday after he mows the lawn.  How much more money does Zach need to earn before he can buy the bike?
Answer: 6

Input: Mark has kangaroos and goats.  Kangaroos have two legs and goats have four legs.  If he has 23 kangaroos and three times as many goats as kangaroos what is the total number of legs of all his animals?
Answer: 322

Input: Josh’s mom gives him $20 to go shopping at the mall. He buys a hat for $10 and a pencil for $2. Then he buys four cookies. If each cookie costs $1.25, how much money does Josh have left?
Answer: 3

Input: George's bowling team is one round away from breaking the league record for most points scored in a season. The old record is an average score per player of 287 per round. Each team has 4 players and there are 10 rounds in the season. Through the first 9 rounds, his team has scored a total of 10,440. How many points less than the current league record per game average is the minimum average they need to score, per player, in the final round to tie the league record?
Answer: 27

Input: Max was doing homework in three different subjects. It took him 20 minutes to finish tasks from biology and two times more time to finish history. Geography took him the most time, three times more than history. How much time did Max spend on doing his homework?
Answer: 180

Input: Sophia ate 1/6 of her pie and she put the rest on the fridge. If the pie left in the fridge weighs 1200 grams, how many grams did Sophia eat?
Answer: 240

Input: Sarah, Mary, and Tuan decided to go to the restaurant for a meal. They decided to split the cost of the meal evenly. If the total price of the meal comes to $67 and they have a coupon for $4, how much does each person need to contribute to the bill?
Answer: 21

Input: Tom's brother is 4 times as old as Tom's dog. If in 6 years, Tom's brother will be 30 years, how old is Tom's dog going to be in six years?
Answer: 12

Input: There are 50 children at the party. Three-fifths of them are boys. How many of the children are girls?
Answer: 20

Input: Gail has some bills in her wallet which amount to $100. She has four $5 bills and three $20 bills, and the rest are $10 bills. How many $10 bills are in her wallet?
Answer: 2

Input: A 220-liter barrel has a small leak. It lost 10% of its contents before anyone noticed. How many liters are left in the barrel?
Answer: 198

Input: Markese earned 5 fewer dollars than Evan. Together they earned $37. How many dollars did Markese earn? Use E to represent how many dollars Evan earned.
Answer: 16

Input: Lou Senior took 3 cookies out of the cookie jar and ate them.  Since he didn't get caught by his wife, he went back the next day and took another 3 cookies out of the jar.  But after eating just one of the cookies, he felt guilty about it and put the other two cookies back.  His son, Louie Junior saw that his Dad was eating cookies.  So, Louie Junior took seven cookies out of the jar and hid them in his bedroom for later.  The next morning, Debra, Lou's wife looked into the cookie jar and reacted by accusing her husband of eating half of the cookies out of the cookie jar.  How many cookies remained in the jar?
Answer: 11

Input: John had $200. He gave 3/8 of his money to his mother and 3/10 to his father. How much money did John have left?
Answer: 65

Input: Tonya has $150.00 on her credit card.  If she leaves any balance on her card at the end of the month, she is charged 20% interest.  If she makes a $50.00 payment on her card, what will be the new balance?
Answer: 120

Input: In her first term, Governor Sandoval gave twice as many commencement addresses as Governor Hawkins. Governor Sloan gave ten more commencement addresses than Governor Sandoval in the same amount of time. If Governor Sandoval gave 12 commencement addresses, how many commencement addresses did the three of them give altogether?
Answer: 40

Input: If Buzz bought a pizza with 78 slices at a restaurant and then decided to share it with the waiter in the ratio of 5:8, with Buzz's ratio being 5, what's twenty less the number of slices of pizza that the waiter ate?
Answer: 28

Input: Jolene and Phil have four children, each with the same birthday.  They gave birth to their first child exactly 15 years ago.  They gave birth to their second child exactly one year after the birth of their first child.  They gave birth to their third child on the fourth birthday of their second child. Two years after the birth of their third child, they gave birth to their fourth child.  How old, in years, is their fourth child?
Answer: 8

Input: Each purple book has 230 pages. Each orange book contains 510 pages. Mirella read 5 purple books and 4 orange books. How many more orange pages did she read than purple pages?
Answer: 890

Input: Isabella has $45 more than Sam but only $15 more than Giselle. If Giselle has $120, calculate the total amount of money each shopper will receive if Isabella, Sam, and Giselle donate the money to three shoppers at their local town's supermarket who then decides to share it equally.
Answer: 115

Input: It takes 40 minutes to freeze ice cubes and 3 minutes per smoothie to turn them into smoothies once they're frozen. How long does it take to make 5 smoothies?
Answer: 55

Input: Belle eats 4 dog biscuits and 2 rawhide bones every evening. If each rawhide bone is $1, and each dog biscuit is $0.25, then how much does it cost, in dollars, to feed Belle these treats for a week?
Answer: 21

### Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid

### Response:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o23-tgsm8k-s1-rFalse
Loading extension module utils...
Time to load utils op: 0.5044798851013184 seconds
Loading extension module utils...
Time to load utils op: 0.5047831535339355 seconds
Evaluating commonsenseqa :   0%|                                                           | 0/50 [00:05<?, ?it/s]
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 4119164) of binary: /home/ylu130/.conda/envs/distllm/bin/python
Traceback (most recent call last):
  File "/home/ylu130/.conda/envs/distllm/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 345, in wrapper
    return f(*args, **kwargs)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 761, in main
    run(args)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 752, in run
    elastic_launch(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 131, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 245, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
/home/ylu130/workspace/in-context-generalization/inference.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2023-08-14_07:06:58
  host      : ia1.wse.jhu.edu
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 4119165)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2023-08-14_07:06:58
  host      : ia1.wse.jhu.edu
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 4119166)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2023-08-14_07:06:58
  host      : ia1.wse.jhu.edu
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 4119167)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2023-08-14_07:06:58
  host      : ia1.wse.jhu.edu
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 4119164)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name gsm8k --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/out-domain/o24-tgsm8k-s1-rFalse --seed 1 --num-out-domain 24
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-14 07:07:02,001] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/out-domain/o24-tgsm8k-s1-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 24
  out_domain_data_name ......... gsm8k
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o24-tgsm8k-s1-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                    | 0/9741 [00:00<?, ?it/s]  0%|▏                                                                         | 17/9741 [00:00<00:57, 169.56it/s]  0%|▎                                                                         | 35/9741 [00:00<00:57, 169.86it/s]  1%|▍                                                                         | 53/9741 [00:00<00:56, 170.35it/s]  1%|▌                                                                         | 71/9741 [00:00<00:56, 170.57it/s]  1%|▋                                                                         | 89/9741 [00:00<00:56, 170.53it/s]  1%|▊                                                                        | 107/9741 [00:00<00:56, 170.77it/s]  1%|▉                                                                        | 125/9741 [00:00<00:57, 167.77it/s]  1%|█                                                                        | 142/9741 [00:00<00:57, 168.40it/s]  2%|█▏                                                                       | 160/9741 [00:00<00:56, 168.95it/s]  2%|█▎                                                                       | 177/9741 [00:01<00:56, 169.13it/s]  2%|█▍                                                                       | 194/9741 [00:01<00:56, 169.36it/s]  2%|█▌                                                                       | 211/9741 [00:01<00:56, 168.15it/s]  2%|█▋                                                                       | 229/9741 [00:01<00:56, 168.81it/s]  3%|█▊                                                                       | 246/9741 [00:01<00:56, 169.09it/s]  3%|█▉                                                                       | 264/9741 [00:01<00:55, 169.42it/s]  3%|██                                                                       | 282/9741 [00:01<00:55, 169.60it/s]  3%|██▏                                                                      | 299/9741 [00:01<00:56, 167.64it/s]  3%|██▎                                                                      | 316/9741 [00:01<00:56, 168.08it/s]  3%|██▌                                                                      | 334/9741 [00:01<00:55, 169.00it/s]  4%|██▋                                                                      | 352/9741 [00:02<00:55, 169.59it/s]  4%|██▊                                                                      | 369/9741 [00:02<00:55, 169.31it/s]  4%|██▉                                                                      | 387/9741 [00:02<00:55, 169.86it/s]  4%|███                                                                      | 405/9741 [00:02<00:54, 170.20it/s]  4%|███▏                                                                     | 427/9741 [00:02<00:51, 181.52it/s]  5%|███▍                                                                     | 454/9741 [00:02<00:45, 205.05it/s]  5%|███▌                                                                     | 480/9741 [00:02<00:41, 220.88it/s]  5%|███▊                                                                     | 507/9741 [00:02<00:39, 232.74it/s]  5%|████                                                                     | 534/9741 [00:02<00:38, 241.24it/s]  6%|████▏                                                                    | 560/9741 [00:03<00:37, 246.66it/s]  6%|████▍                                                                    | 587/9741 [00:03<00:36, 250.81it/s]  6%|████▌                                                                    | 614/9741 [00:03<00:35, 253.73it/s]  7%|████▊                                                                    | 641/9741 [00:03<00:35, 255.70it/s]  7%|████▉                                                                    | 667/9741 [00:03<00:35, 255.31it/s]  7%|█████▏                                                                   | 694/9741 [00:03<00:35, 256.89it/s]  7%|█████▍                                                                   | 721/9741 [00:03<00:34, 257.91it/s]  8%|█████▌                                                                   | 747/9741 [00:03<00:34, 258.48it/s]  8%|█████▊                                                                   | 774/9741 [00:03<00:34, 259.25it/s]  8%|██████                                                                   | 801/9741 [00:03<00:34, 259.69it/s]  8%|██████▏                                                                  | 827/9741 [00:04<00:34, 259.33it/s]  9%|██████▍                                                                  | 854/9741 [00:04<00:34, 259.79it/s]  9%|██████▌                                                                  | 880/9741 [00:04<00:34, 259.69it/s]  9%|██████▊                                                                  | 906/9741 [00:04<00:34, 257.07it/s] 10%|██████▉                                                                  | 932/9741 [00:04<00:34, 257.69it/s] 10%|███████▏                                                                 | 959/9741 [00:04<00:33, 258.49it/s] 10%|███████▍                                                                 | 986/9741 [00:04<00:33, 258.98it/s] 10%|███████▍                                                                | 1012/9741 [00:04<00:33, 259.26it/s] 11%|███████▋                                                                | 1038/9741 [00:04<00:33, 259.27it/s] 11%|███████▊                                                                | 1064/9741 [00:04<00:33, 259.08it/s] 11%|████████                                                                | 1090/9741 [00:05<00:33, 259.10it/s] 11%|████████▏                                                               | 1116/9741 [00:05<00:33, 256.76it/s] 12%|████████▍                                                               | 1142/9741 [00:05<00:33, 257.27it/s] 12%|████████▋                                                               | 1168/9741 [00:05<00:33, 254.96it/s] 12%|████████▊                                                               | 1194/9741 [00:05<00:33, 254.08it/s] 13%|█████████                                                               | 1220/9741 [00:05<00:33, 255.06it/s] 13%|█████████▏                                                              | 1246/9741 [00:05<00:33, 255.80it/s] 13%|█████████▍                                                              | 1272/9741 [00:05<00:33, 256.38it/s] 13%|█████████▌                                                              | 1298/9741 [00:05<00:32, 256.97it/s] 14%|█████████▊                                                              | 1324/9741 [00:05<00:32, 257.29it/s] 14%|█████████▉                                                              | 1350/9741 [00:06<00:32, 255.50it/s] 14%|██████████▏                                                             | 1376/9741 [00:06<00:32, 256.07it/s] 14%|██████████▎                                                             | 1402/9741 [00:06<00:32, 256.19it/s] 15%|██████████▌                                                             | 1428/9741 [00:06<00:32, 256.46it/s] 15%|██████████▋                                                             | 1454/9741 [00:06<00:32, 256.47it/s] 15%|██████████▉                                                             | 1480/9741 [00:06<00:32, 256.92it/s] 15%|███████████▏                                                            | 1506/9741 [00:06<00:33, 247.13it/s] 16%|███████████▎                                                            | 1532/9741 [00:06<00:32, 250.16it/s] 16%|███████████▌                                                            | 1558/9741 [00:06<00:32, 252.62it/s] 16%|███████████▋                                                            | 1584/9741 [00:07<00:32, 249.81it/s] 17%|███████████▉                                                            | 1610/9741 [00:07<00:32, 252.05it/s] 17%|████████████                                                            | 1636/9741 [00:07<00:31, 253.91it/s] 17%|████████████▎                                                           | 1662/9741 [00:07<00:31, 255.03it/s] 17%|████████████▍                                                           | 1688/9741 [00:07<00:31, 255.82it/s] 18%|████████████▋                                                           | 1714/9741 [00:07<00:31, 254.92it/s] 18%|████████████▊                                                           | 1740/9741 [00:07<00:31, 254.91it/s] 18%|█████████████                                                           | 1766/9741 [00:07<00:31, 255.80it/s] 18%|█████████████▏                                                          | 1792/9741 [00:07<00:34, 230.31it/s] 19%|█████████████▍                                                          | 1818/9741 [00:07<00:33, 236.67it/s] 19%|█████████████▋                                                          | 1844/9741 [00:08<00:32, 242.21it/s] 19%|█████████████▊                                                          | 1870/9741 [00:08<00:31, 246.51it/s] 19%|██████████████                                                          | 1896/9741 [00:08<00:31, 249.87it/s] 20%|██████████████▏                                                         | 1922/9741 [00:08<00:30, 252.45it/s] 20%|██████████████▍                                                         | 1948/9741 [00:08<00:30, 254.07it/s] 20%|██████████████▌                                                         | 1974/9741 [00:08<00:30, 255.54it/s] 21%|██████████████▊                                                         | 2000/9741 [00:08<00:30, 256.32it/s] 21%|██████████████▉                                                         | 2026/9741 [00:08<00:30, 254.91it/s] 21%|███████████████▏                                                        | 2052/9741 [00:08<00:30, 255.99it/s] 21%|███████████████▎                                                        | 2078/9741 [00:08<00:29, 256.82it/s] 22%|███████████████▌                                                        | 2104/9741 [00:09<00:29, 257.20it/s] 22%|███████████████▋                                                        | 2130/9741 [00:09<00:29, 257.75it/s] 22%|███████████████▉                                                        | 2156/9741 [00:09<00:29, 258.21it/s] 22%|████████████████▏                                                       | 2182/9741 [00:09<00:29, 258.46it/s] 23%|████████████████▎                                                       | 2208/9741 [00:09<00:29, 258.55it/s] 23%|████████████████▌                                                       | 2234/9741 [00:09<00:29, 258.72it/s] 23%|████████████████▋                                                       | 2260/9741 [00:09<00:29, 256.66it/s] 23%|████████████████▉                                                       | 2286/9741 [00:09<00:28, 257.25it/s] 24%|█████████████████                                                       | 2312/9741 [00:09<00:28, 257.72it/s] 24%|█████████████████▎                                                      | 2338/9741 [00:09<00:28, 257.86it/s] 24%|█████████████████▍                                                      | 2364/9741 [00:10<00:28, 258.07it/s] 25%|█████████████████▋                                                      | 2390/9741 [00:10<00:28, 258.51it/s] 25%|█████████████████▊                                                      | 2416/9741 [00:10<00:28, 258.79it/s] 25%|██████████████████                                                      | 2442/9741 [00:10<00:28, 258.88it/s] 25%|██████████████████▏                                                     | 2468/9741 [00:10<00:28, 258.66it/s] 26%|██████████████████▍                                                     | 2494/9741 [00:10<00:28, 256.62it/s] 26%|██████████████████▋                                                     | 2520/9741 [00:10<00:28, 257.40it/s] 26%|██████████████████▊                                                     | 2546/9741 [00:10<00:27, 257.67it/s] 26%|███████████████████                                                     | 2572/9741 [00:10<00:27, 258.21it/s] 27%|███████████████████▏                                                    | 2598/9741 [00:10<00:27, 258.57it/s] 27%|███████████████████▍                                                    | 2624/9741 [00:11<00:27, 258.66it/s] 27%|███████████████████▌                                                    | 2650/9741 [00:11<00:27, 258.53it/s] 27%|███████████████████▊                                                    | 2676/9741 [00:11<00:27, 258.65it/s] 28%|███████████████████▉                                                    | 2702/9741 [00:11<00:27, 256.26it/s] 28%|████████████████████▏                                                   | 2728/9741 [00:11<00:27, 256.77it/s] 28%|████████████████████▎                                                   | 2754/9741 [00:11<00:27, 257.31it/s] 29%|████████████████████▌                                                   | 2780/9741 [00:11<00:27, 257.56it/s] 29%|████████████████████▋                                                   | 2806/9741 [00:11<00:26, 257.91it/s] 29%|████████████████████▉                                                   | 2832/9741 [00:11<00:26, 258.23it/s] 29%|█████████████████████                                                   | 2858/9741 [00:11<00:26, 258.52it/s] 30%|█████████████████████▎                                                  | 2884/9741 [00:12<00:26, 258.72it/s] 30%|█████████████████████▌                                                  | 2910/9741 [00:12<00:26, 258.54it/s] 30%|█████████████████████▋                                                  | 2936/9741 [00:12<00:26, 256.74it/s] 30%|█████████████████████▉                                                  | 2962/9741 [00:12<00:26, 257.17it/s] 31%|██████████████████████                                                  | 2988/9741 [00:12<00:26, 257.31it/s] 31%|██████████████████████▎                                                 | 3015/9741 [00:12<00:26, 258.16it/s] 31%|██████████████████████▍                                                 | 3041/9741 [00:12<00:25, 258.38it/s] 31%|██████████████████████▋                                                 | 3067/9741 [00:12<00:25, 258.44it/s] 32%|██████████████████████▊                                                 | 3093/9741 [00:12<00:25, 258.76it/s] 32%|███████████████████████                                                 | 3119/9741 [00:12<00:25, 258.29it/s] 32%|███████████████████████▏                                                | 3145/9741 [00:13<00:25, 258.40it/s] 33%|███████████████████████▍                                                | 3171/9741 [00:13<00:25, 256.43it/s] 33%|███████████████████████▋                                                | 3197/9741 [00:13<00:25, 257.44it/s] 33%|███████████████████████▊                                                | 3223/9741 [00:13<00:25, 257.81it/s] 33%|████████████████████████                                                | 3250/9741 [00:13<00:25, 258.49it/s] 34%|████████████████████████▏                                               | 3276/9741 [00:13<00:24, 258.73it/s] 34%|████████████████████████▍                                               | 3302/9741 [00:13<00:24, 258.92it/s] 34%|████████████████████████▌                                               | 3328/9741 [00:13<00:24, 258.80it/s] 34%|████████████████████████▊                                               | 3354/9741 [00:13<00:24, 259.07it/s] 35%|████████████████████████▉                                               | 3380/9741 [00:14<00:24, 257.12it/s] 35%|█████████████████████████▏                                              | 3406/9741 [00:14<00:24, 257.75it/s] 35%|█████████████████████████▎                                              | 3432/9741 [00:14<00:24, 258.15it/s] 35%|█████████████████████████▌                                              | 3458/9741 [00:14<00:24, 258.24it/s] 36%|█████████████████████████▊                                              | 3484/9741 [00:14<00:24, 258.07it/s] 36%|█████████████████████████▉                                              | 3510/9741 [00:14<00:24, 257.82it/s] 36%|██████████████████████████▏                                             | 3536/9741 [00:14<00:24, 258.22it/s] 37%|██████████████████████████▎                                             | 3562/9741 [00:14<00:23, 258.17it/s] 37%|██████████████████████████▌                                             | 3588/9741 [00:14<00:23, 258.18it/s] 37%|██████████████████████████▋                                             | 3614/9741 [00:14<00:23, 256.21it/s] 37%|██████████████████████████▉                                             | 3640/9741 [00:15<00:23, 257.09it/s] 38%|███████████████████████████                                             | 3666/9741 [00:15<00:23, 257.39it/s] 38%|███████████████████████████▎                                            | 3692/9741 [00:15<00:23, 258.05it/s] 38%|███████████████████████████▍                                            | 3718/9741 [00:15<00:23, 258.48it/s] 38%|███████████████████████████▋                                            | 3744/9741 [00:15<00:23, 258.69it/s] 39%|███████████████████████████▊                                            | 3770/9741 [00:15<00:23, 258.51it/s] 39%|████████████████████████████                                            | 3796/9741 [00:15<00:23, 258.44it/s] 39%|████████████████████████████▎                                           | 3822/9741 [00:15<00:22, 258.42it/s] 40%|████████████████████████████▍                                           | 3848/9741 [00:15<00:22, 256.43it/s] 40%|████████████████████████████▋                                           | 3874/9741 [00:15<00:22, 257.24it/s] 40%|████████████████████████████▊                                           | 3900/9741 [00:16<00:22, 257.83it/s] 40%|█████████████████████████████                                           | 3926/9741 [00:16<00:22, 258.10it/s] 41%|█████████████████████████████▏                                          | 3952/9741 [00:16<00:22, 258.16it/s] 41%|█████████████████████████████▍                                          | 3978/9741 [00:16<00:22, 258.22it/s] 41%|█████████████████████████████▌                                          | 4004/9741 [00:16<00:22, 257.58it/s] 41%|█████████████████████████████▊                                          | 4030/9741 [00:16<00:22, 257.55it/s] 42%|█████████████████████████████▉                                          | 4056/9741 [00:16<00:22, 257.96it/s] 42%|██████████████████████████████▏                                         | 4082/9741 [00:16<00:22, 256.08it/s] 42%|██████████████████████████████▎                                         | 4108/9741 [00:16<00:21, 256.36it/s] 42%|██████████████████████████████▌                                         | 4134/9741 [00:16<00:21, 256.29it/s] 43%|██████████████████████████████▋                                         | 4160/9741 [00:17<00:21, 255.93it/s] 43%|██████████████████████████████▉                                         | 4186/9741 [00:17<00:21, 255.63it/s] 43%|███████████████████████████████▏                                        | 4212/9741 [00:17<00:21, 255.64it/s] 44%|███████████████████████████████▎                                        | 4238/9741 [00:17<00:21, 255.64it/s] 44%|███████████████████████████████▌                                        | 4264/9741 [00:17<00:21, 255.87it/s] 44%|███████████████████████████████▋                                        | 4290/9741 [00:17<00:21, 254.02it/s] 44%|███████████████████████████████▉                                        | 4316/9741 [00:17<00:21, 254.67it/s] 45%|████████████████████████████████                                        | 4342/9741 [00:17<00:21, 255.14it/s] 45%|████████████████████████████████▎                                       | 4368/9741 [00:17<00:21, 255.36it/s] 45%|████████████████████████████████▍                                       | 4394/9741 [00:17<00:20, 255.68it/s] 45%|████████████████████████████████▋                                       | 4420/9741 [00:18<00:20, 255.94it/s] 46%|████████████████████████████████▊                                       | 4446/9741 [00:18<00:20, 253.41it/s] 46%|█████████████████████████████████                                       | 4472/9741 [00:18<00:20, 254.26it/s] 46%|█████████████████████████████████▏                                      | 4498/9741 [00:18<00:20, 254.80it/s] 46%|█████████████████████████████████▍                                      | 4524/9741 [00:18<00:22, 230.33it/s] 47%|█████████████████████████████████▋                                      | 4550/9741 [00:18<00:21, 237.22it/s] 47%|█████████████████████████████████▊                                      | 4576/9741 [00:18<00:21, 242.34it/s] 47%|██████████████████████████████████                                      | 4602/9741 [00:18<00:20, 245.89it/s] 48%|██████████████████████████████████▏                                     | 4628/9741 [00:18<00:20, 248.91it/s] 48%|██████████████████████████████████▍                                     | 4654/9741 [00:19<00:20, 251.12it/s] 48%|██████████████████████████████████▌                                     | 4680/9741 [00:19<00:20, 252.70it/s] 48%|██████████████████████████████████▊                                     | 4706/9741 [00:19<00:19, 253.75it/s] 49%|██████████████████████████████████▉                                     | 4732/9741 [00:19<00:19, 254.51it/s] 49%|███████████████████████████████████▏                                    | 4758/9741 [00:19<00:28, 172.84it/s] 49%|███████████████████████████████████▎                                    | 4784/9741 [00:19<00:25, 191.54it/s] 49%|███████████████████████████████████▌                                    | 4810/9741 [00:19<00:23, 207.20it/s] 50%|███████████████████████████████████▋                                    | 4835/9741 [00:19<00:22, 217.79it/s] 50%|███████████████████████████████████▉                                    | 4861/9741 [00:19<00:21, 227.43it/s] 50%|████████████████████████████████████                                    | 4887/9741 [00:20<00:20, 234.88it/s] 50%|████████████████████████████████████▎                                   | 4913/9741 [00:20<00:20, 240.92it/s] 51%|████████████████████████████████████▌                                   | 4939/9741 [00:20<00:19, 245.32it/s] 51%|████████████████████████████████████▋                                   | 4965/9741 [00:20<00:19, 246.80it/s] 51%|████████████████████████████████████▉                                   | 4991/9741 [00:20<00:19, 249.48it/s] 52%|█████████████████████████████████████                                   | 5017/9741 [00:20<00:18, 251.29it/s] 52%|█████████████████████████████████████▎                                  | 5043/9741 [00:20<00:18, 252.69it/s] 52%|█████████████████████████████████████▍                                  | 5069/9741 [00:20<00:18, 253.50it/s] 52%|█████████████████████████████████████▋                                  | 5095/9741 [00:20<00:18, 254.10it/s] 53%|█████████████████████████████████████▊                                  | 5121/9741 [00:21<00:18, 254.79it/s] 53%|██████████████████████████████████████                                  | 5147/9741 [00:21<00:18, 255.20it/s] 53%|██████████████████████████████████████▏                                 | 5173/9741 [00:21<00:18, 253.61it/s] 53%|██████████████████████████████████████▍                                 | 5199/9741 [00:21<00:17, 254.41it/s] 54%|██████████████████████████████████████▌                                 | 5225/9741 [00:21<00:17, 254.79it/s] 54%|██████████████████████████████████████▊                                 | 5251/9741 [00:21<00:17, 253.20it/s] 54%|███████████████████████████████████████                                 | 5277/9741 [00:21<00:17, 253.79it/s] 54%|███████████████████████████████████████▏                                | 5303/9741 [00:21<00:17, 255.47it/s] 55%|███████████████████████████████████████▍                                | 5329/9741 [00:21<00:17, 256.54it/s] 55%|███████████████████████████████████████▌                                | 5355/9741 [00:21<00:17, 257.14it/s] 55%|███████████████████████████████████████▊                                | 5381/9741 [00:22<00:16, 257.67it/s] 56%|███████████████████████████████████████▉                                | 5407/9741 [00:22<00:16, 255.52it/s] 56%|████████████████████████████████████████▏                               | 5433/9741 [00:22<00:16, 256.31it/s] 56%|████████████████████████████████████████▎                               | 5459/9741 [00:22<00:16, 257.11it/s] 56%|████████████████████████████████████████▌                               | 5486/9741 [00:22<00:16, 258.88it/s] 57%|████████████████████████████████████████▋                               | 5513/9741 [00:22<00:16, 261.01it/s] 57%|████████████████████████████████████████▉                               | 5540/9741 [00:22<00:16, 262.33it/s] 57%|█████████████████████████████████████████▏                              | 5567/9741 [00:22<00:15, 263.34it/s] 57%|█████████████████████████████████████████▎                              | 5594/9741 [00:22<00:15, 263.84it/s] 58%|█████████████████████████████████████████▌                              | 5621/9741 [00:22<00:15, 264.44it/s] 58%|█████████████████████████████████████████▋                              | 5648/9741 [00:23<00:15, 262.92it/s] 58%|█████████████████████████████████████████▉                              | 5675/9741 [00:23<00:15, 263.88it/s] 59%|██████████████████████████████████████████▏                             | 5702/9741 [00:23<00:15, 262.30it/s] 59%|██████████████████████████████████████████▎                             | 5729/9741 [00:23<00:15, 263.53it/s] 59%|██████████████████████████████████████████▌                             | 5756/9741 [00:23<00:15, 264.16it/s] 59%|██████████████████████████████████████████▋                             | 5783/9741 [00:23<00:14, 264.73it/s] 60%|██████████████████████████████████████████▉                             | 5810/9741 [00:23<00:14, 265.12it/s] 60%|███████████████████████████████████████████▏                            | 5837/9741 [00:23<00:14, 265.08it/s] 60%|███████████████████████████████████████████▎                            | 5864/9741 [00:23<00:14, 263.01it/s] 60%|███████████████████████████████████████████▌                            | 5891/9741 [00:23<00:14, 263.85it/s] 61%|███████████████████████████████████████████▋                            | 5918/9741 [00:24<00:14, 264.61it/s] 61%|███████████████████████████████████████████▉                            | 5945/9741 [00:24<00:14, 265.04it/s] 61%|████████████████████████████████████████████▏                           | 5972/9741 [00:24<00:14, 265.48it/s] 62%|████████████████████████████████████████████▎                           | 5999/9741 [00:24<00:14, 265.20it/s] 62%|████████████████████████████████████████████▌                           | 6026/9741 [00:24<00:14, 265.05it/s] 62%|████████████████████████████████████████████▋                           | 6053/9741 [00:24<00:13, 265.18it/s] 62%|████████████████████████████████████████████▉                           | 6080/9741 [00:24<00:13, 261.74it/s] 63%|█████████████████████████████████████████████▏                          | 6107/9741 [00:24<00:13, 262.24it/s] 63%|█████████████████████████████████████████████▎                          | 6134/9741 [00:24<00:13, 261.24it/s] 63%|█████████████████████████████████████████████▌                          | 6161/9741 [00:24<00:13, 262.32it/s] 64%|█████████████████████████████████████████████▋                          | 6188/9741 [00:25<00:13, 263.39it/s] 64%|█████████████████████████████████████████████▉                          | 6215/9741 [00:25<00:13, 264.23it/s] 64%|██████████████████████████████████████████████▏                         | 6242/9741 [00:25<00:13, 264.34it/s] 64%|██████████████████████████████████████████████▎                         | 6269/9741 [00:25<00:13, 264.64it/s] 65%|██████████████████████████████████████████████▌                         | 6296/9741 [00:25<00:13, 264.99it/s] 65%|██████████████████████████████████████████████▋                         | 6323/9741 [00:25<00:13, 262.83it/s] 65%|██████████████████████████████████████████████▉                         | 6350/9741 [00:25<00:12, 263.78it/s] 65%|███████████████████████████████████████████████▏                        | 6377/9741 [00:25<00:12, 264.38it/s] 66%|███████████████████████████████████████████████▎                        | 6404/9741 [00:25<00:12, 264.90it/s] 66%|███████████████████████████████████████████████▌                        | 6431/9741 [00:26<00:12, 264.23it/s] 66%|███████████████████████████████████████████████▋                        | 6458/9741 [00:26<00:12, 264.46it/s] 67%|███████████████████████████████████████████████▉                        | 6485/9741 [00:26<00:12, 264.57it/s] 67%|████████████████████████████████████████████████▏                       | 6512/9741 [00:26<00:12, 264.99it/s] 67%|████████████████████████████████████████████████▎                       | 6539/9741 [00:26<00:12, 263.28it/s] 67%|████████████████████████████████████████████████▌                       | 6566/9741 [00:26<00:12, 263.96it/s] 68%|████████████████████████████████████████████████▋                       | 6593/9741 [00:26<00:12, 261.14it/s] 68%|████████████████████████████████████████████████▉                       | 6620/9741 [00:26<00:11, 262.24it/s] 68%|█████████████████████████████████████████████████▏                      | 6647/9741 [00:26<00:11, 263.36it/s] 69%|█████████████████████████████████████████████████▎                      | 6674/9741 [00:26<00:11, 264.16it/s] 69%|█████████████████████████████████████████████████▌                      | 6701/9741 [00:27<00:11, 263.89it/s] 69%|█████████████████████████████████████████████████▋                      | 6728/9741 [00:27<00:11, 263.94it/s] 69%|█████████████████████████████████████████████████▉                      | 6755/9741 [00:27<00:11, 264.74it/s] 70%|██████████████████████████████████████████████████▏                     | 6782/9741 [00:27<00:11, 263.20it/s] 70%|██████████████████████████████████████████████████▎                     | 6809/9741 [00:27<00:11, 264.12it/s] 70%|██████████████████████████████████████████████████▌                     | 6836/9741 [00:27<00:10, 264.63it/s] 70%|██████████████████████████████████████████████████▋                     | 6863/9741 [00:27<00:10, 265.14it/s] 71%|██████████████████████████████████████████████████▉                     | 6890/9741 [00:27<00:10, 265.38it/s] 71%|███████████████████████████████████████████████████▏                    | 6917/9741 [00:27<00:10, 265.62it/s] 71%|███████████████████████████████████████████████████▎                    | 6944/9741 [00:27<00:10, 265.91it/s] 72%|███████████████████████████████████████████████████▌                    | 6971/9741 [00:28<00:10, 265.89it/s] 72%|███████████████████████████████████████████████████▋                    | 6998/9741 [00:28<00:10, 264.03it/s] 72%|███████████████████████████████████████████████████▉                    | 7025/9741 [00:28<00:10, 264.56it/s] 72%|████████████████████████████████████████████████████                    | 7052/9741 [00:28<00:10, 264.15it/s] 73%|████████████████████████████████████████████████████▎                   | 7079/9741 [00:28<00:10, 264.59it/s] 73%|████████████████████████████████████████████████████▌                   | 7106/9741 [00:28<00:09, 264.72it/s] 73%|████████████████████████████████████████████████████▋                   | 7133/9741 [00:28<00:09, 264.83it/s] 74%|████████████████████████████████████████████████████▉                   | 7160/9741 [00:28<00:09, 265.26it/s] 74%|█████████████████████████████████████████████████████                   | 7187/9741 [00:28<00:09, 265.53it/s] 74%|█████████████████████████████████████████████████████▎                  | 7214/9741 [00:28<00:09, 263.69it/s] 74%|█████████████████████████████████████████████████████▌                  | 7241/9741 [00:29<00:09, 264.26it/s] 75%|█████████████████████████████████████████████████████▋                  | 7268/9741 [00:29<00:09, 264.75it/s] 75%|█████████████████████████████████████████████████████▉                  | 7295/9741 [00:29<00:09, 265.06it/s] 75%|██████████████████████████████████████████████████████                  | 7322/9741 [00:29<00:09, 265.30it/s] 75%|██████████████████████████████████████████████████████▎                 | 7349/9741 [00:29<00:09, 265.52it/s] 76%|██████████████████████████████████████████████████████▌                 | 7376/9741 [00:29<00:08, 265.44it/s] 76%|██████████████████████████████████████████████████████▋                 | 7403/9741 [00:29<00:08, 265.51it/s] 76%|██████████████████████████████████████████████████████▉                 | 7430/9741 [00:29<00:08, 265.38it/s] 77%|███████████████████████████████████████████████████████                 | 7457/9741 [00:29<00:09, 232.52it/s] 77%|███████████████████████████████████████████████████████▎                | 7484/9741 [00:30<00:09, 241.52it/s] 77%|███████████████████████████████████████████████████████▌                | 7511/9741 [00:30<00:08, 248.17it/s] 77%|███████████████████████████████████████████████████████▋                | 7538/9741 [00:30<00:08, 253.11it/s] 78%|███████████████████████████████████████████████████████▉                | 7565/9741 [00:30<00:08, 256.82it/s] 78%|████████████████████████████████████████████████████████                | 7592/9741 [00:30<00:08, 259.21it/s] 78%|████████████████████████████████████████████████████████▎               | 7619/9741 [00:30<00:08, 261.02it/s] 78%|████████████████████████████████████████████████████████▌               | 7646/9741 [00:30<00:08, 261.58it/s] 79%|████████████████████████████████████████████████████████▋               | 7673/9741 [00:30<00:07, 260.63it/s] 79%|████████████████████████████████████████████████████████▉               | 7700/9741 [00:30<00:07, 262.15it/s] 79%|█████████████████████████████████████████████████████████               | 7727/9741 [00:30<00:07, 263.59it/s] 80%|█████████████████████████████████████████████████████████▎              | 7754/9741 [00:31<00:07, 264.00it/s] 80%|█████████████████████████████████████████████████████████▌              | 7781/9741 [00:31<00:07, 264.19it/s] 80%|█████████████████████████████████████████████████████████▋              | 7808/9741 [00:31<00:07, 264.68it/s] 80%|█████████████████████████████████████████████████████████▉              | 7835/9741 [00:31<00:07, 265.11it/s] 81%|██████████████████████████████████████████████████████████              | 7862/9741 [00:31<00:07, 265.27it/s] 81%|██████████████████████████████████████████████████████████▎             | 7889/9741 [00:31<00:06, 265.33it/s] 81%|██████████████████████████████████████████████████████████▌             | 7916/9741 [00:31<00:06, 263.61it/s] 82%|██████████████████████████████████████████████████████████▋             | 7943/9741 [00:31<00:06, 264.17it/s] 82%|██████████████████████████████████████████████████████████▉             | 7970/9741 [00:31<00:06, 264.47it/s] 82%|███████████████████████████████████████████████████████████             | 7997/9741 [00:31<00:06, 264.70it/s] 82%|███████████████████████████████████████████████████████████▎            | 8024/9741 [00:32<00:06, 265.09it/s] 83%|███████████████████████████████████████████████████████████▌            | 8051/9741 [00:32<00:06, 264.88it/s] 83%|███████████████████████████████████████████████████████████▋            | 8078/9741 [00:32<00:06, 265.03it/s] 83%|███████████████████████████████████████████████████████████▉            | 8105/9741 [00:32<00:06, 265.37it/s] 83%|████████████████████████████████████████████████████████████            | 8132/9741 [00:32<00:06, 263.61it/s] 84%|████████████████████████████████████████████████████████████▎           | 8159/9741 [00:32<00:05, 264.25it/s] 84%|████████████████████████████████████████████████████████████▌           | 8186/9741 [00:32<00:05, 263.35it/s] 84%|████████████████████████████████████████████████████████████▋           | 8213/9741 [00:32<00:05, 262.73it/s] 85%|████████████████████████████████████████████████████████████▉           | 8240/9741 [00:32<00:05, 263.71it/s] 85%|█████████████████████████████████████████████████████████████           | 8267/9741 [00:32<00:05, 264.29it/s] 85%|█████████████████████████████████████████████████████████████▎          | 8294/9741 [00:33<00:05, 264.41it/s] 85%|█████████████████████████████████████████████████████████████▌          | 8321/9741 [00:33<00:05, 264.71it/s] 86%|█████████████████████████████████████████████████████████████▋          | 8348/9741 [00:33<00:05, 263.05it/s] 86%|█████████████████████████████████████████████████████████████▉          | 8375/9741 [00:33<00:05, 263.88it/s] 86%|██████████████████████████████████████████████████████████████          | 8402/9741 [00:33<00:05, 264.30it/s] 87%|██████████████████████████████████████████████████████████████▎         | 8429/9741 [00:33<00:04, 264.87it/s] 87%|██████████████████████████████████████████████████████████████▌         | 8456/9741 [00:33<00:04, 265.08it/s] 87%|██████████████████████████████████████████████████████████████▋         | 8483/9741 [00:33<00:04, 265.29it/s] 87%|██████████████████████████████████████████████████████████████▉         | 8510/9741 [00:33<00:04, 265.52it/s] 88%|███████████████████████████████████████████████████████████████         | 8537/9741 [00:34<00:04, 264.52it/s] 88%|███████████████████████████████████████████████████████████████▎        | 8564/9741 [00:34<00:04, 264.20it/s] 88%|███████████████████████████████████████████████████████████████▍        | 8591/9741 [00:34<00:04, 262.70it/s] 88%|███████████████████████████████████████████████████████████████▋        | 8618/9741 [00:34<00:04, 263.35it/s] 89%|███████████████████████████████████████████████████████████████▉        | 8645/9741 [00:34<00:04, 262.40it/s] 89%|████████████████████████████████████████████████████████████████        | 8672/9741 [00:34<00:04, 263.16it/s] 89%|████████████████████████████████████████████████████████████████▎       | 8699/9741 [00:34<00:03, 263.89it/s] 90%|████████████████████████████████████████████████████████████████▍       | 8726/9741 [00:34<00:03, 263.79it/s] 90%|████████████████████████████████████████████████████████████████▋       | 8753/9741 [00:34<00:03, 264.34it/s] 90%|████████████████████████████████████████████████████████████████▉       | 8780/9741 [00:34<00:03, 264.62it/s] 90%|█████████████████████████████████████████████████████████████████       | 8807/9741 [00:35<00:03, 262.90it/s] 91%|█████████████████████████████████████████████████████████████████▎      | 8834/9741 [00:35<00:03, 263.51it/s] 91%|█████████████████████████████████████████████████████████████████▍      | 8861/9741 [00:35<00:03, 262.98it/s] 91%|█████████████████████████████████████████████████████████████████▋      | 8888/9741 [00:35<00:03, 263.11it/s] 92%|█████████████████████████████████████████████████████████████████▉      | 8915/9741 [00:35<00:03, 263.97it/s] 92%|██████████████████████████████████████████████████████████████████      | 8942/9741 [00:35<00:03, 264.49it/s] 92%|██████████████████████████████████████████████████████████████████▎     | 8969/9741 [00:35<00:02, 264.77it/s] 92%|██████████████████████████████████████████████████████████████████▍     | 8996/9741 [00:35<00:02, 264.95it/s] 93%|██████████████████████████████████████████████████████████████████▋     | 9023/9741 [00:35<00:02, 265.10it/s] 93%|██████████████████████████████████████████████████████████████████▉     | 9050/9741 [00:35<00:02, 263.21it/s] 93%|███████████████████████████████████████████████████████████████████     | 9077/9741 [00:36<00:02, 263.92it/s] 93%|███████████████████████████████████████████████████████████████████▎    | 9104/9741 [00:36<00:02, 264.39it/s] 94%|███████████████████████████████████████████████████████████████████▍    | 9131/9741 [00:36<00:02, 264.66it/s] 94%|███████████████████████████████████████████████████████████████████▋    | 9158/9741 [00:36<00:02, 264.61it/s] 94%|███████████████████████████████████████████████████████████████████▉    | 9185/9741 [00:36<00:02, 263.15it/s] 95%|████████████████████████████████████████████████████████████████████    | 9212/9741 [00:36<00:02, 263.81it/s] 95%|████████████████████████████████████████████████████████████████████▎   | 9239/9741 [00:36<00:01, 264.13it/s] 95%|████████████████████████████████████████████████████████████████████▍   | 9266/9741 [00:36<00:01, 262.51it/s] 95%|████████████████████████████████████████████████████████████████████▋   | 9293/9741 [00:36<00:01, 263.53it/s] 96%|████████████████████████████████████████████████████████████████████▉   | 9320/9741 [00:36<00:01, 264.02it/s] 96%|█████████████████████████████████████████████████████████████████████   | 9347/9741 [00:37<00:01, 264.51it/s] 96%|█████████████████████████████████████████████████████████████████████▎  | 9374/9741 [00:37<00:01, 264.89it/s] 97%|█████████████████████████████████████████████████████████████████████▍  | 9401/9741 [00:37<00:01, 265.08it/s] 97%|█████████████████████████████████████████████████████████████████████▋  | 9428/9741 [00:37<00:01, 265.28it/s] 97%|█████████████████████████████████████████████████████████████████████▉  | 9455/9741 [00:37<00:01, 265.32it/s] 97%|██████████████████████████████████████████████████████████████████████  | 9482/9741 [00:37<00:00, 262.69it/s] 98%|██████████████████████████████████████████████████████████████████████▎ | 9509/9741 [00:37<00:00, 262.58it/s] 98%|██████████████████████████████████████████████████████████████████████▍ | 9536/9741 [00:37<00:00, 262.29it/s] 98%|██████████████████████████████████████████████████████████████████████▋ | 9563/9741 [00:37<00:00, 263.09it/s] 98%|██████████████████████████████████████████████████████████████████████▉ | 9590/9741 [00:38<00:00, 263.68it/s] 99%|███████████████████████████████████████████████████████████████████████ | 9617/9741 [00:38<00:00, 264.29it/s] 99%|███████████████████████████████████████████████████████████████████████▎| 9644/9741 [00:38<00:00, 264.55it/s] 99%|███████████████████████████████████████████████████████████████████████▍| 9671/9741 [00:38<00:00, 264.51it/s]100%|███████████████████████████████████████████████████████████████████████▋| 9698/9741 [00:38<00:00, 264.38it/s]100%|███████████████████████████████████████████████████████████████████████▉| 9725/9741 [00:38<00:00, 262.02it/s]100%|████████████████████████████████████████████████████████████████████████| 9741/9741 [00:38<00:00, 252.51it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.07s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.34s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.26s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.50s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:09<00:04,  4.93s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.24s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.32s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.36s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.32s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.50s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.63s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.80s/it]
[2023-08-14 07:08:32,664] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.74s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.89s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.72s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.91s/it]
[2023-08-14 07:08:40,636] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-14 07:08:40,638] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-14 07:08:40,639] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-14 07:08:40,639] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-14 07:08:40,639] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-14 07:08:40,639] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-14 07:08:40,640] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-14 07:08:40,640] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-14 07:08:40,640] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-14 07:08:40,640] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-14 07:08:40,640] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-14 07:08:40,640] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f05ee934fd0>
[2023-08-14 07:08:40,640] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-14 07:08:40,640] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-14 07:08:40,640] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-14 07:08:40,640] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-14 07:08:40,640] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-14 07:08:40,640] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-14 07:08:40,640] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-14 07:08:40,640] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-14 07:08:40,640] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-14 07:08:40,640] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-14 07:08:40,640] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-14 07:08:40,640] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-14 07:08:40,640] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-14 07:08:40,640] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-14 07:08:40,640] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-14 07:08:40,640] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-14 07:08:40,641] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-14 07:08:40,641] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-14 07:08:40,641] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-14 07:08:40,641] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-14 07:08:40,641] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-14 07:08:40,641] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-14 07:08:40,641] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-14 07:08:40,641] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-14 07:08:40,641] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-14 07:08:40,641] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-14 07:08:40,641] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-14 07:08:40,641] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-14 07:08:40,641] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-14 07:08:40,641] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-14 07:08:40,641] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-14 07:08:40,641] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-14 07:08:40,641] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f05bcd1bcd0>
[2023-08-14 07:08:40,641] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-14 07:08:40,641] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-14 07:08:40,641] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-14 07:08:40,641] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-14 07:08:40,641] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-14 07:08:40,641] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-14 07:08:40,641] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-14 07:08:40,641] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-14 07:08:40,641] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-14 07:08:40,641] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-14 07:08:40,641] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-14 07:08:40,641] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-14 07:08:40,641] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-14 07:08:40,641] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-14 07:08:40,641] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-14 07:08:40,641] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-14 07:08:40,641] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-14 07:08:40,641] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-14 07:08:40,641] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-14 07:08:40,642] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-14 07:08:40,642] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-14 07:08:40,642] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-14 07:08:40,642] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.5804920196533203 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                                           | 0/50 [00:00<?, ?it/s]############### Example ###############
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following multiple choice question.

### Demonstration:
Input: Mary had 89 stickers.  She used 3 large stickers on the front page of her journal and 7 stickers each to 6 other pages of her journal. How many stickers does Mary have remaining?
Answer: 44

Input: Zach is saving his money to buy a brand new bike that costs $100.  His weekly allowance is $5.  His parent will pay him an extra $10 to mow the lawn.  His neighbor will pay him $7 per hour to babysit their son.  He has already saved up $65.  He'll receive his allowance on Friday and he's planning on babysitting for 2 hours this Saturday after he mows the lawn.  How much more money does Zach need to earn before he can buy the bike?
Answer: 6

Input: Mark has kangaroos and goats.  Kangaroos have two legs and goats have four legs.  If he has 23 kangaroos and three times as many goats as kangaroos what is the total number of legs of all his animals?
Answer: 322

Input: Josh’s mom gives him $20 to go shopping at the mall. He buys a hat for $10 and a pencil for $2. Then he buys four cookies. If each cookie costs $1.25, how much money does Josh have left?
Answer: 3

Input: George's bowling team is one round away from breaking the league record for most points scored in a season. The old record is an average score per player of 287 per round. Each team has 4 players and there are 10 rounds in the season. Through the first 9 rounds, his team has scored a total of 10,440. How many points less than the current league record per game average is the minimum average they need to score, per player, in the final round to tie the league record?
Answer: 27

Input: Max was doing homework in three different subjects. It took him 20 minutes to finish tasks from biology and two times more time to finish history. Geography took him the most time, three times more than history. How much time did Max spend on doing his homework?
Answer: 180

Input: Sophia ate 1/6 of her pie and she put the rest on the fridge. If the pie left in the fridge weighs 1200 grams, how many grams did Sophia eat?
Answer: 240

Input: Sarah, Mary, and Tuan decided to go to the restaurant for a meal. They decided to split the cost of the meal evenly. If the total price of the meal comes to $67 and they have a coupon for $4, how much does each person need to contribute to the bill?
Answer: 21

Input: Tom's brother is 4 times as old as Tom's dog. If in 6 years, Tom's brother will be 30 years, how old is Tom's dog going to be in six years?
Answer: 12

Input: There are 50 children at the party. Three-fifths of them are boys. How many of the children are girls?
Answer: 20

Input: Gail has some bills in her wallet which amount to $100. She has four $5 bills and three $20 bills, and the rest are $10 bills. How many $10 bills are in her wallet?
Answer: 2

Input: A 220-liter barrel has a small leak. It lost 10% of its contents before anyone noticed. How many liters are left in the barrel?
Answer: 198

Input: Markese earned 5 fewer dollars than Evan. Together they earned $37. How many dollars did Markese earn? Use E to represent how many dollars Evan earned.
Answer: 16

Input: Lou Senior took 3 cookies out of the cookie jar and ate them.  Since he didn't get caught by his wife, he went back the next day and took another 3 cookies out of the jar.  But after eating just one of the cookies, he felt guilty about it and put the other two cookies back.  His son, Louie Junior saw that his Dad was eating cookies.  So, Louie Junior took seven cookies out of the jar and hid them in his bedroom for later.  The next morning, Debra, Lou's wife looked into the cookie jar and reacted by accusing her husband of eating half of the cookies out of the cookie jar.  How many cookies remained in the jar?
Answer: 11

Input: John had $200. He gave 3/8 of his money to his mother and 3/10 to his father. How much money did John have left?
Answer: 65

Input: Tonya has $150.00 on her credit card.  If she leaves any balance on her card at the end of the month, she is charged 20% interest.  If she makes a $50.00 payment on her card, what will be the new balance?
Answer: 120

Input: In her first term, Governor Sandoval gave twice as many commencement addresses as Governor Hawkins. Governor Sloan gave ten more commencement addresses than Governor Sandoval in the same amount of time. If Governor Sandoval gave 12 commencement addresses, how many commencement addresses did the three of them give altogether?
Answer: 40

Input: If Buzz bought a pizza with 78 slices at a restaurant and then decided to share it with the waiter in the ratio of 5:8, with Buzz's ratio being 5, what's twenty less the number of slices of pizza that the waiter ate?
Answer: 28

Input: Jolene and Phil have four children, each with the same birthday.  They gave birth to their first child exactly 15 years ago.  They gave birth to their second child exactly one year after the birth of their first child.  They gave birth to their third child on the fourth birthday of their second child. Two years after the birth of their third child, they gave birth to their fourth child.  How old, in years, is their fourth child?
Answer: 8

Input: Each purple book has 230 pages. Each orange book contains 510 pages. Mirella read 5 purple books and 4 orange books. How many more orange pages did she read than purple pages?
Answer: 890

Input: Isabella has $45 more than Sam but only $15 more than Giselle. If Giselle has $120, calculate the total amount of money each shopper will receive if Isabella, Sam, and Giselle donate the money to three shoppers at their local town's supermarket who then decides to share it equally.
Answer: 115

Input: It takes 40 minutes to freeze ice cubes and 3 minutes per smoothie to turn them into smoothies once they're frozen. How long does it take to make 5 smoothies?
Answer: 55

Input: Belle eats 4 dog biscuits and 2 rawhide bones every evening. If each rawhide bone is $1, and each dog biscuit is $0.25, then how much does it cost, in dollars, to feed Belle these treats for a week?
Answer: 21

Input: There are 10 6-ounces of glasses that are only 4/5 full of water. How many ounces of water are needed to fill to the brim all those 10 glasses?
Answer: 12

### Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid

### Response:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o24-tgsm8k-s1-rFalse
Loading extension module utils...
Time to load utils op: 0.5045106410980225 seconds
Loading extension module utils...
Time to load utils op: 0.6047601699829102 seconds
Loading extension module utils...
Time to load utils op: 0.6074223518371582 seconds
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Evaluating commonsenseqa :   0%|                                                           | 0/50 [00:05<?, ?it/s]
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 4120312) of binary: /home/ylu130/.conda/envs/distllm/bin/python
Traceback (most recent call last):
  File "/home/ylu130/.conda/envs/distllm/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 345, in wrapper
    return f(*args, **kwargs)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 761, in main
    run(args)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 752, in run
    elastic_launch(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 131, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 245, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
/home/ylu130/workspace/in-context-generalization/inference.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2023-08-14_07:08:50
  host      : ia1.wse.jhu.edu
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 4120313)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2023-08-14_07:08:50
  host      : ia1.wse.jhu.edu
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 4120314)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2023-08-14_07:08:50
  host      : ia1.wse.jhu.edu
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 4120315)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2023-08-14_07:08:50
  host      : ia1.wse.jhu.edu
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 4120312)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name gsm8k --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/out-domain/o25-tgsm8k-s1-rFalse --seed 1 --num-out-domain 25
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date![nltk_data]   Package punkt is already up-to-date!

[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-14 07:08:53,767] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/out-domain/o25-tgsm8k-s1-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 25
  out_domain_data_name ......... gsm8k
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o25-tgsm8k-s1-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 1
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                    | 0/9741 [00:00<?, ?it/s]  0%|▏                                                                         | 17/9741 [00:00<01:00, 161.57it/s]  0%|▎                                                                         | 34/9741 [00:00<00:59, 161.98it/s]  1%|▍                                                                         | 51/9741 [00:00<00:59, 162.24it/s]  1%|▌                                                                         | 68/9741 [00:00<00:59, 162.37it/s]  1%|▋                                                                         | 85/9741 [00:00<00:59, 162.51it/s]  1%|▊                                                                        | 102/9741 [00:00<01:00, 160.07it/s]  1%|▉                                                                        | 119/9741 [00:00<00:59, 160.79it/s]  1%|█                                                                        | 136/9741 [00:00<00:59, 161.40it/s]  2%|█▏                                                                       | 153/9741 [00:00<00:59, 161.81it/s]  2%|█▎                                                                       | 170/9741 [00:01<00:59, 162.04it/s]  2%|█▍                                                                       | 187/9741 [00:01<00:58, 162.02it/s]  2%|█▌                                                                       | 204/9741 [00:01<00:59, 160.76it/s]  2%|█▋                                                                       | 221/9741 [00:01<00:59, 161.24it/s]  2%|█▊                                                                       | 238/9741 [00:01<00:58, 161.53it/s]  3%|█▉                                                                       | 255/9741 [00:01<00:58, 161.73it/s]  3%|██                                                                       | 272/9741 [00:01<00:59, 159.71it/s]  3%|██▏                                                                      | 289/9741 [00:01<00:58, 160.23it/s]  3%|██▎                                                                      | 306/9741 [00:01<00:58, 160.92it/s]  3%|██▍                                                                      | 323/9741 [00:02<00:58, 161.18it/s]  3%|██▌                                                                      | 340/9741 [00:02<00:58, 160.40it/s]  4%|██▋                                                                      | 357/9741 [00:02<00:58, 160.87it/s]  4%|██▊                                                                      | 374/9741 [00:02<00:58, 161.29it/s]  4%|██▉                                                                      | 391/9741 [00:02<00:57, 161.72it/s]  4%|███                                                                      | 408/9741 [00:02<00:57, 161.80it/s]  4%|███▏                                                                     | 425/9741 [00:02<00:57, 161.47it/s]  5%|███▎                                                                     | 442/9741 [00:02<00:58, 159.52it/s]  5%|███▍                                                                     | 459/9741 [00:02<00:57, 160.33it/s]  5%|███▌                                                                     | 476/9741 [00:02<00:57, 160.67it/s]  5%|███▋                                                                     | 493/9741 [00:03<00:57, 161.04it/s]  5%|███▊                                                                     | 510/9741 [00:03<00:57, 161.37it/s]  5%|███▉                                                                     | 527/9741 [00:03<00:57, 161.58it/s]  6%|████                                                                     | 544/9741 [00:03<00:56, 161.83it/s]  6%|████▏                                                                    | 561/9741 [00:03<00:56, 161.75it/s]  6%|████▎                                                                    | 578/9741 [00:03<00:56, 161.80it/s]  6%|████▍                                                                    | 595/9741 [00:03<00:56, 161.83it/s]  6%|████▌                                                                    | 612/9741 [00:03<00:56, 161.68it/s]  6%|████▋                                                                    | 631/9741 [00:03<00:54, 168.07it/s]  7%|████▉                                                                    | 655/9741 [00:04<00:48, 186.85it/s]  7%|█████                                                                    | 680/9741 [00:04<00:44, 203.39it/s]  7%|█████▎                                                                   | 705/9741 [00:04<00:41, 215.89it/s]  7%|█████▍                                                                   | 730/9741 [00:04<00:40, 224.82it/s]  8%|█████▋                                                                   | 755/9741 [00:04<00:38, 231.30it/s]  8%|█████▊                                                                   | 780/9741 [00:04<00:37, 235.98it/s]  8%|██████                                                                   | 805/9741 [00:04<00:37, 239.17it/s]  9%|██████▏                                                                  | 830/9741 [00:04<00:36, 241.37it/s]  9%|██████▍                                                                  | 855/9741 [00:04<00:36, 243.08it/s]  9%|██████▌                                                                  | 880/9741 [00:04<00:36, 244.21it/s]  9%|██████▊                                                                  | 905/9741 [00:05<00:36, 242.83it/s] 10%|██████▉                                                                  | 930/9741 [00:05<00:36, 243.90it/s] 10%|███████▏                                                                 | 955/9741 [00:05<00:36, 242.99it/s] 10%|███████▎                                                                 | 980/9741 [00:05<00:36, 242.64it/s] 10%|███████▍                                                                | 1005/9741 [00:05<00:35, 242.68it/s] 11%|███████▌                                                                | 1030/9741 [00:05<00:35, 243.91it/s] 11%|███████▊                                                                | 1055/9741 [00:05<00:35, 244.54it/s] 11%|███████▉                                                                | 1080/9741 [00:05<00:35, 245.33it/s] 11%|████████▏                                                               | 1105/9741 [00:05<00:35, 245.63it/s] 12%|████████▎                                                               | 1130/9741 [00:05<00:35, 243.81it/s] 12%|████████▌                                                               | 1155/9741 [00:06<00:35, 244.58it/s] 12%|████████▋                                                               | 1180/9741 [00:06<00:34, 245.04it/s] 12%|████████▉                                                               | 1205/9741 [00:06<00:34, 245.21it/s] 13%|█████████                                                               | 1230/9741 [00:06<00:34, 245.39it/s] 13%|█████████▎                                                              | 1255/9741 [00:06<00:34, 245.65it/s] 13%|█████████▍                                                              | 1280/9741 [00:06<00:34, 242.06it/s] 13%|█████████▋                                                              | 1305/9741 [00:06<00:35, 240.82it/s] 14%|█████████▊                                                              | 1330/9741 [00:06<00:34, 242.13it/s] 14%|██████████                                                              | 1355/9741 [00:06<00:34, 239.65it/s] 14%|██████████▏                                                             | 1380/9741 [00:06<00:34, 241.37it/s] 14%|██████████▍                                                             | 1405/9741 [00:07<00:34, 242.57it/s] 15%|██████████▌                                                             | 1430/9741 [00:07<00:34, 243.55it/s] 15%|██████████▊                                                             | 1455/9741 [00:07<00:33, 244.16it/s] 15%|██████████▉                                                             | 1480/9741 [00:07<00:33, 244.70it/s] 15%|███████████                                                             | 1505/9741 [00:07<00:33, 244.71it/s] 16%|███████████▎                                                            | 1530/9741 [00:07<00:33, 244.50it/s] 16%|███████████▍                                                            | 1555/9741 [00:07<00:33, 244.47it/s] 16%|███████████▋                                                            | 1580/9741 [00:07<00:33, 242.00it/s] 16%|███████████▊                                                            | 1605/9741 [00:07<00:33, 242.53it/s] 17%|████████████                                                            | 1630/9741 [00:07<00:33, 243.25it/s] 17%|████████████▏                                                           | 1655/9741 [00:08<00:33, 244.00it/s] 17%|████████████▍                                                           | 1680/9741 [00:08<00:32, 244.43it/s] 18%|████████████▌                                                           | 1705/9741 [00:08<00:32, 244.83it/s] 18%|████████████▊                                                           | 1730/9741 [00:08<00:32, 245.08it/s] 18%|████████████▉                                                           | 1755/9741 [00:08<00:32, 245.28it/s] 18%|█████████████▏                                                          | 1780/9741 [00:08<00:32, 245.26it/s] 19%|█████████████▎                                                          | 1805/9741 [00:08<00:36, 220.05it/s] 19%|█████████████▌                                                          | 1830/9741 [00:08<00:34, 226.48it/s] 19%|█████████████▋                                                          | 1855/9741 [00:08<00:34, 230.73it/s] 19%|█████████████▉                                                          | 1880/9741 [00:09<00:33, 234.28it/s] 20%|██████████████                                                          | 1904/9741 [00:09<00:33, 235.47it/s] 20%|██████████████▎                                                         | 1929/9741 [00:09<00:32, 238.05it/s] 20%|██████████████▍                                                         | 1954/9741 [00:09<00:32, 240.06it/s] 20%|██████████████▋                                                         | 1979/9741 [00:09<00:32, 241.75it/s] 21%|██████████████▊                                                         | 2004/9741 [00:09<00:31, 242.11it/s] 21%|██████████████▉                                                         | 2029/9741 [00:09<00:32, 240.47it/s] 21%|███████████████▏                                                        | 2054/9741 [00:09<00:31, 241.72it/s] 21%|███████████████▎                                                        | 2079/9741 [00:09<00:31, 242.74it/s] 22%|███████████████▌                                                        | 2104/9741 [00:09<00:31, 243.39it/s] 22%|███████████████▋                                                        | 2129/9741 [00:10<00:31, 243.23it/s] 22%|███████████████▉                                                        | 2154/9741 [00:10<00:31, 242.77it/s] 22%|████████████████                                                        | 2179/9741 [00:10<00:31, 241.36it/s] 23%|████████████████▎                                                       | 2204/9741 [00:10<00:31, 242.52it/s] 23%|████████████████▍                                                       | 2229/9741 [00:10<00:30, 243.40it/s] 23%|████████████████▋                                                       | 2254/9741 [00:10<00:30, 241.68it/s] 23%|████████████████▊                                                       | 2279/9741 [00:10<00:30, 242.79it/s] 24%|█████████████████                                                       | 2304/9741 [00:10<00:30, 243.65it/s] 24%|█████████████████▏                                                      | 2329/9741 [00:10<00:30, 243.98it/s] 24%|█████████████████▍                                                      | 2354/9741 [00:11<00:30, 244.31it/s] 24%|█████████████████▌                                                      | 2379/9741 [00:11<00:30, 244.71it/s] 25%|█████████████████▊                                                      | 2404/9741 [00:11<00:29, 244.92it/s] 25%|█████████████████▉                                                      | 2429/9741 [00:11<00:30, 243.14it/s] 25%|██████████████████▏                                                     | 2454/9741 [00:11<00:30, 242.85it/s] 25%|██████████████████▎                                                     | 2479/9741 [00:11<00:30, 241.37it/s] 26%|██████████████████▌                                                     | 2504/9741 [00:11<00:29, 241.94it/s] 26%|██████████████████▋                                                     | 2529/9741 [00:11<00:29, 242.74it/s] 26%|██████████████████▉                                                     | 2554/9741 [00:11<00:29, 243.23it/s] 26%|███████████████████                                                     | 2579/9741 [00:11<00:29, 243.66it/s] 27%|███████████████████▏                                                    | 2604/9741 [00:12<00:29, 243.89it/s] 27%|███████████████████▍                                                    | 2629/9741 [00:12<00:29, 244.11it/s] 27%|███████████████████▌                                                    | 2654/9741 [00:12<00:28, 244.43it/s] 28%|███████████████████▊                                                    | 2679/9741 [00:12<00:28, 244.55it/s] 28%|███████████████████▉                                                    | 2704/9741 [00:12<00:29, 242.34it/s] 28%|████████████████████▏                                                   | 2729/9741 [00:12<00:28, 242.92it/s] 28%|████████████████████▎                                                   | 2754/9741 [00:12<00:28, 243.61it/s] 29%|████████████████████▌                                                   | 2779/9741 [00:12<00:28, 243.88it/s] 29%|████████████████████▋                                                   | 2804/9741 [00:12<00:28, 244.19it/s] 29%|████████████████████▉                                                   | 2829/9741 [00:12<00:28, 244.01it/s] 29%|█████████████████████                                                   | 2854/9741 [00:13<00:28, 244.49it/s] 30%|█████████████████████▎                                                  | 2879/9741 [00:13<00:28, 244.57it/s] 30%|█████████████████████▍                                                  | 2904/9741 [00:13<00:28, 243.65it/s] 30%|█████████████████████▋                                                  | 2929/9741 [00:13<00:28, 241.76it/s] 30%|█████████████████████▊                                                  | 2954/9741 [00:13<00:27, 242.48it/s] 31%|██████████████████████                                                  | 2979/9741 [00:13<00:27, 243.42it/s] 31%|██████████████████████▏                                                 | 3004/9741 [00:13<00:27, 243.52it/s] 31%|██████████████████████▍                                                 | 3029/9741 [00:13<00:27, 244.01it/s] 31%|██████████████████████▌                                                 | 3054/9741 [00:13<00:27, 244.24it/s] 32%|██████████████████████▊                                                 | 3079/9741 [00:13<00:27, 244.55it/s] 32%|██████████████████████▉                                                 | 3104/9741 [00:14<00:27, 244.83it/s] 32%|███████████████████████▏                                                | 3129/9741 [00:14<00:26, 244.95it/s] 32%|███████████████████████▎                                                | 3154/9741 [00:14<00:27, 242.95it/s] 33%|███████████████████████▍                                                | 3179/9741 [00:14<00:26, 243.71it/s] 33%|███████████████████████▋                                                | 3204/9741 [00:14<00:26, 244.21it/s] 33%|███████████████████████▊                                                | 3229/9741 [00:14<00:26, 244.55it/s] 33%|████████████████████████                                                | 3254/9741 [00:14<00:26, 243.77it/s] 34%|████████████████████████▏                                               | 3279/9741 [00:14<00:26, 244.09it/s] 34%|████████████████████████▍                                               | 3304/9741 [00:14<00:26, 244.40it/s] 34%|████████████████████████▌                                               | 3329/9741 [00:15<00:26, 244.43it/s] 34%|████████████████████████▊                                               | 3354/9741 [00:15<00:26, 244.63it/s] 35%|████████████████████████▉                                               | 3379/9741 [00:15<00:26, 242.68it/s] 35%|█████████████████████████▏                                              | 3404/9741 [00:15<00:26, 243.44it/s] 35%|█████████████████████████▎                                              | 3429/9741 [00:15<00:25, 244.00it/s] 35%|█████████████████████████▌                                              | 3454/9741 [00:15<00:25, 242.17it/s] 36%|█████████████████████████▋                                              | 3479/9741 [00:15<00:25, 243.06it/s] 36%|█████████████████████████▉                                              | 3504/9741 [00:15<00:25, 243.23it/s] 36%|██████████████████████████                                              | 3529/9741 [00:15<00:25, 243.82it/s] 36%|██████████████████████████▎                                             | 3554/9741 [00:15<00:25, 244.23it/s] 37%|██████████████████████████▍                                             | 3579/9741 [00:16<00:25, 244.37it/s] 37%|██████████████████████████▋                                             | 3604/9741 [00:16<00:25, 242.42it/s] 37%|██████████████████████████▊                                             | 3629/9741 [00:16<00:25, 243.21it/s] 38%|███████████████████████████                                             | 3654/9741 [00:16<00:25, 241.57it/s] 38%|███████████████████████████▏                                            | 3679/9741 [00:16<00:24, 242.49it/s] 38%|███████████████████████████▍                                            | 3704/9741 [00:16<00:24, 243.39it/s] 38%|███████████████████████████▌                                            | 3729/9741 [00:16<00:24, 243.79it/s] 39%|███████████████████████████▋                                            | 3754/9741 [00:16<00:24, 244.04it/s] 39%|███████████████████████████▉                                            | 3779/9741 [00:16<00:24, 244.31it/s] 39%|████████████████████████████                                            | 3804/9741 [00:16<00:24, 244.50it/s] 39%|████████████████████████████▎                                           | 3829/9741 [00:17<00:24, 244.67it/s] 40%|████████████████████████████▍                                           | 3854/9741 [00:17<00:24, 242.71it/s] 40%|████████████████████████████▋                                           | 3879/9741 [00:17<00:24, 243.53it/s] 40%|████████████████████████████▊                                           | 3904/9741 [00:17<00:23, 244.15it/s] 40%|█████████████████████████████                                           | 3929/9741 [00:17<00:23, 244.28it/s] 41%|█████████████████████████████▏                                          | 3954/9741 [00:17<00:23, 244.48it/s] 41%|█████████████████████████████▍                                          | 3979/9741 [00:17<00:23, 243.76it/s] 41%|█████████████████████████████▌                                          | 4004/9741 [00:17<00:23, 244.34it/s] 41%|█████████████████████████████▊                                          | 4029/9741 [00:17<00:23, 244.52it/s] 42%|█████████████████████████████▉                                          | 4054/9741 [00:17<00:23, 244.72it/s] 42%|██████████████████████████████▏                                         | 4079/9741 [00:18<00:23, 240.66it/s] 42%|██████████████████████████████▎                                         | 4104/9741 [00:18<00:23, 241.68it/s] 42%|██████████████████████████████▌                                         | 4129/9741 [00:18<00:23, 242.67it/s] 43%|██████████████████████████████▋                                         | 4154/9741 [00:18<00:22, 243.29it/s] 43%|██████████████████████████████▉                                         | 4179/9741 [00:18<00:22, 243.89it/s] 43%|███████████████████████████████                                         | 4204/9741 [00:18<00:22, 244.10it/s] 43%|███████████████████████████████▎                                        | 4229/9741 [00:18<00:22, 244.20it/s] 44%|███████████████████████████████▍                                        | 4254/9741 [00:18<00:22, 244.54it/s] 44%|███████████████████████████████▋                                        | 4279/9741 [00:18<00:22, 244.65it/s] 44%|███████████████████████████████▊                                        | 4304/9741 [00:19<00:22, 242.88it/s] 44%|███████████████████████████████▉                                        | 4329/9741 [00:19<00:22, 243.58it/s] 45%|████████████████████████████████▏                                       | 4354/9741 [00:19<00:22, 243.99it/s] 45%|████████████████████████████████▎                                       | 4379/9741 [00:19<00:21, 244.40it/s] 45%|████████████████████████████████▌                                       | 4404/9741 [00:19<00:21, 244.59it/s] 45%|████████████████████████████████▋                                       | 4429/9741 [00:19<00:21, 244.63it/s] 46%|████████████████████████████████▉                                       | 4454/9741 [00:19<00:21, 244.77it/s] 46%|█████████████████████████████████                                       | 4479/9741 [00:19<00:21, 242.45it/s] 46%|█████████████████████████████████▎                                      | 4504/9741 [00:19<00:21, 243.20it/s] 46%|█████████████████████████████████▍                                      | 4529/9741 [00:19<00:24, 216.05it/s] 47%|█████████████████████████████████▋                                      | 4554/9741 [00:20<00:23, 224.03it/s] 47%|█████████████████████████████████▊                                      | 4579/9741 [00:20<00:22, 229.93it/s] 47%|██████████████████████████████████                                      | 4604/9741 [00:20<00:21, 234.39it/s] 48%|██████████████████████████████████▏                                     | 4629/9741 [00:20<00:21, 237.60it/s] 48%|██████████████████████████████████▍                                     | 4654/9741 [00:20<00:21, 239.95it/s] 48%|██████████████████████████████████▌                                     | 4679/9741 [00:20<00:20, 241.50it/s] 48%|██████████████████████████████████▊                                     | 4704/9741 [00:20<00:20, 242.54it/s] 49%|██████████████████████████████████▉                                     | 4729/9741 [00:20<00:20, 243.16it/s] 49%|███████████████████████████████████▏                                    | 4754/9741 [00:21<00:30, 162.26it/s] 49%|███████████████████████████████████▎                                    | 4779/9741 [00:21<00:27, 180.58it/s] 49%|███████████████████████████████████▌                                    | 4804/9741 [00:21<00:25, 196.06it/s] 50%|███████████████████████████████████▋                                    | 4829/9741 [00:21<00:23, 208.55it/s] 50%|███████████████████████████████████▊                                    | 4853/9741 [00:21<00:22, 216.25it/s] 50%|████████████████████████████████████                                    | 4878/9741 [00:21<00:21, 224.09it/s] 50%|████████████████████████████████████▏                                   | 4903/9741 [00:21<00:21, 229.49it/s] 51%|████████████████████████████████████▍                                   | 4928/9741 [00:21<00:20, 233.83it/s] 51%|████████████████████████████████████▌                                   | 4952/9741 [00:21<00:20, 235.11it/s] 51%|████████████████████████████████████▊                                   | 4977/9741 [00:21<00:20, 238.06it/s] 51%|████████████████████████████████████▉                                   | 5002/9741 [00:22<00:19, 240.02it/s] 52%|█████████████████████████████████████▏                                  | 5027/9741 [00:22<00:19, 241.21it/s] 52%|█████████████████████████████████████▎                                  | 5052/9741 [00:22<00:19, 242.35it/s] 52%|█████████████████████████████████████▌                                  | 5077/9741 [00:22<00:19, 243.15it/s] 52%|█████████████████████████████████████▋                                  | 5102/9741 [00:22<00:19, 243.73it/s] 53%|█████████████████████████████████████▉                                  | 5127/9741 [00:22<00:18, 244.18it/s] 53%|██████████████████████████████████████                                  | 5152/9741 [00:22<00:18, 244.48it/s] 53%|██████████████████████████████████████▎                                 | 5177/9741 [00:22<00:18, 242.53it/s] 53%|██████████████████████████████████████▍                                 | 5202/9741 [00:22<00:18, 243.22it/s] 54%|██████████████████████████████████████▋                                 | 5227/9741 [00:23<00:18, 243.66it/s] 54%|██████████████████████████████████████▊                                 | 5252/9741 [00:23<00:18, 242.07it/s] 54%|███████████████████████████████████████                                 | 5277/9741 [00:23<00:18, 242.50it/s] 54%|███████████████████████████████████████▏                                | 5302/9741 [00:23<00:18, 243.10it/s] 55%|███████████████████████████████████████▎                                | 5327/9741 [00:23<00:18, 243.53it/s] 55%|███████████████████████████████████████▌                                | 5352/9741 [00:23<00:17, 243.84it/s] 55%|███████████████████████████████████████▋                                | 5377/9741 [00:23<00:17, 244.18it/s] 55%|███████████████████████████████████████▉                                | 5402/9741 [00:23<00:17, 241.17it/s] 56%|████████████████████████████████████████                                | 5427/9741 [00:23<00:17, 242.20it/s] 56%|████████████████████████████████████████▎                               | 5452/9741 [00:23<00:17, 243.06it/s] 56%|████████████████████████████████████████▍                               | 5477/9741 [00:24<00:17, 244.14it/s] 56%|████████████████████████████████████████▋                               | 5503/9741 [00:24<00:17, 246.41it/s] 57%|████████████████████████████████████████▊                               | 5529/9741 [00:24<00:16, 248.06it/s] 57%|█████████████████████████████████████████                               | 5555/9741 [00:24<00:16, 249.27it/s] 57%|█████████████████████████████████████████▎                              | 5581/9741 [00:24<00:16, 249.88it/s] 58%|█████████████████████████████████████████▍                              | 5607/9741 [00:24<00:16, 250.17it/s] 58%|█████████████████████████████████████████▋                              | 5633/9741 [00:24<00:16, 248.73it/s] 58%|█████████████████████████████████████████▊                              | 5659/9741 [00:24<00:16, 249.51it/s] 58%|██████████████████████████████████████████                              | 5684/9741 [00:24<00:16, 247.47it/s] 59%|██████████████████████████████████████████▏                             | 5710/9741 [00:24<00:16, 248.50it/s] 59%|██████████████████████████████████████████▍                             | 5736/9741 [00:25<00:16, 249.14it/s] 59%|██████████████████████████████████████████▌                             | 5762/9741 [00:25<00:15, 249.80it/s] 59%|██████████████████████████████████████████▊                             | 5788/9741 [00:25<00:15, 250.38it/s] 60%|██████████████████████████████████████████▉                             | 5814/9741 [00:25<00:15, 250.76it/s] 60%|███████████████████████████████████████████▏                            | 5840/9741 [00:25<00:15, 250.74it/s] 60%|███████████████████████████████████████████▎                            | 5866/9741 [00:25<00:15, 249.03it/s] 60%|███████████████████████████████████████████▌                            | 5892/9741 [00:25<00:15, 249.63it/s] 61%|███████████████████████████████████████████▋                            | 5918/9741 [00:25<00:15, 250.07it/s] 61%|███████████████████████████████████████████▉                            | 5944/9741 [00:25<00:15, 250.60it/s] 61%|████████████████████████████████████████████▏                           | 5970/9741 [00:26<00:15, 251.20it/s] 62%|████████████████████████████████████████████▎                           | 5996/9741 [00:26<00:14, 251.40it/s] 62%|████████████████████████████████████████████▌                           | 6022/9741 [00:26<00:14, 251.43it/s] 62%|████████████████████████████████████████████▋                           | 6048/9741 [00:26<00:14, 251.65it/s] 62%|████████████████████████████████████████████▉                           | 6074/9741 [00:26<00:14, 251.58it/s] 63%|█████████████████████████████████████████████                           | 6100/9741 [00:26<00:14, 248.37it/s] 63%|█████████████████████████████████████████████▎                          | 6126/9741 [00:26<00:14, 248.97it/s] 63%|█████████████████████████████████████████████▍                          | 6152/9741 [00:26<00:14, 249.67it/s] 63%|█████████████████████████████████████████████▋                          | 6178/9741 [00:26<00:14, 250.39it/s] 64%|█████████████████████████████████████████████▊                          | 6204/9741 [00:26<00:14, 250.76it/s] 64%|██████████████████████████████████████████████                          | 6230/9741 [00:27<00:13, 250.89it/s] 64%|██████████████████████████████████████████████▏                         | 6256/9741 [00:27<00:13, 250.98it/s] 64%|██████████████████████████████████████████████▍                         | 6282/9741 [00:27<00:13, 251.03it/s] 65%|██████████████████████████████████████████████▋                         | 6308/9741 [00:27<00:13, 248.98it/s] 65%|██████████████████████████████████████████████▊                         | 6334/9741 [00:27<00:13, 249.72it/s] 65%|███████████████████████████████████████████████                         | 6360/9741 [00:27<00:13, 250.00it/s] 66%|███████████████████████████████████████████████▏                        | 6386/9741 [00:27<00:13, 250.54it/s] 66%|███████████████████████████████████████████████▍                        | 6412/9741 [00:27<00:13, 250.56it/s] 66%|███████████████████████████████████████████████▌                        | 6438/9741 [00:27<00:13, 250.97it/s] 66%|███████████████████████████████████████████████▊                        | 6464/9741 [00:27<00:13, 250.80it/s] 67%|███████████████████████████████████████████████▉                        | 6490/9741 [00:28<00:12, 250.77it/s] 67%|████████████████████████████████████████████████▏                       | 6516/9741 [00:28<00:12, 250.85it/s] 67%|████████████████████████████████████████████████▎                       | 6542/9741 [00:28<00:12, 249.02it/s] 67%|████████████████████████████████████████████████▌                       | 6568/9741 [00:28<00:12, 249.61it/s] 68%|████████████████████████████████████████████████▋                       | 6594/9741 [00:28<00:12, 250.02it/s] 68%|████████████████████████████████████████████████▉                       | 6620/9741 [00:28<00:12, 250.50it/s] 68%|█████████████████████████████████████████████████                       | 6646/9741 [00:28<00:12, 250.93it/s] 68%|█████████████████████████████████████████████████▎                      | 6672/9741 [00:28<00:12, 249.84it/s] 69%|█████████████████████████████████████████████████▌                      | 6698/9741 [00:28<00:12, 250.20it/s] 69%|█████████████████████████████████████████████████▋                      | 6724/9741 [00:29<00:12, 250.72it/s] 69%|█████████████████████████████████████████████████▉                      | 6750/9741 [00:29<00:11, 251.16it/s] 70%|██████████████████████████████████████████████████                      | 6776/9741 [00:29<00:11, 249.40it/s] 70%|██████████████████████████████████████████████████▎                     | 6802/9741 [00:29<00:11, 250.04it/s] 70%|██████████████████████████████████████████████████▍                     | 6828/9741 [00:29<00:11, 250.18it/s] 70%|██████████████████████████████████████████████████▋                     | 6854/9741 [00:29<00:11, 250.57it/s] 71%|██████████████████████████████████████████████████▊                     | 6880/9741 [00:29<00:11, 250.85it/s] 71%|███████████████████████████████████████████████████                     | 6906/9741 [00:29<00:11, 250.83it/s] 71%|███████████████████████████████████████████████████▏                    | 6932/9741 [00:29<00:11, 251.12it/s] 71%|███████████████████████████████████████████████████▍                    | 6958/9741 [00:29<00:11, 251.27it/s] 72%|███████████████████████████████████████████████████▌                    | 6984/9741 [00:30<00:10, 251.31it/s] 72%|███████████████████████████████████████████████████▊                    | 7010/9741 [00:30<00:10, 248.89it/s] 72%|████████████████████████████████████████████████████                    | 7036/9741 [00:30<00:10, 249.68it/s] 72%|████████████████████████████████████████████████████▏                   | 7062/9741 [00:30<00:10, 250.42it/s] 73%|████████████████████████████████████████████████████▍                   | 7088/9741 [00:30<00:10, 250.86it/s] 73%|████████████████████████████████████████████████████▌                   | 7114/9741 [00:30<00:10, 251.21it/s] 73%|████████████████████████████████████████████████████▊                   | 7140/9741 [00:30<00:10, 251.21it/s] 74%|████████████████████████████████████████████████████▉                   | 7166/9741 [00:30<00:10, 250.67it/s] 74%|█████████████████████████████████████████████████████▏                  | 7192/9741 [00:30<00:10, 250.93it/s] 74%|█████████████████████████████████████████████████████▎                  | 7218/9741 [00:30<00:10, 248.61it/s] 74%|█████████████████████████████████████████████████████▌                  | 7244/9741 [00:31<00:10, 249.33it/s] 75%|█████████████████████████████████████████████████████▋                  | 7270/9741 [00:31<00:09, 250.00it/s] 75%|█████████████████████████████████████████████████████▉                  | 7296/9741 [00:31<00:09, 250.44it/s] 75%|██████████████████████████████████████████████████████                  | 7322/9741 [00:31<00:09, 250.76it/s] 75%|██████████████████████████████████████████████████████▎                 | 7348/9741 [00:31<00:09, 251.18it/s] 76%|██████████████████████████████████████████████████████▌                 | 7374/9741 [00:31<00:09, 251.27it/s] 76%|██████████████████████████████████████████████████████▋                 | 7400/9741 [00:31<00:09, 251.22it/s] 76%|██████████████████████████████████████████████████████▉                 | 7426/9741 [00:31<00:09, 250.83it/s] 77%|███████████████████████████████████████████████████████                 | 7452/9741 [00:31<00:10, 224.04it/s] 77%|███████████████████████████████████████████████████████▎                | 7478/9741 [00:32<00:09, 231.50it/s] 77%|███████████████████████████████████████████████████████▍                | 7504/9741 [00:32<00:09, 237.13it/s] 77%|███████████████████████████████████████████████████████▋                | 7530/9741 [00:32<00:09, 241.01it/s] 78%|███████████████████████████████████████████████████████▊                | 7556/9741 [00:32<00:08, 244.05it/s] 78%|████████████████████████████████████████████████████████                | 7582/9741 [00:32<00:08, 246.07it/s] 78%|████████████████████████████████████████████████████████▏               | 7608/9741 [00:32<00:08, 247.74it/s] 78%|████████████████████████████████████████████████████████▍               | 7634/9741 [00:32<00:08, 248.79it/s] 79%|████████████████████████████████████████████████████████▌               | 7660/9741 [00:32<00:08, 249.38it/s] 79%|████████████████████████████████████████████████████████▊               | 7685/9741 [00:32<00:08, 247.60it/s] 79%|████████████████████████████████████████████████████████▉               | 7711/9741 [00:32<00:08, 248.91it/s] 79%|█████████████████████████████████████████████████████████▏              | 7737/9741 [00:33<00:08, 249.74it/s] 80%|█████████████████████████████████████████████████████████▎              | 7762/9741 [00:33<00:07, 249.46it/s] 80%|█████████████████████████████████████████████████████████▌              | 7788/9741 [00:33<00:07, 250.05it/s] 80%|█████████████████████████████████████████████████████████▊              | 7814/9741 [00:33<00:07, 250.46it/s] 80%|█████████████████████████████████████████████████████████▉              | 7840/9741 [00:33<00:07, 250.86it/s] 81%|██████████████████████████████████████████████████████████▏             | 7866/9741 [00:33<00:07, 250.95it/s] 81%|██████████████████████████████████████████████████████████▎             | 7892/9741 [00:33<00:07, 251.07it/s] 81%|██████████████████████████████████████████████████████████▌             | 7918/9741 [00:33<00:07, 249.15it/s] 82%|██████████████████████████████████████████████████████████▋             | 7944/9741 [00:33<00:07, 249.83it/s] 82%|██████████████████████████████████████████████████████████▉             | 7970/9741 [00:34<00:07, 250.36it/s] 82%|███████████████████████████████████████████████████████████             | 7996/9741 [00:34<00:06, 250.67it/s] 82%|███████████████████████████████████████████████████████████▎            | 8022/9741 [00:34<00:06, 250.95it/s] 83%|███████████████████████████████████████████████████████████▍            | 8048/9741 [00:34<00:06, 251.00it/s] 83%|███████████████████████████████████████████████████████████▋            | 8074/9741 [00:34<00:06, 251.00it/s] 83%|███████████████████████████████████████████████████████████▊            | 8100/9741 [00:34<00:06, 251.36it/s] 83%|████████████████████████████████████████████████████████████            | 8126/9741 [00:34<00:06, 249.65it/s] 84%|████████████████████████████████████████████████████████████▎           | 8152/9741 [00:34<00:06, 250.23it/s] 84%|████████████████████████████████████████████████████████████▍           | 8178/9741 [00:34<00:06, 250.50it/s] 84%|████████████████████████████████████████████████████████████▋           | 8204/9741 [00:34<00:06, 250.78it/s] 84%|████████████████████████████████████████████████████████████▊           | 8230/9741 [00:35<00:06, 251.05it/s] 85%|█████████████████████████████████████████████████████████████           | 8256/9741 [00:35<00:05, 251.22it/s] 85%|█████████████████████████████████████████████████████████████▏          | 8282/9741 [00:35<00:05, 251.13it/s] 85%|█████████████████████████████████████████████████████████████▍          | 8308/9741 [00:35<00:05, 250.71it/s] 86%|█████████████████████████████████████████████████████████████▌          | 8334/9741 [00:35<00:05, 251.03it/s] 86%|█████████████████████████████████████████████████████████████▊          | 8360/9741 [00:35<00:05, 248.92it/s] 86%|█████████████████████████████████████████████████████████████▉          | 8386/9741 [00:35<00:05, 249.67it/s] 86%|██████████████████████████████████████████████████████████████▏         | 8412/9741 [00:35<00:05, 249.97it/s] 87%|██████████████████████████████████████████████████████████████▎         | 8438/9741 [00:35<00:05, 250.59it/s] 87%|██████████████████████████████████████████████████████████████▌         | 8464/9741 [00:36<00:05, 250.74it/s] 87%|██████████████████████████████████████████████████████████████▊         | 8490/9741 [00:36<00:04, 250.95it/s] 87%|██████████████████████████████████████████████████████████████▉         | 8516/9741 [00:36<00:04, 251.11it/s] 88%|███████████████████████████████████████████████████████████████▏        | 8542/9741 [00:36<00:04, 251.05it/s] 88%|███████████████████████████████████████████████████████████████▎        | 8568/9741 [00:36<00:04, 251.13it/s] 88%|███████████████████████████████████████████████████████████████▌        | 8594/9741 [00:36<00:04, 249.09it/s] 88%|███████████████████████████████████████████████████████████████▋        | 8620/9741 [00:36<00:04, 249.60it/s] 89%|███████████████████████████████████████████████████████████████▉        | 8646/9741 [00:36<00:04, 250.12it/s] 89%|████████████████████████████████████████████████████████████████        | 8672/9741 [00:36<00:04, 250.36it/s] 89%|████████████████████████████████████████████████████████████████▎       | 8698/9741 [00:36<00:04, 250.75it/s] 90%|████████████████████████████████████████████████████████████████▍       | 8724/9741 [00:37<00:04, 250.97it/s] 90%|████████████████████████████████████████████████████████████████▋       | 8750/9741 [00:37<00:03, 250.99it/s] 90%|████████████████████████████████████████████████████████████████▊       | 8776/9741 [00:37<00:03, 251.05it/s] 90%|█████████████████████████████████████████████████████████████████       | 8802/9741 [00:37<00:03, 249.01it/s] 91%|█████████████████████████████████████████████████████████████████▎      | 8828/9741 [00:37<00:03, 249.63it/s] 91%|█████████████████████████████████████████████████████████████████▍      | 8853/9741 [00:37<00:03, 249.68it/s] 91%|█████████████████████████████████████████████████████████████████▋      | 8879/9741 [00:37<00:03, 250.31it/s] 91%|█████████████████████████████████████████████████████████████████▊      | 8905/9741 [00:37<00:03, 250.52it/s] 92%|██████████████████████████████████████████████████████████████████      | 8931/9741 [00:37<00:03, 250.67it/s] 92%|██████████████████████████████████████████████████████████████████▏     | 8957/9741 [00:37<00:03, 250.78it/s] 92%|██████████████████████████████████████████████████████████████████▍     | 8983/9741 [00:38<00:03, 250.73it/s] 92%|██████████████████████████████████████████████████████████████████▌     | 9009/9741 [00:38<00:02, 250.88it/s] 93%|██████████████████████████████████████████████████████████████████▊     | 9035/9741 [00:38<00:02, 248.95it/s] 93%|██████████████████████████████████████████████████████████████████▉     | 9061/9741 [00:38<00:02, 249.52it/s] 93%|███████████████████████████████████████████████████████████████████▏    | 9087/9741 [00:38<00:02, 249.92it/s] 94%|███████████████████████████████████████████████████████████████████▎    | 9113/9741 [00:38<00:02, 250.42it/s] 94%|███████████████████████████████████████████████████████████████████▌    | 9139/9741 [00:38<00:02, 250.78it/s] 94%|███████████████████████████████████████████████████████████████████▋    | 9165/9741 [00:38<00:02, 250.90it/s] 94%|███████████████████████████████████████████████████████████████████▉    | 9191/9741 [00:38<00:02, 251.24it/s] 95%|████████████████████████████████████████████████████████████████████▏   | 9217/9741 [00:39<00:02, 251.10it/s] 95%|████████████████████████████████████████████████████████████████████▎   | 9243/9741 [00:39<00:01, 251.28it/s] 95%|████████████████████████████████████████████████████████████████████▌   | 9269/9741 [00:39<00:01, 249.34it/s] 95%|████████████████████████████████████████████████████████████████████▋   | 9295/9741 [00:39<00:01, 249.82it/s] 96%|████████████████████████████████████████████████████████████████████▉   | 9321/9741 [00:39<00:01, 250.18it/s] 96%|█████████████████████████████████████████████████████████████████████   | 9347/9741 [00:39<00:01, 250.55it/s] 96%|█████████████████████████████████████████████████████████████████████▎  | 9373/9741 [00:39<00:01, 250.84it/s] 96%|█████████████████████████████████████████████████████████████████████▍  | 9399/9741 [00:39<00:01, 250.67it/s] 97%|█████████████████████████████████████████████████████████████████████▋  | 9425/9741 [00:39<00:01, 250.55it/s] 97%|█████████████████████████████████████████████████████████████████████▊  | 9451/9741 [00:39<00:01, 250.72it/s] 97%|██████████████████████████████████████████████████████████████████████  | 9477/9741 [00:40<00:01, 250.85it/s] 98%|██████████████████████████████████████████████████████████████████████▏ | 9503/9741 [00:40<00:00, 248.85it/s] 98%|██████████████████████████████████████████████████████████████████████▍ | 9529/9741 [00:40<00:00, 249.52it/s] 98%|██████████████████████████████████████████████████████████████████████▋ | 9555/9741 [00:40<00:00, 249.96it/s] 98%|██████████████████████████████████████████████████████████████████████▊ | 9581/9741 [00:40<00:00, 250.33it/s] 99%|███████████████████████████████████████████████████████████████████████ | 9607/9741 [00:40<00:00, 250.58it/s] 99%|███████████████████████████████████████████████████████████████████████▏| 9633/9741 [00:40<00:00, 250.78it/s] 99%|███████████████████████████████████████████████████████████████████████▍| 9659/9741 [00:40<00:00, 250.65it/s] 99%|███████████████████████████████████████████████████████████████████████▌| 9685/9741 [00:40<00:00, 250.68it/s]100%|███████████████████████████████████████████████████████████████████████▊| 9711/9741 [00:40<00:00, 248.50it/s]100%|███████████████████████████████████████████████████████████████████████▉| 9736/9741 [00:41<00:00, 248.80it/s]100%|████████████████████████████████████████████████████████████████████████| 9741/9741 [00:41<00:00, 236.96it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:11,  5.56s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:11,  5.59s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:11,  5.95s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:09<00:18,  9.08s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:11<00:05,  5.66s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:11<00:05,  5.51s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:12<00:06,  6.23s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:15<00:00,  4.86s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.04s/it]
Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:15<00:07,  7.57s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:16<00:00,  5.32s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:16<00:00,  5.40s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:18<00:00,  6.00s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:18<00:00,  6.03s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:20<00:00,  6.34s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:20<00:00,  6.82s/it]
[2023-08-14 07:10:33,298] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
[2023-08-14 07:10:43,479] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-14 07:10:43,480] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-14 07:10:43,481] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-14 07:10:43,481] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-14 07:10:43,481] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-14 07:10:43,481] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-14 07:10:43,481] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-14 07:10:43,481] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-14 07:10:43,481] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-14 07:10:43,481] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-14 07:10:43,481] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-14 07:10:43,481] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f69a273ffd0>
[2023-08-14 07:10:43,481] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-14 07:10:43,481] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-14 07:10:43,481] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-14 07:10:43,481] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-14 07:10:43,481] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-14 07:10:43,481] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-14 07:10:43,482] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-14 07:10:43,482] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-14 07:10:43,482] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-14 07:10:43,482] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-14 07:10:43,482] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-14 07:10:43,482] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-14 07:10:43,482] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-14 07:10:43,482] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-14 07:10:43,482] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-14 07:10:43,482] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-14 07:10:43,482] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-14 07:10:43,482] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-14 07:10:43,482] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-14 07:10:43,482] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-14 07:10:43,482] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-14 07:10:43,482] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-14 07:10:43,482] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-14 07:10:43,482] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-14 07:10:43,482] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-14 07:10:43,482] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-14 07:10:43,482] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-14 07:10:43,482] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-14 07:10:43,482] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-14 07:10:43,482] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-14 07:10:43,482] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-14 07:10:43,482] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-14 07:10:43,482] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f696fef2cd0>
[2023-08-14 07:10:43,482] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-14 07:10:43,482] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-14 07:10:43,482] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-14 07:10:43,482] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-14 07:10:43,482] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-14 07:10:43,482] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-14 07:10:43,482] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-14 07:10:43,482] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-14 07:10:43,482] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-14 07:10:43,482] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-14 07:10:43,483] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-14 07:10:43,483] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-14 07:10:43,483] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-14 07:10:43,483] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-14 07:10:43,483] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-14 07:10:43,483] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-14 07:10:43,483] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-14 07:10:43,483] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-14 07:10:43,483] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-14 07:10:43,483] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-14 07:10:43,483] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-14 07:10:43,483] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-14 07:10:43,483] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.6535565853118896 seconds
Loading extension module utils...
Time to load utils op: 0.5046188831329346 seconds
Loading extension module utils...
Time to load utils op: 0.6046557426452637 seconds
Loading extension module utils...
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Time to load utils op: 0.5063199996948242 seconds
Evaluating commonsenseqa :   0%|                                                           | 0/50 [00:00<?, ?it/s]############### Example ###############
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following multiple choice question.

### Demonstration:
Input: Mary had 89 stickers.  She used 3 large stickers on the front page of her journal and 7 stickers each to 6 other pages of her journal. How many stickers does Mary have remaining?
Answer: 44

Input: Zach is saving his money to buy a brand new bike that costs $100.  His weekly allowance is $5.  His parent will pay him an extra $10 to mow the lawn.  His neighbor will pay him $7 per hour to babysit their son.  He has already saved up $65.  He'll receive his allowance on Friday and he's planning on babysitting for 2 hours this Saturday after he mows the lawn.  How much more money does Zach need to earn before he can buy the bike?
Answer: 6

Input: Mark has kangaroos and goats.  Kangaroos have two legs and goats have four legs.  If he has 23 kangaroos and three times as many goats as kangaroos what is the total number of legs of all his animals?
Answer: 322

Input: Josh’s mom gives him $20 to go shopping at the mall. He buys a hat for $10 and a pencil for $2. Then he buys four cookies. If each cookie costs $1.25, how much money does Josh have left?
Answer: 3

Input: George's bowling team is one round away from breaking the league record for most points scored in a season. The old record is an average score per player of 287 per round. Each team has 4 players and there are 10 rounds in the season. Through the first 9 rounds, his team has scored a total of 10,440. How many points less than the current league record per game average is the minimum average they need to score, per player, in the final round to tie the league record?
Answer: 27

Input: Max was doing homework in three different subjects. It took him 20 minutes to finish tasks from biology and two times more time to finish history. Geography took him the most time, three times more than history. How much time did Max spend on doing his homework?
Answer: 180

Input: Sophia ate 1/6 of her pie and she put the rest on the fridge. If the pie left in the fridge weighs 1200 grams, how many grams did Sophia eat?
Answer: 240

Input: Sarah, Mary, and Tuan decided to go to the restaurant for a meal. They decided to split the cost of the meal evenly. If the total price of the meal comes to $67 and they have a coupon for $4, how much does each person need to contribute to the bill?
Answer: 21

Input: Tom's brother is 4 times as old as Tom's dog. If in 6 years, Tom's brother will be 30 years, how old is Tom's dog going to be in six years?
Answer: 12

Input: There are 50 children at the party. Three-fifths of them are boys. How many of the children are girls?
Answer: 20

Input: Gail has some bills in her wallet which amount to $100. She has four $5 bills and three $20 bills, and the rest are $10 bills. How many $10 bills are in her wallet?
Answer: 2

Input: A 220-liter barrel has a small leak. It lost 10% of its contents before anyone noticed. How many liters are left in the barrel?
Answer: 198

Input: Markese earned 5 fewer dollars than Evan. Together they earned $37. How many dollars did Markese earn? Use E to represent how many dollars Evan earned.
Answer: 16

Input: Lou Senior took 3 cookies out of the cookie jar and ate them.  Since he didn't get caught by his wife, he went back the next day and took another 3 cookies out of the jar.  But after eating just one of the cookies, he felt guilty about it and put the other two cookies back.  His son, Louie Junior saw that his Dad was eating cookies.  So, Louie Junior took seven cookies out of the jar and hid them in his bedroom for later.  The next morning, Debra, Lou's wife looked into the cookie jar and reacted by accusing her husband of eating half of the cookies out of the cookie jar.  How many cookies remained in the jar?
Answer: 11

Input: John had $200. He gave 3/8 of his money to his mother and 3/10 to his father. How much money did John have left?
Answer: 65

Input: Tonya has $150.00 on her credit card.  If she leaves any balance on her card at the end of the month, she is charged 20% interest.  If she makes a $50.00 payment on her card, what will be the new balance?
Answer: 120

Input: In her first term, Governor Sandoval gave twice as many commencement addresses as Governor Hawkins. Governor Sloan gave ten more commencement addresses than Governor Sandoval in the same amount of time. If Governor Sandoval gave 12 commencement addresses, how many commencement addresses did the three of them give altogether?
Answer: 40

Input: If Buzz bought a pizza with 78 slices at a restaurant and then decided to share it with the waiter in the ratio of 5:8, with Buzz's ratio being 5, what's twenty less the number of slices of pizza that the waiter ate?
Answer: 28

Input: Jolene and Phil have four children, each with the same birthday.  They gave birth to their first child exactly 15 years ago.  They gave birth to their second child exactly one year after the birth of their first child.  They gave birth to their third child on the fourth birthday of their second child. Two years after the birth of their third child, they gave birth to their fourth child.  How old, in years, is their fourth child?
Answer: 8

Input: Each purple book has 230 pages. Each orange book contains 510 pages. Mirella read 5 purple books and 4 orange books. How many more orange pages did she read than purple pages?
Answer: 890

Input: Isabella has $45 more than Sam but only $15 more than Giselle. If Giselle has $120, calculate the total amount of money each shopper will receive if Isabella, Sam, and Giselle donate the money to three shoppers at their local town's supermarket who then decides to share it equally.
Answer: 115

Input: It takes 40 minutes to freeze ice cubes and 3 minutes per smoothie to turn them into smoothies once they're frozen. How long does it take to make 5 smoothies?
Answer: 55

Input: Belle eats 4 dog biscuits and 2 rawhide bones every evening. If each rawhide bone is $1, and each dog biscuit is $0.25, then how much does it cost, in dollars, to feed Belle these treats for a week?
Answer: 21

Input: There are 10 6-ounces of glasses that are only 4/5 full of water. How many ounces of water are needed to fill to the brim all those 10 glasses?
Answer: 12

Input: Tony decided to rent a small cottage.  The master bedroom and bath totaled 500 sq ft.  The 2 guest bedrooms were 200 sq ft each.  And the kitchen, guest bath and living area totaled 600 sq ft.  If Tony spends $3,000 a month on rent, how much money is he spending per sq ft of house?
Answer: 2

### Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid

### Response:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o25-tgsm8k-s1-rFalse
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Evaluating commonsenseqa :   0%|                                                           | 0/50 [00:05<?, ?it/s]
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
Traceback (most recent call last):
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 125, in <module>
    main()
  File "/home/ylu130/workspace/in-context-generalization/inference.py", line 122, in main
    evaluate_main(args, tokenizer, model, dataset["test"], device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 139, in evaluate_main
    lm_loss, query_ids, response_ids, rest_ids = run_model(args, tokenizer, model, dataset, device)
  File "/home/ylu130/workspace/in-context-generalization/inference_main.py", line 116, in run_model
    gen_out = model.generate(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 1454, in generate
    return self.sample(
  File "/home/ylu130/workspace/in-context-generalization/transformers/src/transformers/generation/utils.py", line 2568, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 4121477 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 4121478 closing signal SIGTERM
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 4121476) of binary: /home/ylu130/.conda/envs/distllm/bin/python
Traceback (most recent call last):
  File "/home/ylu130/.conda/envs/distllm/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 345, in wrapper
    return f(*args, **kwargs)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 761, in main
    run(args)
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/run.py", line 752, in run
    elastic_launch(
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 131, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/ylu130/.conda/envs/distllm/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 245, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
/home/ylu130/workspace/in-context-generalization/inference.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2023-08-14_07:10:51
  host      : ia1.wse.jhu.edu
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 4121479)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2023-08-14_07:10:51
  host      : ia1.wse.jhu.edu
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 4121476)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name gsm8k --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/out-domain/o10-tgsm8k-s10-rFalse --seed 10 --num-out-domain 10
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-14 07:10:55,455] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/out-domain/o10-tgsm8k-s10-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 10
  out_domain_data_name ......... gsm8k
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o10-tgsm8k-s10-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 10
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                    | 0/9741 [00:00<?, ?it/s]  0%|▎                                                                         | 48/9741 [00:00<00:20, 476.17it/s]  1%|▋                                                                         | 97/9741 [00:00<00:20, 479.20it/s]  1%|█                                                                        | 146/9741 [00:00<00:19, 480.46it/s]  2%|█▍                                                                       | 195/9741 [00:00<00:19, 480.88it/s]  3%|█▊                                                                       | 244/9741 [00:00<00:19, 478.66it/s]  3%|██▏                                                                      | 293/9741 [00:00<00:19, 479.86it/s]  4%|██▌                                                                      | 342/9741 [00:00<00:19, 480.51it/s]  4%|██▉                                                                      | 391/9741 [00:00<00:19, 480.63it/s]  5%|███▎                                                                     | 440/9741 [00:00<00:19, 468.31it/s]  5%|███▋                                                                     | 488/9741 [00:01<00:19, 470.90it/s]  6%|████                                                                     | 536/9741 [00:01<00:19, 472.93it/s]  6%|████▍                                                                    | 584/9741 [00:01<00:19, 474.52it/s]  6%|████▋                                                                    | 632/9741 [00:01<00:19, 475.39it/s]  7%|█████                                                                    | 680/9741 [00:01<00:19, 474.20it/s]  7%|█████▍                                                                   | 728/9741 [00:01<00:18, 475.49it/s]  8%|█████▊                                                                   | 777/9741 [00:01<00:18, 477.01it/s]  8%|██████▏                                                                  | 826/9741 [00:01<00:18, 477.94it/s]  9%|██████▌                                                                  | 874/9741 [00:01<00:18, 478.34it/s]  9%|██████▉                                                                  | 922/9741 [00:01<00:18, 473.36it/s] 10%|███████▎                                                                 | 971/9741 [00:02<00:18, 478.14it/s] 11%|███████▋                                                                | 1044/9741 [00:02<00:15, 552.07it/s] 11%|████████▎                                                               | 1117/9741 [00:02<00:14, 602.63it/s] 12%|████████▊                                                               | 1190/9741 [00:02<00:13, 639.19it/s] 13%|█████████▎                                                              | 1263/9741 [00:02<00:12, 665.10it/s] 14%|█████████▊                                                              | 1335/9741 [00:02<00:12, 680.99it/s] 14%|██████████▍                                                             | 1408/9741 [00:02<00:12, 693.94it/s] 15%|██████████▉                                                             | 1481/9741 [00:02<00:11, 702.80it/s] 16%|███████████▍                                                            | 1554/9741 [00:02<00:11, 709.90it/s] 17%|████████████                                                            | 1626/9741 [00:02<00:11, 712.00it/s] 17%|████████████▌                                                           | 1699/9741 [00:03<00:11, 716.42it/s] 18%|█████████████                                                           | 1772/9741 [00:03<00:11, 719.09it/s] 19%|█████████████▋                                                          | 1844/9741 [00:03<00:11, 695.54it/s] 20%|██████████████▏                                                         | 1917/9741 [00:03<00:11, 703.48it/s] 20%|██████████████▋                                                         | 1990/9741 [00:03<00:10, 709.11it/s] 21%|███████████████▏                                                        | 2062/9741 [00:03<00:10, 710.74it/s] 22%|███████████████▊                                                        | 2134/9741 [00:03<00:10, 713.39it/s] 23%|████████████████▎                                                       | 2207/9741 [00:03<00:10, 715.88it/s] 23%|████████████████▊                                                       | 2279/9741 [00:03<00:10, 716.04it/s] 24%|█████████████████▍                                                      | 2352/9741 [00:03<00:10, 717.91it/s] 25%|█████████████████▉                                                      | 2425/9741 [00:04<00:10, 719.90it/s] 26%|██████████████████▍                                                     | 2498/9741 [00:04<00:10, 717.66it/s] 26%|███████████████████                                                     | 2571/9741 [00:04<00:09, 718.99it/s] 27%|███████████████████▌                                                    | 2644/9741 [00:04<00:09, 720.57it/s] 28%|████████████████████                                                    | 2717/9741 [00:04<00:09, 718.88it/s] 29%|████████████████████▌                                                   | 2789/9741 [00:04<00:09, 719.16it/s] 29%|█████████████████████▏                                                  | 2862/9741 [00:04<00:09, 720.77it/s] 30%|█████████████████████▋                                                  | 2935/9741 [00:04<00:09, 719.96it/s] 31%|██████████████████████▏                                                 | 3008/9741 [00:04<00:09, 720.99it/s] 32%|██████████████████████▊                                                 | 3081/9741 [00:04<00:09, 721.13it/s] 32%|███████████████████████▎                                                | 3154/9741 [00:05<00:09, 719.06it/s] 33%|███████████████████████▊                                                | 3227/9741 [00:05<00:09, 721.17it/s] 34%|████████████████████████▍                                               | 3300/9741 [00:05<00:08, 722.53it/s] 35%|████████████████████████▉                                               | 3373/9741 [00:05<00:08, 723.08it/s] 35%|█████████████████████████▍                                              | 3446/9741 [00:05<00:08, 720.56it/s] 36%|██████████████████████████                                              | 3519/9741 [00:05<00:08, 720.71it/s] 37%|██████████████████████████▌                                             | 3592/9741 [00:05<00:08, 721.23it/s] 38%|███████████████████████████                                             | 3665/9741 [00:05<00:08, 714.45it/s] 38%|███████████████████████████▋                                            | 3738/9741 [00:05<00:08, 717.35it/s] 39%|████████████████████████████▏                                           | 3811/9741 [00:05<00:08, 718.43it/s] 40%|████████████████████████████▋                                           | 3883/9741 [00:06<00:08, 717.15it/s] 41%|█████████████████████████████▏                                          | 3956/9741 [00:06<00:08, 718.27it/s] 41%|█████████████████████████████▊                                          | 4029/9741 [00:06<00:07, 719.78it/s] 42%|██████████████████████████████▎                                         | 4101/9741 [00:06<00:07, 718.25it/s] 43%|██████████████████████████████▊                                         | 4174/9741 [00:06<00:07, 719.38it/s] 44%|███████████████████████████████▍                                        | 4247/9741 [00:06<00:07, 719.94it/s] 44%|███████████████████████████████▉                                        | 4319/9741 [00:06<00:07, 717.50it/s] 45%|████████████████████████████████▍                                       | 4391/9741 [00:06<00:07, 717.66it/s] 46%|████████████████████████████████▉                                       | 4463/9741 [00:06<00:07, 718.15it/s] 47%|█████████████████████████████████▌                                      | 4535/9741 [00:07<00:07, 686.05it/s] 47%|██████████████████████████████████                                      | 4606/9741 [00:07<00:07, 690.23it/s] 48%|██████████████████████████████████▌                                     | 4679/9741 [00:07<00:07, 699.97it/s] 49%|███████████████████████████████████                                     | 4750/9741 [00:07<00:09, 515.05it/s] 50%|███████████████████████████████████▋                                    | 4823/9741 [00:07<00:08, 563.89it/s] 50%|████████████████████████████████████▏                                   | 4895/9741 [00:07<00:08, 603.00it/s] 51%|████████████████████████████████████▋                                   | 4967/9741 [00:07<00:07, 632.84it/s] 52%|█████████████████████████████████████▎                                  | 5040/9741 [00:07<00:07, 657.88it/s] 52%|█████████████████████████████████████▊                                  | 5113/9741 [00:07<00:06, 676.61it/s] 53%|██████████████████████████████████████▎                                 | 5185/9741 [00:08<00:06, 688.30it/s] 54%|██████████████████████████████████████▊                                 | 5258/9741 [00:08<00:06, 698.80it/s] 55%|███████████████████████████████████████▍                                | 5331/9741 [00:08<00:06, 705.92it/s] 55%|███████████████████████████████████████▉                                | 5403/9741 [00:08<00:06, 708.42it/s] 56%|████████████████████████████████████████▍                               | 5475/9741 [00:08<00:06, 707.70it/s] 57%|█████████████████████████████████████████                               | 5551/9741 [00:08<00:05, 721.33it/s] 58%|█████████████████████████████████████████▌                              | 5626/9741 [00:08<00:05, 728.28it/s] 59%|██████████████████████████████████████████▏                             | 5702/9741 [00:08<00:05, 736.46it/s] 59%|██████████████████████████████████████████▋                             | 5778/9741 [00:08<00:05, 742.31it/s] 60%|███████████████████████████████████████████▎                            | 5853/9741 [00:08<00:05, 743.08it/s] 61%|███████████████████████████████████████████▊                            | 5929/9741 [00:09<00:05, 746.52it/s] 62%|████████████████████████████████████████████▍                           | 6005/9741 [00:09<00:04, 748.87it/s] 62%|████████████████████████████████████████████▉                           | 6080/9741 [00:09<00:04, 746.69it/s] 63%|█████████████████████████████████████████████▍                          | 6155/9741 [00:09<00:04, 746.85it/s] 64%|██████████████████████████████████████████████                          | 6231/9741 [00:09<00:04, 747.98it/s] 65%|██████████████████████████████████████████████▌                         | 6306/9741 [00:09<00:04, 746.54it/s] 66%|███████████████████████████████████████████████▏                        | 6382/9741 [00:09<00:04, 748.96it/s] 66%|███████████████████████████████████████████████▋                        | 6457/9741 [00:09<00:04, 742.39it/s] 67%|████████████████████████████████████████████████▎                       | 6532/9741 [00:09<00:04, 743.99it/s] 68%|████████████████████████████████████████████████▊                       | 6607/9741 [00:09<00:04, 742.85it/s] 69%|█████████████████████████████████████████████████▍                      | 6683/9741 [00:10<00:04, 745.97it/s] 69%|█████████████████████████████████████████████████▉                      | 6758/9741 [00:10<00:03, 746.59it/s] 70%|██████████████████████████████████████████████████▌                     | 6834/9741 [00:10<00:03, 749.26it/s] 71%|███████████████████████████████████████████████████                     | 6910/9741 [00:10<00:03, 751.06it/s] 72%|███████████████████████████████████████████████████▋                    | 6986/9741 [00:10<00:03, 750.29it/s] 72%|████████████████████████████████████████████████████▏                   | 7062/9741 [00:10<00:03, 751.92it/s] 73%|████████████████████████████████████████████████████▊                   | 7138/9741 [00:10<00:03, 753.30it/s] 74%|█████████████████████████████████████████████████████▎                  | 7214/9741 [00:10<00:03, 751.43it/s] 75%|█████████████████████████████████████████████████████▉                  | 7290/9741 [00:10<00:03, 752.89it/s] 76%|██████████████████████████████████████████████████████▍                 | 7366/9741 [00:10<00:03, 753.82it/s] 76%|███████████████████████████████████████████████████████                 | 7442/9741 [00:11<00:03, 706.52it/s] 77%|███████████████████████████████████████████████████████▌                | 7517/9741 [00:11<00:03, 718.35it/s] 78%|████████████████████████████████████████████████████████                | 7593/9741 [00:11<00:02, 727.67it/s] 79%|████████████████████████████████████████████████████████▋               | 7668/9741 [00:11<00:02, 732.41it/s] 79%|█████████████████████████████████████████████████████████▏              | 7744/9741 [00:11<00:02, 738.49it/s] 80%|█████████████████████████████████████████████████████████▊              | 7820/9741 [00:11<00:02, 742.06it/s] 81%|██████████████████████████████████████████████████████████▎             | 7895/9741 [00:11<00:02, 743.03it/s] 82%|██████████████████████████████████████████████████████████▉             | 7971/9741 [00:11<00:02, 746.01it/s] 83%|███████████████████████████████████████████████████████████▍            | 8047/9741 [00:11<00:02, 747.21it/s] 83%|████████████████████████████████████████████████████████████            | 8122/9741 [00:12<00:02, 746.19it/s] 84%|████████████████████████████████████████████████████████████▌           | 8197/9741 [00:12<00:02, 746.78it/s] 85%|█████████████████████████████████████████████████████████████▏          | 8272/9741 [00:12<00:01, 747.23it/s] 86%|█████████████████████████████████████████████████████████████▋          | 8347/9741 [00:12<00:01, 742.84it/s] 86%|██████████████████████████████████████████████████████████████▎         | 8423/9741 [00:12<00:01, 745.21it/s] 87%|██████████████████████████████████████████████████████████████▊         | 8499/9741 [00:12<00:01, 746.86it/s] 88%|███████████████████████████████████████████████████████████████▎        | 8574/9741 [00:12<00:01, 745.18it/s] 89%|███████████████████████████████████████████████████████████████▉        | 8649/9741 [00:12<00:01, 746.30it/s] 90%|████████████████████████████████████████████████████████████████▍       | 8725/9741 [00:12<00:01, 747.48it/s] 90%|█████████████████████████████████████████████████████████████████       | 8800/9741 [00:12<00:01, 747.95it/s] 91%|█████████████████████████████████████████████████████████████████▌      | 8875/9741 [00:13<00:01, 746.41it/s] 92%|██████████████████████████████████████████████████████████████████▏     | 8951/9741 [00:13<00:01, 748.29it/s] 93%|██████████████████████████████████████████████████████████████████▋     | 9026/9741 [00:13<00:00, 748.63it/s] 93%|███████████████████████████████████████████████████████████████████▎    | 9101/9741 [00:13<00:00, 746.80it/s] 94%|███████████████████████████████████████████████████████████████████▊    | 9177/9741 [00:13<00:00, 747.97it/s] 95%|████████████████████████████████████████████████████████████████████▍   | 9252/9741 [00:13<00:00, 747.70it/s] 96%|████████████████████████████████████████████████████████████████████▉   | 9327/9741 [00:13<00:00, 746.47it/s] 97%|█████████████████████████████████████████████████████████████████████▌  | 9403/9741 [00:13<00:00, 747.79it/s] 97%|██████████████████████████████████████████████████████████████████████  | 9478/9741 [00:13<00:00, 747.84it/s] 98%|██████████████████████████████████████████████████████████████████████▌ | 9553/9741 [00:13<00:00, 746.22it/s] 99%|███████████████████████████████████████████████████████████████████████▏| 9628/9741 [00:14<00:00, 742.98it/s]100%|███████████████████████████████████████████████████████████████████████▋| 9703/9741 [00:14<00:00, 744.01it/s]100%|████████████████████████████████████████████████████████████████████████| 9741/9741 [00:14<00:00, 687.40it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.00s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:11,  5.52s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:11,  5.64s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:11,  5.86s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:09<00:04,  4.90s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.37s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.41s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:11<00:05,  5.77s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.39s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.54s/it]
[2023-08-14 07:12:00,608] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.72s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.91s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.81s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  5.00s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:16<00:00,  5.27s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:16<00:00,  5.41s/it]
[2023-08-14 07:12:15,733] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-14 07:12:15,734] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-14 07:12:15,735] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-14 07:12:15,735] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-14 07:12:15,735] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-14 07:12:15,735] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-14 07:12:15,736] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-14 07:12:15,736] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-14 07:12:15,736] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-14 07:12:15,736] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-14 07:12:15,736] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-14 07:12:15,736] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f238004ffd0>
[2023-08-14 07:12:15,736] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-14 07:12:15,736] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-14 07:12:15,736] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-14 07:12:15,736] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-14 07:12:15,736] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-14 07:12:15,736] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-14 07:12:15,736] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-14 07:12:15,736] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-14 07:12:15,736] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-14 07:12:15,736] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-14 07:12:15,736] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-14 07:12:15,736] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-14 07:12:15,736] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-14 07:12:15,736] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-14 07:12:15,736] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-14 07:12:15,736] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-14 07:12:15,736] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-14 07:12:15,736] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-14 07:12:15,736] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-14 07:12:15,736] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-14 07:12:15,736] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-14 07:12:15,736] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-14 07:12:15,736] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-14 07:12:15,736] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-14 07:12:15,736] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-14 07:12:15,736] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-14 07:12:15,736] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-14 07:12:15,736] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-14 07:12:15,737] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-14 07:12:15,737] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-14 07:12:15,737] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-14 07:12:15,737] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-14 07:12:15,737] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f2357181cd0>
[2023-08-14 07:12:15,737] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-14 07:12:15,737] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-14 07:12:15,737] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-14 07:12:15,737] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-14 07:12:15,737] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-14 07:12:15,737] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-14 07:12:15,737] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-14 07:12:15,737] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-14 07:12:15,737] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-14 07:12:15,737] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-14 07:12:15,737] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-14 07:12:15,737] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-14 07:12:15,737] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-14 07:12:15,737] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-14 07:12:15,737] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-14 07:12:15,737] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-14 07:12:15,737] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-14 07:12:15,737] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-14 07:12:15,737] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-14 07:12:15,737] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-14 07:12:15,737] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-14 07:12:15,737] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-14 07:12:15,737] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.4867706298828125 seconds
Loading extension module utils...
Time to load utils op: 0.4047424793243408 seconds
Loading extension module utils...
Time to load utils op: 0.40453672409057617 seconds
Loading extension module utils...
Time to load utils op: 0.5046112537384033 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                                           | 0/50 [00:00<?, ?it/s]############### Example ###############
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following multiple choice question.

### Demonstration:
Input: Adam bought 3 kilograms of nuts and 2.5 kilograms of dried fruits at a store. One kilogram of nuts costs $12 and one kilogram of dried fruit costs $8. How much did his purchases cost?
Answer: 56

Input: Johns goes to the gym 3 times a week.  He spends 1 hour each day lifting weight. Additionally, he also spends a third of his weightlifting time warming up and doing cardio each day.  How many hours does he spend at the gym a week?
Answer: 4

Input: James has to refuel his plane.  It used to cost $200 to refill the tank.  He got an extra tank to double fuel capacity.  Fuel prices also went up by 20%.  How much does he pay now for fuel?
Answer: 480

Input: The number of goals scored in a game against Barca by exactly two players last season accounts for 20% of all goals scored in the league. If the players scored an equal number of goals, and the total number of goals scored in the league against Barca that season is 300, calculate the number of goals each of the two players scored.
Answer: 30

Input: Every day Tom drinks 5 12-oz cans of soda plus 64 ounces of water. How many ounces of fluid does he drink a week?
Answer: 868

Input: Stella and Twinkle are filling up a truck with a capacity of 6000 stone blocks at the rate of 250 blocks per hour per person. They work for four hours and are then joined by 6 other people who also work at the same rate. How many hours did filling the truck take?
Answer: 6

Input: Elijah drank 8.5 pints of coffee yesterday. Emilio drank 9.5 pints of water yesterday. How many cups of liquid did the two boys drink yesterday?
Answer: 36

Input: Doris works at the Widget Factory in the packing department. She puts 3 widgets in each carton, which are 4 inches wide, 4 inches long, and 5 inches tall. She then packs those cartons into a shipping box before sending it to the loading bay. The shipping boxes are 20 inches wide, 20 inches long, and 20 inches high. How many widgets get shipped in each shipping box?
Answer: 300

Input: Queenie earns $150 a day as a part-time clerk. She earns an additional $5 per hour as overtime pay. How much will Queenie receive for working 5 days with 4 hours overtime?
Answer: 770

Input: Jodi starts off walking 1 mile a day for 6 days a week.  On the second week, she walks 2 miles a day, 6 days a week.  On the third week, she walks 3 miles a day, 6 days a week. Finally on the fourth week, she walks 4 miles a day, 6 days a week.  How many miles has she walked in 4 weeks?
Answer: 60

### Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid

### Response:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o10-tgsm8k-s10-rFalse
Evaluating commonsenseqa :   2%|█                                                  | 1/50 [00:47<38:46, 47.48s/it]Evaluating commonsenseqa :   4%|██                                                 | 2/50 [01:34<37:37, 47.04s/it]Evaluating commonsenseqa :   6%|███                                                | 3/50 [02:16<35:13, 44.96s/it]Evaluating commonsenseqa :   8%|████                                               | 4/50 [03:04<35:15, 46.00s/it]Evaluating commonsenseqa :  10%|█████                                              | 5/50 [03:39<31:34, 42.10s/it]Evaluating commonsenseqa :  12%|██████                                             | 6/50 [04:25<31:55, 43.52s/it]Evaluating commonsenseqa :  14%|███████▏                                           | 7/50 [05:12<32:02, 44.70s/it]Evaluating commonsenseqa :  16%|████████▏                                          | 8/50 [06:00<31:53, 45.55s/it]Evaluating commonsenseqa :  18%|█████████▏                                         | 9/50 [06:47<31:25, 45.98s/it]Evaluating commonsenseqa :  20%|██████████                                        | 10/50 [07:34<30:51, 46.29s/it]Evaluating commonsenseqa :  22%|███████████                                       | 11/50 [08:21<30:12, 46.48s/it]Evaluating commonsenseqa :  24%|████████████                                      | 12/50 [09:07<29:26, 46.48s/it]Evaluating commonsenseqa :  26%|█████████████                                     | 13/50 [09:54<28:42, 46.56s/it]Evaluating commonsenseqa :  28%|██████████████                                    | 14/50 [10:31<26:10, 43.63s/it]Evaluating commonsenseqa :  30%|███████████████                                   | 15/50 [11:17<25:53, 44.39s/it]Evaluating commonsenseqa :  32%|████████████████                                  | 16/50 [12:04<25:42, 45.38s/it]Evaluating commonsenseqa :  34%|█████████████████                                 | 17/50 [12:52<25:17, 46.00s/it]Evaluating commonsenseqa :  36%|██████████████████                                | 18/50 [13:39<24:39, 46.24s/it]Evaluating commonsenseqa :  38%|███████████████████                               | 19/50 [14:11<21:38, 41.90s/it]Evaluating commonsenseqa :  40%|████████████████████                              | 20/50 [14:58<21:44, 43.47s/it]Evaluating commonsenseqa :  42%|█████████████████████                             | 21/50 [15:35<20:11, 41.77s/it]Evaluating commonsenseqa :  44%|██████████████████████                            | 22/50 [16:22<20:12, 43.32s/it]Evaluating commonsenseqa :  46%|███████████████████████                           | 23/50 [17:09<19:59, 44.43s/it]Evaluating commonsenseqa :  48%|████████████████████████                          | 24/50 [17:56<19:32, 45.08s/it]Evaluating commonsenseqa :  50%|█████████████████████████                         | 25/50 [18:43<19:01, 45.67s/it]Evaluating commonsenseqa :  52%|██████████████████████████                        | 26/50 [19:30<18:28, 46.19s/it]Evaluating commonsenseqa :  54%|███████████████████████████                       | 27/50 [20:18<17:48, 46.47s/it]Evaluating commonsenseqa :  56%|████████████████████████████                      | 28/50 [21:04<17:03, 46.50s/it]Evaluating commonsenseqa :  58%|████████████████████████████▉                     | 29/50 [21:51<16:20, 46.71s/it]Evaluating commonsenseqa :  60%|██████████████████████████████                    | 30/50 [22:38<15:31, 46.56s/it]Evaluating commonsenseqa :  62%|███████████████████████████████                   | 31/50 [23:24<14:44, 46.55s/it]Evaluating commonsenseqa :  64%|████████████████████████████████                  | 32/50 [23:58<12:52, 42.91s/it]Evaluating commonsenseqa :  66%|█████████████████████████████████                 | 33/50 [24:46<12:33, 44.34s/it]Evaluating commonsenseqa :  68%|██████████████████████████████████                | 34/50 [25:33<12:02, 45.16s/it]Evaluating commonsenseqa :  70%|███████████████████████████████████               | 35/50 [26:20<11:25, 45.68s/it]Evaluating commonsenseqa :  72%|████████████████████████████████████              | 36/50 [27:07<10:43, 46.00s/it]Evaluating commonsenseqa :  74%|█████████████████████████████████████             | 37/50 [27:33<08:41, 40.15s/it]Evaluating commonsenseqa :  76%|██████████████████████████████████████            | 38/50 [28:21<08:27, 42.32s/it]Evaluating commonsenseqa :  78%|███████████████████████████████████████           | 39/50 [29:07<07:59, 43.58s/it]Evaluating commonsenseqa :  80%|████████████████████████████████████████          | 40/50 [29:45<06:56, 41.68s/it]Evaluating commonsenseqa :  82%|█████████████████████████████████████████         | 41/50 [30:06<05:21, 35.67s/it]Evaluating commonsenseqa :  84%|██████████████████████████████████████████        | 42/50 [30:54<05:13, 39.23s/it]Evaluating commonsenseqa :  86%|███████████████████████████████████████████       | 43/50 [31:41<04:51, 41.58s/it]Evaluating commonsenseqa :  88%|████████████████████████████████████████████      | 44/50 [32:27<04:18, 43.04s/it]Evaluating commonsenseqa :  90%|█████████████████████████████████████████████     | 45/50 [33:14<03:40, 44.14s/it]Evaluating commonsenseqa :  92%|██████████████████████████████████████████████    | 46/50 [33:55<02:53, 43.35s/it]Evaluating commonsenseqa :  94%|███████████████████████████████████████████████   | 47/50 [34:18<01:51, 37.19s/it]Evaluating commonsenseqa :  96%|████████████████████████████████████████████████  | 48/50 [35:05<01:20, 40.01s/it]Evaluating commonsenseqa :  98%|█████████████████████████████████████████████████ | 49/50 [35:52<00:42, 42.19s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████| 50/50 [36:40<00:00, 43.84s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████| 50/50 [36:40<00:00, 44.01s/it]
name: commonsenseqa | {'exact_match': 0.4, 'rougeL': 4.2174} | lm_loss 7.8411 | avg. gen lenth: 216.184
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name gsm8k --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/out-domain/o11-tgsm8k-s10-rFalse --seed 10 --num-out-domain 11
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-14 07:49:04,320] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/out-domain/o11-tgsm8k-s10-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 11
  out_domain_data_name ......... gsm8k
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o11-tgsm8k-s10-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 10
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                    | 0/9741 [00:00<?, ?it/s]  0%|▎                                                                         | 44/9741 [00:00<00:22, 439.57it/s]  1%|▋                                                                         | 89/9741 [00:00<00:21, 440.93it/s]  1%|█                                                                        | 134/9741 [00:00<00:21, 441.41it/s]  2%|█▎                                                                       | 179/9741 [00:00<00:21, 441.67it/s]  2%|█▋                                                                       | 224/9741 [00:00<00:21, 439.44it/s]  3%|██                                                                       | 269/9741 [00:00<00:21, 440.44it/s]  3%|██▎                                                                      | 314/9741 [00:00<00:21, 441.40it/s]  4%|██▋                                                                      | 359/9741 [00:00<00:21, 432.77it/s]  4%|███                                                                      | 404/9741 [00:00<00:21, 435.28it/s]  5%|███▎                                                                     | 448/9741 [00:01<00:21, 433.99it/s]  5%|███▋                                                                     | 493/9741 [00:01<00:21, 436.06it/s]  6%|████                                                                     | 538/9741 [00:01<00:20, 438.27it/s]  6%|████▎                                                                    | 583/9741 [00:01<00:20, 439.34it/s]  6%|████▋                                                                    | 628/9741 [00:01<00:20, 440.07it/s]  7%|█████                                                                    | 673/9741 [00:01<00:20, 439.29it/s]  7%|█████▍                                                                   | 718/9741 [00:01<00:20, 440.31it/s]  8%|█████▋                                                                   | 763/9741 [00:01<00:20, 437.78it/s]  8%|██████                                                                   | 808/9741 [00:01<00:20, 438.54it/s]  9%|██████▍                                                                  | 853/9741 [00:01<00:20, 440.26it/s]  9%|██████▋                                                                  | 900/9741 [00:02<00:19, 447.42it/s] 10%|███████▏                                                                 | 967/9741 [00:02<00:17, 512.87it/s] 11%|███████▋                                                                | 1034/9741 [00:02<00:15, 558.06it/s] 11%|████████▏                                                               | 1101/9741 [00:02<00:14, 590.51it/s] 12%|████████▋                                                               | 1167/9741 [00:02<00:14, 610.84it/s] 13%|█████████                                                               | 1234/9741 [00:02<00:13, 627.51it/s] 13%|█████████▌                                                              | 1302/9741 [00:02<00:13, 640.44it/s] 14%|██████████                                                              | 1369/9741 [00:02<00:12, 646.76it/s] 15%|██████████▌                                                             | 1436/9741 [00:02<00:12, 652.15it/s] 15%|███████████                                                             | 1503/9741 [00:02<00:12, 656.20it/s] 16%|███████████▌                                                            | 1569/9741 [00:03<00:12, 653.34it/s] 17%|████████████                                                            | 1636/9741 [00:03<00:12, 657.05it/s] 17%|████████████▌                                                           | 1703/9741 [00:03<00:12, 659.96it/s] 18%|█████████████                                                           | 1771/9741 [00:03<00:12, 663.17it/s] 19%|█████████████▌                                                          | 1838/9741 [00:03<00:12, 638.46it/s] 20%|██████████████                                                          | 1905/9741 [00:03<00:12, 646.23it/s] 20%|██████████████▌                                                         | 1972/9741 [00:03<00:11, 651.84it/s] 21%|███████████████                                                         | 2038/9741 [00:03<00:11, 653.50it/s] 22%|███████████████▌                                                        | 2105/9741 [00:03<00:11, 655.32it/s] 22%|████████████████                                                        | 2171/9741 [00:03<00:11, 656.58it/s] 23%|████████████████▌                                                       | 2238/9741 [00:04<00:11, 658.96it/s] 24%|█████████████████                                                       | 2304/9741 [00:04<00:11, 658.35it/s] 24%|█████████████████▌                                                      | 2371/9741 [00:04<00:11, 659.94it/s] 25%|██████████████████                                                      | 2438/9741 [00:04<00:11, 655.88it/s] 26%|██████████████████▌                                                     | 2504/9741 [00:04<00:11, 653.85it/s] 26%|███████████████████                                                     | 2571/9741 [00:04<00:10, 656.85it/s] 27%|███████████████████▍                                                    | 2638/9741 [00:04<00:10, 660.12it/s] 28%|███████████████████▉                                                    | 2705/9741 [00:04<00:10, 659.23it/s] 28%|████████████████████▍                                                   | 2772/9741 [00:04<00:10, 660.36it/s] 29%|████████████████████▉                                                   | 2839/9741 [00:04<00:10, 661.20it/s] 30%|█████████████████████▍                                                  | 2906/9741 [00:05<00:10, 663.23it/s] 31%|█████████████████████▉                                                  | 2973/9741 [00:05<00:10, 656.21it/s] 31%|██████████████████████▍                                                 | 3040/9741 [00:05<00:10, 658.74it/s] 32%|██████████████████████▉                                                 | 3107/9741 [00:05<00:10, 660.89it/s] 33%|███████████████████████▍                                                | 3174/9741 [00:05<00:09, 660.59it/s] 33%|███████████████████████▉                                                | 3241/9741 [00:05<00:09, 663.24it/s] 34%|████████████████████████▍                                               | 3308/9741 [00:05<00:09, 661.28it/s] 35%|████████████████████████▉                                               | 3375/9741 [00:05<00:09, 661.03it/s] 35%|█████████████████████████▍                                              | 3442/9741 [00:05<00:09, 659.36it/s] 36%|█████████████████████████▉                                              | 3509/9741 [00:06<00:09, 660.09it/s] 37%|██████████████████████████▍                                             | 3576/9741 [00:06<00:09, 661.64it/s] 37%|██████████████████████████▉                                             | 3643/9741 [00:06<00:09, 658.77it/s] 38%|███████████████████████████▍                                            | 3709/9741 [00:06<00:09, 657.25it/s] 39%|███████████████████████████▉                                            | 3776/9741 [00:06<00:09, 660.23it/s] 39%|████████████████████████████▍                                           | 3843/9741 [00:06<00:08, 659.73it/s] 40%|████████████████████████████▉                                           | 3910/9741 [00:06<00:08, 661.41it/s] 41%|█████████████████████████████▍                                          | 3977/9741 [00:06<00:08, 662.27it/s] 42%|█████████████████████████████▉                                          | 4044/9741 [00:06<00:08, 663.96it/s] 42%|██████████████████████████████▍                                         | 4111/9741 [00:06<00:08, 658.57it/s] 43%|██████████████████████████████▉                                         | 4178/9741 [00:07<00:08, 660.86it/s] 44%|███████████████████████████████▍                                        | 4245/9741 [00:07<00:08, 661.88it/s] 44%|███████████████████████████████▊                                        | 4312/9741 [00:07<00:08, 660.50it/s] 45%|████████████████████████████████▎                                       | 4379/9741 [00:07<00:08, 662.07it/s] 46%|████████████████████████████████▊                                       | 4446/9741 [00:07<00:08, 659.68it/s] 46%|█████████████████████████████████▎                                      | 4513/9741 [00:07<00:08, 625.28it/s] 47%|█████████████████████████████████▊                                      | 4580/9741 [00:07<00:08, 636.18it/s] 48%|██████████████████████████████████▎                                     | 4647/9741 [00:07<00:07, 644.21it/s] 48%|██████████████████████████████████▊                                     | 4714/9741 [00:07<00:07, 650.04it/s] 49%|███████████████████████████████████▎                                    | 4780/9741 [00:08<00:10, 472.91it/s] 50%|███████████████████████████████████▊                                    | 4846/9741 [00:08<00:09, 516.46it/s] 50%|████████████████████████████████████▎                                   | 4913/9741 [00:08<00:08, 553.25it/s] 51%|████████████████████████████████████▊                                   | 4979/9741 [00:08<00:08, 579.70it/s] 52%|█████████████████████████████████████▎                                  | 5046/9741 [00:08<00:07, 602.97it/s] 52%|█████████████████████████████████████▊                                  | 5113/9741 [00:08<00:07, 619.81it/s] 53%|██████████████████████████████████████▎                                 | 5179/9741 [00:08<00:07, 629.90it/s] 54%|██████████████████████████████████████▊                                 | 5246/9741 [00:08<00:07, 639.36it/s] 55%|███████████████████████████████████████▎                                | 5313/9741 [00:08<00:06, 646.42it/s] 55%|███████████████████████████████████████▊                                | 5379/9741 [00:08<00:06, 649.65it/s] 56%|████████████████████████████████████████▏                               | 5445/9741 [00:09<00:06, 642.33it/s] 57%|████████████████████████████████████████▋                               | 5512/9741 [00:09<00:06, 650.12it/s] 57%|█████████████████████████████████████████▏                              | 5580/9741 [00:09<00:06, 657.43it/s] 58%|█████████████████████████████████████████▋                              | 5646/9741 [00:09<00:06, 656.33it/s] 59%|██████████████████████████████████████████▏                             | 5712/9741 [00:09<00:06, 654.47it/s] 59%|██████████████████████████████████████████▋                             | 5778/9741 [00:09<00:06, 652.81it/s] 60%|███████████████████████████████████████████▏                            | 5846/9741 [00:09<00:05, 658.67it/s] 61%|███████████████████████████████████████████▋                            | 5915/9741 [00:09<00:05, 665.27it/s] 61%|████████████████████████████████████████████▏                           | 5983/9741 [00:09<00:05, 668.07it/s] 62%|████████████████████████████████████████████▋                           | 6050/9741 [00:09<00:05, 666.62it/s] 63%|█████████████████████████████████████████████▏                          | 6117/9741 [00:10<00:05, 661.41it/s] 63%|█████████████████████████████████████████████▋                          | 6185/9741 [00:10<00:05, 666.91it/s] 64%|██████████████████████████████████████████████▏                         | 6254/9741 [00:10<00:05, 671.28it/s] 65%|██████████████████████████████████████████████▋                         | 6322/9741 [00:10<00:05, 672.27it/s] 66%|███████████████████████████████████████████████▏                        | 6392/9741 [00:10<00:04, 677.96it/s] 66%|███████████████████████████████████████████████▊                        | 6461/9741 [00:10<00:04, 680.18it/s] 67%|████████████████████████████████████████████████▎                       | 6530/9741 [00:10<00:04, 682.56it/s] 68%|████████████████████████████████████████████████▊                       | 6599/9741 [00:10<00:04, 682.25it/s] 68%|█████████████████████████████████████████████████▎                      | 6669/9741 [00:10<00:04, 684.94it/s] 69%|█████████████████████████████████████████████████▊                      | 6739/9741 [00:11<00:04, 686.60it/s] 70%|██████████████████████████████████████████████████▎                     | 6808/9741 [00:11<00:04, 685.49it/s] 71%|██████████████████████████████████████████████████▊                     | 6877/9741 [00:11<00:04, 685.99it/s] 71%|███████████████████████████████████████████████████▎                    | 6946/9741 [00:11<00:04, 683.76it/s] 72%|███████████████████████████████████████████████████▊                    | 7015/9741 [00:11<00:03, 682.13it/s] 73%|████████████████████████████████████████████████████▎                   | 7085/9741 [00:11<00:03, 684.67it/s] 73%|████████████████████████████████████████████████████▉                   | 7155/9741 [00:11<00:03, 686.96it/s] 74%|█████████████████████████████████████████████████████▍                  | 7224/9741 [00:11<00:03, 684.28it/s] 75%|█████████████████████████████████████████████████████▉                  | 7293/9741 [00:11<00:03, 685.21it/s] 76%|██████████████████████████████████████████████████████▍                 | 7362/9741 [00:11<00:03, 685.96it/s] 76%|██████████████████████████████████████████████████████▉                 | 7431/9741 [00:12<00:03, 686.98it/s] 77%|███████████████████████████████████████████████████████▍                | 7500/9741 [00:12<00:03, 655.53it/s] 78%|███████████████████████████████████████████████████████▉                | 7569/9741 [00:12<00:03, 664.38it/s] 78%|████████████████████████████████████████████████████████▍               | 7638/9741 [00:12<00:03, 669.75it/s] 79%|████████████████████████████████████████████████████████▉               | 7706/9741 [00:12<00:03, 672.31it/s] 80%|█████████████████████████████████████████████████████████▍              | 7774/9741 [00:12<00:02, 670.57it/s] 81%|█████████████████████████████████████████████████████████▉              | 7843/9741 [00:12<00:02, 675.64it/s] 81%|██████████████████████████████████████████████████████████▍             | 7911/9741 [00:12<00:02, 676.30it/s] 82%|██████████████████████████████████████████████████████████▉             | 7980/9741 [00:12<00:02, 678.71it/s] 83%|███████████████████████████████████████████████████████████▍            | 8049/9741 [00:12<00:02, 680.87it/s] 83%|████████████████████████████████████████████████████████████            | 8119/9741 [00:13<00:02, 683.79it/s] 84%|████████████████████████████████████████████████████████████▌           | 8188/9741 [00:13<00:02, 682.74it/s] 85%|█████████████████████████████████████████████████████████████           | 8257/9741 [00:13<00:02, 684.31it/s] 85%|█████████████████████████████████████████████████████████████▌          | 8326/9741 [00:13<00:02, 684.10it/s] 86%|██████████████████████████████████████████████████████████████          | 8395/9741 [00:13<00:01, 682.87it/s] 87%|██████████████████████████████████████████████████████████████▌         | 8464/9741 [00:13<00:01, 684.52it/s] 88%|███████████████████████████████████████████████████████████████         | 8533/9741 [00:13<00:01, 684.13it/s] 88%|███████████████████████████████████████████████████████████████▌        | 8602/9741 [00:13<00:01, 682.24it/s] 89%|████████████████████████████████████████████████████████████████        | 8671/9741 [00:13<00:01, 683.66it/s] 90%|████████████████████████████████████████████████████████████████▌       | 8740/9741 [00:13<00:01, 684.55it/s] 90%|█████████████████████████████████████████████████████████████████       | 8809/9741 [00:14<00:01, 682.71it/s] 91%|█████████████████████████████████████████████████████████████████▌      | 8878/9741 [00:14<00:01, 675.36it/s] 92%|██████████████████████████████████████████████████████████████████▏     | 8947/9741 [00:14<00:01, 678.12it/s] 93%|██████████████████████████████████████████████████████████████████▋     | 9015/9741 [00:14<00:01, 677.82it/s] 93%|███████████████████████████████████████████████████████████████████▏    | 9083/9741 [00:14<00:00, 677.37it/s] 94%|███████████████████████████████████████████████████████████████████▋    | 9151/9741 [00:14<00:00, 676.40it/s] 95%|████████████████████████████████████████████████████████████████████▏   | 9219/9741 [00:14<00:00, 674.82it/s] 95%|████████████████████████████████████████████████████████████████████▋   | 9287/9741 [00:14<00:00, 675.42it/s] 96%|█████████████████████████████████████████████████████████████████████▏  | 9356/9741 [00:14<00:00, 678.40it/s] 97%|█████████████████████████████████████████████████████████████████████▋  | 9425/9741 [00:14<00:00, 680.84it/s] 97%|██████████████████████████████████████████████████████████████████████▏ | 9494/9741 [00:15<00:00, 679.99it/s] 98%|██████████████████████████████████████████████████████████████████████▋ | 9563/9741 [00:15<00:00, 681.50it/s] 99%|███████████████████████████████████████████████████████████████████████▏| 9632/9741 [00:15<00:00, 682.43it/s]100%|███████████████████████████████████████████████████████████████████████▋| 9701/9741 [00:15<00:00, 683.35it/s]100%|████████████████████████████████████████████████████████████████████████| 9741/9741 [00:15<00:00, 631.55it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.04s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.13s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.31s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:11,  5.51s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:09<00:04,  4.90s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.26s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.39s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.36s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.29s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.47s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.71s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.87s/it]
[2023-08-14 07:50:11,714] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.73s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.88s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.73s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.91s/it]
[2023-08-14 07:50:20,883] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-14 07:50:20,884] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-14 07:50:20,884] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-14 07:50:20,884] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-14 07:50:20,884] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-14 07:50:20,884] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-14 07:50:20,884] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-14 07:50:20,884] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-14 07:50:20,884] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-14 07:50:20,884] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-14 07:50:20,884] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7ffa83322fd0>
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7ffa5a19ecd0>
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-14 07:50:20,885] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-14 07:50:20,886] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-14 07:50:20,886] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-14 07:50:20,886] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-14 07:50:20,886] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.4019196033477783 seconds
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.4045712947845459 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Time to load utils op: 0.30434584617614746 seconds
Evaluating commonsenseqa :   0%|                                                           | 0/50 [00:00<?, ?it/s]############### Example ###############
Loading extension module utils...
Time to load utils op: 0.40448427200317383 seconds
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following multiple choice question.

### Demonstration:
Input: Adam bought 3 kilograms of nuts and 2.5 kilograms of dried fruits at a store. One kilogram of nuts costs $12 and one kilogram of dried fruit costs $8. How much did his purchases cost?
Answer: 56

Input: Johns goes to the gym 3 times a week.  He spends 1 hour each day lifting weight. Additionally, he also spends a third of his weightlifting time warming up and doing cardio each day.  How many hours does he spend at the gym a week?
Answer: 4

Input: James has to refuel his plane.  It used to cost $200 to refill the tank.  He got an extra tank to double fuel capacity.  Fuel prices also went up by 20%.  How much does he pay now for fuel?
Answer: 480

Input: The number of goals scored in a game against Barca by exactly two players last season accounts for 20% of all goals scored in the league. If the players scored an equal number of goals, and the total number of goals scored in the league against Barca that season is 300, calculate the number of goals each of the two players scored.
Answer: 30

Input: Every day Tom drinks 5 12-oz cans of soda plus 64 ounces of water. How many ounces of fluid does he drink a week?
Answer: 868

Input: Stella and Twinkle are filling up a truck with a capacity of 6000 stone blocks at the rate of 250 blocks per hour per person. They work for four hours and are then joined by 6 other people who also work at the same rate. How many hours did filling the truck take?
Answer: 6

Input: Elijah drank 8.5 pints of coffee yesterday. Emilio drank 9.5 pints of water yesterday. How many cups of liquid did the two boys drink yesterday?
Answer: 36

Input: Doris works at the Widget Factory in the packing department. She puts 3 widgets in each carton, which are 4 inches wide, 4 inches long, and 5 inches tall. She then packs those cartons into a shipping box before sending it to the loading bay. The shipping boxes are 20 inches wide, 20 inches long, and 20 inches high. How many widgets get shipped in each shipping box?
Answer: 300

Input: Queenie earns $150 a day as a part-time clerk. She earns an additional $5 per hour as overtime pay. How much will Queenie receive for working 5 days with 4 hours overtime?
Answer: 770

Input: Jodi starts off walking 1 mile a day for 6 days a week.  On the second week, she walks 2 miles a day, 6 days a week.  On the third week, she walks 3 miles a day, 6 days a week. Finally on the fourth week, she walks 4 miles a day, 6 days a week.  How many miles has she walked in 4 weeks?
Answer: 60

Input: A club is going to get additional members so that they will have 5 more than twice their current number of their members. If the club has 10 members now, how many additional members do they need?
Answer: 15

### Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid

### Response:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o11-tgsm8k-s10-rFalse
Evaluating commonsenseqa :   2%|█                                                  | 1/50 [00:46<37:52, 46.39s/it]Evaluating commonsenseqa :   4%|██                                                 | 2/50 [01:16<29:39, 37.07s/it]Evaluating commonsenseqa :   6%|███                                                | 3/50 [01:55<29:38, 37.85s/it]Evaluating commonsenseqa :   8%|████                                               | 4/50 [02:41<31:33, 41.16s/it]Evaluating commonsenseqa :  10%|█████                                              | 5/50 [03:27<32:08, 42.85s/it]Evaluating commonsenseqa :  12%|██████                                             | 6/50 [04:13<32:06, 43.79s/it]Evaluating commonsenseqa :  14%|███████▏                                           | 7/50 [04:59<31:52, 44.48s/it]Evaluating commonsenseqa :  16%|████████▏                                          | 8/50 [05:45<31:29, 44.98s/it]Evaluating commonsenseqa :  18%|█████████▏                                         | 9/50 [06:31<31:04, 45.48s/it]Evaluating commonsenseqa :  20%|██████████                                        | 10/50 [07:18<30:31, 45.79s/it]Evaluating commonsenseqa :  22%|███████████                                       | 11/50 [08:04<29:52, 45.97s/it]Evaluating commonsenseqa :  24%|████████████                                      | 12/50 [08:17<22:39, 35.78s/it]Evaluating commonsenseqa :  26%|█████████████                                     | 13/50 [09:02<23:50, 38.67s/it]Evaluating commonsenseqa :  28%|██████████████                                    | 14/50 [09:49<24:39, 41.11s/it]Evaluating commonsenseqa :  30%|███████████████                                   | 15/50 [10:35<24:47, 42.50s/it]Evaluating commonsenseqa :  32%|████████████████                                  | 16/50 [11:21<24:46, 43.71s/it]Evaluating commonsenseqa :  34%|█████████████████                                 | 17/50 [12:08<24:31, 44.59s/it]Evaluating commonsenseqa :  36%|██████████████████                                | 18/50 [12:54<24:06, 45.20s/it]Evaluating commonsenseqa :  38%|███████████████████                               | 19/50 [13:40<23:23, 45.27s/it]Evaluating commonsenseqa :  40%|████████████████████                              | 20/50 [14:10<20:19, 40.65s/it]Evaluating commonsenseqa :  42%|█████████████████████                             | 21/50 [14:55<20:20, 42.09s/it]Evaluating commonsenseqa :  44%|██████████████████████                            | 22/50 [15:42<20:16, 43.45s/it]Evaluating commonsenseqa :  46%|███████████████████████                           | 23/50 [16:28<19:54, 44.23s/it]Evaluating commonsenseqa :  48%|████████████████████████                          | 24/50 [17:13<19:21, 44.67s/it]Evaluating commonsenseqa :  50%|█████████████████████████                         | 25/50 [18:00<18:47, 45.09s/it]Evaluating commonsenseqa :  52%|██████████████████████████                        | 26/50 [18:45<18:04, 45.20s/it]Evaluating commonsenseqa :  54%|███████████████████████████                       | 27/50 [19:05<14:25, 37.63s/it]Evaluating commonsenseqa :  56%|████████████████████████████                      | 28/50 [19:52<14:48, 40.38s/it]Evaluating commonsenseqa :  58%|████████████████████████████▉                     | 29/50 [20:37<14:40, 41.92s/it]Evaluating commonsenseqa :  60%|██████████████████████████████                    | 30/50 [21:24<14:27, 43.35s/it]Evaluating commonsenseqa :  62%|███████████████████████████████                   | 31/50 [22:11<14:05, 44.52s/it]Evaluating commonsenseqa :  64%|████████████████████████████████                  | 32/50 [22:33<11:17, 37.64s/it]Evaluating commonsenseqa :  66%|█████████████████████████████████                 | 33/50 [23:19<11:25, 40.30s/it]Evaluating commonsenseqa :  68%|██████████████████████████████████                | 34/50 [24:06<11:15, 42.25s/it]Evaluating commonsenseqa :  70%|███████████████████████████████████               | 35/50 [24:53<10:52, 43.53s/it]Evaluating commonsenseqa :  72%|████████████████████████████████████              | 36/50 [25:34<10:01, 42.96s/it]Evaluating commonsenseqa :  74%|█████████████████████████████████████             | 37/50 [26:21<09:34, 44.20s/it]Evaluating commonsenseqa :  76%|██████████████████████████████████████            | 38/50 [27:08<08:57, 44.80s/it]Evaluating commonsenseqa :  78%|███████████████████████████████████████           | 39/50 [27:54<08:16, 45.16s/it]Evaluating commonsenseqa :  80%|████████████████████████████████████████          | 40/50 [28:40<07:34, 45.45s/it]Evaluating commonsenseqa :  82%|█████████████████████████████████████████         | 41/50 [29:26<06:52, 45.78s/it]Evaluating commonsenseqa :  84%|██████████████████████████████████████████        | 42/50 [30:12<06:07, 45.88s/it]Evaluating commonsenseqa :  86%|███████████████████████████████████████████       | 43/50 [30:59<05:22, 46.12s/it]Evaluating commonsenseqa :  88%|████████████████████████████████████████████      | 44/50 [31:45<04:35, 45.93s/it]Evaluating commonsenseqa :  90%|█████████████████████████████████████████████     | 45/50 [32:30<03:49, 45.85s/it]Evaluating commonsenseqa :  92%|██████████████████████████████████████████████    | 46/50 [32:44<02:25, 36.33s/it]Evaluating commonsenseqa :  94%|███████████████████████████████████████████████   | 47/50 [33:30<01:57, 39.21s/it]Evaluating commonsenseqa :  96%|████████████████████████████████████████████████  | 48/50 [34:17<01:22, 41.43s/it]Evaluating commonsenseqa :  98%|█████████████████████████████████████████████████ | 49/50 [35:04<00:43, 43.01s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████| 50/50 [35:47<00:00, 43.14s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████| 50/50 [35:47<00:00, 42.95s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 4.2549} | lm_loss 7.8531 | avg. gen lenth: 251.252
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name gsm8k --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/out-domain/o12-tgsm8k-s10-rFalse --seed 10 --num-out-domain 12
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-14 08:26:18,066] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/out-domain/o12-tgsm8k-s10-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 12
  out_domain_data_name ......... gsm8k
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o12-tgsm8k-s10-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 10
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                    | 0/9741 [00:00<?, ?it/s]  0%|▎                                                                         | 41/9741 [00:00<00:23, 405.99it/s]  1%|▌                                                                         | 82/9741 [00:00<00:23, 406.68it/s]  1%|▉                                                                        | 123/9741 [00:00<00:23, 407.52it/s]  2%|█▏                                                                       | 164/9741 [00:00<00:23, 408.30it/s]  2%|█▌                                                                       | 205/9741 [00:00<00:23, 405.66it/s]  3%|█▊                                                                       | 246/9741 [00:00<00:23, 406.68it/s]  3%|██▏                                                                      | 287/9741 [00:00<00:23, 406.95it/s]  3%|██▍                                                                      | 328/9741 [00:00<00:23, 400.41it/s]  4%|██▊                                                                      | 369/9741 [00:00<00:23, 401.73it/s]  4%|███                                                                      | 410/9741 [00:01<00:23, 403.12it/s]  5%|███▍                                                                     | 451/9741 [00:01<00:23, 401.21it/s]  5%|███▋                                                                     | 492/9741 [00:01<00:22, 402.75it/s]  5%|███▉                                                                     | 533/9741 [00:01<00:22, 404.35it/s]  6%|████▎                                                                    | 574/9741 [00:01<00:22, 404.74it/s]  6%|████▌                                                                    | 615/9741 [00:01<00:22, 405.46it/s]  7%|████▉                                                                    | 656/9741 [00:01<00:22, 404.17it/s]  7%|█████▏                                                                   | 697/9741 [00:01<00:22, 405.33it/s]  8%|█████▌                                                                   | 738/9741 [00:01<00:22, 402.32it/s]  8%|█████▊                                                                   | 779/9741 [00:01<00:22, 403.53it/s]  8%|██████▏                                                                  | 820/9741 [00:02<00:22, 404.96it/s]  9%|██████▍                                                                  | 861/9741 [00:02<00:21, 405.68it/s]  9%|██████▊                                                                  | 902/9741 [00:02<00:21, 404.21it/s] 10%|███████                                                                  | 949/9741 [00:02<00:20, 422.04it/s] 10%|███████▍                                                                | 1011/9741 [00:02<00:18, 479.30it/s] 11%|███████▉                                                                | 1073/9741 [00:02<00:16, 519.69it/s] 12%|████████▍                                                               | 1134/9741 [00:02<00:15, 545.74it/s] 12%|████████▊                                                               | 1196/9741 [00:02<00:15, 566.33it/s] 13%|█████████▎                                                              | 1258/9741 [00:02<00:14, 579.98it/s] 14%|█████████▊                                                              | 1320/9741 [00:02<00:14, 590.01it/s] 14%|██████████▏                                                             | 1381/9741 [00:03<00:14, 594.29it/s] 15%|██████████▋                                                             | 1442/9741 [00:03<00:13, 596.14it/s] 15%|███████████                                                             | 1504/9741 [00:03<00:13, 600.59it/s] 16%|███████████▌                                                            | 1565/9741 [00:03<00:13, 602.69it/s] 17%|████████████                                                            | 1627/9741 [00:03<00:13, 606.05it/s] 17%|████████████▍                                                           | 1689/9741 [00:03<00:13, 608.28it/s] 18%|████████████▉                                                           | 1751/9741 [00:03<00:13, 609.89it/s] 19%|█████████████▍                                                          | 1812/9741 [00:03<00:13, 585.79it/s] 19%|█████████████▊                                                          | 1874/9741 [00:03<00:13, 593.46it/s] 20%|██████████████▎                                                         | 1936/9741 [00:03<00:13, 598.91it/s] 21%|██████████████▊                                                         | 1998/9741 [00:04<00:12, 602.46it/s] 21%|███████████████▏                                                        | 2059/9741 [00:04<00:12, 602.16it/s] 22%|███████████████▋                                                        | 2120/9741 [00:04<00:12, 603.97it/s] 22%|████████████████▏                                                       | 2182/9741 [00:04<00:12, 606.84it/s] 23%|████████████████▌                                                       | 2243/9741 [00:04<00:12, 598.27it/s] 24%|█████████████████                                                       | 2305/9741 [00:04<00:12, 602.20it/s] 24%|█████████████████▍                                                      | 2367/9741 [00:04<00:12, 604.90it/s] 25%|█████████████████▉                                                      | 2429/9741 [00:04<00:12, 607.85it/s] 26%|██████████████████▍                                                     | 2490/9741 [00:04<00:11, 606.70it/s] 26%|██████████████████▊                                                     | 2551/9741 [00:04<00:11, 607.31it/s] 27%|███████████████████▎                                                    | 2613/9741 [00:05<00:11, 609.03it/s] 27%|███████████████████▊                                                    | 2675/9741 [00:05<00:11, 609.77it/s] 28%|████████████████████▏                                                   | 2736/9741 [00:05<00:11, 607.01it/s] 29%|████████████████████▋                                                   | 2798/9741 [00:05<00:11, 608.01it/s] 29%|█████████████████████▏                                                  | 2860/9741 [00:05<00:11, 608.73it/s] 30%|█████████████████████▌                                                  | 2922/9741 [00:05<00:11, 609.24it/s] 31%|██████████████████████                                                  | 2983/9741 [00:05<00:11, 604.32it/s] 31%|██████████████████████▌                                                 | 3045/9741 [00:05<00:11, 606.28it/s] 32%|██████████████████████▉                                                 | 3107/9741 [00:05<00:10, 607.74it/s] 33%|███████████████████████▍                                                | 3168/9741 [00:06<00:11, 589.17it/s] 33%|███████████████████████▊                                                | 3230/9741 [00:06<00:10, 595.90it/s] 34%|████████████████████████▎                                               | 3292/9741 [00:06<00:10, 600.29it/s] 34%|████████████████████████▊                                               | 3353/9741 [00:06<00:10, 602.77it/s] 35%|█████████████████████████▏                                              | 3414/9741 [00:06<00:10, 602.61it/s] 36%|█████████████████████████▋                                              | 3475/9741 [00:06<00:10, 604.72it/s] 36%|██████████████████████████▏                                             | 3536/9741 [00:06<00:10, 605.70it/s] 37%|██████████████████████████▌                                             | 3598/9741 [00:06<00:10, 607.06it/s] 38%|███████████████████████████                                             | 3659/9741 [00:06<00:10, 605.43it/s] 38%|███████████████████████████▌                                            | 3721/9741 [00:06<00:09, 607.51it/s] 39%|███████████████████████████▉                                            | 3783/9741 [00:07<00:09, 608.43it/s] 39%|████████████████████████████▍                                           | 3844/9741 [00:07<00:09, 606.87it/s] 40%|████████████████████████████▊                                           | 3906/9741 [00:07<00:09, 608.32it/s] 41%|█████████████████████████████▎                                          | 3968/9741 [00:07<00:09, 608.92it/s] 41%|█████████████████████████████▊                                          | 4029/9741 [00:07<00:09, 607.46it/s] 42%|██████████████████████████████▏                                         | 4090/9741 [00:07<00:09, 606.01it/s] 43%|██████████████████████████████▋                                         | 4151/9741 [00:07<00:09, 606.76it/s] 43%|███████████████████████████████▏                                        | 4212/9741 [00:07<00:09, 606.70it/s] 44%|███████████████████████████████▌                                        | 4273/9741 [00:07<00:09, 607.00it/s] 44%|████████████████████████████████                                        | 4334/9741 [00:07<00:08, 605.59it/s] 45%|████████████████████████████████▍                                       | 4396/9741 [00:08<00:08, 607.35it/s] 46%|████████████████████████████████▉                                       | 4457/9741 [00:08<00:08, 607.83it/s] 46%|█████████████████████████████████▍                                      | 4518/9741 [00:08<00:09, 574.24it/s] 47%|█████████████████████████████████▊                                      | 4579/9741 [00:08<00:08, 583.64it/s] 48%|██████████████████████████████████▎                                     | 4640/9741 [00:08<00:08, 591.11it/s] 48%|██████████████████████████████████▊                                     | 4702/9741 [00:08<00:08, 596.98it/s] 49%|███████████████████████████████████▏                                    | 4762/9741 [00:08<00:11, 429.09it/s] 50%|███████████████████████████████████▋                                    | 4823/9741 [00:08<00:10, 469.72it/s] 50%|████████████████████████████████████                                    | 4884/9741 [00:08<00:09, 504.02it/s] 51%|████████████████████████████████████▌                                   | 4944/9741 [00:09<00:09, 528.28it/s] 51%|████████████████████████████████████▉                                   | 5005/9741 [00:09<00:08, 550.14it/s] 52%|█████████████████████████████████████▍                                  | 5067/9741 [00:09<00:08, 567.37it/s] 53%|█████████████████████████████████████▉                                  | 5129/9741 [00:09<00:07, 579.80it/s] 53%|██████████████████████████████████████▎                                 | 5190/9741 [00:09<00:07, 586.07it/s] 54%|██████████████████████████████████████▊                                 | 5252/9741 [00:09<00:07, 593.26it/s] 55%|███████████████████████████████████████▎                                | 5313/9741 [00:09<00:07, 598.00it/s] 55%|███████████████████████████████████████▋                                | 5374/9741 [00:09<00:07, 601.37it/s] 56%|████████████████████████████████████████▏                               | 5435/9741 [00:09<00:07, 600.84it/s] 56%|████████████████████████████████████████▋                               | 5497/9741 [00:09<00:07, 605.93it/s] 57%|█████████████████████████████████████████                               | 5561/9741 [00:10<00:06, 614.87it/s] 58%|█████████████████████████████████████████▌                              | 5624/9741 [00:10<00:06, 617.65it/s] 58%|██████████████████████████████████████████                              | 5688/9741 [00:10<00:06, 622.46it/s] 59%|██████████████████████████████████████████▌                             | 5752/9741 [00:10<00:06, 625.61it/s] 60%|██████████████████████████████████████████▉                             | 5816/9741 [00:10<00:06, 627.34it/s] 60%|███████████████████████████████████████████▍                            | 5879/9741 [00:10<00:06, 626.33it/s] 61%|███████████████████████████████████████████▉                            | 5943/9741 [00:10<00:06, 628.16it/s] 62%|████████████████████████████████████████████▍                           | 6007/9741 [00:10<00:05, 629.67it/s] 62%|████████████████████████████████████████████▊                           | 6071/9741 [00:10<00:05, 630.87it/s] 63%|█████████████████████████████████████████████▎                          | 6135/9741 [00:11<00:05, 628.61it/s] 64%|█████████████████████████████████████████████▊                          | 6199/9741 [00:11<00:05, 629.40it/s] 64%|██████████████████████████████████████████████▎                         | 6262/9741 [00:11<00:05, 629.43it/s] 65%|██████████████████████████████████████████████▊                         | 6325/9741 [00:11<00:05, 627.53it/s] 66%|███████████████████████████████████████████████▏                        | 6389/9741 [00:11<00:05, 629.04it/s] 66%|███████████████████████████████████████████████▋                        | 6453/9741 [00:11<00:05, 630.18it/s] 67%|████████████████████████████████████████████████▏                       | 6517/9741 [00:11<00:05, 629.97it/s] 68%|████████████████████████████████████████████████▋                       | 6580/9741 [00:11<00:05, 627.95it/s] 68%|█████████████████████████████████████████████████                       | 6644/9741 [00:11<00:04, 629.50it/s] 69%|█████████████████████████████████████████████████▌                      | 6708/9741 [00:11<00:04, 630.41it/s] 70%|██████████████████████████████████████████████████                      | 6772/9741 [00:12<00:04, 628.90it/s] 70%|██████████████████████████████████████████████████▌                     | 6836/9741 [00:12<00:04, 630.58it/s] 71%|███████████████████████████████████████████████████                     | 6900/9741 [00:12<00:04, 631.21it/s] 71%|███████████████████████████████████████████████████▍                    | 6964/9741 [00:12<00:04, 631.12it/s] 72%|███████████████████████████████████████████████████▉                    | 7028/9741 [00:12<00:04, 628.78it/s] 73%|████████████████████████████████████████████████████▍                   | 7091/9741 [00:12<00:04, 624.23it/s] 73%|████████████████████████████████████████████████████▉                   | 7155/9741 [00:12<00:04, 626.26it/s] 74%|█████████████████████████████████████████████████████▎                  | 7218/9741 [00:12<00:04, 624.42it/s] 75%|█████████████████████████████████████████████████████▊                  | 7282/9741 [00:12<00:03, 626.24it/s] 75%|██████████████████████████████████████████████████████▎                 | 7346/9741 [00:12<00:03, 628.15it/s] 76%|██████████████████████████████████████████████████████▊                 | 7409/9741 [00:13<00:03, 628.67it/s] 77%|███████████████████████████████████████████████████████▏                | 7472/9741 [00:13<00:03, 597.21it/s] 77%|███████████████████████████████████████████████████████▋                | 7535/9741 [00:13<00:03, 606.26it/s] 78%|████████████████████████████████████████████████████████▏               | 7598/9741 [00:13<00:03, 612.88it/s] 79%|████████████████████████████████████████████████████████▋               | 7662/9741 [00:13<00:03, 617.99it/s] 79%|█████████████████████████████████████████████████████████               | 7725/9741 [00:13<00:03, 619.75it/s] 80%|█████████████████████████████████████████████████████████▌              | 7789/9741 [00:13<00:03, 623.12it/s] 81%|██████████████████████████████████████████████████████████              | 7853/9741 [00:13<00:03, 625.89it/s] 81%|██████████████████████████████████████████████████████████▌             | 7916/9741 [00:13<00:02, 625.73it/s] 82%|██████████████████████████████████████████████████████████▉             | 7980/9741 [00:13<00:02, 627.40it/s] 83%|███████████████████████████████████████████████████████████▍            | 8044/9741 [00:14<00:02, 628.34it/s] 83%|███████████████████████████████████████████████████████████▉            | 8108/9741 [00:14<00:02, 629.26it/s] 84%|████████████████████████████████████████████████████████████▍           | 8171/9741 [00:14<00:02, 617.56it/s] 85%|████████████████████████████████████████████████████████████▊           | 8234/9741 [00:14<00:02, 620.47it/s] 85%|█████████████████████████████████████████████████████████████▎          | 8297/9741 [00:14<00:02, 623.07it/s] 86%|█████████████████████████████████████████████████████████████▊          | 8360/9741 [00:14<00:02, 622.66it/s] 86%|██████████████████████████████████████████████████████████████▎         | 8424/9741 [00:14<00:02, 625.43it/s] 87%|██████████████████████████████████████████████████████████████▋         | 8487/9741 [00:14<00:02, 624.60it/s] 88%|███████████████████████████████████████████████████████████████▏        | 8550/9741 [00:14<00:01, 625.84it/s] 88%|███████████████████████████████████████████████████████████████▋        | 8613/9741 [00:14<00:01, 624.23it/s] 89%|████████████████████████████████████████████████████████████████▏       | 8676/9741 [00:15<00:01, 625.77it/s] 90%|████████████████████████████████████████████████████████████████▌       | 8739/9741 [00:15<00:01, 626.80it/s] 90%|█████████████████████████████████████████████████████████████████       | 8802/9741 [00:15<00:01, 624.74it/s] 91%|█████████████████████████████████████████████████████████████████▌      | 8865/9741 [00:15<00:01, 625.80it/s] 92%|█████████████████████████████████████████████████████████████████▉      | 8929/9741 [00:15<00:01, 627.27it/s] 92%|██████████████████████████████████████████████████████████████████▍     | 8992/9741 [00:15<00:01, 627.51it/s] 93%|██████████████████████████████████████████████████████████████████▉     | 9055/9741 [00:15<00:01, 625.30it/s] 94%|███████████████████████████████████████████████████████████████████▍    | 9118/9741 [00:15<00:00, 625.95it/s] 94%|███████████████████████████████████████████████████████████████████▊    | 9181/9741 [00:15<00:00, 619.75it/s] 95%|████████████████████████████████████████████████████████████████████▎   | 9244/9741 [00:15<00:00, 622.10it/s] 96%|████████████████████████████████████████████████████████████████████▊   | 9307/9741 [00:16<00:00, 621.54it/s] 96%|█████████████████████████████████████████████████████████████████████▎  | 9370/9741 [00:16<00:00, 623.75it/s] 97%|█████████████████████████████████████████████████████████████████████▋  | 9433/9741 [00:16<00:00, 625.26it/s] 97%|██████████████████████████████████████████████████████████████████████▏ | 9496/9741 [00:16<00:00, 623.12it/s] 98%|██████████████████████████████████████████████████████████████████████▋ | 9559/9741 [00:16<00:00, 624.62it/s] 99%|███████████████████████████████████████████████████████████████████████ | 9622/9741 [00:16<00:00, 625.79it/s] 99%|███████████████████████████████████████████████████████████████████████▌| 9685/9741 [00:16<00:00, 625.93it/s]100%|████████████████████████████████████████████████████████████████████████| 9741/9741 [00:16<00:00, 580.67it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:04<00:09,  4.86s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.33s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:11,  5.51s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:11,  5.54s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:09<00:04,  4.93s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.37s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.36s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.38s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.29s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.46s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.70s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.88s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.72s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.91s/it]
[2023-08-14 08:27:27,174] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.74s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.93s/it]
[2023-08-14 08:27:35,213] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-14 08:27:35,214] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-14 08:27:35,214] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-14 08:27:35,214] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-14 08:27:35,214] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-14 08:27:35,214] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-14 08:27:35,214] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-14 08:27:35,214] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-14 08:27:35,214] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-14 08:27:35,214] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-14 08:27:35,214] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-14 08:27:35,214] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f1357ba7fd0>
[2023-08-14 08:27:35,214] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f132e02ccd0>
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-14 08:27:35,215] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-14 08:27:35,216] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-14 08:27:35,216] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-14 08:27:35,216] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-14 08:27:35,216] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.41422247886657715 seconds
Loading extension module utils...
Time to load utils op: 0.4045395851135254 seconds
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.30435967445373535 seconds
Time to load utils op: 0.4043276309967041 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                                           | 0/50 [00:00<?, ?it/s]############### Example ###############
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following multiple choice question.

### Demonstration:
Input: Adam bought 3 kilograms of nuts and 2.5 kilograms of dried fruits at a store. One kilogram of nuts costs $12 and one kilogram of dried fruit costs $8. How much did his purchases cost?
Answer: 56

Input: Johns goes to the gym 3 times a week.  He spends 1 hour each day lifting weight. Additionally, he also spends a third of his weightlifting time warming up and doing cardio each day.  How many hours does he spend at the gym a week?
Answer: 4

Input: James has to refuel his plane.  It used to cost $200 to refill the tank.  He got an extra tank to double fuel capacity.  Fuel prices also went up by 20%.  How much does he pay now for fuel?
Answer: 480

Input: The number of goals scored in a game against Barca by exactly two players last season accounts for 20% of all goals scored in the league. If the players scored an equal number of goals, and the total number of goals scored in the league against Barca that season is 300, calculate the number of goals each of the two players scored.
Answer: 30

Input: Every day Tom drinks 5 12-oz cans of soda plus 64 ounces of water. How many ounces of fluid does he drink a week?
Answer: 868

Input: Stella and Twinkle are filling up a truck with a capacity of 6000 stone blocks at the rate of 250 blocks per hour per person. They work for four hours and are then joined by 6 other people who also work at the same rate. How many hours did filling the truck take?
Answer: 6

Input: Elijah drank 8.5 pints of coffee yesterday. Emilio drank 9.5 pints of water yesterday. How many cups of liquid did the two boys drink yesterday?
Answer: 36

Input: Doris works at the Widget Factory in the packing department. She puts 3 widgets in each carton, which are 4 inches wide, 4 inches long, and 5 inches tall. She then packs those cartons into a shipping box before sending it to the loading bay. The shipping boxes are 20 inches wide, 20 inches long, and 20 inches high. How many widgets get shipped in each shipping box?
Answer: 300

Input: Queenie earns $150 a day as a part-time clerk. She earns an additional $5 per hour as overtime pay. How much will Queenie receive for working 5 days with 4 hours overtime?
Answer: 770

Input: Jodi starts off walking 1 mile a day for 6 days a week.  On the second week, she walks 2 miles a day, 6 days a week.  On the third week, she walks 3 miles a day, 6 days a week. Finally on the fourth week, she walks 4 miles a day, 6 days a week.  How many miles has she walked in 4 weeks?
Answer: 60

Input: A club is going to get additional members so that they will have 5 more than twice their current number of their members. If the club has 10 members now, how many additional members do they need?
Answer: 15

Input: Andrea buys herself a pony for her 30th birthday. She pays $500/month to rent a pasture for it, $10 a day for food, and $60/lesson for two lessons a week. How much does she spend on her pony in a year?
Answer: 15890

### Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid

### Response:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o12-tgsm8k-s10-rFalse
Evaluating commonsenseqa :   2%|█                                                  | 1/50 [00:45<37:05, 45.41s/it]Evaluating commonsenseqa :   4%|██                                                 | 2/50 [01:31<36:25, 45.54s/it]Evaluating commonsenseqa :   6%|███                                                | 3/50 [02:16<35:45, 45.66s/it]Evaluating commonsenseqa :   8%|████                                               | 4/50 [02:55<32:47, 42.78s/it]Evaluating commonsenseqa :  10%|█████                                              | 5/50 [03:41<33:02, 44.06s/it]Evaluating commonsenseqa :  12%|██████                                             | 6/50 [04:27<32:47, 44.71s/it]Evaluating commonsenseqa :  14%|███████▏                                           | 7/50 [05:13<32:20, 45.13s/it]Evaluating commonsenseqa :  16%|████████▏                                          | 8/50 [05:59<31:48, 45.43s/it]Evaluating commonsenseqa :  18%|█████████▏                                         | 9/50 [06:42<30:36, 44.79s/it]Evaluating commonsenseqa :  20%|██████████                                        | 10/50 [07:23<29:00, 43.51s/it]Evaluating commonsenseqa :  22%|███████████                                       | 11/50 [08:07<28:25, 43.74s/it]Evaluating commonsenseqa :  24%|████████████                                      | 12/50 [08:54<28:10, 44.48s/it]Evaluating commonsenseqa :  26%|█████████████                                     | 13/50 [09:39<27:33, 44.68s/it]Evaluating commonsenseqa :  28%|██████████████                                    | 14/50 [10:25<27:05, 45.14s/it]Evaluating commonsenseqa :  30%|███████████████                                   | 15/50 [11:07<25:52, 44.36s/it]Evaluating commonsenseqa :  32%|████████████████                                  | 16/50 [11:47<24:23, 43.05s/it]Evaluating commonsenseqa :  34%|█████████████████                                 | 17/50 [12:29<23:28, 42.67s/it]Evaluating commonsenseqa :  36%|██████████████████                                | 18/50 [13:15<23:11, 43.48s/it]Evaluating commonsenseqa :  38%|███████████████████                               | 19/50 [13:35<18:56, 36.65s/it]Evaluating commonsenseqa :  40%|████████████████████                              | 20/50 [14:20<19:35, 39.18s/it]Evaluating commonsenseqa :  42%|█████████████████████                             | 21/50 [15:06<19:54, 41.19s/it]Evaluating commonsenseqa :  44%|██████████████████████                            | 22/50 [15:52<19:48, 42.45s/it]Evaluating commonsenseqa :  46%|███████████████████████                           | 23/50 [16:37<19:30, 43.36s/it]Evaluating commonsenseqa :  48%|████████████████████████                          | 24/50 [17:22<18:58, 43.78s/it]Evaluating commonsenseqa :  50%|█████████████████████████                         | 25/50 [17:35<14:20, 34.43s/it]Evaluating commonsenseqa :  52%|██████████████████████████                        | 26/50 [18:20<15:04, 37.71s/it]Evaluating commonsenseqa :  54%|███████████████████████████                       | 27/50 [19:06<15:22, 40.12s/it]Evaluating commonsenseqa :  56%|████████████████████████████                      | 28/50 [19:52<15:20, 41.85s/it]Evaluating commonsenseqa :  58%|████████████████████████████▉                     | 29/50 [20:38<15:05, 43.12s/it]Evaluating commonsenseqa :  60%|██████████████████████████████                    | 30/50 [21:24<14:41, 44.09s/it]Evaluating commonsenseqa :  62%|███████████████████████████████                   | 31/50 [22:09<14:04, 44.44s/it]Evaluating commonsenseqa :  64%|████████████████████████████████                  | 32/50 [22:55<13:27, 44.89s/it]Evaluating commonsenseqa :  66%|█████████████████████████████████                 | 33/50 [23:28<11:41, 41.28s/it]Evaluating commonsenseqa :  68%|██████████████████████████████████                | 34/50 [24:14<11:25, 42.82s/it]Evaluating commonsenseqa :  70%|███████████████████████████████████               | 35/50 [25:00<10:56, 43.75s/it]Evaluating commonsenseqa :  72%|████████████████████████████████████              | 36/50 [25:46<10:18, 44.20s/it]Evaluating commonsenseqa :  74%|█████████████████████████████████████             | 37/50 [26:14<08:34, 39.57s/it]Evaluating commonsenseqa :  76%|██████████████████████████████████████            | 38/50 [26:46<07:26, 37.20s/it]Evaluating commonsenseqa :  78%|███████████████████████████████████████           | 39/50 [27:32<07:18, 39.88s/it]Evaluating commonsenseqa :  80%|████████████████████████████████████████          | 40/50 [28:17<06:52, 41.30s/it]Evaluating commonsenseqa :  82%|█████████████████████████████████████████         | 41/50 [29:03<06:24, 42.69s/it]Evaluating commonsenseqa :  84%|██████████████████████████████████████████        | 42/50 [29:23<04:47, 35.99s/it]Evaluating commonsenseqa :  86%|███████████████████████████████████████████       | 43/50 [30:01<04:16, 36.59s/it]Evaluating commonsenseqa :  88%|████████████████████████████████████████████      | 44/50 [30:46<03:54, 39.02s/it]Evaluating commonsenseqa :  90%|█████████████████████████████████████████████     | 45/50 [31:15<03:00, 36.07s/it]Evaluating commonsenseqa :  92%|██████████████████████████████████████████████    | 46/50 [32:00<02:35, 38.87s/it]Evaluating commonsenseqa :  94%|███████████████████████████████████████████████   | 47/50 [32:46<02:02, 40.97s/it]Evaluating commonsenseqa :  96%|████████████████████████████████████████████████  | 48/50 [33:32<01:25, 42.54s/it]Evaluating commonsenseqa :  98%|█████████████████████████████████████████████████ | 49/50 [34:18<00:43, 43.32s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████| 50/50 [35:03<00:00, 43.84s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████| 50/50 [35:03<00:00, 42.06s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 3.7893} | lm_loss 7.7838 | avg. gen lenth: 241.884
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name gsm8k --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/out-domain/o13-tgsm8k-s10-rFalse --seed 10 --num-out-domain 13
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-14 09:03:41,780] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/out-domain/o13-tgsm8k-s10-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 13
  out_domain_data_name ......... gsm8k
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o13-tgsm8k-s10-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 10
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                    | 0/9741 [00:00<?, ?it/s]  0%|▎                                                                         | 38/9741 [00:00<00:25, 376.41it/s]  1%|▌                                                                         | 76/9741 [00:00<00:25, 376.97it/s]  1%|▊                                                                        | 114/9741 [00:00<00:25, 378.14it/s]  2%|█▏                                                                       | 152/9741 [00:00<00:25, 378.84it/s]  2%|█▍                                                                       | 190/9741 [00:00<00:25, 378.56it/s]  2%|█▋                                                                       | 228/9741 [00:00<00:25, 376.87it/s]  3%|█▉                                                                       | 266/9741 [00:00<00:25, 377.39it/s]  3%|██▎                                                                      | 304/9741 [00:00<00:25, 371.59it/s]  4%|██▌                                                                      | 342/9741 [00:00<00:25, 373.13it/s]  4%|██▊                                                                      | 380/9741 [00:01<00:24, 374.64it/s]  4%|███▏                                                                     | 418/9741 [00:01<00:24, 375.63it/s]  5%|███▍                                                                     | 456/9741 [00:01<00:25, 370.05it/s]  5%|███▋                                                                     | 494/9741 [00:01<00:24, 372.77it/s]  5%|███▉                                                                     | 533/9741 [00:01<00:24, 375.16it/s]  6%|████▎                                                                    | 572/9741 [00:01<00:24, 376.90it/s]  6%|████▌                                                                    | 611/9741 [00:01<00:24, 377.96it/s]  7%|████▊                                                                    | 650/9741 [00:01<00:24, 378.66it/s]  7%|█████▏                                                                   | 688/9741 [00:01<00:24, 374.60it/s]  7%|█████▍                                                                   | 726/9741 [00:01<00:24, 375.09it/s]  8%|█████▋                                                                   | 764/9741 [00:02<00:23, 376.19it/s]  8%|██████                                                                   | 803/9741 [00:02<00:23, 377.54it/s]  9%|██████▎                                                                  | 842/9741 [00:02<00:23, 378.37it/s]  9%|██████▌                                                                  | 881/9741 [00:02<00:23, 377.02it/s]  9%|██████▉                                                                  | 919/9741 [00:02<00:23, 377.48it/s] 10%|███████▏                                                                 | 957/9741 [00:02<00:23, 378.14it/s] 10%|███████▍                                                                 | 996/9741 [00:02<00:23, 379.06it/s] 11%|███████▋                                                                | 1035/9741 [00:02<00:22, 379.63it/s] 11%|███████▉                                                                | 1074/9741 [00:02<00:22, 380.00it/s] 11%|████████▏                                                               | 1113/9741 [00:02<00:22, 378.15it/s] 12%|████████▌                                                               | 1152/9741 [00:03<00:22, 378.88it/s] 12%|████████▊                                                               | 1190/9741 [00:03<00:22, 375.99it/s] 13%|█████████                                                               | 1228/9741 [00:03<00:22, 376.23it/s] 13%|█████████▎                                                              | 1266/9741 [00:03<00:22, 376.58it/s] 13%|█████████▋                                                              | 1304/9741 [00:03<00:22, 377.22it/s] 14%|█████████▉                                                              | 1346/9741 [00:03<00:21, 389.60it/s] 14%|██████████▍                                                             | 1404/9741 [00:03<00:18, 444.73it/s] 15%|██████████▊                                                             | 1462/9741 [00:03<00:17, 483.21it/s] 16%|███████████▏                                                            | 1520/9741 [00:03<00:16, 509.93it/s] 16%|███████████▋                                                            | 1577/9741 [00:03<00:15, 526.74it/s] 17%|████████████                                                            | 1635/9741 [00:04<00:15, 540.29it/s] 17%|████████████▌                                                           | 1693/9741 [00:04<00:14, 550.22it/s] 18%|████████████▉                                                           | 1751/9741 [00:04<00:14, 557.51it/s] 19%|█████████████▎                                                          | 1807/9741 [00:04<00:14, 537.06it/s] 19%|█████████████▊                                                          | 1863/9741 [00:04<00:14, 541.38it/s] 20%|██████████████▏                                                         | 1921/9741 [00:04<00:14, 550.02it/s] 20%|██████████████▋                                                         | 1979/9741 [00:04<00:13, 556.96it/s] 21%|███████████████                                                         | 2036/9741 [00:04<00:13, 558.62it/s] 21%|███████████████▍                                                        | 2093/9741 [00:04<00:13, 561.31it/s] 22%|███████████████▉                                                        | 2151/9741 [00:04<00:13, 564.61it/s] 23%|████████████████▎                                                       | 2209/9741 [00:05<00:13, 567.00it/s] 23%|████████████████▋                                                       | 2266/9741 [00:05<00:13, 566.28it/s] 24%|█████████████████▏                                                      | 2324/9741 [00:05<00:13, 568.24it/s] 24%|█████████████████▌                                                      | 2382/9741 [00:05<00:12, 569.90it/s] 25%|██████████████████                                                      | 2440/9741 [00:05<00:12, 571.02it/s] 26%|██████████████████▍                                                     | 2498/9741 [00:05<00:12, 568.77it/s] 26%|██████████████████▉                                                     | 2556/9741 [00:05<00:12, 569.36it/s] 27%|███████████████████▎                                                    | 2614/9741 [00:05<00:12, 570.39it/s] 27%|███████████████████▋                                                    | 2672/9741 [00:05<00:12, 570.45it/s] 28%|████████████████████▏                                                   | 2730/9741 [00:06<00:12, 567.52it/s] 29%|████████████████████▌                                                   | 2787/9741 [00:06<00:12, 566.69it/s] 29%|█████████████████████                                                   | 2844/9741 [00:06<00:12, 549.91it/s] 30%|█████████████████████▍                                                  | 2901/9741 [00:06<00:12, 553.26it/s] 30%|█████████████████████▊                                                  | 2957/9741 [00:06<00:12, 553.76it/s] 31%|██████████████████████▎                                                 | 3015/9741 [00:06<00:12, 559.39it/s] 32%|██████████████████████▋                                                 | 3071/9741 [00:06<00:12, 546.36it/s] 32%|███████████████████████▏                                                | 3129/9741 [00:06<00:11, 554.55it/s] 33%|███████████████████████▌                                                | 3186/9741 [00:06<00:11, 557.65it/s] 33%|███████████████████████▉                                                | 3244/9741 [00:06<00:11, 562.56it/s] 34%|████████████████████████▍                                               | 3302/9741 [00:07<00:11, 565.70it/s] 34%|████████████████████████▊                                               | 3360/9741 [00:07<00:11, 567.36it/s] 35%|█████████████████████████▎                                              | 3417/9741 [00:07<00:11, 566.22it/s] 36%|█████████████████████████▋                                              | 3474/9741 [00:07<00:11, 523.86it/s] 36%|██████████████████████████                                              | 3530/9741 [00:07<00:11, 533.37it/s] 37%|██████████████████████████▌                                             | 3587/9741 [00:07<00:11, 542.63it/s] 37%|██████████████████████████▉                                             | 3644/9741 [00:07<00:11, 548.59it/s] 38%|███████████████████████████▎                                            | 3702/9741 [00:07<00:10, 555.17it/s] 39%|███████████████████████████▊                                            | 3760/9741 [00:07<00:10, 560.50it/s] 39%|████████████████████████████▏                                           | 3817/9741 [00:07<00:10, 562.77it/s] 40%|████████████████████████████▋                                           | 3874/9741 [00:08<00:10, 562.19it/s] 40%|█████████████████████████████                                           | 3932/9741 [00:08<00:10, 564.98it/s] 41%|█████████████████████████████▍                                          | 3989/9741 [00:08<00:10, 566.45it/s] 42%|█████████████████████████████▉                                          | 4046/9741 [00:08<00:10, 566.27it/s] 42%|██████████████████████████████▎                                         | 4103/9741 [00:08<00:09, 564.42it/s] 43%|██████████████████████████████▋                                         | 4160/9741 [00:08<00:09, 565.81it/s] 43%|███████████████████████████████▏                                        | 4217/9741 [00:08<00:09, 566.89it/s] 44%|███████████████████████████████▌                                        | 4274/9741 [00:08<00:09, 567.10it/s] 44%|████████████████████████████████                                        | 4331/9741 [00:08<00:09, 564.78it/s] 45%|████████████████████████████████▍                                       | 4389/9741 [00:08<00:09, 566.55it/s] 46%|████████████████████████████████▊                                       | 4446/9741 [00:09<00:09, 567.37it/s] 46%|█████████████████████████████████▎                                      | 4503/9741 [00:09<00:09, 563.69it/s] 47%|█████████████████████████████████▋                                      | 4560/9741 [00:09<00:09, 532.69it/s] 47%|██████████████████████████████████▏                                     | 4618/9741 [00:09<00:09, 544.01it/s] 48%|██████████████████████████████████▌                                     | 4676/9741 [00:09<00:09, 552.16it/s] 49%|██████████████████████████████████▉                                     | 4734/9741 [00:09<00:08, 557.61it/s] 49%|███████████████████████████████████▍                                    | 4790/9741 [00:09<00:12, 399.98it/s] 50%|███████████████████████████████████▊                                    | 4847/9741 [00:09<00:11, 438.98it/s] 50%|████████████████████████████████████▏                                   | 4904/9741 [00:10<00:10, 471.31it/s] 51%|████████████████████████████████████▋                                   | 4960/9741 [00:10<00:09, 494.27it/s] 52%|█████████████████████████████████████                                   | 5018/9741 [00:10<00:09, 515.24it/s] 52%|█████████████████████████████████████▌                                  | 5076/9741 [00:10<00:08, 530.85it/s] 53%|█████████████████████████████████████▉                                  | 5133/9741 [00:10<00:08, 541.54it/s] 53%|██████████████████████████████████████▎                                 | 5190/9741 [00:10<00:08, 547.55it/s] 54%|██████████████████████████████████████▊                                 | 5248/9741 [00:10<00:08, 554.27it/s] 54%|███████████████████████████████████████▏                                | 5306/9741 [00:10<00:07, 559.11it/s] 55%|███████████████████████████████████████▋                                | 5363/9741 [00:10<00:07, 561.88it/s] 56%|████████████████████████████████████████                                | 5420/9741 [00:10<00:07, 561.84it/s] 56%|████████████████████████████████████████▍                               | 5478/9741 [00:11<00:07, 564.81it/s] 57%|████████████████████████████████████████▉                               | 5538/9741 [00:11<00:07, 572.55it/s] 57%|█████████████████████████████████████████▎                              | 5597/9741 [00:11<00:07, 575.99it/s] 58%|█████████████████████████████████████████▊                              | 5655/9741 [00:11<00:07, 576.60it/s] 59%|██████████████████████████████████████████▏                             | 5715/9741 [00:11<00:06, 580.70it/s] 59%|██████████████████████████████████████████▋                             | 5774/9741 [00:11<00:07, 502.36it/s] 60%|███████████████████████████████████████████                             | 5827/9741 [00:11<00:08, 460.85it/s] 60%|███████████████████████████████████████████▍                            | 5875/9741 [00:11<00:08, 434.25it/s] 61%|███████████████████████████████████████████▊                            | 5920/9741 [00:12<00:09, 418.66it/s] 61%|████████████████████████████████████████████                            | 5963/9741 [00:12<00:09, 411.09it/s] 62%|████████████████████████████████████████████▍                           | 6005/9741 [00:12<00:09, 405.46it/s] 62%|████████████████████████████████████████████▋                           | 6046/9741 [00:12<00:09, 401.72it/s] 62%|████████████████████████████████████████████▉                           | 6087/9741 [00:12<00:09, 396.24it/s] 63%|█████████████████████████████████████████████▎                          | 6127/9741 [00:12<00:09, 390.65it/s] 63%|█████████████████████████████████████████████▌                          | 6167/9741 [00:12<00:09, 390.25it/s] 64%|█████████████████████████████████████████████▉                          | 6207/9741 [00:12<00:09, 390.35it/s] 64%|██████████████████████████████████████████████▏                         | 6247/9741 [00:12<00:08, 389.72it/s] 65%|██████████████████████████████████████████████▍                         | 6287/9741 [00:12<00:08, 389.91it/s] 65%|██████████████████████████████████████████████▊                         | 6327/9741 [00:13<00:08, 387.50it/s] 65%|███████████████████████████████████████████████                         | 6366/9741 [00:13<00:08, 387.98it/s] 66%|███████████████████████████████████████████████▍                        | 6423/9741 [00:13<00:07, 440.86it/s] 67%|███████████████████████████████████████████████▉                        | 6482/9741 [00:13<00:06, 484.35it/s] 67%|████████████████████████████████████████████████▎                       | 6541/9741 [00:13<00:06, 513.74it/s] 68%|████████████████████████████████████████████████▊                       | 6600/9741 [00:13<00:05, 535.86it/s] 68%|█████████████████████████████████████████████████▏                      | 6660/9741 [00:13<00:05, 552.16it/s] 69%|█████████████████████████████████████████████████▋                      | 6720/9741 [00:13<00:05, 563.64it/s] 70%|██████████████████████████████████████████████████                      | 6779/9741 [00:13<00:05, 568.95it/s] 70%|██████████████████████████████████████████████████▌                     | 6838/9741 [00:13<00:05, 574.76it/s] 71%|██████████████████████████████████████████████████▉                     | 6897/9741 [00:14<00:04, 579.19it/s] 71%|███████████████████████████████████████████████████▍                    | 6956/9741 [00:14<00:04, 582.02it/s] 72%|███████████████████████████████████████████████████▊                    | 7015/9741 [00:14<00:04, 572.35it/s] 73%|████████████████████████████████████████████████████▎                   | 7074/9741 [00:14<00:04, 576.49it/s] 73%|████████████████████████████████████████████████████▋                   | 7133/9741 [00:14<00:04, 580.42it/s] 74%|█████████████████████████████████████████████████████▏                  | 7193/9741 [00:14<00:04, 583.54it/s] 74%|█████████████████████████████████████████████████████▌                  | 7252/9741 [00:14<00:04, 581.50it/s] 75%|██████████████████████████████████████████████████████                  | 7311/9741 [00:14<00:04, 583.79it/s] 76%|██████████████████████████████████████████████████████▍                 | 7370/9741 [00:14<00:04, 585.04it/s] 76%|██████████████████████████████████████████████████████▉                 | 7429/9741 [00:14<00:03, 585.96it/s] 77%|███████████████████████████████████████████████████████▎                | 7488/9741 [00:15<00:04, 549.71it/s] 77%|███████████████████████████████████████████████████████▊                | 7547/9741 [00:15<00:03, 559.91it/s] 78%|████████████████████████████████████████████████████████▏               | 7606/9741 [00:15<00:03, 567.87it/s] 79%|████████████████████████████████████████████████████████▋               | 7665/9741 [00:15<00:03, 572.58it/s] 79%|█████████████████████████████████████████████████████████               | 7723/9741 [00:15<00:03, 574.10it/s] 80%|█████████████████████████████████████████████████████████▌              | 7782/9741 [00:15<00:03, 578.31it/s] 80%|█████████████████████████████████████████████████████████▉              | 7841/9741 [00:15<00:03, 580.42it/s] 81%|██████████████████████████████████████████████████████████▍             | 7900/9741 [00:15<00:03, 579.58it/s] 82%|██████████████████████████████████████████████████████████▊             | 7959/9741 [00:15<00:03, 575.49it/s] 82%|███████████████████████████████████████████████████████████▎            | 8018/9741 [00:16<00:02, 578.27it/s] 83%|███████████████████████████████████████████████████████████▋            | 8077/9741 [00:16<00:02, 580.67it/s] 84%|████████████████████████████████████████████████████████████▏           | 8136/9741 [00:16<00:02, 580.76it/s] 84%|████████████████████████████████████████████████████████████▌           | 8195/9741 [00:16<00:02, 582.46it/s] 85%|█████████████████████████████████████████████████████████████           | 8254/9741 [00:16<00:02, 583.33it/s] 85%|█████████████████████████████████████████████████████████████▍          | 8313/9741 [00:16<00:02, 579.13it/s] 86%|█████████████████████████████████████████████████████████████▊          | 8371/9741 [00:16<00:02, 578.93it/s] 87%|██████████████████████████████████████████████████████████████▎         | 8430/9741 [00:16<00:02, 581.21it/s] 87%|██████████████████████████████████████████████████████████████▋         | 8489/9741 [00:16<00:02, 582.37it/s] 88%|███████████████████████████████████████████████████████████████▏        | 8548/9741 [00:16<00:02, 582.55it/s] 88%|███████████████████████████████████████████████████████████████▌        | 8607/9741 [00:17<00:01, 581.57it/s] 89%|████████████████████████████████████████████████████████████████        | 8666/9741 [00:17<00:01, 581.90it/s] 90%|████████████████████████████████████████████████████████████████▍       | 8725/9741 [00:17<00:01, 582.66it/s] 90%|████████████████████████████████████████████████████████████████▉       | 8784/9741 [00:17<00:01, 582.93it/s] 91%|█████████████████████████████████████████████████████████████████▎      | 8843/9741 [00:17<00:01, 580.30it/s] 91%|█████████████████████████████████████████████████████████████████▊      | 8902/9741 [00:17<00:01, 582.06it/s] 92%|██████████████████████████████████████████████████████████████████▏     | 8961/9741 [00:17<00:01, 579.80it/s] 93%|██████████████████████████████████████████████████████████████████▋     | 9020/9741 [00:17<00:01, 580.34it/s] 93%|███████████████████████████████████████████████████████████████████     | 9079/9741 [00:17<00:01, 578.19it/s] 94%|███████████████████████████████████████████████████████████████████▌    | 9138/9741 [00:17<00:01, 579.05it/s] 94%|███████████████████████████████████████████████████████████████████▉    | 9197/9741 [00:18<00:00, 580.38it/s] 95%|████████████████████████████████████████████████████████████████████▍   | 9256/9741 [00:18<00:00, 578.89it/s] 96%|████████████████████████████████████████████████████████████████████▊   | 9315/9741 [00:18<00:00, 580.48it/s] 96%|█████████████████████████████████████████████████████████████████████▎  | 9374/9741 [00:18<00:00, 581.69it/s] 97%|█████████████████████████████████████████████████████████████████████▋  | 9433/9741 [00:18<00:00, 581.93it/s] 97%|██████████████████████████████████████████████████████████████████████▏ | 9492/9741 [00:18<00:00, 579.48it/s] 98%|██████████████████████████████████████████████████████████████████████▌ | 9551/9741 [00:18<00:00, 580.31it/s] 99%|███████████████████████████████████████████████████████████████████████ | 9610/9741 [00:18<00:00, 580.49it/s] 99%|███████████████████████████████████████████████████████████████████████▍| 9669/9741 [00:18<00:00, 580.66it/s]100%|███████████████████████████████████████████████████████████████████████▉| 9728/9741 [00:18<00:00, 578.54it/s]100%|████████████████████████████████████████████████████████████████████████| 9741/9741 [00:18<00:00, 513.40it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.21s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.01s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.48s/it]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:09<00:04,  4.89s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.37s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.37s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.29s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.47s/it]
Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:11,  5.64s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.77s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.91s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.78s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.95s/it]
Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:11<00:05,  5.52s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.79s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.00s/it]
[2023-08-14 09:04:59,932] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
[2023-08-14 09:05:07,327] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-14 09:05:07,328] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-14 09:05:07,328] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-14 09:05:07,328] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-14 09:05:07,328] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-14 09:05:07,328] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-14 09:05:07,328] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-14 09:05:07,328] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-14 09:05:07,328] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-14 09:05:07,328] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-14 09:05:07,328] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-14 09:05:07,328] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7facdbe3efd0>
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7facb5b9acd0>
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-14 09:05:07,329] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-14 09:05:07,330] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-14 09:05:07,330] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-14 09:05:07,330] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-14 09:05:07,330] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-14 09:05:07,330] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-14 09:05:07,330] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.4906647205352783 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Loading extension module utils...
Evaluating commonsenseqa :   0%|                                                           | 0/50 [00:00<?, ?it/s]############### Example ###############
Time to load utils op: 0.4047670364379883 seconds
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following multiple choice question.

### Demonstration:
Input: Adam bought 3 kilograms of nuts and 2.5 kilograms of dried fruits at a store. One kilogram of nuts costs $12 and one kilogram of dried fruit costs $8. How much did his purchases cost?
Answer: 56

Input: Johns goes to the gym 3 times a week.  He spends 1 hour each day lifting weight. Additionally, he also spends a third of his weightlifting time warming up and doing cardio each day.  How many hours does he spend at the gym a week?
Answer: 4

Input: James has to refuel his plane.  It used to cost $200 to refill the tank.  He got an extra tank to double fuel capacity.  Fuel prices also went up by 20%.  How much does he pay now for fuel?
Answer: 480

Input: The number of goals scored in a game against Barca by exactly two players last season accounts for 20% of all goals scored in the league. If the players scored an equal number of goals, and the total number of goals scored in the league against Barca that season is 300, calculate the number of goals each of the two players scored.
Answer: 30

Input: Every day Tom drinks 5 12-oz cans of soda plus 64 ounces of water. How many ounces of fluid does he drink a week?
Answer: 868

Input: Stella and Twinkle are filling up a truck with a capacity of 6000 stone blocks at the rate of 250 blocks per hour per person. They work for four hours and are then joined by 6 other people who also work at the same rate. How many hours did filling the truck take?
Answer: 6

Input: Elijah drank 8.5 pints of coffee yesterday. Emilio drank 9.5 pints of water yesterday. How many cups of liquid did the two boys drink yesterday?
Answer: 36

Input: Doris works at the Widget Factory in the packing department. She puts 3 widgets in each carton, which are 4 inches wide, 4 inches long, and 5 inches tall. She then packs those cartons into a shipping box before sending it to the loading bay. The shipping boxes are 20 inches wide, 20 inches long, and 20 inches high. How many widgets get shipped in each shipping box?
Answer: 300

Input: Queenie earns $150 a day as a part-time clerk. She earns an additional $5 per hour as overtime pay. How much will Queenie receive for working 5 days with 4 hours overtime?
Answer: 770

Input: Jodi starts off walking 1 mile a day for 6 days a week.  On the second week, she walks 2 miles a day, 6 days a week.  On the third week, she walks 3 miles a day, 6 days a week. Finally on the fourth week, she walks 4 miles a day, 6 days a week.  How many miles has she walked in 4 weeks?
Answer: 60

Input: A club is going to get additional members so that they will have 5 more than twice their current number of their members. If the club has 10 members now, how many additional members do they need?
Answer: 15

Input: Andrea buys herself a pony for her 30th birthday. She pays $500/month to rent a pasture for it, $10 a day for food, and $60/lesson for two lessons a week. How much does she spend on her pony in a year?
Answer: 15890

Input: A pet shop has 2 puppies and some kittens. A puppy costs $20, and a kitten costs $15. If the stock is worth $100, how many kittens does the pet shop have?
Answer: 4

### Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid

### Response:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o13-tgsm8k-s10-rFalse
Loading extension module utils...
Time to load utils op: 0.5050666332244873 seconds
Loading extension module utils...
Time to load utils op: 0.5046811103820801 seconds
Evaluating commonsenseqa :   2%|█                                                  | 1/50 [00:45<37:15, 45.62s/it]Evaluating commonsenseqa :   4%|██                                                 | 2/50 [01:30<36:14, 45.30s/it]Evaluating commonsenseqa :   6%|███                                                | 3/50 [02:16<35:33, 45.39s/it]Evaluating commonsenseqa :   8%|████                                               | 4/50 [03:00<34:31, 45.03s/it]Evaluating commonsenseqa :  10%|█████                                              | 5/50 [03:45<33:43, 44.98s/it]Evaluating commonsenseqa :  12%|██████                                             | 6/50 [04:30<33:01, 45.03s/it]Evaluating commonsenseqa :  14%|███████▏                                           | 7/50 [05:16<32:29, 45.35s/it]Evaluating commonsenseqa :  16%|████████▏                                          | 8/50 [05:34<25:37, 36.60s/it]Evaluating commonsenseqa :  18%|█████████▏                                         | 9/50 [06:19<26:53, 39.36s/it]Evaluating commonsenseqa :  20%|██████████                                        | 10/50 [06:54<25:19, 37.98s/it]Evaluating commonsenseqa :  22%|███████████                                       | 11/50 [07:11<20:21, 31.31s/it]Evaluating commonsenseqa :  24%|████████████                                      | 12/50 [07:49<21:13, 33.51s/it]Evaluating commonsenseqa :  26%|█████████████                                     | 13/50 [08:34<22:48, 36.97s/it]Evaluating commonsenseqa :  28%|██████████████                                    | 14/50 [09:20<23:48, 39.69s/it]Evaluating commonsenseqa :  30%|███████████████                                   | 15/50 [10:06<24:14, 41.56s/it]Evaluating commonsenseqa :  32%|████████████████                                  | 16/50 [10:51<24:08, 42.59s/it]Evaluating commonsenseqa :  34%|█████████████████                                 | 17/50 [11:36<23:48, 43.29s/it]Evaluating commonsenseqa :  36%|██████████████████                                | 18/50 [12:22<23:29, 44.04s/it]Evaluating commonsenseqa :  38%|███████████████████                               | 19/50 [12:47<19:51, 38.42s/it]Evaluating commonsenseqa :  40%|████████████████████                              | 20/50 [13:24<19:04, 38.14s/it]Evaluating commonsenseqa :  42%|█████████████████████                             | 21/50 [14:10<19:29, 40.34s/it]Evaluating commonsenseqa :  44%|██████████████████████                            | 22/50 [14:55<19:28, 41.74s/it]Evaluating commonsenseqa :  46%|███████████████████████                           | 23/50 [15:40<19:15, 42.79s/it]Evaluating commonsenseqa :  48%|████████████████████████                          | 24/50 [16:25<18:52, 43.54s/it]Evaluating commonsenseqa :  50%|█████████████████████████                         | 25/50 [17:11<18:21, 44.05s/it]Evaluating commonsenseqa :  52%|██████████████████████████                        | 26/50 [17:44<16:21, 40.89s/it]Evaluating commonsenseqa :  54%|███████████████████████████                       | 27/50 [18:12<14:09, 36.92s/it]Evaluating commonsenseqa :  56%|████████████████████████████                      | 28/50 [18:57<14:25, 39.35s/it]Evaluating commonsenseqa :  58%|████████████████████████████▉                     | 29/50 [19:42<14:23, 41.14s/it]Evaluating commonsenseqa :  60%|██████████████████████████████                    | 30/50 [20:16<12:55, 38.80s/it]Evaluating commonsenseqa :  62%|███████████████████████████████                   | 31/50 [21:00<12:52, 40.64s/it]Evaluating commonsenseqa :  64%|████████████████████████████████                  | 32/50 [21:46<12:36, 42.01s/it]Evaluating commonsenseqa :  66%|█████████████████████████████████                 | 33/50 [22:32<12:15, 43.29s/it]Evaluating commonsenseqa :  68%|██████████████████████████████████                | 34/50 [23:17<11:41, 43.87s/it]Evaluating commonsenseqa :  70%|███████████████████████████████████               | 35/50 [24:02<11:03, 44.26s/it]Evaluating commonsenseqa :  72%|████████████████████████████████████              | 36/50 [24:37<09:37, 41.27s/it]Evaluating commonsenseqa :  74%|█████████████████████████████████████             | 37/50 [25:21<09:09, 42.29s/it]Evaluating commonsenseqa :  76%|██████████████████████████████████████            | 38/50 [26:06<08:37, 43.11s/it]Evaluating commonsenseqa :  78%|███████████████████████████████████████           | 39/50 [26:51<07:59, 43.61s/it]Evaluating commonsenseqa :  80%|████████████████████████████████████████          | 40/50 [27:34<07:14, 43.42s/it]Evaluating commonsenseqa :  82%|█████████████████████████████████████████         | 41/50 [28:19<06:35, 43.90s/it]Evaluating commonsenseqa :  84%|██████████████████████████████████████████        | 42/50 [29:04<05:54, 44.30s/it]Evaluating commonsenseqa :  86%|███████████████████████████████████████████       | 43/50 [29:49<05:10, 44.34s/it]Evaluating commonsenseqa :  88%|████████████████████████████████████████████      | 44/50 [30:34<04:27, 44.57s/it]Evaluating commonsenseqa :  90%|█████████████████████████████████████████████     | 45/50 [30:46<02:53, 34.78s/it]Evaluating commonsenseqa :  92%|██████████████████████████████████████████████    | 46/50 [31:31<02:31, 37.83s/it]Evaluating commonsenseqa :  94%|███████████████████████████████████████████████   | 47/50 [32:17<02:01, 40.42s/it]Evaluating commonsenseqa :  96%|████████████████████████████████████████████████  | 48/50 [33:03<01:24, 42.13s/it]Evaluating commonsenseqa :  98%|█████████████████████████████████████████████████ | 49/50 [33:48<00:42, 42.90s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████| 50/50 [34:34<00:00, 43.71s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████| 50/50 [34:34<00:00, 41.48s/it]
name: commonsenseqa | {'exact_match': 0.4, 'rougeL': 3.7983} | lm_loss 7.8025 | avg. gen lenth: 226.556
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name gsm8k --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/out-domain/o14-tgsm8k-s10-rFalse --seed 10 --num-out-domain 14
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-14 09:39:50,442] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/out-domain/o14-tgsm8k-s10-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 14
  out_domain_data_name ......... gsm8k
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o14-tgsm8k-s10-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 10
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                    | 0/9741 [00:00<?, ?it/s]  0%|▎                                                                         | 34/9741 [00:00<00:28, 339.17it/s]  1%|▌                                                                         | 69/9741 [00:00<00:28, 340.59it/s]  1%|▊                                                                        | 104/9741 [00:00<00:28, 341.36it/s]  1%|█                                                                        | 139/9741 [00:00<00:28, 341.68it/s]  2%|█▎                                                                       | 174/9741 [00:00<00:27, 341.76it/s]  2%|█▌                                                                       | 209/9741 [00:00<00:28, 339.36it/s]  2%|█▊                                                                       | 243/9741 [00:00<00:28, 334.28it/s]  3%|██                                                                       | 277/9741 [00:00<00:28, 335.43it/s]  3%|██▎                                                                      | 312/9741 [00:00<00:27, 337.00it/s]  4%|██▌                                                                      | 346/9741 [00:01<00:27, 337.82it/s]  4%|██▊                                                                      | 381/9741 [00:01<00:27, 338.74it/s]  4%|███                                                                      | 415/9741 [00:01<00:27, 339.04it/s]  5%|███▎                                                                     | 449/9741 [00:01<00:27, 337.04it/s]  5%|███▌                                                                     | 483/9741 [00:01<00:27, 337.72it/s]  5%|███▉                                                                     | 518/9741 [00:01<00:27, 338.97it/s]  6%|████▏                                                                    | 553/9741 [00:01<00:27, 339.51it/s]  6%|████▍                                                                    | 587/9741 [00:01<00:27, 337.24it/s]  6%|████▋                                                                    | 621/9741 [00:01<00:27, 337.59it/s]  7%|████▉                                                                    | 655/9741 [00:01<00:26, 336.64it/s]  7%|█████▏                                                                   | 690/9741 [00:02<00:26, 338.13it/s]  7%|█████▍                                                                   | 725/9741 [00:02<00:26, 338.76it/s]  8%|█████▋                                                                   | 760/9741 [00:02<00:26, 340.54it/s]  8%|██████                                                                   | 812/9741 [00:02<00:22, 392.80it/s]  9%|██████▍                                                                  | 864/9741 [00:02<00:20, 429.31it/s]  9%|██████▊                                                                  | 915/9741 [00:02<00:19, 452.10it/s] 10%|███████▏                                                                 | 967/9741 [00:02<00:18, 470.76it/s] 10%|███████▌                                                                | 1019/9741 [00:02<00:18, 483.63it/s] 11%|███████▉                                                                | 1071/9741 [00:02<00:17, 493.59it/s] 12%|████████▎                                                               | 1122/9741 [00:02<00:17, 498.05it/s] 12%|████████▋                                                               | 1173/9741 [00:03<00:17, 500.39it/s] 13%|█████████                                                               | 1225/9741 [00:03<00:16, 504.30it/s] 13%|█████████▍                                                              | 1277/9741 [00:03<00:16, 507.48it/s] 14%|█████████▊                                                              | 1329/9741 [00:03<00:16, 509.62it/s] 14%|██████████▏                                                             | 1380/9741 [00:03<00:16, 508.47it/s] 15%|██████████▌                                                             | 1431/9741 [00:03<00:16, 508.50it/s] 15%|██████████▉                                                             | 1483/9741 [00:03<00:16, 510.30it/s] 16%|███████████▎                                                            | 1535/9741 [00:03<00:16, 511.41it/s] 16%|███████████▋                                                            | 1587/9741 [00:03<00:16, 509.42it/s] 17%|████████████                                                            | 1639/9741 [00:03<00:15, 510.77it/s] 17%|████████████▍                                                           | 1691/9741 [00:04<00:15, 512.07it/s] 18%|████████████▉                                                           | 1743/9741 [00:04<00:15, 512.60it/s] 18%|█████████████▎                                                          | 1795/9741 [00:04<00:16, 489.03it/s] 19%|█████████████▋                                                          | 1845/9741 [00:04<00:16, 491.10it/s] 19%|██████████████                                                          | 1897/9741 [00:04<00:15, 498.04it/s] 20%|██████████████▍                                                         | 1949/9741 [00:04<00:15, 502.44it/s] 21%|██████████████▊                                                         | 2001/9741 [00:04<00:15, 505.60it/s] 21%|███████████████▏                                                        | 2052/9741 [00:04<00:15, 505.17it/s] 22%|███████████████▌                                                        | 2104/9741 [00:04<00:15, 506.99it/s] 22%|███████████████▉                                                        | 2156/9741 [00:04<00:14, 508.52it/s] 23%|████████████████▎                                                       | 2208/9741 [00:05<00:14, 510.25it/s] 23%|████████████████▋                                                       | 2260/9741 [00:05<00:14, 508.88it/s] 24%|█████████████████                                                       | 2312/9741 [00:05<00:14, 510.42it/s] 24%|█████████████████▍                                                      | 2364/9741 [00:05<00:14, 511.25it/s] 25%|█████████████████▊                                                      | 2416/9741 [00:05<00:14, 512.24it/s] 25%|██████████████████▏                                                     | 2468/9741 [00:05<00:14, 512.73it/s] 26%|██████████████████▋                                                     | 2520/9741 [00:05<00:14, 508.58it/s] 26%|███████████████████                                                     | 2572/9741 [00:05<00:14, 509.41it/s] 27%|███████████████████▍                                                    | 2624/9741 [00:05<00:13, 510.87it/s] 27%|███████████████████▊                                                    | 2676/9741 [00:06<00:13, 511.01it/s] 28%|████████████████████▏                                                   | 2728/9741 [00:06<00:13, 508.80it/s] 29%|████████████████████▌                                                   | 2780/9741 [00:06<00:13, 509.56it/s] 29%|████████████████████▉                                                   | 2832/9741 [00:06<00:13, 510.35it/s] 30%|█████████████████████▎                                                  | 2884/9741 [00:06<00:13, 511.88it/s] 30%|█████████████████████▋                                                  | 2936/9741 [00:06<00:13, 510.33it/s] 31%|██████████████████████                                                  | 2988/9741 [00:06<00:13, 511.96it/s] 31%|██████████████████████▍                                                 | 3040/9741 [00:06<00:13, 512.87it/s] 32%|██████████████████████▊                                                 | 3092/9741 [00:06<00:12, 512.70it/s] 32%|███████████████████████▏                                                | 3144/9741 [00:06<00:12, 513.41it/s] 33%|███████████████████████▌                                                | 3196/9741 [00:07<00:12, 512.04it/s] 33%|████████████████████████                                                | 3248/9741 [00:07<00:12, 512.98it/s] 34%|████████████████████████▍                                               | 3300/9741 [00:07<00:12, 513.38it/s] 34%|████████████████████████▊                                               | 3352/9741 [00:07<00:12, 513.41it/s] 35%|█████████████████████████▏                                              | 3404/9741 [00:07<00:12, 509.62it/s] 35%|█████████████████████████▌                                              | 3456/9741 [00:07<00:12, 510.91it/s] 36%|█████████████████████████▉                                              | 3508/9741 [00:07<00:12, 511.41it/s] 37%|██████████████████████████▎                                             | 3560/9741 [00:07<00:12, 512.26it/s] 37%|██████████████████████████▋                                             | 3612/9741 [00:07<00:12, 509.93it/s] 38%|███████████████████████████                                             | 3664/9741 [00:07<00:11, 510.92it/s] 38%|███████████████████████████▍                                            | 3716/9741 [00:08<00:11, 512.20it/s] 39%|███████████████████████████▊                                            | 3768/9741 [00:08<00:11, 512.59it/s] 39%|████████████████████████████▏                                           | 3820/9741 [00:08<00:11, 512.55it/s] 40%|████████████████████████████▌                                           | 3872/9741 [00:08<00:11, 510.78it/s] 40%|█████████████████████████████                                           | 3924/9741 [00:08<00:11, 511.03it/s] 41%|█████████████████████████████▍                                          | 3976/9741 [00:08<00:11, 511.57it/s] 41%|█████████████████████████████▊                                          | 4028/9741 [00:08<00:11, 512.29it/s] 42%|██████████████████████████████▏                                         | 4080/9741 [00:08<00:11, 510.14it/s] 42%|██████████████████████████████▌                                         | 4132/9741 [00:08<00:10, 510.96it/s] 43%|██████████████████████████████▉                                         | 4184/9741 [00:08<00:10, 511.32it/s] 43%|███████████████████████████████▎                                        | 4236/9741 [00:09<00:10, 509.78it/s] 44%|███████████████████████████████▋                                        | 4287/9741 [00:09<00:10, 508.57it/s] 45%|████████████████████████████████                                        | 4339/9741 [00:09<00:10, 509.74it/s] 45%|████████████████████████████████▍                                       | 4391/9741 [00:09<00:10, 510.36it/s] 46%|████████████████████████████████▊                                       | 4443/9741 [00:09<00:10, 510.08it/s] 46%|█████████████████████████████████▏                                      | 4495/9741 [00:09<00:10, 510.83it/s] 47%|█████████████████████████████████▌                                      | 4547/9741 [00:09<00:10, 480.86it/s] 47%|█████████████████████████████████▉                                      | 4599/9741 [00:09<00:10, 490.05it/s] 48%|██████████████████████████████████▍                                     | 4651/9741 [00:09<00:10, 496.69it/s] 48%|██████████████████████████████████▊                                     | 4702/9741 [00:09<00:10, 500.45it/s] 49%|███████████████████████████████████▏                                    | 4753/9741 [00:10<00:13, 357.75it/s] 49%|███████████████████████████████████▌                                    | 4805/9741 [00:10<00:12, 393.91it/s] 50%|███████████████████████████████████▉                                    | 4857/9741 [00:10<00:11, 423.61it/s] 50%|████████████████████████████████████▎                                   | 4909/9741 [00:10<00:10, 447.31it/s] 51%|████████████████████████████████████▋                                   | 4960/9741 [00:10<00:10, 463.40it/s] 51%|█████████████████████████████████████                                   | 5012/9741 [00:10<00:09, 477.22it/s] 52%|█████████████████████████████████████▍                                  | 5064/9741 [00:10<00:09, 488.02it/s] 53%|█████████████████████████████████████▊                                  | 5116/9741 [00:10<00:09, 495.25it/s] 53%|██████████████████████████████████████▏                                 | 5168/9741 [00:11<00:09, 500.69it/s] 54%|██████████████████████████████████████▌                                 | 5219/9741 [00:11<00:09, 501.80it/s] 54%|██████████████████████████████████████▉                                 | 5271/9741 [00:11<00:08, 505.40it/s] 55%|███████████████████████████████████████▎                                | 5323/9741 [00:11<00:08, 508.02it/s] 55%|███████████████████████████████████████▋                                | 5375/9741 [00:11<00:08, 508.94it/s] 56%|████████████████████████████████████████                                | 5427/9741 [00:11<00:08, 507.98it/s] 56%|████████████████████████████████████████▍                               | 5479/9741 [00:11<00:08, 510.87it/s] 57%|████████████████████████████████████████▉                               | 5533/9741 [00:11<00:08, 517.35it/s] 57%|█████████████████████████████████████████▎                              | 5587/9741 [00:11<00:07, 521.48it/s] 58%|█████████████████████████████████████████▋                              | 5640/9741 [00:11<00:07, 521.88it/s] 58%|██████████████████████████████████████████                              | 5694/9741 [00:12<00:07, 524.49it/s] 59%|██████████████████████████████████████████▍                             | 5748/9741 [00:12<00:07, 526.19it/s] 60%|██████████████████████████████████████████▉                             | 5801/9741 [00:12<00:07, 527.15it/s] 60%|███████████████████████████████████████████▎                            | 5854/9741 [00:12<00:07, 525.47it/s] 61%|███████████████████████████████████████████▋                            | 5907/9741 [00:12<00:07, 522.74it/s] 61%|████████████████████████████████████████████                            | 5961/9741 [00:12<00:07, 525.06it/s] 62%|████████████████████████████████████████████▍                           | 6014/9741 [00:12<00:07, 526.04it/s] 62%|████████████████████████████████████████████▊                           | 6068/9741 [00:12<00:06, 527.71it/s] 63%|█████████████████████████████████████████████▏                          | 6121/9741 [00:12<00:06, 525.88it/s] 63%|█████████████████████████████████████████████▋                          | 6174/9741 [00:12<00:06, 526.42it/s] 64%|██████████████████████████████████████████████                          | 6227/9741 [00:13<00:06, 526.61it/s] 64%|██████████████████████████████████████████████▍                         | 6280/9741 [00:13<00:06, 526.98it/s] 65%|██████████████████████████████████████████████▊                         | 6333/9741 [00:13<00:06, 524.70it/s] 66%|███████████████████████████████████████████████▏                        | 6386/9741 [00:13<00:06, 526.25it/s] 66%|███████████████████████████████████████████████▌                        | 6439/9741 [00:13<00:06, 526.68it/s] 67%|███████████████████████████████████████████████▉                        | 6492/9741 [00:13<00:06, 526.97it/s] 67%|████████████████████████████████████████████████▍                       | 6545/9741 [00:13<00:06, 524.83it/s] 68%|████████████████████████████████████████████████▊                       | 6598/9741 [00:13<00:05, 525.28it/s] 68%|█████████████████████████████████████████████████▏                      | 6651/9741 [00:13<00:05, 526.09it/s] 69%|█████████████████████████████████████████████████▌                      | 6704/9741 [00:13<00:05, 526.65it/s] 69%|█████████████████████████████████████████████████▉                      | 6757/9741 [00:14<00:05, 527.48it/s] 70%|██████████████████████████████████████████████████▎                     | 6810/9741 [00:14<00:05, 521.15it/s] 70%|██████████████████████████████████████████████████▋                     | 6863/9741 [00:14<00:05, 523.36it/s] 71%|███████████████████████████████████████████████████                     | 6916/9741 [00:14<00:05, 524.47it/s] 72%|███████████████████████████████████████████████████▌                    | 6969/9741 [00:14<00:05, 525.68it/s] 72%|███████████████████████████████████████████████████▉                    | 7022/9741 [00:14<00:05, 524.03it/s] 73%|████████████████████████████████████████████████████▎                   | 7075/9741 [00:14<00:05, 525.16it/s] 73%|████████████████████████████████████████████████████▋                   | 7128/9741 [00:14<00:04, 525.48it/s] 74%|█████████████████████████████████████████████████████                   | 7181/9741 [00:14<00:04, 525.97it/s] 74%|█████████████████████████████████████████████████████▍                  | 7234/9741 [00:14<00:04, 524.47it/s] 75%|█████████████████████████████████████████████████████▊                  | 7287/9741 [00:15<00:04, 525.80it/s] 75%|██████████████████████████████████████████████████████▎                 | 7340/9741 [00:15<00:04, 526.12it/s] 76%|██████████████████████████████████████████████████████▋                 | 7393/9741 [00:15<00:04, 526.56it/s] 76%|███████████████████████████████████████████████████████                 | 7446/9741 [00:15<00:04, 496.45it/s] 77%|███████████████████████████████████████████████████████▍                | 7499/9741 [00:15<00:04, 504.98it/s] 78%|███████████████████████████████████████████████████████▊                | 7552/9741 [00:15<00:04, 510.80it/s] 78%|████████████████████████████████████████████████████████▏               | 7605/9741 [00:15<00:04, 515.85it/s] 79%|████████████████████████████████████████████████████████▌               | 7658/9741 [00:15<00:04, 518.50it/s] 79%|████████████████████████████████████████████████████████▉               | 7710/9741 [00:15<00:03, 512.14it/s] 80%|█████████████████████████████████████████████████████████▍              | 7763/9741 [00:16<00:03, 517.32it/s] 80%|█████████████████████████████████████████████████████████▊              | 7816/9741 [00:16<00:03, 520.19it/s] 81%|██████████████████████████████████████████████████████████▏             | 7869/9741 [00:16<00:03, 521.94it/s] 81%|██████████████████████████████████████████████████████████▌             | 7922/9741 [00:16<00:03, 521.48it/s] 82%|██████████████████████████████████████████████████████████▉             | 7975/9741 [00:16<00:03, 522.50it/s] 82%|███████████████████████████████████████████████████████████▎            | 8028/9741 [00:16<00:03, 523.73it/s] 83%|███████████████████████████████████████████████████████████▋            | 8081/9741 [00:16<00:03, 524.42it/s] 84%|████████████████████████████████████████████████████████████            | 8134/9741 [00:16<00:03, 523.43it/s] 84%|████████████████████████████████████████████████████████████▌           | 8187/9741 [00:16<00:02, 525.02it/s] 85%|████████████████████████████████████████████████████████████▉           | 8240/9741 [00:16<00:02, 525.46it/s] 85%|█████████████████████████████████████████████████████████████▎          | 8293/9741 [00:17<00:02, 525.66it/s] 86%|█████████████████████████████████████████████████████████████▋          | 8346/9741 [00:17<00:02, 525.92it/s] 86%|██████████████████████████████████████████████████████████████          | 8399/9741 [00:17<00:02, 524.17it/s] 87%|██████████████████████████████████████████████████████████████▍         | 8452/9741 [00:17<00:02, 524.74it/s] 87%|██████████████████████████████████████████████████████████████▊         | 8505/9741 [00:17<00:02, 525.65it/s] 88%|███████████████████████████████████████████████████████████████▎        | 8558/9741 [00:17<00:02, 521.50it/s] 88%|███████████████████████████████████████████████████████████████▋        | 8611/9741 [00:17<00:02, 520.48it/s] 89%|████████████████████████████████████████████████████████████████        | 8664/9741 [00:17<00:02, 522.11it/s] 89%|████████████████████████████████████████████████████████████████▍       | 8717/9741 [00:17<00:01, 523.85it/s] 90%|████████████████████████████████████████████████████████████████▊       | 8770/9741 [00:17<00:01, 524.06it/s] 91%|█████████████████████████████████████████████████████████████████▏      | 8823/9741 [00:18<00:01, 522.12it/s] 91%|█████████████████████████████████████████████████████████████████▌      | 8876/9741 [00:18<00:01, 523.23it/s] 92%|█████████████████████████████████████████████████████████████████▉      | 8929/9741 [00:18<00:01, 524.03it/s] 92%|██████████████████████████████████████████████████████████████████▍     | 8982/9741 [00:18<00:01, 524.51it/s] 93%|██████████████████████████████████████████████████████████████████▊     | 9035/9741 [00:18<00:01, 522.52it/s] 93%|███████████████████████████████████████████████████████████████████▏    | 9088/9741 [00:18<00:01, 523.20it/s] 94%|███████████████████████████████████████████████████████████████████▌    | 9141/9741 [00:18<00:01, 520.84it/s] 94%|███████████████████████████████████████████████████████████████████▉    | 9194/9741 [00:18<00:01, 522.25it/s] 95%|████████████████████████████████████████████████████████████████████▎   | 9247/9741 [00:18<00:00, 523.04it/s] 95%|████████████████████████████████████████████████████████████████████▋   | 9300/9741 [00:18<00:00, 521.80it/s] 96%|█████████████████████████████████████████████████████████████████████▏  | 9353/9741 [00:19<00:00, 523.13it/s] 97%|█████████████████████████████████████████████████████████████████████▌  | 9406/9741 [00:19<00:00, 523.97it/s] 97%|█████████████████████████████████████████████████████████████████████▉  | 9459/9741 [00:19<00:00, 524.75it/s] 98%|██████████████████████████████████████████████████████████████████████▎ | 9512/9741 [00:19<00:00, 523.45it/s] 98%|██████████████████████████████████████████████████████████████████████▋ | 9565/9741 [00:19<00:00, 524.67it/s] 99%|███████████████████████████████████████████████████████████████████████ | 9618/9741 [00:19<00:00, 524.02it/s] 99%|███████████████████████████████████████████████████████████████████████▍| 9671/9741 [00:19<00:00, 523.26it/s]100%|███████████████████████████████████████████████████████████████████████▊| 9724/9741 [00:19<00:00, 517.93it/s]100%|████████████████████████████████████████████████████████████████████████| 9741/9741 [00:19<00:00, 492.08it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.10s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.09s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.35s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.32s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:04,  5.00s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.20s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.22s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.49s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.46s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.61s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.57s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.73s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.61s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.79s/it]
[2023-08-14 09:41:02,038] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.78s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.96s/it]
[2023-08-14 09:41:13,128] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-14 09:41:13,129] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-14 09:41:13,129] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-14 09:41:13,129] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-14 09:41:13,129] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-14 09:41:13,129] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-14 09:41:13,130] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-14 09:41:13,130] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-14 09:41:13,130] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-14 09:41:13,130] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-14 09:41:13,130] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-14 09:41:13,130] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f16fb6befd0>
[2023-08-14 09:41:13,130] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-14 09:41:13,130] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-14 09:41:13,130] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-14 09:41:13,130] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-14 09:41:13,130] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-14 09:41:13,130] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-14 09:41:13,130] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-14 09:41:13,130] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-14 09:41:13,130] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-14 09:41:13,130] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-14 09:41:13,130] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-14 09:41:13,130] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-14 09:41:13,130] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-14 09:41:13,130] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-14 09:41:13,130] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-14 09:41:13,130] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-14 09:41:13,130] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-14 09:41:13,130] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-14 09:41:13,130] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-14 09:41:13,130] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-14 09:41:13,130] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-14 09:41:13,130] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-14 09:41:13,130] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-14 09:41:13,130] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-14 09:41:13,130] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-14 09:41:13,130] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-14 09:41:13,130] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-14 09:41:13,130] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-14 09:41:13,130] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-14 09:41:13,130] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-14 09:41:13,130] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-14 09:41:13,130] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-14 09:41:13,130] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f16d4a92cd0>
[2023-08-14 09:41:13,130] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-14 09:41:13,131] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-14 09:41:13,131] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-14 09:41:13,131] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-14 09:41:13,131] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-14 09:41:13,131] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-14 09:41:13,131] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-14 09:41:13,131] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-14 09:41:13,131] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-14 09:41:13,131] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-14 09:41:13,131] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-14 09:41:13,131] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-14 09:41:13,131] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-14 09:41:13,131] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-14 09:41:13,131] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-14 09:41:13,131] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-14 09:41:13,131] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-14 09:41:13,131] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-14 09:41:13,131] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-14 09:41:13,131] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-14 09:41:13,131] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-14 09:41:13,131] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-14 09:41:13,131] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.4453103542327881 seconds
Loading extension module utils...
Time to load utils op: 0.40439391136169434 seconds
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.5046474933624268 seconds
Time to load utils op: 0.5046894550323486 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                                           | 0/50 [00:00<?, ?it/s]############### Example ###############
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following multiple choice question.

### Demonstration:
Input: Adam bought 3 kilograms of nuts and 2.5 kilograms of dried fruits at a store. One kilogram of nuts costs $12 and one kilogram of dried fruit costs $8. How much did his purchases cost?
Answer: 56

Input: Johns goes to the gym 3 times a week.  He spends 1 hour each day lifting weight. Additionally, he also spends a third of his weightlifting time warming up and doing cardio each day.  How many hours does he spend at the gym a week?
Answer: 4

Input: James has to refuel his plane.  It used to cost $200 to refill the tank.  He got an extra tank to double fuel capacity.  Fuel prices also went up by 20%.  How much does he pay now for fuel?
Answer: 480

Input: The number of goals scored in a game against Barca by exactly two players last season accounts for 20% of all goals scored in the league. If the players scored an equal number of goals, and the total number of goals scored in the league against Barca that season is 300, calculate the number of goals each of the two players scored.
Answer: 30

Input: Every day Tom drinks 5 12-oz cans of soda plus 64 ounces of water. How many ounces of fluid does he drink a week?
Answer: 868

Input: Stella and Twinkle are filling up a truck with a capacity of 6000 stone blocks at the rate of 250 blocks per hour per person. They work for four hours and are then joined by 6 other people who also work at the same rate. How many hours did filling the truck take?
Answer: 6

Input: Elijah drank 8.5 pints of coffee yesterday. Emilio drank 9.5 pints of water yesterday. How many cups of liquid did the two boys drink yesterday?
Answer: 36

Input: Doris works at the Widget Factory in the packing department. She puts 3 widgets in each carton, which are 4 inches wide, 4 inches long, and 5 inches tall. She then packs those cartons into a shipping box before sending it to the loading bay. The shipping boxes are 20 inches wide, 20 inches long, and 20 inches high. How many widgets get shipped in each shipping box?
Answer: 300

Input: Queenie earns $150 a day as a part-time clerk. She earns an additional $5 per hour as overtime pay. How much will Queenie receive for working 5 days with 4 hours overtime?
Answer: 770

Input: Jodi starts off walking 1 mile a day for 6 days a week.  On the second week, she walks 2 miles a day, 6 days a week.  On the third week, she walks 3 miles a day, 6 days a week. Finally on the fourth week, she walks 4 miles a day, 6 days a week.  How many miles has she walked in 4 weeks?
Answer: 60

Input: A club is going to get additional members so that they will have 5 more than twice their current number of their members. If the club has 10 members now, how many additional members do they need?
Answer: 15

Input: Andrea buys herself a pony for her 30th birthday. She pays $500/month to rent a pasture for it, $10 a day for food, and $60/lesson for two lessons a week. How much does she spend on her pony in a year?
Answer: 15890

Input: A pet shop has 2 puppies and some kittens. A puppy costs $20, and a kitten costs $15. If the stock is worth $100, how many kittens does the pet shop have?
Answer: 4

Input: Noah, who loves his Grammy, calls her every week to talk about his day. If each call lasts 30 minutes and he is charged $0.05 per call minute, how much would he be billed if he makes the calls for a year?
Answer: 78

### Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid

### Response:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o14-tgsm8k-s10-rFalse
Evaluating commonsenseqa :   2%|█                                                  | 1/50 [00:44<36:16, 44.43s/it]Evaluating commonsenseqa :   4%|██                                                 | 2/50 [01:28<35:36, 44.51s/it]Evaluating commonsenseqa :   6%|███                                                | 3/50 [01:54<28:14, 36.06s/it]Evaluating commonsenseqa :   8%|████                                               | 4/50 [02:38<29:55, 39.03s/it]Evaluating commonsenseqa :  10%|█████                                              | 5/50 [02:57<23:54, 31.89s/it]Evaluating commonsenseqa :  12%|██████                                             | 6/50 [03:42<26:35, 36.27s/it]Evaluating commonsenseqa :  14%|███████▏                                           | 7/50 [04:26<27:50, 38.86s/it]Evaluating commonsenseqa :  16%|████████▏                                          | 8/50 [04:48<23:19, 33.32s/it]Evaluating commonsenseqa :  18%|█████████▏                                         | 9/50 [05:28<24:15, 35.50s/it]Evaluating commonsenseqa :  20%|██████████                                        | 10/50 [06:13<25:36, 38.42s/it]Evaluating commonsenseqa :  22%|███████████                                       | 11/50 [06:57<26:05, 40.14s/it]Evaluating commonsenseqa :  24%|████████████                                      | 12/50 [07:41<26:14, 41.43s/it]Evaluating commonsenseqa :  26%|█████████████                                     | 13/50 [08:26<26:04, 42.27s/it]Evaluating commonsenseqa :  28%|██████████████                                    | 14/50 [09:10<25:39, 42.78s/it]Evaluating commonsenseqa :  30%|███████████████                                   | 15/50 [09:53<25:06, 43.05s/it]Evaluating commonsenseqa :  32%|████████████████                                  | 16/50 [10:37<24:33, 43.34s/it]Evaluating commonsenseqa :  34%|█████████████████                                 | 17/50 [11:21<23:58, 43.59s/it]Evaluating commonsenseqa :  36%|██████████████████                                | 18/50 [12:04<23:07, 43.36s/it]Evaluating commonsenseqa :  38%|███████████████████                               | 19/50 [12:48<22:30, 43.57s/it]Evaluating commonsenseqa :  40%|████████████████████                              | 20/50 [13:33<21:57, 43.93s/it]Evaluating commonsenseqa :  42%|█████████████████████                             | 21/50 [14:18<21:22, 44.22s/it]Evaluating commonsenseqa :  44%|██████████████████████                            | 22/50 [15:02<20:35, 44.13s/it]Evaluating commonsenseqa :  46%|███████████████████████                           | 23/50 [15:46<19:51, 44.14s/it]Evaluating commonsenseqa :  48%|████████████████████████                          | 24/50 [16:26<18:31, 42.75s/it]Evaluating commonsenseqa :  50%|█████████████████████████                         | 25/50 [17:10<17:59, 43.19s/it]Evaluating commonsenseqa :  52%|██████████████████████████                        | 26/50 [17:54<17:24, 43.54s/it]Evaluating commonsenseqa :  54%|███████████████████████████                       | 27/50 [18:38<16:42, 43.59s/it]Evaluating commonsenseqa :  56%|████████████████████████████                      | 28/50 [19:22<16:02, 43.75s/it]Evaluating commonsenseqa :  58%|████████████████████████████▉                     | 29/50 [20:06<15:20, 43.85s/it]Evaluating commonsenseqa :  60%|██████████████████████████████                    | 30/50 [20:33<12:54, 38.73s/it]Evaluating commonsenseqa :  62%|███████████████████████████████                   | 31/50 [21:17<12:47, 40.41s/it]Evaluating commonsenseqa :  64%|████████████████████████████████                  | 32/50 [22:02<12:29, 41.62s/it]Evaluating commonsenseqa :  66%|█████████████████████████████████                 | 33/50 [22:40<11:28, 40.52s/it]Evaluating commonsenseqa :  68%|██████████████████████████████████                | 34/50 [23:23<11:03, 41.48s/it]Evaluating commonsenseqa :  70%|███████████████████████████████████               | 35/50 [23:57<09:46, 39.08s/it]Evaluating commonsenseqa :  72%|████████████████████████████████████              | 36/50 [24:40<09:26, 40.44s/it]Evaluating commonsenseqa :  74%|█████████████████████████████████████             | 37/50 [25:25<09:00, 41.59s/it]Evaluating commonsenseqa :  76%|██████████████████████████████████████            | 38/50 [26:08<08:25, 42.13s/it]Evaluating commonsenseqa :  78%|███████████████████████████████████████           | 39/50 [26:42<07:15, 39.58s/it]Evaluating commonsenseqa :  80%|████████████████████████████████████████          | 40/50 [27:26<06:51, 41.11s/it]Evaluating commonsenseqa :  82%|█████████████████████████████████████████         | 41/50 [28:11<06:19, 42.12s/it]Evaluating commonsenseqa :  84%|██████████████████████████████████████████        | 42/50 [28:55<05:41, 42.67s/it]Evaluating commonsenseqa :  86%|███████████████████████████████████████████       | 43/50 [29:38<05:00, 42.95s/it]Evaluating commonsenseqa :  88%|████████████████████████████████████████████      | 44/50 [30:23<04:20, 43.38s/it]Evaluating commonsenseqa :  90%|█████████████████████████████████████████████     | 45/50 [31:07<03:38, 43.61s/it]Evaluating commonsenseqa :  92%|██████████████████████████████████████████████    | 46/50 [31:44<02:46, 41.53s/it]Evaluating commonsenseqa :  94%|███████████████████████████████████████████████   | 47/50 [32:28<02:06, 42.26s/it]Evaluating commonsenseqa :  96%|████████████████████████████████████████████████  | 48/50 [33:12<01:25, 42.94s/it]Evaluating commonsenseqa :  98%|█████████████████████████████████████████████████ | 49/50 [33:55<00:43, 43.08s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████| 50/50 [34:40<00:00, 43.57s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████| 50/50 [34:40<00:00, 41.61s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 3.0421} | lm_loss 7.8154 | avg. gen lenth: 263.272
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name gsm8k --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/out-domain/o15-tgsm8k-s10-rFalse --seed 10 --num-out-domain 15
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-14 10:16:39,132] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/out-domain/o15-tgsm8k-s10-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 15
  out_domain_data_name ......... gsm8k
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o15-tgsm8k-s10-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 10
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                    | 0/9741 [00:00<?, ?it/s]  0%|▎                                                                         | 33/9741 [00:00<00:30, 323.07it/s]  1%|▌                                                                         | 66/9741 [00:00<00:29, 323.82it/s]  1%|▊                                                                         | 99/9741 [00:00<00:29, 324.96it/s]  1%|▉                                                                        | 132/9741 [00:00<00:29, 325.19it/s]  2%|█▏                                                                       | 165/9741 [00:00<00:29, 325.36it/s]  2%|█▍                                                                       | 198/9741 [00:00<00:29, 324.94it/s]  2%|█▋                                                                       | 231/9741 [00:00<00:29, 323.13it/s]  3%|█▉                                                                       | 264/9741 [00:00<00:29, 318.23it/s]  3%|██▏                                                                      | 297/9741 [00:00<00:29, 319.85it/s]  3%|██▍                                                                      | 330/9741 [00:01<00:29, 321.32it/s]  4%|██▋                                                                      | 363/9741 [00:01<00:29, 321.94it/s]  4%|██▉                                                                      | 396/9741 [00:01<00:28, 323.12it/s]  4%|███▏                                                                     | 429/9741 [00:01<00:28, 321.13it/s]  5%|███▍                                                                     | 462/9741 [00:01<00:28, 322.40it/s]  5%|███▋                                                                     | 495/9741 [00:01<00:28, 322.69it/s]  5%|███▉                                                                     | 528/9741 [00:01<00:28, 323.23it/s]  6%|████▏                                                                    | 561/9741 [00:01<00:28, 323.59it/s]  6%|████▍                                                                    | 594/9741 [00:01<00:28, 321.51it/s]  6%|████▋                                                                    | 628/9741 [00:01<00:27, 326.12it/s]  7%|█████                                                                    | 677/9741 [00:02<00:24, 373.17it/s]  7%|█████▍                                                                   | 727/9741 [00:02<00:22, 408.72it/s]  8%|█████▊                                                                   | 777/9741 [00:02<00:20, 433.68it/s]  8%|██████▏                                                                  | 827/9741 [00:02<00:19, 451.18it/s]  9%|██████▌                                                                  | 877/9741 [00:02<00:19, 463.54it/s] 10%|██████▉                                                                  | 926/9741 [00:02<00:18, 469.22it/s] 10%|███████▎                                                                 | 975/9741 [00:02<00:18, 475.16it/s] 11%|███████▌                                                                | 1025/9741 [00:02<00:18, 479.90it/s] 11%|███████▉                                                                | 1075/9741 [00:02<00:17, 483.56it/s] 12%|████████▎                                                               | 1124/9741 [00:02<00:17, 483.29it/s] 12%|████████▋                                                               | 1174/9741 [00:03<00:17, 485.63it/s] 13%|█████████                                                               | 1223/9741 [00:03<00:17, 486.74it/s] 13%|█████████▍                                                              | 1272/9741 [00:03<00:17, 487.61it/s] 14%|█████████▊                                                              | 1322/9741 [00:03<00:17, 488.48it/s] 14%|██████████▏                                                             | 1371/9741 [00:03<00:17, 486.85it/s] 15%|██████████▌                                                             | 1421/9741 [00:03<00:17, 487.98it/s] 15%|██████████▊                                                             | 1470/9741 [00:03<00:16, 488.38it/s] 16%|███████████▏                                                            | 1520/9741 [00:03<00:16, 489.20it/s] 16%|███████████▌                                                            | 1570/9741 [00:03<00:16, 491.21it/s] 17%|███████████▉                                                            | 1621/9741 [00:03<00:16, 494.19it/s] 17%|████████████▎                                                           | 1672/9741 [00:04<00:16, 497.13it/s] 18%|████████████▋                                                           | 1723/9741 [00:04<00:16, 498.86it/s] 18%|█████████████                                                           | 1774/9741 [00:04<00:15, 500.33it/s] 19%|█████████████▍                                                          | 1825/9741 [00:04<00:16, 476.35it/s] 19%|█████████████▊                                                          | 1876/9741 [00:04<00:16, 483.29it/s] 20%|██████████████▏                                                         | 1927/9741 [00:04<00:15, 488.50it/s] 20%|██████████████▌                                                         | 1978/9741 [00:04<00:15, 492.12it/s] 21%|██████████████▉                                                         | 2028/9741 [00:04<00:15, 492.62it/s] 21%|███████████████▎                                                        | 2079/9741 [00:04<00:15, 495.01it/s] 22%|███████████████▋                                                        | 2130/9741 [00:05<00:15, 496.64it/s] 22%|████████████████                                                        | 2181/9741 [00:05<00:15, 498.52it/s] 23%|████████████████▍                                                       | 2232/9741 [00:05<00:15, 499.67it/s] 23%|████████████████▊                                                       | 2282/9741 [00:05<00:14, 497.97it/s] 24%|█████████████████▏                                                      | 2333/9741 [00:05<00:14, 498.80it/s] 24%|█████████████████▌                                                      | 2384/9741 [00:05<00:14, 499.80it/s] 25%|█████████████████▉                                                      | 2435/9741 [00:05<00:14, 500.87it/s] 26%|██████████████████▍                                                     | 2486/9741 [00:05<00:14, 494.34it/s] 26%|██████████████████▊                                                     | 2537/9741 [00:05<00:14, 496.12it/s] 27%|███████████████████▏                                                    | 2588/9741 [00:05<00:14, 497.98it/s] 27%|███████████████████▌                                                    | 2639/9741 [00:06<00:14, 499.04it/s] 28%|███████████████████▉                                                    | 2690/9741 [00:06<00:14, 499.55it/s] 28%|████████████████████▎                                                   | 2740/9741 [00:06<00:14, 497.63it/s] 29%|████████████████████▌                                                   | 2790/9741 [00:06<00:13, 498.24it/s] 29%|████████████████████▉                                                   | 2841/9741 [00:06<00:13, 499.21it/s] 30%|█████████████████████▍                                                  | 2892/9741 [00:06<00:13, 500.31it/s] 30%|█████████████████████▊                                                  | 2943/9741 [00:06<00:13, 498.73it/s] 31%|██████████████████████                                                  | 2993/9741 [00:06<00:13, 498.13it/s] 31%|██████████████████████▍                                                 | 3044/9741 [00:06<00:13, 499.39it/s] 32%|██████████████████████▉                                                 | 3095/9741 [00:06<00:13, 499.96it/s] 32%|███████████████████████▏                                                | 3145/9741 [00:07<00:13, 496.66it/s] 33%|███████████████████████▌                                                | 3195/9741 [00:07<00:13, 494.47it/s] 33%|███████████████████████▉                                                | 3246/9741 [00:07<00:13, 496.88it/s] 34%|████████████████████████▎                                               | 3297/9741 [00:07<00:12, 498.38it/s] 34%|████████████████████████▋                                               | 3348/9741 [00:07<00:12, 499.36it/s] 35%|█████████████████████████                                               | 3398/9741 [00:07<00:12, 497.73it/s] 35%|█████████████████████████▍                                              | 3449/9741 [00:07<00:12, 498.93it/s] 36%|█████████████████████████▊                                              | 3499/9741 [00:07<00:12, 499.17it/s] 36%|██████████████████████████▏                                             | 3550/9741 [00:07<00:12, 499.80it/s] 37%|██████████████████████████▌                                             | 3601/9741 [00:07<00:12, 500.25it/s] 37%|██████████████████████████▉                                             | 3652/9741 [00:08<00:12, 498.60it/s] 38%|███████████████████████████▎                                            | 3703/9741 [00:08<00:12, 499.95it/s] 39%|███████████████████████████▋                                            | 3754/9741 [00:08<00:11, 500.98it/s] 39%|████████████████████████████                                            | 3805/9741 [00:08<00:11, 498.43it/s] 40%|████████████████████████████▍                                           | 3855/9741 [00:08<00:11, 497.17it/s] 40%|████████████████████████████▊                                           | 3906/9741 [00:08<00:11, 499.08it/s] 41%|█████████████████████████████▏                                          | 3957/9741 [00:08<00:11, 499.87it/s] 41%|█████████████████████████████▌                                          | 4008/9741 [00:08<00:11, 500.62it/s] 42%|██████████████████████████████                                          | 4059/9741 [00:08<00:11, 498.80it/s] 42%|██████████████████████████████▍                                         | 4110/9741 [00:08<00:11, 499.74it/s] 43%|██████████████████████████████▊                                         | 4161/9741 [00:09<00:11, 500.56it/s] 43%|███████████████████████████████▏                                        | 4212/9741 [00:09<00:11, 500.82it/s] 44%|███████████████████████████████▌                                        | 4263/9741 [00:09<00:10, 501.37it/s] 44%|███████████████████████████████▉                                        | 4314/9741 [00:09<00:10, 499.53it/s] 45%|████████████████████████████████▎                                       | 4365/9741 [00:09<00:10, 500.21it/s] 45%|████████████████████████████████▋                                       | 4416/9741 [00:09<00:10, 501.07it/s] 46%|█████████████████████████████████                                       | 4467/9741 [00:09<00:10, 500.96it/s] 46%|█████████████████████████████████▍                                      | 4518/9741 [00:09<00:11, 461.44it/s] 47%|█████████████████████████████████▊                                      | 4569/9741 [00:09<00:10, 472.53it/s] 47%|██████████████████████████████████▏                                     | 4620/9741 [00:10<00:10, 480.91it/s] 48%|██████████████████████████████████▌                                     | 4671/9741 [00:10<00:10, 486.82it/s] 48%|██████████████████████████████████▉                                     | 4722/9741 [00:10<00:10, 491.29it/s] 49%|███████████████████████████████████▎                                    | 4772/9741 [00:10<00:14, 348.01it/s] 50%|███████████████████████████████████▋                                    | 4822/9741 [00:10<00:12, 382.45it/s] 50%|████████████████████████████████████                                    | 4872/9741 [00:10<00:11, 411.23it/s] 51%|████████████████████████████████████▍                                   | 4923/9741 [00:10<00:11, 434.90it/s] 51%|████████████████████████████████████▊                                   | 4973/9741 [00:10<00:10, 451.23it/s] 52%|█████████████████████████████████████▏                                  | 5024/9741 [00:10<00:10, 465.37it/s] 52%|█████████████████████████████████████▌                                  | 5075/9741 [00:11<00:09, 475.64it/s] 53%|█████████████████████████████████████▉                                  | 5126/9741 [00:11<00:09, 483.57it/s] 53%|██████████████████████████████████████▎                                 | 5176/9741 [00:11<00:09, 486.69it/s] 54%|██████████████████████████████████████▋                                 | 5227/9741 [00:11<00:09, 491.07it/s] 54%|███████████████████████████████████████                                 | 5278/9741 [00:11<00:09, 493.77it/s] 55%|███████████████████████████████████████▍                                | 5329/9741 [00:11<00:08, 496.36it/s] 55%|███████████████████████████████████████▊                                | 5380/9741 [00:11<00:08, 497.72it/s] 56%|████████████████████████████████████████▏                               | 5430/9741 [00:11<00:08, 495.63it/s] 56%|████████████████████████████████████████▌                               | 5481/9741 [00:11<00:08, 498.12it/s] 57%|████████████████████████████████████████▉                               | 5533/9741 [00:11<00:08, 503.84it/s] 57%|█████████████████████████████████████████▎                              | 5585/9741 [00:12<00:08, 507.41it/s] 58%|█████████████████████████████████████████▋                              | 5636/9741 [00:12<00:08, 507.55it/s] 58%|██████████████████████████████████████████                              | 5688/9741 [00:12<00:07, 510.46it/s] 59%|██████████████████████████████████████████▍                             | 5740/9741 [00:12<00:07, 512.85it/s] 59%|██████████████████████████████████████████▊                             | 5792/9741 [00:12<00:07, 513.31it/s] 60%|███████████████████████████████████████████▏                            | 5844/9741 [00:12<00:07, 513.72it/s] 61%|███████████████████████████████████████████▌                            | 5896/9741 [00:12<00:07, 511.90it/s] 61%|███████████████████████████████████████████▉                            | 5948/9741 [00:12<00:07, 512.83it/s] 62%|████████████████████████████████████████████▎                           | 6000/9741 [00:12<00:07, 513.86it/s] 62%|████████████████████████████████████████████▋                           | 6052/9741 [00:12<00:07, 512.76it/s] 63%|█████████████████████████████████████████████                           | 6104/9741 [00:13<00:07, 511.36it/s] 63%|█████████████████████████████████████████████▌                          | 6156/9741 [00:13<00:07, 512.00it/s] 64%|█████████████████████████████████████████████▉                          | 6208/9741 [00:13<00:06, 512.60it/s] 64%|██████████████████████████████████████████████▎                         | 6260/9741 [00:13<00:06, 512.58it/s] 65%|██████████████████████████████████████████████▋                         | 6312/9741 [00:13<00:06, 511.41it/s] 65%|███████████████████████████████████████████████                         | 6364/9741 [00:13<00:06, 512.70it/s] 66%|███████████████████████████████████████████████▍                        | 6416/9741 [00:13<00:06, 513.87it/s] 66%|███████████████████████████████████████████████▊                        | 6468/9741 [00:13<00:06, 514.37it/s] 67%|████████████████████████████████████████████████▏                       | 6520/9741 [00:13<00:06, 514.06it/s] 67%|████████████████████████████████████████████████▌                       | 6572/9741 [00:14<00:06, 511.72it/s] 68%|████████████████████████████████████████████████▉                       | 6624/9741 [00:14<00:06, 512.15it/s] 69%|█████████████████████████████████████████████████▎                      | 6676/9741 [00:14<00:05, 512.96it/s] 69%|█████████████████████████████████████████████████▋                      | 6728/9741 [00:14<00:05, 513.45it/s] 70%|██████████████████████████████████████████████████                      | 6780/9741 [00:14<00:05, 512.62it/s] 70%|██████████████████████████████████████████████████▍                     | 6832/9741 [00:14<00:05, 513.56it/s] 71%|██████████████████████████████████████████████████▉                     | 6884/9741 [00:14<00:05, 512.79it/s] 71%|███████████████████████████████████████████████████▎                    | 6936/9741 [00:14<00:05, 513.30it/s] 72%|███████████████████████████████████████████████████▋                    | 6988/9741 [00:14<00:05, 511.69it/s] 72%|████████████████████████████████████████████████████                    | 7040/9741 [00:14<00:05, 512.46it/s] 73%|████████████████████████████████████████████████████▍                   | 7092/9741 [00:15<00:05, 513.31it/s] 73%|████████████████████████████████████████████████████▊                   | 7144/9741 [00:15<00:05, 513.85it/s] 74%|█████████████████████████████████████████████████████▏                  | 7196/9741 [00:15<00:04, 514.09it/s] 74%|█████████████████████████████████████████████████████▌                  | 7248/9741 [00:15<00:04, 511.12it/s] 75%|█████████████████████████████████████████████████████▉                  | 7300/9741 [00:15<00:04, 512.10it/s] 75%|██████████████████████████████████████████████████████▎                 | 7352/9741 [00:15<00:04, 491.82it/s] 76%|██████████████████████████████████████████████████████▋                 | 7404/9741 [00:15<00:04, 498.84it/s] 77%|███████████████████████████████████████████████████████                 | 7455/9741 [00:15<00:04, 475.86it/s] 77%|███████████████████████████████████████████████████████▍                | 7507/9741 [00:15<00:04, 485.92it/s] 78%|███████████████████████████████████████████████████████▊                | 7559/9741 [00:15<00:04, 493.49it/s] 78%|████████████████████████████████████████████████████████▎               | 7611/9741 [00:16<00:04, 499.19it/s] 79%|████████████████████████████████████████████████████████▋               | 7662/9741 [00:16<00:04, 501.36it/s] 79%|█████████████████████████████████████████████████████████               | 7713/9741 [00:16<00:04, 502.92it/s] 80%|█████████████████████████████████████████████████████████▍              | 7765/9741 [00:16<00:03, 506.62it/s] 80%|█████████████████████████████████████████████████████████▊              | 7817/9741 [00:16<00:03, 508.88it/s] 81%|██████████████████████████████████████████████████████████▏             | 7869/9741 [00:16<00:03, 510.67it/s] 81%|██████████████████████████████████████████████████████████▌             | 7921/9741 [00:16<00:03, 510.05it/s] 82%|██████████████████████████████████████████████████████████▉             | 7973/9741 [00:16<00:03, 510.41it/s] 82%|███████████████████████████████████████████████████████████▎            | 8025/9741 [00:16<00:03, 511.15it/s] 83%|███████████████████████████████████████████████████████████▋            | 8077/9741 [00:16<00:03, 511.41it/s] 83%|████████████████████████████████████████████████████████████            | 8129/9741 [00:17<00:03, 510.74it/s] 84%|████████████████████████████████████████████████████████████▍           | 8181/9741 [00:17<00:03, 511.96it/s] 85%|████████████████████████████████████████████████████████████▊           | 8233/9741 [00:17<00:02, 512.42it/s] 85%|█████████████████████████████████████████████████████████████▏          | 8285/9741 [00:17<00:02, 512.90it/s] 86%|█████████████████████████████████████████████████████████████▌          | 8337/9741 [00:17<00:02, 512.90it/s] 86%|██████████████████████████████████████████████████████████████          | 8389/9741 [00:17<00:02, 511.00it/s] 87%|██████████████████████████████████████████████████████████████▍         | 8441/9741 [00:17<00:02, 508.55it/s] 87%|██████████████████████████████████████████████████████████████▊         | 8493/9741 [00:17<00:02, 509.66it/s] 88%|███████████████████████████████████████████████████████████████▏        | 8545/9741 [00:17<00:02, 511.20it/s] 88%|███████████████████████████████████████████████████████████████▌        | 8597/9741 [00:17<00:02, 510.07it/s] 89%|███████████████████████████████████████████████████████████████▉        | 8649/9741 [00:18<00:02, 510.61it/s] 89%|████████████████████████████████████████████████████████████████▎       | 8701/9741 [00:18<00:02, 511.16it/s] 90%|████████████████████████████████████████████████████████████████▋       | 8753/9741 [00:18<00:01, 511.80it/s] 90%|█████████████████████████████████████████████████████████████████       | 8805/9741 [00:18<00:01, 510.08it/s] 91%|█████████████████████████████████████████████████████████████████▍      | 8857/9741 [00:18<00:01, 510.92it/s] 91%|█████████████████████████████████████████████████████████████████▊      | 8909/9741 [00:18<00:01, 511.72it/s] 92%|██████████████████████████████████████████████████████████████████▏     | 8961/9741 [00:18<00:01, 512.20it/s] 93%|██████████████████████████████████████████████████████████████████▌     | 9013/9741 [00:18<00:01, 512.18it/s] 93%|███████████████████████████████████████████████████████████████████     | 9065/9741 [00:18<00:01, 510.06it/s] 94%|███████████████████████████████████████████████████████████████████▍    | 9117/9741 [00:19<00:01, 510.81it/s] 94%|███████████████████████████████████████████████████████████████████▊    | 9169/9741 [00:19<00:01, 511.25it/s] 95%|████████████████████████████████████████████████████████████████████▏   | 9221/9741 [00:19<00:01, 511.97it/s] 95%|████████████████████████████████████████████████████████████████████▌   | 9273/9741 [00:19<00:00, 503.98it/s] 96%|████████████████████████████████████████████████████████████████████▉   | 9325/9741 [00:19<00:00, 506.00it/s] 96%|█████████████████████████████████████████████████████████████████████▎  | 9377/9741 [00:19<00:00, 507.90it/s] 97%|█████████████████████████████████████████████████████████████████████▋  | 9429/9741 [00:19<00:00, 508.78it/s] 97%|██████████████████████████████████████████████████████████████████████  | 9481/9741 [00:19<00:00, 510.02it/s] 98%|██████████████████████████████████████████████████████████████████████▍ | 9533/9741 [00:19<00:00, 508.78it/s] 98%|██████████████████████████████████████████████████████████████████████▊ | 9585/9741 [00:19<00:00, 509.82it/s] 99%|███████████████████████████████████████████████████████████████████████▏| 9636/9741 [00:20<00:00, 506.79it/s] 99%|███████████████████████████████████████████████████████████████████████▌| 9687/9741 [00:20<00:00, 507.56it/s]100%|███████████████████████████████████████████████████████████████████████▉| 9738/9741 [00:20<00:00, 506.36it/s]100%|████████████████████████████████████████████████████████████████████████| 9741/9741 [00:20<00:00, 481.15it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:04<00:09,  4.95s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.27s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.18s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.18s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.08s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.13s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.15s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.18s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.47s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.62s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.53s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.70s/it]
[2023-08-14 10:17:50,904] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.52s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.70s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.54s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.71s/it]
[2023-08-14 10:18:02,508] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-14 10:18:02,508] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-14 10:18:02,509] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-14 10:18:02,509] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-14 10:18:02,509] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-14 10:18:02,509] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-14 10:18:02,509] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-14 10:18:02,509] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-14 10:18:02,509] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-14 10:18:02,509] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-14 10:18:02,509] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-14 10:18:02,509] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f68f0f30fd0>
[2023-08-14 10:18:02,509] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-14 10:18:02,509] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-14 10:18:02,509] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-14 10:18:02,509] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-14 10:18:02,509] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-14 10:18:02,509] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-14 10:18:02,509] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-14 10:18:02,509] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-14 10:18:02,509] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-14 10:18:02,509] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f68cd53ccd0>
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-14 10:18:02,510] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-14 10:18:02,510] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.4586756229400635 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                                           | 0/50 [00:00<?, ?it/s]############### Example ###############
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following multiple choice question.

### Demonstration:
Input: Adam bought 3 kilograms of nuts and 2.5 kilograms of dried fruits at a store. One kilogram of nuts costs $12 and one kilogram of dried fruit costs $8. How much did his purchases cost?
Answer: 56

Input: Johns goes to the gym 3 times a week.  He spends 1 hour each day lifting weight. Additionally, he also spends a third of his weightlifting time warming up and doing cardio each day.  How many hours does he spend at the gym a week?
Answer: 4

Input: James has to refuel his plane.  It used to cost $200 to refill the tank.  He got an extra tank to double fuel capacity.  Fuel prices also went up by 20%.  How much does he pay now for fuel?
Answer: 480

Input: The number of goals scored in a game against Barca by exactly two players last season accounts for 20% of all goals scored in the league. If the players scored an equal number of goals, and the total number of goals scored in the league against Barca that season is 300, calculate the number of goals each of the two players scored.
Answer: 30

Input: Every day Tom drinks 5 12-oz cans of soda plus 64 ounces of water. How many ounces of fluid does he drink a week?
Answer: 868

Input: Stella and Twinkle are filling up a truck with a capacity of 6000 stone blocks at the rate of 250 blocks per hour per person. They work for four hours and are then joined by 6 other people who also work at the same rate. How many hours did filling the truck take?
Answer: 6

Input: Elijah drank 8.5 pints of coffee yesterday. Emilio drank 9.5 pints of water yesterday. How many cups of liquid did the two boys drink yesterday?
Answer: 36

Input: Doris works at the Widget Factory in the packing department. She puts 3 widgets in each carton, which are 4 inches wide, 4 inches long, and 5 inches tall. She then packs those cartons into a shipping box before sending it to the loading bay. The shipping boxes are 20 inches wide, 20 inches long, and 20 inches high. How many widgets get shipped in each shipping box?
Answer: 300

Input: Queenie earns $150 a day as a part-time clerk. She earns an additional $5 per hour as overtime pay. How much will Queenie receive for working 5 days with 4 hours overtime?
Answer: 770

Input: Jodi starts off walking 1 mile a day for 6 days a week.  On the second week, she walks 2 miles a day, 6 days a week.  On the third week, she walks 3 miles a day, 6 days a week. Finally on the fourth week, she walks 4 miles a day, 6 days a week.  How many miles has she walked in 4 weeks?
Answer: 60

Input: A club is going to get additional members so that they will have 5 more than twice their current number of their members. If the club has 10 members now, how many additional members do they need?
Answer: 15

Input: Andrea buys herself a pony for her 30th birthday. She pays $500/month to rent a pasture for it, $10 a day for food, and $60/lesson for two lessons a week. How much does she spend on her pony in a year?
Answer: 15890

Input: A pet shop has 2 puppies and some kittens. A puppy costs $20, and a kitten costs $15. If the stock is worth $100, how many kittens does the pet shop have?
Answer: 4

Input: Noah, who loves his Grammy, calls her every week to talk about his day. If each call lasts 30 minutes and he is charged $0.05 per call minute, how much would he be billed if he makes the calls for a year?
Answer: 78

Input: A merchant bought 15 keyboards and 25 printers for a total of $2050. If a keyboard costs $20, how much does a printer cost?
Answer: 70

### Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid

### Response:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o15-tgsm8k-s10-rFalse
Loading extension module utils...
Time to load utils op: 0.4045743942260742 seconds
Loading extension module utils...
Time to load utils op: 0.5048041343688965 seconds
Loading extension module utils...
Time to load utils op: 0.4051930904388428 seconds
Evaluating commonsenseqa :   2%|█                                                  | 1/50 [00:44<36:10, 44.30s/it]Evaluating commonsenseqa :   4%|██                                                 | 2/50 [01:27<35:01, 43.78s/it]Evaluating commonsenseqa :   6%|███                                                | 3/50 [02:11<34:14, 43.71s/it]Evaluating commonsenseqa :   8%|████                                               | 4/50 [02:54<33:23, 43.56s/it]Evaluating commonsenseqa :  10%|█████                                              | 5/50 [03:37<32:36, 43.47s/it]Evaluating commonsenseqa :  12%|██████                                             | 6/50 [04:22<32:04, 43.74s/it]Evaluating commonsenseqa :  14%|███████▏                                           | 7/50 [05:05<31:20, 43.72s/it]Evaluating commonsenseqa :  16%|████████▏                                          | 8/50 [05:34<27:14, 38.92s/it]Evaluating commonsenseqa :  18%|█████████▏                                         | 9/50 [06:17<27:33, 40.32s/it]Evaluating commonsenseqa :  20%|██████████                                        | 10/50 [07:01<27:31, 41.30s/it]Evaluating commonsenseqa :  22%|███████████                                       | 11/50 [07:45<27:20, 42.05s/it]Evaluating commonsenseqa :  24%|████████████                                      | 12/50 [08:28<26:57, 42.56s/it]Evaluating commonsenseqa :  26%|█████████████                                     | 13/50 [09:12<26:21, 42.75s/it]Evaluating commonsenseqa :  28%|██████████████                                    | 14/50 [09:28<20:55, 34.89s/it]Evaluating commonsenseqa :  30%|███████████████                                   | 15/50 [09:51<18:16, 31.32s/it]Evaluating commonsenseqa :  32%|████████████████                                  | 16/50 [10:35<19:46, 34.91s/it]Evaluating commonsenseqa :  34%|█████████████████                                 | 17/50 [11:05<18:30, 33.67s/it]Evaluating commonsenseqa :  36%|██████████████████                                | 18/50 [11:49<19:36, 36.76s/it]Evaluating commonsenseqa :  38%|███████████████████                               | 19/50 [12:33<20:00, 38.72s/it]Evaluating commonsenseqa :  40%|████████████████████                              | 20/50 [13:16<20:06, 40.20s/it]Evaluating commonsenseqa :  42%|█████████████████████                             | 21/50 [14:00<19:55, 41.21s/it]Evaluating commonsenseqa :  44%|██████████████████████                            | 22/50 [14:44<19:34, 41.96s/it]Evaluating commonsenseqa :  46%|███████████████████████                           | 23/50 [15:27<19:02, 42.30s/it]Evaluating commonsenseqa :  48%|████████████████████████                          | 24/50 [16:10<18:31, 42.74s/it]Evaluating commonsenseqa :  50%|█████████████████████████                         | 25/50 [16:55<17:58, 43.15s/it]Evaluating commonsenseqa :  52%|██████████████████████████                        | 26/50 [17:34<16:52, 42.17s/it]Evaluating commonsenseqa :  54%|███████████████████████████                       | 27/50 [18:19<16:23, 42.78s/it]Evaluating commonsenseqa :  56%|████████████████████████████                      | 28/50 [19:02<15:46, 43.00s/it]Evaluating commonsenseqa :  58%|████████████████████████████▉                     | 29/50 [19:46<15:08, 43.27s/it]Evaluating commonsenseqa :  60%|██████████████████████████████                    | 30/50 [20:21<13:36, 40.84s/it]Evaluating commonsenseqa :  62%|███████████████████████████████                   | 31/50 [20:41<10:53, 34.39s/it]Evaluating commonsenseqa :  64%|████████████████████████████████                  | 32/50 [21:10<09:53, 32.98s/it]Evaluating commonsenseqa :  66%|█████████████████████████████████                 | 33/50 [21:54<10:14, 36.17s/it]Evaluating commonsenseqa :  68%|██████████████████████████████████                | 34/50 [22:38<10:15, 38.46s/it]Evaluating commonsenseqa :  70%|███████████████████████████████████               | 35/50 [23:21<09:58, 39.93s/it]Evaluating commonsenseqa :  72%|████████████████████████████████████              | 36/50 [24:05<09:35, 41.07s/it]Evaluating commonsenseqa :  74%|█████████████████████████████████████             | 37/50 [24:49<09:07, 42.13s/it]Evaluating commonsenseqa :  76%|██████████████████████████████████████            | 38/50 [25:34<08:35, 42.96s/it]Evaluating commonsenseqa :  78%|███████████████████████████████████████           | 39/50 [26:18<07:56, 43.28s/it]Evaluating commonsenseqa :  80%|████████████████████████████████████████          | 40/50 [27:03<07:16, 43.65s/it]Evaluating commonsenseqa :  82%|█████████████████████████████████████████         | 41/50 [27:31<05:51, 39.03s/it]Evaluating commonsenseqa :  84%|██████████████████████████████████████████        | 42/50 [28:15<05:23, 40.44s/it]Evaluating commonsenseqa :  86%|███████████████████████████████████████████       | 43/50 [28:59<04:50, 41.45s/it]Evaluating commonsenseqa :  88%|████████████████████████████████████████████      | 44/50 [29:42<04:13, 42.19s/it]Evaluating commonsenseqa :  90%|█████████████████████████████████████████████     | 45/50 [30:26<03:32, 42.57s/it]Evaluating commonsenseqa :  92%|██████████████████████████████████████████████    | 46/50 [31:10<02:51, 42.92s/it]Evaluating commonsenseqa :  94%|███████████████████████████████████████████████   | 47/50 [31:54<02:09, 43.26s/it]Evaluating commonsenseqa :  96%|████████████████████████████████████████████████  | 48/50 [32:37<01:26, 43.36s/it]Evaluating commonsenseqa :  98%|█████████████████████████████████████████████████ | 49/50 [33:21<00:43, 43.59s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████| 50/50 [33:55<00:00, 40.60s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████| 50/50 [33:55<00:00, 40.71s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 4.0571} | lm_loss 7.7879 | avg. gen lenth: 245.94
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name gsm8k --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/out-domain/o16-tgsm8k-s10-rFalse --seed 10 --num-out-domain 16
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-14 10:52:12,578] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/out-domain/o16-tgsm8k-s10-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 16
  out_domain_data_name ......... gsm8k
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o16-tgsm8k-s10-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 10
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                    | 0/9741 [00:00<?, ?it/s]  0%|▏                                                                         | 31/9741 [00:00<00:31, 306.04it/s]  1%|▍                                                                         | 63/9741 [00:00<00:31, 308.23it/s]  1%|▋                                                                         | 95/9741 [00:00<00:31, 309.36it/s]  1%|▉                                                                        | 126/9741 [00:00<00:31, 309.32it/s]  2%|█▏                                                                       | 157/9741 [00:00<00:30, 309.32it/s]  2%|█▍                                                                       | 188/9741 [00:00<00:30, 308.70it/s]  2%|█▋                                                                       | 219/9741 [00:00<00:31, 306.64it/s]  3%|█▊                                                                       | 250/9741 [00:00<00:31, 301.91it/s]  3%|██                                                                       | 281/9741 [00:00<00:31, 303.78it/s]  3%|██▎                                                                      | 312/9741 [00:01<00:30, 305.06it/s]  4%|██▌                                                                      | 343/9741 [00:01<00:30, 305.87it/s]  4%|██▊                                                                      | 374/9741 [00:01<00:30, 306.63it/s]  4%|███                                                                      | 406/9741 [00:01<00:30, 307.84it/s]  4%|███▎                                                                     | 437/9741 [00:01<00:30, 306.36it/s]  5%|███▌                                                                     | 469/9741 [00:01<00:30, 307.47it/s]  5%|███▊                                                                     | 501/9741 [00:01<00:29, 308.53it/s]  5%|███▉                                                                     | 533/9741 [00:01<00:29, 309.24it/s]  6%|████▏                                                                    | 564/9741 [00:01<00:29, 306.13it/s]  6%|████▍                                                                    | 595/9741 [00:01<00:29, 306.64it/s]  6%|████▋                                                                    | 626/9741 [00:02<00:29, 307.27it/s]  7%|████▉                                                                    | 657/9741 [00:02<00:29, 306.17it/s]  7%|█████▏                                                                   | 689/9741 [00:02<00:29, 307.66it/s]  7%|█████▍                                                                   | 720/9741 [00:02<00:29, 308.16it/s]  8%|█████▋                                                                   | 757/9741 [00:02<00:27, 325.49it/s]  8%|██████                                                                   | 804/9741 [00:02<00:24, 367.90it/s]  9%|██████▍                                                                  | 851/9741 [00:02<00:22, 397.87it/s]  9%|██████▋                                                                  | 897/9741 [00:02<00:21, 415.78it/s] 10%|███████                                                                  | 944/9741 [00:02<00:20, 430.45it/s] 10%|███████▍                                                                 | 991/9741 [00:02<00:19, 440.70it/s] 11%|███████▋                                                                | 1038/9741 [00:03<00:19, 446.92it/s] 11%|████████                                                                | 1084/9741 [00:03<00:19, 450.59it/s] 12%|████████▎                                                               | 1130/9741 [00:03<00:19, 451.50it/s] 12%|████████▋                                                               | 1177/9741 [00:03<00:18, 455.95it/s] 13%|█████████                                                               | 1224/9741 [00:03<00:18, 458.83it/s] 13%|█████████▍                                                              | 1271/9741 [00:03<00:18, 461.00it/s] 14%|█████████▋                                                              | 1318/9741 [00:03<00:18, 462.87it/s] 14%|██████████                                                              | 1365/9741 [00:03<00:18, 461.70it/s] 14%|██████████▍                                                             | 1412/9741 [00:03<00:18, 460.41it/s] 15%|██████████▊                                                             | 1459/9741 [00:03<00:17, 461.41it/s] 15%|███████████▏                                                            | 1506/9741 [00:04<00:17, 462.71it/s] 16%|███████████▍                                                            | 1553/9741 [00:04<00:17, 464.37it/s] 16%|███████████▊                                                            | 1600/9741 [00:04<00:17, 462.35it/s] 17%|████████████▏                                                           | 1647/9741 [00:04<00:17, 459.76it/s] 17%|████████████▌                                                           | 1694/9741 [00:04<00:17, 461.25it/s] 18%|████████████▊                                                           | 1741/9741 [00:04<00:17, 462.54it/s] 18%|█████████████▏                                                          | 1788/9741 [00:04<00:17, 463.76it/s] 19%|█████████████▌                                                          | 1835/9741 [00:04<00:18, 428.45it/s] 19%|█████████████▉                                                          | 1882/9741 [00:04<00:17, 438.75it/s] 20%|██████████████▎                                                         | 1928/9741 [00:05<00:17, 444.68it/s] 20%|██████████████▌                                                         | 1975/9741 [00:05<00:17, 450.59it/s] 21%|██████████████▉                                                         | 2021/9741 [00:05<00:17, 451.31it/s] 21%|███████████████▎                                                        | 2068/9741 [00:05<00:16, 455.45it/s] 22%|███████████████▋                                                        | 2115/9741 [00:05<00:16, 457.40it/s] 22%|███████████████▉                                                        | 2162/9741 [00:05<00:16, 458.88it/s] 23%|████████████████▎                                                       | 2209/9741 [00:05<00:16, 460.33it/s] 23%|████████████████▋                                                       | 2256/9741 [00:05<00:16, 456.49it/s] 24%|█████████████████                                                       | 2303/9741 [00:05<00:16, 458.45it/s] 24%|█████████████████▎                                                      | 2349/9741 [00:05<00:16, 458.79it/s] 25%|█████████████████▋                                                      | 2395/9741 [00:06<00:16, 458.17it/s] 25%|██████████████████                                                      | 2441/9741 [00:06<00:15, 456.50it/s] 26%|██████████████████▍                                                     | 2487/9741 [00:06<00:15, 454.61it/s] 26%|██████████████████▋                                                     | 2533/9741 [00:06<00:15, 455.93it/s] 26%|███████████████████                                                     | 2580/9741 [00:06<00:15, 457.34it/s] 27%|███████████████████▍                                                    | 2626/9741 [00:06<00:15, 457.78it/s] 27%|███████████████████▋                                                    | 2672/9741 [00:06<00:15, 457.99it/s] 28%|████████████████████                                                    | 2718/9741 [00:06<00:15, 455.24it/s] 28%|████████████████████▍                                                   | 2764/9741 [00:06<00:15, 455.63it/s] 29%|████████████████████▊                                                   | 2810/9741 [00:06<00:15, 455.74it/s] 29%|█████████████████████                                                   | 2856/9741 [00:07<00:15, 455.39it/s] 30%|█████████████████████▍                                                  | 2902/9741 [00:07<00:15, 451.38it/s] 30%|█████████████████████▊                                                  | 2948/9741 [00:07<00:15, 445.40it/s] 31%|██████████████████████▏                                                 | 2994/9741 [00:07<00:15, 446.97it/s] 31%|██████████████████████▍                                                 | 3039/9741 [00:07<00:14, 446.92it/s] 32%|██████████████████████▊                                                 | 3085/9741 [00:07<00:14, 449.25it/s] 32%|███████████████████████▏                                                | 3131/9741 [00:07<00:14, 452.05it/s] 33%|███████████████████████▍                                                | 3177/9741 [00:07<00:14, 451.25it/s] 33%|███████████████████████▊                                                | 3223/9741 [00:07<00:14, 453.44it/s] 34%|████████████████████████▏                                               | 3269/9741 [00:07<00:14, 455.29it/s] 34%|████████████████████████▌                                               | 3315/9741 [00:08<00:14, 455.37it/s] 35%|████████████████████████▊                                               | 3361/9741 [00:08<00:14, 455.47it/s] 35%|█████████████████████████▏                                              | 3407/9741 [00:08<00:13, 452.68it/s] 35%|█████████████████████████▌                                              | 3453/9741 [00:08<00:13, 451.27it/s] 36%|█████████████████████████▊                                              | 3499/9741 [00:08<00:13, 452.87it/s] 36%|██████████████████████████▏                                             | 3545/9741 [00:08<00:13, 454.18it/s] 37%|██████████████████████████▌                                             | 3591/9741 [00:08<00:13, 455.28it/s] 37%|██████████████████████████▉                                             | 3637/9741 [00:08<00:13, 453.91it/s] 38%|███████████████████████████▏                                            | 3683/9741 [00:08<00:13, 454.57it/s] 38%|███████████████████████████▌                                            | 3729/9741 [00:08<00:13, 455.60it/s] 39%|███████████████████████████▉                                            | 3775/9741 [00:09<00:13, 454.61it/s] 39%|████████████████████████████▏                                           | 3821/9741 [00:09<00:13, 455.21it/s] 40%|████████████████████████████▌                                           | 3867/9741 [00:09<00:13, 450.98it/s] 40%|████████████████████████████▉                                           | 3913/9741 [00:09<00:12, 453.16it/s] 41%|█████████████████████████████▎                                          | 3959/9741 [00:09<00:12, 452.87it/s] 41%|█████████████████████████████▌                                          | 4005/9741 [00:09<00:12, 451.39it/s] 42%|█████████████████████████████▉                                          | 4051/9741 [00:09<00:12, 451.89it/s] 42%|██████████████████████████████▎                                         | 4097/9741 [00:09<00:12, 450.62it/s] 43%|██████████████████████████████▌                                         | 4143/9741 [00:09<00:12, 452.40it/s] 43%|██████████████████████████████▉                                         | 4189/9741 [00:09<00:12, 453.35it/s] 43%|███████████████████████████████▎                                        | 4235/9741 [00:10<00:12, 453.57it/s] 44%|███████████████████████████████▋                                        | 4281/9741 [00:10<00:12, 454.40it/s] 44%|███████████████████████████████▉                                        | 4327/9741 [00:10<00:11, 453.09it/s] 45%|████████████████████████████████▎                                       | 4373/9741 [00:10<00:11, 454.06it/s] 45%|████████████████████████████████▋                                       | 4419/9741 [00:10<00:11, 454.59it/s] 46%|█████████████████████████████████                                       | 4465/9741 [00:10<00:11, 455.27it/s] 46%|█████████████████████████████████▎                                      | 4511/9741 [00:10<00:11, 454.92it/s] 47%|█████████████████████████████████▋                                      | 4557/9741 [00:10<00:12, 422.95it/s] 47%|██████████████████████████████████                                      | 4604/9741 [00:10<00:11, 434.03it/s] 48%|██████████████████████████████████▍                                     | 4651/9741 [00:11<00:11, 442.21it/s] 48%|██████████████████████████████████▋                                     | 4698/9741 [00:11<00:11, 448.27it/s] 49%|███████████████████████████████████                                     | 4744/9741 [00:11<00:15, 319.28it/s] 49%|███████████████████████████████████▍                                    | 4791/9741 [00:11<00:14, 352.72it/s] 50%|███████████████████████████████████▊                                    | 4838/9741 [00:11<00:12, 380.33it/s] 50%|████████████████████████████████████                                    | 4885/9741 [00:11<00:12, 401.70it/s] 51%|████████████████████████████████████▍                                   | 4932/9741 [00:11<00:11, 418.25it/s] 51%|████████████████████████████████████▊                                   | 4977/9741 [00:11<00:11, 426.43it/s] 52%|█████████████████████████████████████▏                                  | 5024/9741 [00:11<00:10, 436.92it/s] 52%|█████████████████████████████████████▍                                  | 5071/9741 [00:12<00:10, 444.62it/s] 53%|█████████████████████████████████████▊                                  | 5118/9741 [00:12<00:10, 450.53it/s] 53%|██████████████████████████████████████▏                                 | 5165/9741 [00:12<00:10, 454.62it/s] 53%|██████████████████████████████████████▌                                 | 5211/9741 [00:12<00:09, 455.20it/s] 54%|██████████████████████████████████████▊                                 | 5257/9741 [00:12<00:09, 454.36it/s] 54%|███████████████████████████████████████▏                                | 5304/9741 [00:12<00:09, 457.52it/s] 55%|███████████████████████████████████████▌                                | 5351/9741 [00:12<00:09, 459.68it/s] 55%|███████████████████████████████████████▉                                | 5398/9741 [00:12<00:09, 459.08it/s] 56%|████████████████████████████████████████▏                               | 5445/9741 [00:12<00:09, 461.00it/s] 56%|████████████████████████████████████████▌                               | 5492/9741 [00:12<00:09, 463.47it/s] 57%|████████████████████████████████████████▉                               | 5540/9741 [00:13<00:09, 466.67it/s] 57%|█████████████████████████████████████████▎                              | 5588/9741 [00:13<00:08, 470.04it/s] 58%|█████████████████████████████████████████▋                              | 5636/9741 [00:13<00:08, 469.15it/s] 58%|██████████████████████████████████████████                              | 5684/9741 [00:13<00:08, 471.97it/s] 59%|██████████████████████████████████████████▍                             | 5733/9741 [00:13<00:08, 474.68it/s] 59%|██████████████████████████████████████████▋                             | 5781/9741 [00:13<00:08, 476.10it/s] 60%|███████████████████████████████████████████                             | 5829/9741 [00:13<00:08, 473.83it/s] 60%|███████████████████████████████████████████▍                            | 5877/9741 [00:13<00:08, 470.55it/s] 61%|███████████████████████████████████████████▊                            | 5925/9741 [00:13<00:08, 472.84it/s] 61%|████████████████████████████████████████████▏                           | 5974/9741 [00:13<00:07, 475.19it/s] 62%|████████████████████████████████████████████▌                           | 6022/9741 [00:14<00:07, 476.55it/s] 62%|████████████████████████████████████████████▊                           | 6070/9741 [00:14<00:07, 474.44it/s] 63%|█████████████████████████████████████████████▏                          | 6118/9741 [00:14<00:07, 473.61it/s] 63%|█████████████████████████████████████████████▌                          | 6166/9741 [00:14<00:07, 475.23it/s] 64%|█████████████████████████████████████████████▉                          | 6214/9741 [00:14<00:07, 475.16it/s] 64%|██████████████████████████████████████████████▎                         | 6262/9741 [00:14<00:07, 475.05it/s] 65%|██████████████████████████████████████████████▋                         | 6310/9741 [00:14<00:07, 473.58it/s] 65%|██████████████████████████████████████████████▉                         | 6358/9741 [00:14<00:07, 475.04it/s] 66%|███████████████████████████████████████████████▎                        | 6406/9741 [00:14<00:07, 476.01it/s] 66%|███████████████████████████████████████████████▋                        | 6454/9741 [00:15<00:06, 476.78it/s] 67%|████████████████████████████████████████████████                        | 6502/9741 [00:15<00:06, 477.27it/s] 67%|████████████████████████████████████████████████▍                       | 6550/9741 [00:15<00:06, 474.96it/s] 68%|████████████████████████████████████████████████▊                       | 6598/9741 [00:15<00:06, 473.65it/s] 68%|█████████████████████████████████████████████████                       | 6646/9741 [00:15<00:06, 475.17it/s] 69%|█████████████████████████████████████████████████▍                      | 6694/9741 [00:15<00:06, 476.25it/s] 69%|█████████████████████████████████████████████████▊                      | 6742/9741 [00:15<00:06, 477.34it/s] 70%|██████████████████████████████████████████████████▏                     | 6790/9741 [00:15<00:06, 475.62it/s] 70%|██████████████████████████████████████████████████▌                     | 6838/9741 [00:15<00:06, 475.43it/s] 71%|██████████████████████████████████████████████████▉                     | 6886/9741 [00:15<00:06, 471.60it/s] 71%|███████████████████████████████████████████████████▎                    | 6934/9741 [00:16<00:05, 473.69it/s] 72%|███████████████████████████████████████████████████▌                    | 6982/9741 [00:16<00:05, 474.36it/s] 72%|███████████████████████████████████████████████████▉                    | 7030/9741 [00:16<00:05, 471.96it/s] 73%|████████████████████████████████████████████████████▎                   | 7078/9741 [00:16<00:05, 472.92it/s] 73%|████████████████████████████████████████████████████▋                   | 7127/9741 [00:16<00:05, 475.06it/s] 74%|█████████████████████████████████████████████████████                   | 7175/9741 [00:16<00:05, 476.03it/s] 74%|█████████████████████████████████████████████████████▍                  | 7223/9741 [00:16<00:05, 474.03it/s] 75%|█████████████████████████████████████████████████████▋                  | 7271/9741 [00:16<00:05, 475.27it/s] 75%|██████████████████████████████████████████████████████                  | 7319/9741 [00:16<00:05, 475.67it/s] 76%|██████████████████████████████████████████████████████▍                 | 7367/9741 [00:16<00:04, 476.62it/s] 76%|██████████████████████████████████████████████████████▊                 | 7415/9741 [00:17<00:04, 477.19it/s] 77%|███████████████████████████████████████████████████████▏                | 7463/9741 [00:17<00:05, 431.85it/s] 77%|███████████████████████████████████████████████████████▌                | 7510/9741 [00:17<00:05, 442.41it/s] 78%|███████████████████████████████████████████████████████▊                | 7557/9741 [00:17<00:04, 448.16it/s] 78%|████████████████████████████████████████████████████████▏               | 7605/9741 [00:17<00:04, 455.61it/s] 79%|████████████████████████████████████████████████████████▌               | 7651/9741 [00:17<00:04, 456.43it/s] 79%|████████████████████████████████████████████████████████▉               | 7698/9741 [00:17<00:04, 460.09it/s] 80%|█████████████████████████████████████████████████████████▎              | 7746/9741 [00:17<00:04, 465.39it/s] 80%|█████████████████████████████████████████████████████████▌              | 7794/9741 [00:17<00:04, 468.41it/s] 81%|█████████████████████████████████████████████████████████▉              | 7842/9741 [00:17<00:04, 471.18it/s] 81%|██████████████████████████████████████████████████████████▎             | 7890/9741 [00:18<00:03, 472.90it/s] 81%|██████████████████████████████████████████████████████████▋             | 7938/9741 [00:18<00:03, 472.38it/s] 82%|███████████████████████████████████████████████████████████             | 7986/9741 [00:18<00:03, 474.03it/s] 82%|███████████████████████████████████████████████████████████▍            | 8034/9741 [00:18<00:03, 474.70it/s] 83%|███████████████████████████████████████████████████████████▋            | 8082/9741 [00:18<00:03, 473.93it/s] 83%|████████████████████████████████████████████████████████████            | 8130/9741 [00:18<00:03, 472.83it/s] 84%|████████████████████████████████████████████████████████████▍           | 8178/9741 [00:18<00:03, 474.33it/s] 84%|████████████████████████████████████████████████████████████▊           | 8226/9741 [00:18<00:03, 475.11it/s] 85%|█████████████████████████████████████████████████████████████▏          | 8274/9741 [00:18<00:03, 475.52it/s] 85%|█████████████████████████████████████████████████████████████▌          | 8322/9741 [00:18<00:02, 475.95it/s] 86%|█████████████████████████████████████████████████████████████▊          | 8370/9741 [00:19<00:02, 474.17it/s] 86%|██████████████████████████████████████████████████████████████▏         | 8418/9741 [00:19<00:02, 474.73it/s] 87%|██████████████████████████████████████████████████████████████▌         | 8466/9741 [00:19<00:02, 475.15it/s] 87%|██████████████████████████████████████████████████████████████▉         | 8514/9741 [00:19<00:02, 474.26it/s] 88%|███████████████████████████████████████████████████████████████▎        | 8562/9741 [00:19<00:02, 474.66it/s] 88%|███████████████████████████████████████████████████████████████▋        | 8610/9741 [00:19<00:02, 472.32it/s] 89%|███████████████████████████████████████████████████████████████▉        | 8658/9741 [00:19<00:02, 473.03it/s] 89%|████████████████████████████████████████████████████████████████▎       | 8706/9741 [00:19<00:02, 471.51it/s] 90%|████████████████████████████████████████████████████████████████▋       | 8754/9741 [00:19<00:02, 472.28it/s] 90%|█████████████████████████████████████████████████████████████████       | 8802/9741 [00:19<00:01, 471.20it/s] 91%|█████████████████████████████████████████████████████████████████▍      | 8850/9741 [00:20<00:01, 472.67it/s] 91%|█████████████████████████████████████████████████████████████████▊      | 8898/9741 [00:20<00:01, 473.90it/s] 92%|██████████████████████████████████████████████████████████████████      | 8946/9741 [00:20<00:01, 474.97it/s] 92%|██████████████████████████████████████████████████████████████████▍     | 8994/9741 [00:20<00:01, 475.30it/s] 93%|██████████████████████████████████████████████████████████████████▊     | 9042/9741 [00:20<00:01, 471.19it/s] 93%|███████████████████████████████████████████████████████████████████▏    | 9090/9741 [00:20<00:01, 471.52it/s] 94%|███████████████████████████████████████████████████████████████████▌    | 9138/9741 [00:20<00:01, 472.85it/s] 94%|███████████████████████████████████████████████████████████████████▉    | 9186/9741 [00:20<00:01, 473.44it/s] 95%|████████████████████████████████████████████████████████████████████▎   | 9234/9741 [00:20<00:01, 474.23it/s] 95%|████████████████████████████████████████████████████████████████████▌   | 9282/9741 [00:21<00:00, 472.84it/s] 96%|████████████████████████████████████████████████████████████████████▉   | 9330/9741 [00:21<00:00, 473.88it/s] 96%|█████████████████████████████████████████████████████████████████████▎  | 9378/9741 [00:21<00:00, 474.41it/s] 97%|█████████████████████████████████████████████████████████████████████▋  | 9426/9741 [00:21<00:00, 473.26it/s] 97%|██████████████████████████████████████████████████████████████████████  | 9474/9741 [00:21<00:00, 472.39it/s] 98%|██████████████████████████████████████████████████████████████████████▍ | 9522/9741 [00:21<00:00, 470.99it/s] 98%|██████████████████████████████████████████████████████████████████████▋ | 9570/9741 [00:21<00:00, 472.07it/s] 99%|███████████████████████████████████████████████████████████████████████ | 9618/9741 [00:21<00:00, 470.53it/s] 99%|███████████████████████████████████████████████████████████████████████▍| 9666/9741 [00:21<00:00, 470.87it/s]100%|███████████████████████████████████████████████████████████████████████▊| 9714/9741 [00:21<00:00, 469.46it/s]100%|████████████████████████████████████████████████████████████████████████| 9741/9741 [00:21<00:00, 443.10it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.41s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:11,  5.99s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:11,  5.80s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:11,  5.60s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.44s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:11<00:05,  5.75s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:11<00:05,  5.61s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.47s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:15<00:00,  4.87s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.02s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:15<00:00,  4.81s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.00s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.10s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.26s/it]
[2023-08-14 10:53:28,160] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:16<00:00,  5.29s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:16<00:00,  5.44s/it]
[2023-08-14 10:53:42,519] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-14 10:53:42,521] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-14 10:53:42,521] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-14 10:53:42,521] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-14 10:53:42,521] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-14 10:53:42,521] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-14 10:53:42,522] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-14 10:53:42,522] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-14 10:53:42,522] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-14 10:53:42,522] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-14 10:53:42,522] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-14 10:53:42,522] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f1cd0096fd0>
[2023-08-14 10:53:42,522] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-14 10:53:42,522] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-14 10:53:42,522] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-14 10:53:42,522] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-14 10:53:42,522] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-14 10:53:42,522] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-14 10:53:42,522] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-14 10:53:42,522] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-14 10:53:42,522] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-14 10:53:42,522] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-14 10:53:42,522] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-14 10:53:42,522] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-14 10:53:42,522] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-14 10:53:42,522] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-14 10:53:42,522] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-14 10:53:42,522] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-14 10:53:42,522] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-14 10:53:42,522] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-14 10:53:42,522] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-14 10:53:42,522] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-14 10:53:42,523] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-14 10:53:42,523] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-14 10:53:42,523] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-14 10:53:42,523] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-14 10:53:42,523] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-14 10:53:42,523] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-14 10:53:42,523] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-14 10:53:42,523] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-14 10:53:42,523] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-14 10:53:42,523] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-14 10:53:42,523] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-14 10:53:42,523] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-14 10:53:42,523] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f1ca4d3fcd0>
[2023-08-14 10:53:42,523] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-14 10:53:42,523] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-14 10:53:42,523] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-14 10:53:42,523] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-14 10:53:42,523] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-14 10:53:42,523] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-14 10:53:42,523] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-14 10:53:42,523] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-14 10:53:42,523] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-14 10:53:42,523] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-14 10:53:42,523] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-14 10:53:42,523] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-14 10:53:42,523] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-14 10:53:42,523] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-14 10:53:42,523] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-14 10:53:42,523] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-14 10:53:42,523] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-14 10:53:42,523] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-14 10:53:42,523] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-14 10:53:42,523] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-14 10:53:42,523] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-14 10:53:42,524] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-14 10:53:42,524] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.502802848815918 seconds
Loading extension module utils...
Time to load utils op: 0.404449462890625 seconds
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Evaluating commonsenseqa :   0%|                                                           | 0/50 [00:00<?, ?it/s]############### Example ###############
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following multiple choice question.

### Demonstration:
Input: Adam bought 3 kilograms of nuts and 2.5 kilograms of dried fruits at a store. One kilogram of nuts costs $12 and one kilogram of dried fruit costs $8. How much did his purchases cost?
Answer: 56

Input: Johns goes to the gym 3 times a week.  He spends 1 hour each day lifting weight. Additionally, he also spends a third of his weightlifting time warming up and doing cardio each day.  How many hours does he spend at the gym a week?
Answer: 4

Input: James has to refuel his plane.  It used to cost $200 to refill the tank.  He got an extra tank to double fuel capacity.  Fuel prices also went up by 20%.  How much does he pay now for fuel?
Answer: 480

Input: The number of goals scored in a game against Barca by exactly two players last season accounts for 20% of all goals scored in the league. If the players scored an equal number of goals, and the total number of goals scored in the league against Barca that season is 300, calculate the number of goals each of the two players scored.
Answer: 30

Input: Every day Tom drinks 5 12-oz cans of soda plus 64 ounces of water. How many ounces of fluid does he drink a week?
Answer: 868

Input: Stella and Twinkle are filling up a truck with a capacity of 6000 stone blocks at the rate of 250 blocks per hour per person. They work for four hours and are then joined by 6 other people who also work at the same rate. How many hours did filling the truck take?
Answer: 6

Input: Elijah drank 8.5 pints of coffee yesterday. Emilio drank 9.5 pints of water yesterday. How many cups of liquid did the two boys drink yesterday?
Answer: 36

Input: Doris works at the Widget Factory in the packing department. She puts 3 widgets in each carton, which are 4 inches wide, 4 inches long, and 5 inches tall. She then packs those cartons into a shipping box before sending it to the loading bay. The shipping boxes are 20 inches wide, 20 inches long, and 20 inches high. How many widgets get shipped in each shipping box?
Answer: 300

Input: Queenie earns $150 a day as a part-time clerk. She earns an additional $5 per hour as overtime pay. How much will Queenie receive for working 5 days with 4 hours overtime?
Answer: 770

Input: Jodi starts off walking 1 mile a day for 6 days a week.  On the second week, she walks 2 miles a day, 6 days a week.  On the third week, she walks 3 miles a day, 6 days a week. Finally on the fourth week, she walks 4 miles a day, 6 days a week.  How many miles has she walked in 4 weeks?
Answer: 60

Input: A club is going to get additional members so that they will have 5 more than twice their current number of their members. If the club has 10 members now, how many additional members do they need?
Answer: 15

Input: Andrea buys herself a pony for her 30th birthday. She pays $500/month to rent a pasture for it, $10 a day for food, and $60/lesson for two lessons a week. How much does she spend on her pony in a year?
Answer: 15890

Input: A pet shop has 2 puppies and some kittens. A puppy costs $20, and a kitten costs $15. If the stock is worth $100, how many kittens does the pet shop have?
Answer: 4

Input: Noah, who loves his Grammy, calls her every week to talk about his day. If each call lasts 30 minutes and he is charged $0.05 per call minute, how much would he be billed if he makes the calls for a year?
Answer: 78

Input: A merchant bought 15 keyboards and 25 printers for a total of $2050. If a keyboard costs $20, how much does a printer cost?
Answer: 70

Input: Gina has two bank accounts. Each account has a quarter of the balance in Betty's account. If Betty's account balance is $3,456, what is the combined balance of both Gina's accounts?
Answer: 1728

### Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid

### Response:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o16-tgsm8k-s10-rFalse
Loading extension module utils...
Time to load utils op: 0.4045069217681885 seconds
Loading extension module utils...
Time to load utils op: 0.5049161911010742 seconds
Evaluating commonsenseqa :   2%|█                                                  | 1/50 [00:43<35:55, 43.98s/it]Evaluating commonsenseqa :   4%|██                                                 | 2/50 [01:26<34:39, 43.33s/it]Evaluating commonsenseqa :   6%|███                                                | 3/50 [02:10<33:52, 43.26s/it]Evaluating commonsenseqa :   8%|████                                               | 4/50 [02:52<32:56, 42.96s/it]Evaluating commonsenseqa :  10%|█████                                              | 5/50 [03:35<32:18, 43.08s/it]Evaluating commonsenseqa :  12%|██████                                             | 6/50 [04:17<31:19, 42.71s/it]Evaluating commonsenseqa :  14%|███████▏                                           | 7/50 [05:01<30:51, 43.07s/it]Evaluating commonsenseqa :  16%|████████▏                                          | 8/50 [05:45<30:18, 43.30s/it]Evaluating commonsenseqa :  18%|█████████▏                                         | 9/50 [06:17<27:05, 39.65s/it]Evaluating commonsenseqa :  20%|██████████                                        | 10/50 [06:59<27:06, 40.67s/it]Evaluating commonsenseqa :  22%|███████████                                       | 11/50 [07:43<26:55, 41.43s/it]Evaluating commonsenseqa :  24%|████████████                                      | 12/50 [08:25<26:28, 41.80s/it]Evaluating commonsenseqa :  26%|█████████████                                     | 13/50 [09:05<25:21, 41.12s/it]Evaluating commonsenseqa :  28%|██████████████                                    | 14/50 [09:48<25:03, 41.77s/it]Evaluating commonsenseqa :  30%|███████████████                                   | 15/50 [10:17<22:11, 38.03s/it]Evaluating commonsenseqa :  32%|████████████████                                  | 16/50 [10:37<18:22, 32.43s/it]Evaluating commonsenseqa :  34%|█████████████████                                 | 17/50 [11:20<19:40, 35.78s/it]Evaluating commonsenseqa :  36%|██████████████████                                | 18/50 [12:04<20:16, 38.02s/it]Evaluating commonsenseqa :  38%|███████████████████                               | 19/50 [12:47<20:24, 39.50s/it]Evaluating commonsenseqa :  40%|████████████████████                              | 20/50 [13:30<20:20, 40.70s/it]Evaluating commonsenseqa :  42%|█████████████████████                             | 21/50 [14:01<18:10, 37.61s/it]Evaluating commonsenseqa :  44%|██████████████████████                            | 22/50 [14:44<18:20, 39.29s/it]Evaluating commonsenseqa :  46%|███████████████████████                           | 23/50 [15:26<18:07, 40.28s/it]Evaluating commonsenseqa :  48%|████████████████████████                          | 24/50 [16:10<17:52, 41.25s/it]Evaluating commonsenseqa :  50%|█████████████████████████                         | 25/50 [16:53<17:27, 41.90s/it]Evaluating commonsenseqa :  52%|██████████████████████████                        | 26/50 [17:36<16:52, 42.20s/it]Evaluating commonsenseqa :  54%|███████████████████████████                       | 27/50 [18:20<16:18, 42.55s/it]Evaluating commonsenseqa :  56%|████████████████████████████                      | 28/50 [19:03<15:39, 42.69s/it]Evaluating commonsenseqa :  58%|████████████████████████████▉                     | 29/50 [19:46<15:03, 43.01s/it]Evaluating commonsenseqa :  60%|██████████████████████████████                    | 30/50 [20:30<14:21, 43.09s/it]Evaluating commonsenseqa :  62%|███████████████████████████████                   | 31/50 [21:07<13:07, 41.45s/it]Evaluating commonsenseqa :  64%|████████████████████████████████                  | 32/50 [21:50<12:33, 41.87s/it]Evaluating commonsenseqa :  66%|█████████████████████████████████                 | 33/50 [22:18<10:41, 37.76s/it]Evaluating commonsenseqa :  68%|██████████████████████████████████                | 34/50 [23:01<10:28, 39.28s/it]Evaluating commonsenseqa :  70%|███████████████████████████████████               | 35/50 [23:44<10:05, 40.39s/it]Evaluating commonsenseqa :  72%|████████████████████████████████████              | 36/50 [24:27<09:38, 41.30s/it]Evaluating commonsenseqa :  74%|█████████████████████████████████████             | 37/50 [25:11<09:05, 41.99s/it]Evaluating commonsenseqa :  76%|██████████████████████████████████████            | 38/50 [25:55<08:31, 42.63s/it]Evaluating commonsenseqa :  78%|███████████████████████████████████████           | 39/50 [26:39<07:52, 42.97s/it]Evaluating commonsenseqa :  80%|████████████████████████████████████████          | 40/50 [27:22<07:09, 42.95s/it]Evaluating commonsenseqa :  82%|█████████████████████████████████████████         | 41/50 [28:02<06:17, 41.99s/it]Evaluating commonsenseqa :  84%|██████████████████████████████████████████        | 42/50 [28:45<05:38, 42.30s/it]Evaluating commonsenseqa :  86%|███████████████████████████████████████████       | 43/50 [29:28<04:57, 42.51s/it]Evaluating commonsenseqa :  88%|████████████████████████████████████████████      | 44/50 [30:10<04:15, 42.59s/it]Evaluating commonsenseqa :  90%|█████████████████████████████████████████████     | 45/50 [30:54<03:33, 42.79s/it]Evaluating commonsenseqa :  92%|██████████████████████████████████████████████    | 46/50 [31:37<02:52, 43.00s/it]Evaluating commonsenseqa :  94%|███████████████████████████████████████████████   | 47/50 [32:15<02:04, 41.60s/it]Evaluating commonsenseqa :  96%|████████████████████████████████████████████████  | 48/50 [32:59<01:24, 42.25s/it]Evaluating commonsenseqa :  98%|█████████████████████████████████████████████████ | 49/50 [33:33<00:39, 39.83s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████| 50/50 [34:17<00:00, 40.84s/it]Evaluating commonsenseqa : 100%|██████████████████████████████████████████████████| 50/50 [34:17<00:00, 41.14s/it]
name: commonsenseqa | {'exact_match': 0.0, 'rougeL': 4.2217} | lm_loss 7.8456 | avg. gen lenth: 270.14
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 29501 /home/ylu130/workspace/in-context-generalization/inference.py --model-name llama2-7b --model-type llama --model-path /scratch/ylu130/model/llama-2-7b --n-gpu 4 --is-opensource --data-name commonsenseqa --num-eval 1000 --num-workers 0 --num-in-domain 0 --out-domain-data-name gsm8k --save /home/ylu130/workspace/in-context-generalization/results --do-sample --top-k 50 --top-p 1 --temperature 1 --deepspeed --deepspeed_config /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json --batch-size 5 --data-dir /scratch/ylu130/processed_data/commonsenseqa/out-domain/o17-tgsm8k-s10-rFalse --seed 10 --num-out-domain 17
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data] Downloading package punkt to /home/ylu130/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
using world size: 4
[2023-08-14 11:28:16,326] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_name ................... llama2-7b
  model_type ................... llama
  model_path ................... /scratch/ylu130/model/llama-2-7b
  n_gpu ........................ 4
  n_nodes ...................... 1
  is_opensource ................ True
  model_parallel ............... False
  model_parallel_size .......... None
  data_name .................... commonsenseqa
  data_dir ..................... /scratch/ylu130/processed_data/commonsenseqa/out-domain/o17-tgsm8k-s10-rFalse
  processed_data_dir ........... None
  num_eval ..................... 1000
  num_in_domain ................ 0
  num_out_domain ............... 17
  out_domain_data_name ......... gsm8k
  out_domain_data_dir .......... None
  num_workers .................. 0
  max_prompt_length ............ 2048
  max_length ................... 512
  save ......................... /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o17-tgsm8k-s10-rFalse
  rationales ................... False
  top_k ........................ 50
  top_p ........................ 1.0
  do_sample .................... True
  num_beams .................... 1
  temperature .................. 1.0
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  gradient_accumulation_steps .. 1
  batch_size ................... 5
  clip_grad .................... 1.0
  seed ......................... 10
  deepspeed .................... True
  deepspeed_config ............. /home/ylu130/workspace/in-context-generalization/configs/deepspeed/ds_config.json
  deepscale .................... False
  deepscale_config ............. None
  deepspeed_mpi ................ False
  local_rank ................... 0
  rank ......................... 0
  world_size ................... 4
Loading Data
  0%|                                                                                    | 0/9741 [00:00<?, ?it/s]  0%|▏                                                                         | 30/9741 [00:00<00:32, 294.28it/s]  1%|▍                                                                         | 60/9741 [00:00<00:32, 296.49it/s]  1%|▋                                                                         | 90/9741 [00:00<00:32, 297.09it/s]  1%|▉                                                                        | 120/9741 [00:00<00:32, 297.86it/s]  2%|█                                                                        | 150/9741 [00:00<00:32, 297.79it/s]  2%|█▎                                                                       | 180/9741 [00:00<00:32, 297.47it/s]  2%|█▌                                                                       | 210/9741 [00:00<00:32, 295.40it/s]  2%|█▊                                                                       | 240/9741 [00:00<00:32, 291.40it/s]  3%|██                                                                       | 270/9741 [00:00<00:32, 292.53it/s]  3%|██▏                                                                      | 300/9741 [00:01<00:32, 293.56it/s]  3%|██▍                                                                      | 330/9741 [00:01<00:31, 294.22it/s]  4%|██▋                                                                      | 360/9741 [00:01<00:31, 294.44it/s]  4%|██▉                                                                      | 390/9741 [00:01<00:31, 294.95it/s]  4%|███▏                                                                     | 420/9741 [00:01<00:31, 294.72it/s]  5%|███▎                                                                     | 450/9741 [00:01<00:31, 292.88it/s]  5%|███▌                                                                     | 480/9741 [00:01<00:31, 293.34it/s]  5%|███▊                                                                     | 510/9741 [00:01<00:31, 293.64it/s]  6%|████                                                                     | 540/9741 [00:01<00:31, 291.39it/s]  6%|████▎                                                                    | 570/9741 [00:01<00:31, 291.87it/s]  6%|████▍                                                                    | 600/9741 [00:02<00:31, 292.76it/s]  6%|████▋                                                                    | 630/9741 [00:02<00:31, 293.28it/s]  7%|████▉                                                                    | 660/9741 [00:02<00:31, 291.88it/s]  7%|█████▏                                                                   | 690/9741 [00:02<00:30, 292.87it/s]  7%|█████▍                                                                   | 720/9741 [00:02<00:30, 293.14it/s]  8%|█████▌                                                                   | 750/9741 [00:02<00:30, 293.51it/s]  8%|█████▉                                                                   | 795/9741 [00:02<00:26, 338.01it/s]  9%|██████▎                                                                  | 840/9741 [00:02<00:24, 369.99it/s]  9%|██████▌                                                                  | 884/9741 [00:02<00:22, 390.50it/s] 10%|██████▉                                                                  | 929/9741 [00:02<00:21, 407.24it/s] 10%|███████▎                                                                 | 974/9741 [00:03<00:20, 418.94it/s] 10%|███████▌                                                                | 1019/9741 [00:03<00:20, 426.51it/s] 11%|███████▊                                                                | 1064/9741 [00:03<00:20, 432.51it/s] 11%|████████▏                                                               | 1108/9741 [00:03<00:19, 434.49it/s] 12%|████████▌                                                               | 1153/9741 [00:03<00:19, 437.92it/s] 12%|████████▊                                                               | 1198/9741 [00:03<00:19, 440.18it/s] 13%|█████████▏                                                              | 1243/9741 [00:03<00:19, 441.02it/s] 13%|█████████▌                                                              | 1288/9741 [00:03<00:19, 441.96it/s] 14%|█████████▊                                                              | 1333/9741 [00:03<00:18, 442.88it/s] 14%|██████████▏                                                             | 1378/9741 [00:03<00:18, 440.72it/s] 15%|██████████▌                                                             | 1423/9741 [00:04<00:18, 441.16it/s] 15%|██████████▊                                                             | 1468/9741 [00:04<00:18, 441.82it/s] 16%|███████████▏                                                            | 1513/9741 [00:04<00:18, 442.23it/s] 16%|███████████▌                                                            | 1558/9741 [00:04<00:18, 442.93it/s] 16%|███████████▊                                                            | 1603/9741 [00:04<00:18, 440.34it/s] 17%|████████████▏                                                           | 1648/9741 [00:04<00:18, 441.11it/s] 17%|████████████▌                                                           | 1693/9741 [00:04<00:18, 441.40it/s] 18%|████████████▊                                                           | 1738/9741 [00:04<00:18, 441.82it/s] 18%|█████████████▏                                                          | 1783/9741 [00:04<00:18, 441.53it/s] 19%|█████████████▌                                                          | 1828/9741 [00:05<00:18, 421.08it/s] 19%|█████████████▊                                                          | 1873/9741 [00:05<00:18, 427.27it/s] 20%|██████████████▏                                                         | 1918/9741 [00:05<00:18, 431.73it/s] 20%|██████████████▌                                                         | 1963/9741 [00:05<00:17, 434.55it/s] 21%|██████████████▊                                                         | 2008/9741 [00:05<00:17, 436.69it/s] 21%|███████████████▏                                                        | 2052/9741 [00:05<00:17, 435.65it/s] 22%|███████████████▍                                                        | 2097/9741 [00:05<00:17, 437.37it/s] 22%|███████████████▊                                                        | 2141/9741 [00:05<00:17, 437.03it/s] 22%|████████████████▏                                                       | 2186/9741 [00:05<00:17, 438.28it/s] 23%|████████████████▍                                                       | 2231/9741 [00:05<00:17, 439.60it/s] 23%|████████████████▊                                                       | 2275/9741 [00:06<00:17, 438.18it/s] 24%|█████████████████▏                                                      | 2320/9741 [00:06<00:16, 439.48it/s] 24%|█████████████████▍                                                      | 2365/9741 [00:06<00:16, 440.12it/s] 25%|█████████████████▊                                                      | 2410/9741 [00:06<00:16, 440.72it/s] 25%|██████████████████▏                                                     | 2455/9741 [00:06<00:16, 441.24it/s] 26%|██████████████████▍                                                     | 2500/9741 [00:06<00:16, 439.09it/s] 26%|██████████████████▊                                                     | 2544/9741 [00:06<00:16, 438.91it/s] 27%|███████████████████▏                                                    | 2589/9741 [00:06<00:16, 439.64it/s] 27%|███████████████████▍                                                    | 2634/9741 [00:06<00:16, 439.90it/s] 28%|███████████████████▊                                                    | 2679/9741 [00:06<00:16, 440.07it/s] 28%|████████████████████▏                                                   | 2724/9741 [00:07<00:16, 433.60it/s] 28%|████████████████████▍                                                   | 2768/9741 [00:07<00:16, 434.73it/s] 29%|████████████████████▊                                                   | 2812/9741 [00:07<00:15, 435.87it/s] 29%|█████████████████████                                                   | 2857/9741 [00:07<00:15, 437.70it/s] 30%|█████████████████████▍                                                  | 2901/9741 [00:07<00:15, 437.96it/s] 30%|█████████████████████▊                                                  | 2945/9741 [00:07<00:15, 436.12it/s] 31%|██████████████████████                                                  | 2990/9741 [00:07<00:15, 437.65it/s] 31%|██████████████████████▍                                                 | 3035/9741 [00:07<00:15, 438.51it/s] 32%|██████████████████████▊                                                 | 3080/9741 [00:07<00:15, 440.16it/s] 32%|███████████████████████                                                 | 3125/9741 [00:07<00:14, 443.07it/s] 33%|███████████████████████▍                                                | 3170/9741 [00:08<00:14, 442.67it/s] 33%|███████████████████████▊                                                | 3215/9741 [00:08<00:14, 444.81it/s] 33%|████████████████████████                                                | 3261/9741 [00:08<00:14, 446.53it/s] 34%|████████████████████████▍                                               | 3306/9741 [00:08<00:14, 443.80it/s] 34%|████████████████████████▊                                               | 3351/9741 [00:08<00:14, 445.20it/s] 35%|█████████████████████████                                               | 3396/9741 [00:08<00:14, 444.06it/s] 35%|█████████████████████████▍                                              | 3441/9741 [00:08<00:14, 445.30it/s] 36%|█████████████████████████▊                                              | 3486/9741 [00:08<00:14, 446.30it/s] 36%|██████████████████████████                                              | 3531/9741 [00:08<00:13, 445.82it/s] 37%|██████████████████████████▍                                             | 3576/9741 [00:08<00:13, 445.86it/s] 37%|██████████████████████████▊                                             | 3621/9741 [00:09<00:13, 442.91it/s] 38%|███████████████████████████                                             | 3666/9741 [00:09<00:13, 442.63it/s] 38%|███████████████████████████▍                                            | 3711/9741 [00:09<00:13, 444.08it/s] 39%|███████████████████████████▊                                            | 3756/9741 [00:09<00:13, 443.79it/s] 39%|████████████████████████████                                            | 3801/9741 [00:09<00:13, 443.63it/s] 39%|████████████████████████████▍                                           | 3846/9741 [00:09<00:13, 442.60it/s] 40%|████████████████████████████▊                                           | 3891/9741 [00:09<00:13, 439.51it/s] 40%|█████████████████████████████                                           | 3936/9741 [00:09<00:13, 440.29it/s] 41%|█████████████████████████████▍                                          | 3981/9741 [00:09<00:13, 442.00it/s] 41%|█████████████████████████████▊                                          | 4026/9741 [00:09<00:12, 441.81it/s] 42%|██████████████████████████████                                          | 4071/9741 [00:10<00:12, 438.81it/s] 42%|██████████████████████████████▍                                         | 4116/9741 [00:10<00:12, 439.92it/s] 43%|██████████████████████████████▊                                         | 4161/9741 [00:10<00:12, 440.57it/s] 43%|███████████████████████████████                                         | 4206/9741 [00:10<00:12, 441.51it/s] 44%|███████████████████████████████▍                                        | 4251/9741 [00:10<00:12, 443.09it/s] 44%|███████████████████████████████▊                                        | 4296/9741 [00:10<00:12, 442.15it/s] 45%|████████████████████████████████                                        | 4341/9741 [00:10<00:12, 442.58it/s] 45%|████████████████████████████████▍                                       | 4386/9741 [00:10<00:12, 442.60it/s] 45%|████████████████████████████████▊                                       | 4431/9741 [00:10<00:12, 441.83it/s] 46%|█████████████████████████████████                                       | 4476/9741 [00:11<00:11, 442.73it/s] 46%|█████████████████████████████████▍                                      | 4521/9741 [00:11<00:13, 398.32it/s] 47%|█████████████████████████████████▋                                      | 4566/9741 [00:11<00:12, 411.91it/s] 47%|██████████████████████████████████                                      | 4611/9741 [00:11<00:12, 422.33it/s] 48%|██████████████████████████████████▍                                     | 4656/9741 [00:11<00:11, 429.35it/s] 48%|██████████████████████████████████▋                                     | 4701/9741 [00:11<00:11, 434.44it/s] 49%|███████████████████████████████████                                     | 4745/9741 [00:11<00:15, 322.19it/s] 49%|███████████████████████████████████▍                                    | 4789/9741 [00:11<00:14, 349.59it/s] 50%|███████████████████████████████████▋                                    | 4833/9741 [00:11<00:13, 372.23it/s] 50%|████████████████████████████████████                                    | 4877/9741 [00:12<00:12, 389.60it/s] 51%|████████████████████████████████████▎                                   | 4921/9741 [00:12<00:11, 403.38it/s] 51%|████████████████████████████████████▋                                   | 4964/9741 [00:12<00:11, 408.95it/s] 51%|█████████████████████████████████████                                   | 5009/9741 [00:12<00:11, 419.24it/s] 52%|█████████████████████████████████████▎                                  | 5054/9741 [00:12<00:10, 426.99it/s] 52%|█████████████████████████████████████▋                                  | 5099/9741 [00:12<00:10, 432.24it/s] 53%|██████████████████████████████████████                                  | 5144/9741 [00:12<00:10, 436.05it/s] 53%|██████████████████████████████████████▎                                 | 5188/9741 [00:12<00:10, 436.28it/s] 54%|██████████████████████████████████████▋                                 | 5232/9741 [00:12<00:10, 436.85it/s] 54%|██████████████████████████████████████▉                                 | 5276/9741 [00:12<00:10, 436.88it/s] 55%|███████████████████████████████████████▎                                | 5320/9741 [00:13<00:10, 437.69it/s] 55%|███████████████████████████████████████▋                                | 5365/9741 [00:13<00:09, 438.69it/s] 56%|███████████████████████████████████████▉                                | 5409/9741 [00:13<00:09, 436.32it/s] 56%|████████████████████████████████████████▎                               | 5454/9741 [00:13<00:09, 437.50it/s] 56%|████████████████████████████████████████▋                               | 5499/9741 [00:13<00:09, 440.60it/s] 57%|████████████████████████████████████████▉                               | 5545/9741 [00:13<00:09, 445.42it/s] 57%|█████████████████████████████████████████▎                              | 5591/9741 [00:13<00:09, 448.04it/s] 58%|█████████████████████████████████████████▋                              | 5636/9741 [00:13<00:09, 447.94it/s] 58%|█████████████████████████████████████████▉                              | 5681/9741 [00:13<00:09, 448.16it/s] 59%|██████████████████████████████████████████▎                             | 5727/9741 [00:13<00:08, 450.49it/s] 59%|██████████████████████████████████████████▋                             | 5773/9741 [00:14<00:08, 452.34it/s] 60%|███████████████████████████████████████████                             | 5819/9741 [00:14<00:08, 453.05it/s] 60%|███████████████████████████████████████████▎                            | 5865/9741 [00:14<00:08, 451.36it/s] 61%|███████████████████████████████████████████▋                            | 5911/9741 [00:14<00:08, 452.84it/s] 61%|████████████████████████████████████████████                            | 5957/9741 [00:14<00:08, 453.71it/s] 62%|████████████████████████████████████████████▎                           | 6003/9741 [00:14<00:08, 453.91it/s] 62%|████████████████████████████████████████████▋                           | 6049/9741 [00:14<00:08, 454.23it/s] 63%|█████████████████████████████████████████████                           | 6095/9741 [00:14<00:08, 452.18it/s] 63%|█████████████████████████████████████████████▍                          | 6141/9741 [00:14<00:07, 453.58it/s] 64%|█████████████████████████████████████████████▋                          | 6188/9741 [00:15<00:07, 455.98it/s] 64%|██████████████████████████████████████████████                          | 6234/9741 [00:15<00:07, 455.01it/s] 64%|██████████████████████████████████████████████▍                         | 6280/9741 [00:15<00:07, 456.15it/s] 65%|██████████████████████████████████████████████▊                         | 6326/9741 [00:15<00:07, 455.01it/s] 65%|███████████████████████████████████████████████                         | 6372/9741 [00:15<00:07, 454.90it/s] 66%|███████████████████████████████████████████████▍                        | 6418/9741 [00:15<00:07, 455.55it/s] 66%|███████████████████████████████████████████████▊                        | 6464/9741 [00:15<00:07, 454.46it/s] 67%|████████████████████████████████████████████████                        | 6510/9741 [00:15<00:07, 454.60it/s] 67%|████████████████████████████████████████████████▍                       | 6556/9741 [00:15<00:07, 451.87it/s] 68%|████████████████████████████████████████████████▊                       | 6602/9741 [00:15<00:06, 452.70it/s] 68%|█████████████████████████████████████████████████▏                      | 6648/9741 [00:16<00:06, 453.14it/s] 69%|█████████████████████████████████████████████████▍                      | 6694/9741 [00:16<00:06, 453.70it/s] 69%|█████████████████████████████████████████████████▊                      | 6740/9741 [00:16<00:06, 453.92it/s] 70%|██████████████████████████████████████████████████▏                     | 6786/9741 [00:16<00:06, 452.54it/s] 70%|██████████████████████████████████████████████████▍                     | 6832/9741 [00:16<00:06, 453.44it/s] 71%|██████████████████████████████████████████████████▊                     | 6878/9741 [00:16<00:06, 454.15it/s] 71%|███████████████████████████████████████████████████▏                    | 6924/9741 [00:16<00:06, 454.51it/s] 72%|███████████████████████████████████████████████████▌                    | 6971/9741 [00:16<00:06, 456.22it/s] 72%|███████████████████████████████████████████████████▊                    | 7017/9741 [00:16<00:05, 455.27it/s] 73%|████████████████████████████████████████████████████▏                   | 7064/9741 [00:16<00:05, 457.90it/s] 73%|████████████████████████████████████████████████████▌                   | 7111/9741 [00:17<00:05, 459.01it/s] 73%|████████████████████████████████████████████████████▉                   | 7158/9741 [00:17<00:05, 460.08it/s] 74%|█████████████████████████████████████████████████████▎                  | 7205/9741 [00:17<00:05, 460.48it/s] 74%|█████████████████████████████████████████████████████▌                  | 7252/9741 [00:17<00:05, 457.79it/s] 75%|█████████████████████████████████████████████████████▉                  | 7299/9741 [00:17<00:05, 458.59it/s] 75%|██████████████████████████████████████████████████████▎                 | 7346/9741 [00:17<00:05, 459.30it/s] 76%|██████████████████████████████████████████████████████▋                 | 7393/9741 [00:17<00:05, 460.16it/s] 76%|██████████████████████████████████████████████████████▉                 | 7440/9741 [00:17<00:05, 433.12it/s] 77%|███████████████████████████████████████████████████████▎                | 7486/9741 [00:17<00:05, 439.95it/s] 77%|███████████████████████████████████████████████████████▋                | 7532/9741 [00:17<00:04, 445.13it/s] 78%|████████████████████████████████████████████████████████                | 7579/9741 [00:18<00:04, 450.07it/s] 78%|████████████████████████████████████████████████████████▎               | 7626/9741 [00:18<00:04, 453.87it/s] 79%|████████████████████████████████████████████████████████▋               | 7672/9741 [00:18<00:04, 453.29it/s] 79%|█████████████████████████████████████████████████████████               | 7718/9741 [00:18<00:04, 453.43it/s] 80%|█████████████████████████████████████████████████████████▍              | 7764/9741 [00:18<00:04, 454.40it/s] 80%|█████████████████████████████████████████████████████████▋              | 7810/9741 [00:18<00:04, 454.62it/s] 81%|██████████████████████████████████████████████████████████              | 7856/9741 [00:18<00:04, 454.44it/s] 81%|██████████████████████████████████████████████████████████▍             | 7902/9741 [00:18<00:04, 451.69it/s] 82%|██████████████████████████████████████████████████████████▋             | 7948/9741 [00:18<00:03, 452.69it/s] 82%|███████████████████████████████████████████████████████████             | 7994/9741 [00:18<00:03, 452.83it/s] 83%|███████████████████████████████████████████████████████████▍            | 8040/9741 [00:19<00:03, 452.92it/s] 83%|███████████████████████████████████████████████████████████▊            | 8086/9741 [00:19<00:03, 452.96it/s] 83%|████████████████████████████████████████████████████████████            | 8132/9741 [00:19<00:03, 451.28it/s] 84%|████████████████████████████████████████████████████████████▍           | 8178/9741 [00:19<00:03, 452.21it/s] 84%|████████████████████████████████████████████████████████████▊           | 8224/9741 [00:19<00:03, 452.64it/s] 85%|█████████████████████████████████████████████████████████████▏          | 8270/9741 [00:19<00:03, 452.69it/s] 85%|█████████████████████████████████████████████████████████████▍          | 8316/9741 [00:19<00:03, 452.92it/s] 86%|█████████████████████████████████████████████████████████████▊          | 8362/9741 [00:19<00:03, 453.11it/s] 86%|██████████████████████████████████████████████████████████████▏         | 8408/9741 [00:19<00:02, 453.95it/s] 87%|██████████████████████████████████████████████████████████████▍         | 8454/9741 [00:19<00:02, 453.80it/s] 87%|██████████████████████████████████████████████████████████████▊         | 8500/9741 [00:20<00:02, 453.17it/s] 88%|███████████████████████████████████████████████████████████████▏        | 8546/9741 [00:20<00:02, 453.16it/s] 88%|███████████████████████████████████████████████████████████████▌        | 8592/9741 [00:20<00:02, 453.16it/s] 89%|███████████████████████████████████████████████████████████████▊        | 8638/9741 [00:20<00:02, 453.36it/s] 89%|████████████████████████████████████████████████████████████████▏       | 8684/9741 [00:20<00:02, 453.47it/s] 90%|████████████████████████████████████████████████████████████████▌       | 8730/9741 [00:20<00:02, 453.69it/s] 90%|████████████████████████████████████████████████████████████████▊       | 8776/9741 [00:20<00:02, 448.90it/s] 91%|█████████████████████████████████████████████████████████████████▏      | 8821/9741 [00:20<00:02, 445.53it/s] 91%|█████████████████████████████████████████████████████████████████▌      | 8867/9741 [00:20<00:01, 448.56it/s] 91%|█████████████████████████████████████████████████████████████████▉      | 8913/9741 [00:21<00:01, 450.01it/s] 92%|██████████████████████████████████████████████████████████████████▏     | 8959/9741 [00:21<00:01, 450.93it/s] 92%|██████████████████████████████████████████████████████████████████▌     | 9005/9741 [00:21<00:01, 451.40it/s] 93%|██████████████████████████████████████████████████████████████████▉     | 9051/9741 [00:21<00:01, 450.04it/s] 93%|███████████████████████████████████████████████████████████████████▏    | 9097/9741 [00:21<00:01, 450.85it/s] 94%|███████████████████████████████████████████████████████████████████▌    | 9143/9741 [00:21<00:01, 451.90it/s] 94%|███████████████████████████████████████████████████████████████████▉    | 9189/9741 [00:21<00:01, 452.16it/s] 95%|████████████████████████████████████████████████████████████████████▎   | 9235/9741 [00:21<00:01, 452.43it/s] 95%|████████████████████████████████████████████████████████████████████▌   | 9281/9741 [00:21<00:01, 450.19it/s] 96%|████████████████████████████████████████████████████████████████████▉   | 9327/9741 [00:21<00:00, 452.14it/s] 96%|█████████████████████████████████████████████████████████████████████▎  | 9373/9741 [00:22<00:00, 452.46it/s] 97%|█████████████████████████████████████████████████████████████████████▌  | 9419/9741 [00:22<00:00, 454.15it/s] 97%|█████████████████████████████████████████████████████████████████████▉  | 9465/9741 [00:22<00:00, 454.43it/s] 98%|██████████████████████████████████████████████████████████████████████▎ | 9511/9741 [00:22<00:00, 453.79it/s] 98%|██████████████████████████████████████████████████████████████████████▋ | 9557/9741 [00:22<00:00, 451.94it/s] 99%|██████████████████████████████████████████████████████████████████████▉ | 9603/9741 [00:22<00:00, 454.28it/s] 99%|███████████████████████████████████████████████████████████████████████▎| 9649/9741 [00:22<00:00, 455.47it/s]100%|███████████████████████████████████████████████████████████████████████▋| 9695/9741 [00:22<00:00, 454.93it/s]100%|████████████████████████████████████████████████████████████████████████| 9741/9741 [00:22<00:00, 451.89it/s]100%|████████████████████████████████████████████████████████████████████████| 9741/9741 [00:22<00:00, 426.37it/s]
Load End
Num instances: 1000
Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:04<00:09,  4.92s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:10,  5.04s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:11,  5.56s/it]Loading checkpoint shards:  33%|█████████████████▎                                  | 1/3 [00:05<00:11,  5.51s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:09<00:04,  4.98s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:09<00:04,  4.92s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.27s/it]Loading checkpoint shards:  67%|██████████████████████████████████▋                 | 2/3 [00:10<00:05,  5.29s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.36s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.53s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.32s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:13<00:00,  4.50s/it]
[2023-08-14 11:29:30,081] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed info: version=0.8.0, git-hash=unknown, git-branch=unknown
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.61s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.82s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.64s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████| 3/3 [00:14<00:00,  4.84s/it]
[2023-08-14 11:29:44,713] [INFO] [logging.py:68:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2023-08-14 11:29:44,714] [INFO] [config.py:1008:print] DeepSpeedEngine configuration:
[2023-08-14 11:29:44,715] [INFO] [config.py:1012:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-08-14 11:29:44,715] [INFO] [config.py:1012:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-08-14 11:29:44,715] [INFO] [config.py:1012:print]   amp_enabled .................. False
[2023-08-14 11:29:44,715] [INFO] [config.py:1012:print]   amp_params ................... False
[2023-08-14 11:29:44,715] [INFO] [config.py:1012:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-08-14 11:29:44,715] [INFO] [config.py:1012:print]   bfloat16_enabled ............. False
[2023-08-14 11:29:44,716] [INFO] [config.py:1012:print]   checkpoint_parallel_write_pipeline  False
[2023-08-14 11:29:44,716] [INFO] [config.py:1012:print]   checkpoint_tag_validation_enabled  True
[2023-08-14 11:29:44,716] [INFO] [config.py:1012:print]   checkpoint_tag_validation_fail  False
[2023-08-14 11:29:44,716] [INFO] [config.py:1012:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f25637d4fd0>
[2023-08-14 11:29:44,716] [INFO] [config.py:1012:print]   communication_data_type ...... None
[2023-08-14 11:29:44,716] [INFO] [config.py:1012:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-08-14 11:29:44,716] [INFO] [config.py:1012:print]   curriculum_enabled_legacy .... False
[2023-08-14 11:29:44,716] [INFO] [config.py:1012:print]   curriculum_params_legacy ..... False
[2023-08-14 11:29:44,716] [INFO] [config.py:1012:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-08-14 11:29:44,716] [INFO] [config.py:1012:print]   data_efficiency_enabled ...... False
[2023-08-14 11:29:44,716] [INFO] [config.py:1012:print]   dataloader_drop_last ......... False
[2023-08-14 11:29:44,716] [INFO] [config.py:1012:print]   disable_allgather ............ False
[2023-08-14 11:29:44,716] [INFO] [config.py:1012:print]   dump_state ................... False
[2023-08-14 11:29:44,716] [INFO] [config.py:1012:print]   dynamic_loss_scale_args ...... {'init_scale': 2048, 'scale_window': 2000, 'delayed_shift': 4, 'min_scale': 1}
[2023-08-14 11:29:44,716] [INFO] [config.py:1012:print]   eigenvalue_enabled ........... False
[2023-08-14 11:29:44,716] [INFO] [config.py:1012:print]   eigenvalue_gas_boundary_resolution  1
[2023-08-14 11:29:44,716] [INFO] [config.py:1012:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-08-14 11:29:44,716] [INFO] [config.py:1012:print]   eigenvalue_layer_num ......... 0
[2023-08-14 11:29:44,716] [INFO] [config.py:1012:print]   eigenvalue_max_iter .......... 100
[2023-08-14 11:29:44,716] [INFO] [config.py:1012:print]   eigenvalue_stability ......... 1e-06
[2023-08-14 11:29:44,716] [INFO] [config.py:1012:print]   eigenvalue_tol ............... 0.01
[2023-08-14 11:29:44,716] [INFO] [config.py:1012:print]   eigenvalue_verbose ........... False
[2023-08-14 11:29:44,716] [INFO] [config.py:1012:print]   elasticity_enabled ........... False
[2023-08-14 11:29:44,716] [INFO] [config.py:1012:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-08-14 11:29:44,716] [INFO] [config.py:1012:print]   fp16_auto_cast ............... False
[2023-08-14 11:29:44,716] [INFO] [config.py:1012:print]   fp16_enabled ................. True
[2023-08-14 11:29:44,716] [INFO] [config.py:1012:print]   fp16_master_weights_and_gradients  False
[2023-08-14 11:29:44,716] [INFO] [config.py:1012:print]   global_rank .................. 0
[2023-08-14 11:29:44,716] [INFO] [config.py:1012:print]   grad_accum_dtype ............. None
[2023-08-14 11:29:44,716] [INFO] [config.py:1012:print]   gradient_accumulation_steps .. 1
[2023-08-14 11:29:44,716] [INFO] [config.py:1012:print]   gradient_clipping ............ 1.0
[2023-08-14 11:29:44,716] [INFO] [config.py:1012:print]   gradient_predivide_factor .... 1.0
[2023-08-14 11:29:44,716] [INFO] [config.py:1012:print]   initial_dynamic_scale ........ 2048
[2023-08-14 11:29:44,716] [INFO] [config.py:1012:print]   load_universal_checkpoint .... False
[2023-08-14 11:29:44,716] [INFO] [config.py:1012:print]   loss_scale ................... 0
[2023-08-14 11:29:44,717] [INFO] [config.py:1012:print]   memory_breakdown ............. False
[2023-08-14 11:29:44,717] [INFO] [config.py:1012:print]   monitor_config ............... <deepspeed.monitor.config.DeepSpeedMonitorConfig object at 0x7f253aef8cd0>
[2023-08-14 11:29:44,717] [INFO] [config.py:1012:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-08-14 11:29:44,717] [INFO] [config.py:1012:print]   optimizer_legacy_fusion ...... False
[2023-08-14 11:29:44,717] [INFO] [config.py:1012:print]   optimizer_name ............... None
[2023-08-14 11:29:44,717] [INFO] [config.py:1012:print]   optimizer_params ............. None
[2023-08-14 11:29:44,717] [INFO] [config.py:1012:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-08-14 11:29:44,717] [INFO] [config.py:1012:print]   pld_enabled .................. False
[2023-08-14 11:29:44,717] [INFO] [config.py:1012:print]   pld_params ................... False
[2023-08-14 11:29:44,717] [INFO] [config.py:1012:print]   prescale_gradients ........... False
[2023-08-14 11:29:44,717] [INFO] [config.py:1012:print]   scheduler_name ............... None
[2023-08-14 11:29:44,717] [INFO] [config.py:1012:print]   scheduler_params ............. None
[2023-08-14 11:29:44,717] [INFO] [config.py:1012:print]   sparse_attention ............. None
[2023-08-14 11:29:44,717] [INFO] [config.py:1012:print]   sparse_gradients_enabled ..... False
[2023-08-14 11:29:44,717] [INFO] [config.py:1012:print]   steps_per_print .............. 1
[2023-08-14 11:29:44,717] [INFO] [config.py:1012:print]   train_batch_size ............. 20
[2023-08-14 11:29:44,717] [INFO] [config.py:1012:print]   train_micro_batch_size_per_gpu  5
[2023-08-14 11:29:44,717] [INFO] [config.py:1012:print]   use_node_local_storage ....... False
[2023-08-14 11:29:44,717] [INFO] [config.py:1012:print]   wall_clock_breakdown ......... False
[2023-08-14 11:29:44,717] [INFO] [config.py:1012:print]   world_size ................... 4
[2023-08-14 11:29:44,717] [INFO] [config.py:1012:print]   zero_allow_untested_optimizer  True
[2023-08-14 11:29:44,717] [INFO] [config.py:1012:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False
[2023-08-14 11:29:44,717] [INFO] [config.py:1012:print]   zero_enabled ................. False
[2023-08-14 11:29:44,717] [INFO] [config.py:1012:print]   zero_optimization_stage ...... 0
[2023-08-14 11:29:44,717] [INFO] [config.py:997:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 5, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 0
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1
}
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Using /home/ylu130/.cache/torch_extensions/py39_cu113 as PyTorch extensions root...
Emitting ninja build file /home/ylu130/.cache/torch_extensions/py39_cu113/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.5400257110595703 seconds
Loading extension module utils...
Time to load utils op: 0.4046144485473633 seconds
Loading extension module utils...
Time to load utils op: 0.5046286582946777 seconds
Loading extension module utils...
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   12916 MB |   12916 MB |   12916 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      64 MB |      64 MB |      64 MB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12918 MB |   12918 MB |   12918 MB |       0 B  |
|       from large pool |   12852 MB |   12852 MB |   12852 MB |       0 B  |
|       from small pool |      66 MB |      66 MB |      66 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1512 KB |    2047 KB |   34815 KB |   33303 KB |
|---------------------------------------------------------------------------|
| Allocations           |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     387    |     387    |     387    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |     161    |     161    |     161    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     259    |     259    |       0    |
|       from large pool |     226    |     226    |     226    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |      33    |      31    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |      33    |      31    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Time to load utils op: 0.5046114921569824 seconds
Evaluating commonsenseqa :   0%|                                                           | 0/50 [00:00<?, ?it/s]############### Example ###############
Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:Answer the following multiple choice question.

### Demonstration:
Input: Adam bought 3 kilograms of nuts and 2.5 kilograms of dried fruits at a store. One kilogram of nuts costs $12 and one kilogram of dried fruit costs $8. How much did his purchases cost?
Answer: 56

Input: Johns goes to the gym 3 times a week.  He spends 1 hour each day lifting weight. Additionally, he also spends a third of his weightlifting time warming up and doing cardio each day.  How many hours does he spend at the gym a week?
Answer: 4

Input: James has to refuel his plane.  It used to cost $200 to refill the tank.  He got an extra tank to double fuel capacity.  Fuel prices also went up by 20%.  How much does he pay now for fuel?
Answer: 480

Input: The number of goals scored in a game against Barca by exactly two players last season accounts for 20% of all goals scored in the league. If the players scored an equal number of goals, and the total number of goals scored in the league against Barca that season is 300, calculate the number of goals each of the two players scored.
Answer: 30

Input: Every day Tom drinks 5 12-oz cans of soda plus 64 ounces of water. How many ounces of fluid does he drink a week?
Answer: 868

Input: Stella and Twinkle are filling up a truck with a capacity of 6000 stone blocks at the rate of 250 blocks per hour per person. They work for four hours and are then joined by 6 other people who also work at the same rate. How many hours did filling the truck take?
Answer: 6

Input: Elijah drank 8.5 pints of coffee yesterday. Emilio drank 9.5 pints of water yesterday. How many cups of liquid did the two boys drink yesterday?
Answer: 36

Input: Doris works at the Widget Factory in the packing department. She puts 3 widgets in each carton, which are 4 inches wide, 4 inches long, and 5 inches tall. She then packs those cartons into a shipping box before sending it to the loading bay. The shipping boxes are 20 inches wide, 20 inches long, and 20 inches high. How many widgets get shipped in each shipping box?
Answer: 300

Input: Queenie earns $150 a day as a part-time clerk. She earns an additional $5 per hour as overtime pay. How much will Queenie receive for working 5 days with 4 hours overtime?
Answer: 770

Input: Jodi starts off walking 1 mile a day for 6 days a week.  On the second week, she walks 2 miles a day, 6 days a week.  On the third week, she walks 3 miles a day, 6 days a week. Finally on the fourth week, she walks 4 miles a day, 6 days a week.  How many miles has she walked in 4 weeks?
Answer: 60

Input: A club is going to get additional members so that they will have 5 more than twice their current number of their members. If the club has 10 members now, how many additional members do they need?
Answer: 15

Input: Andrea buys herself a pony for her 30th birthday. She pays $500/month to rent a pasture for it, $10 a day for food, and $60/lesson for two lessons a week. How much does she spend on her pony in a year?
Answer: 15890

Input: A pet shop has 2 puppies and some kittens. A puppy costs $20, and a kitten costs $15. If the stock is worth $100, how many kittens does the pet shop have?
Answer: 4

Input: Noah, who loves his Grammy, calls her every week to talk about his day. If each call lasts 30 minutes and he is charged $0.05 per call minute, how much would he be billed if he makes the calls for a year?
Answer: 78

Input: A merchant bought 15 keyboards and 25 printers for a total of $2050. If a keyboard costs $20, how much does a printer cost?
Answer: 70

Input: Gina has two bank accounts. Each account has a quarter of the balance in Betty's account. If Betty's account balance is $3,456, what is the combined balance of both Gina's accounts?
Answer: 1728

Input: Zain has 10 more of each coin than Emerie. If Emerie has six quarters, seven dimes, and five nickels, how many coins does Zain have?
Answer: 48

### Input:The sanctions against the school were a punishing blow, and they seemed to what the efforts the school had made to change? Choices:  A: ignore B: enforce C: authoritarian D: yell at E: avoid

### Response:
############### End ###############
Experiment Save Path: /home/ylu130/workspace/in-context-generalization/results/llama2-7b/commonsenseqa/out-domain/o17-tgsm8k-s10-rFalse
Evaluating commonsenseqa :   2%|█                                                  | 1/50 [00:43<35:48, 43.84s/it]Evaluating commonsenseqa :   4%|██                                                 | 2/50 [01:15<29:27, 36.83s/it]Evaluating commonsenseqa :   6%|███                                                | 3/50 [01:56<30:13, 38.59s/it]Evaluating commonsenseqa :   8%|████                                               | 4/50 [02:40<31:07, 40.59s/it]Evaluating commonsenseqa :  10%|█████                                              | 5/50 [03:23<31:13, 41.64s/it]Evaluating commonsenseqa :  12%|██████                                             | 6/50 [04:01<29:42, 40.52s/it]Evaluating commonsenseqa :  14%|███████▏                                           | 7/50 [04:39<28:23, 39.62s/it]Evaluating commonsenseqa :  16%|████████▏                                          | 8/50 [05:18<27:39, 39.51s/it]Evaluating commonsenseqa :  18%|█████████▏                                         | 9/50 [06:02<27:49, 40.71s/it]Evaluating commonsenseqa :  20%|██████████                                        | 10/50 [06:45<27:40, 41.51s/it]Evaluating commonsenseqa :  22%|███████████                                       | 11/50 [07:28<27:20, 42.06s/it]Evaluating commonsenseqa :  24%|████████████                                      | 12/50 [08:11<26:46, 42.28s/it]Evaluating commonsenseqa :  26%|█████████████                                     | 13/50 [08:55<26:22, 42.78s/it]Evaluating commonsenseqa :  28%|██████████████                                    | 14/50 [09:39<25:48, 43.01s/it]Evaluating commonsenseqa :  30%|███████████████                                   | 15/50 [10:21<25:01, 42.89s/it]Evaluating commonsenseqa :  32%|████████████████                                  | 16/50 [10:55<22:48, 40.24s/it]Evaluating commonsenseqa :  34%|█████████████████                                 | 17/50 [11:38<22:34, 41.06s/it]Evaluating commonsenseqa :  36%|██████████████████                                | 18/50 [12:22<22:15, 41.75s/it]Evaluating commonsenseqa :  38%|███████████████████                               | 19/50 [13:04<21:41, 41.97s/it]Evaluating commonsenseqa :  40%|████████████████████                              | 20/50 [13:47<21:04, 42.16s/it]Evaluating commonsenseqa :  42%|█████████████████████                             | 21/50 [14:28<20:16, 41.96s/it]Evaluating commonsenseqa :  44%|██████████████████████                            | 22/50 [15:11<19:44, 42.32s/it]Evaluating commonsenseqa :  46%|███████████████████████                           | 23/50 [15:45<17:54, 39.80s/it]Evaluating commonsenseqa :  48%|████████████████████████                          | 24/50 [16:03<14:22, 33.16s/it]Evaluating commonsenseqa :  50%|█████████████████████████                         | 25/50 [16:46<15:05, 36.24s/it]Evaluating commonsenseqa :  52%|██████████████████████████                        | 26/50 [17:30<15:18, 38.29s/it]Evaluating commonsenseqa :  54%|███████████████████████████                       | 27/50 [18:12<15:11, 39.65s/it]Evaluating commonsenseqa :  56%|████████████████████████████                      | 28/50 [18:56<14:56, 40.75s/it]Evaluating commonsenseqa :  58%|████████████████████████████▉                     | 29/50 [19:28<13:21, 38.17s/it]